<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007050A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007050</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17305235</doc-number><date>20210701</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>29</main-group><subgroup>06</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>06</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>205</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>06</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>0236</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>105</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">DIFFERENTIATED SERVICE IN A FEDERATION-BASED ACCESS NETWORK</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Cisco Technology, Inc.</orgname><address><city>San Jose</city><state>CA</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>HENRY</last-name><first-name>Jerome</first-name><address><city>Pittsboro</city><state>NC</state><country>US</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>BARTON</last-name><first-name>Robert E.</first-name><address><city>Richmond</city><country>CA</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>PIGNATARO</last-name><first-name>Carlos M.</first-name><address><city>Cary</city><state>NC</state><country>US</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>NAINAR</last-name><first-name>Nagendra Kumar</first-name><address><city>Morrisville</city><state>NC</state><country>US</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>SMITH</last-name><first-name>Malcolm M.</first-name><address><city>Richardson</city><state>TX</state><country>US</country></address></addressbook></inventor><inventor sequence="05" designation="us-only"><addressbook><last-name>GRAYSON</last-name><first-name>Mark</first-name><address><city>Maidenhead</city><country>GB</country></address></addressbook></inventor><inventor sequence="06" designation="us-only"><addressbook><last-name>BRINCKMAN</last-name><first-name>Bart A.</first-name><address><city>Nevele</city><country>BE</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">Differentiated service in a federation-based access network is provided by receiving, with a request for access to a wireless network offering at least a two different service levels based on user identities, a set of user credentials from a User Equipment (UE); forwarding, for authentication, the set of user credentials to an identity provider in an identity federation with the wireless network, wherein the identity provider is independent from the wireless network; in response to determining that the set of user credentials indicate a realm known to be associated with a given service level, providing network access to the UE according to the given service level; and in response to determining that the given service level is not a highest service level in the wireless network, transmitting a list of preferred realms to the UE that are associated with higher service levels than the given service level.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="117.60mm" wi="158.75mm" file="US20230007050A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="228.09mm" wi="166.62mm" orientation="landscape" file="US20230007050A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="229.45mm" wi="167.05mm" file="US20230007050A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="228.18mm" wi="163.32mm" file="US20230007050A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="215.39mm" wi="167.30mm" orientation="landscape" file="US20230007050A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="215.39mm" wi="167.30mm" orientation="landscape" file="US20230007050A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="176.36mm" wi="166.20mm" file="US20230007050A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">TECHNICAL FIELD</heading><p id="p-0002" num="0001">Embodiments presented in this disclosure generally relate to network management. More specifically, embodiments disclosed herein provide for the exchange and selection of identities and supplemental data to gain access to a network or network-provided service from one of several potential identities.</p><heading id="h-0002" level="1">BACKGROUND</heading><p id="p-0003" num="0002">Various networks and services allow users, via associated User Equipment (UE), also referred to as a station (STA) or mobile station, to gain access to the services by associated identities. For example, a first service can provide access once a user confirms an identity or profile provided by the first service (e.g., a username/password combination). However, services can join together to share credentials and user identities to determine how and whether to provide access to an associated service based on an identity used by other services in an identity federation. With the deployment of identity federations, each user can amass an increasingly larger set of possible identities that could be used to onboard to a given network or other federated service.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0004" num="0003">So that the manner in which the above-recited features of the present disclosure can be understood in detail, a more particular description of the disclosure, briefly summarized above, may be had by reference to embodiments, some of which are illustrated in the appended drawings. It is to be noted, however, that the appended drawings illustrate typical embodiments and are therefore not to be considered limiting; other equally effective embodiments are contemplated.</p><p id="p-0005" num="0004"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates a network environment that supports differentiated service in a federation-based access network, according to embodiments of the present disclosure.</p><p id="p-0006" num="0005"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a flowchart of a method for providing improved differentiated service in a federation-based network, according to embodiments of the present disclosure.</p><p id="p-0007" num="0006"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a flowchart of a method for improving a service level of differentiated service in a federation-based network, according to embodiments of the present disclosure.</p><p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a timing diagram for providing differentiated service in a wireless network, according to embodiments of the present disclosure.</p><p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a timing diagram for providing differentiated service in a wireless network, according to embodiments of the present disclosure.</p><p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. <b>6</b></figref> illustrates hardware of a computing device, according to embodiments of the present disclosure.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><p id="p-0011" num="0010">To facilitate understanding, identical reference numerals have been used, where possible, to designate identical elements that are common to the figures. It is contemplated that elements disclosed in one embodiment may be beneficially used in other embodiments without specific recitation.</p><heading id="h-0004" level="1">DESCRIPTION OF EXAMPLE EMBODIMENTS</heading><heading id="h-0005" level="2">Overview</heading><p id="p-0012" num="0011">One embodiment presented in this disclosure is a method, comprising: receiving, with a request for access to a wireless network offering at least a two different service levels based on user identities, a set of user credentials from a User Equipment (UE); forwarding, for authentication, the set of user credentials to an identity provider in an identity federation with the wireless network, wherein the identity provider is independent from the wireless network; in response to determining that the set of user credentials indicate a realm known to be associated with a given service level, providing network access to the UE according to the given service level; and in response to determining that the given service level is not a highest service level in the wireless network, transmitting a list of preferred realms to the UE that are associated with higher service levels than the given service level.</p><p id="p-0013" num="0012">One embodiment presented in this disclosure is a method, comprising: transmitting, from a User Equipment (UE) to an Access Point (AP) in a wireless network offering at least a two different service levels based on user identities, an access request that includes a first set of user credentials including a first realm; gaining network access to the wireless network according to a first service level associated with the first realm; receiving, at the UE from the AP, a list of preferred realms that are associated with higher service levels than the first realm; and transmitting, from the UE to the AP, a second set of user credentials including a second realm while accessing the wireless network according to the first service level associated with the first realm.</p><p id="p-0014" num="0013">One embodiment presented in this disclosure is a system, comprising: a processor; a memory storing instructions that when executed by the processor enable the processor to perform operations comprising: receiving, with a request for access to a wireless network offering at least a two different service levels based on user identities, a set of user credentials from a User Equipment (UE); forwarding, for authentication, the set of user credentials to an identity provider in an identity federation with the wireless network, wherein the identity provider is independent from the wireless network; in response to determining that the set of user credentials indicate a realm known to be associated with a given service level, providing network access to the UE according to the given service level; and in response to determining that the given service level is not a highest service level in the wireless network, transmitting a list of preferred realms to the UE that are associated with higher service levels than the given service level.</p><heading id="h-0006" level="1">Example Embodiments</heading><p id="p-0015" num="0014">The present disclosure provides for differentiated service in a federation-based access network to manage several valid identities for a user seeking to gain access to a network or network-provided service. The herein described differentiated services offer several service levels to different users of the same service (e.g., a wireless network). For example, a single differentiated access network can offer differentiated service such that a first user may be given highest priority access to unlimited bandwidth and access to the full internet, while a second user may be given medium priority access to limited bandwidth (deferring to the first user) and access to a first list of approved internet address, while a third user may be given lowest priority access to congested bandwidth (deferring to the first and second users) and access to a second list of approved internet address (smaller than the first list).</p><p id="p-0016" num="0015">The differentiated access service can determine what service level to provide to a given user based on the identity of that user, but when using an identity federation to identify a given user, rather than a credentialing service internal to or controlled by the service, a given user can have multiple identities to choose from to gain access to service, which the service can associate with different service levels. The user typically supplies a single identity to gain access to the service when using federated identities, and may not know which identity will give the best service level for access. Moreover, the realm through which the user is identified may be unknown to the service provider, and the service provider may thus provide the user with an incorrect service level. To account for these unknowns, the present disclosure provides improvements to the credentialing and onboarding process for a federated service to allow for a highest service level available to a given user to be provided to that user.</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates a network environment <b>100</b> that supports differentiated service in a federation-based access network, according to embodiments of the present disclosure. In <figref idref="DRAWINGS">FIG. <b>1</b></figref>, a UE <b>110</b> seeks to gain access to a wireless network <b>120</b>, such as a cellular or Wi-Fi based wireless network offered to users in a public or private venue. The service provider can deploy the wireless network via one or more Access Points (APs) <b>130</b><i>a</i>-<i>b </i>(generally or collectively, AP <b>130</b>), and set various controls on the wireless network <b>120</b> to confirm the authenticity of an identity of the user (via the UE <b>110</b>) for permitting access of the appropriate service level. In various embodiments, the wireless network <b>120</b> includes a network controller <b>160</b> that is in communication with the APs <b>130</b> to coordinate network management among the APs <b>130</b>, although the APs <b>130</b> can also manage the network among themselves, thus omitting the network controller <b>160</b> in some embodiments.</p><p id="p-0018" num="0017">The UE <b>110</b> may include any computing device that is configured to wirelessly connect to one or more APs <b>130</b>. Example UE <b>110</b> can include, but are not limited to: smart phones, feature phones, tablet computers, laptop computers, desktop computers, Internet of Things (IoT) devices, and the like. In various embodiments, the UE <b>110</b> can also be referred to as a station (STA), a client device (CD), or an endpoint. Example hardware as may be included in a UE <b>110</b> is discussed in greater detail in regard to <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0019" num="0018">The APs <b>130</b> can offer wireless communication sessions in the wireless network <b>120</b> according to various Radio Access Technologies and communications standards such as, but not limited to, &#x201c;Wi-Fi&#x201d; networking according to the various families, sub-standards, and derivatives of the IEEE 802.11 standard, cellular networking including various generations and subtypes thereof, such as, Long Term Evolution (LTE) and Fifth Generation New Radio (5G NR)) networks, Citizens Broadband Radio Service (CBRS) networks, or the like. Example hardware as may be included in an AP <b>130</b> is discussed in greater detail in regard to <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0020" num="0019">The network controller <b>160</b>, if included, may include any computing device or cloud based service that is configured to interface with two or more APs <b>130</b> to coordinate how spectrum is shared in the environment <b>100</b>. The network controller <b>160</b> can be provided on a separate computing device connected to the individual APs <b>130</b> via wired or wireless communications, may be included with a &#x201c;central&#x201d; or &#x201c;commander&#x201d; AP <b>130</b>, or may be provided in an ad hoc arrangement via a collective of two or more APs <b>130</b> negotiating among themselves for network management. Example hardware as may be included in a network controller <b>160</b> is discussed in greater detail in regard to <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0021" num="0020">When a UE <b>110</b> attempts to gain access to the wireless network <b>120</b> and associate with an AP <b>130</b>, the network provider may request that the UE <b>110</b> provide an identity for the user so that services can be tracked and allocated properly to the UE <b>110</b>. In various embodiments, the UE <b>110</b> can authenticate directly with the wireless network <b>120</b> (e.g., using an identity and credentials set up with the network provider) or can use an externally verified identity that is confirmed via one or more identity providers <b>140</b><i>a</i>-<i>b </i>(generally or collectively, identity provider <b>140</b>). When a service provider (e.g., the network provider) allows for the use of a third-party identity provider <b>140</b> (also referred to as an IdP) to gain access to the provider's service (e.g., the wireless network <b>120</b>), the service provider is said to offer a federated service or participate in an identity federation.</p><p id="p-0022" num="0021">The identity providers <b>140</b> are entities that users can create and manage various identities through which the network provider may delegate authentication function to. For example, the user can register with an identity provider <b>140</b> of a social network to gain access to the wireless network <b>120</b> by authenticating with the social network, which in turn, vouches for the authenticity and identity of the user to the network provider. Accordingly, the network provider, as a service provider, can avoid the need to set up individual accounts for each user attempting to gain access to the wireless network <b>120</b>, and instead rely on one or more trusted identity providers <b>140</b> to verify the identity of the requesting users. In various embodiments, the services of an identity provider <b>140</b> can be an on-premises authentication service shared by several service providers in the wireless network <b>120</b> or an off-premises authentication service used by several service providers offering one or several wireless networks <b>120</b>. Example hardware as may be included in a server providing the services of an identity provider <b>140</b> is discussed in greater detail in regard to <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0023" num="0022">Once authenticated by the identity provider <b>140</b>, the wireless network <b>120</b> grants access to the UE <b>110</b> based on the supplied credentials. In various embodiments, the authentication process can include the provision of a user name and associated with a given realm or domain (e.g., username at roaming.example.com, username at identities.example.co.uk), a password, authentication details (e.g., an answer to a security question), multifactor authentication confirmation, and the like. To confirm relations between supplied realms and known realms, the wireless network <b>120</b> may be in communication with a realm lookup server <b>170</b> (e.g., the domain name registration data service provided by the Internet Corporation for Assigned Names and Numbers (ICANN)) that indicates cross-relations or co-management of multiple differently named realms or domains by a shared party (e.g., when entity A is the registrant for both realm X and realm Y).</p><p id="p-0024" num="0023">For example, the realm of roaming.example.com may be managed by the same entity as the realm of identities.example.co.uk, and the realm lookup server <b>170</b> identifies to the provider that sets of credentials authenticated by each of the differently named realms should be treated as belonging to the same realm. Stated differently, if the wireless network <b>120</b> provides access at service level A to users authenticated by roaming.example.com, the wireless network <b>120</b> should also provide access at service level A when a user is authenticated in the realm of identities.example.co.uk. Example hardware as may be included in a server providing the services of a realm lookup server <b>170</b> is discussed in greater detail in regard to <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0025" num="0024">In various embodiments, the service level of access granted to the user is based on an agreement negotiated between the provider of the wireless network <b>120</b> and the identity provider <b>140</b> or another partner <b>150</b> for related parties. For example, a hotel chain may be a partner <b>150</b> that offers users expanded Wi-Fi privileges at a nearby stadium (as a service provider of a wireless network <b>120</b>) when the users identify themselves via a social media platform (as an identity assigned by the identity provider <b>140</b>) to the service provider. In another example, a first hotel chain may wish to offer different levels of service in its wireless network <b>120</b> to users connecting with a loyalty-program identity versus non-loyalty-based identifiers can access a loyalty program service offered by a partner <b>150</b> to identify users who are loyalty program members. Example hardware that may be included in a server providing the services of a partner <b>150</b> is discussed in greater detail in regard to <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0026" num="0025">However, when offering differentiated services based on different identities, the service provider may indicate to the UE <b>110</b> that an additional or different set of identity credentials can be provided by the UE <b>110</b> to receive a different or higher service level for access to the wireless network <b>120</b>. A wireless network <b>120</b> can provide various benefits to the &#x201c;higher&#x201d; service levels that are not provided to the &#x201c;lower&#x201d; service levels. These benefits include, but are not limited to faster uplink/downlink speeds (including higher rates of assignment for bandwidth or resource units being competed for), higher data caps, channels associated with lower interference levels, access to more websites/services, permission to use more communications standards or protocols (e.g., streaming, file transfer protocol (FTP), etc.), complementary or &#x201c;pre-paid&#x201d; access, higher permitted uplink and downlink transmission powers, greater or different security policies (e.g., firewall services, virus scanning, Virtual Private Network (VPN) services, etc.), and the like. In various embodiments, the service provider can also investigate whether the provided credentials are associated with a realm or domain associated with a different or higher service level for access to the wireless network <b>120</b> than is initially known to the service provider.</p><p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a flowchart of a method <b>200</b> for providing improved differentiated service in a federation-based network, according to embodiments of the present disclosure. Method <b>200</b> begins at block <b>210</b>, where an AP <b>130</b> receives an access request from a UE <b>110</b> for a networking service (e.g., a wireless network <b>120</b>) that offers multiple levels of service to different classes of users. The access request includes a set of user credentials supplied by the UE <b>110</b>, which can include a username associated with a realm (or domain), an indication of what identity provider <b>140</b> to use for authentication, a password, or additional identity-confirming details.</p><p id="p-0028" num="0027">At block <b>220</b>, the AP <b>130</b> forwards the credentials to an identity provider <b>140</b> that participates in an identity federation with the wireless network <b>120</b>. The identity provider <b>140</b> is independently controlled from the wireless network <b>120</b>, and authenticates the identity of the user on behalf of the wireless network <b>120</b>. In various embodiments, the identity provider <b>140</b> may send a multifactor authentication message to the UE <b>110</b> or a secondary device associated with the UE <b>110</b> as part of authenticating the user.</p><p id="p-0029" num="0028">At block <b>230</b>, the AP <b>130</b> (or a network controller <b>160</b> associated with the AP <b>130</b>), determines whether the realm supplied by the UE <b>110</b> (e.g., per block <b>210</b>) or a related realm to that supplied by the UE <b>110</b> (e.g., identified per block <b>250</b>) matches a known realm that is associated with a given service level. In various embodiments, the wireless network <b>120</b> may set different service levels for users who are authenticated with different identity providers <b>140</b>, but may also associated a given realm or domain based on a partnership agreement with a partner <b>150</b> that is independent from the identity provider <b>140</b> and the wireless network <b>120</b>. When the credentials include a known realm, method <b>200</b> proceeds to block <b>270</b>. When the credentials do not include a known realm, method <b>200</b> proceeds to block <b>240</b>.</p><p id="p-0030" num="0029">At block <b>240</b>, in response to determining that a known realm has not yet been identified, the AP <b>130</b> (or the network controller <b>160</b>) sends a whois query to a realm lookup server <b>170</b> to identify whether any related realms exist for the supplied realm (e.g., supplier per block <b>210</b>).</p><p id="p-0031" num="0030">At block <b>250</b>, in response to receiving a response to the whois query from the realm lookup server <b>170</b>, the AP <b>130</b> (or a network controller <b>160</b>) determines whether the realm lookup server <b>170</b> identified a new related realm or a response to the whois query that indicates that no related realms could be discovered. When a new related realm is identified, method <b>200</b> returns to block <b>230</b> to determine whether the related realm is associated with a known level of service. When a new related realm is not identified, method <b>200</b> proceeds to block <b>260</b> to provide the baseline service level for access to the service for the realm initially supplied in block <b>210</b>.</p><p id="p-0032" num="0031">At block <b>260</b>, the AP <b>130</b> provides baseline access for the service to the user (via the associated UE <b>110</b>). In various embodiments, baseline access is a lowest service level of permitted access to the service, and may be provided to the UE <b>110</b> by the AP <b>130</b> while awaiting authentication of the user from an identity provider <b>140</b> (e.g., to users who are not yet unauthenticated) or authenticated with an unknown realm. By granting access before authentication is complete, the wireless network <b>120</b> can begin onboarding the UE <b>110</b> to the wireless network <b>120</b> sooner (e.g., preparing for load balancing), while also protecting access to bandwidth, and restricting access to various services to preserve service levels for other users who are already fully authenticated.</p><p id="p-0033" num="0032">For example, while authenticating users, a restaurant (as a service provider for a WiFi-based wireless network <b>120</b>) may provide all potential users with a baseline access level that restricts access to a subset of approved websites and services (e.g., to login to a reservations website, to visit website for menu information, to indicate when a table becomes available). In addition to or instead of using a restricted access list (which may positively recite blocked or permitted services/websites), the baseline access may also be provided with a lower data throughput rate than other higher service levels offered in the differentiated service, with greater deference to other users (when competing for limited bandwidth) who are connected at higher service levels, may be restricted to certain wireless communications channels (e.g., channels with lower interference levels being reserved for higher service levels), restricted to certain uplink or downlink transmission power, or may be otherwise restricted relative to the higher service levels offered in the wireless network <b>120</b>.</p><p id="p-0034" num="0033">At block <b>270</b>, in response to determining that the set of user credentials (provided per block <b>210</b> an potentially supplemented per block <b>250</b>) indicate a realm known to be associated with a given service level, the AP <b>130</b> provides network access to the UE <b>110</b> according to the given service level. The provider of the wireless network <b>120</b> determines (at the AP <b>130</b> or a network controller <b>160</b>) the appropriate service level to provide to the UE <b>110</b>, and may do so without input from the identity provider <b>140</b> used to authenticate the user.</p><p id="p-0035" num="0034">In various embodiments, the various service levels offered in the wireless network <b>120</b> are based on the identity of the user and the realm in which the identity is based. For example, a user may be identifiable via a social media account, a work-related account, and a travel agency account, which act as separate identity providers <b>140</b> or partners <b>150</b> with the wireless network <b>120</b> to provide more than a baseline level of access to the wireless network <b>120</b>. Accordingly, a provider can set different service levels when the user is identified through the social media account versus through the work-related account or travel agency account. These different service levels may be the result of the provider placing greater emphasis on certain logins (e.g., a hotel may prioritize business-class users over holiday travels, and thus give higher service to logins performed with work-related accounts versus social media accounts or travel agency accounts) or the result of an agreement in place with a partner <b>150</b> (e.g., a hotel prioritizing travel-agency account users over social-media or business-class users to honor the agreement).</p><p id="p-0036" num="0035">Additionally, the service level provider to the user may be based on the identity or class of the user within the realm. For example, the wireless network <b>120</b> at an airport may provide higher service levels to &#x201c;Gold Level&#x201d; frequent fliers versus &#x201c;Bronze Level&#x201d; frequent fliers of the several airlines' frequent flier programs that base flights out of the airport.</p><p id="p-0037" num="0036">At block <b>280</b>, the AP <b>130</b> determines whether the service level provided to the UE <b>110</b> is a highest service level offered in the wireless network <b>120</b>. When a higher service level than the currently-provided service level is available, method <b>200</b> proceeds to block <b>290</b>. Otherwise, when the currently-provided service level is the highest service level available, method <b>200</b> may conclude.</p><p id="p-0038" num="0037">At block <b>290</b>, the AP <b>130</b> transmits a list of preferred realms to the user (via the UE <b>110</b>) that are associated with service levels associated with higher service levels than the currently-provided service level. In various embodiments, the AP <b>130</b> provides a cultivated list with a subset of realms associated with the next-highest service level, or a subset of the realms associated with the highest service level. In various embodiments, the UE <b>110</b> can respond with a second set of user credentials (returning method <b>200</b> to block <b>210</b>) with a different realm to attempt to gain access at the higher service level to the wireless network <b>120</b>.</p><p id="p-0039" num="0038">In various embodiments, as described in greater detail in regard to <figref idref="DRAWINGS">FIG. <b>3</b></figref>, when the UE <b>110</b> responds to the provided list of preferred realms with a second set of user credentials, the second set of credentials may include a realm from the preferred list or a realm not included on the list. Thus, method <b>200</b> may return to block <b>210</b> for further analysis of the appropriate service level for the subsequent realm. Depending on whether the newly supplied credentials indicate a higher or lower service level (or are associated with a baseline service level), the AP <b>130</b> (and network controller <b>160</b>) can provide the service level of the higher of the current or last-provided service level or the service level provided according to the most recently authenticated realm. For example, if the AP <b>130</b> provides a UE <b>110</b> with service level B with a preferred list of realms to receive service level A, but the UE <b>110</b> responds with a new realm associated with service level C, the AP <b>130</b> can continue providing service at service level B or switch to providing service at the lower service level C.</p><p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a flowchart of a method <b>300</b> for improving a service level of differentiated service in a federation-based network, according to embodiments of the present disclosure. Method <b>300</b> begins at block <b>310</b>, where a UE <b>110</b> transmits an access request to an AP <b>130</b> to gain access to a wireless network <b>120</b> that offers multiple different service levels. In various embodiments, the UE <b>110</b> (and the user thereof) may be unaware that the wireless network <b>120</b> offers differentiated service according to the identity supplied to the wireless network <b>120</b>, and may provide any set of credentials associated with an identity provider <b>140</b> that supports the wireless network <b>120</b> to thereby gain access to the wireless network <b>120</b>.</p><p id="p-0041" num="0040">At block <b>320</b>, the UE <b>110</b> gains access to the services of the wireless network <b>120</b> according to the service level associated with the identity provided per block <b>310</b>. In various embodiments, the UE <b>110</b> gains access to a baseline, or lowest, service level offered by the wireless network <b>120</b> while authentication (including multifactor authentication) is performed. For example, when supplying an identity associated with service level C in the wireless network <b>120</b>, the UE <b>110</b> is provided with network access at the baseline level of service level D (where C&#x3e;D) until a positive confirmation of the identity is made via multifactor authentication. By gaining access before authentication is complete, the UE <b>110</b> can begin onboarding to the wireless network <b>120</b> sooner, while the provider can still protect access to bandwidth, restrict access to various services, and begin accounting for a new device (e.g., for load balancing purposes).</p><p id="p-0042" num="0041">At block <b>330</b>, in response to the provided identity being associated with a service level other than the highest service level offered by the wireless network <b>120</b>, the UE <b>110</b> receives a list of preferred realms from the AP <b>130</b>. In various embodiments, the list may indicate the some or all of the realms associated with higher service levels. Depending on the number of realms and number of attempts to authenticate with different identities, the UE <b>110</b> may receive lists of preferred realms with more or fewer entries and with different curated selections of the preferred realms. For example, the AP <b>130</b> can provide a cultivated list with a subset of realms associated with the next-highest service level so that a UE <b>110</b> initially provided with service level C access is provided with a list of preferred realms associated with priority level B (before or instead of being provided with realms associated with level A, where A&#x3e;B&#x3e;C). In another example, the AP <b>130</b> provides the UE <b>110</b> with a list of the preferred realms of the highest priority so that a UE <b>110</b> initially provided with service level C access is provided with a list of preferred realms associated with priority level A (before or instead of being provided with realms associated with level B, where A&#x3e;B&#x3e;C).</p><p id="p-0043" num="0042">In various embodiments, the UE <b>110</b> can retain the list of preferred realms for use in subsequent access requests to the wireless network <b>120</b>. For example, a user who visits a venue that provides a wireless network <b>120</b> on separate dates can initially request access to the wireless network <b>120</b> without knowledge of which identities are associated with the highest levels of service. If the user initially supplied a non-preferred identity (associated with a lower service level), the UE <b>110</b> will have received a list of preferred realms at the initial visit. However, on a subsequent visit to the venue, the UE <b>110</b> may retain the list of preferred realms so that a subsequent access request uses an identity associated with the highest available service level for the user. Accordingly, if a UE <b>110</b> initially gains access to the wireless network <b>120</b> with a preferred identity (associated with a highest service level), the UE <b>110</b> will not have received a list of preferred realms. A UE <b>110</b> configured to operate with differentiated networks can therefore recommend to the user re-supplying the preferred identity on a subsequent access request.</p><p id="p-0044" num="0043">At block <b>340</b>, in response to receiving a list of preferred realms, the UE <b>110</b> determines whether a second set of credentials that match one of the preferred realms are to be transmitted to the AP <b>130</b> to request a higher service level in the wireless network <b>120</b>. In various embodiments, the UE <b>110</b> can present the user with a prompt (e.g., in a graphical user interface) to identify one or more realms that the user could authenticate through to receive a higher service level. Depending on the user's response to the prompt, the UE <b>110</b> determines whether to supply a second set of credentials to the AP <b>130</b> to request access at a higher service level, or to maintain the current level of service with the wireless network <b>120</b>. In other embodiments, the UE <b>110</b> can automatically identify whether to request access at a higher service level based on stored access credentials previously provided on the UE <b>110</b>. For example, when a user has stored identity information and password data on the UE <b>110</b>, the UE <b>110</b> can compare the identity information to the preferred identities and determines to provide a second set of credentials to the AP <b>130</b> when a match is discovered.</p><p id="p-0045" num="0044">When the UE <b>110</b> determines (automatically or via user command) to supply a second set of credentials to the AP <b>130</b>, method <b>300</b> returns to block <b>310</b> to request access using the new credentials. When the UE <b>110</b> determines to maintain access at the current service level (e.g., due to no matches to the preferred list or a lock of user approval), method <b>300</b> may conclude.</p><p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a timing diagram for providing differentiated service in a wireless network <b>120</b>, according to embodiments of the present disclosure. In <figref idref="DRAWINGS">FIG. <b>4</b></figref>, a UE <b>110</b> sends an access request <b>410</b> to an AP <b>130</b> in the wireless network <b>120</b>, which forwards the supplied credentials to an identity provider <b>140</b>.</p><p id="p-0047" num="0046">The identity provider <b>140</b>, in turn, based on the supplied credentials, returns an authorization response <b>440</b> to the AP <b>130</b> (in some embodiments via a network controller <b>160</b>) indicating whether the user is authenticated. In various embodiments, the authentication can be based on the supplied credentials matching known values stored at the identity provider <b>140</b>, and may include additional steps, such as a multifactor authentication or additional security questions. Although not illustrated, multifactor queries and responses can be sent between the identity provider <b>140</b> (or a third party authenticator in communication with the identity provider <b>140</b>) and the UE <b>110</b> or another device associated with the UE <b>110</b> (and nominally in the user's possession) to confirm that the access request was generated by the user. In various embodiments, the identity provider <b>140</b> can forward acceptance or rejection of the multifactor response to the wireless network <b>120</b> separately from or included in the authorization response <b>440</b>.</p><p id="p-0048" num="0047">In various embodiments, in the time between receiving the access request <b>410</b> from the UE <b>110</b> and the authorization response <b>440</b> from the identity provider <b>140</b>, the AP <b>130</b> provides (and the UE <b>110</b> receives) access to the wireless network <b>120</b> according to a baseline service <b>430</b>. The baseline service <b>430</b> can include uplink transmissions from the UE <b>110</b> to the AP <b>130</b> and downline transmissions from the AP <b>130</b> to the UE <b>110</b> for a curated set of network resources (e.g., only to permitted services) and may be used to transfer data in anticipation for full onboarding to the wireless network <b>120</b> (e.g., for load balancing purposes).</p><p id="p-0049" num="0048">Once the AP <b>130</b> (or the network controller <b>160</b>) receives the authorization response <b>440</b> from the identity provider <b>140</b>, the AP <b>130</b> provides (and the UE <b>110</b> receives) differentiated service <b>450</b> based on the identity used to gain access to the wireless network <b>120</b>. In various embodiments, when the authorization response <b>440</b> indicates an authorization failure (e.g., when a password does not match a username, multifactor authentication fails, etc.) the AP <b>130</b> terminates service to the UE <b>110</b>. In various embodiments, the differentiated service <b>450</b> may be the same as or different from the baseline service <b>430</b> depending on the policies of the wireless network <b>120</b> in relation to the realm of the supplied identity</p><p id="p-0050" num="0049">In various embodiments, when the differentiated service <b>450</b> is provided at a lower service level than the highest service level offered in the wireless network <b>120</b>, the AP <b>130</b> transmits preferred realms list <b>460</b> to the UE <b>110</b>. The preferred realms list <b>460</b> can identify one or more realms that are associated with higher service levels in the wireless network <b>120</b> than the currently provided service level in the differentiated service <b>450</b>. The UE <b>110</b>, on behalf of the user, can transmits a subsequent access request <b>410</b> with a credential set associated with a different realm, including realms specifically recited in the preferred realms list <b>460</b> or realms not specifically recited in the preferred realms list <b>460</b> believed to be related to a specifically recited realm. In various embodiments, the AP <b>130</b> provides the preferred realms list <b>460</b> via an Access Network Query Protocol (ANQP) query/response choreography with the UE <b>110</b>.</p><p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a timing diagram for providing differentiated service in a wireless network <b>120</b>, according to embodiments of the present disclosure. The actions shown in <figref idref="DRAWINGS">FIG. <b>5</b></figref> may be performed in parallel to those shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref> for granting differentiated access to a wireless network <b>120</b>. In <figref idref="DRAWINGS">FIG. <b>5</b></figref>, a UE <b>110</b> sends an access request <b>410</b> to an AP <b>130</b> in the wireless network <b>120</b>, which forwards the supplied credentials to an identity provider <b>140</b>, as is shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>. However, when the supplied realm is unknown to the wireless network <b>120</b>, the AP <b>130</b> (or the network controller <b>160</b>) transmits a whois query <b>510</b> to a realm lookup server <b>170</b>.</p><p id="p-0052" num="0051">The realm lookup server <b>170</b> transmits a whois response <b>520</b> back to the AP <b>130</b> (or the network controller <b>160</b>), which can include fields such as the registrant contract name or organization for the unknown realm. The AP <b>130</b> (or the network controller <b>160</b>) compare the contents of the whois response <b>520</b> with similar fields for known realms to identify matches (e.g., related realms). For example, if the realm of &#x201c;remote.example.com&#x201d; and &#x201c;roaming.example.co.uk&#x201d; indicate a shared registrant, the two realms can be treated as being related, and are therefore associated with the same service level to provide in the wireless network <b>120</b>.</p><p id="p-0053" num="0052">After determining whether the supplied unknown realm is equivalent to a known realm, the AP <b>130</b> provides (and the UE <b>110</b> receives) differentiated service based on the identity (or the related realm thereto) used to gain access to the wireless network <b>120</b>.</p><p id="p-0054" num="0053">In various embodiments, in the time between receiving the access request <b>410</b> from the UE <b>110</b> and the whois response <b>520</b> from the identity provider <b>140</b>, the AP <b>130</b> provides (and the UE <b>110</b> receives) access to the wireless network <b>120</b> according to a baseline service <b>430</b>. The baseline service <b>430</b> can include uplink transmissions from the UE <b>110</b> to the AP <b>130</b> and downline transmissions from the AP <b>130</b> to the UE <b>110</b> for a curated set of network resources (e.g., only to permitted services) and may be used to transfer data in anticipation for full onboarding to the wireless network <b>120</b> (e.g., for load balancing purposes). In various embodiments, the differentiated service <b>450</b> may be the same as or different from the baseline service <b>430</b> depending on the policies of the wireless network <b>120</b> in relation to the realm of the supplied identity.</p><p id="p-0055" num="0054">In various embodiments, as is discussed in relation to <figref idref="DRAWINGS">FIG. <b>4</b></figref>, when the related realm is a not a preferred realm (e.g., associated with a highest service level in the wireless network <b>120</b>), the AP <b>130</b> transmits a preferred realms list <b>460</b> to the UE <b>110</b>. However, when the related realm is a preferred realm (despite the initially provided realm not being matched to a preferred realm), the AP <b>130</b> refrains from transmitting the preferred realms list <b>460</b>. Accordingly, in some embodiments, the AP <b>130</b> may delay sending the preferred realms list <b>460</b> until the whois response <b>520</b> is received.</p><p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. <b>6</b></figref> illustrates hardware of a computing device <b>600</b> such as can be included in a UE <b>110</b>, an AP <b>130</b>, a network controller <b>160</b>, or a server used to provide the services of an identity provider <b>140</b>, partner <b>150</b>, or realm lookup server <b>170</b> as described herein. The computing device <b>600</b> includes a processor <b>610</b>, a memory <b>620</b>, and communication interfaces <b>630</b>. The processor <b>610</b> may be any processing element capable of performing the functions described herein. The processor <b>610</b> represents a single processor, multiple processors, a processor with multiple cores, and combinations thereof. The communication interfaces <b>630</b> facilitate communications between the computing device <b>600</b> and other devices. The communication interfaces <b>630</b> are representative of wireless communications antennas (both omnidirectional and directional), various steering mechanisms for the antennas, and various wired communication ports including out-pins and in-pins to a microcontroller. The memory <b>620</b> may be either volatile or non-volatile memory and may include RAM, flash, cache, disk drives, and other computer readable memory storage devices. Although shown as a single entity, the memory <b>620</b> may be divided into different memory storage elements such as RAM and one or more hard disk drives.</p><p id="p-0057" num="0056">As shown, the memory <b>620</b> includes various instructions that are executable by the processor <b>610</b> to provide an operating system <b>621</b> to manage various functions of the computing device <b>600</b> and one or more applications <b>622</b> to provide various functionalities to users of the computing device <b>600</b>, which include one or more of the functions and functionalities described in the present disclosure.</p><p id="p-0058" num="0057">In the current disclosure, reference is made to various embodiments. However, the scope of the present disclosure is not limited to specific described embodiments. Instead, any combination of the described features and elements, whether related to different embodiments or not, is contemplated to implement and practice contemplated embodiments. Additionally, when elements of the embodiments are described in the form of &#x201c;at least one of A and B,&#x201d; it will be understood that embodiments including element A exclusively, including element B exclusively, and including element A and B are each contemplated. Furthermore, although some embodiments disclosed herein may achieve advantages over other possible solutions or over the prior art, whether or not a particular advantage is achieved by a given embodiment is not limiting of the scope of the present disclosure. Thus, the aspects, features, embodiments and advantages disclosed herein are merely illustrative and are not considered elements or limitations of the appended claims except where explicitly recited in a claim(s). Likewise, reference to &#x201c;the invention&#x201d; shall not be construed as a generalization of any inventive subject matter disclosed herein and shall not be considered to be an element or limitation of the appended claims except where explicitly recited in a claim(s).</p><p id="p-0059" num="0058">As will be appreciated by one skilled in the art, the embodiments disclosed herein may be embodied as a system, method or computer program product. Accordingly, embodiments may take the form of an entirely hardware embodiment, an entirely software embodiment (including firmware, resident software, micro-code, etc.) or an embodiment combining software and hardware aspects that may all generally be referred to herein as a &#x201c;circuit,&#x201d; &#x201c;module&#x201d; or &#x201c;system.&#x201d; Furthermore, embodiments may take the form of a computer program product embodied in one or more computer readable medium(s) having computer readable program code embodied thereon.</p><p id="p-0060" num="0059">Program code embodied on a computer readable medium may be transmitted using any appropriate medium, including but not limited to wireless, wireline, optical fiber cable, RF, etc., or any suitable combination of the foregoing.</p><p id="p-0061" num="0060">Computer program code for carrying out operations for embodiments of the present disclosure may be written in any combination of one or more programming languages, including an object oriented programming language such as Java, Smalltalk, C++ or the like and conventional procedural programming languages, such as the &#x201c;C&#x201d; programming language or similar programming languages. The program code may execute entirely on the user's computer, partly on the user's computer, as a stand-alone software package, partly on the user's computer and partly on a remote computer or entirely on the remote computer or server. In the latter scenario, the remote computer may be connected to the user's computer through any type of network, including a local area network (LAN) or a wide area network (WAN), or the connection may be made to an external computer (for example, through the Internet using an Internet Service Provider).</p><p id="p-0062" num="0061">Aspects of the present disclosure are described herein with reference to flowchart illustrations and/or block diagrams of methods, apparatuses (systems), and computer program products according to embodiments presented in this disclosure. It will be understood that each block of the flowchart illustrations and/or block diagrams, and combinations of blocks in the flowchart illustrations and/or block diagrams, can be implemented by computer program instructions. These computer program instructions may be provided to a processor of a general purpose computer, special purpose computer, or other programmable data processing apparatus to produce a machine, such that the instructions, which execute via the processor of the computer or other programmable data processing apparatus, create means for implementing the functions/acts specified in the block(s) of the flowchart illustrations and/or block diagrams.</p><p id="p-0063" num="0062">These computer program instructions may also be stored in a computer readable medium that can direct a computer, other programmable data processing apparatus, or other device to function in a particular manner, such that the instructions stored in the computer readable medium produce an article of manufacture including instructions which implement the function/act specified in the block(s) of the flowchart illustrations and/or block diagrams.</p><p id="p-0064" num="0063">The computer program instructions may also be loaded onto a computer, other programmable data processing apparatus, or other device to cause a series of operational steps to be performed on the computer, other programmable apparatus or other device to produce a computer implemented process such that the instructions which execute on the computer, other programmable data processing apparatus, or other device provide processes for implementing the functions/acts specified in the block(s) of the flowchart illustrations and/or block diagrams.</p><p id="p-0065" num="0064">The flowchart illustrations and block diagrams in the Figures illustrate the architecture, functionality, and operation of possible implementations of systems, methods, and computer program products according to various embodiments. In this regard, each block in the flowchart illustrations or block diagrams may represent a module, segment, or portion of code, which comprises one or more executable instructions for implementing the specified logical function(s). It should also be noted that, in some alternative implementations, the functions noted in the block may occur out of the order noted in the Figures. For example, two blocks shown in succession may, in fact, be executed substantially concurrently, or the blocks may sometimes be executed in the reverse order, depending upon the functionality involved. It will also be noted that each block of the block diagrams and/or flowchart illustrations, and combinations of blocks in the block diagrams and/or flowchart illustrations, can be implemented by special purpose hardware-based systems that perform the specified functions or acts, or combinations of special purpose hardware and computer instructions.</p><p id="p-0066" num="0065">In view of the foregoing, the scope of the present disclosure is determined by the claims that follow.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>We claim:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A method, comprising:<claim-text>receiving, with a request for access to a wireless network offering at least a two different service levels based on user identities, a set of user credentials from a User Equipment (UE);</claim-text><claim-text>forwarding, for authentication, the set of user credentials to an identity provider in an identity federation with the wireless network, wherein the identity provider is independent from the wireless network;</claim-text><claim-text>in response to determining that the set of user credentials indicate a realm known to be associated with a given service level, providing network access to the UE according to the given service level; and</claim-text><claim-text>in response to determining that the given service level is not a highest service level in the wireless network, transmitting a list of preferred realms to the UE that are associated with higher service levels than the given service level.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>receiving a second set of user credentials from the UE; and</claim-text><claim-text>in response to determining that the second set of user credentials are not associated with a given realm known to be associated with a particular service level, sending a query to a realm lookup server to identify additional realms associated with the given realm indicated in the second set of user credentials.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising:<claim-text>in response to determining that the query has identified at least one additional realm associated with a known realm associated with a known service level, providing network access to the UE according to a higher of the given service level and the known service level.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising:<claim-text>in response to determining that the query has not identified at least one additional realm associated with a known realm associated with a known service level, providing network access to the UE according to a higher of the given service level and a baseline service level for the wireless network.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the query identifies related realms to the given realm indicated in the second set of user credentials based on registration data for the related realms indicating a shared entity with registration data for the given realm.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>providing network access to the UE according to a baseline service level, while awaiting confirmation of the set of user credentials via multifactor authentication.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, further comprising:<claim-text>in response to detecting failure of the multifactor authentication, terminating network access to the UE.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the wireless network associates the given service level with the realm based on a partnership agreement with a partner that is independent from the identity provider and the wireless network.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. A method, comprising:<claim-text>transmitting, from a User Equipment (UE) to an Access Point (AP) in a wireless network offering at least a two different service levels based on user identities, an access request that includes a first set of user credentials including a first realm;</claim-text><claim-text>gaining network access to the wireless network according to a first service level associated with the first realm;</claim-text><claim-text>receiving, at the UE from the AP, a list of preferred realms that are associated with higher service levels than the first realm; and</claim-text><claim-text>transmitting, from the UE to the AP, a second set of user credentials including a second realm while accessing the wireless network according to the first service level associated with the first realm.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the second realm is not included in the list of preferred realms, wherein the UE identifies that the second realm is a related realm to at least one realm included in the list of preferred realms.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the first realm is unknown to the wireless network, wherein the list of preferred realms that are associated with higher service levels than the first realm is received in response to the AP identifying that the first realm is not related to any realm included in the list of preferred realms.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising:<claim-text>receiving, at the AP, a multifactor authentication query associated with the first set of user credentials;</claim-text><claim-text>transmitting, from the UE, a multifactor authentication response to an identity provider;</claim-text><claim-text>accessing the wireless network according to a baseline service level before the identity provider indicates acceptance of the multifactor authentication response to the wireless network; and</claim-text><claim-text>wherein gaining access to the wireless network according the first service level is performed in response to the wireless network accepting the multifactor authentication response from the identity provider.</claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. A system, comprising:<claim-text>a processor;</claim-text><claim-text>a memory storing instructions that when executed by the processor enable the processor to perform operations comprising:<claim-text>receiving, with a request for access to a wireless network offering at least a two different service levels based on user identities, a set of user credentials from a User Equipment (UE);</claim-text><claim-text>forwarding, for authentication, the set of user credentials to an identity provider in an identity federation with the wireless network, wherein the identity provider is independent from the wireless network;</claim-text><claim-text>in response to determining that the set of user credentials indicate a realm known to be associated with a given service level, providing network access to the UE according to the given service level; and</claim-text><claim-text>in response to determining that the given service level is not a highest service level in the wireless network, transmitting a list of preferred realms to the UE that are associated with higher service levels than the given service level.</claim-text></claim-text></claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The system of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the operations further comprise:<claim-text>receiving a second set of user credentials from the UE; and</claim-text><claim-text>in response to determining that the second set of user credentials are not associated with a given realm known to be associated with a particular service level, sending a whois query to a realm lookup server to identify additional realms associated with the given realm indicated in the second set of user credentials.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the operations further comprise:<claim-text>in response to determining that the whois query has identified at least one additional realm associated with a known realm associated with a known service level, providing network access to the UE according to a higher of the given service level and the known service level.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the operations further comprise:<claim-text>in response to determining that the whois query has not identified at least one additional realm associated with a known realm associated with a known service level, providing network access to the UE according to a higher of the given service level and a baseline service level for the wireless network.</claim-text></claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the whois query identifies related realms to the given realm indicated in the second set of user credentials based on registration data for the related realms indicating a shared entity with registration data for the given realm.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The system of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the operations further comprise:<claim-text>providing network access to the UE according to a baseline service level, while awaiting confirmation of the set of user credentials via multifactor authentication.</claim-text></claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The system of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein the operations further comprise:<claim-text>in response to detecting failure of the multifactor authentication, terminating network access to the UE.</claim-text></claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The system of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the wireless network associates the given service level with the realm based on a partnership agreement with a partner that is independent from the identity provider and the wireless network.</claim-text></claim></claims></us-patent-application>