<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230006818A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230006818</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17773958</doc-number><date>20201106</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>JP</country><doc-number>2019-210539</doc-number><date>20191121</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>9</main-group><subgroup>08</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>9</main-group><subgroup>06</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>9</main-group><subgroup>0825</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>9</main-group><subgroup>0822</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>9</main-group><subgroup>0618</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">FILE PROCESSING DEVICE AND FILE PROCESSING METHOD</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Sony Group Corporation</orgname><address><city>Tokyo</city><country>JP</country></address></addressbook><residence><country>JP</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Jinnouchi</last-name><first-name>Ryo</first-name><address><city>Kanagawa</city><country>JP</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Ito</last-name><first-name>Ryogo</first-name><address><city>Tokyo</city><country>JP</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Funamoto</last-name><first-name>Daisuke</first-name><address><city>Tokyo</city><country>JP</country></address></addressbook></inventor></inventors></us-parties><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/JP2020/041495</doc-number><date>20201106</date></document-id><us-371c12-date><date>20220503</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">The present technology relates to a file processing device and a file processing method for enabling restriction of viewing of an image.</p><p id="p-0002" num="0000">A file control unit generates a file that stores an encrypted image obtained by encrypting an image with a first encryption key, and an encrypted encryption key obtained by encrypting the first encryption key with a second encryption key, the encrypted image and the encrypted encryption key being associated with each other in the file. The file control unit also decrypts the encrypted encryption key in the file into the first encryption key, and, with the first encryption key obtained by the decryption, decrypts the encrypted image into the image. The present technology can be applied to a digital camera and the like that capture images, for example.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="99.99mm" wi="158.75mm" file="US20230006818A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="227.33mm" wi="154.52mm" orientation="landscape" file="US20230006818A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="227.67mm" wi="99.31mm" file="US20230006818A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="229.62mm" wi="141.73mm" file="US20230006818A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="127.68mm" wi="129.12mm" file="US20230006818A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="187.71mm" wi="85.01mm" orientation="landscape" file="US20230006818A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="215.22mm" wi="154.69mm" orientation="landscape" file="US20230006818A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="215.22mm" wi="156.29mm" orientation="landscape" file="US20230006818A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="215.22mm" wi="154.69mm" orientation="landscape" file="US20230006818A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="215.14mm" wi="154.69mm" orientation="landscape" file="US20230006818A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="214.04mm" wi="125.90mm" orientation="landscape" file="US20230006818A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="214.04mm" wi="125.90mm" orientation="landscape" file="US20230006818A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="234.27mm" wi="134.11mm" file="US20230006818A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00013" num="00013"><img id="EMI-D00013" he="226.57mm" wi="134.11mm" file="US20230006818A1-20230105-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00014" num="00014"><img id="EMI-D00014" he="213.95mm" wi="134.11mm" file="US20230006818A1-20230105-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00015" num="00015"><img id="EMI-D00015" he="98.13mm" wi="130.22mm" file="US20230006818A1-20230105-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00016" num="00016"><img id="EMI-D00016" he="188.81mm" wi="134.11mm" file="US20230006818A1-20230105-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00017" num="00017"><img id="EMI-D00017" he="167.64mm" wi="130.22mm" file="US20230006818A1-20230105-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00018" num="00018"><img id="EMI-D00018" he="232.66mm" wi="130.22mm" file="US20230006818A1-20230105-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00019" num="00019"><img id="EMI-D00019" he="144.27mm" wi="130.22mm" file="US20230006818A1-20230105-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00020" num="00020"><img id="EMI-D00020" he="176.02mm" wi="142.16mm" orientation="landscape" file="US20230006818A1-20230105-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00021" num="00021"><img id="EMI-D00021" he="193.46mm" wi="136.40mm" orientation="landscape" file="US20230006818A1-20230105-D00021.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00022" num="00022"><img id="EMI-D00022" he="215.48mm" wi="138.68mm" orientation="landscape" file="US20230006818A1-20230105-D00022.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00023" num="00023"><img id="EMI-D00023" he="233.43mm" wi="133.18mm" orientation="landscape" file="US20230006818A1-20230105-D00023.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00024" num="00024"><img id="EMI-D00024" he="186.44mm" wi="78.06mm" orientation="landscape" file="US20230006818A1-20230105-D00024.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00025" num="00025"><img id="EMI-D00025" he="235.03mm" wi="151.21mm" orientation="landscape" file="US20230006818A1-20230105-D00025.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00026" num="00026"><img id="EMI-D00026" he="235.03mm" wi="151.21mm" orientation="landscape" file="US20230006818A1-20230105-D00026.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00027" num="00027"><img id="EMI-D00027" he="237.07mm" wi="137.92mm" orientation="landscape" file="US20230006818A1-20230105-D00027.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00028" num="00028"><img id="EMI-D00028" he="237.07mm" wi="137.92mm" orientation="landscape" file="US20230006818A1-20230105-D00028.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00029" num="00029"><img id="EMI-D00029" he="237.07mm" wi="137.92mm" orientation="landscape" file="US20230006818A1-20230105-D00029.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00030" num="00030"><img id="EMI-D00030" he="237.07mm" wi="137.92mm" orientation="landscape" file="US20230006818A1-20230105-D00030.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00031" num="00031"><img id="EMI-D00031" he="114.89mm" wi="94.91mm" file="US20230006818A1-20230105-D00031.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00032" num="00032"><img id="EMI-D00032" he="141.73mm" wi="125.48mm" file="US20230006818A1-20230105-D00032.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00033" num="00033"><img id="EMI-D00033" he="176.61mm" wi="151.81mm" file="US20230006818A1-20230105-D00033.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00034" num="00034"><img id="EMI-D00034" he="113.20mm" wi="94.91mm" file="US20230006818A1-20230105-D00034.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00035" num="00035"><img id="EMI-D00035" he="150.54mm" wi="125.65mm" file="US20230006818A1-20230105-D00035.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00036" num="00036"><img id="EMI-D00036" he="134.45mm" wi="132.59mm" file="US20230006818A1-20230105-D00036.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00037" num="00037"><img id="EMI-D00037" he="195.33mm" wi="155.79mm" file="US20230006818A1-20230105-D00037.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00038" num="00038"><img id="EMI-D00038" he="114.47mm" wi="94.91mm" file="US20230006818A1-20230105-D00038.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00039" num="00039"><img id="EMI-D00039" he="152.91mm" wi="125.65mm" file="US20230006818A1-20230105-D00039.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00040" num="00040"><img id="EMI-D00040" he="204.13mm" wi="151.05mm" file="US20230006818A1-20230105-D00040.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00041" num="00041"><img id="EMI-D00041" he="112.10mm" wi="94.91mm" file="US20230006818A1-20230105-D00041.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00042" num="00042"><img id="EMI-D00042" he="195.16mm" wi="125.39mm" file="US20230006818A1-20230105-D00042.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00043" num="00043"><img id="EMI-D00043" he="219.63mm" wi="151.05mm" file="US20230006818A1-20230105-D00043.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00044" num="00044"><img id="EMI-D00044" he="113.88mm" wi="94.91mm" file="US20230006818A1-20230105-D00044.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00045" num="00045"><img id="EMI-D00045" he="178.82mm" wi="132.50mm" file="US20230006818A1-20230105-D00045.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00046" num="00046"><img id="EMI-D00046" he="139.78mm" wi="129.20mm" file="US20230006818A1-20230105-D00046.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00047" num="00047"><img id="EMI-D00047" he="221.83mm" wi="154.69mm" file="US20230006818A1-20230105-D00047.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00048" num="00048"><img id="EMI-D00048" he="186.44mm" wi="77.98mm" orientation="landscape" file="US20230006818A1-20230105-D00048.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00049" num="00049"><img id="EMI-D00049" he="233.26mm" wi="152.48mm" orientation="landscape" file="US20230006818A1-20230105-D00049.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00050" num="00050"><img id="EMI-D00050" he="235.03mm" wi="151.89mm" orientation="landscape" file="US20230006818A1-20230105-D00050.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00051" num="00051"><img id="EMI-D00051" he="236.30mm" wi="85.85mm" orientation="landscape" file="US20230006818A1-20230105-D00051.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00052" num="00052"><img id="EMI-D00052" he="235.03mm" wi="151.89mm" orientation="landscape" file="US20230006818A1-20230105-D00052.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00053" num="00053"><img id="EMI-D00053" he="114.47mm" wi="94.91mm" file="US20230006818A1-20230105-D00053.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00054" num="00054"><img id="EMI-D00054" he="195.92mm" wi="132.33mm" file="US20230006818A1-20230105-D00054.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00055" num="00055"><img id="EMI-D00055" he="211.16mm" wi="157.23mm" file="US20230006818A1-20230105-D00055.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00056" num="00056"><img id="EMI-D00056" he="114.64mm" wi="94.91mm" file="US20230006818A1-20230105-D00056.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00057" num="00057"><img id="EMI-D00057" he="190.75mm" wi="132.16mm" file="US20230006818A1-20230105-D00057.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00058" num="00058"><img id="EMI-D00058" he="222.50mm" wi="132.33mm" file="US20230006818A1-20230105-D00058.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00059" num="00059"><img id="EMI-D00059" he="195.58mm" wi="108.46mm" orientation="landscape" file="US20230006818A1-20230105-D00059.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0001">The present technology relates to file processing devices and file processing methods, and more particularly, to a file processing device and a file processing method for enabling restriction of viewing of an image, for example.</p><heading id="h-0002" level="1">BACKGROUND ART</heading><p id="p-0004" num="0002">As a file format for efficiently storing images, there is a high efficiency image file format (HEIF) (see Non-Patent Document 1).</p><heading id="h-0003" level="1">CITATION LIST</heading><heading id="h-0004" level="1">Non-Patent Document</heading><p id="p-0005" num="0000"><ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0003">Non-Patent Document 1: ISO/IEC 23008-12: 2017, Information technology&#x2014;High efficiency coding and media delivery in heterogeneous environments&#x2014;Part 12: Image File Format</li></ul></p><heading id="h-0005" level="1">SUMMARY OF THE INVENTION</heading><heading id="h-0006" level="1">Problems to be Solved by the Invention</heading><p id="p-0006" num="0004">With an HEIF file or a some other file that stores images, it would be user-friendly if viewing of images stored in the file can be restricted so as to protect so-called copyrights, portrait rights, and the like.</p><p id="p-0007" num="0005">The present technology has been made in view of such circumstances, and aims to enable restriction of viewing of an image stored in a file.</p><heading id="h-0007" level="1">Solutions to Problems</heading><p id="p-0008" num="0006">A first file processing device of the present technology is a file processing device that includes a file control unit that generates a file storing an encrypted image obtained by encrypting an image with a first encryption key, and an encrypted encryption key obtained by encrypting the first encryption key with a second encryption key, the encrypted image and the encrypted encryption key being associated with each other in the file.</p><p id="p-0009" num="0007">A first file processing method of the present technology is a file processing method that includes generating a file storing an encrypted image obtained by encrypting an image with a first encryption key, and an encrypted encryption key obtained by encrypting the first encryption key with a second encryption key, the encrypted image and the encrypted encryption key being associated with each other in the file.</p><p id="p-0010" num="0008">In the first file processing device and file processing method of the present technology, a file storing an encrypted image obtained by encrypting an image with a first encryption key, and an encrypted encryption key obtained by encrypting the first encryption key with a second encryption key is generated, the encrypted image and the encrypted encryption key being associated with each other in the file.</p><p id="p-0011" num="0009">A second file processing device of the present technology is a file processing device that includes a file control unit that decrypts an encrypted image into an image with a first encryption key, the first encryption key being obtained by decrypting an encrypted encryption key in a file, the file storing the encrypted image obtained by encrypting the image with the first encryption key and the encrypted encryption key obtained by encrypting the first encryption key with a second encryption key, the encrypted image and the encrypted encryption key being associated with each other in the file.</p><p id="p-0012" num="0010">A second file processing method of the present technology is a file processing method that includes decrypting an encrypted image into an image with a first encryption key, the first encryption key being obtained by decrypting an encrypted encryption key in a file, the file storing the encrypted image obtained by encrypting the image with the first encryption key and the encrypted encryption key obtained by encrypting the first encryption key with a second encryption key, the encrypted image and the encrypted encryption key being associated with each other in the file.</p><p id="p-0013" num="0011">In the second file processing device and file processing method of the present technology, an encrypted image is decrypted into an image with a first encryption key, the first encryption key being obtained by decrypting an encrypted encryption key in a file, the file storing the encrypted image obtained by encrypting the image with the first encryption key and the encrypted encryption key obtained by encrypting the first encryption key with a second encryption key, the encrypted image and the encrypted encryption key being associated with each other in the file.</p><p id="p-0014" num="0012">Note that the first and second file processing devices may be independent devices, or may be internal blocks in a single device.</p><p id="p-0015" num="0013">Alternatively, the first and second file processing devices can also be formed by causing a computer to execute a program. The program for causing the computer to function as the first and second file processing devices may be recorded on a recording medium and provided, or be transmitted and provided via a transmission medium.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0008" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p-0016" num="0014"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a block diagram showing an example configuration of an embodiment of a digital camera to which the present technology is applied.</p><p id="p-0017" num="0015"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a diagram showing an example format of a JPEG file compliant with Joint Photographic Experts Group (JPEG).</p><p id="p-0018" num="0016"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a diagram showing an example of an ISO base media file format.</p><p id="p-0019" num="0017"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a diagram showing an example format of an HEIF file compliant with HEIF.</p><p id="p-0020" num="0018"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a diagram showing an example format of an HEIF file in an image item format.</p><p id="p-0021" num="0019"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a diagram showing an example of an iprp box.</p><p id="p-0022" num="0020"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a diagram showing an example format of an HEIF file in an image sequence format.</p><p id="p-0023" num="0021"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a diagram showing an example of a trak box.</p><p id="p-0024" num="0022"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a diagram showing an example of a conventional collection file storing master images and thumbnail images.</p><p id="p-0025" num="0023"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a diagram showing an example of a first associating collection file.</p><p id="p-0026" num="0024"><figref idref="DRAWINGS">FIG. <b>11</b></figref> is a diagram showing an example of a second associating collection file.</p><p id="p-0027" num="0025"><figref idref="DRAWINGS">FIG. <b>12</b></figref> is a diagram showing an example of a third associating collection file.</p><p id="p-0028" num="0026"><figref idref="DRAWINGS">FIG. <b>13</b></figref> is a diagram showing an example of a conventional sequence file in which a track of master images and a track of the thumbnail images of the master images are stored.</p><p id="p-0029" num="0027"><figref idref="DRAWINGS">FIG. <b>14</b></figref> is a diagram showing an example of an associating sequence file.</p><p id="p-0030" num="0028"><figref idref="DRAWINGS">FIG. <b>15</b></figref> is a flowchart for explaining an outline of an example of a generation process for generating an associating HEIF file.</p><p id="p-0031" num="0029"><figref idref="DRAWINGS">FIG. <b>16</b></figref> is a flowchart for explaining an outline of an example of a reproduction process for reproducing an associating HEIF file.</p><p id="p-0032" num="0030"><figref idref="DRAWINGS">FIG. <b>17</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a collection file.</p><p id="p-0033" num="0031"><figref idref="DRAWINGS">FIG. <b>18</b></figref> is a flowchart for explaining an example of the process of reading the reproduction target image in step S<b>32</b>.</p><p id="p-0034" num="0032"><figref idref="DRAWINGS">FIG. <b>19</b></figref> is a flowchart for explaining a first example of the process of acquiring the reproduction target item ID in step S<b>31</b>.</p><p id="p-0035" num="0033"><figref idref="DRAWINGS">FIG. <b>20</b></figref> is a flowchart for explaining a second example of the process of acquiring the reproduction target item ID in step S<b>31</b>.</p><p id="p-0036" num="0034"><figref idref="DRAWINGS">FIG. <b>21</b></figref> is a flowchart for explaining an example of a process of acquiring a uuid as the specific information about the RAW file of a predetermined master image from a first associating collection file.</p><p id="p-0037" num="0035"><figref idref="DRAWINGS">FIG. <b>22</b></figref> is a flowchart for explaining an example of a process of acquiring a uuid as the specific information about the RAW file of a predetermined master image from a second associating collection file.</p><p id="p-0038" num="0036"><figref idref="DRAWINGS">FIG. <b>23</b></figref> is a flowchart for explaining an example of a process of acquiring a uuid as the specific information about the RAW file of a predetermined master image from a third associating collection file.</p><p id="p-0039" num="0037"><figref idref="DRAWINGS">FIG. <b>24</b></figref> is a flowchart for explaining an example of a process of acquiring a list of the item IDs of master images from a collection file.</p><p id="p-0040" num="0038"><figref idref="DRAWINGS">FIG. <b>25</b></figref> is a flowchart for explaining an example of a process of reproducing, from a sequence file, the thumbnail image of (the frame of) the master image corresponding to predetermined time information.</p><p id="p-0041" num="0039"><figref idref="DRAWINGS">FIG. <b>26</b></figref> is a flowchart for explaining an example of a process of acquiring a uuid as the specific information about the RAW file of (the frame of) a predetermined master image from an associating sequence file.</p><p id="p-0042" num="0040"><figref idref="DRAWINGS">FIG. <b>27</b></figref> is a diagram showing an example of storage of uuids in RAW files in a case where RAW files of master images are adopted as external data, and an associating collection file is generated.</p><p id="p-0043" num="0041"><figref idref="DRAWINGS">FIG. <b>28</b></figref> is a diagram showing an example of storage of uuids in RAW files in a case where RAW files of master images are adopted as external data, and an associating sequence file is generated.</p><p id="p-0044" num="0042"><figref idref="DRAWINGS">FIG. <b>29</b></figref> is a diagram showing an example of storage of uuids in WAV files in a case where WAV files of master images are adopted as external data, and an associating collection file is generated.</p><p id="p-0045" num="0043"><figref idref="DRAWINGS">FIG. <b>30</b></figref> is a diagram showing an example of storage of uuids in WAV files in a case where WAV files of master images are adopted as external data, and an associating sequence file is generated.</p><p id="p-0046" num="0044"><figref idref="DRAWINGS">FIG. <b>31</b></figref> is a block diagram showing an example configuration of a first embodiment of an image processing system to which the present technology is applied.</p><p id="p-0047" num="0045"><figref idref="DRAWINGS">FIG. <b>32</b></figref> is a diagram showing an example of a first encrypted HEIF file.</p><p id="p-0048" num="0046"><figref idref="DRAWINGS">FIG. <b>33</b></figref> is a diagram showing an example of a second encrypted HEIF file.</p><p id="p-0049" num="0047"><figref idref="DRAWINGS">FIG. <b>34</b></figref> is a diagram showing an example of a third encrypted HEIF file.</p><p id="p-0050" num="0048"><figref idref="DRAWINGS">FIG. <b>35</b></figref> is a diagram showing an example of a fourth encrypted HEIF file.</p><p id="p-0051" num="0049"><figref idref="DRAWINGS">FIG. <b>36</b></figref> is a diagram showing an example of a fifth encrypted HEIF file.</p><p id="p-0052" num="0050"><figref idref="DRAWINGS">FIG. <b>37</b></figref> is a diagram showing an example of a sixth encrypted HEIF file.</p><p id="p-0053" num="0051"><figref idref="DRAWINGS">FIG. <b>38</b></figref> is a flowchart for explaining an example of the preprocessing to be performed in a case where a first encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0054" num="0052"><figref idref="DRAWINGS">FIG. <b>39</b></figref> is a flowchart for explaining an example of a generation process for generating a first encrypted HEIF file in a case where the first encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0055" num="0053"><figref idref="DRAWINGS">FIG. <b>40</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a first encrypted HEIF file in a case where the first encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0056" num="0054"><figref idref="DRAWINGS">FIG. <b>41</b></figref> is a flowchart for explaining an example of the preprocessing to be performed in a case where a second encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0057" num="0055"><figref idref="DRAWINGS">FIG. <b>42</b></figref> is a flowchart for explaining an example of a generation process for generating a second encrypted HEIF file in a case where the second encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0058" num="0056"><figref idref="DRAWINGS">FIG. <b>43</b></figref> is a flowchart for explaining an example of a restriction process for restricting viewing of a master image obtained by decrypting an encrypted image only to the user who can obtain the private key corresponding to the encrypted image, in a case where a second encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0059" num="0057"><figref idref="DRAWINGS">FIG. <b>44</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a second encrypted HEIF file in a case where the second encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0060" num="0058"><figref idref="DRAWINGS">FIG. <b>45</b></figref> is a flowchart for explaining an example of the preprocessing to be performed in a case where a third encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0061" num="0059"><figref idref="DRAWINGS">FIG. <b>46</b></figref> is a flowchart for explaining an example of a generation process for generating a third encrypted HEIF file in a case where the third encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0062" num="0060"><figref idref="DRAWINGS">FIG. <b>47</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a third encrypted HEIF file in a case where the third encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0063" num="0061"><figref idref="DRAWINGS">FIG. <b>48</b></figref> is a flowchart for explaining an example of the preprocessing to be performed in a case where a fourth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0064" num="0062"><figref idref="DRAWINGS">FIG. <b>49</b></figref> is a flowchart for explaining an example of a generation process for generating a fourth encrypted HEIF file in a case where the fourth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0065" num="0063"><figref idref="DRAWINGS">FIG. <b>50</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a fourth encrypted HEIF file in a case where the fourth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0066" num="0064"><figref idref="DRAWINGS">FIG. <b>51</b></figref> is a flowchart for explaining an example of the preprocessing to be performed in a case where a fifth or sixth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0067" num="0065"><figref idref="DRAWINGS">FIG. <b>52</b></figref> is a flowchart for explaining an example of a generation process for generating a fifth or sixth encrypted HEIF file in a case where the fifth or sixth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0068" num="0066"><figref idref="DRAWINGS">FIG. <b>53</b></figref> is a flowchart for explaining an example of a restriction process for restricting viewing of a master image obtained by decrypting an encrypted image only to the user who can obtain the private key corresponding to the encrypted image, in a case where a fifth or sixth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0069" num="0067"><figref idref="DRAWINGS">FIG. <b>54</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a fifth or sixth encrypted HEIF file in a case where the fifth or sixth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0070" num="0068"><figref idref="DRAWINGS">FIG. <b>55</b></figref> is a block diagram showing an example configuration of a second embodiment of an image processing system to which the present technology is applied.</p><p id="p-0071" num="0069"><figref idref="DRAWINGS">FIG. <b>56</b></figref> is a block diagram showing an example configuration of a digital camera <b>210</b>.</p><p id="p-0072" num="0070"><figref idref="DRAWINGS">FIG. <b>57</b></figref> is a diagram showing an example of a grid file.</p><p id="p-0073" num="0071"><figref idref="DRAWINGS">FIG. <b>58</b></figref> is a diagram for explaining an outline of encrypted grid file processing to be performed by the digital camera <b>210</b>.</p><p id="p-0074" num="0072"><figref idref="DRAWINGS">FIG. <b>59</b></figref> is a diagram showing an example of an encrypted grid file.</p><p id="p-0075" num="0073"><figref idref="DRAWINGS">FIG. <b>60</b></figref> is a flowchart for explaining a first example of the preprocessing to be performed in a case where an encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0076" num="0074"><figref idref="DRAWINGS">FIG. <b>61</b></figref> is a flowchart for explaining a first example of a generation process for generating an encrypted grid file in a case where the encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0077" num="0075"><figref idref="DRAWINGS">FIG. <b>62</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing an encrypted grid file in a case where the encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0078" num="0076"><figref idref="DRAWINGS">FIG. <b>63</b></figref> is a flowchart for explaining a second example of the preprocessing to be performed in a case where an encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0079" num="0077"><figref idref="DRAWINGS">FIG. <b>64</b></figref> is a flowchart for explaining a second example of a generation process for generating an encrypted grid file in a case where the encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0080" num="0078"><figref idref="DRAWINGS">FIG. <b>65</b></figref> is a flowchart for explaining a third example of a generation process for generating an encrypted grid file in a case where the encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0081" num="0079"><figref idref="DRAWINGS">FIG. <b>66</b></figref> is a block diagram showing an example configuration of an embodiment of a computer to which the present technology is applied.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0009" level="1">MODES FOR CARRYING OUT THE INVENTION</heading><p id="p-0082" num="0080">&#x3c;Embodiment of a Digital Camera to which the Present Technology is Applied&#x3e;</p><p id="p-0083" num="0081"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a block diagram showing an example configuration of an embodiment of a digital camera to which the present technology is applied.</p><p id="p-0084" num="0082">A digital camera <b>10</b> includes an optical system <b>11</b>, an image sensor <b>12</b>, a signal processing unit <b>13</b>, a medium <b>14</b>, interfaces <b>15</b> and <b>16</b>, buttons/keys <b>17</b>, a touch panel <b>18</b>, a liquid crystal panel <b>19</b>, a viewfinder <b>20</b>, an interface <b>21</b>, and the like.</p><p id="p-0085" num="0083">The optical system <b>11</b> condenses light from the object onto the image sensor <b>12</b>.</p><p id="p-0086" num="0084">The image sensor <b>12</b> generates image data as an electrical signal by receiving light from the optical system <b>11</b> and performing imaging that involves photoelectric conversion, and supplies the image data to the signal processing unit <b>13</b>.</p><p id="p-0087" num="0085">The signal processing unit <b>13</b> includes an optical system/image sensor control unit <b>41</b>, a coding control unit <b>42</b>, a file control unit <b>43</b>, a media control unit <b>44</b>, an operation control unit <b>45</b>, a display control unit <b>46</b>, and a UI control unit <b>47</b>.</p><p id="p-0088" num="0086">The optical system/image sensor control unit <b>41</b> controls the optical system <b>11</b> and the image sensor <b>12</b>, and supplies the coding control unit <b>42</b> with (data of) the image obtained by the imaging performed in accordance with the control.</p><p id="p-0089" num="0087">The coding control unit <b>42</b> supplies the image from the optical system/image sensor control unit <b>41</b> to the display control unit <b>46</b>, and encodes the image as necessary and supplies the encoded image to the file control unit <b>43</b>. The coding control unit <b>42</b> also decodes an image supplied from the file control unit <b>43</b> as necessary, and supplies the decoded image to the display control unit <b>46</b>.</p><p id="p-0090" num="0088">The file control unit <b>43</b> generates a file that stores the image supplied from the coding control unit <b>42</b>, and supplies the file to the media control unit <b>44</b>. The file control unit <b>43</b> also reproduces the file supplied from the media control unit <b>44</b>. That is, the file control unit <b>43</b> performs readout of data such as the image stored in the file, and the like. For example, the image read from the file is supplied from the file control unit <b>43</b> to the coding control unit <b>42</b>.</p><p id="p-0091" num="0089">The media control unit <b>44</b> controls exchange of files between the medium <b>14</b> and the interfaces <b>15</b> and <b>16</b>. For example, the media control unit <b>44</b> causes the medium <b>14</b> to record the file supplied from the file control unit <b>43</b>, or causes the interfaces <b>15</b> and <b>16</b> to transmit the file supplied from the file control unit <b>43</b>. The media control unit <b>44</b> also reads a file from the medium <b>14</b> or causes the interfaces <b>15</b> and <b>16</b> to receive a file, and supplies the file to the file control unit <b>43</b>.</p><p id="p-0092" num="0090">In accordance with an operation performed on the buttons/keys <b>17</b> or the touch panel <b>18</b> by the user, the operation control unit <b>45</b> supplies an operation signal corresponding to the operation to the required block.</p><p id="p-0093" num="0091">The display control unit <b>46</b> performs display control and the like to supply the image and the like supplied from the coding control unit <b>42</b> to the liquid crystal panel <b>19</b>, the viewfinder <b>20</b>, and the interface <b>21</b>, and have the image and the like be displayed.</p><p id="p-0094" num="0092">The UI control unit <b>47</b> manages user interface (UI) control.</p><p id="p-0095" num="0093">The medium <b>14</b> is a storage medium such as an SD card, for example. The interface <b>15</b> is an interface of a local area network (LAN) such as WiFi (registered trademark) or Ethernet (registered trademark), for example. The interface <b>16</b> is an interface of a universal serial bus (USB), for example. The buttons/keys <b>17</b> and the touch panel <b>18</b> are operated by the user to input a command or other information to the digital camera <b>10</b>. The touch panel <b>18</b> can be formed integrally with the liquid crystal panel <b>19</b>. The liquid crystal panel <b>19</b> and the viewfinder <b>20</b> display an image and the like supplied from the display control unit <b>46</b>. The interface <b>21</b> is an interface that transmits at least an image, such as high-definition multimedia interface (HDMI (registered trademark)) or a display port (DP).</p><p id="p-0096" num="0094">In the digital camera <b>10</b> designed as described above, the optical system/image sensor control unit <b>41</b> generates an image of YUV as a master image of an HEIF file, for example, and supplies the image of YUV to the coding control unit <b>42</b>, the image of YUV being generated from an image of RAW data obtained by imaging performed by the image sensor <b>12</b> (this image will be hereinafter also referred to as the RAW image), the image of YUV having the same resolution (the same number of pixels) as the RAW image.</p><p id="p-0097" num="0095">The coding control unit <b>42</b> generates, from the master image of YUV, an image of YUV having a lower resolution than that of the master image (this image of YUV will be hereinafter also referred to as the screen nail image), for example, as a first other image based on the master image, for use in display on the liquid crystal panel <b>19</b> or an external display. The coding control unit <b>42</b> also generates an image of YUV having a lower resolution than that of the screen nail image (this image of YUV will be hereinafter also referred to as the thumbnail image), for example, as a second other image based on the master image, for use in index display (list display). For example, the coding control unit <b>42</b> supplies the screen nail image to the liquid crystal panel <b>19</b> via the display control unit <b>46</b>, to have the screen nail image be displayed as a so-called through-lens image. As the thumbnail image, an image having a size of 320 pixels or smaller on the long side can be adopted, for example. The ratio of the size (the number of pixels) between the master image and the screen nail image as the first other image based on the master image or the thumbnail image as the second other image based on the master image can be 200 or lower, for example. Likewise, the ratio of the size between the screen nail image as the first other image based on the master image and the thumbnail image as the second other image based on the master image can be 200 or lower. As the screen nail image, an image having a resolution of 4K or higher can be adopted, for example. Also, as the screen nail image, a 4K (QFHD) or FHD image can be adopted according to the user's selection, for example. Further, images having the same resolution can be adopted as the master image and the screen nail image. In a case where images having the same resolution are adopted as the master image and the screen nail image, both the master image and the screen nail image can be stored in the HEIF file, or the master image can be stored in the HEIF file but the screen nail image is not. In a case where the master image is stored in the HEIF file but the screen nail image is not, the master image can be resized, and be used as the screen nail image.</p><p id="p-0098" num="0096">The coding control unit <b>42</b> also encodes the master image, the screen nail image, and the thumbnail image corresponding to the RAW image (the master image, the screen nail image, and the thumbnail image that are generated from the same RAW image) as necessary, and supplies the encoded images, as well as the RAW image, to the file control unit <b>43</b>.</p><p id="p-0099" num="0097">The file control unit <b>43</b> generates a RAW file in which the RAW image is stored, generates an HEIF file, a JPEG file, or the like in which the corresponding master image, screen nail image, and thumbnail image (the master image, the screen nail image, and the thumbnail image that are generated from the same RAW image) are stored, and supplies the files to the media control unit <b>44</b>. An HEIF file is a file compliant with High Efficiency Image File Format (HEIF), and a JPEG file is a file compliant with Joint Photographic Experts Group (JPEG).</p><p id="p-0100" num="0098">The media control unit <b>44</b> records the RAW file and the HEIF file or the JPEG file supplied from the file control unit <b>43</b> on the medium <b>14</b>, or transmits the RAW file and the HEIF file or the JPEG file from the interface <b>15</b> or <b>16</b>.</p><p id="p-0101" num="0099">The file control unit <b>43</b> can choose an HEIF file or a JPEG file as a file to be generated, according to the user's operation, for example. Further, as will be described later, an HEIF file is in an image item format and an image sequence format. The image item format or the image sequence format can be adopted according to the user's operation, for example. Further, the file control unit <b>43</b> can perform mutual conversion between an HEIF file and a JPEG file according to the user's operation.</p><p id="p-0102" num="0100">Further, in generating an HEIF file, the file control unit <b>43</b> can associate the internal data in the HEIF file (the data stored in the HEIF file) associated with external data outside the HEIF file (data not stored in the HEIF file), with specific information for specifying the external data, and store the internal data and the specific information into the HEIF file. The HEIF file in which the internal data and the specific information regarding the external data associated with the internal data are associated with each other and are stored is also referred to as an associating HEIF file. An associating HEIF file can store the internal data and the specific information associated with each other, by storing association information for associating the internal data with the specific information or the like, for example.</p><p id="p-0103" num="0101">&#x3c;JPEG File&#x3e;</p><p id="p-0104" num="0102"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a diagram showing an example format of a JPEG file compliant with Joint Photographic Experts Group (JPEG).</p><p id="p-0105" num="0103">A JPEG file is designed to store Exif metadata, a thumbnail image, Extensible Metadata Platform (XMP, registered trademark) metadata, an MPF indicating the storage locations (positions) of a master image and an image for simplified display and the like, the master image, and the image for simplified display, for example. As the image for simplified display, a screen nail image can be adopted, for example.</p><p id="p-0106" num="0104">&#x3c;ISO Base Media File Format&#x3e;</p><p id="p-0107" num="0105"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a diagram showing an example of an ISO base media file format.</p><p id="p-0108" num="0106">HEIF (ISO/IEC 23008-12) is a file format compliant with an ISO base media file format (ISO/IEC 14496-12), and accordingly, an HEIF file is compliant with the ISO base media file format.</p><p id="p-0109" num="0107">The ISO base media file format includes units called boxes as containers for storing data, and has a structure called a box structure.</p><p id="p-0110" num="0108">A box includes a type (a box type), actual data (data), and the like. The type indicates the type of the actual data in the box. The actual data can be reproducible media data such as an image (a still image or a video image), audio, and subtitles, attribute names (field names and the attribute values (field values) of (the variables represented by) the attribute names, and various kinds of other data.</p><p id="p-0111" num="0109">Further, boxes can be adopted as the actual data. That is, a box can have boxes as actual data, and thus, can have a hierarchical structure.</p><p id="p-0112" num="0110">A base media file compliant with the ISO base media file format can include an ftyp box, a moov box (MovieBox), a meta box (MetaBox), an mdat box (MediaDataBox), and the like. The ftyp box stores identification information for identifying the file format. The moov box can store a trak box and the like. The meta box can store an iinf box, an iprp box, an iref box, an iloc box, and the like. The mdat box can store media data (AV data) and other desired data.</p><p id="p-0113" num="0111">HEIF is compliant with the ISO base media file format described above.</p><p id="p-0114" num="0112">&#x3c;HEIF File&#x3e;</p><p id="p-0115" num="0113"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a diagram showing an example format of an HEIF file compliant with HEIF.</p><p id="p-0116" num="0114">HEIF files are roughly classified into those in image item formats and those in image sequence formats. Further, the image item formats include a single-mage format containing only one item as described later, and an image collection format containing a plurality of items.</p><p id="p-0117" num="0115">An HEIF file in an image item format includes an ftyp box, a meta box, and an mdat box.</p><p id="p-0118" num="0116">An HEIF file in an image sequence format includes an ftyp box, a moov box, and an mdat box.</p><p id="p-0119" num="0117">Note that an HEIF file can include not only either a meta box or a moov box, but both of the boxes.</p><p id="p-0120" num="0118">The ftyp box stores identification information for identifying the file format, such as information indicating that the file is an HEIF file in an image item format or an image sequence format, for example.</p><p id="p-0121" num="0119">The meta box and the moov box store metadata necessary for reproduction, management, and the like of the media data stored in the mdat box, such as metadata indicating the storage location of the media data, for example.</p><p id="p-0122" num="0120">The mdat box stores media data (AV data) and the like.</p><p id="p-0123" num="0121">In the digital camera <b>10</b>, generation of an HEIF file in an image item format or an HEIF file in an image sequence format can be selected according to the user's operation, for example. Further, in a case where an image is encoded and stored in the mdat box of an HEIF file, only intra encoding is permitted for an image item format, and intra encoding and inter encoding are permitted for an image sequence format. Accordingly, in a case where priority is put on high-speed access to the data stored in an HEIF file, for example, generation of an HEIF file in an image item format can be selected. In a case where priority is put on reduction of the size (data amount) of an HEIF file, generation of an HEIF file in an image sequence format can be selected.</p><p id="p-0124" num="0122"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a diagram showing an example format of an HEIF file in an image item format.</p><p id="p-0125" num="0123">In an HEIF file in an image item format, information indicating that the HEIF file is in an image item format, such as that mif1, for example, is stored (as an attribute value) in the ftyp box.</p><p id="p-0126" num="0124">The meta box stores an iinf box, an iref box, an iprp box, and an iloc box.</p><p id="p-0127" num="0125">The iinf box stores (an attribute name and an attribute value indicating) the number of items that are the media data (AV data) stored in the mdat box, and the like. An item is one piece of data stored in the mdat box of an HEIF file in an image item format, and one image (screen) is one item, for example. In this specification, one image that is a still image or a video image is also referred to as a frame. One frame is one item.</p><p id="p-0128" num="0126">The iref box stores information indicating the relationship between the items. For example, in the mdat box, the corresponding master image, screen nail image, and thumbnail image can be stored as items. In a case where an item I1 as the master image, an item I2 as the screen nail image, and an item I3 as the thumbnail image are stored in the mdat box, information indicating that the item I2 is the screen nail image of the master image as the item I1, and information indicating that the item I3 is the thumbnail image of the master image as the item I1 are stored in the iref box.</p><p id="p-0129" num="0127">The iprp box stores information regarding the properties of the items.</p><p id="p-0130" num="0128">The iloc box stores information regarding the storage locations of the items stored in the mdat box.</p><p id="p-0131" num="0129">For example, the frame of an image as an item is stored in the mdat box (of an HEIF file) in an image item format. One or more items can be stored in the mdat box. Also, an encoded frame as an item can be stored in the mdat box. However, encoding of a frame as an item to be stored in the mdat box in an image item format is limited to intra encoding. As an encoding method (codec) for encoding a frame as an item, HEVC or the like can be adopted, for example.</p><p id="p-0132" num="0130"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a diagram showing an example of the iprp box shown in <figref idref="DRAWINGS">FIG. <b>5</b></figref>.</p><p id="p-0133" num="0131">The iprp box stores an ipco box and an ipma box regarding the properties of the items. The ipco box stores the properties of the items stored in the mdat box, such as codec information regarding the codec of images as the items and image size information regarding the size, for example. The ipma box stores the index (pointers) of the properties stored in the ipco box regarding the items stored in the mdat box.</p><p id="p-0134" num="0132"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a diagram showing an example format of an HEIF file in an image sequence format.</p><p id="p-0135" num="0133">In an HEIF file in an image sequence format, information indicating that the HEIF file is in an image sequence format, such as msf1, is stored in the ftyp box, for example.</p><p id="p-0136" num="0134">The moov box stores a trak box. The trak box stores information regarding the tracks stored in the mdat box.</p><p id="p-0137" num="0135">A track is formed with one independent piece of media data to be reproduced according to a timeline, such as an image or sound. For example, a track is formed with one or more frames of images to be an elementary stream. As for the tracks stored in the mdat box, a plurality of tracks, such as the respective tracks of an image and sound recorded at the same time, can be reproduced at the same time, for example.</p><p id="p-0138" num="0136">The media data of the tracks is formed with units called samples. A sample is a minimum unit (access unit) in a case where the media data in the HEIF file is to be accessed. Therefore, the media data in the HEIF file cannot be accessed by a smaller unit than a sample.</p><p id="p-0139" num="0137">In the media data of an image, one frame or the like is one sample, for example. Also, in the media data of sound, one audio frame or the like defined in the standard of the media data of the sound is one sample, for example.</p><p id="p-0140" num="0138">In the mdat box (of an HEIF file) in an image sequence format, the media data of tracks is placed in units called chunks. A chunk is a set of one or more samples placed at logically continuous addresses.</p><p id="p-0141" num="0139">In a case where a plurality of tracks as media data is stored in the mdat box, the plurality of tracks is interleaved and placed in chunks.</p><p id="p-0142" num="0140">As described above, in the mdat box in an image sequence format, one or more tracks formed with media data such as an image and sound are stored.</p><p id="p-0143" num="0141">In the mdat box, encoded frames of images constituting a track can be stored. In the encoding of the frames constituting a track stored in the mdat box in an image sequence format, a long GOP can be adopted as a group of picture (GOP), and both intra encoding and inter encoding can be adopted. As a codec that encodes the frames constituting a track, HEVC or the like can be adopted, for example.</p><p id="p-0144" num="0142"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a diagram showing an example of the trak box.</p><p id="p-0145" num="0143">The trak box can store a tkhd box and an mdia box. The tkhd box stores header information regarding tracks, such as the creation dates and times of the tracks being managed by the trak box. The mdia box stores a minf box and the like. The minf box stores an stbl box. The stbl box stores an stsd box, an stsc box, an stsz box, and an stco box that store samples of the tracks, which are information for accessing the chunks. The stsd box stores codec information regarding the codec of the tracks. The stsc box stores the chunk size (the number of samples of one chunk). The stsz box stores the sample size. The stco box stores the chunk offset, which is the offset of the placement position of each chunk of the tracks stored in the mdat box.</p><p id="p-0146" num="0144">Here, an HEIF file in an image item format is also called a collection file, and an HEIF file in an image sequence format is also called a sequence file. Further, an associating HEIF file in an image item format is also called an associating collection file, and an associating HEIF file in an image sequence format is also called an associating sequence file.</p><p id="p-0147" num="0145">In the digital camera <b>10</b>, it is possible to generate an HEIF file (including an associating HEIF file) in which a master image, and further, a screen nail image and/or a thumbnail image that are required are stored.</p><p id="p-0148" num="0146">&#x3c;Collection File&#x3e;</p><p id="p-0149" num="0147"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a diagram showing an example of a conventional collection file storing master images and thumbnail images.</p><p id="p-0150" num="0148">Here, a conventional collection file means a collection file in which the internal data in the collection file is not associated with specific information about external data.</p><p id="p-0151" num="0149">Here, frames (items) encoded by HEVC are stored in the mdat box of the collection file.</p><p id="p-0152" num="0150">In the ftyp box, heic indicating that the format is an image item format and that the codec is HEVC is stored as identification information for identifying the file format.</p><p id="p-0153" num="0151">The iinf box stores the number of items (item number) stored in the mdat box. In <figref idref="DRAWINGS">FIG. <b>9</b></figref>, a total of four items (frames) that are the master image specified by an item ID #1 (this master image will be hereinafter also written as the master image Item #1), a master image Item #2, the thumbnail image specified by an item ID #101 (this thumbnail image will be hereinafter also written as the thumbnail image Item #101), and a thumbnail image Item #102 are stored in the mdat box. Accordingly, the number of items is four. Note that the thumbnail image Item #101 is the thumbnail image of the master image Item #1, and the thumbnail image Item #102 is the thumbnail image of the master image Item #2.</p><p id="p-0154" num="0152">The iinf box further stores an infe box for each item stored in the mdat box, for example. In an infe box, an item ID for specifying an item, and an item type are registered. In <figref idref="DRAWINGS">FIG. <b>9</b></figref>, there are the respective infe boxes of the master images Item #1 and Item #2 and the thumbnail images Item #101 and Item #102.</p><p id="p-0155" num="0153">The iref box stores thmb boxes as information for associating the items stored in the mdat box with each other, for example. In a thmb box, a reference source and a reference destination associated with each other are stored as information for associating a master image with the thumbnail image of the master image. In the thmb box, the reference source indicates the item ID of the master image, and the reference destination indicates the item ID of the thumbnail image of the master image specified by the item ID of the reference source. Accordingly, with the reference destination associated with the reference source, the item ID of the thumbnail image of the master image specified by the item ID indicated by the reference source can be recognized. Also, with the reference source associated with the reference destination, the item ID of the master image of the thumbnail image specified by the item ID indicated by the reference destination can be recognized.</p><p id="p-0156" num="0154">As described above with reference to <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the iprp box stores an ipco box and an ipma box. As described above with reference to <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the ipco box stores the properties of the frames as the items stored in the mdat box, such as codec information regarding the codec and image size information regarding the size, for example. As described above with reference to <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the ipma box stores the index of the properties stored in the ipco box regarding the items stored in the mdat box.</p><p id="p-0157" num="0155">As described above with reference to <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the iloc box stores information regarding the storage locations of the items in the mdat box. In <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the information stored in the iloc box indicates that the number of items is four. Further, in the iloc box, offsets for the respective storage locations and the sizes of the master images Item #1 and Item #2 and the thumbnail images Item #101 and Item #102 stored in the mdat box are associated with the item IDs and are stored.</p><p id="p-0158" num="0156">In the description below, an associating collection file in which internal data and specific information about external data that are associated with each other are stored in the conventional collection file in <figref idref="DRAWINGS">FIG. <b>9</b></figref> is explained.</p><p id="p-0159" num="0157"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a diagram showing an example of a first associating collection file.</p><p id="p-0160" num="0158">Here, (a RAW file storing) the RAW image of a master image is adopted as the external data associated with the master image as internal data in the HEIF file, for example.</p><p id="p-0161" num="0159">In the first associating collection file, association information for associating the master images as the internal data with the specific information regarding (the RAW images stored in) the RAW files storing the RAW images as the external data, so that the master images and the specific information regarding the RAW files storing the RAW images are associated and stored. Further, in the first associating collection file, the association information is stored in the meta box.</p><p id="p-0162" num="0160">As the specific information regarding a RAW files storing a RAW image as external data, any information from which it is possible to specify (the RAW image stored in) the RAW file, such as the file name of the RAW file, the universally unique identifier (uuid) issued to the RAW file, or the uniform resource locator (URL), can be adopted.</p><p id="p-0163" num="0161">In the first associating collection file, an association information storage box in which the association information is stored is defined as a new box to be stored in the meta box, and is stored in the meta box. The association information storage box of the first associating collection file stores the association information in which the item ID for specifying a master image is associated with the uuid as the specific information for specifying (the RAW image stored in) the RAW file (storing the RAW image) associated with the master image, for example. Further, the association information storage box stores the number of the master images (the master image number) associated with (the RAW images stored in) the RAW files. Being the number of the master images associated with the RAW files, the number of the master images stored in the association information storage box is equal to or smaller than the number of the master images stored in the mdat box.</p><p id="p-0164" num="0162">In <figref idref="DRAWINGS">FIG. <b>10</b></figref>, the uuid of the RAW file of the master image Item #1 (the uuid of the RAW image associated with the master image Item #1) is UUID #1, and the uuid of the RAW file of the master image Item #2 is UUID #2. Where a RAW file whose uuid is UUID #i is written as the RAW file UUID #i, association information in which the item ID #1 of the master image Item #1 is associated with the uuid of the RAW file UUID #1, and the item ID #2 of the master image Item #2 is associated with the uuid of the RAW file UUID #2 is stored in the association information storage box in <figref idref="DRAWINGS">FIG. <b>10</b></figref>.</p><p id="p-0165" num="0163"><figref idref="DRAWINGS">FIG. <b>11</b></figref> is a diagram showing an example of a second associating collection file.</p><p id="p-0166" num="0164">In the second associating collection file, association information for associating the master images as the internal data with the specific information regarding the RAW files as the external data, so that the master images and the specific information regarding the RAW files are associated and stored, as in the first associating collection file. However, in the second associating collection file, the association information is stored in the mdat box.</p><p id="p-0167" num="0165">In the second associating collection file, association information similar to that in the case of the first associating collection file is stored as an item in the mdat box, for example. In <figref idref="DRAWINGS">FIG. <b>11</b></figref>, the association information is stored as an item that is an item ID #201 in the mdat box.</p><p id="p-0168" num="0166">As described above, in the second associating collection file, the information stored in the meta box is different from that in the case of the conventional collection file in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, as the association information is stored as the item Item #201 in the mdat box. In the second associating collection file, metadata of the association information as the item Item #201 is stored in the meta box.</p><p id="p-0169" num="0167">Specifically, in the second associating collection file, the number of the items stored in the iinf box and the iloc box is five, increasing from four in the case in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the item Item #201 being added as one to four. Further, the infe box for the item Item #201 is added to the iinf box, and the offset for the storage location and the size of the item Item #201 are added to the iloc box. The infe box for the item Item #201 stores the item ID #201 of the item Item #201, and an item type IDIF (identifying data info) indicating that the item Item #201 is the association information. The IDIF is a newly defined attribute value (field value) indicating that the item is the association information.</p><p id="p-0170" num="0168"><figref idref="DRAWINGS">FIG. <b>12</b></figref> is a diagram showing an example of a third associating collection file.</p><p id="p-0171" num="0169">In the third associating collection file, the specific information regarding the RAW files as external data is stored as an item for each piece of specific information in the mdat box, and association information for associating the master images as the internal data with the specific information regarding the RAW files as the external data is stored in the meta box, so that the master images and the specific information regarding the RAW files are associated and stored. However, in the third associating collection file, the association information is information in which the item IDs of the master images as items are associated with the item IDs of the specific information (about the RAW files) as items, and is stored in cdsc boxes stored in the iref box in the meta box.</p><p id="p-0172" num="0170">In a cdsc box, a reference source and a reference destination that are associated with each other can be stored as information for associating items with each other, the items being a master image and the specific information about the RAW file of the master image. In the cdsc box, the reference source indicates the item ID of the master image, and the reference destination indicates the item ID of the specific information as an item of the RAW file of the master image specified by the item ID of the reference source.</p><p id="p-0173" num="0171">In <figref idref="DRAWINGS">FIG. <b>12</b></figref>, UUID #1, which is the uuid as the specific information about the RAW file of the master image Item #1, is stored as the item Item #201 in the mdat box, and UUID #2, which is the uuid as the specific information about the RAW file of the master image Item #2, is stored as an item Item #202 in the mdat box. Further, a cdsc box storing the association information in which the item ID #1 of the master image Item #1 and the item ID #201 of the specific information UUID #1 are associated with each other as a reference source and a reference destination is stored in the iref box, and a cdsc box storing the association information in which the item ID #2 of the master image Item #2 and the item ID #202 of the specific information UUID #2 are associated with each other as a reference source and a reference destination is stored in the iref box.</p><p id="p-0174" num="0172">&#x3c;Sequence File&#x3e;</p><p id="p-0175" num="0173"><figref idref="DRAWINGS">FIG. <b>13</b></figref> is a diagram showing an example of a conventional sequence file in which a track of master images and a track of the thumbnail images of the master images are stored.</p><p id="p-0176" num="0174">Here, a conventional sequence means a sequence file in which the internal data in the sequence file is not associated with specific information about external data.</p><p id="p-0177" num="0175">Here, frames encoded by HEVC are stored in the mdat box of the sequence file.</p><p id="p-0178" num="0176">In the ftyp box, hevc indicating that the format is an image sequence format and that the codec is HEVC is stored as identification information for identifying the file format.</p><p id="p-0179" num="0177">The moov box stores trak boxes that manage the respective tracks stored in the mdat box, as described above with reference to <figref idref="DRAWINGS">FIG. <b>7</b></figref>. In <figref idref="DRAWINGS">FIG. <b>13</b></figref>, the track of master images specified by a track ID #1 (this track will be hereinafter also written as the track #1), and a track #2 of the thumbnail images of the master images of the track #1 are stored in the mdat box. Accordingly, the moov box stores a trak box that manages the track #1, and a trak box that manages the track #2. (The frame of) the nth thumbnail image (from the top) of the track #2 is the thumbnail image of the nth master image of the track #1.</p><p id="p-0180" num="0178">A sequence file is useful in cases, such as a case where continuous shooting is performed by the digital camera <b>10</b>, and a case where master images of a plurality of frames obtained by the continuous shooting are recorded as one track while the thumbnail images of the master images are also recorded as one track, for example.</p><p id="p-0181" num="0179">The tkhd box of the trak box that manages the track #1 of the master images stores the track ID #1 for specifying the track #1, the image size of the master images constituting the track #1, rotation information indicating the orientation of the digital camera <b>10</b> when the master images were captured, and the creation date and time of the track #1. The tkhd box of the trak box that manages the track #2 of the thumbnail images stores the track ID #2 for specifying the track #2, and the creation date and time of the track #2.</p><p id="p-0182" num="0180">In a trak box, a tref box can be stored in addition to the tkhd box and the mdia box described above with reference to <figref idref="DRAWINGS">FIG. <b>7</b></figref>. A tref box stores a track ID for specifying another track associated with the track being managed by the trak box storing the tref box, information indicating the contents of the track, and the like. In <figref idref="DRAWINGS">FIG. <b>13</b></figref>, a tref box is provided in the trak box that manages the track #2. Further, the tref box stores information indicating that another track associated with the track #2 is the track #1 (track ID=1), and that the data constituting the track #2 is thumbnail images (the track #2 is a track of thumbnail images) (type=thmb).</p><p id="p-0183" num="0181">In the mdia box in a trak box, an hdlr box can be stored in addition to the minf box described above with reference to <figref idref="DRAWINGS">FIG. <b>8</b></figref>. An hdlr box stores information indicating the type of the data constituting the track being managed by the trak box storing the hdlr box. Information (pict) indicating that the data constituting the track #1 is pictures (frames) is stored in the hdlr box stored (in the mdia box stored) in the trak box that manages the track #1 of the master images, and information indicating that the data constituting the track #2 is pictures is stored in the hdlr box stored in the trak box that manages the track #2 of the thumbnail images.</p><p id="p-0184" num="0182">The minf box is as described above with reference to <figref idref="DRAWINGS">FIG. <b>8</b></figref>.</p><p id="p-0185" num="0183">In the description below, an associating sequence file in which internal data and specific information about external data that are associated with each other are stored in the conventional sequence file in <figref idref="DRAWINGS">FIG. <b>13</b></figref> is explained.</p><p id="p-0186" num="0184"><figref idref="DRAWINGS">FIG. <b>14</b></figref> is a diagram showing an example of an associating sequence file.</p><p id="p-0187" num="0185">In an associating sequence file, a track #3 of the (elementary) stream (Meta ES) of a uuid as the specific information about RAW files as external data is added to the mdat box, and a trak box that manages the track #3 is added to the moov box.</p><p id="p-0188" num="0186">Here, the track #1 is a time series of one or more frames of master images arranged on the timeline, and the track #3 is a time series of the uuids of the RAW files of the respective frames of the master images arranged on the timeline.</p><p id="p-0189" num="0187">The nth uuid (from the top) of the track #3 is the specific information about the RAW file of the frame of the nth master image in the track #1. Further, (the data of) the plurality of tracks stored in the mdat box can be synchronously reproduced according to the time information on one timeline. Therefore, the track #1 of the master images and the track #3 of (the stream of) the uuids of the RAW files of the respective frames of the master images constituting the track #1 are stored in the mdat box, so that the frame of the nth master image of the track #1 and the uuid of the RAW file of (the frame of) the master image are associated with each other and stored. In this case, the frame of a master image of the track #1 and the uuid of the RAW file of (the frame of) the master image can be associated with each other by the time information on the timeline.</p><p id="p-0190" num="0188">Note that the nth uuid (from the top) of the track #3 is the specific information about the RAW file of the nth frame of the track #1, and it can be understood that (the frames of) the master images constituting the track #1 and the uuids constituting the track #3 are associated with each other by the arrangement sequences in the tracks.</p><p id="p-0191" num="0189">In the associating sequence file, a trak box that manages the track #3 is added to the moov box, because the track #3 of the uuids of the RAW files is added to the mdat box.</p><p id="p-0192" num="0190">The trak box that manages the track #3 of the uuids of the RAW files stores a tkhd box, a tref box, an mdia box, and the like.</p><p id="p-0193" num="0191">The tkhd box of the trak box that manages the track #3 stores the track ID #3 for specifying the track #3, and the creation date and time of the track #3.</p><p id="p-0194" num="0192">The tref box of the trak box that manages the track #3 stores a track ID for specifying another track associated with the track #3 being managed by the trak box storing the tref box, information indicating the contents of the track #3, and the like. Since the uuids constituting the track #3 is the specific information about the RAW files of the master images constituting the track #1, and the track #3 is associated with the track #1, information indicating that another track associated with the track #3 is the track #1 (track ID=1) and that the track #3 is a track of metadata (specific information herein) (type=cdsc) is stored in the tref box of the trak box that manages the track #3 in <figref idref="DRAWINGS">FIG. <b>14</b></figref>.</p><p id="p-0195" num="0193">The mdia box of the trak box that manages the track #3 stores an hdlr box and a minf box. In the trak box that manages the track #3, information indicating that the data constituting the track #3 is metadata (of the master images) is stored in the hdlr box, and an stsc box, an stsc box, an stsz box, and an stco box for the track #3 are stored in the minf box.</p><p id="p-0196" num="0194">&#x3c;Generation and Reproduction of an HEIF File&#x3e;</p><p id="p-0197" num="0195"><figref idref="DRAWINGS">FIG. <b>15</b></figref> is a flowchart for explaining an outline of an example of a generation process for generating an associating HEIF file.</p><p id="p-0198" num="0196">In the generation process, in step S<b>11</b>, the file control unit <b>43</b> generates a uuid as specific information about the RAW file (RAW image) of the frame of a master image, and the process then moves on to step <b>312</b>.</p><p id="p-0199" num="0197">In step <b>312</b>, the file control unit <b>43</b> allocates the uuid generated in step S<b>11</b> to the RAW file (RAW image) of the frame of the master image, and the process then moves on to step S<b>13</b>.</p><p id="p-0200" num="0198">In step <b>313</b>, the file control unit <b>43</b> generates an associating HEIF file in which the frame of the master image and the uuid of the RAW file of the frame that are associated with each other are stored in an HEIF file, and then ends the generation process.</p><p id="p-0201" num="0199"><figref idref="DRAWINGS">FIG. <b>16</b></figref> is a flowchart for explaining an outline of an example of a reproduction process for reproducing an associating HEIF file.</p><p id="p-0202" num="0200">In the reproduction process, in step S<b>21</b>, the file control unit <b>43</b> generates a handle list of handles for identifying each of the frames of the master images stored in an HEIF file stored in the medium <b>14</b>, for example, and the process then moves on to step S<b>22</b>.</p><p id="p-0203" num="0201">Here, the handle of the frame of a master image includes the file name of the HEIF file in which the frame is stored. The handle of the frame (item) of a master image stored in a collection file further includes the item ID of the frame. The handle of the frame of a master image stored in a sequence file further includes time information about the frame. With the handle of the frame of a master image, the frame corresponding to the handle can be uniquely identified (specified).</p><p id="p-0204" num="0202">Note that the handle of the frame of a master image stored in the sequence file can include the track ID of the track including the frame, and the order of the frame (what the order of the frame is) in the track, instead of the time information about the frame.</p><p id="p-0205" num="0203">The time information about each frame is unique, regardless of whether the number of the tracks formed with the frames of master images stored in the sequence file is one or plural. Accordingly, with the time information about the frames, even if a plurality of tracks is stored in the sequence file, the frame of the time information included in the handle can be uniquely specified from the frames constituting each track of the plurality of tracks. Thus, in a case where the time information about the frame is included in the handle of the frame of a master image, the frame corresponding to the time information can be uniquely specified even if there is no track ID of the track in which the frame exists.</p><p id="p-0206" num="0204">The handle list can be generated for all the frames of the master images stored in the HEIF file stored in the medium <b>14</b>, or can be generated for only frames narrowed down under a specific condition, such as the frames of a specific creation date and time.</p><p id="p-0207" num="0205">After generating the handle list, the file control unit <b>43</b> accesses the HEIF file by referring to the handle list as necessary.</p><p id="p-0208" num="0206">In step S<b>22</b>, after waiting for the user to operate the digital camera <b>10</b> so as to display a thumbnail image or the like, for example, the UI control unit <b>47</b> requests the file control unit <b>43</b> to display the thumbnail image. In response to the thumbnail image display request from the UI control unit <b>47</b>, the file control unit <b>43</b> reads, from the HEIF file, (the frames of) the thumbnail images of the frames of the master images identified by the handles in the handle list. The file control unit <b>43</b> then causes the liquid crystal panel <b>19</b> (<figref idref="DRAWINGS">FIG. <b>1</b></figref>), for example, to display a list of the thumbnail images read from the HEIF file, and the process moves from step S<b>22</b> on to step S<b>23</b>.</p><p id="p-0209" num="0207">In step S<b>23</b>, after waiting for the user to select (the frame of) a desired thumbnail from the list of the thumbnail images or the like, for example, the UI control unit <b>47</b> requests the file control unit <b>43</b> to display the master image corresponding to the thumbnail image selected by the user. In response to the request for the master image from the UI control unit <b>47</b>, the file control unit <b>43</b> reads the master image from the HEIF file. The file control unit <b>43</b> can cause the liquid crystal panel <b>19</b> to display the master image read from the HEIF file, as necessary.</p><p id="p-0210" num="0208">Alternatively, the UI control unit <b>47</b> requests the file control unit <b>43</b> to supply the uuid of the RAW file of the master image corresponding to the thumbnail image selected by the user. In response to the uuid request from the UI control unit <b>47</b>, the file control unit <b>43</b> reads the uuid from the associating HEIF file. The file control unit <b>43</b> can access the RAW file specified by the uuid read from the associating HEIF file, as necessary.</p><p id="p-0211" num="0209"><figref idref="DRAWINGS">FIG. <b>17</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a collection file.</p><p id="p-0212" num="0210">In step S<b>31</b>, the file control unit <b>43</b> acquires the item ID of the reproduction target image that is the image (item) to be reproduced (this ID will be hereinafter also referred to as the reproduction target item ID), and the process then moves on to step S<b>32</b>.</p><p id="p-0213" num="0211">In the acquisition of the reproduction target item ID, the item ID of the reproduction target image (the reproduction target item ID) is acquired, the reproduction target image being the master image identified by a certain handle in the handle list, the thumbnail image of the master image, a thumbnail image selected by the user from the list of the thumbnail images (this thumbnail image will be hereinafter also referred to as the selected thumbnail image), the master image of the selected thumbnail image, or the like, for example.</p><p id="p-0214" num="0212">In step S<b>32</b>, the file control unit <b>43</b> reads the reproduction target image, in accordance with the reproduction target item ID acquired in step S<b>31</b>.</p><p id="p-0215" num="0213">In the reading of the reproduction target image, the reproduction target image specified by the reproduction target item ID is read from the collection file.</p><p id="p-0216" num="0214"><figref idref="DRAWINGS">FIG. <b>18</b></figref> is a flowchart for explaining an example of the process of reading the reproduction target image in step S<b>32</b> in <figref idref="DRAWINGS">FIG. <b>17</b></figref>.</p><p id="p-0217" num="0215">In step S<b>41</b>, the file control unit <b>43</b> retrieves the reproduction target item ID from the iloc box in the collection file (<figref idref="DRAWINGS">FIGS. <b>9</b> to <b>12</b></figref>), and the process then moves on to step S<b>42</b>.</p><p id="p-0218" num="0216">In step S<b>42</b>, the file control unit <b>43</b> reads the offset and the size associated with the reproduction target item ID retrieved in step S<b>41</b> in the iloc box, and the process then moves on to step S<b>43</b>.</p><p id="p-0219" num="0217">In step S<b>43</b>, in accordance with the offset and the size associated with the reproduction target item ID, the file control unit <b>43</b> reads the reproduction target image stored in the mdat box in the collection file, and the process comes to an end.</p><p id="p-0220" num="0218"><figref idref="DRAWINGS">FIG. <b>19</b></figref> is a flowchart for explaining a first example of the process of acquiring the reproduction target item ID in step S<b>31</b> in <figref idref="DRAWINGS">FIG. <b>17</b></figref>.</p><p id="p-0221" num="0219">That is, <figref idref="DRAWINGS">FIG. <b>19</b></figref> shows an example of acquisition of the item ID of a thumbnail image as the reproduction target image in a case where the reproduction target image is a thumbnail image.</p><p id="p-0222" num="0220">Note that, in <figref idref="DRAWINGS">FIG. <b>19</b></figref>, the file control unit <b>43</b> recognizes the item ID of the master image of the thumbnail image as the reproduction target image, from its handle, for example.</p><p id="p-0223" num="0221">In step S<b>51</b>, the file control unit <b>43</b> retrieves the thmb box whose reference source matches the item ID of the master image from among the thmb boxes in the iref box in the collection file (<figref idref="DRAWINGS">FIGS. <b>9</b> to <b>12</b></figref>), and the process then moves on to step S<b>52</b>.</p><p id="p-0224" num="0222">In step S<b>52</b>, the file control unit <b>43</b> reads the reference destination in the thmb box, which was retrieved in step S<b>51</b> and has the reference source matching the item ID of the master image, as the item ID of the thumbnail image as the reproduction target image, and the process comes to an end.</p><p id="p-0225" num="0223"><figref idref="DRAWINGS">FIG. <b>20</b></figref> is a flowchart for explaining a second example of the process of acquiring the reproduction target item ID in step S<b>31</b> in <figref idref="DRAWINGS">FIG. <b>17</b></figref>.</p><p id="p-0226" num="0224">That is, <figref idref="DRAWINGS">FIG. <b>20</b></figref> shows an example of acquisition of the item ID of a master image as the reproduction target image in a case where the reproduction target image is a master image.</p><p id="p-0227" num="0225">Note that, in <figref idref="DRAWINGS">FIG. <b>20</b></figref>, the user selects a thumbnail image (a selected thumbnail image) from the list of thumbnail images, and the file control unit <b>43</b> recognizes the item ID of the selected thumbnail image, for example.</p><p id="p-0228" num="0226">In step S<b>61</b>, the file control unit <b>43</b> retrieves the thmb box whose reference destination matches the item ID of the selected thumbnail image from among the thmb boxes in the iref box in the collection file (<figref idref="DRAWINGS">FIGS. <b>9</b> to <b>12</b></figref>), and the process then moves on to step S<b>62</b>.</p><p id="p-0229" num="0227">In step S<b>62</b>, the file control unit <b>43</b> reads the reference source in the thmb box, which was retrieved in step <b>361</b> and has the reference destination matching the item ID of the selected thumbnail image, as the item ID of the master image as the reproduction target image, and the process comes to an end.</p><p id="p-0230" num="0228"><figref idref="DRAWINGS">FIG. <b>21</b></figref> is a flowchart for explaining an example of a process of acquiring a uuid as the specific information about the RAW file of a predetermined master image from the first associating collection file shown in <figref idref="DRAWINGS">FIG. <b>10</b></figref>.</p><p id="p-0231" num="0229">Note that, in <figref idref="DRAWINGS">FIG. <b>21</b></figref>, the file control unit <b>43</b> recognizes the item ID of the predetermined master image from the handle list or the like, for example.</p><p id="p-0232" num="0230">In step S<b>71</b>, the file control unit <b>43</b> retrieves the item ID of the predetermined master image from the association information in the association information storage box in the first associating collection file (<figref idref="DRAWINGS">FIG. <b>10</b></figref>), and the process then moves on to step S<b>72</b>.</p><p id="p-0233" num="0231">In step S<b>72</b>, the file control unit <b>43</b> reads the uuid associated with the item ID of the predetermined master image retrieved in step S<b>71</b> in the association information, and the process comes to an end.</p><p id="p-0234" num="0232">With the uuid read in the above manner, the file control unit <b>43</b> can access the RAW file of the predetermined master image.</p><p id="p-0235" num="0233"><figref idref="DRAWINGS">FIG. <b>22</b></figref> is a flowchart for explaining an example of a process of acquiring a uuid as the specific information about the RAW file of a predetermined master image from the second associating collection file shown in <figref idref="DRAWINGS">FIG. <b>11</b></figref>.</p><p id="p-0236" num="0234">Note that, in <figref idref="DRAWINGS">FIG. <b>22</b></figref>, the file control unit <b>43</b> recognizes the item ID of the predetermined master image from the handle list or the like, for example.</p><p id="p-0237" num="0235">In step S<b>81</b>, the file control unit <b>43</b> retrieves the infe box of an item type IDIF indicating that the item is association information from among the infe boxes in the iinf box in the second associating collection file (<figref idref="DRAWINGS">FIG. <b>11</b></figref>), and the process then moves on to step S<b>82</b>.</p><p id="p-0238" num="0236">In step S<b>82</b>, the file control unit <b>43</b> reads the item ID of the association information as an item from the infe box of the item type IDIF retrieved in step S<b>81</b>, and the process then moves on to step S<b>83</b>.</p><p id="p-0239" num="0237">In step S<b>83</b>, the file control unit <b>43</b> retrieves the item ID of the association information read in step S<b>82</b>, from the iloc box in the second associating collection file, and the process then moves on to step S<b>84</b>.</p><p id="p-0240" num="0238">In step S<b>84</b>, the file control unit <b>43</b> reads the offset and the size associated with the item ID of the association information retrieved in step S<b>83</b> in the iloc box, and the process then moves on to step S<b>85</b>.</p><p id="p-0241" num="0239">In step S<b>85</b>, in accordance with the offset and the size associated with the item ID of the association information read in step S<b>84</b>, the file control unit <b>43</b> reads the association information as an item stored in the mdat box in the second associating collection file, and the process then moves on to step S<b>86</b>.</p><p id="p-0242" num="0240">In step S<b>86</b>, the file control unit <b>43</b> retrieves the item ID of the predetermined master image from the association information read in step S<b>85</b>, and the process then moves on to step S<b>87</b>.</p><p id="p-0243" num="0241">In step S<b>87</b>, the file control unit <b>43</b> reads the uuid associated with the item ID of the predetermined master image retrieved in step S<b>86</b> in the association information, and the process comes to an end.</p><p id="p-0244" num="0242">With the uuid read in the above manner, the file control unit <b>43</b> can access the RAW file of the predetermined master image.</p><p id="p-0245" num="0243"><figref idref="DRAWINGS">FIG. <b>23</b></figref> is a flowchart for explaining an example of a process of acquiring a uuid as the specific information about the RAW file of a predetermined master image from the third associating collection file shown in <figref idref="DRAWINGS">FIG. <b>12</b></figref>.</p><p id="p-0246" num="0244">Note that, in <figref idref="DRAWINGS">FIG. <b>23</b></figref>, the file control unit <b>43</b> recognizes the item ID of the predetermined master image from the handle list or the like, for example.</p><p id="p-0247" num="0245">In step S<b>91</b>, the file control unit <b>43</b> retrieves the cdsc box having the reference source matching the item ID of the predetermined master image from among the cdsc boxes in the iref box in the third associating collection file (<figref idref="DRAWINGS">FIG. <b>12</b></figref>), and the process then moves on to step S<b>92</b>.</p><p id="p-0248" num="0246">In step S<b>92</b>, the file control unit <b>43</b> reads the reference destination in the cdsc box, which was retrieved in step S<b>91</b> and has the reference source matching the item ID of the predetermined master image, as the item ID of the specific information about the RAW file of the predetermined master image as an item, and the process then moves on to step S<b>93</b>.</p><p id="p-0249" num="0247">In step S<b>93</b>, the file control unit <b>43</b> retrieves the item ID of the specific information as an item read in step S<b>92</b>, from the iloc box in the third associating collection file, and the process then moves on to step S<b>94</b>.</p><p id="p-0250" num="0248">In step S<b>94</b>, the file control unit <b>43</b> reads the offset and the size associated with the item ID of the specific information retrieved in step S<b>93</b> in the iloc box, and the process then moves on to step S<b>95</b>.</p><p id="p-0251" num="0249">In step S<b>95</b>, in accordance with the offset and the size associated with the item ID of the specific information read in step S<b>94</b>, the file control unit <b>43</b> reads the uuid as the specific information about the RAW file of the predetermined master image stored in the mdat box in the third associating collection file, and the process comes to an end.</p><p id="p-0252" num="0250">With the uuid read in the above manner, the file control unit <b>43</b> can access the RAW file of the predetermined master image.</p><p id="p-0253" num="0251"><figref idref="DRAWINGS">FIG. <b>24</b></figref> is a flowchart for explaining an example of a process of acquiring a list of the item IDs of master images from a collection file.</p><p id="p-0254" num="0252">The process of acquiring the list of the item IDs of master images from a collection file is performed in a case where a handle list is to be generated, or the like, for example.</p><p id="p-0255" num="0253">In step S<b>101</b>, the file control unit <b>43</b> reads item IDs from all the infe boxes in the iinf box in the collection file (<figref idref="DRAWINGS">FIGS. <b>9</b> to <b>12</b></figref>), and registers the item IDs in a list of the item IDs of master images (this list will be hereinafter also referred to as the master image list). The process then moves on to step S<b>102</b>.</p><p id="p-0256" num="0254">In step S<b>102</b>, the file control unit <b>43</b> reads the item IDs that are reference destinations from all the boxes in the iref box in the collection file, and eliminates the read item IDs from the master image list. The process then comes to an end.</p><p id="p-0257" num="0255">After the above process, the item IDs registered in the master image list are the item IDs of master images.</p><p id="p-0258" num="0256"><figref idref="DRAWINGS">FIG. <b>25</b></figref> is a flowchart for explaining an example of a process of reproducing, from a sequence file, the thumbnail image of (the frame of) the master image corresponding to predetermined time information.</p><p id="p-0259" num="0257">Note that, in <figref idref="DRAWINGS">FIG. <b>25</b></figref>, the file control unit <b>43</b> recognizes the time information about (or the order of) a predetermined master image from the handle list or the like, for example.</p><p id="p-0260" num="0258">In step S<b>111</b>, from among the trak boxes in the moov box in a sequence file (<figref idref="DRAWINGS">FIGS. <b>13</b> and <b>14</b></figref>), the file control unit <b>43</b> retrieves the trak box in which information indicating that the data constituting the track is thumbnail images is stored in the tref box, or the trak box in which the type in the tref box is &#x201c;thmb&#x201d;, as the trak box that manages the track of the thumbnail images of the master images corresponding to the predetermined time information. The process then moves on to step S<b>112</b>.</p><p id="p-0261" num="0259">In step S<b>112</b>, the file control unit <b>43</b> reads the track ID in the tkhd box in the trak box retrieved in step S<b>111</b>, as the track ID of the track of the thumbnail images of the master images corresponding to the predetermined time information. The process then moves on to step S<b>113</b>.</p><p id="p-0262" num="0260">In step S<b>113</b>, the file control unit <b>43</b> reproduces the track having the track ID read in step S<b>112</b>, and acquires (the frames of) the thumbnail images corresponding to the predetermined time information (or the order) from the track, as the thumbnail images of the master images corresponding to the predetermined time information. The process then comes to an end.</p><p id="p-0263" num="0261">Note that the process of reproducing the track of the images stored in the sequence file is similar to a process of reproducing a video image in an MP4 file.</p><p id="p-0264" num="0262"><figref idref="DRAWINGS">FIG. <b>26</b></figref> is a flowchart for explaining an example of a process of acquiring a uuid as the specific information about the RAW file of (the frame of) a predetermined master image from an associating sequence file.</p><p id="p-0265" num="0263">Note that, in <figref idref="DRAWINGS">FIG. <b>26</b></figref>, the file control unit <b>43</b> recognizes the time information about (or the order of) a predetermined master image from the handle list or the like, for example.</p><p id="p-0266" num="0264">In step S<b>121</b>, from among the trak boxes in the moov box in an associating sequence file (<figref idref="DRAWINGS">FIG. <b>14</b></figref>), the file control unit <b>43</b> retrieves the trak box in which information indicating that the data constituting the track is specific information is stored in the tref box, or the trak box in which the type in the tref box is &#x201c;cdsc&#x201d;, as the trak box that manages the track of specific information. The process then moves on to step S<b>122</b>.</p><p id="p-0267" num="0265">In step S<b>122</b>, the file control unit <b>43</b> reads the track ID in the tkhd box in the trak box retrieved in step S<b>121</b>, as the track ID of the track of specific information. The process then moves on to step S<b>123</b>.</p><p id="p-0268" num="0266">In step S<b>123</b>, from the track having the track ID read in step S<b>122</b>, the file control unit <b>43</b> acquires the uuid as the specific information corresponding to the time information about (or the order of) the predetermined master image, as the uuid of the RAW file of the predetermined master image. The process then comes to an end.</p><p id="p-0269" num="0267">With the uuid acquired in the above manner, the file control unit <b>43</b> can access the RAW file of the predetermined master image.</p><p id="p-0270" num="0268">As described above, the file control unit <b>43</b> generates and reproduces an associating HEIF file in which the master images in an HEIF file and the specific information for specifying external data outside the HEIF file are associated with each other and stored in the HEIF file compliant with HEIF. Thus, the master images stored in the HEIF file can be associated with external data outside the HEIF file.</p><p id="p-0271" num="0269">Further, in a case where uuids are used as the specific information, even if the file name of external data is changed, the association between the master images in the HEIF file and the external data after the change of the file name can be maintained by the uuids.</p><p id="p-0272" num="0270">&#x3c;Storage of Specific Information Assigned to External Data&#x3e;</p><p id="p-0273" num="0271"><figref idref="DRAWINGS">FIG. <b>27</b></figref> is a diagram showing an example of storage of uuids in RAW files in a case where RAW files of master images are adopted as (the files storing) external data, and an associating collection file is generated.</p><p id="p-0274" num="0272">Note that, in <figref idref="DRAWINGS">FIG. <b>27</b></figref>, the first associating collection file is adopted as the associating collection file.</p><p id="p-0275" num="0273">A RAW file has a region called a marker note (MakerNote) as part of the region storing the information accompanying Exif as metadata.</p><p id="p-0276" num="0274">The file control unit <b>43</b> can store the uuid assigned to the RAW file (a RAW image) into the marker note of the RAW file, for example.</p><p id="p-0277" num="0275">In <figref idref="DRAWINGS">FIG. <b>27</b></figref>, the master images Item #1, Item #2, Item #3, and Item #4 as four items are stored in the associating collection file, and RAW files #1, #2, #3, and #4 in which RAW images of the master images Item #1, Item #2, Item #3, and Item #4 are stored are generated. Further, a UUID #i is assigned to the RAW file #i (a RAW image), and, as association information for associating the master image Item #i with the UUID #i of the RAW file #i of the master image Item #i, association information for associating the item ID #i for specifying the master image Item #i with the UUID #i of the RAW file #i associated with the master image Item #i is stored in the association information storage box.</p><p id="p-0278" num="0276"><figref idref="DRAWINGS">FIG. <b>28</b></figref> is a diagram showing an example of storage of uuids in RAW files in a case where RAW files of master images are adopted as external data, and an associating sequence file is generated.</p><p id="p-0279" num="0277">In a case where an associating sequence file is generated, the file control unit <b>43</b> can also store the uuids assigned to RAW files in the marker notes of the RAW files, as in a case where an associating collection file is generated as described above with reference to <figref idref="DRAWINGS">FIG. <b>27</b></figref>.</p><p id="p-0280" num="0278">In <figref idref="DRAWINGS">FIG. <b>28</b></figref>, a track #1 formed with master images #1, #2, #3, and #4 as four frames is stored in the associating sequence file, and RAW files #1, #2, #3, and #4 in which RAW images of the master images #1, #2, #3, and #4 are stored are generated. Further, a UUID #i is assigned to the RAW file #i, and a track #3 in which the UUID #i of the RAW file #i is placed so as to have the same time information as the master image #i corresponding to the RAW file #i (a RAW image) is stored in the associating sequence file.</p><p id="p-0281" num="0279">As described above, the UUID #i of the RAW file #i is placed so as to have the same time information as the master image #i corresponding to the RAW file #i, and the track #3 is formed. Thus, the ith master image #i in the track #1 and the ith UUID #i in the track #3, which is the UUID #i of the RAW file #i of the master image #i, are associated with each other and stored in the associating sequence file.</p><p id="p-0282" num="0280">Although the RAW files (RAW images) of master images are adopted as external data in the above example, some other data can be adopted as external data. As the external data, the sound (voice) or the like recorded together with the imaging of the master images can be adopted, for example. As a file that stores sound, a WAV file in a WAV format, an MP4 file in an MP4 format, or the like can be adopted, for example. In the description below, WAV files are adopted as files that store sound, for example.</p><p id="p-0283" num="0281"><figref idref="DRAWINGS">FIG. <b>29</b></figref> is a diagram showing an example of storage of uuids in WAV files in a case where WAV files of master images are adopted as (the files storing) external data, and an associating collection file is generated.</p><p id="p-0284" num="0282">Note that, in <figref idref="DRAWINGS">FIG. <b>29</b></figref>, the first associating collection file is adopted as the associating collection file.</p><p id="p-0285" num="0283">A WAV file has a region called a List chunk as part of the region in which metadata is written.</p><p id="p-0286" num="0284">The file control unit <b>43</b> can store the uuids assigned to the WAV files (audio) into the List chunks of the WAV files, for example.</p><p id="p-0287" num="0285">In <figref idref="DRAWINGS">FIG. <b>29</b></figref>, the master images Item #1, Item #2, Item #3, and Item #4 as four items are stored in the associating collection file, and WAV files #1, #2, #3, and #4 of the master images Item #1, Item #2, Item #3, and Item #4 are generated. Further, a UUID #i is assigned to the WAV file #i (sound), and, as association information for associating the master image Item #i with the UUID #i of the WAV file #i of the master image Item #i, association information for associating the item ID #i for specifying the master image Item #i with the UUID #i of the WAV file #i associated with the master image Item #i is stored in the association information storage box.</p><p id="p-0288" num="0286"><figref idref="DRAWINGS">FIG. <b>30</b></figref> is a diagram showing an example of storage of uuids in WAV files in a case where WAV files of master images are adopted as external data, and an associating sequence file is generated.</p><p id="p-0289" num="0287">In a case where an associating sequence file is generated, the file control unit <b>43</b> can also store the uuids assigned to WAV files in the List chunks of the WAV files, as in a case where an associating collection file is generated as described above with reference to <figref idref="DRAWINGS">FIG. <b>29</b></figref>.</p><p id="p-0290" num="0288">In <figref idref="DRAWINGS">FIG. <b>30</b></figref>, a track #1 formed with master images #1, #2, #3, and #4 as four frames is stored in the associating sequence file, and WAV files #1, #2, #3, and #4 of the master images #1, #2, #3, and #4 are generated. Further, a UUID #i is assigned to the WAV file #i, and a track #3 in which the UUID #i of the WAV file #i is placed so as to have the same time information as the master image #i corresponding to the WAV file #i is stored in the associating sequence file.</p><p id="p-0291" num="0289">As described above, the UUID #i of the WAV file #i is placed so as to have the same time information as the master image #i corresponding to the WAV file #i, and the track #3 is formed. Thus, the ith master image #i in the track #1 and the ith UUID #i in the track #3, which is the UUID #i of the WAV file #i of the master image #i, are associated with each other and stored in the associating sequence file.</p><p id="p-0292" num="0290">Note that, the present technology can be applied not only to an HEIF file, but also to an ISO base media file, an MP4 file, a Miaf file, or the like that has a box structure different from an HEIF file, for example.</p><p id="p-0293" num="0291">Other than that, the present technology can also be applied to a file or the like that does not have a box structure, and stores images (master images) and other images with a lower resolution than the images, for example.</p><p id="p-0294" num="0292">Further, the present technology can be applied not only in a case where external data is associated with master images in an HEIF file, but also in a case where external data is associated with screen nail images or thumbnail images in an HEIF file.</p><p id="p-0295" num="0293">Other than that, the present technology can also be applied in a case where external data is associated with internal data that is not images like master images or the like in an HEIF file, for example.</p><p id="p-0296" num="0294">&#x3c;First Embodiment of an Image Processing System to which the Present Technology is Applied&#x3e;</p><p id="p-0297" num="0295"><figref idref="DRAWINGS">FIG. <b>31</b></figref> is a block diagram showing an example configuration of a first embodiment of an image processing system to which the present technology is applied.</p><p id="p-0298" num="0296">In <figref idref="DRAWINGS">FIG. <b>31</b></figref>, an image processing system <b>100</b> includes the digital camera <b>10</b> shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, and an external computer <b>101</b> such as a cloud computer, for example. The digital camera <b>10</b> and the external computer <b>101</b> can communicate with each other via a network such as the Internet.</p><p id="p-0299" num="0297">Here, there are cases where the user wishes to restrict viewing of an image captured by the digital camera <b>10</b>, to protect a so-called copyright or protect the portrait right or the like of the person appearing in the image.</p><p id="p-0300" num="0298">Therefore, in the image processing system <b>100</b>, an encrypted HEIF file using an associating HEIF file is generated by the digital camera <b>10</b>, so that viewing of images captured by the digital camera <b>10</b> can be restricted.</p><p id="p-0301" num="0299">Note that, in the description below, viewing of master images stored in an HEIF file is to be restricted, for ease of explanation. However, by the present technology, viewing of any desired media data other than master images stored in an HEIF file can be restricted. The present technology can also be applied to (a file compliant with) an ISO base media file other than an HEIF file, and further, can be applied to any appropriate file other than an ISO base media file.</p><p id="p-0302" num="0300">In the digital camera <b>10</b> (<figref idref="DRAWINGS">FIG. <b>1</b></figref>), the file control unit <b>43</b> can generate, as an encrypted HEIF file, an HEIF file in which an encrypted image obtained by encrypting a master image stored in an HEIF file with a first encryption key, and an encrypted encryption key obtained by encrypting the first encryption key with a second encryption key are associated with each other and stored.</p><p id="p-0303" num="0301">In associating an encrypted image stored in the encrypted HEIF file with the encrypted encryption key obtained by encrypting the first encryption key used in the encryption for obtaining the encrypted image, the file control unit <b>43</b> can use the association between the master images stored in an associating HEIF file and the specific information about external data. That is, the file control unit <b>43</b> can associate an encrypted image stored in the encrypted HEIF file with an encrypted encryption key, in a manner similar to that in the association between master images stored in an associating HEIF file and the specific information about external data.</p><p id="p-0304" num="0302">The file control unit <b>43</b> can also decrypt the encrypted encryption key of an encrypted HEIF file into the first encryption key, and, with the first encryption key obtained by the decryption, decrypt the encrypted image into the original master image.</p><p id="p-0305" num="0303">The digital camera <b>10</b> can request the external computer <b>101</b> to supply the first encryption key and the second encryption key. When there is a request for the first encryption key and the second encryption key from the digital camera <b>10</b>, the external computer <b>101</b> generates the first encryption key and the second encryption key, and provides (transmits) the first encryption key and the second encryption key to the digital camera <b>10</b>. Note that the first encryption key and the second encryption key can be generated by the digital camera <b>10</b>. Alternatively, one of the first encryption key and the second encryption key can be generated by the digital camera <b>10</b>, and the other can be generated by the external computer <b>101</b>.</p><p id="p-0306" num="0304">As the first encryption key and the second encryption key, encryption keys of any appropriate encryption scheme can be adopted. Also, as the first encryption key and the second encryption key, encryption keys of the same encryption scheme can be adopted, or encryption keys of different encryption schemes can be adopted.</p><p id="p-0307" num="0305">In this embodiment, a common key of a common key encryption scheme is adopted as the first encryption key, and a public key of a public key encryption scheme is adopted as the second encryption key, for example.</p><p id="p-0308" num="0306">Since the load of the process of generating a common key is smaller than the load of the process of generating a public key of a public key encryption scheme and a private key, a common key can be easily generated in the digital camera <b>10</b>. Further, with a common key, an image having a relatively large data amount can be encrypted or decrypted in a shorter time than that with a public key and a private key.</p><p id="p-0309" num="0307">Furthermore, by adopting a public key of a public key encryption scheme as the second encryption key, it is possible to increase the confidentiality of a common key encrypted with the public key.</p><p id="p-0310" num="0308">In this embodiment, a common key is generated by the digital camera <b>10</b>, and a public key and a private key are generated and managed by the external computer <b>101</b>.</p><p id="p-0311" num="0309">As described above, in the digital camera <b>10</b>, an HEIF file in which an encrypted image obtained by encrypting a master image stored in an HEIF file with a common key as the first encryption key, and an encrypted encryption key obtained by encrypting the common key with a public key as the second encryption key are associated with each other and stored is generated as an encrypted HEIF file. Thus, it is possible to restrict viewing of the master image so that only the user who can obtain (acquire) the private key corresponding to the public key used in the encryption for obtaining the encrypted encryption key (or the common key before being encrypted into the encrypted encryption key) can view the master image.</p><p id="p-0312" num="0310">In the description below, an encrypted HEIF file using (the association in) the third associating collection file shown in <figref idref="DRAWINGS">FIG. <b>12</b></figref> among associating HEIF files is explained, for example. However, as an encrypted HEIF file, an HEIF file using an associating HEIF file (the first associating collection file, the second associating collection file, or an associating sequence file) other than the third associating collection file can be generated.</p><p id="p-0313" num="0311">Note that, in the description of encrypted HEIF files below, the portions common with the HEIF files (including the associating HEIF files) already described will not be explained.</p><p id="p-0314" num="0312">&#x3c;Encrypted HEIF File&#x3e;</p><p id="p-0315" num="0313"><figref idref="DRAWINGS">FIG. <b>32</b></figref> is a diagram showing an example of a first encrypted HEIF file.</p><p id="p-0316" num="0314">In <figref idref="DRAWINGS">FIG. <b>32</b></figref>, items Item #1, Item #2, Item #201, and Item #202 are stored in the mdat box. The item Item #1 is an encrypted image obtained by encrypting a master image 1 with a common key (by a common key encryption scheme), and the item Item #2 is an encrypted image obtained by encrypting a master image 2 with a common key. Different common keys can be used to encrypt different master images. For example, the common key that is used in the encryption for obtaining the encrypted image as the item Item #1 (this encrypted image will be hereinafter also written as the encrypted image Item #1), and the common key that is used in the encryption for obtaining the encrypted image Item #2 are different common keys. Note that the same common key can be used to encrypt different master images, where necessary.</p><p id="p-0317" num="0315">The item Item #201 is an encrypted encryption key obtained by encrypting the common key used in the decryption of the master image 1 with a public key (by a public key encryption scheme), and the item Item #202 is an encrypted encryption key obtained by encrypting the common key used in the encryption of the master image 2 with a public key. Different public keys (corresponding to private keys) can be used to encrypt different public keys. For example, the public key that is used in the encryption for obtaining the encrypted encryption key as the item Item #201 (this encrypted encryption key will be hereinafter also written as the encrypted encryption key Item #201), and the public key that is used in the encryption for obtaining the encrypted encryption key Item #202 are different public keys. Note that the same public key can be used to encrypt different common keys, where necessary.</p><p id="p-0318" num="0316">In <figref idref="DRAWINGS">FIG. <b>32</b></figref>, a white lock indicates that the item is encrypted with a common key, and a shaded lock indicates that the item is encrypted with a public key. The same applies in the drawings described later.</p><p id="p-0319" num="0317">In the first encrypted HEIF file, association information for associating an encrypted image Item #i stored in the mdat box with an encrypted encryption key Item #200+i obtained by encrypting the common key used in the encryption for obtaining the encrypted image Item #i with a public key is stored in the meta box so that the encrypted image Item #i and the encrypted encryption key Item #200+i are associated with each other, as in the third associating collection file (<figref idref="DRAWINGS">FIG. <b>12</b></figref>) in which association information for associating a master image stored in the mdat box with specific information is stored in the meta box so that the master image and the specific information are associated with each other, for example.</p><p id="p-0320" num="0318">The association information for associating the encrypted image Item #i with the encrypted encryption key Item #200+i is information that associates the item ID #i of the encrypted image Item #i with the item ID of the encrypted encryption key Item #200+i, and is stored in a cdsc box stored in the iref box in the meta box, as in the third associating collection file.</p><p id="p-0321" num="0319">In <figref idref="DRAWINGS">FIG. <b>32</b></figref>, a cdsc box storing the association information in which the item ID #1 of the encrypted image Item #1, and the item ID #201 of the encrypted encryption key Item #201 obtained by encrypting the common key used in the encryption for obtaining the encrypted image Item #1 with a public key are associated with each other as a reference source and a reference destination is stored in the iref box, and a cdsc box storing the association information in which the item ID #2 of the encrypted image Item #2, and the item ID #202 of the encrypted encryption key Item #202 obtained by encrypting the common key used in the encryption for obtaining the encrypted image Item #2 with a public key are associated with each other as a reference source and a reference destination is stored in the iref box.</p><p id="p-0322" num="0320">As for the encrypted image Item #i stored in the first encrypted HEIF file, in a case where the private key corresponding to the encrypted image Item #i, which is the private key corresponding to the public key used in the encryption of the common key used in the encryption for obtaining the encrypted image Item #i, can be obtained, the file control unit <b>43</b> can decrypt the encrypted encryption key Item #200+i associated with the encrypted image Item #i into the common key with the private key, and decrypt the encrypted image Item #i into the original master image i with the common key obtained by the decryption. Thus, viewing of the master image i can be restricted to the user who can obtain the private key corresponding to the encrypted image Item #i.</p><p id="p-0323" num="0321">In the infe box of the encrypted encryption key Item #200+i in the first encrypted HEIF file, the item type (Item Type) of the encrypted encryption key Item #200+i is set as ECKI (Encryption key for Item) indicating an encryption key (a common key in this case), for example. The attribute value of the item time indicating an encryption key is not necessarily ECKI. In a case where the encrypted image Item #i is to be decrypted, the file control unit <b>43</b> specifies the item ID of the reference destination in the cdsc box having the reference source indicating the item ID #i of the encrypted image Item #i, as the item ID #200+i of the encrypted encryption key Item #200+i corresponding to the encrypted image Item #i, or of the encrypted encryption key Item #200+i obtained by encrypting the common key used in the encryption of the encrypted image Item #i. In accordance with the item ID #200+i, the file control unit <b>43</b> acquires (reads) the encrypted encryption key Item #200+i having the item ID #200+i from the mdat box, and performs decryption. Whether or not the item specified by the item ID of the reference destination in a cdsc box is an encrypted encryption key can be recognized (determined) from the item type set in the infe box of the item specified by the item ID.</p><p id="p-0324" num="0322"><figref idref="DRAWINGS">FIG. <b>33</b></figref> is a diagram showing an example of a second encrypted HEIF file.</p><p id="p-0325" num="0323">In <figref idref="DRAWINGS">FIG. <b>33</b></figref>, the encrypted images Item #1 and Item #2, and the encrypted encryption keys Item #201 and Item #202 are stored in the mdat box, as in <figref idref="DRAWINGS">FIG. <b>32</b></figref>. Further, in <figref idref="DRAWINGS">FIG. <b>33</b></figref>, plain text common keys Item #301 and Item #302 are stored in the mdat box. The encrypted encryption key Item #200+i is obtained by encrypting the plain text common key Item #300+i as an item with a private key. Here, plain text means data in an unencrypted state.</p><p id="p-0326" num="0324">In the second encrypted HEIF file, the plain text common key Item #300+i is associated with (the master image i corresponding to) the encrypted image Item #i, like the encrypted encryption key Item #200+i corresponding to the common key Item #300+i, or the encrypted encryption key Item #200+i obtained by encrypting the common key Item #300+i.</p><p id="p-0327" num="0325">In <figref idref="DRAWINGS">FIG. <b>33</b></figref>, in addition to the cdsc boxes shown in <figref idref="DRAWINGS">FIG. <b>32</b></figref>, a cdsc box storing association information in which the item ID #1 of the encrypted image Item #1, and the item ID #301 of the plain text common key Item #301 (the common key Item #301 used in the encryption for obtaining the encrypted image Item #1) corresponding to the encrypted image Item #1 are associated with each other as a reference source and a reference destination is stored in the iref box. Further, a cdsc box storing association information in which the item ID #2 of the encrypted image Item #2, and the item ID #302 of the plain text common key Item #302 corresponding to the encrypted image Item #2 are associated with each other as a reference source and a reference destination is stored in the iref box.</p><p id="p-0328" num="0326">In the second encrypted HEIF file, the plain text common key Item #300+i stored in the mdat box can be deleted in accordance with the user's operation. For example, in a case where viewing of the master image i obtained by decrypting the encrypted image Item #i is restricted to a specific user (the user who can obtain the private key corresponding to the encrypted image Item #i), the file control unit <b>43</b> deletes the plain text common key Item #300+i stored in the mdat box in accordance with the user's operation. With this arrangement, the encrypted image Item #i cannot be decrypted, unless the private key corresponding to the encrypted image Item #i is successfully obtained.</p><p id="p-0329" num="0327">That is, in a case where the plain text common key Item #300+i is not stored in the mdat box, the encrypted image Item #i cannot be decrypted, unless the private key corresponding to the encrypted image Item #i is successfully obtained. In a case where the private key corresponding to the encrypted image Item #i can be obtained, the file control unit <b>43</b> can decrypt the encrypted encryption key Item #200+i associated with the encrypted image Item #i stored in the second encrypted HEIF file into the common key with the corresponding private key, and decrypt the encrypted image Item #i into the original master image i with the common key obtained by the decryption, as with the first encrypted HEIF file.</p><p id="p-0330" num="0328">On the other hand, in a case where the plain text common key Item #300+i is stored in the mdat box, the file control unit <b>43</b> can decrypt the encrypted image Item #i into the original master image i with the plain text common key Item #300+i associated with the encrypted image Item #i stored in the second encrypted HEIF file.</p><p id="p-0331" num="0329">Accordingly, in a case where the plain text common key Item #300+i is stored in the mdat box in the second encrypted HEIF file, the encrypted image Item #i can be decrypted into the master image i, and any user can view the master image i, regardless of acquisition of the private key corresponding to the encrypted image Item #i.</p><p id="p-0332" num="0330">In view of the above, with the second encrypted HEIF file, the user can allow any user to view a master image that does not need to be restricted in viewing, by leaving the plain text common key associated with (the encrypted image obtained by encrypting) the master image in the mdat box. Further, as for a master image that is to be restricted in viewing, the user can restrict viewing by any user, by deleting, from the mdat box, the plain text common key associated with the master image.</p><p id="p-0333" num="0331">Note that, in the infe box of the plain text common key Item #300+i in the second encrypted HEIF file, the item type (Item Type) of the plain text common key Item #300+i is set as ECKI indicating an encryption key, as in the infe box of the encrypted encryption key Item #200+i.</p><p id="p-0334" num="0332"><figref idref="DRAWINGS">FIG. <b>34</b></figref> is a diagram showing an example of a third encrypted HEIF file.</p><p id="p-0335" num="0333">In <figref idref="DRAWINGS">FIG. <b>34</b></figref>, the encrypted images Item #1 and Item #2, and the encrypted encryption keys Item #201 and Item #202 are stored in the mdat box, as in <figref idref="DRAWINGS">FIG. <b>32</b></figref>.</p><p id="p-0336" num="0334">In the third encrypted HEIF file, however, the encrypted encryption key Item #200+i is a specific-information-containing encryption key obtained by encrypting the uuid as the specific information for specifying the external data associated with the master image i and the common key used in the encryption of the master image i with a private key, and will be hereinafter also written as the specific-information-containing encryption key Item #200+i.</p><p id="p-0337" num="0335">In the third encrypted HEIF file in <figref idref="DRAWINGS">FIG. <b>34</b></figref>, the encrypted image Item #1 obtained by encrypting the master image 1 with a common key, the UUID #1 assigned to (the RAW data stored in) the RAW file ARW #1 associated with the master image 1, and the specific-information-containing encryption key Item #201 obtained by encrypting the common key used in the encryption of the master image 1 with a private key are associated with one another by the association information stored in a cdsc box in the iref box, and are stored in the mdat box. Further, the encrypted image Item #2 obtained by encrypting the master image 2 with a common key, the UUID #2 assigned to the WAV file WAV #2 associated with the master image 2, and the specific-information-containing encryption key Item #202 obtained by encrypting the common key used in the encryption of the master image 2 with a private key are associated with one another by the association information stored in a cdsc box in the iref box, and are stored in the mdat box.</p><p id="p-0338" num="0336">With the third encrypted HEIF file, in a case where the private key corresponding to the encrypted image Item #i stored in the third encrypted HEIF file can be obtained, the file control unit <b>43</b> can decrypt the specific-information-containing encryption key Item #200+i associated with the encrypted image Item #i into the common key and the UUID #i with the private key, and decrypt the encrypted image Item #i into the original master image i with the common key obtained by the decryption, as with the first encrypted HEIF file. Thus, viewing of the master image i can be restricted to the user who can obtain the private key corresponding to the encrypted image Item #i.</p><p id="p-0339" num="0337">Further, with the third encrypted HEIF file, in a case where the private key corresponding to the encrypted image Item #i can be obtained, it is possible to access the external data specified by the UUID #i obtained by decrypting the specific-information-containing encryption key Item #200+i with the private key, or the external data associated with the master image i. Thus, access to the external data associated with the master image i can be restricted to the user who can obtain the private key corresponding to the encrypted image Item #i. Further, falsification of the uuid as the specific information about the external data associated with the master image i can be prevented.</p><p id="p-0340" num="0338"><figref idref="DRAWINGS">FIG. <b>35</b></figref> is a diagram showing an example of a fourth encrypted HEIF file.</p><p id="p-0341" num="0339">In <figref idref="DRAWINGS">FIG. <b>35</b></figref>, the fourth encrypted HEIF file is designed in a manner similar to the third encrypted HEIF file (<figref idref="DRAWINGS">FIG. <b>34</b></figref>).</p><p id="p-0342" num="0340">However, with the fourth encrypted HEIF file, the external data associated with the master image i is encrypted with the common key used in the encryption of the master image i. In <figref idref="DRAWINGS">FIG. <b>35</b></figref>, (the RAW data stored in) the RAW file ARW #1 is encrypted with the common key used in the encryption of the master image 1 associated with the RAW file ARW #1. Further, (the sound stored in) the WAV file WAV #2 is encrypted with the common key used in the encryption of the master image 2 associated with the WAV file WAV #2.</p><p id="p-0343" num="0341">With the fourth encrypted HEIF file, in a case where the private key corresponding to the encrypted image Item #i stored in the fourth encrypted HEIF file can be obtained, the file control unit <b>43</b> can decrypt the specific-information-containing encryption key Item #200+i associated with the encrypted image Item #i into the common key and the UUID #i with the private key, and decrypt the encrypted image Item #i into the original master image i with the common key obtained by the decryption, as with the third encrypted HEIF file. Thus, viewing of the master image i can be restricted to the user who can obtain the private key corresponding to the encrypted image Item #i.</p><p id="p-0344" num="0342">Further, with the fourth encrypted HEIF file, in a case where the private key corresponding to the encrypted image Item #i can be obtained, it is possible to access the encrypted external data specified by the UUID #i obtained by decrypting the specific-information-containing encryption key Item #200+i with the private key, or the encrypted external data associated with the master image i, and further to decrypt the encrypted external data into the original external data with the common key obtained by decrypting the specific-information-containing encryption key Item #200+i. Thus, viewing and the like of the external data associated with the master image i can be restricted to the user who can obtain the private key corresponding to the encrypted image Item #i. Further, falsification of the uuid as the specific information about the external data associated with the master image i can be prevented.</p><p id="p-0345" num="0343"><figref idref="DRAWINGS">FIG. <b>36</b></figref> is a diagram showing an example of a fifth encrypted HEIF file.</p><p id="p-0346" num="0344">In <figref idref="DRAWINGS">FIG. <b>36</b></figref>, the encrypted images Item #1 and Item #2, and the specific-information-containing encryption keys Item #201 and Item #202 are stored in the mdat box, as in <figref idref="DRAWINGS">FIG. <b>34</b></figref>. Further, in <figref idref="DRAWINGS">FIG. <b>36</b></figref>, the mdat box stores a set (hereinafter, also referred to as a common key set) Item #301 of a plain text common key and UUID #1 as specific information, and a common key set Item #302 of a plain text common key and UUID #2 as specific information.</p><p id="p-0347" num="0345">The common key forming the common key set Item #300+i is a common key used in the encryption of the master image i. Meanwhile, the UUID #i forming the common key set Item #300+i is the uuid serving as the specific information for specifying the external data associated with (the encrypted image Item #i obtained by encrypting) the master image i. The specific-information-containing encryption key Item #200+i is obtained by encrypting the common key set Item #300+i with a private key.</p><p id="p-0348" num="0346">In the fifth encrypted HEIF file, the common key set Item #300+i of a plain text common key and UUID #i is associated with the encrypted image Item #i and stored, like the specific-information-containing encryption key Item #200+i obtained by encrypting the common key set Item #300+i.</p><p id="p-0349" num="0347">In <figref idref="DRAWINGS">FIG. <b>36</b></figref>, in addition to the cdsc boxes shown in <figref idref="DRAWINGS">FIG. <b>34</b></figref>, a cdsc box storing association information in which the item ID #1 of the encrypted image Item #1, and the item ID #301 of the common key set Item #301 are associated with each other as a reference source and a reference destination is stored in the iref box. Further, a cdsc box storing association information in which the item ID #2 of the encrypted image Item #2, and the item ID #302 of the common key set Item #302 are associated with each other as a reference source and a reference destination is stored in the iref box.</p><p id="p-0350" num="0348">In the fifth encrypted HEIF file, the (plain text) common key set Item #300+i stored in the mdat box can be deleted in accordance with the user's operation. For example, in a case where viewing of the master image i obtained by decrypting the encrypted image Item #i is restricted to a specific user, the file control unit <b>43</b> deletes the common key set Item #300+i stored in the mdat box in accordance with the user's operation. With this arrangement, the encrypted image Item #i cannot be decrypted, unless the private key corresponding to the encrypted image Item #i is successfully obtained. Further, the external data associated with (the master image i corresponding to) the encrypted image Item #i cannot be accessed, unless the private key corresponding to the encrypted image Item #i is successfully obtained.</p><p id="p-0351" num="0349">That is, in a case where the common key set Item #300+i is not stored in the mdat box, the encrypted image Item #i cannot be decrypted, and the external data associated with the encrypted image Item #i cannot be accessed, unless the private key corresponding to the encrypted image Item #i is successfully obtained. In a case where the private key corresponding to the encrypted image Item #i can be obtained, the file control unit <b>43</b> can decrypt the specific-information-containing encryption key Item #200+i associated with the encrypted image Item #i stored in the fifth encrypted HEIF file into the common key and the UUID #i with the corresponding private key, and decrypt the encrypted image Item #i into the original master image i with the common key obtained by the decryption, as with the third encrypted HEIF file (<figref idref="DRAWINGS">FIG. <b>34</b></figref>). Further, the external data (the RAW file ARW #1 or the WAV file WAV #2 in this case) associated with the encrypted image Item #i can be accessed, in accordance with the UUID #i obtained by decrypting the specific-information-containing encryption key Item #200+i.</p><p id="p-0352" num="0350">On the other hand, in a case where the common key set Item #300+i is stored in the mdat box, the file control unit <b>43</b> can decrypt the encrypted image Item #i into the original master image i with the common key forming the common key set Item #300+i associated with the encrypted image Item #i stored in the fifth encrypted HEIF file. Further, the file control unit <b>43</b> can access the external data associated with the encrypted image Item #i, in accordance with the UUID #i forming the common key set Item #300+i associated with the encrypted image Item #i stored in the fifth encrypted HEIF file.</p><p id="p-0353" num="0351">Accordingly, in a case where the (plain text) common key set Item #300+i is stored in the mdat box in the fifth encrypted HEIF file, any user can view the master image i and access the external data associated with the master image i, regardless of acquisition of the private key corresponding to the encrypted image Item #i.</p><p id="p-0354" num="0352">In view of the above, with the fifth encrypted HEIF file, the user can allow any appropriate user to view a master image that does not need to be restricted in viewing, by leaving the common key set associated with the master image in the mdat box. Further, it is possible to allow any appropriate user to access the external data associated with such a master image.</p><p id="p-0355" num="0353">Meanwhile, as for a master image that is to be restricted in viewing, the user can restrict viewing by any user, by deleting, from the mdat box, the common key set associated with the master image. Further, it is possible to restrict any user from accessing the external data associated with such a master image.</p><p id="p-0356" num="0354">Note that, in the infe box of the common key set Item #300+i (the infe box of the item ID #300+i) in the fifth encrypted HEIF file, the item type (Item Type) of the common key set Item #300+i is set as ECKI indicating an encryption key, as in the infe box of the specific-information-containing encryption key Item #200+i.</p><p id="p-0357" num="0355"><figref idref="DRAWINGS">FIG. <b>37</b></figref> is a diagram showing an example of a sixth encrypted HEIF file.</p><p id="p-0358" num="0356">In <figref idref="DRAWINGS">FIG. <b>37</b></figref>, the sixth encrypted HEIF file is designed in a manner similar to the fifth encrypted HEIF file (<figref idref="DRAWINGS">FIG. <b>36</b></figref>).</p><p id="p-0359" num="0357">However, with the sixth encrypted HEIF file, the external data associated with the master image i is encrypted with the common key used in the encryption of the master image i, as with the fourth encrypted HEIF file (<figref idref="DRAWINGS">FIG. <b>35</b></figref>). In <figref idref="DRAWINGS">FIG. <b>37</b></figref>, the RAW file ARW #1 is encrypted with the common key used in the encryption of the master image 1 associated with the RAW file ARW #1, and the WAV file WAV #2 is encrypted with the common key used in the encryption of the master image 2 associated with the WAV file WAV #2.</p><p id="p-0360" num="0358">With the sixth encrypted HEIF file, in a case where the common key set Item #300+i is not deleted but remains stored in the mdat box, the file control unit <b>43</b> can decrypt the encrypted image Item #i into the original master image i with the common key forming the common key set Item #300+i associated with the encrypted image Item #i stored in the sixth encrypted HEIF file, as with the fifth encrypted HEIF file. Further, the file control unit <b>43</b> can access the encrypted external data associated with the encrypted image Item #i in accordance with the UUID #i forming the common key set Item #300+i associated with the encrypted image Item #i stored in the sixth encrypted HEIF file, and decrypt the encrypted external data into the original external data with the common key forming the common key set Item #300+i.</p><p id="p-0361" num="0359">Accordingly, in a case where the (plain text) common key set Item #300+i is stored in the mdat box in the sixth encrypted HEIF file, any appropriate user can view the master image i, and, for viewing and the like, access the external data associated with the master image i, regardless of acquisition of the private key corresponding to the encrypted image Item #i.</p><p id="p-0362" num="0360">Meanwhile, as for a master image i that is to be restricted in viewing, the user can restrict viewing by any user, by deleting, from the mdat box, the common key set Item #300+i associated with the master image i. Further, regarding the external data associated with such a master image i, access, viewing, and the like by any user can be restricted. Also, falsification of the uuid as the specific information about the external data associated with the master image i can be prevented.</p><p id="p-0363" num="0361">Further, with the sixth encrypted HEIF file, in a case where the private key corresponding to the encrypted image Item #i obtained by encrypting a master image i can be obtained even after the common key set Item #300+i associated with the master image i is deleted from the mdat box, the file control unit <b>43</b> can decrypt the specific-information-containing encryption key Item #200+i associated with the encrypted image Item #i into the common key and the UUID #i with the private key, and decrypt the encrypted image Item #i into the original master image i with the common key obtained by the decryption. Thus, viewing of the master image i can be restricted to the user who can obtain the private key corresponding to the encrypted image Item #i.</p><p id="p-0364" num="0362">Further, with the sixth encrypted HEIF file, when the private key corresponding to the encrypted image Item #i can be obtained, it is possible to access the encrypted external data specified by the UUID #i obtained by decrypting the specific-information-containing encryption key Item #200+i with the private key, or the encrypted external data associated with the master image i, and further to decrypt the encrypted external data into the original external data with the common key obtained by decrypting the specific-information-containing encryption key Item #200+i. Thus, viewing and the like of the external data associated with the master image i can be restricted to the user who can obtain the private key corresponding to the encrypted image Item #i. Further, falsification of the uuid as the specific information about the external data associated with the master image i can be prevented.</p><p id="p-0365" num="0363"><figref idref="DRAWINGS">FIG. <b>38</b></figref> is a flowchart for explaining an example of the preprocessing to be performed in a case where a first encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0366" num="0364">The preprocessing is performed immediately after the manufacture of the digital camera <b>10</b>, before imaging by the digital camera <b>10</b>, or the like, for example</p><p id="p-0367" num="0365">In the preprocessing, in step S<b>211</b>, the digital camera <b>10</b> of the image processing system <b>100</b> transmits a public key request to the external computer <b>101</b>, and the process then moves on to step S<b>212</b>.</p><p id="p-0368" num="0366">In step S<b>212</b>, the external computer <b>101</b> receives the public key request from the digital camera <b>10</b>, and, in response to the public key request, generates the private key corresponding to the public key. The process then moves on to step S<b>213</b>.</p><p id="p-0369" num="0367">In step S<b>213</b>, the external computer <b>101</b> transmits the public key to the digital camera <b>10</b>, and the process then moves on to step S<b>214</b>.</p><p id="p-0370" num="0368">In step S<b>214</b>, the digital camera <b>10</b> stores the public key supplied from the external computer <b>101</b> into the medium <b>14</b> or the like, and the preprocessing then comes to an end.</p><p id="p-0371" num="0369">Note that the digital camera <b>10</b> can transmit, to the external computer <b>101</b>, a request for the same number of public keys as the number of master images that can be stored in the medium <b>14</b>, in accordance with the remaining capacity or the like of the medium <b>14</b> that stores the first encrypted HEIF file, for example. In this case, the external computer <b>101</b> generates the same number of public keys as the requested public keys, and the generated public keys are stored into the digital camera <b>10</b>. With a different public key for each master image, the digital camera <b>10</b> encrypts the common key used in the encryption of the master image.</p><p id="p-0372" num="0370"><figref idref="DRAWINGS">FIG. <b>39</b></figref> is a flowchart for explaining an example of a generation process for generating a first encrypted HEIF file in a case where the first encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0373" num="0371">The generation process is started in a case where the user operates the digital camera <b>10</b> so as to capture an image (a master image) or the like, for example.</p><p id="p-0374" num="0372">In the generation process, in step S<b>221</b>, the digital camera <b>10</b> captures an image, in accordance with the user's operation, for example, and the process then moves on to step S<b>222</b>.</p><p id="p-0375" num="0373">In step S<b>222</b>, the file control unit <b>43</b> of the digital camera <b>10</b> generates a common key, and the process then moves on to step S<b>223</b>.</p><p id="p-0376" num="0374">In step S<b>223</b>, the file control unit <b>43</b> generates an encrypted image by encrypting the master image obtained by capturing an image in step S<b>221</b>, with the common key generated in step S<b>222</b>. The process then moves on to step S<b>224</b>.</p><p id="p-0377" num="0375">In step S<b>224</b>, the file control unit <b>43</b> selects a public key of interest that is one of the public keys not yet used for encrypting a common key, from among the public keys stored in the preprocessing. Further, the file control unit <b>43</b> generates an encrypted encryption key by encrypting the common key used in the encryption of the master image, with the public key of interest. The process then moves from step S<b>224</b> on to step S<b>225</b>.</p><p id="p-0378" num="0376">In step S<b>225</b>, the file control unit <b>43</b> generates the first encrypted HEIF file in which the encrypted image generated in step S<b>223</b> and the encrypted encryption key generated in step S<b>224</b> are associated with each other and stored. The generation process then comes to an end.</p><p id="p-0379" num="0377"><figref idref="DRAWINGS">FIG. <b>40</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a first encrypted HEIF file in a case where the first encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0380" num="0378">The reproduction process is started in a case where the user operates the digital camera <b>10</b> so as to reproduce an image (a master image) or the like, for example.</p><p id="p-0381" num="0379">In the reproduction process, in step S<b>231</b>, the file control unit <b>43</b> of the digital camera <b>10</b> selects the first encrypted HEIF file to be reproduced in accordance with the user's operation, for example, and selects the reproduction target encrypted image from the first encrypted HEIF file. Further, the file control unit <b>43</b> acquires (reads) the encrypted encryption key associated with the reproduction target encrypted image (or the encrypted encryption key corresponding to the encrypted image) from the first encrypted HEIF file to be reproduced, and the process then moves from step S<b>231</b> on to step S<b>232</b>.</p><p id="p-0382" num="0380">In step S<b>232</b>, the file control unit <b>43</b> attempts to acquire the private key corresponding to the reproduction target encrypted image, and the process then moves on to step S<b>233</b>.</p><p id="p-0383" num="0381">For example, the file control unit <b>43</b> requests the external computer <b>101</b> to supply the private key corresponding to the reproduction target encrypted image. The external computer <b>101</b> stores beforehand the user ID and the password that are associated with the private key corresponding to the encrypted image, for example. The external computer <b>101</b> prompts the user of the digital camera <b>10</b> to input the user ID and the password, waits for an input of the user ID and the password, and performs authentication. In a case where the authentication is successful, or a case where the user ID and the password stored and associated with the private key corresponding to the reproduction target encrypted image match the user ID and the password input by the user, for example, the external computer <b>101</b> transmits the private key corresponding to the reproduction target encrypted image to the digital camera <b>10</b>.</p><p id="p-0384" num="0382">In a case where the authentication fails, on the other hand, the external computer <b>101</b> informs the digital camera <b>10</b> to that effect.</p><p id="p-0385" num="0383">In the digital camera <b>10</b>, in a case where the private key corresponding to the reproduction target encrypted image is transmitted from the external computer <b>101</b>, the file control unit <b>43</b> acquires the private key.</p><p id="p-0386" num="0384">In step S<b>233</b>, a check is made to determine whether the file control unit <b>43</b> has successfully acquired the private key in the above manner.</p><p id="p-0387" num="0385">If it is determined in step S<b>233</b> that the private key has not been successfully acquired, the process moves on to step S<b>234</b>. In step S<b>234</b>, the digital camera <b>10</b> performs error processing, and causes the liquid crystal panel <b>19</b> to display an error message indicating that image decryption has failed, or the like, for example. The reproduction process then comes to an end. Therefore, the user who cannot obtain the private key corresponding to the reproduction target encrypted image cannot view the master image obtained by decrypting the reproduction target encrypted image.</p><p id="p-0388" num="0386">If it is determined in step S<b>233</b> that the private key has been successfully acquired, on the other hand, the process moves on to step S<b>235</b>.</p><p id="p-0389" num="0387">In step S<b>235</b>, the file control unit <b>43</b> decrypts the encrypted encryption key acquired in step S<b>231</b> into the common key, with the private key acquired in step S<b>232</b>. The process then moves on to step S<b>236</b>.</p><p id="p-0390" num="0388">In step S<b>236</b>, the file control unit <b>43</b> decrypts the reproduction target encrypted image into the master image with the common key decrypted in step S<b>236</b>, and causes the liquid crystal panel <b>19</b> to display the master image. The reproduction process then comes to an end.</p><p id="p-0391" num="0389"><figref idref="DRAWINGS">FIG. <b>41</b></figref> is a flowchart for explaining an example of the preprocessing to be performed in a case where a second encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0392" num="0390">In the preprocessing shown in <figref idref="DRAWINGS">FIG. <b>41</b></figref>, in steps S<b>251</b> to S<b>254</b>, processes similar to those in respective steps S<b>211</b> to S<b>214</b> in the preprocessing shown in <figref idref="DRAWINGS">FIG. <b>38</b></figref> are performed.</p><p id="p-0393" num="0391"><figref idref="DRAWINGS">FIG. <b>42</b></figref> is a flowchart for explaining an example of a generation process for generating a second encrypted HEIF file in a case where the second encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0394" num="0392">In the generation process shown in <figref idref="DRAWINGS">FIG. <b>42</b></figref>, in steps S<b>261</b> to S<b>264</b>, processes similar to those in respective steps S<b>221</b> to S<b>224</b> in the generation process shown in <figref idref="DRAWINGS">FIG. <b>39</b></figref> are performed.</p><p id="p-0395" num="0393">Further, in step S<b>265</b>, the file control unit <b>43</b> generates the second encrypted HEIF file in which the encrypted image generated in step S<b>263</b>, the common key generated in step S<b>262</b>, and the encrypted encryption key generated in step S<b>264</b> are associated with one another and stored. The generation process then comes to an end.</p><p id="p-0396" num="0394"><figref idref="DRAWINGS">FIG. <b>43</b></figref> is a flowchart for explaining an example of a restriction process for restricting viewing of a master image obtained by decrypting an encrypted image only to the user who can obtain the private key corresponding to the encrypted image, in a case where a second encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0397" num="0395">For example, when the user operates the digital camera <b>10</b> so as to perform the restriction process, the file control unit <b>43</b> in step S<b>271</b> selects the second encrypted HEIF file to be reproduced in accordance with the user's operation, for example, and acquires (reads) a plain text common key and the encrypted image with which the plain text common key is associated, from the second encrypted HEIF file. The process then moves on to step S<b>272</b>.</p><p id="p-0398" num="0396">In step S<b>272</b>, the file control unit <b>43</b> decrypts the encrypted image acquired in step S<b>271</b> into the master image with the common key also acquired in step S<b>271</b>, and causes the liquid crystal panel <b>19</b> to display the master image. The process then moves on to step S<b>273</b>.</p><p id="p-0399" num="0397">In step S<b>273</b>, the file control unit <b>43</b> determines whether the user has performed a restricting operation of operating the digital camera <b>10</b> so as to restrict viewing of the master image displayed in step S<b>272</b>.</p><p id="p-0400" num="0398">If it is determined in step S<b>273</b> that the restricting operation has not been performed, the restriction process comes to an end.</p><p id="p-0401" num="0399">If it is determined in step S<b>273</b> that the restricting operation has been performed, on the other hand, the process moves on to step S<b>274</b>. The file control unit <b>43</b> deletes the plain text common key acquired in step S<b>271</b> from the second encrypted HEIF file, and the restriction process then comes to an end.</p><p id="p-0402" num="0400">As described above, as the plain text common key associated with an encrypted image is deleted from the second encrypted HEIF file, it is possible to restrict viewing of the master image obtained by decrypting the encrypted image only to the user who can obtain the private key corresponding to the encrypted image.</p><p id="p-0403" num="0401"><figref idref="DRAWINGS">FIG. <b>44</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a second encrypted HEIF file in a case where the second encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0404" num="0402">In the reproduction process shown in <figref idref="DRAWINGS">FIG. <b>44</b></figref>, in step S<b>281</b>, the file control unit <b>43</b> selects the second encrypted HEIF file to be reproduced in accordance with the user's operation, for example, and selects the reproduction target encrypted image from the second encrypted HEIF file. The file control unit <b>43</b> then determines whether the plain text common key associated with the reproduction target encrypted image is stored in the second encrypted HEIF file to be reproduced.</p><p id="p-0405" num="0403">If it is determined in step S<b>281</b> that the plain text common key is stored, the process moves on to step S<b>287</b>.</p><p id="p-0406" num="0404">In step S<b>287</b>, the file control unit <b>43</b> decrypts the reproduction target encrypted image into the master image with the plain text common key associated with the encrypted image, and causes the liquid crystal panel <b>19</b> to display the master image. The reproduction process then comes to an end.</p><p id="p-0407" num="0405">If it is determined in step S<b>281</b> that the plain text common key is not stored, or if the plain text common key has been deleted by the restriction process shown in <figref idref="DRAWINGS">FIG. <b>43</b></figref>, on the other hand, the process moves on to step S<b>282</b>.</p><p id="p-0408" num="0406">In steps S<b>282</b> to S<b>287</b>, processes similar to those in respective steps S<b>231</b> to S<b>236</b> in the reproduction process in <figref idref="DRAWINGS">FIG. <b>40</b></figref> are performed.</p><p id="p-0409" num="0407"><figref idref="DRAWINGS">FIG. <b>45</b></figref> is a flowchart for explaining an example of the preprocessing to be performed in a case where a third encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0410" num="0408">In the preprocessing shown in <figref idref="DRAWINGS">FIG. <b>45</b></figref>, in steps S<b>311</b> to S<b>314</b>, processes similar to those in respective steps S<b>211</b> to S<b>214</b> in the preprocessing shown in <figref idref="DRAWINGS">FIG. <b>38</b></figref> are performed.</p><p id="p-0411" num="0409"><figref idref="DRAWINGS">FIG. <b>46</b></figref> is a flowchart for explaining an example of a generation process for generating a third encrypted HEIF file in a case where the third encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0412" num="0410">In the generation process shown in <figref idref="DRAWINGS">FIG. <b>46</b></figref>, in steps S<b>321</b> to S<b>323</b>, processes similar to those in respective steps S<b>221</b> to S<b>223</b> in the generation process shown in <figref idref="DRAWINGS">FIG. <b>39</b></figref> are performed.</p><p id="p-0413" num="0411">Further, in step S<b>324</b>, the file control unit <b>43</b> selects a public key of interest that is one of the public keys not yet used for encrypting a common key, from among the public keys stored in the preprocessing. The file control unit <b>43</b> also assigns a uuid as specific information to the external data (such as the RAW data of the master image, for example) associated with the master image. The file control unit <b>43</b> then encrypts the common key used in the encryption of the master image and the uuid of the external data associated with the master image with the public key of interest, to generate a specific-information-containing encryption key. The process then moves from step S<b>324</b> on to step S<b>325</b>.</p><p id="p-0414" num="0412">In step S<b>325</b>, the file control unit <b>43</b> generates the third encrypted HEIF file in which the encrypted image generated in step S<b>323</b> and the specific-information-containing encryption key generated in step S<b>324</b> are associated with each other and stored. The generation process then comes to an end.</p><p id="p-0415" num="0413"><figref idref="DRAWINGS">FIG. <b>47</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a third encrypted HEIF file in a case where the third encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0416" num="0414">In the reproduction process shown in <figref idref="DRAWINGS">FIG. <b>47</b></figref>, in step S<b>331</b>, the file control unit <b>43</b> of the digital camera <b>10</b> selects the third encrypted HEIF file to be reproduced in accordance with the user's operation, for example, and selects the reproduction target encrypted image from the third encrypted HEIF file. Further, the file control unit <b>43</b> acquires the specific-information-containing encryption key associated with the reproduction target encrypted image from the third encrypted HEIF file to be reproduced, and the process then moves from step S<b>331</b> on to step S<b>332</b>.</p><p id="p-0417" num="0415">In step S<b>332</b>, the file control unit <b>43</b> attempts to acquire the private key corresponding to the reproduction target encrypted image in a manner similar to that in step S<b>233</b> in <figref idref="DRAWINGS">FIG. <b>40</b></figref>, for example. The process then moves on to step S<b>333</b>.</p><p id="p-0418" num="0416">In step S<b>333</b>, a check is made to determine whether the file control unit <b>43</b> has successfully acquired the private key.</p><p id="p-0419" num="0417">If it is determined in step S<b>333</b> that the private key has not been successfully acquired, the process moves on to step S<b>334</b>. In step S<b>334</b>, the digital camera <b>10</b> performs error processing in a manner similar to that in step S<b>234</b> in <figref idref="DRAWINGS">FIG. <b>40</b></figref>. The reproduction process then comes to an end.</p><p id="p-0420" num="0418">If it is determined in step S<b>333</b> that the private key has been successfully acquired, on the other hand, the process moves on to step S<b>335</b>.</p><p id="p-0421" num="0419">In step S<b>335</b>, the file control unit <b>43</b> decrypts the specific-information-containing encryption key acquired in step S<b>331</b> into the uuid as the specific information and the common key, with the private key acquired in step S<b>332</b>. The process then moves on to step S<b>336</b>.</p><p id="p-0422" num="0420">In step S<b>336</b>, the file control unit <b>43</b> decrypts the reproduction target encrypted image into the master image with the common key decrypted in step S<b>335</b>, and causes the liquid crystal panel <b>19</b> to display the master image. The process then moves on to step S<b>337</b>.</p><p id="p-0423" num="0421">In step S<b>337</b>, the file control unit <b>43</b> acquires the external data specified by the uuid decrypted in step S<b>336</b>, and the reproduction process then comes to an end. The external data is reproduced in response to the user's operation or the like, for example.</p><p id="p-0424" num="0422"><figref idref="DRAWINGS">FIG. <b>48</b></figref> is a flowchart for explaining an example of the preprocessing to be performed in a case where a fourth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0425" num="0423">In the preprocessing shown in <figref idref="DRAWINGS">FIG. <b>48</b></figref>, in steps S<b>351</b> to S<b>354</b>, processes similar to those in respective steps S<b>211</b> to S<b>214</b> in the preprocessing shown in <figref idref="DRAWINGS">FIG. <b>38</b></figref> are performed.</p><p id="p-0426" num="0424"><figref idref="DRAWINGS">FIG. <b>49</b></figref> is a flowchart for explaining an example of a generation process for generating a fourth encrypted HEIF file in a case where the fourth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0427" num="0425">In the generation process shown in <figref idref="DRAWINGS">FIG. <b>49</b></figref>, in steps S<b>361</b> to S<b>363</b>, processes similar to those in respective steps S<b>321</b> to S<b>323</b> in the generation process shown in <figref idref="DRAWINGS">FIG. <b>46</b></figref> are performed.</p><p id="p-0428" num="0426">Further, in step S<b>364</b>, the file control unit <b>43</b> encrypts the external data (such as the RAW data of the master image, for example) associated with the master image, with the common key used in the encryption of the master image. The process then moves on to step S<b>365</b>.</p><p id="p-0429" num="0427">In step S<b>365</b>, the file control unit <b>43</b> selects a public key of interest that is one of the public keys not yet used for encrypting a common key, from among the public keys stored in the preprocessing. The file control unit <b>43</b> also assigns a uuid as specific information to the external data (the external data encrypted in step S<b>364</b>) associated with the master image. The file control unit <b>43</b> then encrypts the common key used in the encryption of the master image and the uuid of the external data associated with the master image with the public key of interest, to generate a specific-information-containing encryption key. The process then moves from step S<b>365</b> on to step S<b>366</b>.</p><p id="p-0430" num="0428">In step S<b>366</b>, the file control unit <b>43</b> generates the fourth encrypted HEIF file in which the encrypted image generated in step S<b>363</b> and the specific-information-containing encryption key generated in step S<b>365</b> are associated with each other and stored. The process then moves on to step S<b>367</b>.</p><p id="p-0431" num="0429">In step S<b>367</b>, the file control unit <b>43</b> generates a file storing the external data encrypted in step S<b>364</b>, and stores the file into the medium <b>14</b>, for example. The generation process then comes to an end.</p><p id="p-0432" num="0430"><figref idref="DRAWINGS">FIG. <b>50</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a fourth encrypted HEIF file in a case where the fourth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0433" num="0431">In the reproduction process shown in <figref idref="DRAWINGS">FIG. <b>50</b></figref>, in steps S<b>371</b> to S<b>377</b>, processes similar to those in respective steps S<b>331</b> to S<b>337</b> in <figref idref="DRAWINGS">FIG. <b>47</b></figref> are performed.</p><p id="p-0434" num="0432">Further, in step S<b>378</b>, the file control unit <b>43</b> decrypts the external data acquired in step S<b>377</b> with the common key decrypted in step S<b>375</b>. The reproduction process then comes to an end.</p><p id="p-0435" num="0433">That is, with the fourth encrypted HEIF file, the external data acquired in step S<b>377</b> is encrypted with the common key, and therefore, the encrypted external data is decrypted with the common key in step S<b>378</b>.</p><p id="p-0436" num="0434"><figref idref="DRAWINGS">FIG. <b>51</b></figref> is a flowchart for explaining an example of the preprocessing to be performed in a case where a fifth or sixth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0437" num="0435">In the preprocessing shown in <figref idref="DRAWINGS">FIG. <b>41</b></figref>, in steps S<b>451</b> to S<b>454</b>, processes similar to those in respective steps S<b>211</b> to S<b>214</b> in the preprocessing shown in <figref idref="DRAWINGS">FIG. <b>38</b></figref> are performed.</p><p id="p-0438" num="0436"><figref idref="DRAWINGS">FIG. <b>52</b></figref> is a flowchart for explaining an example of a generation process for generating a fifth or sixth encrypted HEIF file in a case where the fifth or sixth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0439" num="0437">In the generation process shown in <figref idref="DRAWINGS">FIG. <b>52</b></figref>, in steps S<b>461</b> and S<b>462</b>, processes similar to those in respective steps S<b>221</b> and S<b>222</b> in the generation process shown in <figref idref="DRAWINGS">FIG. <b>39</b></figref> are performed.</p><p id="p-0440" num="0438">Further, in step S<b>463</b>, the file control unit <b>43</b> generates an encrypted image by encrypting the master image obtained by capturing an image in step S<b>461</b>, with the common key generated in step S<b>462</b>. The process then moves on to step S<b>464</b>.</p><p id="p-0441" num="0439">Note that, as for the sixth HEIF file, in step S<b>463</b>, the file control unit <b>43</b> further encrypts the external data associated with the master image, with the common key used in the encryption of the master image.</p><p id="p-0442" num="0440">In step S<b>464</b>, the file control unit <b>43</b> selects a public key of interest that is one of the public keys not yet used for encrypting a common key, from among the public keys stored in the preprocessing. The file control unit <b>43</b> also assigns a uuid as specific information to the external data associated with the master image. The file control unit <b>43</b> then encrypts the common key set of the common key used in the encryption of the master image and the uuid of the external data associated with the master image with the public key of interest, to generate a specific-information-containing encryption key. The process then moves from step S<b>464</b> on to step S<b>465</b>.</p><p id="p-0443" num="0441">In step S<b>465</b>, the file control unit <b>43</b> generates the fifth or sixth encrypted HEIF file in which the encrypted image generated in step S<b>463</b>, the specific-information-containing encryption key generated in step S<b>464</b>, and the (plain text) common key set before being encrypted with the specific-information-containing encryption key are associated with one another and stored. The generation process then comes to an end.</p><p id="p-0444" num="0442">Note that, as for the sixth HEIF file, in step S<b>465</b>, the file control unit <b>43</b> further generates a file storing the external data encrypted in step S<b>463</b>, and stores the file into the medium <b>14</b>, for example.</p><p id="p-0445" num="0443"><figref idref="DRAWINGS">FIG. <b>53</b></figref> is a flowchart for explaining an example of a restriction process for restricting viewing of a master image obtained by decrypting an encrypted image only to the user who can obtain the private key corresponding to the encrypted image, in a case where a fifth or sixth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0446" num="0444">In the restriction process shown in <figref idref="DRAWINGS">FIG. <b>53</b></figref>, in step S<b>471</b>, the file control unit <b>43</b> selects the fifth or sixth encrypted HEIF file to be reproduced in accordance with the user's operation, for example, and acquires a (plain text) common key set and the encrypted image with which the common key set is associated, from the fifth or sixth encrypted HEIF file. The process then moves on to step S<b>472</b>.</p><p id="p-0447" num="0445">In step S<b>472</b>, the file control unit <b>43</b> decrypts the encrypted image acquired in step S<b>471</b> into the master image with the common key forming the common key set also acquired in step S<b>471</b>, and causes the liquid crystal panel <b>19</b> to display the master image. The process then moves on to step S<b>473</b>.</p><p id="p-0448" num="0446">In step S<b>473</b>, the file control unit <b>43</b> determines whether the user has performed a restricting operation of operating the digital camera <b>10</b> so as to restrict viewing of the master image displayed in step S<b>472</b>.</p><p id="p-0449" num="0447">If it is determined in step S<b>473</b> that the restricting operation has not been performed, the restriction process comes to an end.</p><p id="p-0450" num="0448">If it is determined in step S<b>473</b> that the restricting operation has been performed, on the other hand, the process moves on to step S<b>474</b>. The file control unit <b>43</b> deletes the common key set acquired in step S<b>471</b> from the fifth or sixth encrypted HEIF file, and the restriction process then comes to an end.</p><p id="p-0451" num="0449">As described above, as the plain text common key associated with an encrypted image is deleted from the fifth or sixth encrypted HEIF file, it is possible to restrict viewing of the master image obtained by decrypting the encrypted image, and access to the external data associated with the master image, only to the user who can obtain the private key corresponding to the encrypted image.</p><p id="p-0452" num="0450"><figref idref="DRAWINGS">FIG. <b>54</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing a fifth or sixth encrypted HEIF file in a case where the fifth or sixth encrypted HEIF file is handled by the image processing system <b>100</b>.</p><p id="p-0453" num="0451">In the reproduction process shown in <figref idref="DRAWINGS">FIG. <b>54</b></figref>, in step S<b>481</b>, the file control unit <b>43</b> selects the fifth or sixth encrypted HEIF file to be reproduced in accordance with the user's operation, for example, and selects the reproduction target encrypted image from the fifth or sixth encrypted HEIF file. The file control unit <b>43</b> then determines whether the plain text common key set associated with the reproduction target encrypted image is stored in the fifth or sixth encrypted HEIF file to be reproduced.</p><p id="p-0454" num="0452">If it is determined in step S<b>481</b> that the common key set is stored, the process moves on to step S<b>487</b>.</p><p id="p-0455" num="0453">In step S<b>487</b>, the file control unit <b>43</b> decrypts the reproduction target encrypted image into the master image with the common key forming the common key set associated with the encrypted image, and causes the liquid crystal panel <b>19</b> to display the master image. The process then moves on to step S<b>488</b>.</p><p id="p-0456" num="0454">In step S<b>488</b>, the file control unit <b>43</b> acquires the external data specified by the uuid forming the common key set associated with the reproduction target encrypted image. The reproduction process then comes to an end.</p><p id="p-0457" num="0455">Note that, as for the sixth HEIF file, the external data is encrypted. Therefore, in step S<b>488</b>, the file control unit <b>43</b> further acquires the encrypted external data specified by the uuid forming the common key set, and then decrypts the encrypted external data with the common key forming the common key set.</p><p id="p-0458" num="0456">If it is determined in step S<b>481</b> that the common key set is not stored, or if the common key set has been deleted by the restriction process shown in <figref idref="DRAWINGS">FIG. <b>53</b></figref>, on the other hand, the process moves on to step S<b>482</b>.</p><p id="p-0459" num="0457">In steps S<b>482</b> to S<b>488</b>, processes similar to those in respective steps S<b>331</b> to S<b>337</b> in the reproduction process in <figref idref="DRAWINGS">FIG. <b>47</b></figref> are performed. The reproduction process then comes to an end.</p><p id="p-0460" num="0458">Note that, as for the sixth HEIF file, the external data is encrypted. Therefore, in step S<b>488</b>, the file control unit <b>43</b> further acquires the encrypted external data specified by the uuid obtained by decrypting the specific-information-containing encryption key in step S<b>486</b>, and then decrypts the encrypted external data with the common key obtained by decrypting the specific-information-containing encryption key in step S<b>486</b>.</p><p id="p-0461" num="0459">&#x3c;Second Embodiment of an Image Processing System to which the Present Technology is Applied&#x3e;</p><p id="p-0462" num="0460"><figref idref="DRAWINGS">FIG. <b>55</b></figref> is a block diagram showing an example configuration of a second embodiment of an image processing system to which the present technology is applied.</p><p id="p-0463" num="0461">Note that, in the drawing, the components corresponding to those of the image processing system <b>100</b> in <figref idref="DRAWINGS">FIG. <b>31</b></figref> are denoted by the same reference numerals as those used in <figref idref="DRAWINGS">FIG. <b>31</b></figref>, and explanation thereof will not be repeated below.</p><p id="p-0464" num="0462">In <figref idref="DRAWINGS">FIG. <b>55</b></figref>, an image processing system <b>200</b> includes a digital camera <b>210</b> and the external computer <b>101</b>.</p><p id="p-0465" num="0463">Accordingly, the image processing system <b>200</b> is the same as the image processing system <b>100</b> in <figref idref="DRAWINGS">FIG. <b>31</b></figref> in including the external computer <b>101</b>, and differs from the image processing system <b>100</b> in including the digital camera <b>210</b> in place of the digital camera <b>10</b>.</p><p id="p-0466" num="0464"><figref idref="DRAWINGS">FIG. <b>56</b></figref> is a block diagram showing an example configuration of the digital camera <b>210</b>.</p><p id="p-0467" num="0465">Note that, in the drawing, the components corresponding to those of the digital camera <b>10</b> in <figref idref="DRAWINGS">FIG. <b>1</b></figref> are denoted by the same reference numerals as those used in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, and explanation thereof will not be repeated below.</p><p id="p-0468" num="0466">The digital camera <b>210</b> includes components from the optical system <b>11</b> to the interface <b>21</b>, and the signal processing unit <b>13</b> includes components from the optical system/image sensor control unit <b>41</b> to the UI control unit <b>47</b>, and a recognition unit <b>211</b>.</p><p id="p-0469" num="0467">Accordingly, the digital camera <b>210</b> is the same as the digital camera <b>10</b> in <figref idref="DRAWINGS">FIG. <b>1</b></figref> in including the components from the optical system <b>11</b> to the interface <b>21</b>, and the signal processing unit <b>13</b> is the same as that in <figref idref="DRAWINGS">FIG. <b>1</b></figref> in including the components from the optical system/image sensor control unit <b>41</b> to the UI control unit <b>47</b>.</p><p id="p-0470" num="0468">However, the digital camera <b>210</b> differs from the digital camera <b>10</b> in that the recognition unit <b>211</b> is added to the signal processing unit <b>13</b>.</p><p id="p-0471" num="0469">The recognition unit <b>211</b> receives (data of) a master image supplied from the optical system/image sensor control unit <b>41</b>.</p><p id="p-0472" num="0470">The recognition unit <b>211</b> performs image recognition on the master image supplied from the optical system/image sensor control unit <b>41</b>. Through the image recognition, the recognition unit <b>211</b> recognizes the object appearing in the master image as the recognition target, and supplies the recognition result to the file control unit <b>43</b>.</p><p id="p-0473" num="0471">In the recognition unit <b>211</b>, the recognition algorithm adopted for recognizing an object can be an algorithm for recognizing any appropriate object appearing in a master image as the recognition target, and identifying (classifying) the type of the object as the recognition target such as a person, an automobile, or a trademark, for example, or can be a recognition algorithm for recognizing an object of a specific type as the recognition object and identifying an individual, such as a recognition algorithm for identifying an individual person, for example.</p><p id="p-0474" num="0472">Further, other sensors <b>212</b> may be provided in the digital camera <b>210</b>, and the recognition unit <b>211</b> can recognize an object appearing in a master image, using a sensing result supplied from the other sensors <b>212</b> in addition to the master image. The other sensors <b>212</b> can include a global positioning system (GPS) sensor, an orientation sensor, a depth (distance measurement) sensor, and the like, for example. The recognition unit <b>211</b> can increase the accuracy of recognition of objects appearing in master images, by specifying the current location from a sensing result supplied from the GPS sensor or the orientation sensor, and restricting recognition targets to objects that can exist at the current location. Also, the recognition unit <b>211</b> can increase the recognition accuracy at low illuminance, by generating, from a sensing result supplied from the depth sensor, a distance image having the distance to the object as its pixel value, and recognizing the object appearing in a master image, using the distance image in addition to the master image.</p><p id="p-0475" num="0473">Here, there is &#x201c;grid&#x201d; as an item type of an HEIF. As for a master image whose item type is &#x201c;grid&#x201d;, each divisional image of a plurality of divisional images (tiles) obtained by dividing the master image into divisional images of the same size is stored as an item in an HEIF file. A master image whose item type is &#x201c;grid&#x201d; is reconstructed from a plurality of divisional images as items. An item (a master image in this example) whose item type is &#x201c;grid&#x201d;, or a master image to be divided into a plurality of divisional images (and a master image to be reconstructed from a plurality of divisional images) is also referred to as a grid item.</p><p id="p-0476" num="0474">In the digital camera <b>210</b>, the file control unit <b>43</b> can perform encryption not on an entire master image, but on divisional images obtained by dividing a master image. For example, the file control unit <b>43</b> can perform encryption on divisional images in which a predetermined object in a master image appears, according to a recognition result supplied from the recognition unit <b>211</b>.</p><p id="p-0477" num="0475">In the description below, processing of an encrypted HEIF file in a case where encryption is performed on a divisional image basis will be explained. Before that, however, an HEIF file storing a master image whose item type is &#x201c;grid&#x201d; (this HEIF file will be hereinafter also referred to as a grid file) is described.</p><p id="p-0478" num="0476">&#x3c;Grid File&#x3e;</p><p id="p-0479" num="0477"><figref idref="DRAWINGS">FIG. <b>57</b></figref> is a diagram showing an example of a grid file.</p><p id="p-0480" num="0478">In the grid file in <figref idref="DRAWINGS">FIG. <b>57</b></figref>, a master image is divided into 3&#xd7;3 divisional images Item #1 to Item #9 arranged in vertical and horizontal directions, and the divisional images Item #1 to Item #9 are stored as items in the mdat box.</p><p id="p-0481" num="0479">In <figref idref="DRAWINGS">FIG. <b>57</b></figref>, the items stored in the mdat box are the nine items of the divisional images Item #1 to Item #9, but the number of items in each of the iinf box and the iloc box is 10. This is because, in addition of the nine items of the divisional images Item #1 to Item #9, a master image (a reconstructed image) as a grid item to be reconstructed from the divisional images Item #1 to Item #9 is counted as an item. In <figref idref="DRAWINGS">FIG. <b>57</b></figref>, the item ID of the master image as a grid item is 10, and this master image is referred to as the master image Item #10, for ease of explanation.</p><p id="p-0482" num="0480">Regarding the master image #10 as a grid item, the media data is not stored in the mdat box, but an idat box is stored in the meta box instead. The idat box stores a horizontal grid number, a vertical grid number, a horizontal output size, and a vertical output size. The horizontal grid number and the vertical grid number indicate the respective numbers of the divisional images #1 to #9 constituting the master image #10 as a grid item in the horizontal direction and the vertical direction. The horizontal output size and the vertical output size indicate the respective sizes in the horizontal direction and the vertical direction of the master image #10 as a grid item reconstructed from the divisional images #1 to #9.</p><p id="p-0483" num="0481">Further, as for the master image #10 as a grid item, information (the offset and size) regarding the storage location of the master image #10 is stored in the iloc box, and this information indicates the storage location of the idat box of the master image #10 as a grid item.</p><p id="p-0484" num="0482">The grid file in <figref idref="DRAWINGS">FIG. <b>57</b></figref> includes ten infe boxes, as the ten items of the divisional images Item #1 to Item #9 and the master image Item #10 to be reconstructed from the divisional images Item #1 to Item #9 are stored therein. As described above with reference to <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the item ID for specifying the item and the item type are stored (registered) in an infe box, and &#x201c;grid&#x201d; indicating a grid item is stored as the item type of the master image Item #10 in the infe box of the master image Item #10 as a grid item.</p><p id="p-0485" num="0483">In the grid file, a dimg box is stored in the iref box. The dimg box stores information for associating a grid item with the divisional images constituting the grid item. For example, the dimg box stores the item IDs of the divisional images are stored as reference destinations, and the item ID of the master image as the grid item to be reconstructed from the divisional image is stored as a reference source. In <figref idref="DRAWINGS">FIG. <b>57</b></figref>, the item IDs #1 to #9 of the divisional images Item #1 to Item #9 are stored as the reference destinations, and the item ID #10 of the master image Item #10 is stored as the reference source. The dimg box also stores a reference counter indicating the number of divisional images.</p><p id="p-0486" num="0484">Regarding the grid file as described above, the file control unit <b>43</b> can recognize, from the item type &#x201c;grid&#x201d; stored in the infe box of the master image Item #10, that the master image Item #10 is a reconstructed image (a grid item) to be reconstructed from a plurality of divisional images. Further, the file control unit <b>43</b> can specify, from the reference source and the reference destinations stored in the dimg box, the item ID #10 of the master image Item #10 to be reconstructed from the divisional images, and the item IDs #1 to #9 of the divisional images Item #1 to Item #9 to be used for reconstructing the master image Item #10. From the horizontal grid number and the vertical grid number, and the horizontal output size and the vertical output size stored in the idat box, the file control unit <b>43</b> can also specify the numbers of the divisional images #1 to #9 constituting the master image #10 in the horizontal direction and the vertical direction, and the horizontal and vertical sizes of the master image #10 to be reconstructed from the divisional images #1 to #9.</p><p id="p-0487" num="0485">From the divisional images Item #1 to Item #9 of the item IDs #1 to #9 specified from the dimg box, the file control unit <b>43</b> can reconstruct the master image Item #10 that has the item ID #10 specified from the dimg box, has the size specified from the idat box, and is formed with divisional images as many as the numbers in the horizontal direction and the vertical direction specified from the idat box.</p><p id="p-0488" num="0486">In the digital camera <b>210</b> (<figref idref="DRAWINGS">FIG. <b>56</b></figref>), the file control unit <b>43</b> can generate an encrypted grid file that is a grid file in which encrypted divisional images an encrypted images obtained by encrypting divisional images obtained by dividing a master image with a common key (a first encryption key), and an encrypted encryption key obtained by encrypting the common key with a public key (a second encryption key) are associated with each other and stored. An encrypted grid file is a type of encrypted HEIF file.</p><p id="p-0489" num="0487">In associating the encrypted divisional images stored in the encrypted grid file with the encrypted encryption key obtained by encrypting the common key used in the encryption for obtaining the encrypted divisional images, the file control unit <b>43</b> can use the association between the master image stored in an associating HEIF file and the specific information about external data. That is, the file control unit <b>43</b> can associate the encrypted divisional images stored in the encrypted grid file with the encrypted encryption key, in a manner similar to that in the association between the master image stored in an associating HEIF file and the specific information about external data.</p><p id="p-0490" num="0488">The file control unit <b>43</b> can also decrypt the encrypted encryption key of the encrypted grid file into the common key, and, with the common key obtained by the decryption, decrypt the encrypted divisional images into the original divisional images. Further, the file control unit <b>43</b> can reconstruct the reconstructed image as the master image by arranging the divisional images.</p><p id="p-0491" num="0489">&#x3c;Processing of an Encrypted Grid File&#x3e;</p><p id="p-0492" num="0490"><figref idref="DRAWINGS">FIG. <b>58</b></figref> is a diagram for explaining an outline of encrypted grid file processing to be performed by the digital camera <b>210</b>.</p><p id="p-0493" num="0491">At the time of generation of the encrypted grid file, the recognition unit <b>211</b> in the digital camera <b>210</b> (<figref idref="DRAWINGS">FIG. <b>56</b></figref>) sets the faces of persons as the recognition target, recognizes the faces of persons appearing in the master image, for example, and supplies the recognition result to the file control unit <b>43</b>.</p><p id="p-0494" num="0492">According to the recognition result supplied from the recognition unit <b>211</b>, the file control unit <b>43</b> encrypts the divisional images in which the recognition target has been recognized (the divisional images in which the face of the person as the recognition target appears) among the divisional images obtained by dividing the master image, into encrypted divisional images with a common key, and stores the encrypted divisional images into the encrypted grid file, for example. The divisional images other than the divisional images in which the recognition target has been recognized can be encrypted into encrypted divisional images with a common key and be stored into the encrypted grid file like the divisional images in which the recognition target has been recognized, or can be stored (as plain text) into the encrypted grid file without being encrypted. In this example, the divisional images other than the divisional images in which the recognition target has been recognized are stored into the encrypted grid file without being encrypted.</p><p id="p-0495" num="0493">As in a case with an encrypted HEIF file, the file control unit <b>43</b> encrypts the common key used in the encryption of divisional images into an encrypted encryption key with a public key, and stores the encrypted encryption key into the encrypted grid file by associating the encrypted encryption key with the corresponding encrypted divisional images (the divisional images encrypted with the public key obtained by decrypting the encrypted encryption key).</p><p id="p-0496" num="0494">When reproducing the encrypted grid file, the file control unit <b>43</b> in the digital camera <b>210</b> reconstructs a reconstructed image as a master image from the divisional images and the encrypted divisional images stored in the encrypted grid file.</p><p id="p-0497" num="0495">In a case where the private key corresponding to the public key can be obtained, when reconstructing a reconstructed image as a master image, the file control unit <b>43</b> decrypts the encrypted encryption key associated with the encrypted divisional images into the common key with the private key, and decrypts the encrypted divisional images into the original divisional images with the common key. Further, the file control unit <b>43</b> reconstructs the reconstructed image as the master image by arranging the (plain text) divisional images stored in the encrypted grid file and the divisional images obtained by decrypting the encrypted divisional images. As a result, it is possible to obtain a reconstructed image showing the objects as the recognition target appearing in the original master image, or human faces in this case.</p><p id="p-0498" num="0496">On the other hand, in a case where the private key corresponding to the public key cannot be obtained, when reconstructing the reconstructed image as the master image, the file control unit <b>43</b> reconstructs the reconstructed image as the master image by arranging the (plain text) divisional images stored in the encrypted grid file and the encrypted divisional images (or an unpatterned one-color image or the like representing the encrypted divisional images, for example). As a result, it is possible to obtain a reconstructed image that does not show (or hides) the objects as the recognition target appearing in the original master image, or human faces in this case.</p><p id="p-0499" num="0497">As described above, with the encrypted grid file, viewing of the objects as the recognition target can be restricted to the user who can obtain the private key corresponding to the public key.</p><p id="p-0500" num="0498">Note that, in the digital camera <b>210</b>, encrypted divisional images can be encrypted with common keys that vary with each object appearing in the corresponding divisional images, and the common keys used in the encryption of the divisional images can be encrypted with public keys that vary with each object.</p><p id="p-0501" num="0499">That is, in the digital camera <b>210</b>, divisional images can be encrypted with common keys that vary with each object as a recognition target appearing in a divisional image. Further, the common keys that vary with each object as a recognition target appearing in a divisional image can be encrypted with public keys that vary with each object as a recognition target (accordingly, the private keys also vary).</p><p id="p-0502" num="0500">For example, in a case where the face of a person is a recognition target, and the face of a person A and the face of a person B appearing in a master image are recognized as shown in <figref idref="DRAWINGS">FIG. <b>58</b></figref>, the divisional image in which the face of the person A appears and the divisional image in which the face of the person B appears can be encrypted with different common keys. Further, the common key used in the encryption of the divisional image in which the face of the person A appears and the common key used in the encryption of the divisional image in which the face of the person B appears can be encrypted with different public keys KA and KB.</p><p id="p-0503" num="0501">In this example, in a case where the private key corresponding to the public key KA can be obtained, a reconstructed image showing the face of the person A is reconstructed, and, in a case where the private key corresponding to the public key KB can be obtained, a reconstructed image showing the face of the person B is reconstructed. Accordingly, viewing of the face of the person A can be limited to the user who can obtain the private key corresponding to the public key KA, and viewing of the face of the person B can be limited to the user who can obtain the private key corresponding to the public key KB.</p><p id="p-0504" num="0502">As described above, for each object, the user who can view object can be limited.</p><p id="p-0505" num="0503">Also, in this example, an individual is identified, with a recognition target being specific one type of object that is a person. However, a plurality of types of objects can be set as recognition targets, and the type of an object as a recognition target can be identified. For example, a person and a trademark can be identified as recognition targets. In this case, encryption can be performed with different common keys and public keys for the respective types of objects as the recognition targets, which are a person and a trademark.</p><p id="p-0506" num="0504">Further, in the recognition unit <b>211</b>, an object as a recognition target can be set in accordance with the user's operation. For example, whether to identify an individual as a specific one type of object such as a person as a recognition target, or whether to identify a person and a trademark as recognition targets as described above can be set in accordance with the user's operation.</p><p id="p-0507" num="0505">&#x3c;Encrypted Grid File&#x3e;</p><p id="p-0508" num="0506"><figref idref="DRAWINGS">FIG. <b>59</b></figref> is a diagram showing an example of an encrypted grid file.</p><p id="p-0509" num="0507">The encrypted grid file in <figref idref="DRAWINGS">FIG. <b>59</b></figref> is an encrypted grid file corresponding to the grid file in <figref idref="DRAWINGS">FIG. <b>57</b></figref>. That is, the encrypted grid file in <figref idref="DRAWINGS">FIG. <b>59</b></figref> is an encrypted grid file storing encrypted divisional images Item #1 to Item #9 as the encrypted images obtained by encrypting the divisional images Item #1 to Item ##9 stored in the grid file in <figref idref="DRAWINGS">FIG. <b>57</b></figref> on a divisional image basis.</p><p id="p-0510" num="0508">Note that the contents of the iloc box and the idat box are not shown in <figref idref="DRAWINGS">FIG. <b>59</b></figref>, but are similar to those in <figref idref="DRAWINGS">FIG. <b>57</b></figref>.</p><p id="p-0511" num="0509">The encrypted grid file in <figref idref="DRAWINGS">FIG. <b>59</b></figref> differs from the grid file in <figref idref="DRAWINGS">FIG. <b>57</b></figref> in that, instead of the (plain text) divisional images Item #1 to Item #9, the encrypted divisional images Item #1 to Item #9 are stored as items in the mdat box. The encrypted grid file in <figref idref="DRAWINGS">FIG. <b>59</b></figref> also differs from the grid file in <figref idref="DRAWINGS">FIG. <b>57</b></figref> in that encrypted encryption keys Item #11 to Item #19 obtained by encrypting the common keys used in the encryption for obtaining the encrypted divisional images Item #1 to Item #9 with public keys are newly stored as items in the mdat box. Further, the encrypted grid file in <figref idref="DRAWINGS">FIG. <b>59</b></figref> differs from the grid file in <figref idref="DRAWINGS">FIG. <b>57</b></figref> in that cdsc boxes storing association information are newly stored in the iref box.</p><p id="p-0512" num="0510">Note that, in the encrypted grid file in <figref idref="DRAWINGS">FIG. <b>59</b></figref>, items are increased from those in the grid file in FIG. <b>57</b> by the number of the encrypted encryption keys Item #11 to Item #19. Therefore, in the encrypted grid file in <figref idref="DRAWINGS">FIG. <b>59</b></figref>, the number of items in the iinf box is 19, and, in this respect, the encrypted grid file in <figref idref="DRAWINGS">FIG. <b>59</b></figref> differs from the grid file in <figref idref="DRAWINGS">FIG. <b>57</b></figref> in which the number of items is ten. Further, the encrypted grid file in <figref idref="DRAWINGS">FIG. <b>59</b></figref> differs from the grid file in <figref idref="DRAWINGS">FIG. <b>57</b></figref> in that infe boxes for the encrypted encryption keys Item #11 to Item #19, which cause the increase of items from that in the grid file in <figref idref="DRAWINGS">FIG. <b>57</b></figref>, are newly provided.</p><p id="p-0513" num="0511">In <figref idref="DRAWINGS">FIG. <b>59</b></figref>, objects as different recognition targets are captured in the respective divisional images 1 to 9 before being encrypted into the encrypted divisional images Item #1 to Item #9, for example. Therefore, the divisional images 1 to 9 are encrypted into the encrypted divisional images Item #1 to Item #9 with different common keys. Further, the common keys used in the encryption of the divisional images 1 to 9 in which objects as different recognition targets are captured are encrypted into the encrypted encryption keys Item #11 to Item #19 with different public keys.</p><p id="p-0514" num="0512">In the encrypted grid file, association information for associating an encrypted divisional image Item #i with an encrypted encryption key Item #10+i obtained by encrypting the common key used in the encryption for obtaining the encrypted divisional image Item #i with a public key is stored in the cdsc box, so that the encrypted divisional image Item #i and the encrypted encryption key Item #10+i are associated with each other, as in the (first to sixth) encrypted HEIF files, for example.</p><p id="p-0515" num="0513">As for the encrypted divisional image Item #i stored in the encrypted grid file, in a case where the private key corresponding to the encrypted divisional image Item #i (the private key corresponding to the public key used in the encryption of the common key used in the encryption for obtaining the encrypted divisional image Item #i) can be obtained, the file control unit <b>43</b> can decrypt the encrypted encryption key Item #10+i associated with the encrypted divisional image Item #i into the common key with the private key, and decrypt the encrypted divisional image Item #i into the original divisional image i with the common key obtained by the decryption. Thus, as for each divisional image i obtained by dividing a master image, viewing of (the object appearing in) the divisional image i can be restricted to the user who can obtain the private key corresponding to the encrypted divisional image Item #i.</p><p id="p-0516" num="0514">In a case where the encrypted divisional image Item #i is to be decrypted, the file control unit <b>43</b> specifies the item ID of the reference destination in the cdsc box having the reference source indicating the item ID #i of the encrypted divisional image Item #i, as the item ID #10+i of the encrypted encryption key Item #10+i corresponding to the encrypted divisional image Item #i, or of the encrypted encryption key Item #10+i obtained by encrypting the common key used in the encryption of the encrypted image Item #i. In accordance with the item ID #10+i, the file control unit <b>43</b> acquires the encrypted encryption key Item #10+i from the mdat box, and performs decryption.</p><p id="p-0517" num="0515">Note that, in the encrypted grid file in <figref idref="DRAWINGS">FIG. <b>59</b></figref>, all the nine divisional images 1 to 9 constituting the master image are encrypted into the encrypted divisional images Item #1 to Item #9. However, not all the divisional images 1 to 9 constituting the master image need to be encrypted. That is, of the divisional images 1 to 9 constituting the master image, only the divisional images in which objects as recognition targets appear can be encrypted.</p><p id="p-0518" num="0516"><figref idref="DRAWINGS">FIG. <b>60</b></figref> is a flowchart for explaining a first example of the preprocessing to be performed in a case where an encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0519" num="0517">In the first example of the preprocessing, in step S<b>511</b>, the digital camera <b>210</b> of the image processing system <b>200</b> transmits a request for a predetermined number of public keys to the external computer <b>101</b>, and the process then moves on to step S<b>512</b>.</p><p id="p-0520" num="0518">For example, in a case where persons are set as recognition targets in the recognition unit <b>211</b> to identify individuals, face recognition is performed using images captured for displaying so-called through-lens images by the digital camera <b>210</b>, so that the number of persons (individuals) as recognition targets is specified, and public keys as many as the number of persons as the recognition targets are requested.</p><p id="p-0521" num="0519">Further, in the digital camera <b>210</b>, the user inputs information about persons whose faces are to be concealed, for example, and public keys as many as the number of persons whose faces are to be concealed are requested according to the information.</p><p id="p-0522" num="0520">In steps S<b>512</b> to S<b>514</b>, processes similar to those in respective steps S<b>212</b> to S<b>214</b> in <figref idref="DRAWINGS">FIG. <b>38</b></figref> are performed. As a result, the digital camera <b>210</b> stores public keys as many as the necessary number, such as the number of persons whose faces are to be concealed, for example.</p><p id="p-0523" num="0521"><figref idref="DRAWINGS">FIG. <b>61</b></figref> is a flowchart for explaining a first example of a generation process for generating an encrypted grid file in a case where the encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0524" num="0522">In the first example of a generation process, in step S<b>521</b>, the digital camera <b>210</b> captures an image, in accordance with the user's operation, for example, and the process then moves on to step S<b>522</b>.</p><p id="p-0525" num="0523">In step S<b>522</b>, the recognition unit <b>211</b> performs image recognition using the image captured in step S<b>521</b>, and the process then moves on to step S<b>523</b>.</p><p id="p-0526" num="0524">In step S<b>523</b>, the file control unit <b>43</b> controls the coding control unit <b>42</b> to divide the master image obtained by capturing an image in step S<b>521</b>, in accordance with the recognition targets recognized in the image recognition performed by the recognition unit <b>211</b>. Under the control of the file control unit <b>43</b>, the coding control unit <b>42</b> divides the master image into a plurality of divisional images so that different recognition targets appear in different divisional images (so that one or less recognition target appears in one divisional image), for example, and supplies the plurality of divisional images to the file control unit <b>43</b>. The process then moves from step S<b>523</b> on to step S<b>524</b>.</p><p id="p-0527" num="0525">In step S<b>524</b>, the file control unit <b>43</b> generates different common keys for the respective recognition targets recognized in the image recognition by the recognition unit <b>211</b>, and the process then moves on to step S<b>525</b>.</p><p id="p-0528" num="0526">In step S<b>525</b>, the file control unit <b>43</b> generates encrypted divisional images by encrypting the divisional images showing the recognition targets recognized in the image recognition by the recognition unit <b>211</b> among the divisional images obtained by dividing the master image, with the common keys for the recognition targets. The process then moves on to step S<b>526</b>.</p><p id="p-0529" num="0527">In step S<b>526</b>, the file control unit <b>43</b> encrypts the common keys for the respective recognition targets recognized in the image recognition by the recognition unit <b>211</b> with public keys stored in the first example of the preprocessing, and thus, generates encrypted encryption keys for the respective recognition targets. The process then moves on to step S<b>527</b>. Note that the common keys for different recognition targets are encrypted with different public keys.</p><p id="p-0530" num="0528">In step S<b>527</b>, the file control unit <b>43</b> generates an encrypted grid file that stores the divisional images in which any recognition target does not appear among the divisional images obtained by dividing the master image, and the encrypted divisional images generated in step S<b>525</b> associated with the encrypted encryption keys that have been generated in step S<b>526</b> and correspond to the encrypted divisional images (the encrypted encryption keys obtained by encrypting the common keys used in the encryption for obtaining the encrypted divisional images). The generation process then comes to an end.</p><p id="p-0531" num="0529">Note that, according to HEIF, a master image is divided into a plurality of divisional images of the same size. Therefore, in a case where a master image is divided into divisional images in which one or less recognition target appears, one recognition target might appear over a plurality of divisional images. In a case where one recognition target appears over a plurality of divisional images, the plurality of divisional images can be encrypted with the same common key.</p><p id="p-0532" num="0530">Further, in this example, common keys are generated for the respective recognition targets recognized by image recognition, and a divisional image showing a recognition target is encrypted with the common key for the recognition target. However, common keys can be generated for the respective divisional images showing the recognition targets recognized by image recognition, and a divisional image showing a recognition target can be encrypted with the common key for the divisional image, for example.</p><p id="p-0533" num="0531"><figref idref="DRAWINGS">FIG. <b>62</b></figref> is a flowchart for explaining an example of a reproduction process for reproducing an encrypted grid file in a case where the encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0534" num="0532">In the reproduction process, in step S<b>531</b>, the file control unit <b>43</b> of the digital camera <b>210</b> selects the encrypted grid file to be reproduced in accordance with the user's operation, for example, and selects the reproduction target master image from the encrypted grid file. Further, the file control unit <b>43</b> reconstructs the master image using the divisional images and the encrypted divisional images constituting the reproduction target master image, and causes the liquid crystal panel <b>19</b> to display the master image.</p><p id="p-0535" num="0533">In the master image reconstructed in step S<b>531</b>, the objects appearing in the regions of the encrypted divisional images are invisible. After such a master image is displayed in step S<b>531</b>, the process moves on to step S<b>532</b>.</p><p id="p-0536" num="0534">In step S<b>532</b>, when the user designates an encrypted divisional image in the master image displayed in step S<b>531</b>, for example, the file control unit <b>43</b> selects the encrypted divisional image designated by the user as the encrypted divisional image of interest. Further, the file control unit <b>43</b> acquires the encrypted encryption key associated with the encrypted divisional image of interest (or the encrypted encryption key corresponding to the encrypted divisional image) from the encrypted grid file to be reproduced, and the process then moves from step S<b>532</b> on to step S<b>533</b>.</p><p id="p-0537" num="0535">In step S<b>533</b>, the file control unit <b>43</b> attempts to acquire a private key corresponding to the encrypted divisional image of interest (the private key corresponding to the public key used in the encryption for obtaining the encrypted divisional image of interest), in a manner similar to that in step S<b>232</b> in <figref idref="DRAWINGS">FIG. <b>40</b></figref>, for example. The process then moves on to step S<b>534</b>.</p><p id="p-0538" num="0536">In step S<b>534</b>, a check is made to determine whether the file control unit <b>43</b> has successfully acquired the private key corresponding to the encrypted divisional image of interest.</p><p id="p-0539" num="0537">If it is determined in step S<b>534</b> that the private key has not been successfully acquired, the process moves on to step S<b>535</b>, and error processing similar to that in step S<b>234</b> in <figref idref="DRAWINGS">FIG. <b>40</b></figref> is performed. The reproduction process then comes to an end. Therefore, the user who cannot obtain the private key corresponding to the encrypted divisional image of interest cannot view the master image shown in the divisional image obtained by decrypting the encrypted divisional image of interest.</p><p id="p-0540" num="0538">If it is determined in step S<b>534</b> that the private key has been successfully acquired, on the other hand, the process moves on to step S<b>536</b>.</p><p id="p-0541" num="0539">In step S<b>536</b>, the file control unit <b>43</b> decrypts the encrypted encryption key acquired in step S<b>532</b> into the common key, with the private key acquired in step S<b>533</b>. The process then moves on to step S<b>537</b>.</p><p id="p-0542" num="0540">In step S<b>537</b>, the file control unit <b>43</b> decrypts the encrypted divisional image of interest into the divisional image with the common key decrypted in step S<b>536</b>. The process then moves on to step S<b>538</b>.</p><p id="p-0543" num="0541">In step S<b>538</b>, the file control unit <b>43</b> reconstructs the master image, using the divisional image obtained by decrypting the encrypted divisional image of interest, instead of using the encrypted divisional image of interest, and causes the liquid crystal panel <b>19</b> to display the master image. The reproduction process then comes to an end.</p><p id="p-0544" num="0542"><figref idref="DRAWINGS">FIG. <b>63</b></figref> is a flowchart for explaining a second example of the preprocessing to be performed in a case where an encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0545" num="0543">In the second example of the preprocessing, in step S<b>611</b>, the digital camera <b>210</b> of the image processing system <b>200</b> transmits a request for a predetermined number of public keys to the external computer <b>101</b>, and the process then moves on to step S<b>612</b>.</p><p id="p-0546" num="0544">For example, in a case where a method for dividing a master image into divisional images of the same size, or the numbers of the divisional images in the horizontal direction and the vertical direction of the master image is set in advance, public keys as many as the number of the divisional images constituting the master image are requested.</p><p id="p-0547" num="0545">In steps S<b>512</b> to S<b>514</b>, processes similar to those in respective steps S<b>212</b> to S<b>214</b> in <figref idref="DRAWINGS">FIG. <b>38</b></figref> are performed. As a result, in the digital camera <b>210</b>, public keys as many as the maximum number that can be necessary, or as many as the number of the divisional images constituting the master image are acquired and stored as the public keys for the respective divisional images constituting the master image.</p><p id="p-0548" num="0546"><figref idref="DRAWINGS">FIG. <b>64</b></figref> is a flowchart for explaining a second example of a generation process for generating an encrypted grid file in a case where the encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0549" num="0547">In the second example of a generation process, in step <b>3621</b>, the digital camera <b>210</b> captures an image, in accordance with the user's operation, for example, and the process then moves on to step S<b>622</b>.</p><p id="p-0550" num="0548">In step S<b>622</b>, the file control unit <b>43</b> controls the coding control unit <b>42</b> to divide the master image obtained by capturing an image in step S<b>621</b>. Under the control of the file control unit <b>43</b>, the coding control unit <b>42</b> divides the master image into a plurality of divisional images of the same size by the preset dividing method, for example, and supplies the plurality of divisional images to the file control unit <b>43</b>. The process then moves from step S<b>622</b> on to step S<b>623</b>.</p><p id="p-0551" num="0549">In step S<b>623</b>, the recognition unit <b>211</b> performs image recognition using the image captured in step S<b>621</b>, and the process then moves on to step S<b>624</b>.</p><p id="p-0552" num="0550">In step S<b>624</b>, the file control unit <b>43</b> generates common keys for the respective divisional images showing the recognition targets recognized in the image recognition by the recognition unit <b>211</b> among the plurality of the divisional images constituting the master image. The process then moves on to step S<b>625</b>.</p><p id="p-0553" num="0551">In step S<b>625</b>, the file control unit <b>43</b> generates encrypted divisional images by encrypting the divisional images showing the recognition targets recognized in the image recognition by the recognition unit <b>211</b> among the divisional images obtained by dividing the master image, with the common keys for the divisional images. The process then moves on to step S<b>626</b>.</p><p id="p-0554" num="0552">In step S<b>626</b>, the file control unit <b>43</b> encrypts the common keys for the divisional images showing the recognition targets recognized in the image recognition by the recognition unit <b>211</b> with public keys stored in the second example of the preprocessing, the public keys being for the divisional images, and thus, generates encrypted encryption keys for the respective divisional images showing the recognition targets. The process then moves from step S<b>626</b> on to step S<b>627</b>.</p><p id="p-0555" num="0553">In step S<b>627</b>, the file control unit <b>43</b> generates an encrypted grid file that stores the divisional images in which any recognition target does not appear among the divisional images obtained by dividing the master image, and the encrypted divisional images generated in step S<b>625</b> and associated with the encrypted encryption keys that have been generated in step S<b>626</b> and correspond to the encrypted divisional images. The generation process then comes to an end.</p><p id="p-0556" num="0554">A reproduction process for reproducing the encrypted grid file generated in the second example of a generation process is similar to that in <figref idref="DRAWINGS">FIG. <b>62</b></figref>, for example, and therefore, explanation thereof is not made herein.</p><p id="p-0557" num="0555"><figref idref="DRAWINGS">FIG. <b>65</b></figref> is a flowchart for explaining a third example of a generation process for generating an encrypted grid file in a case where the encrypted grid file is handled by the image processing system <b>200</b>.</p><p id="p-0558" num="0556">In the first and second examples of a generation process, common keys are encrypted with public keys stored in advance in the digital camera <b>210</b> by the first and second examples of the preprocessing. In the third example of a generation process, however, necessary public keys are acquired in the generation process, without the preprocessing.</p><p id="p-0559" num="0557">In the third example of a generation process, in steps S<b>721</b> and S<b>722</b>, processes similar to those in steps S<b>521</b> and S<b>522</b> in <figref idref="DRAWINGS">FIG. <b>61</b></figref> are performed. The process then moves on to step S<b>723</b>.</p><p id="p-0560" num="0558">In step S<b>723</b>, the digital camera <b>210</b> acquires and stores a public key for a new recognition target among the recognition targets recognized in the image recognition by the recognition unit <b>211</b> in step S<b>722</b>. The process then moves on to step S<b>724</b>.</p><p id="p-0561" num="0559">That is, the digital camera <b>210</b> stores a recognition targets recognized in the image recognition by the recognition unit <b>211</b>, and acquires and stores a public key for a new recognition target when the new recognition target is recognized. Specifically, the digital camera <b>210</b> transmits a request for public keys as many as the number of new recognition targets to the external computer <b>101</b>. In response to the request for public keys from the digital camera <b>210</b>, the external computer <b>101</b> generates public keys and the corresponding private keys for the new recognition targets, and transmits the public keys to the digital camera <b>210</b>. The digital camera <b>210</b> receives and stores the public keys supplied for the new recognition target from the external computer <b>101</b>.</p><p id="p-0562" num="0560">In step S<b>724</b>, the file control unit <b>43</b> controls the coding control unit <b>42</b> to divide the master image obtained by capturing an image in step S<b>721</b>, in accordance with the recognition targets recognized in the image recognition performed by the recognition unit <b>211</b>. Under the control of the file control unit <b>43</b>, the coding control unit <b>42</b> divides the master image into a plurality of divisional images in a manner similar to that in step S<b>523</b> in <figref idref="DRAWINGS">FIG. <b>61</b></figref>, for example, and supplies the plurality of divisional images to the file control unit <b>43</b>. The process then moves from step <b>3724</b> on to step <b>3725</b>.</p><p id="p-0563" num="0561">In step <b>3725</b>, the file control unit <b>43</b> generates common keys for the respective recognition targets recognized in the image recognition by the recognition unit <b>211</b>, and the process then moves on to step <b>3726</b>.</p><p id="p-0564" num="0562">In step S<b>726</b>, the file control unit <b>43</b> generates encrypted divisional images by encrypting the divisional images showing the recognition targets recognized in the image recognition by the recognition unit <b>211</b> among the divisional images obtained by dividing the master image, with the common keys for the recognition targets. The process then moves on to step <b>3727</b>.</p><p id="p-0565" num="0563">In step <b>3727</b>, the file control unit <b>43</b> encrypts the common keys for the respective recognition targets recognized in the image recognition by the recognition unit <b>211</b> with the public keys for the recognition targets, and thus, generates encrypted encryption keys for the respective recognition targets. The process then moves on to step S<b>728</b>.</p><p id="p-0566" num="0564">In step S<b>728</b>, the file control unit <b>43</b> generates an encrypted grid file that stores the divisional images in which any recognition target does not appear among the divisional images obtained by dividing the master image, and the encrypted divisional images generated in step S<b>726</b> and associated with the encrypted encryption keys that have been generated in step S<b>727</b> and correspond to the encrypted divisional images. The generation process then comes to an end.</p><p id="p-0567" num="0565">Note that, in this example, common keys are generated for the respective recognition targets recognized by image recognition, and a divisional image showing a recognition target is encrypted with the common key for the recognition target. However, common keys can be generated for the respective divisional images showing the recognition targets recognized by image recognition, and a divisional image showing a recognition target can be encrypted with the common key for the divisional image, for example.</p><p id="p-0568" num="0566">&#x3c;Description of a Computer to which the Present Technology is Applied&#x3e;</p><p id="p-0569" num="0567">Next, a series of processes that are performed by the respective blocks forming the file control unit <b>43</b>, the signal processing unit <b>13</b> (<figref idref="DRAWINGS">FIG. <b>1</b></figref>), and the like described above can be performed by hardware or by software. In a case where the series of processes is performed by software, the program that forms the software is installed into a computer or the like.</p><p id="p-0570" num="0568"><figref idref="DRAWINGS">FIG. <b>66</b></figref> is a block diagram showing an example configuration of an embodiment of a computer into which the program for performing the above described series of processes is installed.</p><p id="p-0571" num="0569">The program can be recorded beforehand in a hard disk <b>905</b> or a ROM <b>903</b> provided as a recording medium in the computer.</p><p id="p-0572" num="0570">Alternatively, the program can be stored (recorded) in a removable recording medium <b>911</b> that is driven by a drive <b>909</b>. Such a removable recording medium <b>911</b> can be provided as so-called packaged software. Here, the removable recording medium <b>911</b> may be a flexible disk, a compact disc read only memory (CD-ROM), a magneto-optical (MO) disk, a digital versatile disc (DVD), a magnetic disk, a semiconductor memory, or the like, for example.</p><p id="p-0573" num="0571">Note that, the program can be installed into the computer from the above described removable recording medium <b>911</b>, but can also be downloaded into the computer via a communication network or a broadcasting network and be installed into the internal hard disk <b>905</b>. That is, the program can be wirelessly transferred from a download site, for example, to the computer via an artificial satellite for digital satellite broadcasting, or can be transferred by cable to the computer via a network such as a local area network (LAN) or the Internet.</p><p id="p-0574" num="0572">The computer includes a central processing unit (CPU) <b>902</b>, and an input/output interface <b>910</b> is connected to the CPU <b>902</b> via a bus <b>901</b>.</p><p id="p-0575" num="0573">When an instruction is input by a user operating an input unit <b>907</b> or the like via the input/output interface <b>910</b>, the CPU <b>902</b> executes the program stored in the read only memory (ROM) <b>903</b> in accordance with the instruction. Alternatively, the CPU <b>902</b> loads the program stored in the hard disk <b>905</b> into a random access memory (RAM) <b>904</b>, and executes the program.</p><p id="p-0576" num="0574">By doing so, the CPU <b>902</b> performs the processes according to the above described flowcharts, or performs the processes with the components shown in the above described block diagrams. The CPU <b>902</b> then outputs the process results from an output unit <b>906</b> or transmits the process results from a communication unit <b>908</b> via the input/output interface <b>910</b>, for example, and further stores the process results into the hard disk <b>905</b> or the like, as necessary.</p><p id="p-0577" num="0575">Note that the input unit <b>907</b> is formed with a keyboard, a mouse, a microphone, and the like. Meanwhile, the output unit <b>906</b> is formed with a liquid crystal display (LCD), a speaker, and the like.</p><p id="p-0578" num="0576">Here, in this specification, the processes to be performed by the computer in accordance with the program are not necessarily performed in chronological order according to the sequences shown in the flowcharts. That is, the processes to be performed by the computer in accordance with the program include processes to be performed in parallel or independently of one another (such as parallel processes or object-based processes, for example).</p><p id="p-0579" num="0577">Also, the program may be executed by one computer (processor), or may be executed in a distributive manner by a plurality of computers. Further, the program may be transferred to a remote computer, and be executed therein.</p><p id="p-0580" num="0578">Further, in this specification, a system means an assembly of a plurality of components (devices, modules (parts), and the like), and not all the components need to be provided in the same housing. In view of this, a plurality of devices that are housed in different housings and are connected to one another via a network forms a system, and one device having a plurality of modules housed in one housing is also a system.</p><p id="p-0581" num="0579">Note that embodiments of the present technology are not limited to the above described embodiments, and various modifications may be made to them without departing from the scope of the present technology.</p><p id="p-0582" num="0580">For example, the present technology may be embodied in a cloud computing configuration in which one function is shared among a plurality of devices via a network, and processing is performed by the devices cooperating with one another.</p><p id="p-0583" num="0581">Further, the respective steps described with reference to the flowcharts described above can be carried out by one device or can be shared among a plurality of devices.</p><p id="p-0584" num="0582">Furthermore, in a case where a plurality of processes is included in one step, the plurality of processes included in the one step can be performed by one device or can be shared among a plurality of devices.</p><p id="p-0585" num="0583">Meanwhile, the advantageous effects described in this specification are merely examples, and the advantageous effects of the present technology are not limited to them and may include other effects.</p><p id="p-0586" num="0584">Note that the present technology may also be embodied in the configurations described below.</p><p id="p-0587" num="0585">&#x3c;1&#x3e;</p><p id="p-0588" num="0586">A file processing device including</p><p id="p-0589" num="0587">a file control unit that generates a file that stores</p><p id="p-0590" num="0588">an encrypted image obtained by encrypting an image with a first encryption key, and</p><p id="p-0591" num="0589">an encrypted encryption key obtained by encrypting the first encryption key with a second encryption key,</p><p id="p-0592" num="0590">the encrypted image and the encrypted encryption key being associated with each other in the file.</p><p id="p-0593" num="0591">&#x3c;2&#x3e;</p><p id="p-0594" num="0592">The file processing device according to &#x3c;1&#x3e;, in which</p><p id="p-0595" num="0593">the first encryption key in plain text is further stored in the file.</p><p id="p-0596" num="0594">&#x3c;3&#x3e;</p><p id="p-0597" num="0595">The file processing device according to &#x3c;1&#x3e;, in which</p><p id="p-0598" num="0596">the encrypted encryption key is a specific-information-containing encryption key obtained by encrypting specific information and the first encryption key with the second encryption key, the specific information being for specifying external data, the external data being data outside the file and being associated with the image.</p><p id="p-0599" num="0597">&#x3c;4&#x3e;</p><p id="p-0600" num="0598">The file processing device according to &#x3c;3&#x3e;, in which</p><p id="p-0601" num="0599">the external data is encrypted with the first encryption key.</p><p id="p-0602" num="0600">&#x3c;5&#x3e;</p><p id="p-0603" num="0601">The file processing device according to &#x3c;3&#x3e; or &#x3c;4&#x3e;, in which</p><p id="p-0604" num="0602">the specific information and the first encryption key in plain text are further stored in the file.</p><p id="p-0605" num="0603">&#x3c;6&#x3e;</p><p id="p-0606" num="0604">The file processing device according to &#x3c;1&#x3e; or &#x3c;2&#x3e;, in which</p><p id="p-0607" num="0605">the encrypted image is an encrypted divisional image obtained by encrypting a divisional image obtained by dividing the image with the first encryption key.</p><p id="p-0608" num="0606">&#x3c;7&#x3e;</p><p id="p-0609" num="0607">The file processing device according to &#x3c;6&#x3e;, in which</p><p id="p-0610" num="0608">the encrypted divisional image is encrypted with the first encryption key that varies with each object appearing in the corresponding divisional image, and</p><p id="p-0611" num="0609">the first encryption key used in encryption of the divisional image is encrypted with the second encryption key that varies with each object.</p><p id="p-0612" num="0610">&#x3c;8&#x3e;</p><p id="p-0613" num="0611">The file processing device according to &#x3c;6&#x3e; or &#x3c;7&#x3e;, in which</p><p id="p-0614" num="0612">the image is divided into the divisional image, in accordance with the object captured in the image.</p><p id="p-0615" num="0613">&#x3c;9&#x3e;</p><p id="p-0616" num="0614">The file processing device according to any one of &#x3c;1&#x3e; to &#x3c;8&#x3e;, in which</p><p id="p-0617" num="0615">the first encryption key is a common key of a common key encryption scheme,</p><p id="p-0618" num="0616">the second encryption key is a public key of a public key encryption scheme, and</p><p id="p-0619" num="0617">the file is a high efficiency image file format (HEIF) file.</p><p id="p-0620" num="0618">&#x3c;10&#x3e;</p><p id="p-0621" num="0619">A file processing method including</p><p id="p-0622" num="0620">generating a file that stores</p><p id="p-0623" num="0621">an encrypted image obtained by encrypting an image with a first encryption key, and</p><p id="p-0624" num="0622">an encrypted encryption key obtained by encrypting the first encryption key with a second encryption key,</p><p id="p-0625" num="0623">the encrypted image and the encrypted encryption key being associated with each other in the file.</p><p id="p-0626" num="0624">&#x3c;11&#x3e;</p><p id="p-0627" num="0625">A file processing device including</p><p id="p-0628" num="0626">a file control unit that decrypts an encrypted image into an image with a first encryption key, the first encryption key being obtained by decrypting an encrypted encryption key in a file, the file storing</p><p id="p-0629" num="0627">the encrypted image obtained by encrypting the image with the first encryption key, and</p><p id="p-0630" num="0628">the encrypted encryption key obtained by encrypting the first encryption key with a second encryption key,</p><p id="p-0631" num="0629">the encrypted image and the encrypted encryption key being associated with each other in the file.</p><p id="p-0632" num="0630">&#x3c;12&#x3e;</p><p id="p-0633" num="0631">The file processing device according to &#x3c;11&#x3e;, in which,</p><p id="p-0634" num="0632">when the first encryption key in plain text is further stored in the file, the file control unit decrypts the encrypted image into the image with the first encryption key in the plain text, and,</p><p id="p-0635" num="0633">when the first encryption key in plain text is not stored in the file, the file control unit decrypts the encrypted encryption key into the first encryption key, and decrypts the encrypted image into the image with the first encryption key obtained by the decryption of the encrypted encryption key.</p><p id="p-0636" num="0634">&#x3c;13&#x3e;</p><p id="p-0637" num="0635">The file processing device according to &#x3c;11&#x3e;, in which</p><p id="p-0638" num="0636">the encrypted encryption key is a specific-information-containing encryption key obtained by encrypting specific information for specifying external data and the first encryption key with the second encryption key, the external data being data outside the file and being associated with the image, and</p><p id="p-0639" num="0637">the file control unit decrypts the specific-information-containing encryption key into the specific information and the first encryption key, and acquires the external data specified by the specific information obtained by the decryption of the specific-information-containing encryption key.</p><p id="p-0640" num="0638">&#x3c;14&#x3e;</p><p id="p-0641" num="0639">The file processing device according to &#x3c;13&#x3e;, in which,</p><p id="p-0642" num="0640">when the external data is encrypted with the first encryption key, the file control unit decrypts the encrypted external data with the first encryption key.</p><p id="p-0643" num="0641">&#x3c;15&#x3e;</p><p id="p-0644" num="0642">The file processing device according to &#x3c;13&#x3e; or &#x3c;14&#x3e;, in which,</p><p id="p-0645" num="0643">when the specific information and the first encryption key in plain text are further stored in the file, the file control unit acquires the external data specified by the specific information in the plain text, and,</p><p id="p-0646" num="0644">when the specific information and the first encryption key in plain text are not stored in the file, the file control unit decrypts the specific-information-containing encryption key into the specific information and the first encryption key, and acquires the external data specified by the specific information obtained by the decryption of the specific-information-containing encryption key.</p><p id="p-0647" num="0645">&#x3c;16&#x3e;</p><p id="p-0648" num="0646">The file processing device according to &#x3c;11&#x3e; or &#x3c;12&#x3e;, in which</p><p id="p-0649" num="0647">the encrypted image is an encrypted divisional image obtained by encrypting a divisional image obtained by dividing the image with the first encryption key, and</p><p id="p-0650" num="0648">the file control unit decrypts the encrypted encryption key into the first encryption key, and decrypts the encrypted divisional image into the divisional image with the first encryption key obtained by the decryption of the encrypted encryption key.</p><p id="p-0651" num="0649">&#x3c;17&#x3e;</p><p id="p-0652" num="0650">The file processing device according to &#x3c;16&#x3e;, in which</p><p id="p-0653" num="0651">the encrypted divisional image is encrypted with the first encryption key that varies with each object appearing in the corresponding divisional image,</p><p id="p-0654" num="0652">the first encryption key used in encryption of the divisional image is encrypted with the second encryption key that varies with each object, and</p><p id="p-0655" num="0653">the file control unit decrypts the encrypted encryption key obtained by encrypting the first encryption key for an object of interest into the first encryption key, and decrypts the encrypted divisional image showing the object of interest into the divisional image with the first encryption key that has been obtained for the object of interest by the decryption of the encrypted encryption key.</p><p id="p-0656" num="0654">&#x3c;18&#x3e;</p><p id="p-0657" num="0655">The file processing device according to &#x3c;16&#x3e; or &#x3c;17&#x3e;, in which</p><p id="p-0658" num="0656">the image is divided into the divisional image, in accordance with the object captured in the image.</p><p id="p-0659" num="0657">&#x3c;19&#x3e;</p><p id="p-0660" num="0658">The file processing device according to any one of &#x3c;11&#x3e; to &#x3c;18&#x3e;, in which</p><p id="p-0661" num="0659">the first encryption key is a common key of a common key encryption scheme,</p><p id="p-0662" num="0660">the second encryption key is a public key of a public key encryption scheme, and</p><p id="p-0663" num="0661">the file is a high efficiency image file format (HEIF) file.</p><p id="p-0664" num="0662">&#x3c;20&#x3e;</p><p id="p-0665" num="0663">A file processing method including</p><p id="p-0666" num="0664">decrypting an encrypted image into an image with a first encryption key, the first encryption key being obtained by decrypting an encrypted encryption key in a file, the file storing</p><p id="p-0667" num="0665">the encrypted image obtained by encrypting the image with the first encryption key, and</p><p id="p-0668" num="0666">the encrypted encryption key obtained by encrypting the first encryption key with a second encryption key,</p><p id="p-0669" num="0667">the encrypted image and the encrypted encryption key being associated with each other in the file.</p><heading id="h-0010" level="1">REFERENCE SIGNS LIST</heading><p id="p-0670" num="0000"><ul id="ul0002" list-style="none">    <li id="ul0002-0001" num="0668"><b>10</b> Digital camera</li>    <li id="ul0002-0002" num="0669"><b>11</b> Optical system</li>    <li id="ul0002-0003" num="0670"><b>13</b> Signal processing unit</li>    <li id="ul0002-0004" num="0671"><b>14</b> Medium</li>    <li id="ul0002-0005" num="0672"><b>15</b>, <b>16</b> Interface</li>    <li id="ul0002-0006" num="0673"><b>17</b> Buttons/Keys</li>    <li id="ul0002-0007" num="0674"><b>18</b> Touch panel</li>    <li id="ul0002-0008" num="0675"><b>19</b> Liquid crystal panel</li>    <li id="ul0002-0009" num="0676"><b>20</b> Viewfinder</li>    <li id="ul0002-0010" num="0677"><b>21</b> Interface</li>    <li id="ul0002-0011" num="0678"><b>41</b> Optical system/image sensor control unit</li>    <li id="ul0002-0012" num="0679"><b>42</b> Coding control unit</li>    <li id="ul0002-0013" num="0680"><b>43</b> File control unit</li>    <li id="ul0002-0014" num="0681"><b>44</b> Media control unit</li>    <li id="ul0002-0015" num="0682"><b>45</b> Operation control unit</li>    <li id="ul0002-0016" num="0683"><b>46</b> Display control unit</li>    <li id="ul0002-0017" num="0684"><b>47</b> UI control unit</li>    <li id="ul0002-0018" num="0685"><b>901</b> Bus</li>    <li id="ul0002-0019" num="0686"><b>902</b> CPU</li>    <li id="ul0002-0020" num="0687"><b>903</b> ROM</li>    <li id="ul0002-0021" num="0688"><b>904</b> RAM</li>    <li id="ul0002-0022" num="0689"><b>905</b> Hard disk</li>    <li id="ul0002-0023" num="0690"><b>906</b> Output unit</li>    <li id="ul0002-0024" num="0691"><b>907</b> Input unit</li>    <li id="ul0002-0025" num="0692"><b>908</b> Communication unit</li>    <li id="ul0002-0026" num="0693"><b>909</b> Drive</li>    <li id="ul0002-0027" num="0694"><b>910</b> Input/output interface</li>    <li id="ul0002-0028" num="0695"><b>911</b> Removable recording medium</li></ul></p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A file processing device comprising<claim-text>a file control unit that generates a file that stores</claim-text><claim-text>an encrypted image obtained by encrypting an image with a first encryption key, and</claim-text><claim-text>an encrypted encryption key obtained by encrypting the first encryption key with a second encryption key,</claim-text><claim-text>the encrypted image and the encrypted encryption key being associated with each other in the file.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The file processing device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the first encryption key in plain text is further stored in the file.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The file processing device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the encrypted encryption key is a specific-information-containing encryption key obtained by encrypting specific information and the first encryption key with the second encryption key, the specific information being for specifying external data, the external data being data outside the file and being associated with the image.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The file processing device according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein<claim-text>the external data is encrypted with the first encryption key.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The file processing device according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein<claim-text>the specific information and the first encryption key in plain text are further stored in the file.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The file processing device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the encrypted image is an encrypted divisional image obtained by encrypting a divisional image obtained by dividing the image with the first encryption key.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The file processing device according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein<claim-text>the encrypted divisional image is encrypted with the first encryption key that varies with each object appearing in the corresponding divisional image, and</claim-text><claim-text>the first encryption key used in encryption of the divisional image is encrypted with the second encryption key that varies with each object.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The file processing device according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein<claim-text>the image is divided into the divisional image, in accordance with an object captured in the image.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The file processing device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the first encryption key is a common key of a common key encryption scheme,</claim-text><claim-text>the second encryption key is a public key of a public key encryption scheme, and</claim-text><claim-text>the file is a high efficiency image file format (HEIF) file.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. A file processing method comprising<claim-text>generating a file that stores</claim-text><claim-text>an encrypted image obtained by encrypting an image with a first encryption key, and</claim-text><claim-text>an encrypted encryption key obtained by encrypting the first encryption key with a second encryption key,</claim-text><claim-text>the encrypted image and the encrypted encryption key being associated with each other in the file.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. A file processing device comprising<claim-text>a file control unit that decrypts an encrypted image into an image with a first encryption key, the first encryption key being obtained by decrypting an encrypted encryption key in a file, the file storing</claim-text><claim-text>the encrypted image obtained by encrypting the image with the first encryption key, and</claim-text><claim-text>the encrypted encryption key obtained by encrypting the first encryption key with a second encryption key,</claim-text><claim-text>the encrypted image and the encrypted encryption key being associated with each other in the file.</claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The file processing device according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein,<claim-text>when the first encryption key in plain text is further stored in the file, the file control unit decrypts the encrypted image into the image with the first encryption key in the plain text, and,</claim-text><claim-text>when the first encryption key in plain text is not stored in the file, the file control unit decrypts the encrypted encryption key into the first encryption key, and decrypts the encrypted image into the image with the first encryption key obtained by the decryption of the encrypted encryption key.</claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The file processing device according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein<claim-text>the encrypted encryption key is a specific-information-containing encryption key obtained by encrypting specific information for specifying external data and the first encryption key with the second encryption key, the external data being data outside the file and being associated with the image, and</claim-text><claim-text>the file control unit decrypts the specific-information-containing encryption key into the specific information and the first encryption key, and acquires the external data specified by the specific information obtained by the decryption of the specific-information-containing encryption key.</claim-text></claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The file processing device according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein,<claim-text>when the external data is encrypted with the first encryption key, the file control unit decrypts the encrypted external data with the first encryption key.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The file processing device according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein,<claim-text>when the specific information and the first encryption key in plain text are further stored in the file, the file control unit acquires the external data specified by the specific information in the plain text, and,</claim-text><claim-text>when the specific information and the first encryption key in plain text are not stored in the file, the file control unit decrypts the specific-information-containing encryption key into the specific information and the first encryption key, and acquires the external data specified by the specific information obtained by the decryption of the specific-information-containing encryption key.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The file processing device according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein<claim-text>the encrypted image is an encrypted divisional image obtained by encrypting a divisional image obtained by dividing the image with the first encryption key, and</claim-text><claim-text>the file control unit decrypts the encrypted encryption key into the first encryption key, and decrypts the encrypted divisional image into the divisional image with the first encryption key obtained by the decryption of the encrypted encryption key.</claim-text></claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The file processing device according to <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein<claim-text>the encrypted divisional image is encrypted with the first encryption key that varies with each object appearing in the corresponding divisional image,</claim-text><claim-text>the first encryption key used in encryption of the divisional image is encrypted with the second encryption key that varies with each object, and</claim-text><claim-text>the file control unit decrypts the encrypted encryption key obtained by encrypting the first encryption key for an object of interest into the first encryption key, and decrypts the encrypted divisional image showing the object of interest into the divisional image with the first encryption key that has been obtained for the object of interest by the decryption of the encrypted encryption key.</claim-text></claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The file processing device according to <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein<claim-text>the image is divided into the divisional image, in accordance with an object captured in the image.</claim-text></claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The file processing device according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein<claim-text>the first encryption key is a common key of a common key encryption scheme,</claim-text><claim-text>the second encryption key is a public key of a public key encryption scheme, and</claim-text><claim-text>the file is a high efficiency image file format (HEIF) file.</claim-text></claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. A file processing method comprising<claim-text>decrypting an encrypted image into an image with a first encryption key, the first encryption key being obtained by decrypting an encrypted encryption key in a file, the file storing</claim-text><claim-text>the encrypted image obtained by encrypting the image with the first encryption key, and</claim-text><claim-text>the encrypted encryption key obtained by encrypting the first encryption key with a second encryption key,</claim-text><claim-text>the encrypted image and the encrypted encryption key being associated with each other in the file.</claim-text></claim-text></claim></claims></us-patent-application>