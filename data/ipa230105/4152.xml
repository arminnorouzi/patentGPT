<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230004153A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230004153</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17781612</doc-number><date>20201224</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>JP</country><doc-number>2020-000427</doc-number><date>20200106</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>05</class><subclass>B</subclass><main-group>23</main-group><subgroup>02</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>05</class><subclass>B</subclass><main-group>23</main-group><subgroup>0235</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>05</class><subclass>B</subclass><main-group>23</main-group><subgroup>0275</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>05</class><subclass>B</subclass><main-group>23</main-group><subgroup>0221</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">DIAGNOSING DEVICE, DIAGNOSING METHOD, AND PROGRAM</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>MITSUBISHI HEAVY INDUSTRIES, LTD.</orgname><address><city>Tokyo</city><country>JP</country></address></addressbook><residence><country>JP</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>NAGANO</last-name><first-name>Ichiro</first-name><address><city>Yokohama-shi</city><country>JP</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>SAITO</last-name><first-name>Mayumi</first-name><address><city>Tokyo</city><country>JP</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>EGUCHI</last-name><first-name>Keiji</first-name><address><city>Tokyo</city><country>JP</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>AOYAMA</last-name><first-name>Kuniaki</first-name><address><city>Takasago City</city><country>JP</country></address></addressbook></inventor></inventors></us-parties><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/JP2020/048494</doc-number><date>20201224</date></document-id><us-371c12-date><date>20220601</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">Provided are a diagnosing device, a diagnosing method, and a program with which it is possible to detect abnormalities accurately even if there is a small amount of data or the number of data points varies. This diagnosing device is provided with a Mahalanobis distance calculating unit which calculates the Mahalanobis distance (referred to as &#x2018;MD value&#x2019; hereinbelow) of a detected value, and an abnormality determining unit which determines the presence or absence of an abnormality on the basis of the MD value, wherein the abnormality determining unit determines the presence or absence of an abnormality by arranging that a determination that there is no abnormality is more likely to occur if the number of samples per unit space is small than if the number of samples per unit space is large.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="84.33mm" wi="112.44mm" file="US20230004153A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="224.96mm" wi="114.47mm" file="US20230004153A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="234.19mm" wi="150.96mm" file="US20230004153A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="232.07mm" wi="148.51mm" file="US20230004153A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="230.80mm" wi="147.74mm" file="US20230004153A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="168.23mm" wi="147.83mm" file="US20230004153A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">TECHNICAL FIELD</heading><p id="p-0002" num="0001">The present disclosure relates to a diagnosing device, a diagnosing method, and a program. The present application claims priority based on Japanese Patent Application No. 2020-000427 filed in Japan on Jan. 6, 2020, the contents of which are incorporated herein by reference.</p><heading id="h-0002" level="1">BACKGROUND ART</heading><p id="p-0003" num="0002">The Mahalanobis Taguchi System (MT method) using a Mahalanobis distance is widely used in anomaly detection systems in power generation facilities and remote monitoring systems (for example, PTL 1). As described in PTL 1, in the Mahalanobis distance, it is assumed that normal data follow a normal distribution, but actual data does not follow a normal distribution in many cases. Therefore, in an anomaly detection preprocessing apparatus described in PTL 1, it is determined whether or not the distribution data for two variables within a predetermined period, measured at a normal time, has a distribution according to the normal distribution, a predetermined number of pieces of distribution data selected from the distribution data determined not to follow the normal distribution are fitted to a tentative nonlinear model, and a correction term for correcting the distribution data is calculated by the difference between the tentative nonlinear model and a regression line. A tentative nonlinear model in which the distribution data corrected by the correction term results in a distribution that most follows the normal distribution is selected as an anomaly detection model when used in anomaly detection, and the correction term calculated based on the anomaly detection model is selected as the correction term used for the anomaly detection.</p><p id="p-0004" num="0003">Further, the anomaly detection apparatus described in PTL 1 calculates correction determination data obtained by correcting determination data that is measurement data to be determined as normal or abnormal, based on the correction term selected by the anomaly detection preprocessing apparatus, and determines whether or not the correction determination data is abnormal, based on the Mahalanobis distance. According to the anomaly detection preprocessing apparatus and the anomaly detection apparatus described in PTL 1, the normal distribution of the normal data is quantitatively evaluated and the anomaly detection model and the correction term used for anomaly detection are selected based on the distribution data measured at the normal time, so that it is possible to accurately detect data (that is, abnormal data) that deviates from the measurement data obtained at the normal time.</p><heading id="h-0003" level="1">CITATION LIST</heading><heading id="h-0004" level="1">Patent Literature</heading><p id="p-0005" num="0000"><ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0004">[PTL 1] Japanese Patent No. 6129508</li></ul></p><heading id="h-0005" level="1">SUMMARY OF INVENTION</heading><heading id="h-0006" level="1">Technical Problem</heading><p id="p-0006" num="0005">As described above, in the anomaly detection preprocessing apparatus described in PTL 1, the correction term is selected based on the result of determining whether or not the data distribution follows the normal distribution. Therefore, a plurality of pieces of data are required for determining whether or not the distribution follows the normal distribution. However, in equipment that may continue to operate for a while (for example, several months) once the equipment is started, such as the gas turbine equipment shown as an example in PTL 1, there is a problem that it takes a long time to collect a plurality of pieces of data that can be measured only once at one startup (for example, a time required for a predetermined state change at startup, the maximum value, minimum value, average value, total value, or the like of data at startup).</p><p id="p-0007" num="0006">The present disclosure has been made to solve the above problems, and an object is to provide a diagnosing device, a diagnosing method, and a program capable of accurately detecting anomalies even when the amount of data is small or the number of data pieces varies.</p><heading id="h-0007" level="1">Solution to Problem</heading><p id="p-0008" num="0007">In order to solve the above problems, a diagnosing device according to the present disclosure includes: a Mahalanobis distance calculating unit that calculates a Mahalanobis distance (referred to as &#x201c;MD value&#x201d; hereinbelow) of a detected value; and an anomaly determination unit that determines a presence or absence of an anomaly based on the MD value, wherein the anomaly determination unit determines the presence or absence of an anomaly in a manner that a determination that there is no anomaly is more likely to occur when the number of samples per unit space is small than when the number of samples per unit space is large.</p><p id="p-0009" num="0008">Further, a diagnosing method according to the present disclosure includes: a step of calculating an MD value of a detected value, and a step of determining a presence or absence of an anomaly, based on the MD value in a manner that a determination that there is no anomaly is more likely to occur when the number of samples per unit space is small than when the number of samples per unit space is large.</p><p id="p-0010" num="0009">Further, a program according to the present disclosure causes a computer to execute: a step of calculating an MD value of a detected value, and a step of determining a presence or absence of an anomaly, based on the MD value in a manner that a determination that there is no anomaly is more likely to occur when the number of samples per unit space is small than when the number of samples per unit space is large.</p><heading id="h-0008" level="1">Advantageous Effects of Invention</heading><p id="p-0011" num="0010">According to the diagnosing device, the diagnosing method, and the program of the present disclosure, it is possible to detect anomalies accurately even when there is a small amount of data or the number of data points varies.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0009" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a diagram showing a configuration example of a diagnosing device according to a first embodiment of the present disclosure.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a flowchart showing an operation example of the diagnosing device according to the first embodiment of the present disclosure.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a schematic diagram for explaining a diagnosing device according to a second embodiment of the present disclosure.</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flowchart showing an operation example of the diagnosing device according to the second embodiment of the present disclosure.</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a system flow diagram showing the operation example of the diagnosing device according to the second embodiment of the present disclosure.</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a schematic diagram for explaining a diagnosing device according to a third embodiment of the present disclosure.</p><p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a flowchart showing an operation example of the diagnosing device according to the third embodiment of the present disclosure.</p><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a system flow diagram showing the operation example of the diagnosing device according to the third embodiment of the present disclosure.</p><p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a system flow diagram showing an operation example of a diagnosing device according to a fourth embodiment of the present disclosure.</p><p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a schematic block diagram illustrating a configuration of a computer according to at least one embodiment.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0010" level="1">DESCRIPTION OF EMBODIMENTS</heading><heading id="h-0011" level="1">First Embodiment</heading><p id="p-0022" num="0021">(Configuration of Diagnosing Device)</p><p id="p-0023" num="0022">Hereinafter, a diagnosing device according to an embodiment of the present disclosure will be described with reference to <figref idref="DRAWINGS">FIGS. <b>1</b> and <b>2</b></figref>. In each figure, the same reference numerals are used for the same or corresponding configurations, and the description thereof will be omitted as appropriate. The present embodiment will be described assuming that a diagnosing device <b>10</b> is provided in a monitoring center for monitoring a gas turbine and is used for detecting an anomaly in the gas turbine, but the present invention is not limited thereto.</p><p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a diagram showing a configuration example of the diagnosing device <b>10</b> according to the first embodiment of the present disclosure. The diagnosing device <b>10</b> shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref> is, for example, a device that monitors gas turbine equipment <b>31</b> installed in a power plant and diagnoses the presence or absence of an anomaly. The gas turbine equipment <b>31</b> and the diagnosing device <b>10</b> are connected to each other via a network <b>32</b> such that information can be exchanged. For example, the diagnosing device <b>10</b> receives gas turbine operation data, alarm information, inquiry information, and the like transmitted from the gas turbine equipment <b>31</b> at predetermined timings. The diagnosing device <b>10</b> stores various pieces of acquired information in a storage unit <b>13</b> (details will be described later). In the present embodiment, it is described that the diagnosing device <b>10</b> is provided at a remote location from the gas turbine equipment <b>31</b> via the network <b>32</b>, but the position of the diagnosing device <b>10</b> is not limited to this.</p><p id="p-0025" num="0024">The diagnosing device <b>10</b> can be configured by using, for example, a computer such as a server or a personal computer and its peripheral devices. The diagnosing device <b>10</b> includes a Mahalanobis distance calculating unit <b>11</b>, an anomaly determination unit <b>12</b>, and a storage unit <b>13</b>, as a functional configuration composed of a combination of hardware such as a computer and its peripheral devices and software such as a program executed by the computer.</p><p id="p-0026" num="0025">The storage unit <b>13</b> stores measurement data (operation data, or the like) within a predetermined period obtained from measurement equipment provided at a plurality of locations of the gas turbine equipment <b>31</b>. Examples of the measurement data include measurement data within a predetermined period measured in an unsteady state in which normal data varies particularly, such as when the gas turbine is started, and measurement data that is a target for determining normality or anomaly of gas turbine equipment. Further, in the present embodiment, examples of the plurality of locations of the gas turbine equipment include a combustor, a compressor, or the like, and examples of the measurement data include information such as the temperature, the voltage, the current, the rotation speed, the pressure value, the time required for a predetermined state change at the time of startup or the like, and the maximum value, the minimum value, the average value, the total value, or the like of the data at the time of startup or the like, obtained from the plurality of locations. Further, the storage unit <b>13</b> stores values such as the number of samples (number of data pieces), the mean value, the standard deviation, the inverse matrix of the correlation matrix, and the threshold value for anomaly determination related to a unit space in the MT method.</p><p id="p-0027" num="0026">The Mahalanobis distance calculating unit <b>11</b> calculates the MD value of the measurement data (detected value). The Mahalanobis distance calculating unit <b>11</b> obtains a k-dimensional MD value by using the following expression. Here, k is the number of items, i and j are 1 to k, &#x3b1;ij are the i and j components of the inverse matrix of the correlation matrix, and mi, mj, &#x3c3;i and &#x3c3;j are the mean value and standard deviation in the unit space, respectively. The unit space is a reference data group consisting of a plurality of MD values based on the measurement data at the normal time, and is calculated based on a plurality of samples of a set of measurement data of k items. The unit space is updated based on new measurement data by, for example, the Mahalanobis distance calculating unit <b>11</b>.</p><p id="p-0028" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mrow>  <msup>   <mi>MD</mi>   <mn>2</mn>  </msup>  <mo>=</mo>  <mrow>   <mfrac>    <mn>1</mn>    <mi>k</mi>   </mfrac>   <mo>&#x2062;</mo>   <mrow>    <mo>&#x2211;</mo>    <mrow>     <mrow>      <msub>       <mi>&#x3b1;</mi>       <mi>ij</mi>      </msub>      <mo>(</mo>      <mfrac>       <mrow>        <msub>         <mi>x</mi>         <mi>i</mi>        </msub>        <mo>-</mo>        <msub>         <mi>m</mi>         <mi>i</mi>        </msub>       </mrow>       <msub>        <mi>&#x3c3;</mi>        <mi>i</mi>       </msub>      </mfrac>      <mo>)</mo>     </mrow>     <mo>&#x2062;</mo>     <mrow>      <mo>(</mo>      <mfrac>       <mrow>        <msub>         <mi>x</mi>         <mi>j</mi>        </msub>        <mo>-</mo>        <msub>         <mi>m</mi>         <mi>j</mi>        </msub>       </mrow>       <msub>        <mi>&#x3c3;</mi>        <mi>j</mi>       </msub>      </mfrac>      <mo>)</mo>     </mrow>    </mrow>   </mrow>  </mrow> </mrow></math></maths></p><p id="p-0029" num="0027">In addition, the determination using the Mahalanobis distance is a method of expressing the characteristic amount (multivariable) of a certain group with one parameter (Mahalanobis distance), and evaluating whether certain measurement data is good or bad by the distance from the basic data of a healthy group (measurement data at the normal time). When some measurement data is bad, the distance from the healthy group becomes larger, and when the measurement data is good, the distance from the healthy group becomes smaller.</p><p id="p-0030" num="0028">The anomaly determination unit <b>12</b> determines the presence or absence of an anomaly, based on the MD value calculated by the Mahalanobis distance calculating unit <b>11</b>. In this case, the anomaly determination unit <b>12</b> determines the presence or absence of an anomaly in a manner that a determination that there is no anomaly is more likely to occur when the number of samples per unit space is small than when the number of samples per unit space is large. The anomaly determination unit <b>12</b> sets, for example, a threshold value (also referred to as an MD threshold value) for the Mahalanobis distance, and determines as normal, when the Mahalanobis distance is equal to or less than the threshold value, and determines as abnormal, and when the Mahalanobis distance is larger than the threshold value.</p><p id="p-0031" num="0029">(Operation of Diagnosing Device)</p><p id="p-0032" num="0030">Next, with reference to <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the basic operation of the diagnosing device <b>10</b> shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref> will be described. <figref idref="DRAWINGS">FIG. <b>2</b></figref> is a flowchart showing an operation example of the diagnosing device according to the first embodiment of the present disclosure.</p><p id="p-0033" num="0031">The process shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref> is started according to, for example, a predetermined operation input of the operator. It is assumed that the storage unit <b>13</b> stores the measurement data regarding the operation of the gas turbine measured by the gas turbine equipment <b>31</b>. In the diagnosing device <b>10</b>, first, the Mahalanobis distance calculating unit <b>11</b> calculates the MD value of the measurement data (detected value) (step S<b>11</b>). Next, the anomaly determination unit <b>12</b> determines a presence or absence of the anomaly in a manner that a determination that there is no anomaly is more likely to occur when the number of samples per unit space is small than when the number of samples per unit space is large (step S<b>12</b>).</p><p id="p-0034" num="0032">In step S<b>12</b>, for example, the anomaly determination unit <b>12</b> determines the presence or absence of an anomaly, by increasing the threshold value for anomaly determination for the MD value, when the number of samples per unit space is small. When the threshold value becomes large, it is not often determined that there is an anomaly when the MD value is large. Alternatively, for example, when the number of samples per unit space is small, the anomaly determination unit <b>12</b> may correct the MD value calculated by the Mahalanobis distance calculating unit <b>11</b> to be small by multiplying the MD value by a coefficient for reducing the MD value. When the MD value becomes small, it is not often determined that there is an anomaly even when the threshold value for determining the anomaly does not change. Alternatively, the anomaly determination unit <b>12</b> may combine the correction of the threshold value and the correction of the MD value.</p><p id="p-0035" num="0033">When the number of samples is small, the distribution of MD values, which is the basis of the unit space, does not follow the normal distribution in many cases. In this case, for example, when the threshold value is set assuming a normal distribution, it is considered that the MD value often exceeds the threshold value even though it is normal. On the other hand, in a manner that a determination that there is no anomaly is more likely to occur when the number of samples per unit space is small than when the number of samples per unit space is large, in the present embodiment, it is possible to reduce the number of cases where an anomaly is erroneously detected even though it is normal. That is, it is possible to suppress the occurrence of erroneous detection and improve the accuracy of anomaly detection. The anomaly determination unit <b>12</b> can prevent the occurrence of erroneous detection that is determined to be normal, even though it is abnormal, by using, for example, a combination of the anomaly detection technique described in PTL 1.</p><p id="p-0036" num="0034">The determination result of the presence or absence of an anomaly by the anomaly determination unit <b>12</b> can be stored in the storage unit <b>13</b>, for example, output from a display device, a printing device, an acoustic output device, or the like (not shown) included in the diagnosing device <b>10</b>, or transmitted to an external terminal via a communication device (not shown) included in the diagnosing device <b>10</b>.</p><heading id="h-0012" level="1">Second Embodiment</heading><p id="p-0037" num="0035">Next, a second embodiment of the present disclosure will be described with reference to <figref idref="DRAWINGS">FIGS. <b>3</b> to <b>5</b></figref>. <figref idref="DRAWINGS">FIG. <b>3</b></figref> is a schematic diagram for explaining a diagnosing device according to the second embodiment of the present disclosure. <figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flowchart showing an operation example of the diagnosing device according to the second embodiment of the present disclosure. <figref idref="DRAWINGS">FIG. <b>5</b></figref> is a system flow diagram showing an operation example of the diagnosing device according to the second embodiment of the present disclosure.</p><p id="p-0038" num="0036">The basic configuration of the diagnosing device of the second embodiment is the same as that of the diagnosing device <b>10</b> of the first embodiment shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>. In the second embodiment, as compared with the first embodiment, a part of the operation of the anomaly determination unit <b>12</b> shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref> is detailed.</p><p id="p-0039" num="0037"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a diagram schematically showing the probability distribution of the Mahalanobis distance MD with a normal distribution and n (or Student's t-distribution). Further, <figref idref="DRAWINGS">FIG. <b>3</b></figref> shows the normal distribution cumulative probability of MD&#x2265;3 (inverse cumulative distribution function of normal distribution) and the t-distribution cumulative probability of MD&#x2265;5 (inverse cumulative distribution function in a t-distribution) by shading.</p><p id="p-0040" num="0038">The mathematically correct probability density function is a t-distribution when the number of samples is small, and approaches a normal distribution when the number of samples is large. When the number of samples is infinite, the t-distribution and the normal distribution match. Further, when the number of sensors is small and 1, it is equal to the t-test. Even with the same MD, the cumulative probability changes depending on the assumed probability density function. In particular, the t-distribution is wider than the normal distribution. In a case of diagnosing &#x201c;abnormal in 3&#x3c;MD value&#x201d;, when the number of data is small and it is a t-distribution, even though &#x201c;3&#x3c;MD value&#x201d; is a relatively common event, there are many false detections that &#x201c;3&#x3c;MD value&#x201d; is regarded as &#x201c;abnormal&#x201d;.</p><p id="p-0041" num="0039">Therefore, in the second embodiment, the anomaly determination unit <b>12</b> corrects the MD value calculated by the Mahalanobis distance calculating unit <b>11</b> to an MD&#x2032; value (second MD value), based on a cumulative probability in a t-distribution having a degree of freedom according to the number of samples (hereinafter referred to as the t-distribution cumulative probability) and a cumulative probability in a normal distribution corresponding to the t-distribution cumulative probability, and determines the presence or absence of an anomaly, based on the result of comparing the MD&#x2032; value with a predetermined threshold value.</p><p id="p-0042" num="0040">As shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>, in the second embodiment, the Mahalanobis distance calculating unit <b>11</b> first calculates the MD value of the measurement data (detected value) (step S<b>21</b>). In this case, it is assumed that the MD value is &#x201c;5&#x201d;.</p><p id="p-0043" num="0041">Next, the anomaly determination unit <b>12</b> obtains the t-distribution cumulative probability up to the MD value (&#x201c;5&#x201d;) in the t-distribution, for the MD value calculated by the Mahalanobis distance calculating unit <b>11</b> via the MT method (step S<b>22</b>).</p><p id="p-0044" num="0042">Next, the anomaly determination unit <b>12</b> obtains an MD&#x2032; value in the normal distribution such that the cumulative probability is equal to the obtained t-distribution cumulative probability (normal distribution cumulative probability) (step S<b>23</b>). In this case, it is assumed that the MD&#x2032; value is &#x201c;3&#x201d;.</p><p id="p-0045" num="0043">Next, the anomaly determination unit <b>12</b> compares the MD&#x2032; value with the threshold value to perform an anomaly diagnosis (step S<b>24</b>).</p><p id="p-0046" num="0044">The anomaly determination unit <b>12</b> can obtain the MD&#x2032; value, which is the corrected MD value, by using, for example, the following expression.</p><p id="p-0047" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>MD&#x2032;=&#x221a;{square root over (2)}*erf<sub>inv</sub>(2*<i>t</i><sub>cdf</sub>(MD,&#x3bd;)&#x2212;1)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0048" num="0045">Here, tcdf is the cumulative distribution function of the t-distribution, erfinv is the inverse function of the error function, &#x3bd; is a degree of freedom, in (N&#x2212;A), N is the number of samples in the unit space (the number of data), and A is the number of sensors.</p><p id="p-0049" num="0046">As shown in <figref idref="DRAWINGS">FIG. <b>5</b></figref>, the anomaly determination unit <b>12</b> calculates a t-distribution cumulative probability (<b>103</b>), based on the MD value (<b>101</b>) calculated by the MD Mahalanobis distance calculating unit <b>11</b> via the MT method and the number of samples (sample number) (<b>102</b>). Further, the anomaly determination unit <b>12</b> calculates the MD&#x2032; value (<b>104</b>) in a normal distribution having the same cumulative probability. Then, the anomaly determination unit <b>12</b> compares the MD&#x2032; value (<b>104</b>) with the MD threshold value (<b>105</b>).</p><p id="p-0050" num="0047">As described above, according to the second embodiment, it is possible to reduce the case where an anomaly is erroneously detected even though it is normal, as in the first embodiment. Further, by using the above expression, the same calculation expression can be used from when the number of samples is small to when the number of samples is large.</p><heading id="h-0013" level="1">Third Embodiment</heading><p id="p-0051" num="0048">Next, a third embodiment of the present disclosure will be described with reference to <figref idref="DRAWINGS">FIGS. <b>6</b> to <b>8</b></figref>. <figref idref="DRAWINGS">FIG. <b>6</b></figref> is a schematic diagram for explaining a diagnosing device according to the third embodiment of the present disclosure. <figref idref="DRAWINGS">FIG. <b>7</b></figref> is a flowchart showing an operation example of the diagnosing device according to the third embodiment of the present disclosure. <figref idref="DRAWINGS">FIG. <b>8</b></figref> is a system flow diagram showing an operation example of the diagnosing device according to the third embodiment of the present disclosure.</p><p id="p-0052" num="0049">The basic configuration of the diagnosing device of the third embodiment is the same as that of the diagnosing device <b>10</b> of the first embodiment shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>. In the third embodiment, as compared with the first embodiment, a part of the operation of the anomaly determination unit <b>12</b> shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref> is detailed.</p><p id="p-0053" num="0050"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a diagram schematically showing the probability distribution of the Mahalanobis distance MD with a normal distribution and the t-distribution, as in <figref idref="DRAWINGS">FIG. <b>3</b></figref>. Further, <figref idref="DRAWINGS">FIG. <b>6</b></figref> shows the normal distribution cumulative probability of MD&#x2265;3 (inverse cumulative distribution function of normal distribution) and the t-distribution cumulative probability of MD&#x2265;5 by shading. In <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the value of the threshold value MDc is &#x201c;3&#x201d;.</p><p id="p-0054" num="0051">In the third embodiment, the anomaly determination unit <b>12</b> obtains the cumulative probability (normal distribution cumulative probability) up to a predetermined threshold value MDc in the normal distribution, obtains a corresponding value MDt corresponding to a threshold value MDc in the t-distribution having a degree of freedom according to the number of samples in which the t-distribution cumulative probability is equal to the normal distribution cumulative probability, and determines the presence or absence of an anomaly, based on the result of comparing the threshold value MDc with the MD&#x2032; value (second MD value) obtained by correcting the MD value based on the threshold value MDc and the corresponding value MDt. In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the corresponding value MDt corresponding to the threshold value MDc &#x201c;3&#x201d; is assumed to be &#x201c;5&#x201d;. In this case, for example, the value (MD&#x2032; value) obtained by multiplying the MD value by 3/5 is compared with the threshold value MDc.</p><p id="p-0055" num="0052">As shown in <figref idref="DRAWINGS">FIG. <b>7</b></figref>, in the third embodiment, the Mahalanobis distance calculating unit <b>11</b> first calculates the MD value of the measurement data (detected value) (step S<b>31</b>). Next, the anomaly determination unit <b>12</b> obtains the cumulative probability up to the threshold value (MDc) in the normal distribution (step S<b>32</b>). Next, the anomaly determination unit <b>12</b> obtains a corresponding value (MDt) in the t-distribution such that the cumulative probability is equal to the cumulative probability of the obtained normal distribution (step S<b>33</b>). In <figref idref="DRAWINGS">FIG. <b>6</b></figref>, MDc=3 and MDt=5. From this, it can be seen that MD=3 in the normal distribution is equivalent to MD=5 in terms of the probability of occurrence of an event in the t-distribution. However, the corresponding value of the t-distribution changes depending on the number of samples.</p><p id="p-0056" num="0053">Next, the anomaly determination unit <b>12</b> multiplies the MD value calculated by the Mahalanobis distance calculating unit <b>11</b> via the MT method by MDc/MDt to obtain the MD&#x2032; value (second MD value) (step S<b>34</b>). In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, MD&#x2032; value=MD value&#xd7;3/5. Next, the anomaly determination unit <b>12</b> compares the MD&#x2032; value with the MD threshold value (MDc) to perform an anomaly diagnosis (step S<b>35</b>).</p><p id="p-0057" num="0054">The anomaly determination unit <b>12</b> can obtain the MD&#x2032; value, which is the corrected MD value, by using, for example, the following expression.</p><p id="p-0058" num="0000"><maths id="MATH-US-00002" num="00002"><math overflow="scroll"> <mrow>  <msup>   <mi>MD</mi>   <mo>&#x2032;</mo>  </msup>  <mo>=</mo>  <mfrac>   <mrow>    <mi>MD</mi>    <mo>*</mo>    <mi>MDc</mi>   </mrow>   <mrow>    <mi>tinv</mi>    <mo>&#x2062;</mo>    <mrow>     <mo>(</mo>     <mrow>      <mfrac>       <mrow>        <mn>1</mn>        <mo>-</mo>        <mrow>         <mi>erf</mi>         <mo>&#x2061;</mo>         <mo>(</mo>         <mfrac>          <mi>MDc</mi>          <msqrt>           <mn>2</mn>          </msqrt>         </mfrac>         <mo>)</mo>        </mrow>       </mrow>       <mn>2</mn>      </mfrac>      <mo>,</mo>      <mi>v</mi>     </mrow>     <mo>)</mo>    </mrow>   </mrow>  </mfrac> </mrow></math></maths></p><p id="p-0059" num="0055">Here, MDc is the threshold value in the MT method, tiny is the inverse cumulative distribution function of the t-distribution, erf is the error function, &#x3bd; is the degree of freedom, in (N&#x2212;A), N is the number of samples in the unit space (the number of data), and A is the number of sensors.</p><p id="p-0060" num="0056">As shown in <figref idref="DRAWINGS">FIG. <b>8</b></figref>, the anomaly determination unit <b>12</b> of the third embodiment may compare the MD (MD value) (<b>201</b>) calculated by the MD Mahalanobis distance calculating unit <b>11</b> via the MT method with the MD threshold value selected from the normal distribution MD threshold value (<b>203</b>) or the t-distribution MD threshold value (<b>204</b>) based on the number of samples (sample number) (<b>205</b>). In this case, the t-distribution MD threshold value (<b>204</b>) is smaller than the normal distribution MD threshold value (<b>203</b>) and is selected when the number of samples is small. That is, in the third embodiment, the anomaly determination unit <b>12</b> increases a predetermined threshold value to be compared with the MD value when the number of samples is small, and determines that there is an anomaly when the MD value is larger than the threshold value.</p><p id="p-0061" num="0057">As described above, according to the third embodiment, it is possible to reduce the case where an anomaly is erroneously detected even though it is normal, as in the first embodiment. Further, by using the above expression, the calculation process can be simplified (the parameter of the function can be the threshold value MDc which is a constant instead of the MD value), and the processing load can be reduced as compared with the second embodiment.</p><heading id="h-0014" level="1">Fourth Embodiment</heading><p id="p-0062" num="0058">Next, a fourth embodiment of the present disclosure will be described with reference to <figref idref="DRAWINGS">FIG. <b>9</b></figref>. <figref idref="DRAWINGS">FIG. <b>9</b></figref> is a system flow diagram showing an operation example of the diagnosing device according to the fourth embodiment of the present disclosure. The basic configuration of the diagnosing device of the fourth embodiment is the same as that of the diagnosing device <b>10</b> of the first embodiment shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>. In the fourth embodiment, as compared with the first embodiment, a part of the operation of the anomaly determination unit <b>12</b> shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref> is detailed.</p><p id="p-0063" num="0059">As shown in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the anomaly determination unit <b>12</b> of the fourth embodiment calculates a t-distribution cumulative probability (<b>303</b>), based on the MD value (<b>301</b>) calculated by the MD Mahalanobis distance calculating unit <b>11</b> via the MT method and the number of samples (sample number) (<b>302</b>), and determines the anomaly by comparing the t-distribution cumulative probability (<b>303</b>) with the cumulative probability threshold value (<b>304</b>) that is the cumulative probability of the normal distribution corresponding to the predetermined threshold value. That is, in the diagnosing device <b>10</b> of the fourth embodiment, the Mahalanobis distance calculating unit <b>11</b> calculates the MD value of the measurement data (detected value). Then, the anomaly determination unit <b>12</b> compares the cumulative probability up to the MD value obtained according to the number of samples in the unit space with the predetermined cumulative probability threshold value, and determines the presence or absence of an anomaly based on the comparison result to determine the presence or absence of anomaly based on the MD value.</p><heading id="h-0015" level="1">Other Embodiments</heading><p id="p-0064" num="0060">Although the embodiment of the present disclosure has been described in detail with reference to the drawings, the specific configuration is not limited to this embodiment, and includes design changes and the like within a range not deviating from the gist of the present disclosure.</p><p id="p-0065" num="0061">&#x3c;Computer Configuration&#x3e;</p><p id="p-0066" num="0062"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a schematic block diagram illustrating a configuration of a computer according to at least one embodiment.</p><p id="p-0067" num="0063">A computer <b>90</b> includes a processor <b>91</b>, a main memory <b>92</b>, a storage <b>93</b>, and an interface <b>94</b>.</p><p id="p-0068" num="0064">The diagnosing device <b>10</b> described above is mounted on the computer <b>90</b>. The operation of each processing unit described above is stored in the storage <b>93</b> in the form of a program. The processor <b>91</b> reads a program from the storage <b>93</b>, expands the read program into the main memory <b>92</b>, and executes the above process according to the program. Further, the processor <b>91</b> secures a storage area corresponding to each of the above-described storage units in the main memory <b>92</b>, according to the program.</p><p id="p-0069" num="0065">The program may be for achieving some of the functions performed by the computer <b>90</b>. For example, the program may perform its function in combination with another program already stored in the storage or in combination with another program mounted on another device. In another embodiment, the computer may include a custom large scale integrated circuit (LSI) such as a programmable logic device (PLD) in addition to or in place of the above configuration. Examples of PLDs include a programmable array logic (PAL), a generic array logic (GAL), a complex programmable logic device (CPLD), and a field programmable gate array (FPGA). In this case, some or all of the functions achieved by the processor may be achieved by the integrated circuit.</p><p id="p-0070" num="0066">Examples of the storage <b>93</b> include a hard disk drive (HDD), a solid state drive (SSD), a magnetic disk, a magneto-optical disk, a compact disc read only memory (CD-ROM), a digital versatile disc read only memory (DVD-ROM), and a semiconductor memory. The storage <b>93</b> may be an internal medium directly connected to the bus of the computer <b>90</b>, or may be an external medium connected to the computer <b>90</b> through the interface <b>94</b> or a communication line. Further, when this program is delivered to the computer <b>90</b> through a communication line, the computer <b>90</b> receiving the delivered program may develop the program in the main memory <b>92</b> and execute the above process. In at least one embodiment, the storage <b>93</b> is a non-transitory tangible storage medium.</p><heading id="h-0016" level="1">ADDITIONAL NOTES</heading><p id="p-0071" num="0067">The diagnosing device <b>10</b> according to each embodiment is understood as follows, for example.</p><p id="p-0072" num="0068">(1) A diagnosing device <b>10</b> according to a first aspect includes a Mahalanobis distance calculating unit <b>11</b> that calculates an MD value of measurement data (detected value), and an anomaly determination unit <b>12</b> that determines a presence or absence of an anomaly based on the MD value, in which the anomaly determination unit <b>12</b> determines the presence or absence of an anomaly in a manner that a determination that there is no anomaly is more likely to occur when the number of samples per unit space is small than when the number of samples per unit space is large.</p><p id="p-0073" num="0069">(2) The diagnosing device <b>10</b> of the second aspect is the diagnosing device <b>10</b> of (1), in which the anomaly determination unit <b>12</b> corrects the MD value to an MD&#x2032; value (second MD value), based on a t-distribution cumulative probability having a degree of freedom according to the number of samples and a cumulative probability in a normal distribution corresponding to the t-distribution cumulative probability, and determines the presence or absence of an anomaly, based on a result of comparing the MD&#x2032; value (second MD value) with a predetermined threshold value.</p><p id="p-0074" num="0070">(3) The diagnosing device of the third aspect is the diagnosing device <b>10</b> of (1), the anomaly determination unit <b>12</b> obtains a cumulative probability up to a predetermined threshold value MDc in a normal distribution, obtains a corresponding value MDt corresponding to the threshold value in the t-distribution having a degree of freedom according to the number of samples in which a cumulative probability is equal to the obtained cumulative probability, and determines the presence or absence of an anomaly, based on the result of comparing the threshold value MDc with the MD&#x2032; value (second MD value) obtained by correcting the MD value based on the threshold value MDc and the corresponding value MDt.</p><p id="p-0075" num="0071">(4) The diagnosing device of the fourth aspect is the diagnosing device <b>10</b> of (1), the anomaly determination unit <b>12</b> increases a predetermined threshold value to be compared with the MD value when the number of samples is small, and determines that there is the anomaly when the MD value is larger than the threshold value.</p><p id="p-0076" num="0072">(5) The diagnosing device of the fourth aspect includes a Mahalanobis distance calculating unit <b>11</b> that calculates a Mahalanobis distance (MD value) of measurement data (detected value); and an anomaly determination unit <b>12</b> that determines a presence or absence of an anomaly based on the MD value, in which the anomaly determination unit <b>12</b> compares the cumulative probability (<b>303</b>) up to the MD value obtained according to the number of samples in the unit space with the predetermined cumulative probability threshold value (<b>304</b>), and determines a presence or absence of an anomaly based on the comparison result.</p><p id="p-0077" num="0073">According to each aspect described above, it is possible to reduce erroneous detection in which a normal value is determined to be an abnormal value when the number of samples (data used for calculating the unit space) is small, and improve detection accuracy.</p><heading id="h-0017" level="1">INDUSTRIAL APPLICABILITY</heading><heading id="h-0018" level="1">Reference Signs List</heading><p id="p-0078" num="0000"><ul id="ul0002" list-style="none">    <li id="ul0002-0001" num="0000">    <ul id="ul0003" list-style="none">        <li id="ul0003-0001" num="0074"><b>10</b> Diagnosing device</li>        <li id="ul0003-0002" num="0075"><b>11</b> Mahalanobis distance calculating unit</li>        <li id="ul0003-0003" num="0076"><b>12</b> Anomaly determination unit</li>    </ul>    </li></ul></p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001" nb-file="US20230004153A1-20230105-M00001.NB"><img id="EMI-M00001" he="6.35mm" wi="76.20mm" file="US20230004153A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00002" nb-file="US20230004153A1-20230105-M00002.NB"><img id="EMI-M00002" he="12.70mm" wi="76.20mm" file="US20230004153A1-20230105-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A diagnosing device comprising:<claim-text>a Mahalanobis distance calculating unit that calculates a Mahalanobis distance (MD value) of a detected value; and</claim-text><claim-text>an anomaly determination unit that determines a presence or absence of an anomaly based on the MD value, wherein</claim-text><claim-text>the anomaly determination unit determines the presence or absence of an anomaly in a manner that a determination that there is no anomaly is more likely to occur when the number of samples per unit space is small than when the number of samples per unit space is large.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The diagnosing device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the anomaly determination unit corrects the MD value to a second MD value, based on a cumulative probability in a t-distribution having a degree of freedom according to the number of samples and a cumulative probability in a normal distribution corresponding to the cumulative probability in the t-distribution, and determines the presence or absence of an anomaly, based on a result of comparing the second MD value with a predetermined threshold value.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The diagnosing device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the anomaly determination unit obtains a cumulative probability up to a predetermined threshold value in a normal distribution, obtains a corresponding value corresponding to the threshold value in a t-distribution having a degree of freedom corresponding to the number of samples in which a cumulative probability is equal to the obtained cumulative probability, and determines the presence or absence of an anomaly, based on a result of comparing the threshold value with a second MD value obtained by correcting the MD value based on the threshold value and the corresponding value.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The diagnosing device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the anomaly determination unit increases a predetermined threshold value to be compared with the MD value when the number of samples is small, and determines that there is the anomaly when the MD value is larger than the threshold value.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. A diagnosing device comprising:<claim-text>a Mahalanobis distance calculating unit that calculates a Mahalanobis distance (MD value) of a detected value; and</claim-text><claim-text>an anomaly determination unit that determines a presence or absence of an anomaly, based on the MD value, wherein</claim-text><claim-text>the anomaly determination unit compares a cumulative probability up to the MD value, obtained according to the number of samples in a unit space, with a predetermined cumulative probability threshold value, and determines a presence or absence of an anomaly, based on a comparison result.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. A diagnosing method comprising:<claim-text>a step of calculating a Mahalanobis distance (MD value) of a detected value; and</claim-text><claim-text>a step of determining a presence or absence of an anomaly based on the MD value in a manner that a determination that there is no anomaly is more likely to occur when the number of samples per unit space is small than when the number of samples per unit space is large.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. A program that causes a computer to execute:<claim-text>a step of calculating a Mahalanobis distance (MD value) of a detected value; and</claim-text><claim-text>a step of determining a presence or absence of an anomaly based on the MD value in a manner that a determination that there is no anomaly is more likely to occur when the number of samples per unit space is small than when the number of samples per unit space is large.</claim-text></claim-text></claim></claims></us-patent-application>