<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007281A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007281</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17781497</doc-number><date>20201210</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>196</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>139</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>105</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>132</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>176</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>52</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>196</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>139</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>105</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>132</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>176</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>52</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">Video Encoding or Decoding Methods and Apparatuses with Scaling Ratio Constraint</invention-title><us-related-documents><us-provisional-application><document-id><country>US</country><doc-number>62949506</doc-number><date>20191218</date></document-id></us-provisional-application><us-provisional-application><document-id><country>US</country><doc-number>62946540</doc-number><date>20191211</date></document-id></us-provisional-application></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>HFI Innovation Inc.</orgname><address><city>Zhubei City, Hsinchu County</city><country>TW</country></address></addressbook><residence><country>TW</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>CHUANG</last-name><first-name>Tzu-Der</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>HSU</last-name><first-name>Chih-Wei</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>CHEN</last-name><first-name>Ching-Yeh</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>TSAI</last-name><first-name>Chia-Ming</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>CHEN</last-name><first-name>Chun-Chia</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="05" designation="us-only"><addressbook><last-name>CHUBACH</last-name><first-name>Olena</first-name><address><city>San Jose</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="06" designation="us-only"><addressbook><last-name>CHEN</last-name><first-name>Lulin</first-name><address><city>San Jose</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="07" designation="us-only"><addressbook><last-name>HUANG</last-name><first-name>Yu-Wen</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor></inventors></us-parties><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/CN2020/135301</doc-number><date>20201210</date></document-id><us-371c12-date><date>20220601</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">Video processing methods and apparatuses for processing a current block in a current picture by reference picture resampling include receiving input data of the current block, determining a scaling window of the current picture and a scaling window of a reference picture. The current picture and reference picture may have different scaling window sizes. A ratio between a scaling window width, height, or size of the current picture and a scaling window width, height, or size of the reference picture is constrained to be within a ratio constraint. A reference block is generated from the reference picture according to the ratio, and used to encode or decode the current block.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="62.31mm" wi="101.77mm" file="US20230007281A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="94.91mm" wi="103.80mm" file="US20230007281A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="100.33mm" wi="103.80mm" file="US20230007281A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="178.14mm" wi="113.88mm" file="US20230007281A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="133.10mm" wi="97.79mm" file="US20230007281A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="128.10mm" wi="127.59mm" file="US20230007281A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="123.61mm" wi="126.24mm" file="US20230007281A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATION</heading><p id="p-0002" num="0001">The present invention claims priority to U.S. Provisional Patent Application, Ser. No. 62/946,540, filed on Dec. 11, 2019, entitled &#x201c;Method of Scaling Ratio Constraint&#x201d;, and U.S. Provisional Patent Application, Ser. No. 62/949,506, filed on Dec. 18, 2019, entitled &#x201c;Method of Scaling Window Constraint&#x201d;. The U.S. Provisional Patent Applications are hereby incorporated by reference in their entireties.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">FIELD OF THE INVENTION</heading><p id="p-0003" num="0002">The present invention relates to video processing methods and apparatuses in video encoding and decoding systems. In particular, the present invention relates to scaling ratio constraint for reference picture resampling.</p><heading id="h-0003" level="1">BACKGROUND AND RELATED ART</heading><p id="p-0004" num="0003">The Versatile Video Coding (VVC) standard is the upcoming emerging video coding standard which has been developed incrementally based on the former High Efficiency Video Coding (HEVC) standard by enhancing existing coding tools and introducing multiple new coding tools in various building blocks of the codec structure. The VVC standard improves compression performance and efficiency of transmission and storage, and supports new formats such as the High Dynamic Range and omni-directional <b>360</b> video. The VVC standard makes video transmission in mobile networks more efficiently as it allows systems or locations with poor data rates to receive larger files more quickly. VVC supports layer coding, spatial or Signal to Noise Ratio (SNR) temporal scalability.</p><p id="p-0005" num="0004">Reference Picture Resampling (RPR) In the VVC standard, fast representation switching for adaptive streaming services is desired to deliver multiple representations of the same video content at the same time, each having different properties. Different properties involve with different spatial resolutions or different sample bit depths. In real-time video communications, by allowing resolution changes within a coded video sequence without inserting an I-picture, not only the video data can be adapted to dynamic channel conditions and user preference seamlessly, but the beating effect caused by the I-pictures can also be removed. Reference Picture Resampling (RPR) allows pictures with different resolutions can reference each other in inter prediction. <figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates an example of applying reference picture resampling to encode or decode a current picture, where inter coded blocks of the current picture are predicted from reference pictures with same or different sizes. Spatial scalability is beneficial in streaming applications. The picture size of the reference picture can be different from the current picture when spatial scalability is supported. RPR is adopted in the VVC standard to support the on-the-fly upsampling and downsampling motion compensation.</p><p id="p-0006" num="0005">Table 1 shows an example of signaling an RPR enabling flag and a maximum picture size in a Sequence Parameter Set (SPS). A RPR enabling flag sps_ref_pic_resampling_enabled_flag signaled in a Sequence Parameter Set (SPS) is used to indicate whether RPR is enabled for pictures referring to the SPS. When this RPR enabling flag is equal to 1, a current picture referring to the SPS may have slices that refer to a reference picture in an active entry of a reference picture layer that has one or more of the following seven parameters different than that of the current picture. The seven parameters include syntax elements associated with a picture width pps_pic_width_in_luma_samples, a picture height pps_pic_height_in_luma_samples, a left scaling window offset pps_scaling_win_left_offset, a right scaling window offset pps_scaling_win_right_offset, a top scaling window offset pps_scaling_win_top_offset, a bottom scaling window offset pps_scaling_win_bottom_offset, and a number of sub-pictures sps_num_subpics_minus1. For a current picture referring to a reference picture that has one or more of these seven parameters different than that of the current picture, the reference picture could either belong to the same layer or a different layer than the layer containing the current picture. The syntax element sps_res_change_in_clvs_allowed_flag equals to 1 specifying that the picture spatial resolution might change within a Coded Layer Video Sequence (CLVS) referring to the SPS, and this syntax element equals to 0 specifying that the picture spatial resolution does not change within any CLVS referring to the SPS. When this syntax element sps_res_change_in_clvs_allowed_flag is not present in the SPS, the value is inferred to be equal to 0. The maximum picture size is signaled in the SPS by syntax elements sps_pic_width_max_in_luma_samples and sps_pic_height_max_in_luma_samples, and the maximum picture size shall not be larger than the Output Layer Set (OLS) Decoded Picture Buffer (DPB) picture size signaled in the corresponding Video Parameter Set (VPS).</p><p id="p-0007" num="0000"><tables id="TABLE-US-00001" num="00001"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="offset" colwidth="168pt" align="left"/><colspec colname="1" colwidth="49pt" align="left"/><thead><row><entry/><entry namest="offset" nameend="1" rowsep="1">TABLE 1</entry></row><row><entry/><entry namest="offset" nameend="1" align="center" rowsep="1"/></row><row><entry/><entry>Descriptor</entry></row><row><entry/><entry namest="offset" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="offset" colwidth="14pt" align="left"/><colspec colname="1" colwidth="154pt" align="left"/><colspec colname="2" colwidth="49pt" align="left"/><tbody valign="top"><row><entry/><entry>seq_parameter_set_rbsp( ) {</entry><entry/></row><row><entry/><entry>&#x2003;&#x2002;...</entry></row><row><entry/><entry>&#x2003;&#x2002;sps_ref_pic_resampling_enabled_flag</entry><entry>u(1)</entry></row><row><entry/><entry>&#x2003;if (sps_ref_pic_resampling_enabled_flag)</entry></row><row><entry/><entry>&#x2003;&#x2003;sps_res_change_in_clvs_allowed_flag</entry><entry>u(1)</entry></row><row><entry/><entry>&#x2003;&#x2002;sps_pic_width_max_in_luma_samples</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;Sps_pic_height_max_in_luma_samples</entry><entry>ue(v)</entry></row><row><entry/><entry namest="offset" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0008" num="0006">When predicting a current picture using RPR, a picture size ratio is derived from the reference picture width or height and the current picture width or height. The picture size ratio is constrained to be within a range between &#x215b; and 2. For example, the picture width and height measured in luma samples are derived by syntax elements pic_width_in_luma_samples and pic_height_in_luma_samples signaled in a Picture Parameter Set (PPS). The syntax element pic_width_in_luma_samples specifies the width of each decoded picture referring to the PPS in units of luma samples. This syntax element shall not be equal to 0 and shall be an integer multiple of Max(8, MinCbSizeY), and is constrained to be less than or equal to pic_width_max_in_luma_samples. The value of this syntax element pic_width_in_luma_samples shall be equal to pic_width_max_in_luma_samples when a sub-picture present flag subpics_present_flag is equal to 1 or when the RPR enabling flag ref_pic_resampling_enabled_flag is equal to 0. The syntax element pic_height_in_luma_samples specifies the height of each decoded picture referring to the PPS in units of luma samples. This syntax element shall not be equal to 0 and shall be an integer multiple of Max(8, MinCbSizeY), and shall be less than or equal to pic_height_max_in_luma_samples. The value of the syntax element pic_height_in_luma_samples is set to be equal to pic_height_max_in_luma_samples when the sub-picture present flag subpics_present_flag is equal to 1 or when the RPR enabling flag ref_pic_resampling_enabled_flag is equal to 0.</p><p id="p-0009" num="0007">In the current design of RPR in VVC draft <b>6</b>, when the picture size of a current picture and reference pictures are specified, the following constraint has to be satisfied. This constraint limits the picture size ratio between the reference picture and the current picture to be within the range of [&#x215b;, <b>2</b>]. Let variables refPicWidthInLumaSamples and refPicHeightInLumaSamples be the picture width and picture height of a reference picture referenced by a current picture. It is a requirement of bitstream conformance that all of the following conditions are satisfied: the picture width of the current picture pic_width_in_luma_samples multiplied by 2 shall be greater than or equal to the picture width of the reference picture refPicWidthInLumaSamples, the picture height of the current picture pic_height_in_luma_samples multiplied by 2 shall be greater than or equal to the picture height of the reference picture refPicHeightInLumaSamples, the picture width of the current picture pic_width_in_luma_samples shall be less than or equal to the picture width of the reference picture refPicWidthInLumaSample multiplied by 8, and the picture height of the current picture pic_height_in_luma_samples shall be less than or equal to the picture height of the reference picture refPicHeightInLumaSamples multiplied by 8.</p><p id="p-0010" num="0008">The picture size scaling ratio between a reference picture and a current picture is derived from syntax elements pic_width_in_luma_samples and pic_height_in_luma_samples signaled in a PPS associated with the reference picture and syntax elements pic_width_in_luma_samples and pic_height_in_luma_samples signaled in a PPS associated with the current picture. The scaling window offsets for RPR are also derived from syntax elements signaled in the PPS. These syntax elements signaled in the PPS and corresponding semantic are shown in Table 2.</p><p id="p-0011" num="0000"><tables id="TABLE-US-00002" num="00002"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="offset" colwidth="161pt" align="left"/><colspec colname="1" colwidth="56pt" align="left"/><thead><row><entry/><entry namest="offset" nameend="1" rowsep="1">TABLE 2</entry></row><row><entry/><entry namest="offset" nameend="1" align="center" rowsep="1"/></row><row><entry/><entry>Descriptor</entry></row><row><entry/><entry namest="offset" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="offset" colwidth="21pt" align="left"/><colspec colname="1" colwidth="140pt" align="left"/><colspec colname="2" colwidth="56pt" align="left"/><tbody valign="top"><row><entry/><entry>pic_parameter_set_rbsp( ) {</entry><entry/></row><row><entry/><entry>&#x2003;pps_pic_parameter_set_id</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;pps_seq_parameter_set_id</entry><entry>u(4)</entry></row><row><entry/><entry>&#x2003;pic_width_in_luma_samples</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;pic_height_in_luma_samples</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;conformance_window_flag</entry><entry>u(1)</entry></row><row><entry/><entry>&#x2003;if( conformance_window_flag ) {</entry></row><row><entry/><entry>&#x2003;&#x2003;conf_win_left_offset</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;&#x2003;conf_win_right_offset</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;&#x2003;conf_win_top_offset</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;&#x2003;conf_win_bottom_offset</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;}</entry></row><row><entry/><entry>&#x2003;scaling_window_flag</entry><entry>u(1)</entry></row><row><entry/><entry>&#x2003;if( scaling_window_flag ) {</entry></row><row><entry/><entry>&#x2003;&#x2003;scaling_win_left_offset</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;&#x2003;scaling_win_right_offset</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;&#x2003;scaling_win_top_offset</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;&#x2003;scaling_win_bottom_offset</entry><entry>ue(v)</entry></row><row><entry/><entry>&#x2003;}</entry></row><row><entry/><entry>...</entry></row><row><entry/><entry namest="offset" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0012" num="0009">The syntax element scaling_window_flag equals to 1 specifying scaling window offset parameters are present in the PPS, and scaling_window_flag equals to 0 specifying scaling window offset parameters are not present in the PPS. The value of this syntax element scaling_window_flag shall be equal to 0 when a RPR enabling flag ref_pic_resampling_enabled_flag is equal to 0. The syntax elements scaling_win_left_offset, scaling_win_right_offset, scaling_win_top_offset, and scaling_win_bottom_offset specify the scaling offsets in units of luma samples. These scaling offsets are applied to the picture size for scaling ratio calculation. The scaling offsets can be negative values. The values of these four scaling offset syntax elements, scaling_win_left_offset, scaling_win_right_offset, scaling_win_top_offset, and scaling_win_bottom_offset are inferred to be equal to 0 when a scaling window flag scaling_window_flag is equal to 0.</p><p id="p-0013" num="0010">The value of a sum of the left and right offsets scaling_win_left_offset and scaling_win_right_offset shall be less than the picture width pic_width_in_luma_samples, and the value of a sum of the top and bottom offsets scaling_win_top_offset and scaling_win_bottom_offset shall be less than the picture height pic_height_in_luma_samples. The variable PicOutputWidthL representing a scaling window width is derived by subtracting the right and left offsets from the picture width. PicOutputWidthL=pic_width_in_luma_samples&#x2212;(scaling_win_right_offset+scaling_win_left_offset). The variable PicOutputHeightL representing a scaling window height is derived by subtracting the top and bottom offsets from the picture height. PicOutputHeightL=pic_height_in_luma_samples&#x2212;(scaling_win_bottom_offset+scaling_win_top_offset).</p><p id="p-0014" num="0011">A variable fRefWidth is set equal to PicOutputWidthL of a reference picture RefPicList[i][j] in luma samples, and a variable fRefHight is set equal to PicOutputHeightL of the reference picture RefPicList[i][j] in luma samples. A derived reference picture scaling ratio for the horizontal direction RefPicScale[i][j][0] is calculated by ((fRefWidth&#x3c;&#x3c;14)+(PicOutputWidthL&#x3e;&#x3e;1))/PicOutputWidthL, and a derived reference picture scaling ratio for the vertical direction RefPicScale[i][j][1] is calculated by ((fRefHeight&#x3c;&#x3c;14)+(PicOutputHeightL&#x3e;&#x3e;1))/PicOutputHeightL. The derived reference picture scaling ratio is thus RefPicIsScaled[i][j]=(RefPicScale [i][j][0]!=(1&#x3c;&#x3c;14))&#x2225;(RefPicScale[i][j][1]!=(1&#x3c;&#x3c;14).</p><p id="p-0015" num="0012">In a more recent proposal of the VVC standard, the scaling window offsets are measured in chroma samples, and when these scaling window offset syntax elements are not present in the PPS, the values of these four scaling offset syntax elements scaling_win_left_offset, scaling_win_right_offset, scaling_win_top_offset, and scaling_win_bottom_offset are inferred to be equal to conf_win_left_offset, conf_win_right_offset, conf_win_top_offset, and conf_win_bottom_offset, respectively. A variable CurrPicScalWinWidthL indicating the scaling window width is derived by the picture width, SubWidthC, left scaling offset, and right scaling offset, and a variable CurrPicScalWinHeightL indicating the scaling window height is derived by the picture height, SubHeightC, top scaling offset, and bottom scaling offset as shown in the following. CurrPicScalWinWidthL=pic_width_in_luma_samples&#x2212;SubWidthC*(scaling_win_right_offset+scaling_win_left_offset); and CurrPicScalWinHeightL=pic_height_in_luma_samples&#x2212;SubHeightC*(scaling_win_bottom_offset+scaling_win_top_offset).</p><heading id="h-0004" level="1">BRIEF SUMMARY OF THE INVENTION</heading><p id="p-0016" num="0013">In exemplary embodiments of the video processing method for processing a current block in a current picture, a video encoding or decoding system implementing the video processing method receives input video data associated with the current block, determines a scaling window width, height, or size of the current picture, determines a scaling window width, height, or size of a reference picture, generates a reference block by a ratio between the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture, performs motion compensation for the current block using the reference block, and encodes or decodes the current block in the current picture. The ratio between the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture is constrained within a ratio constraint.</p><p id="p-0017" num="0014">In some exemplary embodiments, the ratio constraint is between 1/M and N, where M and N are positive integers. For the ratio between the scaling window width of the current picture and the scaling window width of the reference block to be within the ratio constraint, N times the scaling window width of the current picture is greater than or equal to the scaling window width of the reference picture, and the scaling window width of the current picture is less than or equal to M times the scaling window width of the reference picture. For the ratio between the scaling window height of the current picture and the scaling window height of the reference picture to be within the ratio constraint, N times the scaling window height of the current picture is greater than or equal to the scaling window height of the reference picture, and the scaling window height of the current picture is less than or equal to M times the scaling window height of the reference picture. In one embodiment, the scaling window size includes both the scaling window width and the scaling window height. For the ratio between the scaling window size of the current picture and the scaling window size of the reference picture to be within the ratio constraint, N times the scaling window width of the current picture is greater than or equal to the scaling window width of the reference picture, N times the scaling window height of the current picture is greater than or equal to the scaling window height of the reference picture, the scaling window width of the current picture is less than or equal to M times the scaling window width of the reference picture, and the scaling window height of the current picture is less than or equal to M times the scaling window height of the reference picture For example, the ratio constraint is between &#x215b; and 2. In cases when the scaling window size of the current picture is smaller than the scaling window size of the reference picture, 2 times the scaling window width of the current picture is greater than or equal to the scaling window with of the reference picture, and 2 times the scaling window height of the current picture is greater than or equal to the scaling window height of the reference picture. In cases when the scaling window size of the current picture is larger than the scaling window size of the reference picture, the scaling window width of the current picture is less than or equal to 8 times the scaling window width of the reference picture, and the scaling window height of the current picture is less than or equal to 8 times the scaling window height of the reference picture.</p><p id="p-0018" num="0015">In some embodiments, the scaling window width of the current picture is derived by a picture width, a left scaling window offset, and a right scaling window offset of the current picture, and the scaling window height of the current picture is derived by a picture height, a top scaling window offset, and a bottom scaling window offset of the current picture. The picture width, left scaling window offset, right scaling window offset, picture height, top scaling window offset, and bottom scaling window offset of the current picture are signaled in a PPS associated with the current picture.</p><p id="p-0019" num="0016">In an embodiment, the scaling window offsets are measured in luma samples, the scaling window width of the current picture is derived by subtracting the left scaling window offset and the right scaling window offset from the picture width of the current picture, and the scaling window height of the current picture is derived by subtracting the top scaling window offset and the bottom scaling window offset form the picture height of the current picture. In another embodiment, the scaling window offsets are measured in chroma samples, the scaling window width of the current picture is derived by the picture width, left and right scaling window offsets, and a variable SubWidthC, and the scaling window height of the current picture is derived by the picture height, top and bottom scaling window offsets, and a variable SubHeightC. These variables SubWidthC and SubHeightC indicate down-sampling ratios associated with chroma bitplanes in horizontal and vertical dimensions. The scaling window width of the current picture is derived by multiplying the variable SubWidthC with a sum of the left scaling window offset and the right scaling window offset and then subtracting from the picture width of the current picture. The scaling window height of the current picture is derived by multiplying the variable SubHeightC with a sum of the top scaling window offset and the bottom scaling window offset and then subtracting from the picture height of the current picture.</p><p id="p-0020" num="0017">In an embodiment, a reference picture scaling ratio is derived for motion compensation from the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture, and the reference picture scaling ratio is constrained to be within a range of [2048, 32768].</p><p id="p-0021" num="0018">In an embodiment, for an encoder side to generate a bitstream corresponding to encoded data of a video sequence, or for a decoder side to receive a bitstream corresponding to encoded data of a video sequence, it is a bitstream conformance requirement that 2 times the scaling window width of the current picture is greater than or equal to the scaling window width of the reference picture, 2 times the scaling window height of the current picture is greater than or equal to the scaling window height of the reference picture, the scaling window width of the current picture is less than or equal to 8 times the scaling window width of the reference picture, and the scaling window height of the current picture is less than or equal to 8 times the scaling window height of the reference picture.</p><p id="p-0022" num="0019">Aspects of the disclosure further provide an apparatus for video processing in a video encoding or decoding system, the apparatus comprising one or more electronic circuits configured for receiving input video data of a current block in a current picture, determining a scaling window width, height, or size of the current picture, determining a scaling window width, height, or size of a reference picture, generating a reference block from the reference picture, performing motion compensation for the current block using the reference block, and encoding or decoding the current block in the current picture. A ratio between the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture is within a ratio constraint.</p><p id="p-0023" num="0020">Aspects of the disclosure further provide a non-transitory computer readable medium storing program instructions for causing a processing circuit of an apparatus to perform a video processing method to encode or decode a current block in a current picture. The video processing method determines a scaling window width, height, or size of the current picture, determines a scaling window width, height, or size of a reference picture, generates a reference block from the reference picture, encodes or decodes the current block according to the reference block. A ratio between the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture is constrained to be within a ratio constraint. Other aspects and features of the invention will become apparent to those with ordinary skill in the art upon review of the following descriptions of specific embodiments.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0024" num="0021">Various embodiments of this disclosure that are proposed as examples will be described in detail with reference to the following figures, and wherein:</p><p id="p-0025" num="0022"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates a hypothetical example of enabling reference picture resampling.</p><p id="p-0026" num="0023"><figref idref="DRAWINGS">FIG. <b>2</b></figref> demonstrates an example of enabling reference picture resampling considering the scaling window size of each picture.</p><p id="p-0027" num="0024"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates an exemplary flowchart of a video encoding or decoding system for checking a scaling window ratio between a current picture and a reference picture according to an embodiment of the present invention.</p><p id="p-0028" num="0025"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flowchart showing an embodiment of a video processing method for encoding or decoding a current block by enabling reference picture resampling in a video encoding or decoding system.</p><p id="p-0029" num="0026"><figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates an exemplary system block diagram for a video encoding system incorporating the video processing method according to embodiments of the present invention.</p><p id="p-0030" num="0027"><figref idref="DRAWINGS">FIG. <b>6</b></figref> illustrates an exemplary system block diagram for a video decoding system incorporating the video processing method according to embodiments of the present invention.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading><p id="p-0031" num="0028">It will be readily understood that the components of the present invention, as generally described and illustrated in the figures herein, may be arranged and designed in a wide variety of different configurations. Thus, the following more detailed description of the embodiments of the systems and methods of the present invention, as represented in the figures, is not intended to limit the scope of the invention, as claimed, but is merely representative of selected embodiments of the invention.</p><p id="p-0032" num="0029">Constrain Reference Picture Scaling Ratio In VVC draft <b>6</b>, one bitstream conformance requirement is applied to constrain a picture size ratio of a reference picture to a current picture to be within [&#x215b;, 2]. The picture size ratio is derived from a reference picture width/height/size and a current picture width/height/size. The picture size ratio constraint is specified to be within [&#x215b;, 2] as the interpolation filters only supports scaling ratios between &#x215b; and 2. Some embodiments of the present invention apply the [&#x215b;, 2] ratio constraint to a scaling ratio between a current scaling window width, height, or size and a reference scaling window width, height, or size. The scaling ratio is calculated by scaling window widths, heights, or sizes instead of picture widths, heights, or sizes. <figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates an example of performing motion compensation by referencing two reference pictures with different picture sizes and difference scaling window sizes. A current picture <b>20</b> as shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref> has a scaling window <b>202</b>, and although a first reference picture <b>22</b> is smaller than the current picture <b>20</b>, a scaling window <b>222</b> of the first reference picture <b>22</b> is larger than the scaling window <b>202</b> of the current picture, which implies a scaling ratio of less than 1 is applied to downscale the scaling window <b>222</b> to be referenced by the current picture. A second reference picture <b>24</b> is larger than the current picture <b>20</b>, however, a scaling window <b>242</b> of the second reference picture <b>24</b> is smaller than the scaling window <b>202</b> of the current picture, so a scaling ratio of larger than 1 is applied to upscale the scaling window <b>242</b> to be referenced by the current picture.</p><p id="p-0033" num="0030">In one embodiment, a scaling window width of a current picture PicOutputWidthL is derived by a picture width pic_width_in_luma_samples, a left scaling window offset scaling_win_left_offset, and a right scaling window offset scaling_win_right_offset signaled in the PPS associated with the current picture, i.e. PicOutputWidthL=pic_width_in_luma_samples&#x2212;(scaling_win_right_offset+scaling_win_left_offset), and a scaling window height of the current picture PicOutputHeightL is derived by a picture height pic_height_in_luma_samples, a top scaling window offset scaling_win_top_offset, and a bottom scaling window offset scaling_win_bottom_offset, i.e. PicOutputHeightL=pic_height_in_luma_samples&#x2212;(scaling_win_bottom_offset+scaling_win_top_offset). When scaling_window_flag is equal to 1, let refPicOutputWidthL and refPicOutputHiehgtL be a scaling window width of a reference picture and a scaling window height of the reference picture respectively. A reference block in the reference picture is determined to be referenced by a current block of the current picture. For example, a video encoding system determines the reference block by motion estimation, and a video decoding system determines the reference block by parsing motion information of the current block signaled in the video bitstream. It is a requirement of the bitstream conformance that all of the following four conditions are satisfied when the ratio between the scaling window size of the current picture and the scaling window size of the reference picture is within the ratio constraint [&#x215b;, 2]. Two times the scaling window width of the current picture is greater than or equal to the scaling window width of the reference picture, two times the scaling window height of the current picture is greater than or equal to the scaling window height of the reference picture, the scaling window width of the current picture is less than or equal to eight times the scaling window width of the reference picture, and the scaling window height of the current picture is less than or equal to eight times the scaling window height of the reference picture. That is, PicOutputWidthL*2&#x2265;refPicOutputWidthL, PicOutputHeightL*2&#x2265;refPicOutputHeightL, PicOutputWidthL&#x2264;refPicOutputWidthL*8, and PicOutputHeightL&#x2264;refPicOutputHeightL*8.</p><p id="p-0034" num="0031">To generalize the above embodiment of constraining the scaling window width and scaling window height of the current picture based on the scaling window width and scaling window height of the reference picture, it is a requirement of the bitstream conformance that all of the following conditions are satisfied. N times the scaling window width of the current picture is greater than or equal to the scaling window width of the reference picture, N times the scaling window height of the current picture is greater than or equal to the scaling window height of the reference picture, the scaling window width of the current picture is less than or equal to M times the scaling window width of the reference picture, and the scaling window height of the current picture is less than or equal to M times the scaling window height of the reference picture. The ratio between the scaling window size of the current picture and the scaling window size of the reference picture is between a ratio constraint [1/M, N], where N and M are positive integers, for example, N is 2 and M is 8 in the previous embodiment. PicOutputWidthL*N&#x2265;refPicOutputWidthL, PicOutputHeight*N&#x2265;refPicOutputHeight, PicOutputWidthL&#x2264;refPicOutputWidthL*M, and PicOutputHeightL&#x2264;refPicOutputHeightL*M.</p><p id="p-0035" num="0032">In one embodiment, a ratio constraint [1/M, N] is determined, to encode or decode a current picture, an encoder or decoder checks if one or more reference pictures satisfied the ratio constraint by determining a scaling window width, height, or size of the current picture and a scaling window width, height, or size of the reference picture. Only the reference picture with a scaling window width, height, or size satisfying the ratio constraint can be referenced by the current picture. <figref idref="DRAWINGS">FIG. <b>3</b></figref> is a flowchart illustrating an example of this embodiment.</p><p id="p-0036" num="0033">In some other embodiments, a ratio constraint [1/M, N] is determined, and an encoder or decoder determines a scaling window width, height, or size of a current picture according to a scaling window width, height, or size of a reference picture in order to satisfy the ratio constraint. In one embodiment, the same ratio constraint may constrain both the scaling window ratio and the picture size ratio, and the encoder or decoder also determines a picture size of the current picture according to a picture size of the reference picture to follow the ratio constraint.</p><p id="p-0037" num="0034">In another embodiment, scaling window offsets signaled in the PPS are measured in chroma samples, a scaling window width of a current picture PicOutputWidthL is derived by a picture width pic_width_in_luma_samples, a left scaling window offset scaling_win_left_offset, and a right scaling window offset scaling_win_right_offset signaled in the PPS, as well as a variable SubWidthC. The value of the variable SubWidthC is defined according to the color sampling format of the video data; for example, SubWidthC is equal to 2 when the color sampling format is 4:2:0. PicOutputWidthL=pic_width_in_luma_samples&#x2212;SubWidthC*(scaling_win_right_offset+scaling_win_left_offset). Similarly, a scaling window height of the current picture PicOutputHeightL is derived by a picture height pic_height_in_luma_samples, a top scaling window offset scaling_win_top_offset, and a bottom scaling window offset scaling_win_bottom_offset, as well as a variable SubHeightC. The value of the variable SubHeightC is also defined according to the color sampling format of the video data. SubHeightC is equal to 2 when the color sampling format is 4:2:0. PicOutputHeightL=pic_height_in_luma_samples&#x2212;SubHeightC*(scaling_win_bottom_offset+scaling_win_top_offset). The variables SubWidthC and SubHeightC indicate down-sampling ratios associated with the chroma bitplanes in horizontal and vertical dimensions respectively.</p><p id="p-0038" num="0035">Let refPicOutputWidthL and refPicOutputHeightL be a scaling window width and a scaling window height of a reference picture referenced by a current block of the current picture, where refPicOutputWidthL and refPicOutputHeightL are derived by the picture width and height, scaling window offsets, and the variable SubWidthC and SubHeightC. It is a requirement of the bitstream conformance that all of the following four conditions are satisfied. Two times the scaling window width of the current picture is greater than or equal to the scaling window width of the reference picture, two times the scaling window height of the current picture is greater than or equal to the scaling window height of the reference picture, the scaling window width of the current picture is less than or equal to eight times the scaling window width of the reference picture, and the scaling window height of the current picture is less than or equal to eight times the scaling window height of the reference picture. PicOutputWidthL*2&#x2265;refPicOutputWidthL, PicOutputHeightL*2&#x2265;refPicOutputHeightL, PicOutputWidthL&#x2264;refPicOutputWidthL*8, PicOutputHeightL&#x2264;refPicOutputHeightL*8.</p><p id="p-0039" num="0036">A reference picture scaling ratio, RefPicScale[i][j][0], RefPicScale[i][j][1], is derived for motion compensation from the scaling window size, width, or height specified in the PPS. The reference picture scaling ratio affects which filters are used in the motion compensation stage, and it also affects the memory bandwidth used for the motion compensation stage. In addition to constrain the picture size ratio, embodiments of the present invention constrain the reference picture scaling ratio as well. For example, the reference picture scaling ratio RefPicScale[i][j][0] and RefPicScale[i][j][1] shall be constrained to be within the range of [2048, 32768], which is equivalent to a scaling ratio of [&#x215b;, 2]. It is a requirement of the bitstream conformance that all of the following conditions are satisfied: RefPicScale[i][j][0] shall be greater than or equal to 2048, and shall be smaller than or equal to 32768, and RefPicScale[i][j][1] shall be greater than or equal to 2048, and shall be smaller than or equal to 32768.</p><p id="p-0040" num="0037">For example, three different interpolation filter sets can be selected in motion compensation depending on the scaling ratio. A first interpolation filter set (set 0) includes a 8-tap DCT-IF filter, an affine 6-tap DCT-IF filter, and a 6-tap Half pixel IF filter, and a second interpolation filter set (set 1) includes 8-tap RPR filters and corresponding 6-tap affine filters for 1.5&#xd7; ratio, and a third interpolation filter set (set 2) includes 8-tap RPR filters and corresponding 6-tap affine filters for 2.0&#xd7; ratio. For processing a current block associated with a scaling ratio between &#x215b; and 1.25, filters in set 0 are selected, for processing a current block associated with a scaling ratio between 1.25 and 1.75, filters in set 1 are selected, and for processing a current block associated with a scaling ratio between 1.75 and 2, filters in set 2 are selected.</p><p id="p-0041" num="0038">Exemplary Flowchart for <figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates an exemplary flowchart of a video encoding or decoding system for checking a scaling ratio between a current picture and a reference picture according to an embodiment of the present invention. The video encoding or decoding system receives input data associated with a current picture in step S<b>302</b>, and determines a scaling window width, height, or size of the current picture in step S<b>304</b>. For example, the scaling window size includes both the scaling window width and scaling window height. In this embodiment, the scaling window width of the current picture is derived by a picture width, a left scaling window offset, and a right scaling window offset of the current picture, and the scaling window height of the current picture is derived by a picture height, a top scaling window offset, and a bottom scaling window offset of the current picture. Syntax elements associated with these scaling window offsets and the picture width and height are signaled in a PPS corresponding to the current picture. In step S<b>306</b>, a scaling window width, height, or size of a reference picture is determined. Similarly, the scaling window width of the reference picture is derived by a picture width, a left scaling window offset, and a right scaling window offset of the reference picture, and the scaling window height of the reference picture is derived by a picture height, a top scaling window offset, and a bottom scaling window offset of the reference picture. Syntax elements associated with these scaling window offsets and the picture width and height of the reference picture are signaled in a PPS corresponding to the reference picture. The video encoding or decoding system checks if a ratio between the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture is within a ratio constraint [1/M, N] in step S<b>308</b>. For example, the ratio constraint is [&#x215b;, 2], which means 2 times the scaling window width/height of the current picture is greater than or equal to the scaling window width/height of the reference picture, and the scaling window width/height of the current picture is less than or equal to 8 times the scaling window width/height of the reference picture. The reference picture is included in a reference picture list for one or more blocks in the current picture in step S<b>310</b> when the ratio is within the ratio constraint, so that the reference picture can be referenced by the blocks in the current picture. In step S<b>312</b>, in cases when the ratio is not within the ratio constraint, the reference picture is excluded in a reference picture list as the reference picture cannot be referenced by any block in the current picture. The video encoding or decoding system further encodes or decodes the current picture in step S<b>314</b>.</p><p id="p-0042" num="0039"><figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates an exemplary flowchart of a video encoding or decoding system for encoding or decoding a current block by enabling reference picture resampling according to an embodiment of the present invention. The video encoding or decoding system receives input video data of a current block in a current picture in step S<b>402</b>. In step S<b>404</b>, a reference region in a reference picture is determined for prediction or motion compensation of the current block. A ratio between a scaling window width, height, or size of the current picture and a scaling window width, height, or size of the reference picture is within a ratio constraint [1/M, N]. The video encoding or decoding system generates a reference block from the reference region in the reference picture according to the ratio in step S<b>406</b>, and encodes or decodes the current block using the reference block in step S<b>408</b>.</p><p id="p-0043" num="0040">Video Encoder and Decoder Implementations The foregoing proposed video processing methods for reference picture resampling can be implemented in video encoders or decoders. For example, a proposed video processing method is implemented in an inter prediction module of an encoder, and/or an inter prediction module of a decoder. Alternatively, any of the proposed methods is implemented as a circuit coupled to one or a combination of the inter prediction module and/or one or a combination of the inter prediction module of the decoder, so as to provide the information needed by the inter prediction module. <figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates an exemplary system block diagram for a Video Encoder <b>500</b> implementing various embodiments of the present invention. An Intra Prediction module <b>510</b> provides intra predictors based on reconstructed video data of a current picture. An Inter Prediction module <b>512</b> performs motion estimation (ME) and MC to provide inter predictors based on video data from other picture or pictures. To encode a current block in a current picture according to some embodiments of the present invention, a reference region in a valid reference picture is determined, and a scaling ratio between the current picture and any valid reference picture is within a ratio constraint [1/M, N]. The reference block is generated from the reference region and is used for motion compensation of the current block. The ratio constraint is defined according to interpolation filters for motion compensation, for example, the ratio constraint is between &#x215b; and 2. In another embodiment, the Intra Prediction module <b>510</b> determines a scaling window width, height, or size of the current picture according to the ratio constraint and the scaling window width, height, or size of one or more reference picture for the current picture. A switch <b>541</b> selects either the Intra Prediction module <b>510</b> or Inter Prediction <b>512</b> to supply the selected predictor to an Adder <b>516</b> to form prediction errors, also called prediction residual. The prediction residual of the current block are further processed by a Transformation module (T) <b>518</b> followed by a Quantization module (Q) <b>520</b>. The transformed and quantized residual signal is then encoded by an Entropy Encoder <b>532</b> to form a video bitstream. The video bitstream is then packed with side information. The transformed and quantized residual signal of the current block is then processed by an Inverse Quantization module (IQ) <b>522</b> and an Inverse Transformation module (IT) <b>524</b> to recover the prediction residual. As shown in <figref idref="DRAWINGS">FIG. <b>5</b></figref>, the prediction residual is recovered by adding back to the selected predictor at a Reconstruction module (REC) <b>526</b> to produce reconstructed video data. The reconstructed video data may be stored in a Reference Picture Buffer (Ref. Pict. Buffer) <b>530</b> and used for prediction of other pictures. The reconstructed video data recovered from the REC module <b>526</b> may be subject to various impairments due to encoding processing; consequently, an In-loop Processing Filter <b>528</b> is applied to the reconstructed video data before storing in the Reference Picture Buffer <b>530</b> to further enhance picture quality.</p><p id="p-0044" num="0041">A corresponding Video Decoder <b>600</b> for decoding the video bitstream generated from the Video Encoder <b>500</b> of <figref idref="DRAWINGS">FIG. <b>5</b></figref> is shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>. The video bitstream is the input to the Video Decoder <b>600</b> and is decoded by an Entropy Decoder <b>610</b> to parse and recover the transformed and quantized residual signal and other system information. The decoding process of the Decoder <b>600</b> is similar to the reconstruction loop at the Encoder <b>500</b>, except the Decoder <b>600</b> only requires motion compensation prediction in an Inter Prediction <b>614</b>. Each block is decoded by either an Intra Prediction module <b>612</b> or Inter Prediction module <b>614</b>. To decode a current block in a current picture according to some embodiments of the present invention, the Inter Prediction module <b>614</b> determines a reference region in a reference picture. A ratio between a scaling window width, height, or size of the current picture and a scaling window width, height, or size of the reference picture is within a ratio constraint [1/M, N]. A reference block is then generated from the reference region based on the ratio, and the reference block is used for motion compensation of the current block in the Inter Prediction module <b>614</b>. A Switch <b>616</b> selects an intra predictor from the Intra Prediction module <b>612</b> or an inter predictor from the Inter Prediction module <b>614</b> according to decoded mode information. The transformed and quantized residual signal associated with each block is recovered by an Inverse Quantization module (IQ) <b>620</b> and an Inverse Transformation module (IT) <b>622</b>. The recovered residual signal is reconstructed by adding back the predictor in a REC module <b>618</b> to produce reconstructed video. The reconstructed video is further processed by an In-loop Processing Filter (Filter) <b>624</b> to generate final decoded video. If the currently decoded picture is a reference picture for later pictures in decoding order, the reconstructed video of the currently decoded picture is also stored in the Ref. Pict. Buffer <b>626</b>.</p><p id="p-0045" num="0042">Various components of Video Encoder <b>500</b> and Video Decoder <b>600</b> in <figref idref="DRAWINGS">FIG. <b>5</b></figref> and <figref idref="DRAWINGS">FIG. <b>6</b></figref> may be implemented by hardware components, one or more processors configured to execute program instructions stored in a memory, or a combination of hardware and processor. For example, a processor executes program instructions to control receiving of input data associated with a current picture. The processor is equipped with a single or multiple processing cores. In some examples, the processor executes program instructions to perform functions in some components in Encoder <b>500</b> and Decoder <b>600</b>, and the memory electrically coupled with the processor is used to store the program instructions, information corresponding to the reconstructed images of blocks, and/or intermediate data during the encoding or decoding process. The memory in some embodiments includes a non-transitory computer readable medium, such as a semiconductor or solid-state memory, a random access memory (RAM), a read-only memory (ROM), a hard disk, an optical disk, or other suitable storage medium. The memory may also be a combination of two or more of the non-transitory computer readable mediums listed above. As shown in <figref idref="DRAWINGS">FIGS. <b>5</b> and <b>6</b></figref>, Encoder <b>500</b> and Decoder <b>600</b> may be implemented in the same electronic device, so various functional components of Encoder <b>500</b> and Decoder <b>600</b> may be shared or reused if implemented in the same electronic device.</p><p id="p-0046" num="0043">Embodiments of the video processing method for encoding or decoding may be implemented in a circuit integrated into a video compression chip or program codes integrated into video compression software to perform the processing described above. For examples, determining a reference block in a reference picture may be realized in program codes to be executed on a computer processor, a Digital Signal Processor (DSP), a microprocessor, or field programmable gate array (FPGA). These processors can be configured to perform particular tasks according to the invention, by executing machine-readable software codes or firmware codes that defines the particular methods embodied by the invention.</p><p id="p-0047" num="0044">Reference throughout this specification to &#x201c;an embodiment&#x201d;, &#x201c;some embodiments&#x201d;, or similar language means that a particular feature, structure, or characteristic described in connection with the embodiments may be included in at least one embodiment of the present invention. Thus, appearances of the phrases &#x201c;in an embodiment&#x201d; or &#x201c;in some embodiments&#x201d; in various places throughout this specification are not necessarily all referring to the same embodiment, these embodiments can be implemented individually or in conjunction with one or more other embodiments. Furthermore, the described features, structures, or characteristics may be combined in any suitable manner in one or more embodiments. One skilled in the relevant art will recognize, however, that the invention can be practiced without one or more of the specific details, or with other methods, components, etc. In other instances, well-known structures, or operations are not shown or described in detail to avoid obscuring aspects of the invention.</p><p id="p-0048" num="0045">The invention may be embodied in other specific forms without departing from its spirit or essential characteristics. The described examples are to be considered in all respects only as illustrative and not restrictive. The scope of the invention is therefore, indicated by the appended claims rather than by the foregoing description. All changes which come within the meaning and range of equivalency of the claims are to be embraced within their scope.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A video processing method in a video encoding or decoding system, comprising:<claim-text>receiving input video data of a current block in a current picture;</claim-text><claim-text>determining a scaling window width, height, or size of the current picture;</claim-text><claim-text>determining a scaling window width, height, or size of a reference picture, wherein a ratio between the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture is within a ratio constraint;</claim-text><claim-text>generating a reference block from the reference picture according to the ratio between the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture;</claim-text><claim-text>performing motion compensation for the current block using the reference block; and</claim-text><claim-text>encoding or decoding the current block in the current picture.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the ratio constraint is between &#x215b; and 2.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the scaling window size comprises both the scaling window width and the scaling window height, and the ratio between the scaling window size of the current picture and the scaling window size of the reference picture is within the ratio constraint when 2 times the scaling window width of the current picture is greater than or equal to the scaling window width of the reference picture, 2 times the scaling window height of the current picture is greater than or equal to the scaling window height of the reference picture, the scaling window width of the current picture is less than or equal to 8 times the scaling window width of the reference picture, and the scaling window height of the current picture is less than or equal to 8 times the scaling window height of the reference picture.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the scaling window width of the current picture is derived by a picture width, a left scaling window offset, and a right scaling window offset of the current picture, and the scaling window height of the current picture is derived by a picture height, a top scaling window offset, and a bottom scaling window offset of the current picture.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the scaling window width of the current picture is derived by subtracting the left scaling window offset and the right scaling window offset from the picture width of the current picture, and the scaling window height of the current picture is derived by subtracting the top scaling window offset and the bottom scaling window offset from the picture height of the current picture.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the picture width, left scaling window offset, right scaling window offset, picture height, top scaling window offset, and bottom scaling window offset of the current picture are signaled in a Picture Parameter Set (PPS) associated with the current picture.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the left scaling window offset, right scaling window offset, top scaling window offset, and bottom scaling window offset are measured in chroma samples.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the scaling window width of the current picture is further derived by a variable SubWidthC and the scaling window height of the current picture is further derived by a variable SubHeightC, wherein the variables SubWidthC and SubHeightC indicate down-sampling ratios associated with chroma bitplanes in horizontal and vertical dimensions.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the scaling window width of the current picture is derived by multiplying the variable SubWidthC with a sum of the left scaling window offset and the right scaling window offset and then subtracting from the picture width of the current picture, and the scaling window height of the current picture is derived by multiplying the variable SubHeightC with a sum of the top scaling window offset and the bottom scaling window offset and then subtracting from the picture height of the current picture.</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the ratio constraint is between 1/M and N, wherein M and N are positive integers.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the scaling window size comprises both the scaling window width and the scaling window height, and the ratio between the scaling window size of the current picture and the scaling window size of the reference picture is within the ratio constraint when N times the scaling window width of the current picture is greater than or equal to the scaling window width of the reference picture, N times the scaling window height of the current picture is greater than or equal to the scaling window height of the reference picture, the scaling window width of the current picture is less than or equal to M times the scaling window width of the reference picture, and the scaling window height of the current picture is less than or equal to M times the scaling window height of the reference picture.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein a reference picture scaling ratio is derived for motion compensation from the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture, and the reference picture scaling ratio is constrained to be within a range of [2048, 32768].</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising generating, at an encoder side, or receiving, at a decoder side, a bitstream corresponding to encoded data of a video sequence, wherein the bitstream complies with a bitstream conformance requirement that 2 times the scaling window width of the current picture is greater than or equal to the scaling window width of the reference picture, 2 times the scaling window height of the current picture is greater than or equal to the scaling window height of the reference picture, the scaling window width of the current picture is less than or equal to 8 times the scaling window width of the reference picture, and the scaling window height of the current picture is less than or equal to 8 times the scaling window height of the reference picture.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. An apparatus of processing video data in a video encoding or decoding system, the apparatus comprising one or more electronic circuits configured for:<claim-text>receiving input video data of a current block in a current picture;</claim-text><claim-text>determining a scaling window width, height, or size of the current picture;</claim-text><claim-text>determining a scaling window width, height, or size of a reference picture, wherein a ratio between the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture is within a ratio constraint;</claim-text><claim-text>generating a reference block from the reference picture according to the ratio between the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture;</claim-text><claim-text>performing motion compensation for the current block using the reference block; and</claim-text><claim-text>encoding or decoding the current block in the current picture.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. A non-transitory computer readable medium storing program instruction causing a processing circuit of an apparatus to perform a video processing method for video data, and the method comprising:<claim-text>receiving input video data of a current block in a current picture;</claim-text><claim-text>determining a scaling window width, height, or size of the current picture;</claim-text><claim-text>determining a scaling window width, height, or size of a reference picture, wherein a ratio between the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture is within a ratio constraint;</claim-text><claim-text>generating a reference block from the reference picture according to the ratio between the scaling window width, height, or size of the current picture and the scaling window width, height, or size of the reference picture;</claim-text><claim-text>performing motion compensation for the current block using the reference block; and</claim-text><claim-text>encoding or decoding the current block in the current picture.</claim-text></claim-text></claim></claims></us-patent-application>