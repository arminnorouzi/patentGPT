<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230006993A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230006993</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17781085</doc-number><date>20200225</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="regional"><country>EP</country><doc-number>19404006.9</doc-number><date>20191204</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>9</main-group><subgroup>40</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>0823</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc></classifications-cpc><invention-title id="d2e61">Authentication of an Entity</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="obligated-assignee"><addressbook><orgname>Telefonaktiebolaget LM Ericsson (publ)</orgname><address><city>Stockholm</city><country>SE</country></address></addressbook><residence><country>SE</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Bilgin</last-name><first-name>Zeki</first-name><address><city>Istanbul</city><country>TR</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Tomur</last-name><first-name>Emrah</first-name><address><city>Izmir</city><country>TR</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Soykan</last-name><first-name>Elif Ustundag</first-name><address><city>Istanbul</city><country>TR</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>Ersoy</last-name><first-name>Mehmet Akif</first-name><address><city>Istanbul</city><country>TR</country></address></addressbook></inventor></inventors></us-parties><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/EP2020/054908</doc-number><date>20200225</date></document-id><us-371c12-date><date>20220531</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">There is provided a method performed by a first entity of a network. Contextual information for the first entity and a timestamp for the contextual information is acquired (<b>102</b>). An authentication token is generated (<b>104</b>) using the acquired contextual information. Transmission of an authentication request message is initiated (<b>106</b>) towards a second entity of the network requesting authentication of the first entity with the second entity. The authentication request message comprises the generated authentication token and the timestamp for use in the authentication. An authentication response message indicative of whether authentication of the first entity with the second entity is successful or unsuccessful received (<b>108</b>).</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="115.32mm" wi="133.27mm" file="US20230006993A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="130.64mm" wi="113.88mm" file="US20230006993A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="134.37mm" wi="135.30mm" file="US20230006993A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="130.64mm" wi="113.88mm" file="US20230006993A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="103.89mm" wi="136.23mm" file="US20230006993A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="130.64mm" wi="113.88mm" file="US20230006993A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="103.89mm" wi="136.23mm" file="US20230006993A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="236.90mm" wi="85.60mm" orientation="landscape" file="US20230006993A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="199.73mm" wi="134.45mm" orientation="landscape" file="US20230006993A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="243.25mm" wi="150.96mm" orientation="landscape" file="US20230006993A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="205.74mm" wi="157.90mm" orientation="landscape" file="US20230006993A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="167.81mm" wi="115.49mm" file="US20230006993A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="136.82mm" wi="115.49mm" file="US20230006993A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00013" num="00013"><img id="EMI-D00013" he="136.82mm" wi="115.49mm" file="US20230006993A1-20230105-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">TECHNICAL FIELD</heading><p id="p-0002" num="0001">The disclosure relates to methods for authenticating an entity. The disclosure also relates to entities configured to operate in accordance with those methods.</p><heading id="h-0002" level="1">BACKGROUND</heading><p id="p-0003" num="0002">Many networks employ techniques to authenticate entities that communicate via the network. Examples of such networks include internet of things (IoT) networks and machine to machine (M2M) networks. Both IoT and M2M networks can operate without manual assistance from humans.</p><p id="p-0004" num="0003">IoT networks are those that enable devices, which are embedded with sensors, software and electronics, to communicate with each other (e.g. to exchange data and/or perform actions). IoT networks use an Internet platform to enable this communication. The devices can be uniquely identifiable through this Internet platform. M2M networks are those that enable machines to communicate with each other directly (e.g. to exchange information and/or perform actions). M2M networks support point-to-point communication and do not necessarily rely on an Internet connection. Instead, the machines communicate with each other using wired and/or wireless communication channels. M2M networks can enable remote monitoring of operations (e.g. industrial operations) and/or can be used to automate processes. There also exist networks that combine the communication capabilities of M2M networks and IoT networks. These networks can be useful for industrial applications, such as applications in production, logistics, and/or lifecycle management processes.</p><p id="p-0005" num="0004">In existing M2M and/or IoT networks, entities (e.g. the devices or machines) are authenticated mostly using keys, such as pre-shared symmetric keys or public-private key pairs. However, this requires a trusted third party to generate and distribute the keys. Moreover, the keys are generated based on static credentials that are not updated or changed for different message exchanges, sessions or logins, which means that the keys themselves are static. The keys are thus vulnerable to certain threats. An example of such a threat is a replay attack. In this sort of attack, the static keys are sniffed and then maliciously re-used (replayed) by attackers in subsequent sessions or logins to gain access to resources, and/or previously transmitted data packets can be resent to trick a receiver into taking an action specified by a hacker. In another sort of attack, a static key is compromised and subsequent communications become insecure in terms of confidentiality, integrity and other security-related features of data exchange.</p><p id="p-0006" num="0005">There exist techniques that use a trusted execution environment (TEE) with ephemeral keys, which partly address these issues. However, such a TEE is not always feasible and/or available, which is especially the case for constrained IoT devices. In addition, the management of keys is a complex process, which requires generating, exchanging, storing, and revoking mechanisms. As such, these existing techniques have some inherent difficulties, which cause an overhead to network. This can be particularly severe in large scale networks that have large numbers of devices or machines.</p><p id="p-0007" num="0006">Some other existing techniques require a user generated password for authentication. However, since it is difficult for a human user to remember passwords, a user generally uses short and easy to remember passwords or tokens when authenticating themselves. This can increase the risk of security breaches. There is not such a problem for devices or machines, since devices or machines can use large and complex passwords in different formats. Thus, authentication mechanisms developed for devices or machines need different design considerations than authentication mechanisms developed for human user authentication.</p><p id="p-0008" num="0007">Moreover, as M2M and IoT networks become more widespread and advance, new and additional security mechanisms are required. The security mechanisms required can depend on the criticality of the networks as each network has its own unique requirements and structure, such as the requirements of deploying constrained devices and/or low latency. Also, as network management and operations are becoming more autonomous, the security mechanisms in the networks usually need to work without human intervention as much as possible. Therefore, there is a need for authentication mechanisms that enable the management and generation of keys in a secure and autonomous way, especially for M2M and IoT networks.</p><heading id="h-0003" level="1">SUMMARY</heading><p id="p-0009" num="0008">It is an object of the disclosure to obviate or eliminate at least some of the above-described disadvantages associated with existing techniques and provide an improved technique for authenticating an entity of a network.</p><p id="p-0010" num="0009">Therefore, according to an aspect of the disclosure, there is provided a method performed by a first entity of a network. The method comprises acquiring contextual information for the first entity and a timestamp for the contextual information and generating an authentication token using the acquired contextual information. The method also comprises initiating transmission of an authentication request message towards a second entity of the network requesting authentication of the first entity with the second entity. The authentication request message comprises the generated authentication token and the timestamp for use in the authentication. The method also comprises receiving an authentication response message indicative of whether authentication of the first entity with the second entity is successful or unsuccessful.</p><p id="p-0011" num="0010">There is thus provided an improved method for authenticating a first entity. In particular, the method involves generating and exchanging dynamic credentials (in the form of an authentication token) by use of contextual information for the first entity and a corresponding timestamp for that contextual information for authenticating the first entity with the second entity. As the credentials are dynamic, the method is resistant against replay attacks because the credentials can vary (or change) over time depending on the contextual information at that time. Moreover, the use of contextual information for the first entity in generating the credentials means that the generated credentials can contain longer and richer data types, which can be extended depending on threat level. This makes the method more resistant against brute-force attacks. Thus, the method provides improved security. The method also eliminates the need for user generated passwords by instead using contextual information for the first entity in the generation of the authentication token.</p><p id="p-0012" num="0011">In some embodiments, the method may comprise generating the authentication token using the acquired contextual information and any one or more of the timestamp, a random number generated for the first entity and having the timestamp, identification information for the first entity, and identification information for the second entity. Where the timestamp is used in the generation of the authentication token, the freshness of the authentication token can be checked and tokens that are dated back to a certain pre-determined period can be invalidated, which provides protection against replay attacks and forces the use of fresh enough tokens. The use of a random number generated for the timestamp can increase the strength of the unpredictability of the first authentication token. Where identification information for the entities is used in the generation of the authentication token, it can be ensured that a particular token is only for authentication processes between these identified entities, not for others.</p><p id="p-0013" num="0012">In some embodiments, the network may be an internet of things (IoT) network. In this way, the method can be used to enhance security of a wide range of IoT applications in harmony with their dynamic and autonomous manner of operation.</p><p id="p-0014" num="0013">In some embodiments, the contextual information for the first entity may comprise any one or more of utility consumption information for the first entity, environmental information for the first entity, location information for the first entity, neighbourhood information for the first entity, and network information for the first entity. As at least some of this contextual information is already transmitted within the network, the method can make an additional use of this data in the generation of the authentication token. This eliminates the need for creating and sending extra dynamic tokens. As such, energy efficiency can be provided. The method can be used in constrained devices without requiring heavy computations for security algorithms and protocols. Moreover, existing infrastructure can be used for the acquisition of contextual information for the first entity, which means that the method benefits from security measures already implemented in those infrastructures.</p><p id="p-0015" num="0014">In some embodiments, transmission of the authentication request message towards the second entity may be initiated via an in-band communication channel between the first entity and the second entity. In this way, the method can be integrated with common network protocols used in in-band communication channels.</p><p id="p-0016" num="0015">According to another aspect of the disclosure, there is provided a first entity comprising processing circuitry configured to operate in accordance with the method described earlier in respect of the first entity. In some embodiments, the first entity may comprise at least one memory for storing instructions which, when executed by the processing circuitry, cause the first entity to operate in accordance with the method described earlier in respect of the first entity. The first entity thus provides the advantages discussed earlier in respect of the method performed by the first entity.</p><p id="p-0017" num="0016">According to another aspect of the disclosure, there is provided a method performed by a second entity of a network. The method comprises, in response to receiving an authentication request message from a first entity of the network requesting authentication of the first entity with the second entity, wherein the authentication request message comprises an authentication token and a timestamp for contextual information for the first entity used to generate the authentication token, initiating transmission of a verification request message towards a third entity requesting verification of the authentication request message. The verification request message comprises the authentication token and the timestamp for use in the verification. The method also comprises receiving a verification response message from the third entity indicative of whether verification of the authentication request message is successful and initiating transmission of an authentication response message towards the first entity. The authentication request message indicates that authentication of the first entity with the second entity is successful if verification of the authentication request message is successful or indicates that authentication of the first entity with the second entity is unsuccessful if verification of the authentication request message is unsuccessful.</p><p id="p-0018" num="0017">There is thus provided an improved method for authenticating a first entity. In particular, the authentication token provides a dynamic credential as it is generated using contextual information for the first entity. As the credential is dynamic, the method is resistant against replay attacks because the credentials can vary (or change) over time depending on the contextual information at that time. Moreover, the use of contextual information for the first entity in generating the credentials means that the generated credentials can contain longer and richer data types, which can be extended depending on threat level. This makes the method more resistant against brute-force attacks. Thus, the method provides improved security. The method also eliminates the need for user generated passwords by instead using contextual information for the first entity in the generation of the authentication token.</p><p id="p-0019" num="0018">According to another aspect of the disclosure, there is provided a second entity comprising processing circuitry configured to operate in accordance with the method described earlier in respect of the second entity. In some embodiments, the second entity may comprise at least one memory for storing instructions which, when executed by the processing circuitry, cause the second entity to operate in accordance with the method described earlier in respect of the second entity. The second entity thus provides the advantages discussed earlier in respect of the method performed by the second entity.</p><p id="p-0020" num="0019">According to another aspect of the disclosure, there is provided a method performed by a third entity. The method comprises, in response to receiving a verification request message from a second entity of a network requesting verification of an authentication request message, wherein the verification request message comprises a first authentication token for a first entity and a timestamp for contextual information for the first entity used to generate the first authentication token, generating a second authentication token using contextual information stored in a database for the first entity of the network with the timestamp. The method also comprises checking whether the second authentication token is the same as the first authentication token or different to the first authentication token and initiating transmission of a verification response message towards the second entity. The verification response message indicates that verification of the authentication request message is successful if the second authentication token is the same as the first authentication token or indicates that verification of the authentication request message is unsuccessful if the second authentication token is different to the first authentication token.</p><p id="p-0021" num="0020">There is thus provided an improved method for authenticating a first entity. In particular, the authentication token provides a dynamic credential as it is generated using contextual information for the first entity. As the credential is dynamic, the method is resistant against replay attacks because the credentials can vary (or change) over time depending on the contextual information at that time. Moreover, the use of contextual information for the first entity in generating the credentials means that the generated credentials can contain longer and richer data types, which can be extended depending on threat level. This makes the method more resistant against brute-force attacks. Thus, the method provides improved security. The method also eliminates the need for user generated passwords by instead using contextual information for the first entity in the generation of the authentication token.</p><p id="p-0022" num="0021">In some embodiments, the network may be an internet of things (IoT) network. In this way, the method can be used to enhance security of a wide range of IoT applications in harmony with their dynamic and autonomous manner of operation.</p><p id="p-0023" num="0022">In some embodiments, the method may comprise acquiring the contextual information for the first entity and the timestamp for the contextual information and controlling the database to store the acquired contextual information for the first entity with the timestamp. In this way, it becomes possible to use the stored contextual information for authentication purposes later.</p><p id="p-0024" num="0023">In some embodiments, a communication channel via which the contextual information for the first entity and the timestamp for the contextual information is acquired may be an out-of-band communication channel. In this way, the security of the method can be further improved as usage of out-of-band authentication (OOBA) is enabled. For example, utilizing an extra communication channel, which is separate from the primary communication channel used by the first and second entities, makes it significantly more difficult for an attacker to intercept and subvert the authentication process, because it requires an attacker to compromise two different communications channels.</p><p id="p-0025" num="0024">In some embodiments, the method may comprise generating the second authentication token using the contextual information stored in the database for the first entity with the timestamp and any one or more of the timestamp, a random number stored in the database for the first entity with the timestamp, identification information for the first entity, and identification information for the second entity. In this way, the second authentication token is obtained for the comparison with the first authentication token generated earlier based on the identical contextual information. In such a way, due to the timestamp used in the generation of the second authentication token, the freshness of the second authentication token can be checked and tokens that are dated back to a certain pre-determined period can be rejected, which provides protection against replay attacks and forces to the use of fresh enough tokens. The use of a random number generated for the timestamp can increase the strength of the unpredictability of the first authentication token and thus, by using the random number stored in the database for the first entity with the timestamp in the generation of the second token, it can be better ensured that the first authentication token is trusted when it is checked against the second authentication token. Also, by using the identification information of the entities in the generation of the second authentication token, it can be ensured that a particular token is only for authentication processes between these particular entities, not for others.</p><p id="p-0026" num="0025">In some embodiments, the contextual information stored in the database for the first entity with the timestamp may comprise any one or more of utility consumption information for the first entity, environmental information for the first entity, location information for the first entity, neighbourhood information for the first entity, and network information for the first entity. As at least some of this contextual information is already transmitted within the network, the method can make an additional use of this data in the generation of the authentication token. This eliminates the need for creating and sending extra tokens. As such, energy efficiency can be provided. The method can be used in constrained devices without requiring heavy computations for security algorithms and protocols. Moreover, existing infrastructure can be used for the acquisition of contextual information for the first entity, which means that the method benefits from security measures already implemented in those infrastructures.</p><p id="p-0027" num="0026">In some embodiments, transmission of the authentication request message towards the second entity may be initiated via an in-band communication channel between the first entity and the second entity. In this way, the method can be integrated with common network protocols used in in-band communication channels.</p><p id="p-0028" num="0027">According to another aspect of the disclosure, there is provided a third entity comprising processing circuitry configured to operate in accordance with the method described earlier in respect of the third entity. In some embodiments, the third entity may comprise at least one memory for storing instructions which, when executed by the processing circuitry, cause the third entity to operate in accordance with the method described earlier in respect of the third entity. The third entity thus provides the advantages discussed earlier in respect of the method performed by the third entity.</p><p id="p-0029" num="0028">According to another aspect of the disclosure, there is provided a network comprising any one or more of the first entity as described earlier, the second entity as described earlier, and the third entity as described earlier. The network thus provides the advantages discussed earlier in respect of the method performed by the first entity, second entity, and/or third entity.</p><p id="p-0030" num="0029">According to another aspect of the disclosure, there is provided a computer program comprising instructions which, when executed by processing circuitry, cause the processing circuitry to perform the method described earlier in respect of the first entity, second entity, and/or third entity. The computer program thus provides the advantages discussed earlier in respect of the method performed by the first entity, second entity, and/or third entity.</p><p id="p-0031" num="0030">According to another aspect of the disclosure, there is provided a computer program product, embodied on a non-transitory machine-readable medium, comprising instructions which are executable by processing circuitry to cause the processing circuitry to perform the method described earlier in respect of the first entity, second entity, and/or third entity. The computer program product thus provides the advantages discussed earlier in respect of the method performed by the first entity, second entity, and/or third entity.</p><p id="p-0032" num="0031">Therefore, an advantageous technique for authenticating an entity is provided.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0033" num="0032">For a better understanding of the technique, and to show how it may be put into effect, reference will now be made, by way of example, to the accompanying drawings, in which:</p><p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a block diagram illustrating a first entity according to an embodiment;</p><p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a block diagram illustrating a method performed by a first entity according to an embodiment;</p><p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a block diagram illustrating a second entity according to an embodiment;</p><p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a block diagram illustrating a method performed by a second entity according to an embodiment;</p><p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a block diagram illustrating a third entity according to an embodiment;</p><p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a block diagram illustrating a method performed by a third entity according to an embodiment;</p><p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is an example of contextual information according to an embodiment;</p><p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a block diagram illustrating a network according to an embodiment;</p><p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a block diagram illustrating a network according to an embodiment;</p><p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a signalling diagram illustrating an exchange of signals in a network according to an embodiment;</p><p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. <b>11</b></figref> is a block diagram illustrating a first entity according to an embodiment;</p><p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. <b>12</b></figref> is a block diagram illustrating a second entity according to an embodiment; and</p><p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. <b>13</b></figref> is a block diagram illustrating a third entity according to an embodiment.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0005" level="1">DETAILED DESCRIPTION</heading><p id="p-0047" num="0046">As mentioned earlier, an advantageous technique for authenticating an entity is described herein. The technique that is described herein is implemented by a first entity of a network, a second entity of the network, and a third entity of the network. In some embodiments, the network referred to herein may be an internet of things (IoT) network and/or a machine to machine (M2M) network.</p><p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates a first entity <b>10</b> of a network in accordance with an embodiment. The first entity <b>10</b> is for authenticating the first entity <b>10</b> with a second entity. The first entity <b>10</b> can, for example, be a machine (e.g. a physical machine or a virtual machine) or a device.</p><p id="p-0049" num="0048">As illustrated in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the first entity <b>10</b> comprises processing circuitry (or logic) <b>12</b>. The processing circuitry <b>12</b> controls the operation of the first entity <b>10</b> and can implement the method described herein. The processing circuitry <b>12</b> can comprise one or more processors, processing units, multi-core processors or modules that are configured or programmed to control the first entity <b>10</b> in the manner described herein. In particular implementations, the processing circuitry <b>12</b> of the first entity <b>10</b> can comprise a plurality of software and/or hardware modules that are each configured to perform, or are for performing, individual or multiple steps of the method described herein.</p><p id="p-0050" num="0049">Briefly, the processing circuitry <b>12</b> of the first entity <b>10</b> is configured to acquire contextual information for the first entity <b>10</b> and a timestamp for the contextual information, and generating a first authentication token using the acquired contextual information. The processing circuitry <b>12</b> of the first entity <b>10</b> is configured to initiate transmission of an authentication request message towards a second entity of the network requesting authentication of the first entity with the second entity. The authentication request message comprises the generated first authentication token and the timestamp for use in the authentication. The processing circuitry <b>12</b> of the first entity <b>10</b> is configured to receive an authentication response message indicative of whether authentication of the first entity with the second entity is successful or unsuccessful.</p><p id="p-0051" num="0050">As illustrated in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, in some embodiments, the first entity <b>10</b> may optionally comprise a memory <b>14</b>. The memory <b>14</b> of the first entity <b>10</b> can comprise a volatile memory or a non-volatile memory. In some embodiments, the memory <b>14</b> of the first entity <b>10</b> may comprise a non-transitory media. Examples of the memory <b>14</b> of the first entity <b>10</b> include, but are not limited to, a random access memory (RAM), a read only memory (ROM), a mass storage media such as a hard disk, a removable storage media such as a compact disk (CD) or a digital video disk (DVD), and/or any other memory.</p><p id="p-0052" num="0051">The processing circuitry <b>12</b> of the first entity <b>10</b> can be connected to the memory <b>14</b> of the first entity <b>10</b>. In some embodiments, the memory <b>14</b> of the first entity <b>10</b> may be for storing program code or instructions which, when executed by the processing circuitry <b>12</b> of the first entity <b>10</b>, cause the first entity <b>10</b> to operate in the manner described herein in respect of the first entity <b>10</b>. For example, in some embodiments, the memory <b>14</b> of the first entity <b>10</b> may be configured to store program code or instructions that can be executed by the processing circuitry <b>12</b> of the first entity <b>10</b> to cause the first entity <b>10</b> to operate in accordance with the method described herein in respect of the first entity <b>10</b>. Alternatively or in addition, the memory <b>14</b> of the first entity <b>10</b> can be configured to store any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein. The processing circuitry <b>12</b> of the first entity <b>10</b> may be configured to control the memory <b>14</b> of the first entity <b>10</b> to store any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein.</p><p id="p-0053" num="0052">In some embodiments, as illustrated in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the first entity <b>10</b> may optionally comprise a communications interface <b>16</b>. The communications interface <b>16</b> of the first entity <b>10</b> can be connected to the processing circuitry <b>12</b> of the first entity <b>10</b> and/or the memory <b>14</b> of first entity <b>10</b>. The communications interface <b>16</b> of the first entity <b>10</b> may be operable to allow the processing circuitry <b>12</b> of the first entity <b>10</b> to communicate with the memory <b>14</b> of the first entity <b>10</b> and/or vice versa. Similarly, the communications interface <b>16</b> of the first entity <b>10</b> may be operable to allow the processing circuitry <b>12</b> of the first entity <b>10</b> to communicate with the second entity, the third entity, and/or any other entity of the network. The communications interface <b>16</b> of the first entity <b>10</b> can be configured to transmit and/or receive any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein. In some embodiments, the processing circuitry <b>12</b> of the first entity <b>10</b> may be configured to control the communications interface <b>16</b> of the first entity <b>10</b> to transmit and/or receive any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein.</p><p id="p-0054" num="0053">Although the first entity <b>10</b> is illustrated in <figref idref="DRAWINGS">FIG. <b>1</b></figref> as comprising a single memory <b>14</b>, it will be appreciated that the first entity <b>10</b> may comprise at least one memory (i.e. a single memory or a plurality of memories) <b>14</b> that operate in the manner described herein. Similarly, although the first entity <b>10</b> is illustrated in <figref idref="DRAWINGS">FIG. <b>1</b></figref> as comprising a single communications interface <b>16</b>, it will be appreciated that the first entity <b>10</b> may comprise at least one communications interface (i.e. a single communications interface or a plurality of communications interface) <b>16</b> that operate in the manner described herein. It will also be appreciated that <figref idref="DRAWINGS">FIG. <b>1</b></figref> only shows the components required to illustrate an embodiment of the first entity <b>10</b> and, in practical implementations, the first entity <b>10</b> may comprise additional or alternative components to those shown.</p><p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a flowchart illustrating a method performed by a first entity <b>10</b> in accordance with an embodiment. The method is for authenticating the first entity <b>10</b> with a second entity. The first entity <b>10</b> described earlier with reference to <figref idref="DRAWINGS">FIG. <b>1</b></figref> is configured to operate in accordance with the method of <figref idref="DRAWINGS">FIG. <b>2</b></figref>. The method can be performed by or under the control of the processing circuitry <b>12</b> of the first entity <b>10</b>.</p><p id="p-0056" num="0055">As illustrated at block <b>102</b> of <figref idref="DRAWINGS">FIG. <b>2</b></figref>, contextual information (e.g. one or more contextual parameters) for the first entity <b>10</b> and a timestamp for the contextual information is acquired. More specifically, the processing circuitry <b>12</b> of the first entity <b>10</b> acquires the contextual information and the timestamp. The contextual information for the first entity <b>10</b> can be any information related to or belonging to the first entity <b>10</b>. The contextual information for the first entity <b>10</b> may be acquired instantaneously or in real time (or near real time). The method illustrated in <figref idref="DRAWINGS">FIG. <b>2</b></figref> is thus context-aware.</p><p id="p-0057" num="0056">In some embodiments, the contextual information for the first entity <b>10</b> of the network and the timestamp for the contextual information may be represented as a tuple.</p><p id="p-0058" num="0057">The contextual information referred to herein is information that provides context to the first entity <b>10</b>. For example, the contextual information referred to herein may be any information that can be used to characterize the state of the first entity <b>10</b> according to some embodiments. Generally, contextual information is dynamic. That is, contextual information can vary (or change) over time, e.g. continuously over time. For example, contextual information can vary (or change) depending on a type, a state and/or a condition of entities and/or the environment. Thus, contextual information for the first entity <b>10</b> with one timestamp may be different to contextual information for the first entity <b>10</b> with another timestamp.</p><p id="p-0059" num="0058">In some embodiments, the contextual information and the timestamp may be acquired from the network. For example, in some embodiments, the contextual information and timestamp may be acquired from one or more sensors in the network, e.g. one or more smart meters in the network comprising one or more sensors, one or more network nodes (e.g. one or more routers and/or one or more gateways) in the network comprising one or more sensors, one or more location sensors (such as one or more global positioning system (GPS) sensors), and/or any other sensors. In these embodiments, the one or more sensors can be configured to record the contextual information and the timestamp. In other embodiments, the contextual information and the timestamp may be acquired from a memory, e.g. the local memory <b>14</b> of the first entity <b>10</b>. In some of these embodiments, the contextual information acquired from the memory may be from the network, such as from one or more sensors in the network as described earlier.</p><p id="p-0060" num="0059">In some embodiments, the contextual information for the first entity <b>10</b> may comprise any one or more of utility (or energy) consumption information for the first entity <b>10</b>, environmental information for the first entity <b>10</b>, location information for the first entity <b>10</b>, neighbourhood information for the first entity <b>10</b>, and network information for the first entity <b>10</b>.</p><p id="p-0061" num="0060">In some embodiments, the utility consumption information may comprise information indicative of utility (or energy) consumption for the first entity <b>10</b>. In some embodiments, the utility (or energy) consumption information for the first entity <b>10</b> may comprise electricity, gas and/or water consumption information for the first entity <b>10</b>. In some embodiments involving electricity consumption information for the first entity <b>10</b>, the electricity consumption information for the first entity <b>10</b> may comprise a current rate for the first entity <b>10</b>, a voltage rate for the first entity <b>10</b>, a power for the first entity <b>10</b>, a power factor for the first entity <b>10</b>, an active power measurement for the first entity <b>10</b>, a reactive power measurement for the first entity <b>10</b>, a frequency for the first entity <b>10</b>, phase information for the first entity <b>10</b>, and/or any other electricity consumption information for the first entity <b>10</b>. In some embodiments, the utility consumption information may be from a smart utility network, such as a smart electricity network (i.e. a smart grid), a smart water supply network, and/or a smart gas distribution network. In some embodiments, the utility consumption information for the first entity <b>10</b> can be from one or more utility consumption sensors (i.e. one or more sensors configured to obtain utility consumption information for the first entity <b>10</b>), such as one or more sensors of one or more smart meters. In some embodiments, the smart utility network may comprise the one or more utility consumption sensors. In general, the smart utility network may be one that is advanced by the integration of communication technologies.</p><p id="p-0062" num="0061">In some embodiments, the environmental information for the first entity <b>10</b> may comprise information indicative of a temperature in the environment of the first entity <b>10</b> and/or a humidity in the environment of the first entity <b>10</b>. The environmental information for the first entity <b>10</b> can be from one or more environmental sensors (i.e. one or more sensors configured to obtain environmental information for the first entity <b>10</b>), such as a temperate sensor and/or a humidity sensor. In some embodiments, the location information for the first entity <b>10</b> may comprise information indicative of a geographical location of the first entity <b>10</b>, a relative location of the first entity <b>10</b>, and/or an indoor location of the first entity <b>10</b>. The location information for the first entity <b>10</b> can be from one or more location sensors (i.e. one or more sensors configured to obtain location information for the first entity <b>10</b>), such as a GPS sensor.</p><p id="p-0063" num="0062">In some embodiments, the neighbourhood information for the first entity <b>10</b> may comprise information indicative of a number of other entities (e.g. machines, devices and/or other entities) sensed around the first entity <b>10</b>, e.g. within a predefined area around the first entity <b>10</b> or within a predefined distance to the first entity <b>10</b>. The neighbourhood information for the first entity <b>10</b> can be from one or more neighbourhood sensors (i.e. one or more sensors configured to obtain neighbourhood information for the first entity <b>10</b>). In some embodiments, the network information for the first entity <b>10</b> may comprise an internet protocol (IP) address for the first entity <b>10</b>. The network information for the first entity <b>10</b> can be from one or more internet services and/or one or more network sensors (i.e. one or more sensors configured to obtain network information for the first entity <b>10</b>), such as one or more sensors of one or more network nodes. In some embodiments, the network nodes may comprise one or more routers and/or one or more gateways.</p><p id="p-0064" num="0063">The method can use already existing infrastructure for the acquisition of the contextual information for the first entity <b>10</b> according to some embodiments. This means that the advantages mentioned earlier can be achieved without requiring additional infrastructure. Moreover, the method can also further benefit from the security mechanisms already implemented in those existing infrastructures.</p><p id="p-0065" num="0064">Returning back to <figref idref="DRAWINGS">FIG. <b>2</b></figref>, at block <b>104</b>, a first authentication token is generated using the acquired contextual information. More specifically, the processing circuitry <b>12</b> of the first entity <b>10</b> generates the first authentication token using the acquired contextual information. As mentioned earlier, contextual information for the first entity <b>10</b> with one timestamp may be different to contextual information for the first entity <b>10</b> with another timestamp. In this way, it is possible to use a newly generated authentication token each time the first entity <b>10</b> wishes to authenticate itself with another entity, e.g. in each different session. This provides protection against attacks where credentials are compromised and re-used by malicious parties. In particular, the generated authentication token is difficult to estimate since the contextual information used to generate it varies (or changes) over time. The first authentication token can be used as a one-time password.</p><p id="p-0066" num="0065">In some embodiments, the method may comprise generating the first authentication token using the acquired contextual information and any one or more of the timestamp, a random number (e.g. a pseudo random number) generated for the first entity <b>10</b> and having the timestamp, identification information for the first entity <b>10</b>, and identification information for the second entity. In some embodiments, the first authentication token may be generated using the tuple (representing the contextual information and the timestamp for the contextual information), and any one or more of the timestamp for the contextual information, the random number generated for the first entity <b>10</b> and having the timestamp, the identification information for the first entity <b>10</b> and the identification information for the second entity. In some embodiments, the identification information for the first entity <b>10</b> may comprise a serial number for the first entity <b>10</b> and/or a media access control (MAC) address for the first entity <b>10</b>. Similarly, in some embodiments, the identification information for the second entity may comprise a serial number for the second entity and/or a media access control (MAC) address for the second entity.</p><p id="p-0067" num="0066">In some embodiments involving a random number, the random number may be acquired from a (e.g. pseudo) random number generator that generated the random number for the first entity <b>10</b>. In some embodiments, one or more of the sensors (e.g. one or more sensor of one or more smart meters) may comprise this random number generator. In some embodiments, the first authentication token may be generated using the acquired contextual information and optionally also any one or more of the timestamp for the contextual information, the identification information for the first entity <b>10</b>, and the identification information for the second entity, and the random number generated for the first entity <b>10</b> may be inserted into the generated first authentication token. This use of a random number generated for the first entity <b>10</b> can increase the strength of the unpredictability of the first authentication token.</p><p id="p-0068" num="0067">In some embodiments, the contextual information that is acquired for the first entity <b>10</b> and used to generate the authentication token may be adjusted based on an application and/or a security threat scenario. For example, in some cases (e.g. when a risk of a security threat is high), a larger amount of contextual information for the first entity <b>10</b> may be acquired and used to generate the authentication token. This can improve security even further. In other cases (e.g. when a risk of a security threat is low), a smaller amount of contextual information for the first entity <b>10</b> may be acquired and used to generate the authentication token. This can conserve bandwidth in the network. In some embodiments, the token may be for use in granting (e.g. a time-limited) access to a specific resource.</p><p id="p-0069" num="0068">At block <b>106</b> of <figref idref="DRAWINGS">FIG. <b>2</b></figref>, transmission of an (e.g. integrity protected) authentication request message is initiated towards a second entity of the network requesting authentication of the first entity <b>10</b> with the second entity. More specifically, the processing circuitry <b>12</b> of the first entity <b>10</b> initiates transmission of the authentication request message. The authentication request message comprises the first authentication token and the timestamp used to generate the authentication token for use in the authentication. In some embodiments, the authentication request message may further comprise the identification information for the first entity <b>10</b> and the identification information for the second entity.</p><p id="p-0070" num="0069">In some embodiments, transmission of the authentication request message towards the second entity may be initiated via a first communication channel between the first entity <b>10</b> and the second entity. In some embodiments, the first communication channel can be a primary communication channel. For example, in some embodiments, the first communication channel can be an in-band communication channel. An in-band communication channel can be defined as a communication channel that is used for primary communications between entities (e.g. devices or machines). The first communication channel may operate using a frequency within a predefined frequency band. In some embodiments, the first authentication token may have a hash function or a hash based authentication code (HMAC) applied to it. In this way, it is possible to enable verification of the integrity of the authentication request message.</p><p id="p-0071" num="0070">At block <b>108</b> of <figref idref="DRAWINGS">FIG. <b>2</b></figref>, an (e.g. integrity protected) authentication response message indicative of whether authentication of the first entity <b>10</b> with the second entity is successful or unsuccessful is received. More specifically, the processing circuitry <b>12</b> of the first entity <b>10</b> receives the authentication response message. In some embodiments, the authentication response message may be received through the first (e.g. in-band) communication channel described earlier. In some embodiments, the authentication response message may comprise a verification token for verifying message. In some embodiments, the authentication response message may further comprise the identification information for the first entity <b>10</b> and the identification information for the second entity <b>20</b>.</p><p id="p-0072" num="0071">Although not illustrated in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, in some embodiments, the method may comprise initiating transmission of the acquired contextual information for the first entity <b>10</b> and the timestamp for the contextual information towards the third entity of the network. More specifically, the processing circuitry <b>12</b> of the first entity <b>10</b> initiates transmission of the acquired contextual information for the first entity <b>10</b> and the timestamp for the contextual information towards the third entity of the network according to some embodiments. The transmission of the acquired contextual information for the first entity <b>10</b> and the timestamp for the contextual information may be initiated periodically or on-demand. In some embodiments, the acquired contextual information for the first entity <b>10</b> and the timestamp for the contextual information may be transmitted as a code, e.g. via a short message service (SMS) or a mobile application.</p><p id="p-0073" num="0072">In some embodiments, the transmission of the contextual information for the first entity <b>10</b> and the timestamp for the contextual information may be initiated via a second communication channel. In some embodiments, the second communication channel may be an extra or secondary communication channel. For example, the second communication channel can be secondary to the first communication channel mentioned earlier. The second communication channel is separate from the first communication channel. Using a separate second communication channel for the transmission of the contextual information for the first entity <b>10</b> and the timestamp for the contextual information makes it significantly more difficult for an attacker to intercept and subvert the authentication process, because it requires such an attacker to compromise two communications channels.</p><p id="p-0074" num="0073">In some embodiments, the second communication channel may be an out-of-band (OOB) communication channel. In these embodiments, the authentication of the first entity <b>10</b> with the second entity <b>20</b> may be referred to as out-of-band authentication (OOBA). Examples of an OOBA can include the transmission via an SMS or a mobile application as mentioned earlier. An out-of-band communication channel can be defined as a communication channel that is separate from a primary communication channel. More specifically, an out-of-band communication channel can be defined as a communication channel that use a frequency that is outside the frequency band used by a primary communication channel. The primary communication channel can, for example, be the first communication channel between the first entity <b>10</b> and the second entity <b>20</b>. In some embodiments, the second communication channel may be a smart grid communication channel. Thus, advantageously, additional infrastructure is not required to transmit the acquired contextual information for the first entity <b>10</b> and the timestamp for the contextual information.</p><p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates a second entity <b>20</b> of a network in accordance with an embodiment. The second entity <b>20</b> is for authenticating a first entity <b>10</b> with the second entity <b>20</b>. In some embodiments, the second entity <b>20</b> may be a server of the network.</p><p id="p-0076" num="0075">As illustrated in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the second entity <b>20</b> comprises processing circuitry (or logic) <b>22</b>. The processing circuitry <b>22</b> controls the operation of the second entity <b>20</b> and can implement the method described herein. The processing circuitry <b>22</b> can comprise one or more processors, processing units, multi-core processors or modules that are configured or programmed to control the second entity <b>20</b> in the manner described herein. In particular implementations, the processing circuitry <b>22</b> of the second entity <b>20</b> can comprise a plurality of software and/or hardware modules that are each configured to perform, or are for performing, individual or multiple steps of the method described herein.</p><p id="p-0077" num="0076">Briefly, the processing circuitry <b>22</b> of the second entity <b>20</b> is configured to, in response to receiving an authentication request message from a first entity <b>10</b> of the network requesting authentication of the first entity <b>10</b> with the second entity <b>20</b> (wherein the authentication request message comprises a first authentication token and a timestamp for contextual information for the first entity used to generate the first authentication token), initiate transmission of a verification request message towards a third entity requesting verification of the authentication request message. The verification request message comprises the first authentication token and the timestamp for use in the verification. The processing circuitry <b>22</b> of the second entity <b>20</b> is configured to receive a verification response message from the third entity indicative of whether verification of the authentication request message is successful and initiate transmission of an authentication response message towards the first entity <b>10</b>. The authentication response message indicates that authentication of the first entity <b>10</b> with the second entity <b>20</b> is successful if verification of the authentication request message is successful or indicating that authentication of the first entity <b>10</b> with the second entity <b>20</b> is unsuccessful if verification of the authentication request message is unsuccessful.</p><p id="p-0078" num="0077">As illustrated in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, in some embodiments, the second entity <b>20</b> may optionally comprise a memory <b>24</b>. The memory <b>24</b> of the second entity <b>20</b> can comprise a volatile memory or a non-volatile memory. In some embodiments, the memory <b>24</b> of the second entity <b>20</b> may comprise a non-transitory media. Examples of the memory <b>24</b> of the second entity <b>20</b> include, but are not limited to, a random access memory (RAM), a read only memory (ROM), a mass storage media such as a hard disk, a removable storage media such as a compact disk (CD) or a digital video disk (DVD), and/or any other memory.</p><p id="p-0079" num="0078">The processing circuitry <b>22</b> of the second entity <b>20</b> can be connected to the memory <b>24</b> of the second entity <b>20</b>. In some embodiments, the memory <b>24</b> of the second entity <b>20</b> may be for storing program code or instructions which, when executed by the processing circuitry <b>22</b> of the second entity <b>20</b>, cause the second entity <b>20</b> to operate in the manner described herein in respect of the second entity <b>20</b>. For example, in some embodiments, the memory <b>24</b> of the second entity <b>20</b> may be configured to store program code or instructions that can be executed by the processing circuitry <b>22</b> of the second entity <b>20</b> to cause the second entity <b>20</b> to operate in accordance with the method described herein in respect of the second entity <b>20</b>. Alternatively or in addition, the memory <b>24</b> of the second entity <b>20</b> can be configured to store any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein. The processing circuitry <b>22</b> of the second entity <b>20</b> may be configured to control the memory <b>24</b> of the second entity <b>20</b> to store any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein.</p><p id="p-0080" num="0079">In some embodiments, as illustrated in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the second entity <b>20</b> may optionally comprise a communications interface <b>26</b>. The communications interface <b>26</b> of the second entity <b>20</b> can be connected to the processing circuitry <b>22</b> of the second entity <b>20</b> and/or the memory <b>24</b> of second entity <b>20</b>. The communications interface <b>26</b> of the second entity <b>20</b> may be operable to allow the processing circuitry <b>22</b> of the second entity <b>20</b> to communicate with the memory <b>24</b> of the second entity <b>20</b> and/or vice versa. Similarly, the communications interface <b>26</b> of the second entity <b>20</b> may be operable to allow the processing circuitry <b>22</b> of the second entity <b>20</b> to communicate with the first entity <b>10</b>, the third entity, and/or any other entity of the network. The communications interface <b>26</b> of the second entity <b>20</b> can be configured to transmit and/or receive any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein. In some embodiments, the processing circuitry <b>22</b> of the second entity <b>20</b> may be configured to control the communications interface <b>26</b> of the second entity <b>20</b> to transmit and/or receive any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein.</p><p id="p-0081" num="0080">Although the second entity <b>20</b> is illustrated in <figref idref="DRAWINGS">FIG. <b>3</b></figref> as comprising a single memory <b>24</b>, it will be appreciated that the second entity <b>20</b> may comprise at least one memory (i.e. a single memory or a plurality of memories) <b>24</b> that operate in the manner described herein. Similarly, although the second entity <b>20</b> is illustrated in <figref idref="DRAWINGS">FIG. <b>3</b></figref> as comprising a single communications interface <b>26</b>, it will be appreciated that the second entity <b>20</b> may comprise at least one communications interface (i.e. a single communications interface or a plurality of communications interface) <b>26</b> that operate in the manner described herein. It will also be appreciated that <figref idref="DRAWINGS">FIG. <b>3</b></figref> only shows the components required to illustrate an embodiment of the second entity <b>20</b> and, in practical implementations, the second entity <b>20</b> may comprise additional or alternative components to those shown.</p><p id="p-0082" num="0081"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flowchart illustrating a method performed by a second entity <b>20</b> in accordance with an embodiment. The method is for authenticating the first entity <b>10</b> with the second entity <b>20</b>. The second entity <b>20</b> described earlier with reference to <figref idref="DRAWINGS">FIG. <b>3</b></figref> is configured to operate in accordance with the method of <figref idref="DRAWINGS">FIG. <b>4</b></figref>. The method can be performed by or under the control of the processing circuitry <b>22</b> of the second entity <b>20</b>.</p><p id="p-0083" num="0082">As the contextual information for the first entity <b>10</b> is dynamic and can vary (or change) over time, the contextual information for the first entity <b>10</b> used to generate the first authentication token needs to be verified. Thus, as illustrated at block <b>202</b> of <figref idref="DRAWINGS">FIG. <b>4</b></figref>, in response to receiving an authentication request message from a first entity <b>10</b> of the network requesting authentication of the first entity <b>10</b> with the second entity <b>20</b> (wherein the authentication request message comprises a first authentication token and a timestamp for contextual information, e.g. one or more contextual parameters, for the first entity <b>10</b> used to generate the first authentication token), transmission of a verification request message is initiated towards a third entity. The verification request message requests verification of the authentication request message. For example, the verification request message can request whether the acquired contextual information for the first entity <b>10</b> matches contextual information for the first entity <b>10</b> stored in a database.</p><p id="p-0084" num="0083">In some embodiments, the verification request message can comprise the same or similar contents as the authentication request message. For example, the verification request message may comprise the same contents as the authentication request message but in a different predetermined order. As mentioned earlier, the authentication request message comprises the first authentication token and the timestamp used to generate the authentication token for use in the authentication. Thus, the verification request message comprises the first authentication token and the timestamp for use in the verification. As also mentioned earlier, in some embodiments, the authentication request message may further comprise the identification information for the first entity <b>10</b> and the identification information for the second entity <b>20</b>. Thus, in some embodiments, the verification request message may further comprise the identification information for the first entity <b>10</b> and the identification information for the second entity <b>20</b>. In some embodiments, transmission of the verification request message towards the third entity may be initiated via the second (e.g. out-of-band) communication channel described earlier.</p><p id="p-0085" num="0084">Returning back to <figref idref="DRAWINGS">FIG. <b>4</b></figref>, at block <b>204</b>, a verification response message is received from the third entity. The verification response message is indicative of whether verification of the authentication request message is successful. For example, the verification response message may comprise an indication that the verification of the authentication message is successful or unsuccessful. The verification response message may be received through the second (e.g. out-of-band) communication channel described earlier. As mentioned earlier, in some embodiments, the second communication channel may be a smart grid communication channel. Thus, a smart grid infrastructure can be used in verifying acquired contextual information according to some embodiments.</p><p id="p-0086" num="0085">In some embodiments, the verification response message may also comprise a first verification token and a timestamp for contextual information used to generate the first verification token. In some embodiments, the verification response message may further comprise the identification information for the first entity <b>10</b>, the identification information for the second entity <b>20</b>. The second entity <b>20</b> either authenticates the first entity <b>10</b> or rejects the first authorisation request based on the verification response message. Thus, the second entity <b>20</b> receives the verification response message and either authenticates the first entity <b>10</b> or rejects the first authorisation request accordingly.</p><p id="p-0087" num="0086">At block <b>206</b> of <figref idref="DRAWINGS">FIG. <b>4</b></figref>, transmission of an authentication response message is initiated towards the first entity <b>10</b>. The authentication response message indicates that authentication of the first entity <b>10</b> with the second entity <b>20</b> is successful if verification of the authentication request message is successful or indicates that authentication of the first entity <b>10</b> with the second entity <b>20</b> is unsuccessful if verification of the authentication request message is unsuccessful. For example, the authentication response message may comprise an indication that the authentication of the first entity <b>10</b> with the second entity <b>20</b> is successful (e.g. True) or unsuccessful (e.g. False). Thus, the first entity <b>10</b> is only authenticated with the second entity <b>20</b> if it can provide the correct contextual information for itself.</p><p id="p-0088" num="0087">In some embodiments, the authentication response message can also comprise the first verification token. In some embodiments, the authentication response message may further comprise any one or more of the identification information for the first entity <b>10</b> and the identification information for the second entity <b>20</b>. In some embodiments, the transmission of the authentication response message may be initiated through the first (e.g. in-band) communication channel described earlier.</p><p id="p-0089" num="0088"><figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates a third entity <b>30</b> of a network in accordance with an embodiment. The third entity <b>30</b> is for authenticating a first entity <b>10</b> with a second entity <b>20</b>. The third entity <b>30</b> can be an entity of a trusted party or body, e.g. a trusted third party or body. In some embodiments, the third entity <b>30</b> may be a central entity of the network, such as a distribution system operator (DSO) node, e.g. of a smart grid infrastructure of any other infrastructure.</p><p id="p-0090" num="0089">As illustrated in <figref idref="DRAWINGS">FIG. <b>5</b></figref>, the third entity <b>30</b> comprises processing circuitry (or logic) <b>32</b>.</p><p id="p-0091" num="0090">The processing circuitry <b>32</b> controls the operation of the third entity <b>30</b> and can implement the method described herein. The processing circuitry <b>32</b> can comprise one or more processors, processing units, multi-core processors or modules that are configured or programmed to control the third entity <b>30</b> in the manner described herein. In particular implementations, the processing circuitry <b>32</b> of the third entity <b>30</b> can comprise a plurality of software and/or hardware modules that are each configured to perform, or are for performing, individual or multiple steps of the method described herein.</p><p id="p-0092" num="0091">Briefly, the processing circuitry <b>32</b> of the third entity <b>30</b> is configured to, in response to receiving a verification request message from a second entity <b>20</b> of a network requesting verification of an authentication request message (wherein the verification request message comprises a first authentication token for a first entity <b>10</b> and a timestamp for contextual information for the first entity used to generate the first authentication token), generate a second authentication token using contextual information stored in a database for the first entity <b>10</b> of the network with the timestamp. The processing circuitry <b>32</b> of the third entity <b>30</b> is configured to check whether the second authentication token is the same as the first authentication token or different to the first authentication token and initiate transmission of a verification response message towards the second entity <b>20</b>. The verification response message indicates that verification of the authentication request message is successful if the second authentication token is the same as the first authentication token or indicates that verification of the authentication request message is unsuccessful if the second authentication token is different to the first authentication token.</p><p id="p-0093" num="0092">As illustrated in <figref idref="DRAWINGS">FIG. <b>5</b></figref>, in some embodiments, the third entity <b>30</b> may optionally comprise a memory <b>34</b>. The memory <b>34</b> of the third entity <b>30</b> can comprise a volatile memory or a non-volatile memory. In some embodiments, the memory <b>34</b> of the third entity <b>30</b> may comprise a non-transitory media. Examples of the memory <b>34</b> of the third entity <b>30</b> include, but are not limited to, a random access memory (RAM), a read only memory (ROM), a mass storage media such as a hard disk, a removable storage media such as a compact disk (CD) or a digital video disk (DVD), and/or any other memory.</p><p id="p-0094" num="0093">The processing circuitry <b>32</b> of the third entity <b>30</b> can be connected to the memory <b>34</b> of the third entity <b>30</b>. In some embodiments, the memory <b>34</b> of the third entity <b>30</b> may be for storing program code or instructions which, when executed by the processing circuitry <b>32</b> of the third entity <b>30</b>, cause the third entity <b>30</b> to operate in the manner described herein in respect of the third entity <b>30</b>. For example, in some embodiments, the memory <b>34</b> of the third entity <b>30</b> may be configured to store program code or instructions that can be executed by the processing circuitry <b>32</b> of the third entity <b>30</b> to cause the third entity <b>30</b> to operate in accordance with the method described herein in respect of the third entity <b>30</b>. Alternatively or in addition, the memory <b>34</b> of the third entity <b>30</b> can be configured to store any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein. The processing circuitry <b>32</b> of the third entity <b>30</b> may be configured to control the memory <b>34</b> of the third entity <b>30</b> to store any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein.</p><p id="p-0095" num="0094">In some embodiments, as illustrated in <figref idref="DRAWINGS">FIG. <b>5</b></figref>, the third entity <b>30</b> may optionally comprise a communications interface <b>36</b>. The communications interface <b>36</b> of the third entity <b>30</b> can be connected to the processing circuitry <b>32</b> of the third entity <b>30</b> and/or the memory <b>34</b> of third entity <b>30</b>. The communications interface <b>36</b> of the third entity <b>30</b> may be operable to allow the processing circuitry <b>32</b> of the third entity <b>30</b> to communicate with the memory <b>34</b> of the third entity <b>30</b> and/or vice versa. Similarly, the communications interface <b>36</b> of the third entity <b>30</b> may be operable to allow the processing circuitry <b>32</b> of the third entity <b>30</b> to communicate with the first entity <b>10</b>, the second entity <b>20</b>, and/or any other entity of the network. The communications interface <b>36</b> of the third entity <b>30</b> can be configured to transmit and/or receive any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein. In some embodiments, the processing circuitry <b>32</b> of the third entity <b>30</b> may be configured to control the communications interface <b>36</b> of the third entity <b>30</b> to transmit and/or receive any messages, requests, responses, indications, information, data, notifications, signals, or similar, that are described herein.</p><p id="p-0096" num="0095">Although the third entity <b>30</b> is illustrated in <figref idref="DRAWINGS">FIG. <b>5</b></figref> as comprising a single memory <b>34</b>, it will be appreciated that the third entity <b>30</b> may comprise at least one memory (i.e. a single memory or a plurality of memories) <b>34</b> that operate in the manner described herein. Similarly, although the third entity <b>30</b> is illustrated in <figref idref="DRAWINGS">FIG. <b>5</b></figref> as comprising a single communications interface <b>36</b>, it will be appreciated that the third entity <b>30</b> may comprise at least one communications interface (i.e. a single communications interface or a plurality of communications interface) <b>36</b> that operate in the manner described herein. It will also be appreciated that <figref idref="DRAWINGS">FIG. <b>5</b></figref> only shows the components required to illustrate an embodiment of the third entity <b>30</b> and, in practical implementations, the third entity <b>30</b> may comprise additional or alternative components to those shown.</p><p id="p-0097" num="0096"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a flowchart illustrating a method performed by a third entity <b>30</b> in accordance with an embodiment. The method is for authenticating a first entity <b>10</b> with a second entity <b>20</b>. The third entity <b>30</b> described earlier with reference to <figref idref="DRAWINGS">FIG. <b>5</b></figref> is configured to operate in accordance with the method of <figref idref="DRAWINGS">FIG. <b>6</b></figref>. The method can be performed by or under the control of the processing circuitry <b>32</b> of the third entity <b>30</b>.</p><p id="p-0098" num="0097">As illustrated at block <b>302</b> of <figref idref="DRAWINGS">FIG. <b>6</b></figref>, in response to receiving a verification request message from a second entity <b>20</b> of a network requesting verification of an authentication request message (wherein the verification request message comprises a first authentication token for a first entity <b>10</b> and a timestamp for contextual information for the first entity, e.g. one or more contextual parameters, used to generate the first authentication token), a second authentication token is generated using contextual information stored in a database for the first entity <b>10</b> of the network with the timestamp. More specifically, the processing circuitry <b>32</b> of the third entity <b>30</b> generates the second authentication token using contextual information stored in a database for the first entity <b>10</b> of the network with the timestamp. In some embodiments, the memory <b>14</b> of the first entity <b>10</b> may comprise the database. In other embodiments, a memory separate to (e.g. remote from or external to) the first entity <b>10</b> may comprise the database. In some embodiments, the contextual information stored in a database for the first entity <b>10</b> of the network with the timestamp and the timestamp for the contextual information may be represented as a tuple.</p><p id="p-0099" num="0098">In some embodiments, the contextual information stored in the database for the first entity <b>10</b> with the timestamp may comprise any one or more of utility consumption information for the first entity <b>10</b> such as that described earlier, environmental information for the first entity <b>10</b> such as that described earlier, location information for the first entity <b>10</b> such as that described earlier, neighbourhood information for the first entity <b>10</b> such as that described earlier, and network information for the first entity <b>10</b> such as that described earlier.</p><p id="p-0100" num="0099">In some embodiments, the method may comprise generating the second authentication token using the contextual information stored in the database for the first entity <b>10</b> with the timestamp and any one or more of the timestamp for the contextual information (e.g. from the verification request message), a random number (e.g. a pseudo random number) stored in the database for the first entity <b>10</b> with the timestamp, identification information for the first entity <b>10</b> as described earlier (e.g. from the verification request message), and identification information for the second entity <b>20</b> as described earlier (e.g. from the verification request message). In some embodiments, the second authentication token may be generated using the tuple (representing the contextual information stored in the database for the first entity <b>10</b> with the timestamp and the timestamp for the contextual information) and any one or more of the timestamp for the contextual information, the random number stored in the database for the first entity <b>10</b> with the timestamp, the identification information for the first entity <b>10</b>, and the identification information for the second entity <b>20</b>. In some embodiments, the second authentication token may have a hash function or HMAC applied to it.</p><p id="p-0101" num="0100">In some embodiments involving a random number, the random number may be acquired from a (e.g. pseudo) random number generator that generated the random number for the first entity <b>10</b>. In some embodiments, one or more of the sensors (e.g. one or more sensor of one or more smart meters) may comprise this random number generator. In some embodiments, the second authentication token may be generated using the contextual information stored in the database for the first entity <b>10</b> with the timestamp for the contextual information and optionally also any one or more of the timestamp, the identification information for the first entity <b>10</b>, and the identification information for the second entity <b>20</b>, and the random number stored in the database for the first entity <b>10</b> with the timestamp may be inserted into the generated second authentication token. This use of a random number can increase the strength of the unpredictability of the second authentication token.</p><p id="p-0102" num="0101">Returning back to <figref idref="DRAWINGS">FIG. <b>6</b></figref>, at block <b>304</b>, it is checked whether the second authentication token is the same as the first authentication token or different to the first authentication token. More specifically, the processing circuitry <b>32</b> of the third entity <b>30</b> performs this check. In some embodiments, the processing circuitry <b>32</b> of the third entity <b>30</b> may also be configured to check if the timestamp for the contextual information is timely, i.e. is recent enough or belongs to the last time interval that can be optimized accordingly to prevent replay attacks.</p><p id="p-0103" num="0102">At block <b>306</b> of <figref idref="DRAWINGS">FIG. <b>6</b></figref>, transmission of a verification response message is initiated towards the second entity <b>20</b>. More specifically, the processing circuitry <b>32</b> of the third entity <b>30</b> initiates transmission of the verification response message. The verification response message indicates that verification of the authentication request message is successful if the second authentication token is the same as the first authentication token or indicates that verification of the authentication request message is unsuccessful if the second authentication token is different to the first authentication token. For example, the verification response message may comprise an indication that the verification of the authentication message is successful or unsuccessful. In some embodiments, transmission of the verification response message towards the second entity <b>20</b> may be initiated via the second (e.g. out-of-band) communication channel descried earlier.</p><p id="p-0104" num="0103">Although not illustrated in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, in some embodiments, a first verification token may be generated using the contextual information stored in the database for the first entity <b>10</b> with the timestamp. More specifically, the processing circuitry <b>32</b> of the third entity <b>30</b> can be configured to generate the first verification token according to some embodiments. In some embodiments, the first verification token may be generated using the contextual information stored in the database for the first entity <b>10</b> with the timestamp and any one or more of the time stamp for the contextual information, the identification information for the first entity <b>10</b>, the identification information for the second entity <b>20</b> and an indication that the verification of the authentication message is successful or unsuccessful. In some embodiments, the first verification token may be generated using the tuple (representing the contextual information stored in the database for the first entity <b>10</b> with the timestamp and the timestamp for the contextual information), and any one or more of the time stamp for the contextual information (from the verification request message), the identification information for the first entity <b>10</b> (from the verification request message), the identification information (from the verification request message) and the indication that the verification of the authentication message is successful (e.g. True) or unsuccessful (e.g. False).</p><p id="p-0105" num="0104">In some embodiments, the verification response message may also comprise the first verification token and the timestamp for the contextual information used to generate the first verification token. In some embodiments, the verification response message may further comprise any one or more of the identification information for the first entity <b>10</b> described earlier and the identification information for the second entity <b>20</b> described earlier. In some embodiments, the first verification token may have a hash function or HMAC applied to it. In this way, it is possible to enable verification of the integrity of the verification response message.</p><p id="p-0106" num="0105">Although not illustrated in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, in some embodiments, the method may comprise (e.g. prior to block <b>302</b>) acquiring the contextual information for the first entity <b>10</b>, the timestamp for the contextual information (and optionally also the random number for the first entity <b>10</b> with the timestamp), e.g. from the first entity <b>10</b> of the network. More specifically, the processing circuitry <b>32</b> of the third entity <b>30</b> can be configured to acquire the contextual information for the first entity <b>10</b>, the timestamp for the contextual information (and optionally also the random number for the first entity <b>10</b> with the timestamp) according to some embodiments. The contextual information for the first entity <b>10</b>, the timestamp for the contextual information (and optionally also the random number for the first entity <b>10</b> with the timestamp) may be acquired periodically or on-demand. The contextual information for the first entity <b>10</b> may be acquired instantaneously or in real time (or near real time).</p><p id="p-0107" num="0106">In some embodiments, the contextual information for the first entity <b>10</b>, the timestamp for the contextual information (and optionally also the random number with for the first entity <b>10</b> the timestamp) may be acquired via a second communication channel. In some embodiments, the second communication channel via which the contextual information for the first entity <b>10</b>, the timestamp for the contextual information (and optionally also the random number for the first entity <b>10</b> with the timestamp) is acquired may be the second (e.g. out-of-band) communication channel described earlier.</p><p id="p-0108" num="0107">Although also not illustrated in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, in some of these embodiments, the method may comprise controlling the database to store the acquired contextual information for the first entity <b>10</b> (and optionally also the random number for the first entity <b>10</b>) with the timestamp. More specifically, the processing circuitry <b>32</b> of the third entity <b>30</b> can be configured to control the database to store the acquired contextual information for the first entity <b>10</b> (and optionally also the random number for the first entity <b>10</b>) with the timestamp. Thus, in some embodiments, the processing circuitry <b>32</b> of the third entity <b>30</b> can be configured to collect and store contextual information for the first entity <b>10</b> (and optionally also random numbers for the first entity <b>10</b>) over time, with corresponding timestamps for the contextual information (and random numbers). In this way, the processing circuitry <b>32</b> of the third entity <b>30</b> can then check the stored contextual information (and optionally also the random numbers for the first entity <b>10</b>) and corresponding timestamps for the verification process described earlier. In some embodiments, the processing circuitry <b>32</b> of the third entity <b>30</b> can be configured to (e.g. continuously) monitor contextual information for the first entity <b>10</b> (and optionally also random numbers for the first entity <b>10</b>) and store the contextual information (and optionally also the random numbers for the first entity <b>10</b>) with a timestamp for the contextual information (and random numbers) at regular intervals, such as a time interval of the order of seconds or a more granular or adaptive time resolution. Thus, the third entity <b>30</b> can be configured to maintain (recent) contextual information (and optionally also random numbers) in the database.</p><p id="p-0109" num="0108">In some embodiments, the processing circuitry <b>32</b> of the third entity <b>30</b> can be configured to delete contextual information (and optionally also any random numbers) from the database that has been stored for more than a predefined amount of time. That is, the database does not need to maintain all contextual information (or all random numbers) including that with earlier dates. It is enough for the database to maintain only recent contextual information (and optionally also recent random numbers). In this way, space and memory requirements can be reduced, and the processing circuitry <b>32</b> of the third entity <b>30</b> can access contextual information (and optionally also a random number) from database faster when performing the check of whether the second authentication token is the same as the first authentication token or different to the first authentication token.</p><p id="p-0110" num="0109">In some embodiments, in addition to storing contextual information (and optionally also random numbers) and corresponding timestamps for the first entity <b>10</b>, the database may also store contextual information (and optionally also random numbers) and corresponding timestamps for other entities (e.g. for the second entity <b>20</b> and/or one or more other entities). The contextual information (and optionally also random numbers) and corresponding timestamps for an entity may be stored in the database with an identity (ID) of the entity. An example of the structure of such a database is shown in the following table, which may also be referred to as &#x201c;Table 1&#x201d;.</p><p id="p-0111" num="0000"><tables id="TABLE-US-00001" num="00001"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="9"><colspec colname="1" colwidth="21pt" align="left"/><colspec colname="2" colwidth="42pt" align="left"/><colspec colname="3" colwidth="28pt" align="left"/><colspec colname="4" colwidth="21pt" align="left"/><colspec colname="5" colwidth="28pt" align="left"/><colspec colname="6" colwidth="28pt" align="left"/><colspec colname="7" colwidth="42pt" align="left"/><colspec colname="8" colwidth="42pt" align="left"/><colspec colname="9" colwidth="42pt" align="left"/><thead><row><entry namest="1" nameend="9" align="center" rowsep="1"/></row><row><entry/><entry/><entry/><entry/><entry/><entry/><entry>Other</entry><entry>Other</entry><entry>Other</entry></row><row><entry>Entity</entry><entry/><entry>Power</entry><entry>Power</entry><entry>Current</entry><entry>Random</entry><entry>Contextual</entry><entry>Contextual</entry><entry>Contextual</entry></row><row><entry>ID</entry><entry>Timestamp</entry><entry>(mW)</entry><entry>Factor</entry><entry>(mA)</entry><entry>Number</entry><entry>information</entry><entry>information</entry><entry>information</entry></row><row><entry namest="1" nameend="9" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>ID 1</entry><entry>2019.06.10</entry><entry>&#x2003;&#x2002;663</entry><entry>1.0</entry><entry>&#x2003;3</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry></row><row><entry/><entry>10:05:16</entry><entry/><entry/><entry/><entry/><entry/><entry/><entry/></row><row><entry/><entry>2019.06.10</entry><entry>&#x2003;2640</entry><entry>0.986</entry><entry>&#x2002;12</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry></row><row><entry/><entry>10:05:15</entry><entry/><entry/><entry/><entry/><entry/><entry/><entry/></row><row><entry/><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry></row><row><entry>ID 2</entry><entry>2019.06.10</entry><entry>136968</entry><entry>0.829</entry><entry>312</entry><entry/><entry/><entry/><entry/></row><row><entry/><entry>10:05:16</entry><entry/><entry/><entry/><entry/><entry/><entry/><entry/></row><row><entry/><entry>2019.06.10</entry><entry>137720</entry><entry>0.830</entry><entry>313</entry><entry/><entry/><entry/><entry/></row><row><entry/><entry>10:05:15</entry><entry/><entry/><entry/><entry/><entry/><entry/><entry/></row><row><entry/><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry></row><row><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry></row><row><entry/><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry></row><row><entry>ID n</entry><entry>yyyy.mm.dd</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry></row><row><entry/><entry>hh:mm:ss</entry><entry/><entry/><entry/><entry/><entry/><entry/><entry/></row><row><entry/><entry>yyyy.mm.dd</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry></row><row><entry/><entry>hh:mm:ss</entry><entry/><entry/><entry/><entry/><entry/><entry/><entry/></row><row><entry/><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry><entry>. . .</entry></row><row><entry namest="1" nameend="9" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0112" num="0110">The example of the database shown in Table 1 includes electricity consumption information (and a random number) together with the corresponding timestamps for that electricity consumption information (and random number) for a plurality of entities. As shown in Table 1, there may be a plurality of parameters related to electricity consumption information, such as an instantaneous power consumption, a current drain, a power factor and/or any other parameter(s) related to electricity consumption information.</p><p id="p-0113" num="0111">Although electricity consumption information has been used to illustrate an example structure for the database referred to herein, it will be understood that the database may alternatively or additionally comprise any other types of contextual information, such as any of the contextual information described earlier. The contextual information stored in the database described herein is temporal in that each of parameter changes over time, e.g. depending on factors such as the type of entity, the state of the entity, the number of entities connected to a sensor (e.g. of a smart meter) and/or any other factors.</p><p id="p-0114" num="0112"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is an example of contextual information according to an embodiment. As illustrated in <figref idref="DRAWINGS">FIG. <b>7</b></figref>, in some embodiments, the contextual information may comprise utility consumption information (or data) for the first entity <b>10</b>. In this example, the utility consumption information for the first entity <b>10</b> is electricity consumption information for the first entity <b>10</b>, which may comprise a power for the first entity <b>10</b> (e.g. measured in mW), an active power for the first entity <b>10</b> (e.g. measured in mW), a reactive power for the first entity <b>10</b> (e.g. measured in mVA), a power factor for the first entity <b>10</b>, a current for the first entity <b>10</b> (e.g. measured in mA), a frequency for the first entity <b>10</b> (e.g. measured in Hz), a phase for the first entity <b>10</b>, and/or any other electricity (and/or gas and/or water) consumption information for the first entity <b>10</b>. As also illustrated in <figref idref="DRAWINGS">FIG. <b>7</b></figref>, in some embodiments, the contextual information for the first entity <b>10</b> may alternatively or additionally comprise environmental information for the first entity <b>10</b>, network information for the first entity <b>10</b>, location information for the first entity <b>10</b>, a random number and/or any other contextual information for the first entity <b>10</b>. As illustrated in <figref idref="DRAWINGS">FIG. <b>7</b></figref>, the contextual information (and random number) is timestamped.</p><p id="p-0115" num="0113">There is also provided a network comprising one or more first entities <b>10</b> as described earlier with reference to <figref idref="DRAWINGS">FIGS. <b>1</b> and <b>2</b></figref>, one or more second entities <b>20</b> as described earlier with reference to <figref idref="DRAWINGS">FIGS. <b>3</b> and <b>4</b></figref>, and/or one or more third entities <b>30</b> as described earlier with reference to <figref idref="DRAWINGS">FIGS. <b>5</b> and <b>6</b></figref>.</p><p id="p-0116" num="0114"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a block diagram illustrating such a network according to an embodiment.</p><p id="p-0117" num="0115">As illustrated in <figref idref="DRAWINGS">FIG. <b>8</b></figref>, the network comprises the first entity <b>10</b> as described earlier with reference to <figref idref="DRAWINGS">FIG. <b>1</b></figref>. The first entity <b>10</b> can, for example, be a machine or device. The embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>8</b></figref> shows a manner in which contextual information may be acquired by the first entity <b>10</b>.</p><p id="p-0118" num="0116">For example, as illustrated in <figref idref="DRAWINGS">FIG. <b>8</b></figref>, the network may also comprise a plurality of sensors <b>40</b>, <b>50</b>, <b>60</b>, <b>70</b>, <b>80</b>. In the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>8</b></figref>, the plurality of sensors comprises a sensor of a smart meter <b>40</b> (from which utility consumption information for the first entity <b>10</b> can be acquired), a sensor of a router <b>70</b> (from which network information for the first entity <b>10</b> can be acquired), a GPS sensor <b>80</b> (from which location information for the first entity <b>10</b> can be acquired), and two other sensors <b>50</b>, <b>60</b> (e.g. from which neighbourhood information for the first entity <b>10</b> and/or any other contextual information for the first entity <b>10</b> can be acquired).</p><p id="p-0119" num="0117">As illustrated in <figref idref="DRAWINGS">FIG. <b>8</b></figref>, each of the plurality of sensors can communicate with the first entity <b>10</b>, e.g. via a data connection and/or a grid connection (which may be via an electricity cable in some embodiments). Although examples have been provided for the one or more sensors from which the contextual information may be acquired, it will be understood that there may be any other number of sensors, any other type(s) of sensor, and/or any combination of sensors. The first entity <b>10</b> of the network illustrated in <figref idref="DRAWINGS">FIG. <b>8</b></figref> operates in the manner described earlier with reference to <figref idref="DRAWINGS">FIG. <b>2</b></figref>.</p><p id="p-0120" num="0118"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a block diagram illustrating another such a network according to an embodiment. As illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the network comprises the first entity <b>10</b> as described earlier with reference to <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the second entity <b>20</b> as described earlier with reference to <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the third entity <b>30</b> as described earlier with reference to <figref idref="DRAWINGS">FIG. <b>5</b></figref>. As mentioned earlier, in some embodiments, the third entity <b>30</b> may be a central entity of the network such as a DSO node.</p><p id="p-0121" num="0119">In the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the first entity <b>10</b> comprises a first device or machine (D<b>1</b>) <b>404</b> and the second entity <b>20</b> comprises a second device or machine (D<b>2</b>) <b>406</b>. The first entity <b>10</b> (or, more specifically, the first device or machine <b>404</b> of the first entity <b>10</b>) and the second entity <b>20</b> (or, more specifically, the second device or machine <b>406</b> of the second entity <b>20</b>) can communicate via the first communication channel <b>402</b>, which may be a primary communication channel. The dashed lines in <figref idref="DRAWINGS">FIG. <b>9</b></figref> represent communication via the first communication channel <b>402</b>.</p><p id="p-0122" num="0120">As illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, there can be an information exchange protocol between the first entity <b>10</b> (or, more specifically, the first device or machine <b>404</b> of the first entity <b>10</b>) and the third entity <b>30</b>. Similarly, as illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, there can be an information exchange protocol between the second entity <b>20</b> (or, more specifically, the second device or machine <b>406</b> of the second entity <b>20</b>) and the third entity <b>30</b>. It may be assumed that there is a secure communication and data exchange protocol between the first entity <b>10</b> and the third entity <b>30</b>, and/or between the second entity <b>20</b> and the third entity <b>30</b>. For example, the first entity <b>10</b> and/or the second entity <b>20</b> can be registered entities and there may be a secure communication and data exchange protocol between registered entities and the third entity <b>30</b>. The verification of the contextual information, which is included in authentication request messages transmitted in the primary communication channel between the first entity <b>10</b> and the second entity <b>20</b>, can be performed with the data exchange protocol between the third entity and the other entities <b>10</b>, <b>20</b>.</p><p id="p-0123" num="0121">As illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, in some embodiments, the network may also comprise a first smart meter (SM<b>1</b>) <b>40</b> comprising one or more sensors and a second smart meter (SM<b>2</b>) <b>42</b> comprising one or more sensors according to some embodiments. The third entity <b>30</b> can communicate with the first smart meter <b>40</b> and the second smart meter <b>42</b> via the second communication channel <b>400</b>, e.g. a smart grid communication channel, which can be an out-of-band communication channel. Thus, in some embodiments, a smart grid infrastructure may be integrated with communication technologies. This can enable monitoring and/or measuring of electricity consumption information remotely, e.g. in real-time. The smart meter <b>40</b> can report electricity consumption information to the third entity <b>30</b>. The communication infrastructure integrated with the smart grid infrastructure can be used as the second (e.g. an out-of-band) communication channel to transmit the electricity consumption information.</p><p id="p-0124" num="0122">Generally, in a smart grid infrastructure, electricity consumption information of entities is monitored and recorded regularly by the third entity <b>30</b>. Alternatively or in addition, other contextual information may also be sent to the third entity <b>30</b>. In the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the first smart meter <b>40</b> is deployed between the first entity <b>10</b> and the third entity <b>30</b>, and the second smart meter <b>42</b> is deployed between the second entity <b>20</b> and the third entity <b>30</b>. The first smart meter <b>40</b> and the second smart meter <b>42</b> can be configured to measure contextual information (e.g. electricity consumption information or any other contextual information) for the first entity <b>10</b> and the second entity <b>20</b> respectively, and transmit the measured contextual information to the third entity <b>30</b>. In this way, the third entity <b>30</b> can build the database of contextual information with corresponding timestamps (or temporal information).</p><p id="p-0125" num="0123">Although a smart grid infrastructure and electricity consumption information have been provided as an example, it will be understood that the same concepts can also be applied to any other infrastructure and any other contextual information.</p><p id="p-0126" num="0124">As illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the third entity <b>30</b> can acquire contextual information from the first smart meter <b>40</b> and/or the second smart meter <b>42</b>, e.g. via the second communication channel <b>400</b>. The solid lines in <figref idref="DRAWINGS">FIG. <b>9</b></figref> represent communication via the second communication channel <b>400</b>. The first communication channel <b>402</b> and the second communication channel <b>400</b> are separate from each other in the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref>. They can belong to any wired or wireless communication technologies. The first entity <b>10</b> (or, more specifically, the first device or machine <b>404</b> of the first entity <b>10</b>) of the network illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref> operates in the manner described earlier with reference to <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the second entity <b>20</b> (or, more specifically, the second device or machine <b>406</b> of the second entity <b>20</b>) of the network illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref> operates in the manner described earlier with reference to <figref idref="DRAWINGS">FIG. <b>4</b></figref>, and the third entity <b>30</b> of the network illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref> operates in the operates in the manner described earlier with reference to <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0127" num="0125"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a signalling (or call flow) diagram illustrating an exchange of signals in an example embodiment. The exchange of signals is in a network, such as the network illustrated in <figref idref="DRAWINGS">FIG. <b>9</b></figref>. The network illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref> comprises a first entity <b>10</b> as described earlier with reference to <figref idref="DRAWINGS">FIG. <b>1</b></figref>, a second entity <b>20</b> as described earlier with reference to <figref idref="DRAWINGS">FIG. <b>3</b></figref>, and a third entity (such as a DSO node) <b>30</b> as described earlier with reference to <figref idref="DRAWINGS">FIG. <b>5</b></figref>. According to some embodiments, the first entity <b>10</b> can comprise a first device or machine and the second entity <b>20</b> can comprise a second device or machine. The first entity <b>10</b> (or, more specifically, the first device or machine of the first entity <b>10</b>) and the second entity <b>20</b> (or, more specifically, the second device or machine of the second entity <b>20</b>) can communicate via a first communication channel as described earlier.</p><p id="p-0128" num="0126">Although not illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, contextual information for the first entity <b>10</b> of the network and a timestamp for the contextual information is acquired by the first entity <b>10</b> of the network in the manner described earlier. As illustrated by arrows <b>500</b> and <b>504</b> of <figref idref="DRAWINGS">FIG. <b>10</b></figref>, in some embodiments, the third entity <b>30</b> of the network can acquire contextual information for the first entity <b>10</b> of the network (such as any of the contextual information described earlier) and a timestamp for the contextual information. For example, the third entity <b>30</b> of the network may acquire contextual information for the first entity <b>10</b> of the network with a first timestamp t<sub>i&#x2212;1 </sub>as illustrated by arrow <b>500</b> and contextual information for the first entity <b>10</b> of the network with a second timestamp t as illustrated by the arrow <b>504</b>. The first timestamp and the second timestamp can be different. For example, the first timestamp can be earlier than the second timestamp.</p><p id="p-0129" num="0127">In the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, contextual information for the first entity <b>10</b> of the network and a corresponding timestamp for the contextual information is represented as a tuple. For example, if e(D<sub>k</sub>,t<sub>i</sub>) is a tuple representing the contextual information with timestamp t for an entity D<sub>k </sub>and assuming e(D<sub>k</sub>,t<sub>i</sub>) contains similar contextual information to that included in a single row of Table 1, the tuple representing this contextual information and timestamp may be formulated as follows:</p><p id="p-0130" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>e</i>(<i>D</i>1,<i>t</i><sub>i</sub>)=&#x3c;<i>t</i><sub>i</sub><i>,P,PF,C,O</i>1,<i>O</i>2,<i>O</i>3,<i>O</i>4&#x3e;,<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0131" num="0000">where D<b>1</b> is the first entity <b>10</b>, t is the timestamp for the contextual information, P is an instantaneous power consumption for the first entity <b>10</b>, PF is a power factor for the first entity <b>10</b>, C is a current drain for the first entity <b>10</b>, O<b>1</b> is other contextual information <b>1</b> for the first entity <b>10</b>, O<b>2</b> is other contextual information <b>2</b> for the first entity <b>10</b>, O<b>3</b> is other contextual information <b>3</b> for the first entity <b>10</b> and O<b>4</b> is other contextual information <b>4</b> for the first entity <b>10</b>.</p><p id="p-0132" num="0128">Although also not illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, contextual information for the second entity <b>20</b> of the network and a timestamp for the contextual information may be acquired by the second entity <b>20</b> of the network in the same manner as for the first entity <b>10</b>. As illustrated by arrows <b>502</b> and <b>506</b> of <figref idref="DRAWINGS">FIG. <b>10</b></figref>, in some embodiments, the third entity <b>30</b> of the network can acquire contextual information for the second entity <b>20</b> of the network (such as any of the contextual information described earlier) and a timestamp for the contextual information. For example, the third entity <b>30</b> of the network may acquire contextual information for the second entity <b>20</b> of the network with a third timestamp t<sub>i&#x2212;1 </sub>as illustrated by arrow <b>502</b> and contextual information for the second entity <b>20</b> of the network with a second timestamp t as illustrated by arrow <b>506</b>. The first timestamp and the second timestamp can be different. For example, the first timestamp can be earlier than the second timestamp. In some embodiments, contextual information for the second entity <b>20</b> of the network and a corresponding timestamp for the contextual information may be represented as a tuple in the same manner as described earlier with respect to the first entity <b>10</b>.</p><p id="p-0133" num="0129">Thus, in the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, the first entity <b>10</b> and the second entity <b>20</b> can send their contextual information to the third entity <b>30</b>, e.g. either periodically or on-demand. The third entity <b>30</b> can thus receive contextual information for the first entity <b>10</b> and the second entity <b>20</b>, e.g. either periodically or on-demand. The third entity <b>30</b> of the network stores the acquired contextual information.</p><p id="p-0134" num="0130">In some embodiments, the first entity <b>10</b> of the network may wish to authenticate itself with the second entity <b>20</b> of the network and the second entity <b>20</b> of the network may wish to authenticate itself with the first entity <b>10</b> of the network. Thus, the authentication may be mutual. However, for simplicity, in the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, it is the first entity <b>10</b> of the network that wishes to authenticate itself with the second entity <b>20</b> of the network.</p><p id="p-0135" num="0131">The first entity <b>10</b> thus begins an authentication procedure. In particular, although not illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, a first authentication token is generated by the first entity <b>10</b> of the network using the acquired contextual information in the manner described earlier. In the illustrated embodiment of <figref idref="DRAWINGS">FIG. <b>10</b></figref>, the first authentication token is generated by the first entity <b>10</b> of the network using the acquired contextual information, the timestamp for the contextual information, identification information D<b>1</b> for the first entity <b>10</b> such as that described earlier and identification information D<b>2</b> for the second entity <b>20</b> such as that described earlier. More specifically, the first authentication token is generated by the first entity <b>10</b> of the network using the tuple e(D<b>1</b>,t<sub>i</sub>) representing the contextual information and the timestamp for the contextual information, the timestamp t<sub>i </sub>for the contextual information, the identification information D<b>1</b> for the first entity <b>10</b> and the identification information D<b>2</b>.</p><p id="p-0136" num="0132">In order to enable verification of the message integrity, the first authentication token may have a hash function or HMAC applied to it. In the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, for example, the first authentication token comprises a HMAC applied to the tuple e(D<b>1</b>,t<sub>i</sub>) representing the contextual information and the timestamp for the contextual information, the timestamp t<sub>i </sub>for the contextual information, the identification information D<b>1</b> for the first entity <b>10</b> and the identification information D<b>2</b>. The first authentication token HMAC<b>1</b> according to the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref> can thus be expressed as:</p><p id="p-0137" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>HMAC1=HMAC(<i>e</i>(<i>D</i>1,<i>ti</i>),(<i>D</i>1,<i>ti,D</i>2)).<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0138" num="0133">As illustrated by arrow <b>508</b> of <figref idref="DRAWINGS">FIG. <b>10</b></figref>, transmission of an (e.g. integrity protected) authentication request message is initiated towards the second entity <b>20</b> of the network in the manner described earlier. The transmission of the authentication request message may be initiated through the first (e.g. in-band) communication channel described earlier. The dashed arrows in <figref idref="DRAWINGS">FIG. <b>10</b></figref> represent transmissions via the first communication channel. The authentication request message requests authentication of the first entity <b>10</b> with the second entity <b>20</b>. As described earlier, the authentication request message comprises the first authentication token HMAC<b>1</b> and the timestamp t<sub>i </sub>for the contextual information used to generate the authentication token HMAC<b>1</b>. In the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, the authentication request message further comprises the identification information D<b>1</b> for the first entity <b>10</b> and the identification information D<b>2</b> for the second entity <b>20</b>, e.g. (HMAC<b>1</b>, D<b>1</b>, t<sub>i</sub>, D<b>2</b>).</p><p id="p-0139" num="0134">As illustrated by arrow <b>510</b> of <figref idref="DRAWINGS">FIG. <b>10</b></figref>, in response to receiving the authentication request message from the first entity <b>10</b> of the network, transmission of a verification request message is initiated by the second entity <b>20</b> of the network towards the third entity <b>30</b> of the network in the manner described earlier. The transmission of the verification request message may be initiated through the second (e.g. out-of-band) communication channel described earlier. The solid arrows in <figref idref="DRAWINGS">FIG. <b>10</b></figref> represent transmissions via the second communication channel. The verification request message requests verification of the authentication request message.</p><p id="p-0140" num="0135">The verification request message can comprise the same or similar contents as the authentication request message. For example, the verification request message may comprise the same contents as the authentication request message but in a different predetermined order, e.g. (D<b>2</b>, HMAC<b>1</b>, D<b>1</b>, t<sub>i</sub>,). The verification request message can request whether the acquired contextual information for the first entity <b>10</b> matches the contextual information for the first entity <b>10</b> stored in a database.</p><p id="p-0141" num="0136">Although not illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, a second authentication token is generated by the third entity <b>30</b> of the network using the contextual information stored in the database for the first entity <b>10</b> with the timestamp in the manner described earlier. In the illustrated embodiment of <figref idref="DRAWINGS">FIG. <b>10</b></figref>, the second authentication token is generated by the third entity <b>30</b> of the network using the contextual information stored in the database for the first entity <b>10</b> with the timestamp, the timestamp t<sub>i</sub>, the identification information D<b>1</b> for the first entity <b>10</b> and the identification information D<b>2</b> for the second entity <b>20</b>. More specifically, the second authentication token is generated by the third entity <b>30</b> of the network using a tuple e(D<b>1</b>,t<sub>i</sub>) representing the contextual information stored in the database for the first entity <b>10</b> with the timestamp and the timestamp for the contextual information, the timestamp t<sub>i </sub>for the contextual information (from the verification request message), the identification information D<b>1</b> for the first entity <b>10</b> (from the verification request message) and the identification information D<b>2</b> (from the verification request message).</p><p id="p-0142" num="0137">In order to enable verification of the message integrity, the second authentication token may have a hash function or HMAC applied to it. In the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, for example, the second authentication token comprises a HMAC applied to the tuple e(D<b>1</b>,t<sub>i</sub>) representing the contextual information stored in the database for the first entity <b>10</b> and the timestamp for the contextual information, the timestamp t<sub>i </sub>for the contextual information, the identification information D<b>1</b> for the first entity <b>10</b> and the identification information D<b>2</b>.</p><p id="p-0143" num="0138">Although not illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, it is checked by the third entity <b>30</b> whether the second authentication token is the same as the first authentication token or different to the first authentication token. In some embodiments, the third entity <b>30</b> may also check if the timestamp t<sub>i </sub>is timely, i.e. t<sub>i </sub>is recent enough or belongs to the last time interval that can be optimized accordingly to prevent replay attacks.</p><p id="p-0144" num="0139">As illustrated by arrow <b>512</b> of <figref idref="DRAWINGS">FIG. <b>10</b></figref>, transmission of a verification response message is initiated by the third entity <b>30</b> of the network towards the second entity <b>20</b> of the network in the manner described earlier. The transmission of the verification response message may be initiated through the second (e.g. out-of-band) communication channel described earlier. The verification response message is received by the second entity <b>20</b> of the network from the third entity <b>30</b> of the network in the manner described earlier. The verification response message indicates that verification of the authentication request message is successful if the second authentication token is the same as the first authentication token or indicates that verification of the authentication request message is unsuccessful if the second authentication token is different to the first authentication token.</p><p id="p-0145" num="0140">Although not illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, in some embodiments, a first verification token may be generated by the third entity <b>30</b> of the network using the contextual information stored in the database for the first entity <b>10</b> with the timestamp in the manner described earlier. In the illustrated embodiment of <figref idref="DRAWINGS">FIG. <b>10</b></figref>, the first verification token is generated by the third entity <b>30</b> of the network using the contextual information stored in the database for the first entity <b>10</b> with the timestamp, the timestamp t<sub>i</sub>, the identification information D<b>1</b> for the first entity <b>10</b>, the identification information D<b>2</b> for the second entity <b>20</b> and an indication that the verification of the authentication message is successful or unsuccessful. More specifically, the first verification token is generated by the third entity <b>30</b> of the network using the tuple e(D<b>1</b>,t<sub>i</sub>) representing the contextual information stored in the database for the first entity <b>10</b> with the timestamp and the timestamp for the contextual information, the timestamp t<sub>i </sub>for the contextual information (from the verification request message), the identification information D<b>1</b> for the first entity <b>10</b> (from the verification request message), the identification information D<b>2</b> (from the verification request message) and the indication that the verification of the authentication message is successful (e.g. True) or unsuccessful (e.g. False).</p><p id="p-0146" num="0141">In order to enable verification of the message integrity, the first verification token may have a hash function or HMAC applied to it. In the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, for example, the first verification token comprises a HMAC applied to the tuple e(D<b>1</b>,t<sub>i</sub>) representing the contextual information stored in the database for the first entity <b>10</b> with the timestamp and the timestamp for the contextual information, the timestamp t<sub>i </sub>for the contextual information, the identification information D<b>1</b> for the first entity <b>10</b>, the identification information D<b>2</b>, and the indication that the verification of the authentication message is True or False. The first verification token HMAC<b>2</b> according to the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref> can thus be expressed as:</p><p id="p-0147" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>HMAC2=HMAC(<i>e</i>(<i>D</i>1,<i>ti</i>),(<i>D</i>2,<i>D</i>1,True/False)),<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0148" num="0142">As described earlier, the verification response message may comprise the first verification token HMAC<b>2</b> and the timestamp t<sub>i </sub>for the contextual information used to generate the first verification token HMAC<b>2</b>. In the embodiment illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, the verification response message further comprises the identification information D<b>1</b> for the first entity <b>10</b>, the identification information D<b>2</b> for the second entity <b>20</b> and the indication that the verification of the authentication message is successful (e.g. True) or unsuccessful (e.g. False), e.g. (D<b>2</b>, HMAC<b>2</b>, D<b>1</b>, t<sub>i</sub>, True/False). The second entity <b>20</b> receives the verification response message and either authenticates the first entity <b>10</b> or rejects the first authorisation request accordingly.</p><p id="p-0149" num="0143">As illustrated by arrow <b>514</b> of <figref idref="DRAWINGS">FIG. <b>10</b></figref>, transmission of an authentication response message is initiated by the second entity <b>20</b> of the network towards the first entity <b>10</b> of the network in the manner described earlier. The transmission of the authentication response message may be initiated through the first (e.g. in-band) communication channel described earlier. The authentication response message indicates that authentication of the first entity <b>10</b> with the second entity <b>20</b> is successful (True) if verification of the authentication request message is successful or indicates that authentication of the first entity <b>10</b> with the second entity <b>20</b> is unsuccessful (False) if verification of the authentication request message is unsuccessful. As described earlier, the authentication response message can comprise the first verification token HMAC<b>2</b>. In some embodiments, such as that illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, the authentication response message may further comprise the identification information D<b>1</b> for the first entity <b>10</b> and the identification information D<b>2</b> for the second entity <b>20</b>.</p><p id="p-0150" num="0144">Although an example protocol-level implementation has been described with reference to <figref idref="DRAWINGS">FIG. <b>10</b></figref>, it will be understood that there may be many alternative implementations of the method described herein.</p><p id="p-0151" num="0145">It is noted that, in the network described herein, the second entity <b>20</b> that wishes to verify the authentication request message for the first entity <b>10</b> does not actually request contextual information for the first entity <b>10</b> from the third entity <b>30</b>. Instead, the second entity <b>20</b> just requests verification of the authentication request message (e.g. whether the first authentication token is valid or invalid). Thus, the third entity <b>30</b> returns only a response to the request, namely a verification response message, which indicates either that verification of the authentication request message is successful (e.g. the first authentication token is valid) or unsuccessful (e.g. the first authentication token is invalid). Therefore, the second entity <b>20</b> is prevented from obtaining contextual information for the first entity <b>10</b>, which can safeguard the first entity <b>10</b> if it turns out that the second entity <b>20</b> is a malicious entity.</p><p id="p-0152" num="0146">It is also noted that the authentication request message comprises the first authentication token generated using the contextual information for the first entity <b>10</b>, rather than the contextual information for the first entity <b>10</b> itself. Moreover, in some embodiments, the first authentication token may even have a hash function applied to it. As known in the art, cryptographic hash functions have a one way property and are thus irreversible. Therefore, the second entity <b>20</b> receiving the authentication request message is unable to infer the actual contextual information for the first entity <b>10</b> from the authentication request message. In some embodiments, the security of message exchange can be improved in the network by relying on security functions (e.g. secure tunnels, end-to-end encryption, etc.) of the underlying communication infrastructure.</p><p id="p-0153" num="0147">In some embodiments, the method described herein can be used as a primary authentication method. In other embodiments, the method described herein can be used as a secondary authentication method. For example, the method described herein can be used multi-factor authentication (MFA), such as two-factor authentication (2FA), according to some embodiments. MFA is an authentication method that requires more than one pieces of evidence (or factors) from independent categories of credentials to verify an identity of an entity, e.g. for a login or other transaction. These independent categories of credentials are typically knowledge (i.e. something the entity and only the entity knows), possession (i.e. something the entity has and only the entity has), and inherence (i.e. something the entity is and only the entity is). 2FA is a type, or subset, of MFA that requires a combination of two different authentication factors.</p><p id="p-0154" num="0148">Thus, the method described herein can be used on its own or in combination with one or more other authentication methods to provide MFA. The latter can be especially advantageous in critical systems that require extra precautions in addition to standard authentication mechanisms. In particular, it can provide an extra layer of security when a standard authentication mechanism is compromised. Currently, most existing authentication schemes developed for M2M and IoT rely on single authentication. It may be beneficial to employ the method described herein alone or in combination with one or more other authentication methods.</p><p id="p-0155" num="0149"><figref idref="DRAWINGS">FIG. <b>11</b></figref> is a block diagram illustrating a first entity <b>600</b> of a network in accordance with an embodiment. The first entity <b>600</b> comprises an acquiring module <b>602</b> configured to acquire contextual information for the first entity <b>600</b> and a timestamp for the contextual information. The first entity <b>600</b> comprises a generating module <b>604</b> configured to generate an authentication token using the acquired contextual information. The first entity <b>600</b> comprises a transmission initiating module <b>606</b> configured to initiate transmission of an authentication request message towards a second entity of the network requesting authentication of the first entity <b>600</b> with the second entity. The authentication request message comprises the generated authentication token and the timestamp for use in the authentication. The first entity <b>600</b> comprises a receiving module <b>608</b> configured to receive an authentication response message indicative of whether authentication of the first entity <b>600</b> with the second entity is successful or unsuccessful. The first entity <b>600</b> may operate in the manner described herein.</p><p id="p-0156" num="0150"><figref idref="DRAWINGS">FIG. <b>12</b></figref> is a block diagram illustrating a second entity <b>700</b> of a network in accordance with an embodiment. The second entity <b>700</b> comprises a first transmission initiating module <b>702</b> configured to, in response to receiving an authentication request message from a first entity <b>600</b> of the network requesting authentication of the first entity <b>600</b> with the second entity <b>700</b> (wherein the authentication request message comprises an authentication token and a timestamp for contextual information for the first entity <b>600</b> used to generate the authentication token), initiate transmission of a verification request message towards a third entity requesting verification of the authentication request message, wherein the verification request message comprises the authentication token and the timestamp for use in the verification. The second entity <b>700</b> comprises a receiving module <b>704</b> configured to receive a verification response message from the third entity indicative of whether verification of the authentication request message is successful. The second entity <b>700</b> comprises a second transmission initiating module <b>706</b> configured to initiate transmission of an authentication response message towards the first entity <b>600</b> indicating that authentication of the first entity <b>600</b> with the second entity <b>700</b> is successful if verification of the authentication request message is successful or indicating that authentication of the first entity <b>600</b> with the second entity <b>700</b> is unsuccessful if verification of the authentication request message is unsuccessful. The second entity <b>700</b> may operate in the manner described herein.</p><p id="p-0157" num="0151"><figref idref="DRAWINGS">FIG. <b>13</b></figref> is a block diagram illustrating a third entity <b>800</b> of a network in accordance with an embodiment. The third entity <b>800</b> comprises a generating module <b>802</b> configured to, in response to receiving a verification request message from a second entity <b>700</b> of a network requesting verification of an authentication request message (wherein the verification request message comprises a first authentication token for a first entity <b>600</b> and a timestamp for contextual information for the first entity <b>600</b> used to generate the first authentication token), generate a second authentication token using contextual information stored in a database for the first entity <b>600</b> of the network with the timestamp. The third entity <b>800</b> comprises a checking module <b>804</b> configured to check whether the second authentication token is the same as the first authentication token or different to the first authentication token. The third entity <b>800</b> comprises a transmission initiating module <b>806</b> configured to initiate transmission of a verification response message towards the second entity <b>700</b> indicating that verification of the authentication request message is successful if the second authentication token is the same as the first authentication token or indicating that verification of the authentication request message is unsuccessful if the second authentication token is different to the first authentication token. The third entity <b>800</b> may operate in the manner described herein.</p><p id="p-0158" num="0152">There is also provided a computer program comprising instructions which, when executed by processing circuitry (such as the processing circuitry <b>12</b> of the first entity <b>10</b> described earlier, the processing circuitry <b>22</b> of the second entity <b>20</b> described earlier, or the processing circuitry <b>32</b> of the third entity <b>30</b> described earlier), cause the processing circuitry to perform at least part of the method described herein. There is provided a computer program product, embodied on a non-transitory machine-readable medium, comprising instructions which are executable by processing circuitry (such as the processing circuitry <b>12</b> of the first entity <b>10</b> described earlier, the processing circuitry <b>22</b> of the second entity <b>20</b> described earlier, or the processing circuitry <b>32</b> of the third entity <b>30</b> described earlier) to cause the processing circuitry to perform at least part of the method described herein. There is provided a computer program product comprising a carrier containing instructions for causing processing circuitry (such as the processing circuitry <b>12</b> of the first entity <b>10</b> described earlier, the processing circuitry <b>22</b> of the second entity <b>20</b> described earlier, or the processing circuitry <b>32</b> of the third entity <b>30</b> described earlier) to perform at least part of the method described herein. In some embodiments, the carrier can be any one of an electronic signal, an optical signal, an electromagnetic signal, an electrical signal, a radio signal, a microwave signal, or a computer-readable storage medium.</p><p id="p-0159" num="0153">The entity functionality described herein can be performed by hardware. Thus, any one or more entities described herein can be a hardware entity. However, it will also be understood that at least part or all of the entity functionality described herein can be virtualized. For example, the functions performed by any one or more entities described herein can be implemented in software running on generic hardware that is configured to orchestrate the entity functionality. Thus, in some embodiments, any one or more entities described herein can be a virtual entity. In some embodiments, at least part or all of the entity functionality described herein may be performed in a network enabled cloud. The entity functionality described herein may all be at the same location or at least some of the entity functionality may be distributed.</p><p id="p-0160" num="0154">It will be understood that at least some or all of the method steps described herein can be automated in some embodiments. That is, in some embodiments, at least some or all of the method steps described herein can be performed automatically. The method can thus provide improved authentication in an autonomous manner without requiring human intervention.</p><p id="p-0161" num="0155">Thus, in the manner described herein, there is advantageously provided an improved technique for authenticating a first entity with a second entity. The technique enables the generation of a context-based dynamic security token for entities, which can be verified by different entities. The technique can be useful in a variety of applications including, but not limited to, IoT applications, M2M applications, and/or any other applications. The method can help to automatize security procedures in such applications, e.g. by leveraging the flexibility of a token based authentication scheme.</p><p id="p-0162" num="0156">It should be noted that the above-mentioned embodiments illustrate rather than limit the idea, and that those skilled in the art will be able to design many alternative embodiments without departing from the scope of the appended claims. The word &#x201c;comprising&#x201d; does not exclude the presence of elements or steps other than those listed in a claim, &#x201c;a&#x201d; or &#x201c;an&#x201d; does not exclude a plurality, and a single processor or other unit may fulfil the functions of several units recited in the claims. Any reference signs in the claims shall not be construed so as to limit their scope.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-01-20" num="01-20"><claim-text><b>1</b>.-<b>20</b>. (canceled)</claim-text></claim><claim id="CLM-00021" num="00021"><claim-text><b>21</b>. A method performed by a first entity of a network, the method comprising:<claim-text>acquiring contextual information for the first entity and a timestamp for the contextual information;</claim-text><claim-text>generating an authentication token using the acquired contextual information;</claim-text><claim-text>initiating transmission of an authentication request message towards a second entity of the network requesting authentication of the first entity with the second entity, wherein the authentication request message comprises the generated authentication token and the timestamp for use in the authentication; and</claim-text><claim-text>receiving an authentication response message indicative of whether authentication of the first entity with the second entity is successful or unsuccessful.</claim-text></claim-text></claim><claim id="CLM-00022" num="00022"><claim-text><b>22</b>. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein generating the authentication token comprises generating the authentication token using the acquired contextual information and any one or more of:<claim-text>the timestamp;</claim-text><claim-text>a random number generated for the first entity and having the timestamp;</claim-text><claim-text>identification information for the first entity; and</claim-text><claim-text>identification information for the second entity.</claim-text></claim-text></claim><claim id="CLM-00023" num="00023"><claim-text><b>23</b>. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the network is an internet of things (IoT) network.</claim-text></claim><claim id="CLM-00024" num="00024"><claim-text><b>24</b>. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the contextual information for the first entity comprises any one or more of:<claim-text>utility consumption information for the first entity;</claim-text><claim-text>environmental information for the first entity;</claim-text><claim-text>location information for the first entity;</claim-text><claim-text>neighbourhood information for the first entity; and</claim-text><claim-text>network information for the first entity.</claim-text></claim-text></claim><claim id="CLM-00025" num="00025"><claim-text><b>25</b>. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein transmission of the authentication request message towards the second entity is initiated via an in-band communication channel between the first entity and the second entity.</claim-text></claim><claim id="CLM-00026" num="00026"><claim-text><b>26</b>. A first entity of a network, wherein the first entity comprises processing circuitry configured to:<claim-text>acquire contextual information for the first entity and a timestamp for the contextual information;</claim-text><claim-text>generate an authentication token using the acquired contextual information;</claim-text><claim-text>initiate transmission of an authentication request message towards a second entity of the network requesting authentication of the first entity with the second entity, wherein the authentication request message comprises the generated authentication token and the timestamp for use in the authentication; and</claim-text><claim-text>receive an authentication response message indicative of whether authentication of the first entity with the second entity is successful or unsuccessful.</claim-text></claim-text></claim><claim id="CLM-00027" num="00027"><claim-text><b>27</b>. The first entity of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the processing circuitry is configured to generate the authentication token by generating the authentication token using the acquired contextual information and any one or more of:<claim-text>the timestamp;</claim-text><claim-text>a random number generated for the first entity and having the timestamp;</claim-text><claim-text>identification information for the first entity; and</claim-text><claim-text>identification information for the second entity.</claim-text></claim-text></claim><claim id="CLM-00028" num="00028"><claim-text><b>28</b>. The first entity of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the network is an internet of things (IoT) network.</claim-text></claim><claim id="CLM-00029" num="00029"><claim-text><b>29</b>. The first entity of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the contextual information for the first entity comprises any one or more of:<claim-text>utility consumption information for the first entity;</claim-text><claim-text>environmental information for the first entity;</claim-text><claim-text>location information for the first entity;</claim-text><claim-text>neighbourhood information for the first entity; and</claim-text><claim-text>network information for the first entity.</claim-text></claim-text></claim><claim id="CLM-00030" num="00030"><claim-text><b>30</b>. The first entity of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the processing circuitry is configured to initiate transmission of the authentication request message towards the second entity via an in-band communication channel between the first entity and the second entity.</claim-text></claim><claim id="CLM-00031" num="00031"><claim-text><b>31</b>. A method performed by a third entity, the method comprising:<claim-text>receiving, from a second entity of a network, a verification request message that requests verification of an authentication request message, wherein the verification request message comprises a first authentication token for a first entity and a timestamp for contextual information for the first entity used to generate the first authentication token; and</claim-text><claim-text>in response to receiving the verification request message:<claim-text>generating a second authentication token using contextual information stored in a database for the first entity of the network with the timestamp;</claim-text><claim-text>checking whether the second authentication token is the same as the first authentication token or different from the first authentication token; and</claim-text><claim-text>initiating transmission of a verification response message towards the second entity indicating that verification of the authentication request message is successful if the second authentication token is the same as the first authentication token or indicating that verification of the authentication request message is unsuccessful if the second authentication token is different from the first authentication token.</claim-text></claim-text></claim-text></claim><claim id="CLM-00032" num="00032"><claim-text><b>32</b>. The method of <claim-ref idref="CLM-00031">claim 31</claim-ref>, wherein the network is an internet of things (IoT) network.</claim-text></claim><claim id="CLM-00033" num="00033"><claim-text><b>33</b>. The method of <claim-ref idref="CLM-00031">claim 31</claim-ref>, further comprising:<claim-text>acquiring the contextual information for the first entity and the timestamp for the contextual information; and</claim-text><claim-text>controlling the database to store the acquired contextual information for the first entity with the timestamp.</claim-text></claim-text></claim><claim id="CLM-00034" num="00034"><claim-text><b>34</b>. The method of <claim-ref idref="CLM-00033">claim 33</claim-ref>, wherein a communication channel via which the contextual information for the first entity and the timestamp for the contextual information is acquired is an out-of-band communication channel.</claim-text></claim><claim id="CLM-00035" num="00035"><claim-text><b>35</b>. The method of <claim-ref idref="CLM-00031">claim 31</claim-ref>, further comprising generating the second authentication token using the contextual information stored in the database for the first entity with the timestamp and any one or more of:<claim-text>the timestamp;</claim-text><claim-text>a random number stored in the database for the first entity with the timestamp;</claim-text><claim-text>identification information for the first entity; and</claim-text><claim-text>identification information for the second entity.</claim-text></claim-text></claim><claim id="CLM-00036" num="00036"><claim-text><b>36</b>. The method of <claim-ref idref="CLM-00031">claim 31</claim-ref>, wherein the contextual information stored in the database for the first entity with the timestamp comprises any one or more of:<claim-text>utility consumption information for the first entity;</claim-text><claim-text>environmental information for the first entity;</claim-text><claim-text>location information for the first entity;</claim-text><claim-text>neighbourhood information for the first entity; and</claim-text><claim-text>network information for the first entity.</claim-text></claim-text></claim><claim id="CLM-00037" num="00037"><claim-text><b>37</b>. The method of <claim-ref idref="CLM-00031">claim 31</claim-ref>, wherein transmission of the authentication request message towards the second entity is initiated via an in-band communication channel between the first entity and the second entity.</claim-text></claim><claim id="CLM-00038" num="00038"><claim-text><b>38</b>. A third entity comprising processing circuitry configured to:<claim-text>receive, from a second entity of a network, a verification request message that requests verification of an authentication request message, wherein the verification request message comprises a first authentication token for a first entity and a timestamp for contextual information for the first entity used to generate the first authentication token; and</claim-text><claim-text>in response to receiving the verification request message:<claim-text>generate a second authentication token using contextual information stored in a database for the first entity of the network with the timestamp;</claim-text><claim-text>check whether the second authentication token is the same as the first authentication token or different from the first authentication token; and</claim-text><claim-text>initiate transmission of a verification response message towards the second entity indicating that verification of the authentication request message is successful if the second authentication token is the same as the first authentication token or indicating that verification of the authentication request message is unsuccessful if the second authentication token is different from the first authentication token.</claim-text></claim-text></claim-text></claim><claim id="CLM-00039" num="00039"><claim-text><b>39</b>. The third entity of <claim-ref idref="CLM-00038">claim 38</claim-ref>, wherein the processing circuitry is further configured to:<claim-text>acquire the contextual information for the first entity and the timestamp for the contextual information; and</claim-text><claim-text>control the database to store the acquired contextual information for the first entity with the timestamp.</claim-text></claim-text></claim><claim id="CLM-00040" num="00040"><claim-text><b>40</b>. The third entity of <claim-ref idref="CLM-00038">claim 38</claim-ref>, wherein the processing circuitry is further configured to generate the second authentication token using the contextual information stored in the database for the first entity with the timestamp and any one or more of:<claim-text>the timestamp;</claim-text><claim-text>a random number stored in the database for the first entity with the timestamp;</claim-text><claim-text>identification information for the first entity; and</claim-text><claim-text>identification information for the second entity.</claim-text></claim-text></claim></claims></us-patent-application>