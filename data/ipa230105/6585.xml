<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230006586A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230006586</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17780349</doc-number><date>20201113</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>JP</country><doc-number>2019-215991</doc-number><date>20191129</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>02</class><subclass>P</subclass><main-group>21</main-group><subgroup>18</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>02</class><subclass>P</subclass><main-group>21</main-group><subgroup>22</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20160201</date></cpc-version-indicator><section>H</section><class>02</class><subclass>P</subclass><main-group>21</main-group><subgroup>18</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20160201</date></cpc-version-indicator><section>H</section><class>02</class><subclass>P</subclass><main-group>21</main-group><subgroup>22</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>02</class><subclass>P</subclass><main-group>27</main-group><subgroup>06</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">POWER CONVERSION DEVICE</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>HITACHI ASTEMO, LTD.</orgname><address><city>Hitachinaka-shi, Ibaraki,</city><country>JP</country></address></addressbook><residence><country>JP</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>MATSUO</last-name><first-name>Kentaro</first-name><address><city>Hitachinaka-shi</city><country>JP</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>MYOEN</last-name><first-name>Kohei</first-name><address><city>Hitachinaka-shi</city><country>JP</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>YOSHIDA</last-name><first-name>Kenichi</first-name><address><city>Hitachinaka-shi</city><country>JP</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>AIZAWA</last-name><first-name>Kazuyoshi</first-name><address><city>Hitachinaka-shi</city><country>JP</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>HITACHI ASTEMO, LTD.</orgname><role>03</role><address><city>Hitachinaka-shi, Ibaraki,</city><country>JP</country></address></addressbook></assignee></assignees><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/JP2020/042369</doc-number><date>20201113</date></document-id><us-371c12-date><date>20220526</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A power conversion device includes: an inverter that converts a DC voltage into an AC voltage and drives a synchronous motor; and a magnetic pole position correction unit that corrects an error in a magnetic pole position of a rotor from a rotation angle sensor of the synchronous motor. The magnetic pole position correction unit includes an actual current phase calculation unit that calculates a current phase from a current when three-phase lines are short-circuited during rotation of the synchronous motor and an ideal current phase calculation unit that calculates an ideal current phase based on a rotational speed of the rotor and a temperature of a stator, and corrects the magnetic pole position from a difference between outputs of the actual current phase calculation unit and the ideal current phase calculation unit.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="112.35mm" wi="134.96mm" file="US20230006586A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="136.06mm" wi="136.99mm" file="US20230006586A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="168.06mm" wi="117.77mm" orientation="landscape" file="US20230006586A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="198.20mm" wi="86.61mm" file="US20230006586A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="194.56mm" wi="111.17mm" file="US20230006586A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="214.29mm" wi="130.81mm" file="US20230006586A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="209.47mm" wi="134.70mm" file="US20230006586A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="84.41mm" wi="130.05mm" file="US20230006586A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">TECHNICAL FIELD</heading><p id="p-0002" num="0001">The present invention relates to a power conversion device.</p><heading id="h-0002" level="1">BACKGROUND ART</heading><p id="p-0003" num="0002">When a system in which a permanent magnet synchronous motor is driven by an inverter is controlled, information on a magnetic pole position of a rotor with respect to a stator is required. In the case of an electric vehicle, the information on the magnetic pole position is acquired by a rotation angle sensor (resolver or the like) attached to the rotor to perform torque control of the motor, but torque different from a torque command value is generated when there is an angle error caused by an attachment error of the rotation angle sensor, which causes deterioration of drivability of the vehicle.</p><p id="p-0004" num="0003">Therefore, it is necessary to estimate an actual rotor position of the permanent magnet synchronous motor and detect an offset error of the rotation angle sensor based on the estimated actual rotor position. Such conventional techniques are described in, for example, PTL 1 and PTL 2.</p><heading id="h-0003" level="1">CITATION LIST</heading><heading id="h-0004" level="1">Patent Literature</heading><p id="p-0005" num="0004">PTL 1: JP 2014-050122 A</p><p id="p-0006" num="0005">PTL 2: JP 2017-212783 A</p><heading id="h-0005" level="1">SUMMARY OF INVENTION</heading><heading id="h-0006" level="1">Technical Problem</heading><p id="p-0007" num="0006">In the invention described in PTL 1, only a d-axis voltage is applied in a rotor stopped state, and an angle at which a q-axis current becomes zero is searched for. In this method, however, calibration of the magnitude of Vd and an energization time and the zero determination regarding the q-axis current are difficult, and it is difficult to sufficiently improve the accuracy.</p><p id="p-0008" num="0007">The invention described in PTL 2 calculates an offset error based on a difference between a phase current detected in a state where a motor end is short-circuited and a phase current theoretical value. However, when a rotational speed is relatively low (for example, 1000 to 2000 rpm), an error caused by a motor temperature, particularly a stator temperature, is large, and it is difficult to sufficiently improve the accuracy.</p><p id="p-0009" num="0008">An object that is to be achieved by the present invention is to detect an offset error of a rotation angle sensor of a rotor with high accuracy.</p><heading id="h-0007" level="1">Solution to Problem</heading><p id="p-0010" num="0009">Therefore, a power conversion device according to the present invention includes: an inverter that converts a DC voltage into an AC voltage and drives a synchronous motor; and a magnetic pole position correction unit that corrects an error in a magnetic pole position of a rotor from a rotation angle sensor of the synchronous motor, the magnetic pole position correction unit including an actual current phase calculation unit that calculates a current phase from a current when three-phase lines are short-circuited during rotation of the synchronous motor, and an ideal current phase calculation unit that calculates an ideal current phase based on a rotational speed of the rotor and a temperature of a stator, and correcting the magnetic pole position from a difference between outputs of the actual current phase calculation unit and the ideal current phase calculation unit.</p><heading id="h-0008" level="1">Advantageous Effects of Invention</heading><p id="p-0011" num="0010">The offset error of the rotation angle sensor of the rotor can be detected with high accuracy.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0009" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a diagram illustrating a schematic circuit configuration of a power conversion device.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a processing block diagram for describing processing of a controller <b>4</b>.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a flowchart illustrating a procedure of offset error calculation.</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a view illustrating a waveform of each phase current after the start of a three-phase short circuit.</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a block diagram illustrating a configuration of a magnetic pole position correction unit <b>46</b> according to a first embodiment.</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a graph illustrating a relationship between a rotational speed and an ideal current phase.</p><p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a block diagram illustrating a first modification of an ideal phase current calculation unit <b>55</b>.</p><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a block diagram illustrating a second modification of the ideal phase current calculation unit <b>55</b>.</p><p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a block diagram illustrating a configuration of the magnetic pole position correction unit <b>46</b> according to a second embodiment.</p><p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a block diagram illustrating a modification of the magnetic pole position correction unit <b>46</b> according to the second embodiment.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0010" level="1">DESCRIPTION OF EMBODIMENTS</heading><p id="p-0022" num="0021">Hereinafter, a description will be given regarding embodiments of a power conversion device according to the present invention with reference to the drawings. Incidentally, the same elements will be denoted by the same reference signs in the respective drawings, and the redundant description thereof will be omitted.</p><heading id="h-0011" level="1">First Embodiment</heading><p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a diagram illustrating a schematic circuit configuration of a power conversion device. In <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the power conversion device of a motor <b>2</b> mainly includes an inverter <b>1</b>, a battery <b>3</b>, a controller <b>4</b>, and the like. The inverter <b>1</b> is a three-phase voltage-type two-level inverter.</p><p id="p-0024" num="0023">The motor <b>2</b> is connected to a drive mechanism of a motor vehicle system, and the motor <b>2</b> rotates to propel a vehicle. The motor <b>2</b> of the present embodiment is an AC motor, and is a three-phase interior permanent magnet synchronous motor (IPMSM). The motor <b>2</b> operates by an interaction between a magnetic flux generated from a permanent magnet provided in a rotor (not illustrated) and a magnetic field generated by currents iu, iv, and iw flowing through three-phase windings <b>5</b>, <b>6</b>, and <b>7</b> fixed to an armature. Here, iu, iv, and iw represent a U-phase current, a V-phase current, and a W-phase current, respectively. Note that a permanent magnet synchronous motor will be described in the present embodiment, but the present invention is also applicable to other synchronous motors such as a wound field synchronous motor.</p><p id="p-0025" num="0024">The motor <b>2</b> includes a magnetic pole position sensor <b>8</b>. The magnetic pole position sensor <b>8</b> has a function of detecting a magnetic pole position of the rotor of the motor <b>2</b> as a rotation angle. The magnetic pole position sensor <b>8</b> outputs a magnetic pole position signal <b>9</b> (&#x3b8;) to be input to the controller <b>4</b>. Processing of the magnetic pole position signal <b>9</b> (&#x3b8;) in the controller <b>4</b> will be described later with reference to <figref idref="DRAWINGS">FIG. <b>2</b></figref>. The magnetic pole position sensor <b>8</b> can be configured using a resolver, a rotary encoder, an absolute encoder, or the like.</p><p id="p-0026" num="0025">The current sensor <b>10</b> detects currents flowing through the windings <b>5</b>, <b>6</b>, and <b>7</b>, outputs a U-phase current sensor signal <b>11</b> (signal indicating the current iu), a V-phase current sensor signal <b>12</b> (signal indicating the current iv), and a W-phase current sensor signal <b>13</b> (signal indicating the current iw) based on the detected currents to be input to the controller <b>4</b>. Processing of the current sensor signals <b>11</b>, <b>12</b>, and <b>13</b> in the controller <b>4</b> will also be described later with reference to <figref idref="DRAWINGS">FIG. <b>2</b></figref>.</p><p id="p-0027" num="0026">The inverter <b>1</b> includes switching elements <b>14</b>, <b>15</b>, <b>16</b>, <b>17</b>, <b>18</b>, and <b>19</b> and freewheeling diodes <b>20</b>, <b>21</b>, <b>22</b>, <b>23</b>, <b>24</b>, and <b>25</b>. Each of the switching elements <b>14</b> to <b>19</b> of the present embodiment is a Si-IGBT and includes a gate terminal, a collector terminal, and an emitter terminal. Each of the freewheeling diodes <b>20</b> to <b>25</b> is connected between the collector terminal and the emitter terminal of each of the switching elements <b>14</b> to <b>19</b>. When the collector terminal has a higher potential than the emitter terminal in each of the switching elements <b>14</b> to <b>19</b>, each of the freewheeling diodes <b>20</b> to <b>25</b> prevents a current from flowing through the freewheeling diodes <b>20</b> to <b>25</b> and prevents a high reverse voltage from being applied to the switching elements <b>14</b> to <b>19</b>. However, the present invention is not limited to the combination of the Si-IGBT and the freewheeling diode, and an inverter circuit may be configured using other semiconductor elements.</p><p id="p-0028" num="0027">Switching of on and off of each of the switching elements <b>14</b> to <b>19</b> is performed by each of gate drive signals <b>26</b>, <b>27</b>, <b>28</b>, <b>29</b>, <b>30</b>, and <b>31</b> connected to the gate terminals of the respective switching elements <b>14</b> to <b>19</b>. Six gate signals <b>32</b> that are the basis of the gate drive signals <b>26</b> to <b>31</b> are generated by the controller <b>4</b> and output to a gate drive circuit <b>35</b>. The gate drive circuit <b>35</b> converts the gate signals <b>32</b> into potentials necessary for switching the switching elements <b>14</b>, <b>15</b>, <b>16</b>, <b>17</b>, <b>18</b>, and <b>19</b> between on and off, and outputs the gate drive signals <b>26</b>, <b>27</b>, <b>28</b>, <b>29</b>, <b>30</b>, and <b>31</b>. The generation of the gate signal <b>32</b> in the controller <b>4</b> will be described later with reference to <figref idref="DRAWINGS">FIG. <b>2</b></figref>.</p><p id="p-0029" num="0028">The emitter terminal of the switching element <b>14</b> and the collector terminal of the switching element <b>15</b> are connected to each other, and the connection point thereof is connected to the winding <b>5</b> to allow the flow of the current iu. The emitter terminal of the switching element <b>16</b> and the collector terminal of the switching element <b>17</b> are connected to each other, and the connection point thereof is connected to the winding <b>6</b> to allow the flow of the current iv. The emitter terminal of the switching element <b>18</b> and the collector terminal of the switching element <b>19</b> are connected to each other, and the connection point thereof is connected to the winding <b>7</b> to allow the flow of the current iw. The collector terminals of the switching elements <b>14</b>, <b>16</b>, and <b>18</b> are connected to each other and connected to a high-potential DC wiring <b>33</b>. Further, the emitter terminals of the switching elements <b>15</b>, <b>17</b>, and <b>19</b> are connected to each other and connected to a low-potential DC wiring <b>34</b>.</p><p id="p-0030" num="0029">As a result, the controller <b>4</b> turns on and off the switching elements <b>14</b>, <b>15</b>, <b>16</b>, <b>17</b>, <b>18</b>, and <b>19</b> at appropriate timings based on the generated gate signals <b>32</b>, and controls the currents iu, iv, and iw flowing through the windings <b>5</b>, <b>6</b>, and <b>7</b> to realize rotation control of the motor <b>2</b>. The gate signal <b>32</b> is in a form of a pulse width modulation (PWM) signal such that the currents iu, iv, and iw are sinusoidal signals having phases different from each other by 120 degrees.</p><p id="p-0031" num="0030">A voltage sensor <b>36</b> is connected to the high-potential DC wiring <b>33</b> and the low-potential DC wiring <b>34</b>, and detects a potential difference therebetween. Since the potential difference between the high-potential DC wiring <b>33</b> and the low-potential DC wiring <b>34</b> is normally a high voltage of, for example, <b>100</b> V or more, the voltage sensor <b>36</b> generates a DC voltage sensor signal <b>37</b> (Vdc), converted into a low voltage detectable by the controller <b>4</b>, and inputs the DC voltage sensor signal to the controller <b>4</b>.</p><p id="p-0032" num="0031">A smoothing capacitor <b>38</b> included in the inverter <b>1</b> is connected between the high-potential DC wiring <b>33</b> and the low-potential DC wiring <b>34</b>. The smoothing capacitor <b>38</b> has a function of suppressing a pulsation of a DC voltage generated by each switching operation of the switching elements <b>14</b> to <b>19</b>.</p><p id="p-0033" num="0032">In the battery <b>3</b>, a terminal on the high potential side of the battery <b>3</b> is connected to the high-potential DC wiring <b>33</b>, and a terminal on the low potential side of the battery <b>3</b> is connected to the low-potential DC wiring <b>34</b>. As a result, the battery <b>3</b> serves as a DC power supply that supplies power to the inverter <b>1</b> and the motor <b>2</b>.</p><p id="p-0034" num="0033">A torque command <b>39</b> (T*) given from a host controller of a vehicle, such as an electronic control unit (ECU), is input to the controller <b>4</b>. The controller <b>4</b> performs torque control of the motor <b>2</b> based on the torque command <b>39</b> (T*).</p><p id="p-0035" num="0034">Further the controller <b>4</b> receives inputs of temperatures of a stator and the rotor of the motor <b>2</b> although not illustrated in <figref idref="DRAWINGS">FIG. <b>1</b></figref>. Although it is desirable that the temperatures of the stator and the rotor be detected by a temperature sensor, it may be configured to use temperatures estimated by a known method.</p><p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a processing block diagram for describing the processing of the controller <b>4</b>.</p><p id="p-0037" num="0036">In <figref idref="DRAWINGS">FIG. <b>2</b></figref>, processing blocks of the controller <b>4</b> include a current command calculation unit <b>40</b>, a three-phase/two-phase conversion unit <b>41</b>, a current control unit <b>42</b>, a two-phase/three-phase conversion unit <b>43</b>, a velocity calculation unit <b>44</b>, a PWM gate control signal generation unit (control signal generation unit) <b>45</b>, a magnetic pole position correction unit <b>46</b>, a deviation calculator <b>47</b>, a deviation calculator <b>48</b>, and an adder <b>49</b>. The current command calculation unit <b>40</b>, the three-phase/two-phase conversion unit <b>41</b>, the current control unit <b>42</b>, the two-phase/three-phase conversion unit <b>43</b>, the deviation calculator <b>47</b>, and the deviation calculator <b>48</b> form a three-phase voltage command value generation unit. Normally, a three-phase voltage command value is generated based on the magnetic pole position signal <b>9</b> (&#x3b8;) detected by the magnetic pole position sensor <b>8</b>. In the present invention, however, a corrected magnetic pole position signal <b>50</b> (&#x3b8;&#x2032;) corrected by a method to be described later is used instead of the magnetic pole position signal <b>9</b> (&#x3b8;).</p><p id="p-0038" num="0037">The controller <b>4</b> performs the rotation control by causing the three-phase currents iu, iv, and iw to flow through the motor <b>2</b>. Inside the controller <b>4</b>, a so-called current vector control method is used in which processing is performed in a coordinate system obtained by converting a three-phase fixed coordinate into a two-phase rotating coordinate represented by a d-axis and a q-axis.</p><p id="p-0039" num="0038">The current command calculation unit <b>40</b> calculates a d-axis current command value id* and a q-axis current command value iq*. The torque command <b>39</b> (T*), a rotational angular velocity &#x3c9;, and the DC voltage sensor signal <b>37</b> (Vdc) are input to the current command calculation unit <b>40</b>, and the d-axis current command value id* and the q-axis current command value iq* are calculated from these inputs. The rotational angular velocity &#x3c9; is calculated by the velocity calculation unit <b>44</b> based on the corrected magnetic pole position signal <b>50</b> (&#x3b8;&#x2032;).</p><p id="p-0040" num="0039">In a synchronous motor having magnetic saliency such as IPMSM, torque T is expressed by the following Formula (1) and depends on a current.</p><p id="p-0041" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>T=Pp</i>&#xb7;{&#x3a6;+(<i>Ld&#x2212;Lq</i>)<i>id}&#xb7;iq </i>&#x2003;&#x2003;(1)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0042" num="0040">In Formula (1), id is a d-axis current, iq is a q-axis current, Pp is the number of pole pairs, Ld is a d-axis inductance, Lq is a q-axis inductance, and &#x3a6; is a magnetic flux.</p><p id="p-0043" num="0041">The corrected magnetic pole position signal <b>50</b> (&#x3b8;&#x2032;) is input to the three-phase/two-phase conversion unit <b>41</b> and the two-phase/three-phase conversion unit <b>43</b>, and is used for conversion between a two-phase coordinate and a three-phase coordinate of the d-axis and q-axis.</p><p id="p-0044" num="0042">The three-phase/two-phase conversion unit <b>41</b> performs coordinate conversion on the current sensor signals <b>11</b> (iu), <b>12</b> (iv), and <b>13</b> (iw) into the d-axis and q-axis based on information on the corrected magnetic pole position signal <b>50</b> (&#x3b8;&#x2032;), and outputs a d-axis detection current id and a q-axis detection current iq.</p><p id="p-0045" num="0043">The deviation calculator <b>47</b> calculates a deviation between the d-axis current command value id* output from the current command calculation unit <b>40</b> and the d-axis sensing current id output from the three-phase/two-phase conversion unit <b>41</b>, and outputs a d-axis current deviation Lid to the current control unit <b>42</b>. The deviation calculator <b>48</b> calculates a deviation between the q-axis current command value iq* output from the current command calculation unit <b>40</b> and the q-axis sensing current iq output from the three-phase/two-phase conversion unit <b>41</b>, and outputs a q-axis current deviation &#x394;iq to the current control unit <b>42</b>.</p><p id="p-0046" num="0044">The current control unit <b>42</b> performs feedback control such that the d-axis difference current Lid the q-axis current deviation &#x394;iq each indicating a deviation between a command value that is a target value and a measured value that is an output value become zero, and calculates and outputs a d-axis voltage command Vd* and a q-axis voltage command Vq* as voltage commands in order to update the output values. The feedback control in the current control unit <b>42</b> is performed by, for example, PI control. The d-axis voltage command value Vd* and the q-axis voltage command value Vq* output from the current control unit <b>42</b> are input to the two-phase/three-phase conversion unit <b>43</b>, thereby calculating and outputting three-phase voltage command values Vu*, Vv*, and Vw* based on the corrected magnetic pole position signal <b>50</b> (&#x3b8;&#x2032;).</p><p id="p-0047" num="0045">The PWM gate control signal generation unit (control signal generation unit) <b>45</b> compares the three-phase voltage command values Vu*, Vv*, and Vw* with a carrier carrier wave (not illustrated) to generate the six gate signals <b>32</b>, which are PWM signals, and outputs the gate signals to the gate drive circuit <b>35</b>.</p><p id="p-0048" num="0046">The magnetic pole position correction unit <b>46</b> is a characteristic portion of the present invention. The magnetic pole position correction unit <b>46</b> calculates an offset error AO caused by an attachment error of the magnetic pole position sensor <b>8</b>. The calculated offset error AB is added to the magnetic pole position signal <b>9</b> (&#x3b8;) detected by the magnetic pole position sensor <b>8</b>, and is used to generate the three-phase voltage command value as the corrected magnetic pole position signal <b>50</b> (&#x3b8;&#x2032;).</p><p id="p-0049" num="0047"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a specific procedure of the offset error calculation.</p><p id="p-0050" num="0048">First, it is determined whether there is a request for angle error correction from the host controller. For example, as one execution example, the angle error correction is executed before product shipment after the magnetic pole position sensor <b>8</b> is assembled to the motor <b>2</b>. In addition, the processing may be executed when the inverter <b>1</b> or the motor <b>2</b> is replaced, or may be executed when a decrease in output or torque of the motor <b>2</b> is detected. The host controller mounted on the vehicle outputs the angle error correction request when determining that the angle error correction according to the present invention can be executed from information on the rotational speed of the motor <b>2</b> and the like, for example.</p><p id="p-0051" num="0049">When the angle error correction request is made from the host controller, a three-phase short circuit is started. The three-phase short circuit is a state where the switching elements <b>14</b>, <b>16</b>, and <b>18</b> constituting an upper arm of the inverter <b>1</b> are simultaneously turned on and the switching elements <b>15</b>, <b>17</b>, and <b>19</b> constituting a lower arm are simultaneously turned off, or a state where the switching elements <b>14</b>, <b>16</b>, and <b>18</b> constituting the upper arm are simultaneously turned off and the switching elements <b>15</b>, <b>17</b>, and <b>19</b> constituting the lower arm are simultaneously turned on.</p><p id="p-0052" num="0050">After the start of the three-phase short circuit, the processing stands by until a predetermined threshold time elapses. The reason therefor will be described with reference to <figref idref="DRAWINGS">FIG. <b>4</b></figref>. <figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates current waveforms of the respective phases of U to W when the three-phase short circuit is started at certain time during the rotation of the motor <b>2</b>. As illustrated in <figref idref="DRAWINGS">FIG. <b>4</b></figref>, the current waveforms varies in a transient state immediately after the start of the three-phase short circuit. In this state, the d-axis current and the q-axis current vibrate, and it is difficult to execute the magnetic pole position error correction accurately. Thus, this is because the magnetic pole position correction operation is executed after transition to a steady state where the variations of each phase current is settled.</p><p id="p-0053" num="0051">The threshold time until the transition to the steady state can be calculated by characteristics of the motor <b>2</b>. Time constants of the d-axis inductance Ld, the q-axis inductance Lq, and a stator resistance R in the motor can be expressed by 2Ld&#xb7;Lq/{R (Ld+Lq)}.</p><p id="p-0054" num="0052">Note that the determination until the transition to the steady state is performed by the comparison with the threshold time in the present embodiment, but the determination may be performed by another method, for example, a case where the amplitude of each phase current falls within a predetermined value range, a case where the vibration of the d-axis current id and the q-axis current iq falls below a predetermined threshold, or the like.</p><p id="p-0055" num="0053">In <figref idref="DRAWINGS">FIG. <b>3</b></figref>, when a three-phase short circuit time exceeds the threshold, the magnetic pole position correction operation is executed. Details of the magnetic pole position correction operation will be described later with reference to <figref idref="DRAWINGS">FIG. <b>5</b></figref>. After the completion of the magnetic pole position correction operation, the three-phase short circuit is ended, and the processing returns to a normal PWM mode.</p><p id="p-0056" num="0054"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a block diagram illustrating a configuration of the magnetic pole position correction unit <b>46</b> in the present embodiment. A procedure of the magnetic pole position correction operation in <figref idref="DRAWINGS">FIG. <b>3</b></figref> will be described with reference to the block diagram of <figref idref="DRAWINGS">FIG. <b>5</b></figref>.</p><p id="p-0057" num="0055">As described in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the magnetic pole position correction operation is executed at the time of the three-phase short circuit. First, dq conversion is performed on each phase current detected at the time of three-phase short circuit to calculate an actual current phase Pact. The actual current phase Pact at the time of the three-phase short circuit is expressed by Formula (2). The current phase has the q-axis at 0 degrees as a reference, and the counterclockwise direction thereof is positive.</p><p id="p-0058" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3b2;act=tan<sup>&#x2212;1</sup>(&#x2212;<i>id/iq</i>) &#x2003;&#x2003;(2)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0059" num="0056">Further, the ideal current phase calculation unit <b>55</b> calculates an ideal current phase &#x3b2;ideal based on the rotational speed (rotational angular velocity &#x3c9;) of the motor <b>2</b> and a stator temperature Ts. The ideal current phase &#x3b2;ideal at the time of the three-phase short circuit is expressed by Formula (3). Here, &#x3c9; is an electrical angular velocity [rad/s], Lq is the q-axis inductance [H], and R is the stator resistance [&#x3a9;].</p><p id="p-0060" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3b2;ideal=tan<sup>&#x2212;1 </sup>(&#x2212;&#x3c9;&#xb7;<i>Lq/R</i>) &#x2003;&#x2003;(3)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0061" num="0057">Here, the ideal current phase &#x3b2;ideal is a current phase in a case where there is no error in the magnetic pole position. The q-axis inductance Lq changes depending on the q-axis current, and the stator resistance R changes depending on the stator temperature. Meanwhile, the q-axis current hardly changes as long as the q-axis current is equal to or higher than a predetermined rotational speed (for example, 1000 rpm), and thus, the q-axis current can be regarded to be substantially constant. However, the stator resistance R depends on the temperature, and a resistance value also increases as the temperature increases. Therefore, the correction operation is performed using the stator temperature Ts in the present invention.</p><p id="p-0062" num="0058"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a graph illustrating a relationship between a rotational speed and an ideal current phase. The current phase on the vertical axis is indicated by a numerical value when the q-axis is set to 0 degrees as a reference. As illustrated in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, a variation due to the temperature is large in a region where the rotational speed is relatively low, and an error in a case where the temperature is not corrected is large.</p><p id="p-0063" num="0059">After the ideal current phase &#x3b2;ideal is calculated in consideration of the influence of the stator temperature Ts as described above, a difference from the actual current phase &#x3b2;act is obtained. This difference corresponds to the offset error &#x394;&#x3b8; of the magnetic pole position sensor <b>8</b>.</p><p id="p-0064" num="0060">As described above, the power conversion device according to the present embodiment includes: the inverter that converts the DC voltage into the AC voltage and drives the synchronous motor; and the magnetic pole position correction unit <b>46</b> that corrects an error in a rotor magnetic pole position from the magnetic pole position sensor <b>8</b> of the motor <b>2</b>. The magnetic pole position correction unit <b>46</b> includes an actual current phase calculation unit that calculates the current phase &#x3b2;act from the current when three-phase lines are short-circuited during rotation of the motor <b>2</b>, and the ideal current phase calculation unit that calculates the ideal current phase &#x3b2;ideal based on the rotational speed of the rotor and the temperature of the stator. Then, the magnetic pole position is corrected from the difference &#x394;&#x3b8; between outputs of the actual current phase calculation unit and the ideal current phase calculation unit.</p><p id="p-0065" num="0061">As a result, the magnetic pole position can be obtained with high accuracy even in a low-speed region. In other words, the offset error can be corrected by a simple method according to the present invention, and thus, tolerance management at the time of assembling the magnetic pole position sensor can be simplified. Further, the current phase is directly obtained from the current value on the rotating coordinate in the magnetic pole position error correction in the present embodiment, and thus, the correction can be performed with a simple configuration as compared with a method of calculating an ideal current as three-phase currents on the fixed coordinates. Further, the offset angle is obtained by the three-phase short circuit currents, and thus, it is possible to perform the correction with high accuracy without being affected by an error caused by a dead time due to switching.</p><p id="p-0066" num="0062">Note that the present embodiment is configured such that the highly accurate offset correction can be performed with fewer parameters by using the stator temperature Ts to calculate the ideal current phase. However, the use of other parameters is not precluded. For example, the ideal current phase may be calculated in consideration of not only the stator temperature but also the influence of a rotor temperature.</p><p id="p-0067" num="0063">Next, modifications of the ideal current phase calculation unit in <figref idref="DRAWINGS">FIG. <b>5</b></figref> will be described. A modification in <figref idref="DRAWINGS">FIG. <b>7</b></figref> is an example using a one-dimensional map for calculating the stator resistance R from the stator temperature Ts. The stator resistance R obtained by the one-dimensional map, the q-axis inductance regarded as a constant value, and the rotor rotational speed (rotation speed &#x3c9;) are used to calculate &#x3b2;ideal=tan<sup>&#x2212;1 </sup>(&#x2212;&#x3c9;&#xb7;<i>Lq/R</i>). Further, in a modification of <figref idref="DRAWINGS">FIG. <b>8</b></figref>, a two-dimensional map or a table for the rotational speed and the stator temperature is stored, and the ideal current phase &#x3b2;ideal is calculated with reference to the two-dimensional map. The two-dimensional map is created in advance by changing the stator temperature and speed and acquiring current phases with an actual machine.</p><heading id="h-0012" level="1">Second Embodiment</heading><p id="p-0068" num="0064">In the present embodiment, a noise removal unit is further provided in addition to the configuration of the magnetic pole position correction unit <b>46</b> illustrated in <figref idref="DRAWINGS">FIG. <b>5</b></figref>. The other points are common to those of the first embodiment. Ideally, three-phase short circuit currents are three-phase symmetrical sinusoidal currents as illustrated in the steady state of <figref idref="DRAWINGS">FIG. <b>4</b></figref>. In practice, however, the current becomes a current in which noise is superimposed due to a variation in impedance of each phase, a spatial harmonic of an induced voltage, an error of a current sensor, or the like. Further, the dq-axis current vibrates even in a case where a complete steady state is not formed. Therefore, the noise removal unit is provided in the present embodiment to eliminate influence thereof and more accurate angle correction can be implemented. The noise removal unit removes noise by a first-order lag filter or an averaging process.</p><p id="p-0069" num="0065"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a block diagram in a case where a noise removal unit <b>56</b> is provided at a subsequent stage of a deviation calculation unit that obtains a deviation between the actual current phase Pact and the ideal current phase &#x3b2;ideal. Alternatively, noise removal units <b>57</b> and <b>58</b> may be provided at subsequent stages of an actual phase calculation unit and an ideal current phase calculation unit, respectively, as illustrated in <figref idref="DRAWINGS">FIG. <b>10</b></figref>.</p><heading id="h-0013" level="1">REFERENCE SIGNS LIST</heading><p id="p-0070" num="0000"><ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0066"><b>1</b> inverter</li>    <li id="ul0001-0002" num="0067"><b>2</b> motor</li>    <li id="ul0001-0003" num="0068"><b>3</b> battery</li>    <li id="ul0001-0004" num="0069"><b>4</b> controller</li>    <li id="ul0001-0005" num="0070"><b>5</b> to <b>7</b> three-phase winding</li>    <li id="ul0001-0006" num="0071"><b>8</b> magnetic pole position sensor</li>    <li id="ul0001-0007" num="0072"><b>9</b> magnetic pole position signal</li>    <li id="ul0001-0008" num="0073"><b>10</b> current sensor</li>    <li id="ul0001-0009" num="0074"><b>11</b> U-phase current sensor signal</li>    <li id="ul0001-0010" num="0075"><b>12</b> V-phase current sensor signal</li>    <li id="ul0001-0011" num="0076"><b>13</b> W-phase current sensor signal</li>    <li id="ul0001-0012" num="0077"><b>14</b> to <b>19</b> switching element</li>    <li id="ul0001-0013" num="0078"><b>20</b> to <b>25</b> IGBT</li>    <li id="ul0001-0014" num="0079"><b>26</b> to <b>31</b> gate drive signal</li>    <li id="ul0001-0015" num="0080"><b>32</b> gate signal</li>    <li id="ul0001-0016" num="0081"><b>33</b> high-potential DC wiring</li>    <li id="ul0001-0017" num="0082"><b>34</b> low-potential DC wiring</li>    <li id="ul0001-0018" num="0083"><b>35</b> gate drive circuit</li>    <li id="ul0001-0019" num="0084"><b>36</b> voltage sensor</li>    <li id="ul0001-0020" num="0085"><b>37</b> DC voltage sensor signal</li>    <li id="ul0001-0021" num="0086"><b>38</b> smoothing capacitor</li>    <li id="ul0001-0022" num="0087"><b>39</b> torque command</li>    <li id="ul0001-0023" num="0088"><b>40</b> current command calculation unit</li>    <li id="ul0001-0024" num="0089"><b>41</b> three-phase/two-phase conversion unit</li>    <li id="ul0001-0025" num="0090"><b>42</b> current control unit</li>    <li id="ul0001-0026" num="0091"><b>43</b> two-phase/three-phase conversion unit</li>    <li id="ul0001-0027" num="0092"><b>44</b> velocity calculation unit</li>    <li id="ul0001-0028" num="0093"><b>45</b> PWM gate control signal generation unit (control signal generation unit)</li>    <li id="ul0001-0029" num="0094"><b>46</b> magnetic pole position correction unit</li>    <li id="ul0001-0030" num="0095"><b>47</b> deviation calculator</li>    <li id="ul0001-0031" num="0096"><b>48</b> deviation calculator</li>    <li id="ul0001-0032" num="0097"><b>49</b> adder</li>    <li id="ul0001-0033" num="0098"><b>50</b> corrected magnetic pole position signal (&#x3b8;&#x2032;)</li>    <li id="ul0001-0034" num="0099"><b>55</b> ideal current phase calculation unit</li>    <li id="ul0001-0035" num="0100"><b>56</b> to <b>58</b> noise removal unit</li>    <li id="ul0001-0036" num="0101"><b>65</b> motor drive device (motor control device)</li></ul></p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A power conversion device comprising:<claim-text>an inverter that converts a DC voltage into an AC voltage and drives a synchronous motor; and</claim-text><claim-text>a magnetic pole position correction unit that corrects an error in a magnetic pole position of a rotor from a rotation angle sensor of the synchronous motor,</claim-text><claim-text>wherein the magnetic pole position correction unit</claim-text><claim-text>includes an actual current phase calculation unit that calculates a current phase from a current when three-phase lines are short-circuited during rotation of the synchronous motor, and</claim-text><claim-text>an ideal current phase calculation unit that calculates an ideal current phase based on a rotational speed of the rotor and a temperature of a stator, and</claim-text><claim-text>corrects the magnetic pole position from a difference between outputs of the actual current phase calculation unit and the ideal current phase calculation unit.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The power conversion device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the magnetic pole position correction unit starts to operate after three-phase currents transition to a steady state after the short circuit among the three-phase lines.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The power conversion device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising<claim-text>a noise removal unit configured for a difference between the outputs of the actual current phase calculation unit and the ideal current phase calculation unit or calculated actual phase and ideal phase.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The power conversion device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the ideal current phase calculation unit calculates an ideal current phase based on the rotational speed of the rotor, the temperature of the stator, and a temperature of the rotor of the synchronous motor.</claim-text></claim-text></claim></claims></us-patent-application>