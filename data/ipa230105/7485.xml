<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007486A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007486</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17855355</doc-number><date>20220630</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>IN</country><doc-number>202141029386</doc-number><date>20210630</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>088</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>12</main-group><subgroup>66</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>088</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>12</main-group><subgroup>66</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">SYSTEM AND METHOD OF NETWORKING SECURITY FOR VIRTUALIZED BASE STATION</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>CommScope Technologies LLC</orgname><address><city>Hickory</city><state>NC</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Ni</last-name><first-name>James J.</first-name><address><city>Medford</city><state>MA</state><country>US</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Ramakrishnan</last-name><first-name>Shanthakumar</first-name><address><city>Westford</city><state>MA</state><country>US</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Sambandan</last-name><first-name>Devaraj</first-name><address><city>Bengaluru</city><country>IN</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>Dharwadkar</last-name><first-name>Sriram</first-name><address><city>Bangalore</city><country>IN</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>Daeipour</last-name><first-name>Ehsan</first-name><address><city>Southborough</city><state>MA</state><country>US</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>CommScope Technologies LLC</orgname><role>02</role><address><city>Hickory</city><state>NC</state><country>US</country></address></addressbook></assignee></assignees></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">Systems and methods for implementing IPsec connections for one or more virtualized base station entities are provided.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="153.59mm" wi="141.39mm" file="US20230007486A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="178.48mm" wi="143.43mm" file="US20230007486A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="236.39mm" wi="163.32mm" file="US20230007486A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="242.06mm" wi="142.16mm" orientation="landscape" file="US20230007486A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="216.15mm" wi="142.16mm" orientation="landscape" file="US20230007486A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="237.66mm" wi="93.73mm" orientation="landscape" file="US20230007486A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="237.66mm" wi="93.73mm" orientation="landscape" file="US20230007486A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="252.48mm" wi="169.08mm" orientation="landscape" file="US20230007486A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading><p id="p-0002" num="0001">This application claims priority to IN Provisional Application No. 202141029386 filed on Jun. 30, 2021, and titled &#x201c;SYSTEM AND METHOD OF NETWORKING SECURITY FOR VIRTUALIZED BASE STATION,&#x201d; the contents of which are hereby incorporated by reference in their entirety.</p><heading id="h-0002" level="1">BACKGROUND</heading><p id="p-0003" num="0002">Cloud-based virtualization of Fifth Generation (5G) base stations (also referred to as &#x201c;g NodeBs&#x201d; or &#x201c;gNBs&#x201d;) is widely promoted by standards organizations, wireless network operators, and wireless equipment vendors. Such an approach can help provide better high-availability and scalability solutions as well as addressing other issues in the network.</p><p id="p-0004" num="0003"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a block diagram illustrating a typical 5G distributed gNB. In general, a distributed 5G gNB can be partitioned into different entities, each of which can be implemented in different ways. For example, each entity can be implemented as a physical network function (PNF) or a virtual network function (VNF) and in different locations within an operator's network (for example, in the operator's &#x201c;edge cloud&#x201d; or &#x201c;central cloud&#x201d;).</p><p id="p-0005" num="0004">In the particular example shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, a distributed 5G gNB <b>100</b> is partitioned into one or more central units (CUs) <b>102</b>, one or more distributed units (DUs) <b>104</b>, and one or more radio units (RUs) <b>106</b>. In this example, each CU <b>102</b> is further partitioned into a central unit control-plane (CU-CP) <b>108</b> and one or more central unit user-planes (CU-UPs) <b>110</b> dealing with the gNB Packet Data Convergence Protocol (PDCP) and higher layers of functions of the respective control and user planes of the gNB <b>100</b>. Each DU <b>104</b> is configured to implement the upper part of the physical layer through the radio link control (RLC) layer of both the control-plane and user-plane of the gNB <b>100</b>. In this example, each RU <b>106</b> is configured to implement the radio frequency (RF) interface and lower physical layer control-plane and user-plane functions of the gNB <b>100</b>.</p><p id="p-0006" num="0005">Each RU <b>106</b> is typically implemented as a physical network function (PNF) and is deployed in a physical location where radio coverage is to be provided. Each DU <b>104</b> is typically implemented as a virtual network function (VNF) and, as the name implies, is typically distributed and deployed in a distributed manner in the operator's edge cloud. Each CU-CP <b>108</b> and CU-UP <b>110</b> are typically implemented as a virtual network functions (VNFs) and are typically centralized and deployed in the operator's central cloud.</p><p id="p-0007" num="0006">When deploying a distributed gNB <b>100</b>, operators have the option to deploy RUs <b>106</b>, DUs <b>104</b>, CU-CP <b>108</b>, and CU-UPs <b>110</b> all in one trusted network or to deploy any one of the DUs <b>104</b>, RUs <b>106</b>, the CU-CP <b>108</b>, and/or the CU-UPs <b>110</b> in an edge network, which is likely untrusted. In all deployment cases, there are additional features (for example, the management O1 connection inside/outside an operator's trusted networks, service orchestration virtual network management function (VNMF) inside/outside operators' trusted networks, virtual infrastructure management (VIM) function inside/outside operators' trusted network, etc.) that are utilized when implementing a virtualized gNB. The networking security in all deployment cases on various interfaces is a critical component of implementing a virtualized gNB.</p><heading id="h-0003" level="1">SUMMARY</heading><p id="p-0008" num="0007">In an example, a system to provide wireless service to user equipment comprises a scalable cloud environment configured to implement a base station using a plurality of virtualized base station entities, wherein each virtualized base station entity of the plurality of virtualized base station entities is configured to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment. The scalable cloud environment is also configured to implement a first Internet Protocol Security (IPsec) virtual gateway configured to be communicatively coupled to an external network. The first IPsec virtual gateway is configured to terminate an IPsec tunnel with the external network and route traffic from the external network to at least one application implemented by a first virtualized base station entity of the plurality of virtualized entities.</p><p id="p-0009" num="0008">In another example, a server comprises an Internet Protocol Security (IPsec) virtual gateway configured to be communicatively coupled to an external network. The server further comprises at least one application virtual network function of a first virtualized base station entity. The at least one application virtual network function is communicatively coupled to the IPsec virtual gateway via an internal network, and the first virtualized base station entity is configured to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment. The IPsec virtual gateway is configured to terminate an IPsec tunnel with the external network and route traffic from the external network to the at least one application virtual network function of the first virtualized base station entity.</p><p id="p-0010" num="0009">In another example, a method of providing wireless service to user equipment comprises using a scalable cloud environment configured to implement a base station using a plurality of virtualized entities, wherein each virtualized entity of the plurality of virtualized entities is configured to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment. The scalable cloud environment is further configured to implement a first Internet Protocol Security (IPsec) virtual gateway configured to be communicatively coupled to an external network. The first IPsec virtual gateway is configured to terminate an IPsec tunnel with the external network and route traffic from the external network to at least one application implemented by a first virtualized entity of the plurality of virtualized entities.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0004" level="1">DRAWINGS</heading><p id="p-0011" num="0010">Understanding that the drawings depict only exemplary embodiments and are not therefore to be considered limiting in scope, the exemplary embodiments will be described with additional specificity and detail through the use of the accompanying drawings, in which:</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a block diagram illustrating a typical 5G distributed gNB;</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a block diagram of an example virtualized 5G gNB;</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a block diagram of example connections between nodes of a virtualized 5G gNB and an external network using an Internet Protocol Security (IPsec) virtual gateway;</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a block diagram of example IPsec connections between a node of a virtualized 5G gNB and an external network;</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIGS. <b>5</b>A-<b>5</b>B</figref> are block diagrams illustrating an example of outgoing and incoming traffic flows through an IPsec virtual gateway; and</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a diagram of example implementation of a virtualized 5G gNB with various IPsec connections between nodes of the virtualized 5G gNB and external networks.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><p id="p-0018" num="0017">In accordance with common practice, the various described features are not drawn to scale but are drawn to emphasize specific features relevant to the exemplary embodiments.</p><heading id="h-0005" level="1">DETAILED DESCRIPTION</heading><p id="p-0019" num="0018">In the following detailed description, reference is made to the accompanying drawings that form a part hereof, and in which is shown by way of illustration specific illustrative embodiments. However, it is to be understood that other embodiments may be used and that logical, mechanical, and electrical changes may be made. The following detailed description is, therefore, not to be taken in a limiting sense.</p><p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a block diagram illustrating one example of a virtualized 5G gNB <b>200</b> in which the networking security techniques described here can be used. In the particular example shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the virtualized 5G gNB <b>200</b> is partitioned into one or more central units (CUs) <b>202</b>, which is composed of one central unit control-plane (CU-CP) virtual network function <b>216</b> and one or more central unit user-plane (CU-UP) virtual network functions <b>218</b>, one or more distributed units (DUs) <b>204</b>, which is composed of one or more DU virtual network functions <b>205</b>, and one or more radio units (RUs) <b>206</b>. In this example the virtualized 5G gNB <b>200</b> is configured so that each CU <b>202</b> is configured to serve one or more DUs <b>204</b> and each DU <b>204</b> is configured to serve one or more RUs <b>206</b>. In the particular configuration shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, a single CU <b>202</b> serves a single DU <b>204</b>, and the DU <b>204</b> shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref> serves three RUs <b>206</b>. However, the particular configuration shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref> is only one example; other numbers of CUs <b>202</b>, DUs <b>204</b>, and RUs <b>206</b> can be used. Also, the number of DUs <b>204</b> served by each CU <b>202</b> can vary from CU <b>202</b> to CU <b>202</b>; likewise, the number of RUs <b>206</b> served by each DU can vary from DU <b>204</b> to DU <b>204</b>. Moreover, although the following embodiments are primarily described as being implemented for use to provide 5G NR service, it is to be understood the techniques described here can be used with other wireless interfaces (for example, fourth generation (4G) Long-Term Evolution (LTE) service) and references to &#x201c;gNB&#x201d; can be replaced with the more general term &#x201c;base station&#x201d; or &#x201c;base station entity&#x201d; and/or a term particular to the alternative wireless interfaces (for example, &#x201c;enhanced NodeB&#x201d; or &#x201c;eNB&#x201d;). Furthermore, it is also to be understood that 5G NR embodiments can be used in both standalone and non-standalone modes (or other modes developed in the future) and the following description is not intended to be limited to any particular mode. Also, unless explicitly indicated to the contrary, references to &#x201c;layers&#x201d; or a &#x201c;layer&#x201d; (for example, Layer 1, Layer 2, Layer 3, the Physical Layer, the MAC Layer, etc.) set forth herein refer to layers of the wireless interface (for example, 5G NR or 4G LTE) used for wireless communication between a base station and user equipment).</p><p id="p-0021" num="0020">In general, the virtualized gNB <b>200</b> is configured to provide wireless service to various numbers of user equipment (UEs) <b>208</b> using one or more cells <b>210</b> (only one of which is shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref> for ease of illustration). Each RU <b>206</b> includes or is coupled to a respective set of one or more antennas <b>212</b> via which downlink RF signals are radiated to UEs <b>208</b> and via which uplink RF signals transmitted by UEs <b>208</b> are received.</p><p id="p-0022" num="0021">In one configuration (used, for example, in indoor deployments), each RU <b>206</b> is co-located with its respective set of antennas <b>212</b> and is remotely located from the DU <b>204</b> and CU <b>202</b> serving it as well as the other RUs <b>206</b>. In another configuration (used, for example, in outdoor deployments), the respective sets of antennas <b>212</b> for multiple RUs <b>206</b> are deployed together in a sectorized configuration (for example, mounted at the top of a tower or mast), with each set of antennas <b>212</b> serving a different sector. In such a sectorized configuration, the RUs <b>206</b> need not be co-located with the respective sets of antennas <b>212</b> and, for example, can be co-located together (for example, at the base of the tower or mast structure) and, possibly, co-located with its serving DUs <b>204</b>. Other configurations can be used.</p><p id="p-0023" num="0022">The virtualized gNB <b>200</b> is implemented using a scalable cloud environment <b>220</b> in which resources used to instantiate each type of entity can be scaled horizontally (that is, by increasing or decreasing the number of physical computers or other physical devices) and vertically (that is, by increasing or decreasing the &#x201c;power&#x201d; (for example, by increasing the amount of processing and/or memory resources) of a given physical computer or other physical device). The scalable cloud environment <b>220</b> can be implemented in various ways. For example, the scalable cloud environment <b>220</b> can be implemented using hardware virtualization, operating system virtualization, and application virtualization (also referred to as containerization) as well as various combinations of two or more of the preceding. The scalable cloud environment <b>220</b> can be implemented in other ways. For example, as shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the scalable cloud environment <b>220</b> is implemented in a distributed manner. That is, the scalable cloud environment <b>220</b> is implemented as a distributed scalable cloud environment <b>220</b> comprising at least one central cloud <b>214</b> and at least one edge cloud <b>215</b>.</p><p id="p-0024" num="0023">In the example shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, each RU <b>206</b> is implemented as a physical network function (PNF) and is deployed in or near a physical location where radio coverage is to be provided. In this example, each DU <b>204</b> is implemented with one or more DU virtual network functions (VNFs) <b>205</b> and, as the name implies, is distributed and deployed in a distributed manner in the edge cloud <b>215</b>. Each CU-CP is implemented with a CU-CP VNF <b>216</b> and each CU-UP is implemented with a CU-UP VNF <b>218</b> and, as the name implies, are centralized and deployed in the central cloud <b>214</b>. In the example shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the CU <b>202</b> (including the CU-CP VNF <b>216</b> and CU-UP VNF <b>218</b>) and the entities used to implement it are communicatively coupled to each DU <b>204</b> served by the CU <b>202</b> (and the DU VNF(s) <b>205</b> used to implement each such DU <b>204</b>) over a midhaul network <b>228</b> (for example, a network that supports the Internet Protocol (IP)). In the example shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, each DU <b>204</b>, and the DU VNF(s) <b>205</b> used to implement it, are communicatively coupled to each RU <b>206</b> served by the DU <b>204</b> using a fronthaul network <b>225</b> (for example, a switched Ethernet network that supports the IP).</p><p id="p-0025" num="0024">As shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the scalable cloud environment <b>220</b> comprises one or more cloud worker nodes <b>222</b> that are configured to execute cloud native software <b>224</b> that, in turn, is configured to instantiate, delete, communicate with, and manage one or more virtualized entities <b>226</b>. For example, where the networking security techniques described here are implemented at the operating system virtualization level, each cloud worker node <b>222</b> comprises one or more virtualized entities <b>226</b> and a cloud native software <b>224</b>, the cloud native software <b>224</b> comprises a shared host operating system, and the virtualized entities <b>226</b> comprise one or more virtual network functions (VNFs), and each VNF further comprises one or more functional containers. In another example, where the networking security techniques described here are implemented at the hardware virtualization level, the cloud worker nodes <b>222</b> comprise respective clusters of physical worker nodes, the cloud native software <b>224</b> comprises a hypervisor (or similar software), and the virtualized entities <b>226</b> comprise virtual machines.</p><p id="p-0026" num="0025">In the example shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, a node of the scalable cloud environment <b>220</b> is designated as the cloud &#x201c;master&#x201d; node <b>230</b>. The cloud master node <b>230</b> is configured to implement management and orchestration processes for the worker nodes <b>222</b> in a cluster and the cloud master node <b>230</b> is communicatively coupled to the worker nodes <b>222</b> via an orchestration and management network <b>229</b>. In some examples, the cloud master node <b>230</b> is configured to determine what runs on each of the cloud worker nodes <b>222</b>, which can include scheduling, resource allocation, state maintenance, and monitoring. In some examples, the cloud master node is configured to manage the lifecycle, scaling, and upgrades of workloads (such as containerized applications) on the cloud worker nodes <b>222</b>.</p><p id="p-0027" num="0026">In the example shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, each DU VNF <b>205</b>, CU-CP VNF <b>216</b>, and CU-UP VNF <b>218</b> is implemented as a software virtualized entity <b>226</b> that is executed in the scalable cloud environment <b>220</b> on a cloud worker node <b>222</b> under the control of the cloud native software <b>224</b> executing on that cloud worker node <b>222</b>. In the following description, a cloud worker node <b>222</b> that implements at least a part of a CU <b>202</b> (for example, a CU-CP VNF <b>216</b> and/or a CU-UP VNF <b>218</b>) is also referred to here as a &#x201c;CU cloud worker node&#x201d; <b>222</b>, and a cloud worker node <b>222</b> that implements at least a part of a DU <b>204</b> is also referred to here as a &#x201c;DU cloud worker node&#x201d; <b>222</b>.</p><p id="p-0028" num="0027">In the example shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the CU-CP VNF <b>216</b> and the CU-UP VNF <b>218</b> are each implemented as a single virtualized entity <b>226</b> executing on the same cloud worker node <b>222</b>. In the example shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the DU VNF <b>205</b> is implemented as a single virtualized entity <b>226</b> executing on the same cloud worker node <b>222</b>. However, it is to be understood that this is just one example and that different configurations and examples can be implemented in other ways. For example, the CU <b>202</b> can be implemented using multiple CU-UP VNFs <b>218</b> using multiple virtualized entities <b>226</b> executing on one or more cloud worker nodes <b>222</b>. In another example, multiple DU VNFs <b>205</b> (using multiple virtualized entities <b>226</b> executing on one or more cloud worker nodes <b>222</b>) can be used to serve a cell, where each of the multiple DU VNFs <b>205</b> serves a different set of RUs <b>206</b>. Moreover, it is to be understood that the CU <b>202</b> and DU <b>204</b> can be implemented in the same cloud (for example, together in an edge cloud <b>215</b>). Other configurations and examples can be implemented in other ways.</p><p id="p-0029" num="0028">Bringing a virtualized gNB (such as virtualized gNB <b>200</b>) up to service is generally performed in multiple stages by a variety of entities. The virtualization infrastructure/environment required for gNB VNFs is brought up from bare metal servers and relevant network and storage equipment (for example, using platform orchestration through an edge cloud node management network or controller). The gNB VNFs are then deployed and orchestrated into service providing entities (for example, using service orchestration through a virtual network function manager (VNFM)). The gNB VNFs are also configured and activated to make them service ready (for example, using service configuration with an Operations and Maintenance (OAM) entity or Device Management System (DMS)). The gNB VNFs will be communicatively coupled to many other components in different networks, which can include but are not limited to a platform orchestration network, a service orchestration network, a service management network, a mobile network (for example, an operator's mobile infrastructure including LTE/5G core and access networks), and a time service network (for example, 1588 traffic used for synchronization).</p><p id="p-0030" num="0029">When deploying and managing gNB VNFs, the location of the network elements determines the different networking and security requirements. When the virtual network functions (VNFs) used to implement a virtualized gNB are outside a trusted network (for example, outside the operator's mobile core network), the tunnel mode of Internet Protocol Security (IPsec) can generally be used between the VNF and each trusted network that communicates data with the VNF. In many situations, the number of IPsec tunnels connected to a mobile core operator's network is limited by an operator in order to reduce the exposure or vulnerability of the operator network because more IPsec tunnels generally increase the vulnerability of a network. The number of IPsec tunnels connected to a mobile core operator's network can also be limited by operator IPsec resource availability or operator network topology restrictions. If each IPsec tunnel is terminated by the relevant VNF, a prohibitively large amount of IPsec tunnels could be required to implement a distributed deployment (such as a deployment shown in and described with respect to <figref idref="DRAWINGS">FIG. <b>2</b></figref>).</p><p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates a block diagram of example connections between nodes of a virtualized gNB and an external network. In the example shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, two different nodes of the gNB, the CU node <b>302</b> and the DU node <b>304</b>, are communicatively coupled to an external network <b>322</b>. While <figref idref="DRAWINGS">FIG. <b>3</b></figref> specifically illustrates the CU node <b>302</b> and DU node <b>304</b> of a virtualized gNB, it should be understood that the techniques described with respect to these features can also be implemented for any virtualized base station entity used to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment. While not explicitly shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref> for clarity, it should be understood that the CU node <b>302</b> and the DU node <b>304</b> of the virtualized gNB in <figref idref="DRAWINGS">FIG. <b>3</b></figref> can be implemented using the scalable cloud platform and virtualization techniques described above. Further, while <figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates VNFs specific to the CU node <b>302</b> (CU-CP VNF <b>306</b> and CU-UP VNF <b>308</b>) and the DU node <b>304</b> (DU VNF <b>310</b>), it should be understood that the techniques described with respect to these features can also be implemented for other applications or VNFs implemented by a virtualized base station entity used to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment.</p><p id="p-0032" num="0031">In the example shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the CU node <b>302</b> includes a CU-CP VNF <b>306</b> and a CU-UP VNF <b>308</b> coupled to a first IPsec virtual gateway <b>312</b>. The first IPsec virtual gateway <b>312</b> is communicatively coupled to an external security gateway <b>320</b> of a network <b>322</b> (for example, a service management network such as an OAM network). For incoming traffic, the first IPsec virtual gateway <b>312</b> is configured to terminate the IPsec tunnel <b>316</b> between the CU node <b>302</b> and the external security gateway <b>320</b> (including removing encapsulation) and to route the traffic to the addressed terminating VNFs (CU-CP VNF <b>306</b> and CU-UP VNF <b>308</b>) accordingly. For outgoing traffic, the first IPsec virtual gateway <b>312</b> is configured to encapsulate the packets from the VNFs (CU-CP VNF <b>306</b> and CU-UP VNF <b>308</b>) inside the IPsec tunnel IP packets and transmit the IPsec tunnel IP packets to the external security gateway <b>320</b> via an IPsec tunnel <b>316</b>. The first IPsec virtual gateway <b>312</b> is configured to connect with the external security gateway <b>320</b> in a peer-to-peer mode (for example, gateway-to-gateway).</p><p id="p-0033" num="0032">In the example shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the DU node <b>304</b> includes a DU VNF <b>310</b> coupled to a second IPsec virtual gateway <b>314</b>. The second IPsec virtual gateway <b>314</b> is communicatively coupled to an external security gateway <b>320</b> of a network <b>322</b> (for example, a service management network such as an OAM network). For incoming traffic, the second IPsec virtual gateway <b>314</b> is configured to terminate the IPsec tunnel <b>318</b> between the DU node <b>304</b> and the external security gateway <b>320</b> (including removing encapsulation) and to route the traffic to the addressed terminating VNF (DU VNF <b>310</b>). For outgoing traffic, the second IPsec virtual gateway <b>314</b> is configured to encapsulate the packets from the VNFs (DU VNF <b>310</b>) inside the IPsec tunnel IP packets and transmit the IPsec tunnel IP packets to the external security gateway <b>320</b> via the IPsec tunnel <b>318</b>. The second IPsec virtual gateway <b>314</b> is configured to connect with the external security gateway <b>320</b> in a peer-to-peer mode (for example, gateway-to-gateway).</p><p id="p-0034" num="0033">The CU-CP VNF <b>306</b>, CU-UP VNF <b>308</b>, and DU VNF <b>310</b> are separate network elements and treated as physical entities from a network point of view. In the example shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the CU node <b>302</b> and the DU node <b>304</b> of the virtualized gNB each include an internal IP subnetwork that is exposed through the respective IPsec virtual gateway <b>312</b>, <b>314</b>. In some examples, the IPsec virtual gateway <b>312</b>, <b>314</b> and each of the VNFs <b>306</b>, <b>308</b>, <b>310</b> in a particular node are deployed as a microservice that has its own unique identity and IP address (used as an inner IP address for IPsec tunnel traffic). In such examples, the respective IPsec virtual gateway <b>312</b>, <b>314</b> exposes the IP addresses and identities of the elements for the internal subnetwork of the node to the external network <b>322</b> in a manner similar to a site-to-site VPN model, and the external network <b>322</b> is able to communicate with each VNF <b>306</b>, <b>308</b>, <b>310</b> of a node individually using the unique IP address for the respective VNF <b>306</b>, <b>308</b>, <b>310</b>.</p><p id="p-0035" num="0034">In some examples, each node has a respective IP subnetwork for each type of traffic where an IPsec connection is used. In such examples, each VNF <b>306</b>, <b>308</b>, <b>310</b> is assigned a respective IP address for each type of traffic that is communicated to/from that VNF <b>306</b>, <b>308</b>, <b>310</b>, which is used as an inner IP address for each type of traffic transmitted through an IPsec tunnel.</p><p id="p-0036" num="0035">In some such examples, when an IPsec virtual gateway <b>312</b>, <b>314</b> is used to connect the VNF <b>306</b>, <b>308</b>, <b>310</b> to an external network <b>322</b> via an IPsec tunnel, the IPsec virtual gateway <b>312</b>, <b>314</b> is assigned an IPv6 address as the gateway IP address of the subnetwork serving the VNFs <b>306</b>, <b>308</b>, <b>310</b> and an IPv4 address (used as an outer IP address for IPsec tunnel traffic) for the tunnel network interface communicatively coupled to the external network security gateway <b>320</b>, and the VNFs <b>306</b>, <b>308</b>, <b>310</b> are each assigned an IPv6 address (used as an inner source IP address of each of the VNFs traffic to be encapsulated inside the IPsec tunnel traffic) for the VNF network interface communicatively coupled to the IPsec virtual gateway <b>312</b>, <b>314</b>. The first IPsec virtual gateway <b>312</b> is configured to route traffic to/from the CU-CP VNF <b>306</b> and the CU-UP VNF <b>308</b> using the IPv6 address for the CU-CP VNF <b>306</b> and the CU-UP VNF <b>308</b>, and the second IPsec virtual gateway <b>314</b> is configured to route traffic to/from the DU VNF <b>310</b> using the IPv6 address for the DU VNF <b>310</b>.</p><p id="p-0037" num="0036">In other examples, when an IPsec virtual gateway <b>312</b>, <b>314</b> is used to connect the VNF <b>306</b>, <b>308</b>, <b>310</b> to an external network <b>322</b>, the IPsec virtual gateway <b>312</b>, <b>314</b> is assigned an IPv4 address as the gateway IP address of the subnetwork serving the VNFs <b>306</b>, <b>308</b>, <b>310</b> and an IPv6 address (used as an outer IP address for IPsec tunnel traffic) for the tunnel network interface communicatively coupled to the external network security gateway <b>320</b>, and the VNFs <b>306</b>, <b>308</b>, <b>310</b> are each assigned an IPv4 address (used as an inner source IP address of each of the VNFs traffic to be encapsulated inside the IPsec tunnel traffic) for the VNF network interface communicatively coupled to the IPsec virtual gateway <b>312</b>, <b>314</b>. In such examples, the first IPsec virtual gateway <b>312</b> is configured to route traffic to/from the CU-CP VNF <b>306</b> and the CU-UP VNF <b>308</b> using the IPv4 address for the CU-CP VNF <b>306</b> and the CU-UP VNF <b>308</b>, and the second IPsec virtual gateway <b>314</b> is configured to route traffic to/from the DU VNF <b>310</b> using the IPv4 address for the DU VNF <b>310</b>.</p><p id="p-0038" num="0037">In some examples, the traffic routed to/from the CU-CP VNF <b>306</b> and CU-UP VNF <b>308</b> via the first IPsec virtual gateway <b>312</b> is the same type of traffic (for example, O1 traffic from a service management network). In other examples, the traffic routed to the CU-CP VNF <b>306</b> is a different type of traffic than the traffic routed to the CU-UP VNF <b>308</b> via the first IPsec virtual gateway <b>312</b>. In one such example, the IPsec virtual gateway <b>312</b> is configured to communicate traffic with a mobile core network, route X2-C traffic transmitted using the IPsec tunnel <b>316</b> to the CU-CP VNF <b>306</b>, and route X2-U/S1-U traffic transmitted using the IPsec tunnel <b>316</b> to the CU-UP VNF <b>308</b>. In another such example, the IPsec virtual gateway <b>312</b> is configured to communicate traffic with a 5G mobile core network, route Xn-C/N2 traffic transmitted using the IPsec tunnel <b>316</b> to the CU-CP VNF <b>306</b>, and route Xn-U/N3 traffic transmitted using the IPsec tunnel <b>316</b> to the CU-UP VNF <b>308</b>.</p><p id="p-0039" num="0038">In either case, when multiple VNFs (for example, CU-CP VNF <b>306</b> and CU-UP VNF <b>308</b>) are connecting to the same external network <b>322</b>, an IPsec virtual gateway <b>312</b> can be shared by those VNFs. In some examples, the VNFs are manually configured to utilize the same IPsec virtual gateway <b>312</b>. In other examples, the VNFs and/or IPsec virtual gateway <b>312</b> utilize internal discovery capabilities to determine whether/when the VNFs will be configured to utilize the same IPsec virtual gateway <b>312</b>.</p><p id="p-0040" num="0039">While the CU node <b>302</b> and the DU node <b>304</b> are shown as including separate IPsec virtual gateways <b>312</b>, <b>314</b>, this may not be necessary if the CU node <b>302</b> and the DU node <b>304</b> are deployed on the same platform (for example, same server). In particular, if the CU node <b>302</b> (including the CU-CP VNF <b>306</b> and CU-UP VNF <b>308</b>) and the DU node <b>304</b> (include the DU VNF(s) <b>310</b>) are deployed on the same platform, then a single instance of an IPsec virtual gateway can be used for each respective traffic type. In such examples, the IPsec virtual gateway is configured to terminate the IPsec tunnel (including removing encapsulation) for a respective traffic type and route traffic to the CU-CP VNF <b>306</b>, CU-UP VNF <b>308</b>, and DU VNF <b>310</b> using the respective IP addresses for those entities. However, if the CU node <b>302</b> and the DU node <b>304</b> are deployed on different platforms (for example, different servers), then the separate IPsec virtual gateways <b>312</b>, <b>314</b> are needed in order to prevent exposing the subnetwork of an application in an untrusted environment.</p><p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates a block diagram of example connections between a node of a virtualized gNB and an external network. In the example shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>, the CU node <b>402</b> of the gNB is communicatively coupled to an external network <b>422</b>. While <figref idref="DRAWINGS">FIG. <b>4</b></figref> specifically illustrates the CU node <b>402</b> of a virtualized gNB, it should be understood that the techniques described with respect to these features can also be implemented for any virtualized base station entity used to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment. While not explicitly shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref> for clarity, it should be understood that the CU node <b>402</b> of the virtualized gNB in <figref idref="DRAWINGS">FIG. <b>4</b></figref> can be implemented using the scalable cloud platform and virtualization techniques described above. Further, while <figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates VNFs specific to the CU node <b>402</b> (CU-CP VNF <b>406</b> and CU-UP VNF <b>408</b>), it should be understood that the techniques described with respect to these features can also be implemented for other applications or VNFs implemented by a virtualized base station entity. Moreover, while <figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates multiple VNFs specific to the CU node <b>402</b> (CU-CP VNF <b>406</b> and CU-UP VNF <b>408</b>), it should be understood that other virtualized base station entities can implement one or more applications or VNFs and use similar techniques to those described below.</p><p id="p-0042" num="0041">In the example shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>, the CU node <b>402</b> includes a CU-CP VNF <b>406</b> and a CU-UP VNF <b>408</b>. In the example shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>, the CU-CP VNF <b>406</b> and the CU-UP VNF <b>408</b> are communicatively coupled to an external security gateway <b>420</b>. In contrast to the connections in <figref idref="DRAWINGS">FIG. <b>3</b></figref> that utilize an IPsec virtual gateway, the CU-CP VNF <b>406</b> and CU-UP VNF <b>408</b> are directly communicatively coupled to the external security gateway <b>420</b> using respective IPsec tunnels <b>417</b>, <b>419</b>, and the IPsec tunnels <b>417</b>, <b>419</b> are terminated at the application layer. The first IPsec tunnel <b>417</b> is terminated by the CU-CP VNF <b>406</b> and the second IPsec tunnel <b>419</b> is terminated by the CU-UP VNF <b>408</b>. The CU-CP VNF <b>406</b> and the CU-UP VNF <b>408</b> are each configured to respectively connect with the external security gateway <b>420</b> in a host-to-gateway mode.</p><p id="p-0043" num="0042">In the example shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>, the CU-CP VNF <b>406</b> and the CU-UP VNF <b>408</b> each include respective IP addresses that are exposed to the external network <b>422</b>. In some examples, the CU-CP VNF <b>406</b> and the CU-UP VNF <b>408</b> of the CU node <b>402</b> are deployed as microservices and have their own unique identity and IP address. In some examples, the CU-CP VNF <b>406</b> and the CU-UP VNF <b>408</b> each include a tunnel network interface (not shown) that, for incoming traffic, is configured to terminate the respective IPsec tunnel <b>417</b>, <b>419</b> (including removing encapsulation) that has a first IP address (used as an outer IP address for IPsec tunnel traffic) and terminate the tunneled traffic internally at the VNF <b>406</b>, <b>408</b> that has a second IP address (used as an inner IP address for IPsec tunnel traffic). For outgoing traffic, the tunnel network interface (not shown) for each respective VNF is configured to encapsulate the packets the respective VNF inside IPsec tunnel IP packets and transmit the IPsec tunnel IP packets to the external security gateway <b>420</b> via the respective IPsec tunnel <b>417</b>, <b>419</b>. In such examples, the respective tunnel network interfaces expose the IP addresses and identities of the elements for VNFs <b>406</b>, <b>408</b> of the CU node <b>402</b> to the external network <b>422</b> in a manner similar to a host-to-site VPN model, and the external network <b>422</b> is able to communicate with each VNF <b>406</b>, <b>408</b> of a node individually using the unique IP address for the respective VNF <b>406</b>, <b>408</b>.</p><p id="p-0044" num="0043">In some examples, each application has a respective IP address for each type of traffic where an IPsec connection is used. In such examples, the access network interface and the tunnel network interface for each respective VNF <b>406</b>, <b>408</b> are assigned a respective IP address for each type of traffic that is communicated to/from that VNF <b>406</b>, <b>408</b>. In some examples, the VNFs <b>406</b>, <b>408</b> are assigned an IPv6 address (used as an inner IP address for IPsec tunnel traffic) and an IPv4 address for the tunnel network interface (used as an outer IP address for IPsec tunnel traffic). In other examples, the VNFs <b>406</b>, <b>408</b> are assigned an IPv4 address (used as an inner IP address for IPsec tunnel traffic) and an IPv6 address for the tunnel network interface (used as an outer IP address for IPsec tunnel traffic).</p><p id="p-0045" num="0044">The traffic communicated to the CU-CP VNF <b>406</b> via the first IPsec tunnel <b>417</b> is a different type of traffic than the traffic communicated to the CU-UP VNF <b>408</b> via the second IPsec tunnel <b>419</b>. For example, the CU-CP VNF <b>406</b> is configured to communicate X2-C traffic via the first IPsec tunnel <b>417</b> with a mobile core network <b>422</b>, and the CU-UP VNF <b>408</b> is configured to communicate X2-U/S1-U traffic via the second IPsec tunnel <b>419</b> with the mobile core network <b>422</b>. In another example, the CU-CP VNF <b>406</b> is configured to communicate Xn-C/N2 traffic via the first IPsec tunnel <b>417</b> with a mobile core network <b>422</b>, and the CU-UP VNF <b>408</b> is configured to communicate Xn-U/N3 traffic via the second IPsec tunnel <b>419</b> with the mobile core network <b>422</b>.</p><p id="p-0046" num="0045"><figref idref="DRAWINGS">FIGS. <b>5</b>A-<b>5</b>B</figref> illustrate an example of outgoing and incoming traffic flows for an IPsec virtual gateway (for example, IPsec virtual gateway <b>312</b>, <b>314</b>, <b>612</b>, <b>613</b>, <b>614</b>). It should be understood that the IPsec virtual gateway can be used for communicating and routing any type of traffic for a virtualized 5G gNB. For example, an IPsec virtual gateway can be used to routing O1 traffic, O2 traffic, X2-C traffic, X2-U/S1-U traffic, F1-C traffic, F1-U traffic, N2 traffic, N3 traffic, Xn-C traffic, Xn-U traffic, or other types of traffic utilized for a virtualized 5G gNB or other base station. While not explicitly shown in <figref idref="DRAWINGS">FIG. <b>5</b></figref> for clarity, it should be understood that the application VNF <b>502</b> and the IPsec virtual gateway <b>504</b> in <figref idref="DRAWINGS">FIG. <b>5</b></figref> can be implemented using the scalable cloud platform and virtualization techniques described above.</p><p id="p-0047" num="0046">The example shown in <figref idref="DRAWINGS">FIG. <b>5</b>A</figref> illustrates outgoing traffic from an application VNF <b>502</b> being provided to an external network <b>508</b> via the IPsec virtual gateway <b>504</b>. In the example shown in <figref idref="DRAWINGS">FIG. <b>5</b>A</figref>, the application VNF <b>502</b> (for example, CU-CP VNF, CU-UP VNF, or DU VNF) includes a network interface <b>510</b> and is configured to transmit IP packets to an access network interface <b>512</b> of the IPsec virtual gateway <b>504</b>. The IPsec virtual gateway <b>504</b> is configured to transparently encapsulate the IP packets from the application VNF <b>502</b> into the IPsec tunnel IP packets and transmit the IPsec tunnel IP packets via the tunnel network interface <b>514</b> using an IPsec tunnel. The IPsec tunnel IP packets, which include the encapsulated IP packets from the application VNF <b>502</b>, are received at the security gateway <b>506</b> of the external network, and the security gateway is configured to remove the encapsulation of the IP packets. The security gateway <b>506</b> is also configured to route/deliver the IP packets to a network interface of an end point (for example, an OAM or DMS) in the external network subnet using the IP address of the end point.</p><p id="p-0048" num="0047">The example shown in <figref idref="DRAWINGS">FIG. <b>5</b>B</figref> illustrates incoming traffic from an external network <b>508</b> being provided to an application VNF <b>502</b> via the IPsec virtual gateway <b>504</b>. In the example shown in <figref idref="DRAWINGS">FIG. <b>5</b>B</figref>, the endpoint of an external network <b>508</b> is configured to transmit IP packets to the security gateway <b>506</b>. The security gateway <b>506</b> is configured to transparently encapsulate the IP packets from the endpoint of the external network <b>508</b> into the IPsec tunnel IP packets and transmit the IPsec tunnel IP packets to the IPsec virtual gateway <b>504</b> using an IPsec tunnel and the IP address of the tunnel network interface <b>514</b> (used as an outer IP address for IPsec tunnel traffic). The IPsec tunnel IP packets, which include the encapsulated IP packets from the endpoint of the external network <b>508</b>, are received at the tunnel network interface <b>514</b> of the IPsec virtual gateway <b>504</b>, and the IPsec virtual gateway <b>504</b> is configured to remove the encapsulation of the IP packets. The IPsec virtual gateway <b>504</b> is also configured to route/deliver the IP packets to the network interface <b>510</b> of the application VNF <b>502</b> (for example, CU-CP VNF, CU-UP VNF, or DU VNF) using the IP address of the network interface <b>510</b> of the application VNF <b>502</b> (used as an inner IP address for IPsec tunnel traffic).</p><p id="p-0049" num="0048">In some examples, the network interface <b>510</b> of the application VNF <b>502</b> is assigned an IPv6 address (inner IP address), the IPsec virtual gateway <b>504</b> is assigned an IPv6 address as the gateway IP address of the subnetwork, and the tunnel network interface <b>514</b> of the IPsec virtual gateway is assigned an IPv4 address (outer IP address). In such examples, the security gateway <b>506</b> is assigned an IPv4 address (outer IP address) and the end points in the external network subnet are assigned IPv6 addresses (inner IP address).</p><p id="p-0050" num="0049">In other examples, the network interface <b>510</b> of the application VNF <b>502</b> is assigned an IPv4 address (inner IP address), the IPsec virtual gateway <b>504</b> is assigned an IPv4 address as the gateway IP address of the subnetwork, and the tunnel network interface <b>514</b> of the IPsec virtual gateway is assigned an IPv6 address (outer IP address). In such examples, the security gateway <b>506</b> is assigned an IPv6 address (outer IP address) and the end points in the external network subnet are assigned IPv4 addresses (inner IP address).</p><p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. <b>6</b></figref> illustrates a block diagram of an example virtualized gNB and various networks. In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the virtualized gNB includes a CU server node <b>602</b> and a DU server node <b>604</b> that are communicatively coupled to external networks <b>622</b> using the IPsec tunnel techniques described above with respect to <figref idref="DRAWINGS">FIGS. <b>3</b>-<b>5</b></figref>. In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the CU node <b>602</b> and DU node <b>602</b> are coupled to external networks <b>622</b> through a public network <b>642</b> using particular trunk connections <b>640</b>. It should be understood that the virtualized gNB shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref> represents a specific example implementation and other implementations are possible and covered by the present disclosure. Further, while not explicitly shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref> for clarity, it should be understood that the components of the CU node <b>602</b> and DU node <b>604</b> in <figref idref="DRAWINGS">FIG. <b>6</b></figref> can be implemented using the scalable cloud platform and virtualization techniques described above.</p><p id="p-0052" num="0051">In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the CU node <b>602</b> includes a CU-CP VNF <b>606</b>, a CU-UP VNF <b>608</b>, and multiple IPsec virtual gateways <b>612</b>. In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the CU node <b>602</b> also includes a platform and service orchestration function <b>644</b>, logging services <b>646</b>, and a VNF image repository <b>648</b>. In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the CU node <b>602</b> also includes a public-key infrastructure (PKI) certificate authority (CA) application <b>651</b>. In some examples, these features of the CU node <b>602</b> are deployed as microservices in the CU node <b>602</b>.</p><p id="p-0053" num="0052">The CU node <b>602</b> of a virtualized gNB will always include at least one CU-CP VNF <b>606</b> and at least one CU-UP VNF <b>608</b>, but the other components of the virtualized gNB shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref> are implementation specific. It should be understood that the particular number of IPsec virtual gateways <b>612</b>, <b>613</b> in the CU node <b>602</b> and the elements of the CU node <b>602</b> can vary depending on the requirements for the virtualized gNB <b>600</b>.</p><p id="p-0054" num="0053">In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the CU-CP VNF <b>606</b> and the CU-UP VNF <b>608</b> are communicatively coupled to an external network <b>622</b>-<b>2</b> via the first IPsec virtual gateway <b>612</b>-<b>1</b>. The CU-CP VNF <b>606</b> and CU-UP VNF <b>608</b> are configured to communicate data with a service management network <b>622</b>-<b>2</b> using an IPsec tunnel <b>616</b>-<b>1</b> between the first IPsec virtual gateway <b>612</b>-<b>1</b> in the CU node <b>602</b> and a security gateway <b>620</b>-<b>2</b> of the service management network <b>622</b>-<b>2</b>. In some examples, the CU-CP VNF <b>606</b> and the CU-UP VNF <b>608</b> are configured to communicate O1 traffic with an Operations and Maintenance (OAM) entity or Device Management System (DMS) via the first IPsec virtual gateway <b>612</b>-<b>1</b> in a manner similar to that described above with respect to <figref idref="DRAWINGS">FIGS. <b>3</b> and <b>5</b></figref>. In particular, the first IPsec virtual gateway <b>612</b>-<b>1</b> includes a tunnel network interface <b>624</b> and an access network interface <b>626</b> and is configured to route O1 traffic to/from the network interfaces <b>628</b> of the CU-CP VNF <b>606</b> and the CU-UP VNF <b>608</b>. The first IPsec virtual gateway <b>612</b>-<b>1</b> is configured to terminate the IPsec tunnel <b>616</b>-<b>1</b> (including removing encapsulation) for incoming traffic, and the first IPsec virtual gateway <b>612</b>-<b>1</b> is configured to encapsulate packets from the CU-CP VNF <b>606</b> and CU-UP VNF <b>608</b> and transmit them to the security gateway <b>620</b>-<b>2</b> using the IPsec tunnel <b>616</b>-<b>1</b> for outgoing traffic.</p><p id="p-0055" num="0054">In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the CU-CP VNF <b>606</b> and the CU-UP VNF <b>608</b> are also communicatively coupled to another external network <b>622</b>-<b>1</b>. The CU-CP VNF <b>606</b> and the CU-UP VNF <b>608</b> are configured to communicate data with a mobile network <b>622</b>-<b>1</b> (for example, operator core network) via the respective IPsec tunnels <b>617</b>, <b>619</b> with the security gateway <b>620</b>-<b>1</b> of the mobile network <b>622</b>-<b>1</b>. In some examples, the CU-CP VNF <b>606</b> is configured to communicate X2-C traffic with the operator core network <b>622</b>-<b>1</b> using an IPsec tunnel <b>617</b> and the CU-UP VNF <b>608</b> is configured to communicate X2-U/S1-U traffic with the operator core network <b>622</b>-<b>1</b> using a different IPsec tunnel <b>619</b>. The CU-CP VNF <b>606</b> and the CU-UP VNF <b>608</b> are configured to implement IPsec client functions within the CU-CP VNF <b>606</b> and the CU-UP VNF <b>608</b> to terminate the respective IPsec tunnels <b>617</b>, <b>619</b> in a manner similar to that described above with respect to <figref idref="DRAWINGS">FIG. <b>4</b></figref>. In particular, the CU-CP <b>606</b> and the CU-UP VNF <b>608</b> each include a tunnel network interface <b>630</b> and second IP address configured in a manner similar to that described above with respect to <figref idref="DRAWINGS">FIG. <b>4</b></figref>. In other examples, an IPsec virtual gateway could include a tunnel network interface and an access network interface and be configured to route the X2/S1 (or Xn/N2/N3 for a 5GC) traffic to/from the network interfaces <b>632</b> of the CU-CP VNF <b>606</b> and the CU-UP VNF <b>608</b>.</p><p id="p-0056" num="0055">In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the platform and service orchestration function <b>644</b>, logging services <b>646</b>, and VNF image repository <b>648</b> are communicatively coupled to an external network <b>622</b>-<b>3</b> via a second IPsec virtual gateway <b>612</b>-<b>2</b>. The platform and service orchestration function <b>644</b>, logging services <b>646</b>, and VNF image repository <b>648</b> are configured to communicate data with a platform or service orchestration network using an IPsec tunnel <b>616</b>-<b>2</b> between the second IPsec virtual gateway <b>612</b>-<b>2</b> in the CU node <b>602</b> and a security gateway <b>620</b>-<b>2</b> of the platform or service orchestration network <b>622</b>-<b>3</b>. In some examples, the platform and service orchestration function <b>644</b>, logging services <b>646</b>, and VNF image repository <b>648</b> of the CU node <b>602</b> are configured to communicate O2 traffic with a virtual network function manager (VNFM) or REC controller of a platform or service orchestration network <b>622</b>-<b>3</b> via the second IPsec virtual gateway <b>612</b>-<b>2</b> in a manner similar to that described above with respect to <figref idref="DRAWINGS">FIGS. <b>3</b> and <b>5</b></figref>. In particular, the second IPsec virtual gateway <b>612</b>-<b>2</b> includes a tunnel network interface <b>624</b> and an access network interface <b>626</b> and is configured to route O2 traffic to/from the platform and service orchestration function <b>644</b>, logging services <b>646</b>, and VNF image repository <b>648</b> of the CU node <b>602</b>. The second IPsec virtual gateway <b>612</b>-<b>2</b> is configured to terminate the IPsec tunnel <b>616</b>-<b>2</b> (including removing encapsulation) for incoming traffic, and the second IPsec virtual gateway <b>612</b>-<b>2</b> is configured to encapsulate packets from the platform and service orchestration function <b>644</b>, logging services <b>646</b>, and VNF image repository <b>648</b> and transmit them to the security gateway <b>620</b>-<b>2</b> using the IPsec tunnel <b>616</b>-<b>2</b>.</p><p id="p-0057" num="0056">In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the CU-CP VNF <b>606</b> and the CU-UP VNF <b>608</b> are also communicatively coupled to the DU VNFs <b>610</b> via the third IPsec virtual gateway <b>613</b> in the CU node <b>602</b>. The CU-CP VNF <b>606</b> is configured to communicate control-plane data and the CU-UP VNF <b>608</b> configured to communicate user-plane data with the DU VNFs <b>610</b> using an IPsec tunnel <b>633</b> between the third IPsec virtual gateway <b>613</b> in the CU node <b>602</b> and an IPsec virtual gateway <b>615</b> of the DU node <b>604</b>. In some examples, the CU-CP VNF <b>606</b> is configured to communicate F1-C traffic with the DU VNFs <b>610</b> and the CU-UP VNF <b>608</b> is configured to communicate F1-U traffic with the DU VNFs <b>610</b> via the third IPsec virtual gateway <b>613</b>. In particular, the third IPsec virtual gateway <b>613</b> includes a tunnel network interface <b>634</b> and an access network interface <b>636</b> and is configured to route the F1 traffic to/from the network interfaces <b>638</b> of the CU-CP VNF <b>606</b> and the CU-UP VNF <b>608</b>. The third IPsec virtual gateway <b>613</b> is configured to terminate the IPsec tunnel <b>633</b> (including removing encapsulation) for incoming traffic, and the third IPsec virtual gateway <b>613</b> is configured to encapsulate packets from the CU-CP VNF <b>606</b> and CU-UP VNF <b>608</b> and transmit them to the IPsec virtual gateway <b>615</b> using the IPsec tunnel <b>633</b> for outgoing traffic.</p><p id="p-0058" num="0057">In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the PKI-CA application <b>651</b> is communicatively coupled to an operator CA server <b>622</b>-<b>4</b> via an IPsec tunnel <b>649</b> between a tunnel network interface <b>650</b> and a security gateway <b>620</b>-<b>3</b> for the operator CA <b>622</b>-<b>4</b>.</p><p id="p-0059" num="0058">In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the DU node <b>604</b> includes a first DU VNF instance <b>610</b>-<b>1</b>, a second DU VNF instance <b>610</b>-<b>2</b>, a first IPsec virtual gateway <b>614</b>, and a second IPsec virtual gateway <b>615</b>. In some examples, the DU VNF instances <b>610</b> and IPsec virtual gateways <b>614</b>, <b>615</b> are deployed as microservices in the DU node <b>604</b>.</p><p id="p-0060" num="0059">In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the first DU VNF instance <b>610</b>-<b>1</b> and the second DU VNF instance <b>610</b>-<b>2</b> are communicatively coupled to an external network <b>622</b>-<b>2</b> via the first IPsec virtual gateway <b>614</b> in the DU node <b>604</b>. The DU VNF instances <b>610</b> are configured to communicate data with the service management network <b>622</b>-<b>2</b> using an IPsec tunnel <b>618</b> between the first IPsec virtual gateway <b>614</b> in the DU node <b>604</b> and a security gateway <b>620</b>-<b>2</b> of the service management network <b>622</b>-<b>2</b>. In some examples, the DU VNF instances <b>610</b> are configured to communicate O1 traffic with an Operations and Maintenance (OAM) entity or Device Management System (DMS) via the first IPsec virtual gateway <b>614</b> in a manner similar to that described above with respect to <figref idref="DRAWINGS">FIGS. <b>3</b> and <b>5</b></figref>. In particular, the first IPsec virtual gateway <b>614</b> includes a tunnel network interface <b>625</b> and an access network interface <b>627</b> and is configured to route O1 traffic to/from the network interfaces <b>629</b> of the DU VNF instances <b>610</b>. The first IPsec virtual gateway <b>614</b> is configured to terminate the IPsec tunnel <b>618</b> (including removing encapsulation) for incoming traffic, and the first IPsec virtual gateway <b>614</b> is configured to encapsulate packets from the DU VNF instances <b>610</b> and transmit them to the security gateway <b>620</b>-<b>2</b> using the IPsec tunnel <b>618</b> for outgoing traffic.</p><p id="p-0061" num="0060">In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the first DU VNF instance <b>610</b>-<b>1</b> and the second DU VNF instance <b>610</b>-<b>2</b> are communicatively coupled to the CU-CP VNF <b>606</b> and CU-UP VNF <b>608</b> via the second IPsec virtual gateway <b>615</b> in the DU node <b>604</b>. The DU VNF instances <b>610</b> are configured to communicate control-plane data with the CU-CP VNF <b>606</b> and user-plane data with the CU-UP VNF <b>608</b> using an IPsec tunnel <b>633</b> between the third IPsec virtual gateway <b>613</b> in the CU node <b>602</b> and the second IPsec virtual gateway <b>615</b> of the DU node <b>604</b>. In some examples, the DU VNF instances <b>610</b> are configured to communicate F1-C traffic with the CU-CP VNF <b>606</b> and F1-U traffic with the CU-UP VNF <b>608</b> via the second IPsec virtual gateway <b>615</b> in the DU node <b>604</b>. In particular, the second IPsec virtual gateway <b>615</b> includes a tunnel network interface <b>635</b> and an access network interface <b>637</b> and is configured to route the F1 traffic to/from the network interfaces <b>639</b> of the DU VNF instances <b>610</b>. The second IPsec virtual gateway <b>615</b> is configured to terminate the IPsec tunnel <b>633</b> (including removing encapsulation) for incoming traffic, and the second IPsec virtual gateway <b>615</b> is configured to encapsulate packets from the DU VNF instances <b>610</b> and transmit them to the IPsec virtual gateway <b>613</b> using the IPsec tunnel <b>633</b> for outgoing traffic.</p><p id="p-0062" num="0061">In some examples, the virtualized gNBs described above can be deployed in a venue in conjunction with a Long-Term Evolution (LTE) Evolved NodeB (eNB). In some such examples, the LTE eNB is configured to communicate X2-C and X2-U/S1-U traffic with the security gateway of the mobile network using IPsec tunnels. In some examples, the LTE eNB can be implemented using virtualization techniques similar to those described above with respect to the virtualized gNBs. In such examples, the IPsec techniques described above with respect to <figref idref="DRAWINGS">FIGS. <b>3</b>-<b>5</b></figref> could be utilized in a similar manner for the virtualized eNB.</p><p id="p-0063" num="0062">Other examples are implemented in other ways.</p><p id="p-0064" num="0063">The systems and methods described herein provide flexible solutions for ensuring network security for virtualized base stations. The systems and methods described herein reduce the exposure or vulnerability of the operator network and enable compliance with operator network topology restrictions and implementation of the virtualized base station even with limited operator IPsec resource availability.</p><p id="p-0065" num="0064">The methods and techniques described here may be implemented in digital electronic circuitry, or with a programmable processor (for example, a special-purpose processor or a general-purpose processor such as a computer) firmware, software, or in combinations of them. Apparatus embodying these techniques may include appropriate input and output devices, a programmable processor, and a storage medium tangibly embodying program instructions for execution by the programmable processor. A process embodying these techniques may be performed by a programmable processor executing a program of instructions to perform desired functions by operating on input data and generating appropriate output. The techniques may advantageously be implemented in one or more programs that are executable on a programmable system including at least one programmable processor coupled to receive data and instructions from, and to transmit data and instructions to, a data storage system, at least one input device, and at least one output device. Generally, a processor will receive instructions and data from a read-only memory and/or a random-access memory. Storage devices suitable for tangibly embodying computer program instructions and data include all forms of non-volatile memory, including by way of example semiconductor memory devices, such as EPROM, EEPROM, and flash memory devices; magnetic disks such as internal hard disks and removable disks; magneto-optical disks; and DVD disks. Any of the foregoing may be supplemented by, or incorporated in, specially-designed application-specific integrated circuits (ASICs).</p><heading id="h-0006" level="1">Example Embodiments</heading><p id="p-0066" num="0065">Example 1 includes a system to provide wireless service to user equipment, the system comprising: a scalable cloud environment configured to implement: a base station using a plurality of virtualized base station entities, wherein each virtualized base station entity of the plurality of virtualized base station entities is configured to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment; and a first Internet Protocol Security (IPsec) virtual gateway configured to be communicatively coupled to an external network, wherein the first IPsec virtual gateway is configured to terminate an IPsec tunnel with the external network, wherein the first IPsec virtual gateway is configured to route traffic from the external network to at least one application implemented by a first virtualized base station entity of the plurality of virtualized entities.</p><p id="p-0067" num="0066">Example 2 includes the system of Example 1, wherein the plurality of virtualized base station entities include: a central unit (CU), wherein the CU is configured to implement at least one CU-control-plane (CU-CP) virtual network function and at least one CU-user-plane (CU-UP) virtual network function; and a distributed unit (DU) served by the CU, wherein the DU is configured to serve at least some of the user equipment, wherein the DU is configured to implement at least one DU virtual network function.</p><p id="p-0068" num="0067">Example 3 includes the system of Example 2, wherein the system comprises one or more radio units (RUs), each RU is communicatively coupled to the DU and is associated with a respective set of one or more antennas via which downlink radio frequency signals are radiated to at least some of the user equipment and via which uplink radio frequency signals transmitted by at least some of the user equipment are received.</p><p id="p-0069" num="0068">Example 4 includes the system of any of Examples 1-3, wherein the first IPsec virtual gateway is communicatively coupled to at least one virtual network function implemented by the first virtualized base station entity, wherein the first IPsec virtual gateway is configured to route traffic from the external network to the at least one virtual network function.</p><p id="p-0070" num="0069">Example 5 includes the system of any of Examples 1-4, wherein the first IPsec virtual gateway is communicatively coupled to a first virtual network function implemented by the first virtualized base station entity and a second virtual network function implemented by the first virtualized base station entity, wherein the traffic routed to the first virtual network function by the first IPsec virtual gateway is a different type of traffic compared to the traffic routed to the second virtual network function by the first IPsec virtual gateway.</p><p id="p-0071" num="0070">Example 6 includes the system of any of Examples 1-5, wherein a first virtual network function implemented by the first virtualized base station entity is configured to terminate a first IPsec tunnel between the first virtual network function and a second network.</p><p id="p-0072" num="0071">Example 7 includes the system of any of Examples 1-6, wherein the traffic includes one of: O1 traffic from a service management network; O2 traffic from a platform or service orchestration network; X2/S1 traffic from a first mobile core network; or Xn/N2/N3 traffic from a second mobile core network.</p><p id="p-0073" num="0072">Example 8 includes the system of any of Examples 1-7, wherein the scalable cloud environment is further configured to implement a second virtualized base station entity of the plurality of virtualized base station entities; wherein the first virtualized base station entity is configured to implement a second IPsec virtual gateway and the second virtualized base station entity is configured to implement a third IPsec virtual gateway, wherein the second IPsec virtual gateway is communicatively coupled to the third IPsec virtual gateway, wherein the second IPsec virtual gateway and the third IPsec virtual gateway are configured to terminate an IPsec tunnel between the first virtualized base station entity and the second virtualized base station entity, wherein the first virtualized base station entity and the second virtualized base station entity are configured to communicate traffic via the second IPsec virtual gateway and the third IPsec virtual gateway.</p><p id="p-0074" num="0073">Example 9 includes the system of any of Examples 1-8, further comprising an Evolved Node B (eNB) communicatively coupled to the external network, wherein the scalable cloud environment is configured to implement the eNB, wherein the eNB is configured to implement an IPsec virtual gateway configured to be communicatively coupled to a core network of an operator.</p><p id="p-0075" num="0074">Example 10 includes a server, comprising: an Internet Protocol Security (IPsec) virtual gateway configured to be communicatively coupled to an external network; and at least one application virtual network function of a first virtualized base station entity, wherein the at least one application virtual network function is communicatively coupled to the IPsec virtual gateway via an internal network, wherein the first virtualized base station entity is configured to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment; wherein the IPsec virtual gateway is configured to terminate an IPsec tunnel with the external network, wherein the IPsec virtual gateway is configured to route traffic from the external network to the at least one application virtual network function of the first virtualized base station entity.</p><p id="p-0076" num="0075">Example 11 includes the server of Example 10, wherein the internal network is an IP network.</p><p id="p-0077" num="0076">Example 12 includes the server of any of Examples 10-11, wherein the at least one application virtual network function includes a first virtual network function and a second virtual network function, wherein the first virtual network function is configured to terminate a first IPsec tunnel between the first virtual network function and a second network, wherein the second virtual network function is configured to terminate a second IPsec tunnel between the second virtual network function and the second network.</p><p id="p-0078" num="0077">Example 13 includes the server of any of Examples 10-12, wherein the server comprises a second IPsec virtual gateway, wherein the second IPsec virtual gateway is configured to terminate an IPsec tunnel between the first virtualized base station entity and a second virtualized base station entity configured to implement at least some functions for one or more layers of the wireless interface used to communicate with user equipment, wherein the first virtualized base station entity is configured to communicate traffic with the second virtualized base station entity via the second IPsec virtual gateway.</p><p id="p-0079" num="0078">Example 14 includes the server of any of Examples 10-13, wherein the traffic includes one of: O1 traffic from a service management network; O2 traffic from a platform or service orchestration network; X2/S1 traffic from a first mobile core network; or Xn/N2/N3 traffic from a second mobile core network.</p><p id="p-0080" num="0079">Example 15 includes a method of providing wireless service to user equipment, the method comprising: using a scalable cloud environment configured to implement: a base station using a plurality of virtualized entities, wherein each virtualized entity of the plurality of virtualized entities is configured to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment; and a first Internet Protocol Security (IPsec) virtual gateway configured to be communicatively coupled to an external network, wherein the first IPsec virtual gateway is configured to terminate an IPsec tunnel with the external network, wherein the first IPsec virtual gateway is configured to route traffic from the external network to at least one application implemented by a first virtualized entity of the plurality of virtualized entities.</p><p id="p-0081" num="0080">Example 16 includes the method of Example 15, wherein the plurality of virtualized entities include: a central unit (CU), wherein the CU is configured to implement at least one CU-control-plane (CU-CP) virtual network function and at least one CU-user-plane (CU-UP) virtual network function; and a distributed unit (DU) served by the CU, wherein the DU is configured to serve at least some of the user equipment, wherein the DU is configured to implement at least one DU virtual network function.</p><p id="p-0082" num="0081">Example 17 includes the method of any of Examples 15-16, wherein the first IPsec virtual gateway is communicatively coupled to at least one virtual network function implemented by the first virtualized entity, wherein the first IPsec virtual gateway is configured to route traffic from the external network to the at least one virtual network function.</p><p id="p-0083" num="0082">Example 18 includes the method of any of Examples 15-17, wherein the first IPsec virtual gateway is communicatively coupled to a first virtual network function and a second virtual network function, wherein the traffic routed to the first virtual network function by the first IPsec virtual gateway is a different type of traffic compared to the traffic routed to the second virtual network function by the first IPsec virtual gateway.</p><p id="p-0084" num="0083">Example 19 includes the method of any of Examples 15-18, wherein the first IPsec virtual gateway is communicatively coupled to at least one virtual network function implemented by the first virtualized entity, wherein the at least one virtual network function is configured to terminate a first IPsec tunnel between the at least one virtual network function and a second network.</p><p id="p-0085" num="0084">Example 20 includes the method of any of Examples 15-19, wherein the scalable cloud environment is further configured to implement a second IPsec virtual gateway configured to be communicatively coupled to a second external network or a second virtualized entity of the plurality of virtualized entities, wherein the second IPsec virtual gateway is configured to terminate an IPsec tunnel with the second external network or the second virtualized entity of the plurality of virtualized entities, wherein the first IPsec virtual gateway is configured to route traffic from the external network or the second virtualized entity of the plurality of virtualized entities to at least one application implemented by the first virtualized entity of the plurality of virtualized entities.</p><p id="p-0086" num="0085">A number of embodiments of the invention defined by the following claims have been described. Nevertheless, it will be understood that various modifications to the described embodiments may be made without departing from the spirit and scope of the claimed invention. Accordingly, other embodiments are within the scope of the following claims.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A system to provide wireless service to user equipment, the system comprising:<claim-text>a scalable cloud environment configured to implement:<claim-text>a base station using a plurality of virtualized base station entities, wherein each virtualized base station entity of the plurality of virtualized base station entities is configured to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment; and</claim-text><claim-text>a first Internet Protocol Security (IPsec) virtual gateway configured to be communicatively coupled to an external network, wherein the first IPsec virtual gateway is configured to terminate an IPsec tunnel with the external network, wherein the first IPsec virtual gateway is configured to route traffic from the external network to at least one application implemented by a first virtualized base station entity of the plurality of virtualized entities.</claim-text></claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the plurality of virtualized base station entities include:<claim-text>a central unit (CU), wherein the CU is configured to implement at least one CU-control-plane (CU-CP) virtual network function and at least one CU-user-plane (CU-UP) virtual network function; and</claim-text><claim-text>a distributed unit (DU) served by the CU, wherein the DU is configured to serve at least some of the user equipment, wherein the DU is configured to implement at least one DU virtual network function.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The system of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the system comprises one or more radio units (RUs), each RU is communicatively coupled to the DU and is associated with a respective set of one or more antennas via which downlink radio frequency signals are radiated to at least some of the user equipment and via which uplink radio frequency signals transmitted by at least some of the user equipment are received.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first IPsec virtual gateway is communicatively coupled to at least one virtual network function implemented by the first virtualized base station entity, wherein the first IPsec virtual gateway is configured to route traffic from the external network to the at least one virtual network function.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first IPsec virtual gateway is communicatively coupled to a first virtual network function implemented by the first virtualized base station entity and a second virtual network function implemented by the first virtualized base station entity, wherein the traffic routed to the first virtual network function by the first IPsec virtual gateway is a different type of traffic compared to the traffic routed to the second virtual network function by the first IPsec virtual gateway.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein a first virtual network function implemented by the first virtualized base station entity is configured to terminate a first IPsec tunnel between the first virtual network function and a second network.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the traffic includes one of:<claim-text>O1 traffic from a service management network;</claim-text><claim-text>O2 traffic from a platform or service orchestration network;</claim-text><claim-text>X2/S1 traffic from a first mobile core network; or</claim-text><claim-text>Xn/N2/N3 traffic from a second mobile core network.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the scalable cloud environment is further configured to implement a second virtualized base station entity of the plurality of virtualized base station entities;<claim-text>wherein the first virtualized base station entity is configured to implement a second IPsec virtual gateway and the second virtualized base station entity is configured to implement a third IPsec virtual gateway, wherein the second IPsec virtual gateway is communicatively coupled to the third IPsec virtual gateway, wherein the second IPsec virtual gateway and the third IPsec virtual gateway are configured to terminate an IPsec tunnel between the first virtualized base station entity and the second virtualized base station entity, wherein the first virtualized base station entity and the second virtualized base station entity are configured to communicate traffic via the second IPsec virtual gateway and the third IPsec virtual gateway.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising an Evolved Node B (eNB) communicatively coupled to the external network, wherein the scalable cloud environment is configured to implement the eNB, wherein the eNB is configured to implement an IPsec virtual gateway configured to be communicatively coupled to a core network of an operator.</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. A server, comprising:<claim-text>an Internet Protocol Security (IPsec) virtual gateway configured to be communicatively coupled to an external network; and</claim-text><claim-text>at least one application virtual network function of a first virtualized base station entity, wherein the at least one application virtual network function is communicatively coupled to the IPsec virtual gateway via an internal network, wherein the first virtualized base station entity is configured to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment;</claim-text><claim-text>wherein the IPsec virtual gateway is configured to terminate an IPsec tunnel with the external network, wherein the IPsec virtual gateway is configured to route traffic from the external network to the at least one application virtual network function of the first virtualized base station entity.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The server of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the internal network is an IP network.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The server of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the at least one application virtual network function includes a first virtual network function and a second virtual network function, wherein the first virtual network function is configured to terminate a first IPsec tunnel between the first virtual network function and a second network, wherein the second virtual network function is configured to terminate a second IPsec tunnel between the second virtual network function and the second network.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The server of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the server comprises a second IPsec virtual gateway, wherein the second IPsec virtual gateway is configured to terminate an IPsec tunnel between the first virtualized base station entity and a second virtualized base station entity configured to implement at least some functions for one or more layers of the wireless interface used to communicate with user equipment, wherein the first virtualized base station entity is configured to communicate traffic with the second virtualized base station entity via the second IPsec virtual gateway.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The server of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the traffic includes one of:<claim-text>O1 traffic from a service management network;</claim-text><claim-text>O2 traffic from a platform or service orchestration network;</claim-text><claim-text>X2/S1 traffic from a first mobile core network; or</claim-text><claim-text>Xn/N2/N3 traffic from a second mobile core network.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. A method of providing wireless service to user equipment, the method comprising:<claim-text>using a scalable cloud environment configured to implement:<claim-text>a base station using a plurality of virtualized entities, wherein each virtualized entity of the plurality of virtualized entities is configured to implement at least some functions for one or more layers of a wireless interface used to communicate with user equipment; and</claim-text><claim-text>a first Internet Protocol Security (IPsec) virtual gateway configured to be communicatively coupled to an external network, wherein the first IPsec virtual gateway is configured to terminate an IPsec tunnel with the external network, wherein the first IPsec virtual gateway is configured to route traffic from the external network to at least one application implemented by a first virtualized entity of the plurality of virtualized entities.</claim-text></claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the plurality of virtualized entities include:<claim-text>a central unit (CU), wherein the CU is configured to implement at least one CU-control-plane (CU-CP) virtual network function and at least one CU-user-plane (CU-UP) virtual network function; and</claim-text><claim-text>a distributed unit (DU) served by the CU, wherein the DU is configured to serve at least some of the user equipment, wherein the DU is configured to implement at least one DU virtual network function.</claim-text></claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the first IPsec virtual gateway is communicatively coupled to at least one virtual network function implemented by the first virtualized entity, wherein the first IPsec virtual gateway is configured to route traffic from the external network to the at least one virtual network function.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the first IPsec virtual gateway is communicatively coupled to a first virtual network function and a second virtual network function, wherein the traffic routed to the first virtual network function by the first IPsec virtual gateway is a different type of traffic compared to the traffic routed to the second virtual network function by the first IPsec virtual gateway.</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the first IPsec virtual gateway is communicatively coupled to at least one virtual network function implemented by the first virtualized entity, wherein the at least one virtual network function is configured to terminate a first IPsec tunnel between the at least one virtual network function and a second network.</claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the scalable cloud environment is further configured to implement a second IPsec virtual gateway configured to be communicatively coupled to a second external network or a second virtualized entity of the plurality of virtualized entities, wherein the second IPsec virtual gateway is configured to terminate an IPsec tunnel with the second external network or the second virtualized entity of the plurality of virtualized entities, wherein the first IPsec virtual gateway is configured to route traffic from the external network or the second virtualized entity of the plurality of virtualized entities to at least one application implemented by the first virtualized entity of the plurality of virtualized entities.</claim-text></claim></claims></us-patent-application>