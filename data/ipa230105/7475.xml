<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007476A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007476</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17409196</doc-number><date>20210823</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>IN</country><doc-number>202141029412</doc-number><date>20210630</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>06</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>03</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>0431</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>69</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>06</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>03</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>0431</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>69</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">5G NAS DECIPHERING ENHANCE RATE OF CONVERGENCE MECHANISM</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>NetScout Systems, Inc.</orgname><address><city>Westford</city><state>MA</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Liubinskas</last-name><first-name>Tauras</first-name><address><city>Lexington</city><state>KY</state><country>US</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Muthuchamy</last-name><first-name>Subappriya</first-name><address><city>Fremont</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Prasad</last-name><first-name>Sandeep</first-name><address><city>Pleasanton</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>Saraswati</last-name><first-name>Abhishek</first-name><address><city>Santa Clara</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>Pinelli</last-name><first-name>Alessandro</first-name><address><city>Modena</city><country>IT</country></address></addressbook></inventor><inventor sequence="05" designation="us-only"><addressbook><last-name>Aherrao</last-name><first-name>Pritish Vijay</first-name><address><city>Pune</city><country>IN</country></address></addressbook></inventor><inventor sequence="06" designation="us-only"><addressbook><last-name>Resta</last-name><first-name>Loreto Di</first-name><address><city>Modena</city><country>IT</country></address></addressbook></inventor><inventor sequence="07" designation="us-only"><addressbook><last-name>Bass</last-name><first-name>Brandon</first-name><address><city>Flower Mound</city><state>TX</state><country>US</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>NetScout Systems, Inc.</orgname><role>02</role><address><city>Westford</city><state>MA</state><country>US</country></address></addressbook></assignee></assignees></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">An illustrative embodiment disclosed herein is a non-transitory computer readable medium. In some aspects, the non-transitory computer readable medium includes instructions for providing a mobile user monitoring solution that, when executed by a processor, cause the processor to capture a transaction transmitted over an N12 interface, extract, from the transaction, one of an expected response (XRES) or an authentication token (AUTN), a user identifier (ID), and a cipher key, capture a first message transmitted over an N1 interface, and determine that the first message is associated with the user ID and the cipher key extracted from the transaction.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="117.35mm" wi="146.81mm" file="US20230007476A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="194.65mm" wi="158.92mm" orientation="landscape" file="US20230007476A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="199.64mm" wi="159.43mm" orientation="landscape" file="US20230007476A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="202.10mm" wi="144.36mm" orientation="landscape" file="US20230007476A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="220.81mm" wi="163.83mm" orientation="landscape" file="US20230007476A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="223.52mm" wi="161.04mm" orientation="landscape" file="US20230007476A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="230.21mm" wi="164.34mm" orientation="landscape" file="US20230007476A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="222.50mm" wi="160.61mm" orientation="landscape" file="US20230007476A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="210.14mm" wi="129.88mm" orientation="landscape" file="US20230007476A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading><p id="p-0002" num="0001">This application is related to and claims priority under 35 U.S. &#xa7; 119(b) the Indian Patent Application No. 202141029412, filed Jun. 30, 2021, titled &#x201c;5G NAS DECIPHERING ENHANCE RATE OF CONVERGENCE MECHANISM,&#x201d; the entire contents of which are incorporated herein by reference for all purposes.</p><heading id="h-0002" level="1">BACKGROUND</heading><p id="p-0003" num="0002">The 5G Core aggregates data traffic from end devices. The 5G Core also authenticates subscribers and devices, applies personalized policies and manages the mobility of the devices before routing the traffic to operator services or the Internet. The 5G Core and its predecessor, the Evolved Core Packet (EPC), are different in that the 5G Core is decomposed into a number of Service-Based Architecture (SBA) elements and is designed from the ground-up for complete control and user plane separation. Rather than physical network elements, the 5G Core comprises software-based network functions.</p><heading id="h-0003" level="1">SUMMARY</heading><p id="p-0004" num="0003">Aspects of the present disclosure relate generally to a 5G network, and more particularly to a system, apparatus, and method for monitoring N1 and N2 interfaces.</p><p id="p-0005" num="0004">An illustrative embodiment disclosed herein is a non-transitory computer readable medium. In some aspects, the non-transitory computer readable medium includes instructions for providing a mobile user monitoring solution that, when executed by a processor, cause the processor to capture a transaction transmitted over an N12 interface, extract, from the transaction, one of an expected response (XRES) or an authentication token (AUTN), a user identifier (ID), and a cipher key, capture a first message transmitted over an N1 interface, and determine that the first message is associated with the user ID and the cipher key extracted from the transaction.</p><p id="p-0006" num="0005">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to extract, from the first message, a second one of the XRES or the AUTN that matches the one of the XRES or the AUTN and retrieve, from the storage medium, the cipher key and the user ID using the second one of the XRES or the AUTN.</p><p id="p-0007" num="0006">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to extract, from the first message, a second one of the XRES or the AUTN that matches the one of the XRES or the AUTN, and retrieve, from the storage, the cipher key and the user ID using the second one of the XRES or the AUTN.</p><p id="p-0008" num="0007">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to extract, from a second message transmitted over the N1 interface, a first time that the second message is transmitted and extract, from a third message transmitted over the N1 interface, a second time that the third message is transmitted, wherein the transaction is transmitted at a time between the first time and the second time.</p><p id="p-0009" num="0008">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to capture a fourth message, determine that the fourth message is ciphered, and decipher the fourth message using the cipher key.</p><p id="p-0010" num="0009">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to extract a plurality of cipher keys from a plurality of transaction that are transmitted at the time between the first time and the second time and cycle through each of the plurality of cipher keys, attempting to decipher the fourth message with a current one of the plurality of cipher keys, until successfully deciphering the fourth message using the current one of the plurality of cipher keys.</p><p id="p-0011" num="0010">In some aspects, the transaction is an authentication request and an authentication response, the first message is an authentication message, the second message is a registration message, the third message is a security mode command message, and the fourth message is another message transmitted subsequent to the security mode command message being transmitted.</p><p id="p-0012" num="0011">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to capture a subsequent message transmitted over the N1 interface, decipher the subsequent message using the cipher key, extract session details from the subsequent message, and store the session details in a storage medium.</p><p id="p-0013" num="0012">An illustrative embodiment disclosed herein is a non-transitory computer readable medium. In some aspects, the apparatus includes a processor and a memory. In some aspects, the memory includes programmed instructions that, when executed by the processor, cause the apparatus to capture a transaction transmitted over an N12 interface, extract, from the transaction, one of an expected response (XRES) or an authentication token (AUTN), a user identifier (ID), and a cipher key, capture a first message transmitted over an N1 interface, and determine that the first message is associated with the user ID and the cipher key extracted from the transaction.</p><p id="p-0014" num="0013">In some aspects, the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to store the one of the XRES or the AUTN, the user ID, and the cipher key in a storage medium.</p><p id="p-0015" num="0014">In some aspects, the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to: extract, from the first message, a second one of the XRES or the AUTN that matches the one of the XRES or the AUTN and retrieve, from the storage medium, the cipher key and the user ID using the second one of the XRES or the AUTN.</p><p id="p-0016" num="0015">In some aspects, the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to: extract, from a second message transmitted over the N1 interface, a first time that the second message is transmitted and extract, from a third message transmitted over the N1 interface, a second time that the third message is transmitted, wherein the transaction is transmitted at a time between the first time and the second time.</p><p id="p-0017" num="0016">In some aspects, the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to: capture a fourth message, determine that the fourth message is ciphered, and decipher the fourth message using the cipher key.</p><p id="p-0018" num="0017">In some aspects, the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to: extract a plurality of cipher keys from a plurality of transaction that are transmitted at the time between the first time and the second time and cycle through each of the plurality of cipher keys, attempting to decipher the fourth message with a current one of the plurality of cipher keys, until successfully deciphering the fourth message using the current one of the plurality of cipher keys.</p><p id="p-0019" num="0018">In some aspects, the transaction is an authentication request and an authentication response, the first message is an authentication message, the second message is a registration message, the third message is a security mode command message, and the fourth message is another message transmitted subsequent to the security mode command message being transmitted.</p><p id="p-0020" num="0019">In some aspects, the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to: capture a subsequent message transmitted over the N1 interface, decipher the subsequent message using the cipher key, extract session details from the subsequent message, and store the session details in a storage medium.</p><p id="p-0021" num="0020">An illustrative embodiment disclosed herein is a method. In some aspects, the method includes capturing a transaction transmitted over an N12 interface, extracting, from the transaction, one of an expected response (XRES) or an authentication token (AUTN), a user identifier (ID), and a cipher key, capturing a first message transmitted over an N1 interface, and determining that the first message is associated with the user ID and the cipher key extracted from the transaction.</p><p id="p-0022" num="0021">In some aspects, the method includes storing the one of the XRES or the AUTN, the user ID, and the cipher key in a storage medium.</p><p id="p-0023" num="0022">In some aspects, the method includes extracting, from the first message, a second one of the XRES or the AUTN that matches the one of the XRES or the AUTN and retrieving, from the storage medium, the cipher key and the user ID using the second one of the XRES or the AUTN.</p><p id="p-0024" num="0023">In some aspects, the method includes extracting, from a second message transmitted over the N1 interface, a first time that the second message is transmitted and extracting, from a third message transmitted over the N1 interface, a second time that the third message is transmitted, wherein the transaction is transmitted at a time between the first time and the second time.</p><p id="p-0025" num="0024">Further details of aspects, objects, and advantages of the disclosure are described below in the detailed description, drawings, and claims. Both the foregoing general description and the following detailed description are exemplary and explanatory and are not intended to be limiting as to the scope of the disclosure. Particular embodiments may include all, some, or none of the components, elements, features, functions, operations, or steps of the embodiments disclosed above. The subject matter which can be claimed comprises not only the combinations of features as set out in the attached claims but also any other combination of features in the claims, wherein each feature mentioned in the claims can be combined with any other feature or combination of other features in the claims. Furthermore, any of the embodiments and features described or depicted herein can be claimed in a separate claim and/or in any combination with any embodiment or feature described or depicted herein or with any of the features of the attached claims.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a block diagram of an environment for monitoring a 5G network, in accordance with some embodiments.</p><p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> is a block diagram of the network monitoring device, in accordance with some embodiments.</p><p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. <b>2</b>B</figref> is a block diagram of records of one user that are in the correlation data structure and the session detail data structure, in accordance with some embodiments.</p><p id="p-0029" num="0028"><figref idref="DRAWINGS">FIGS. <b>3</b>A-<b>3</b>D</figref> are a flow chart of an example method for monitoring the 5G network, in accordance with some embodiments.</p><p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flow chart of an example method for monitoring the 5G network, in accordance with some embodiments.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><p id="p-0031" num="0030">The foregoing and other features of the present disclosure will become apparent from the following description and appended claims, taken in conjunction with the accompanying drawings. Understanding that these drawings depict only several embodiments in accordance with the disclosure and are, therefore, not to be considered limiting of its scope, the disclosure will be described with additional specificity and detail through use of the accompanying drawings.</p><heading id="h-0005" level="1">DETAILED DESCRIPTION</heading><p id="p-0032" num="0031">In the following detailed description, reference is made to the accompanying drawings, which form a part hereof. In the drawings, similar symbols typically identify similar components, unless context dictates otherwise. The illustrative embodiments described in the detailed description, drawings, and claims are not meant to be limiting. Other embodiments may be utilized, and other changes may be made, without departing from the spirit or scope of the subject matter presented here. It will be readily understood that the aspects of the present disclosure, as generally described herein, and illustrated in the figures, can be arranged, substituted, combined, and designed in a wide variety of different configurations, all of which are explicitly contemplated and make part of this disclosure.</p><p id="p-0033" num="0032">Tracking a user may include obtaining cipher keys for deciphering the user's messages as well as establishing mappings between temporary and permanent user identities that exist for the user within the 5G network. There are various challenges to obtaining the mappings and obtaining the cipher keys when monitoring the N1 interface (a 5G interface between the user and a core network, which is also known as the non-access stratum (NAS)) and the N2 interface (a 5G interface between a radio access network and the core network). In some embodiments, the mapping between the permanent user identity and the temporary user identities is unavailable. For example, an initial mapping between temporary to permanent user identifier (ID) message negotiation may be transmitted on the network very infrequently. It may take days, weeks, or months before this initial negotiation occurs. In some embodiments, there can be a disruption in the network feed or monitoring system which may break the mapping between the temporary user ID and the permanent user ID. In some embodiments, the authentication messages to negotiate the cipher keys by the NAS may themselves be ciphered, and keys for deciphering the ciphered authentication messages may be unavailable or unknown.</p><p id="p-0034" num="0033">Disclosed herein is a system, apparatus, and method that extract user information from messages transmitted over the N12 interface, capture user traffic transmitted over the N1/N2 interface, and determine that the user traffic of the message transmitted over the N1/N2 interface is associated with the user information from the messages on the N12 interface. In some embodiments, the system, apparatus, and method associate a correct cipher key for deciphering ciphered user traffic by mapping user information extracted from a message transmitted over the N1 interface to the cipher key stored in a correlation table. In some embodiments, the system, apparatus, and method associate a correct cipher key for deciphering ciphered user traffic by cycling through cached cipher keys until the user traffic is successfully deciphered.</p><p id="p-0035" num="0034">In some embodiments, the disclosure herein reduces a time of deciphering to a matter of hours or days instead of weeks or months. In addition, some embodiments of the disclosure minimize a number of times to actually run a deciphering algorithm, thereby reducing a central processing unit (CPU) consumption when trying to find the keys. Some embodiments of the disclosure speed up correlation of user data over the N1/N2 interface by allowing the NAS message to be deciphered quickly.</p><p id="p-0036" num="0035">Referring now to <figref idref="DRAWINGS">FIG. <b>1</b></figref>, a block diagram of an environment <b>100</b> for monitoring a 5G network is depicted, in accordance with some embodiments. The environment <b>100</b> includes a network monitoring device (e.g., a probe) <b>102</b> coupled to a 5G (New Radio) network <b>104</b>. The network monitoring device <b>102</b> captures traffic (e.g., messages, packets) transmitted on various interfaces of the 5G network <b>104</b>, deciphers traffic, extracts user data from the traffic, self-correlates user data, and correlates user data to subsequent traffic transmitted by the user over various interfaces.</p><p id="p-0037" num="0036">The 5G network <b>104</b> includes user equipment (UE) <b>106</b> such as a mobile device, a phone, a smart phone, an Internet of Things (IoT) device, a vehicular communications device, a computer, a laptop, a tablet, a smart watch, or any 3GPP device associated with a user. The 5G network <b>104</b> includes a radio access network (RAN) <b>108</b> that is in communication with the UE <b>106</b> via a Uu (air, wireless, etc.) interface <b>110</b>. The RAN <b>108</b> covers a geographical area which is divided into cell areas, with each cell area being served by a base station (e.g., a cell tower, a Next Generation nodeB (gNB), etc.).</p><p id="p-0038" num="0037">The 5G network <b>104</b> includes a core network (CN, e.g., a 5G core network) <b>112</b>, which provides access to one or more data networks (DN) such as the DN <b>114</b>. The CN <b>112</b> includes a service-based architecture (SBA) in which messaging/signaling between network functions (NFs) are exposed via (e.g., happen on top of) hypertext transfer protocol (HTTP)/2 representational state transfer (REST)-ful application program interface (API). Each of the components of the CN <b>112</b>, and other components of the 5G network <b>104</b>, can produce and/or consume NF services over the HTTP/2 transport. In some embodiments, container orchestrators (e.g., Docker Containers, Kubernetes) and microservices are employed in implementing the NFs. The CN <b>112</b> includes a user plane function (UPF) <b>126</b> that forwards messages from the RAN <b>108</b> to one or more data networks (DN) such as the DN <b>114</b> (e.g., the Internet, a Local Area Data Network, an Internet Protocol Multimedia Subsystem (IMS) network, etc.).</p><p id="p-0039" num="0038">The CN <b>112</b> includes the access and mobility management function (AMF) <b>114</b>, which manages access and of the UE <b>106</b>. The AMF <b>116</b> is responsible for coordinating authentication and registering users to the network. The AMF <b>116</b> also manages mobility of the UE <b>106</b> when the UE <b>106</b> roams from one gNB to another for session continuity. The AMF <b>116</b> is in communication with the UE <b>106</b> via an N1 interface <b>118</b>. The AMF <b>116</b> is in communication with the RAN <b>108</b> via an N2 interface <b>120</b>. <figref idref="DRAWINGS">FIG. <b>1</b></figref> shows the interfaces as logical interfaces. In particular, the N1 interface <b>106</b> is part of the non-access stratum (NAS) which is a highest functional layer in a protocol stack between the CN <b>112</b> and the UE <b>106</b>. Although most of the logical interfaces are same as their physical counterparts, messages transmitted over the N1 interface are physically transmitted via the RAN <b>108</b>.</p><p id="p-0040" num="0039">The CN <b>112</b> includes the authentication server function (AUSF) <b>122</b> in communication with the AMF <b>116</b> over the N12 interface <b>124</b>. The AUSF <b>122</b> is a part of the authentication procedure for authenticating the UE <b>106</b>. The AUSF <b>122</b> sends a challenge message to the UE <b>106</b>. The AUSF <b>122</b> verifies the authentication by comparing a response of the challenge message by the UE <b>106</b> to an expected response.</p><p id="p-0041" num="0040">The UE <b>106</b> registers and authenticates after the UE <b>106</b> transitions from an idle state. First, the UE <b>106</b> sends a registration (e.g., initial NAS) message to the AMF <b>116</b>. The registration message can include information elements (IEs) including IEs needed to establish security in the initial message when the UE <b>106</b> has no NAS security context. The registration message can include one or more temporary identifiers (IDs) such as a temporary mobile subscriber identity (TMSI), a shorten(S)-TMSI, a 5G-S-TMSI, a globally unique temporary ID (GUTI), or a 5G-GUTI. The registration message can include one or more concealed identifiers such as a subscription concealed ID (SUCI). The registration message is not ciphered.</p><p id="p-0042" num="0041">Next, if the AMF <b>116</b> is not able to find the security context locally or from a last visited AMF (e.g., an AMF from another CN), or if the integrity check fails, then the AMF <b>116</b> initiates an authentication procedure with the UE <b>106</b>. During the authentication procedure, in some embodiments, the AUSF <b>122</b> sends authentication vectors (AVs) to the AMF <b>116</b>. The AVs may include an authentication token (AUTN), an expected response (XRES), and one or more cipher keys (e.g., CK, K<sub>amf</sub>, K<sub>seaf</sub>, K<sub>ausf</sub>) for deciphering ciphered messages. In some embodiments, the AUSF <b>122</b> sends, to the AMF <b>116</b>, one or more permanent IDs such as one or more of a subscription permanent identifier (SUPI), an international mobile subscriber identity (IMSI), an international mobile equipment identity (IMEI), an IMEI software version (IMEISV), or a network access identity (NAI). In some embodiments, the SUPI includes one or more of the IMSI, the IMEI, the IMEISV, or the NAI.</p><p id="p-0043" num="0042">The AUSF <b>122</b> sends a challenge message to the UE <b>106</b> via the AMF <b>116</b>. The UE <b>106</b> generates a response (RES) to the challenge message using a key derivation function (KDF) possessed by the UE <b>106</b>. The UE <b>106</b> sends the RES to the AUSF <b>122</b> via the AMF <b>116</b>. The AUSF <b>122</b> authenticates the UE <b>106</b> by comparing the RES to the XRES to determine if the RES and the XRES match. In some embodiments, the messages sent during the authentication procedure between the UE <b>106</b> and the AMF <b>116</b> (herein, the authentication messages or the N1 authentication messages) are not ciphered, while in other embodiments, the N1 authentication messages are ciphered. The N12 authentication messages are not ciphered.</p><p id="p-0044" num="0043">Next, if the authentication is successful (e.g., XRES and the RES match), the AMF <b>116</b> sends the NAS security mode command message, which is not ciphered, to the UE <b>106</b>. Next, the UE <b>106</b> shall send the NAS security mode complete message to the AMF <b>116</b> in response to the NAS Security Mode Command message. The NAS security mode complete is ciphered and integrity protected.</p><p id="p-0045" num="0044">The network monitoring device <b>102</b> is connected to the 5G network <b>104</b> using various links. For example, the network monitoring device <b>102</b> is coupled to the N1 interface <b>118</b> via link <b>128</b>, the N2 interface <b>120</b> via link <b>130</b>, and the N12 interface <b>124</b> via link <b>132</b>. In some embodiments, the network monitoring device <b>102</b> is coupled to other interfaces (e.g., the Uu interface <b>110</b>) via other links. Each of the links can be passive or active and include software, firmware, and/or hardware components, such as taps, probes, or port mirrors that can be positioned in-line along communication links between various components of the 5G network <b>104</b>. In the case of a physical site, each link can receive a copy of packets flowing over the respective interface from a tap in-line with an edge router located at the physical site, or from a switch port analyzer (&#x201c;SPAN&#x201d;) port on the edge router.</p><p id="p-0046" num="0045">Referring now to <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>, a block diagram of the network monitoring device <b>102</b> is depicted, in accordance with some embodiments. The network monitoring device <b>102</b> includes a processor <b>202</b>, a first storage medium <b>204</b>, a second storage medium <b>206</b>, and a network interface <b>208</b>. The network monitoring device <b>102</b> may include other components such as input devices (e.g., keyboard, mouse) and output devices (e.g., display, monitor).</p><p id="p-0047" num="0046">The processor <b>202</b> executes computer instructions stored in one or more of the first storage medium <b>204</b> or the second storage medium <b>206</b>. Although only a single processor is shown in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>, any number of processors is within the scope of the present disclosure. The processor <b>202</b> includes a cache <b>214</b>. In some embodiments, user data extracted from captured traffic data can be stored in the cache <b>214</b>.</p><p id="p-0048" num="0047">The processor <b>202</b> includes one or more threads. For example, as shown in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>, the processor includes a collector thread <b>210</b> and a recorder thread <b>212</b>. In some embodiments, the collector thread <b>210</b> performs at least one of collecting user/session details/data/metadata (e.g., location information, a handset type, local network information, or service quality information) extracted from messages (e.g., N1 or N2 messages) transmitted over various (e.g., N1 or N2) interfaces, storing the session details in the cache <b>214</b> or the first storage medium <b>204</b>, or aggregating statistics on the session details. In some embodiments, the recorder thread <b>212</b> stores, or copies, one or more of the messages or the session details to the second storage medium <b>206</b>. Advantageously, by processing various messages in parallel in separate (e.g., dedicated) threads, the monitoring device <b>102</b> can achieve lower latency and live-time, or substantially live-time, monitoring of the 5G network <b>104</b>. Although the processor <b>202</b> is shown as having one core and two threads, the processor <b>202</b> can have any number of cores and threads and remain within the scope of the present disclosure.</p><p id="p-0049" num="0048">The first storage medium <b>204</b> stores instructions (e.g., computer instructions, programmed instructions) for one or more of processing, extracting, correlating, generating, storing, or retrieving traffic data (e.g., messages, packets, headers, payloads, fields, information elements, parameters, keys, etc.) or metadata derived from the traffic data. The first storage medium <b>204</b> is implemented in one of various devices (e.g., Random-Access Memory (RAM), static RAM (SRAM), dynamic RAM (DRAM), Resistive RAM (ReRAM), magnetoresistive RAM (MRAM)) that has a faster read or write speed than the second storage medium <b>206</b>.</p><p id="p-0050" num="0049">In some embodiments, the first storage medium <b>204</b> includes instructions for data capture <b>216</b>, N12 correlation <b>218</b>, N1 correlation <b>220</b>, and N1 decryption <b>222</b>. In some embodiments, one or more of the instructions <b>216</b>-<b>222</b> can be combined. In some embodiments, the data capture <b>216</b> instructions include instructions to capture messages (e.g., control packets or data packets). In some embodiments, the data capture <b>216</b> instructions include instructions to extract user data (e.g., temporary IDs, permanent IDs, cipher keys, time stamps, any parameters or state information related to user data) from the captured messages. For example, the data capture <b>216</b> instructions include instructions to extract one or more of security parameters such as XRES or AUTN, a permanent ID, or security context (e.g., one or more cipher keys, key set identifier, uplink and downlink NAS count, etc.) from authentication messages transmitted over the N12 interface. In some embodiments, the data capture <b>216</b> instructions include instructions to extract one or more of a time stamp or a temporary ID from a registration message transmitted over the N1 interface and a second time stamp from a security mode command message transmitted over the N1 interface. In another example, the data capture <b>216</b> instructions include instructions to extract one or more of the session details associated with the user (e.g., handset type, etc.) from messages transmitted over one or more of the N1 interface or the N2 interface. The data capture <b>216</b> instructions can include instructions for software agents or virtual devices that remotely operate on, or control, each of the links (e.g., links <b>128</b>, <b>130</b>, and <b>132</b>) and/or any associated hardware.</p><p id="p-0051" num="0050">In some embodiments, the N12 correlation <b>218</b> instructions include instructions to correlate/map/link any user data extracted from messages captured over the N12 interface <b>124</b>. For example, the N12 correlation <b>218</b> instructions include instructions to correlate an XRES to a permanent ID. In some embodiments, correlating includes storing the first parameter in a first field of a record associated with a user (e.g., an NGAP record or a user database record) and storing the second parameter in a second field of the record associated with the user. This may be referred to as generating a mapping from the first parameter to the second parameter. For example, the N12 correlation <b>218</b> instructions include instructions to store (e.g., populate) the XRES extracted from an N12 message in a first field of an XRES record and to store the permanent ID extracted from the N12 message in a second field of the XRES record. Similarly, in some embodiments, the N12 correlation <b>218</b> instructions include instructions to store the extracted permanent ID in a first field of a user database record and to store one or more cipher keys extracted from the N12 message in a second field of the user database record. In some embodiments, each mapping may be a key-value pair in which the first parameter (the XRES or the permanent ID) is a key and the second parameter (the permanent ID or the one or more cipher keys, respectively) is the value. In some embodiments, the first parameter is an input to a hash function which generates or fetches (e.g., retrieves) the second parameter or a location/address of the second parameter.</p><p id="p-0052" num="0051">In some embodiments, the N1 correlation <b>220</b> instructions include instructions to correlate any user data extracted from messages captured over the N1 interface <b>118</b>. For example, the N1 correlation <b>220</b> instructions include instructions to use a second XRES extracted from an authentication message transmitted over the N1 interface to retrieve, from the correlation data structure <b>224</b>, a permanent ID stored in the correlation data structure <b>224</b>. In some embodiments, the second XRES matches the XRES that the permanent ID was correlated with (e.g., mapped to). For instance, the N1 correlation <b>220</b> instructions include instructions to apply the hash function to the second XRES to retrieve the permanent ID. Once the permanent ID is retrieved, the N1 correlation <b>220</b> instructions include instructions to use the permanent ID (e.g., apply the hash function to the permanent ID) to retrieve, from the correlation data structure <b>224</b>, the one or more cipher keys that was previously mapped to the permanent ID.</p><p id="p-0053" num="0052">In some embodiments, the N1 correlation <b>220</b> instructions include instructions to correlate a temporary ID to a permanent ID and cipher keys to generate a mapping from the temporary ID to the permanent ID and the cipher keys. The N1 correlation <b>220</b> instructions include instructions to store the temporary ID-to-permanent ID mapping in the correlation data structure <b>224</b>. In some embodiments, the N1 correlation <b>220</b> instructions include instructions to use the temporary ID (or a second temporary ID extracted from another message and matching the temporary ID) to retrieve, from the correlation data structure <b>224</b>, the permanent ID and the cipher keys that were previously mapped to the temporary ID. One or more of the instructions of the N1 correlation <b>220</b> instructions may be interchangeable with one or more of the instructions of the N12 correlation <b>218</b> instructions.</p><p id="p-0054" num="0053">In some embodiments, the N1 correlation <b>218</b> instructions include instructions to store session details such as handset type in a session detail data structure, which may be stored in a storage medium separate from the storage medium where the correlation data structure <b>224</b> is stored. In some embodiments, a session detail record in the separate session detail data structure can be linked to a respective user database record in the correlation data structure <b>224</b>, for example, with an IMEI or an IMSI.</p><p id="p-0055" num="0054">In some embodiments, the N1 decryption <b>222</b> instructions include instructions to decipher a ciphered N1 message (e.g., a ciphered N1 authentication message, a ciphered N1 security mode complete message, a subsequent N1 ciphered message) using a cipher key. In some embodiments, the ciphered N1 message includes security-related IEs (e.g., an unciphered security header, a temporary ID, a permanent ID, an XRES, etc.) that is used to retrieve the one or more cipher keys that deciphers the ciphered N1 message. In some embodiments, a plurality of cipher keys are provided for deciphering and the N1 decryption <b>222</b> instructions include instructions to iteratively select one of the cipher keys to decipher the ciphered N1 message until the N1 message is successfully deciphered.</p><p id="p-0056" num="0055">In some embodiments, the N1 decryption <b>222</b> instructions include instructions to determine whether traffic data is ciphered. For example, security state information may be extracted from a message or a separate message that may indicate whether the message is ciphered. The N1 decryption <b>222</b> instructions may include instructions to decipher a message if the extracted security state information indicates that the message is ciphered.</p><p id="p-0057" num="0056">The first storage medium <b>204</b> includes the correlation data structure <b>224</b>, which stores the mappings in one or more data structures (e.g., databases, tables, files). For example, a first table stores a mapping of XRES-permanent ID pairs, a second table stores a mapping of temporary ID-permanent ID and cipher keys tuples. Each table can include a number of records (e.g., rows). In some embodiments, each record has a first field (e.g., entry) populated by the first parameter (e.g., information element) of the mapping, or a hash thereof, and each of the one or more second fields populated by the second parameter (e.g., one of the second parameters, if there is more than one) of the mapping, or a hash thereof. In some embodiments, the table is a hash table (e.g., a key-value table) in which the record containing the one or more second fields (e.g., the values, values in a bucket, etc.) is determined, fetched, or located based on transforming the first parameter by a hashing function (e.g., modulus of a predetermined number).</p><p id="p-0058" num="0057">The second storage medium <b>206</b> stores data or metadata that is the result of processing or correlating the traffic data. The second storage medium <b>206</b> is implemented in one of various devices (e.g., solid-state drive, hard disk drive, optical drive, etc.) that can store a greater amount of data than the first storage medium <b>204</b>. In some embodiments, the second storage medium <b>206</b> stores the instructions for the data capture <b>216</b>, the N12 correlation <b>218</b>, the N1 correlation <b>220</b>, and the N1 decryption <b>222</b>, or instances thereof. In some embodiments, the processor <b>202</b> can execute each of the instructions <b>216</b>, <b>218</b>, <b>220</b>, and <b>222</b> from the second storage medium <b>206</b>. In some embodiments, the second storage medium <b>206</b> stores copies of the correlation data structures <b>224</b>.</p><p id="p-0059" num="0058">In some embodiments, the second storage medium <b>206</b> includes the session detail data structure <b>226</b>. The session detail data structure <b>226</b> includes session details (e.g., location information, a handset type, local network information, or service quality information) extracted from the captured messages. In some embodiments, session details (e.g., location information, a handset type, local network information, or service quality information) for each user are in a respective session detail record. In some embodiments, a user's session detail record persists even after the user has changed temporary IDs. In some embodiments, the second storage medium <b>206</b> stores the captured messages, monitoring-related user parameters (e.g., temporary ID) extracted from the captured messages, etc.</p><p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. <b>2</b>B</figref> illustrates records of one user that are in the correlation data structure <b>224</b> and the session detail data structure <b>226</b>, in accordance with some embodiments of the present disclosure. In some embodiments, the correlation data structure <b>224</b> includes an XRES record <b>260</b> and a user database record <b>265</b>. In some embodiments, the XRES record <b>260</b> includes an XRES field <b>262</b> and a permanent ID field <b>264</b>, and the user database record <b>265</b> includes a temporary ID field <b>266</b>, the permanent ID field <b>264</b>, and a security context (e.g., cipher key) field <b>268</b>. In some embodiments, the session detail data structure <b>226</b> includes a session detail record <b>270</b>. In some embodiments, the session detail record <b>270</b> includes a permanent ID field <b>264</b> and a session details field <b>272</b>. In some embodiments, the session details field <b>272</b> includes multiple fields (e.g., at least one for handset type, at least one for local network information, at least one for location information, at least one for service quality information, etc.).</p><p id="p-0061" num="0060">Returning to <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>, the network interface <b>208</b> may include a NIC (network interface card) or other standard network interfaces to receive captured network traffic and communicate with other network interface devices. For example, the network interfaces <b>208</b> may include an N1 interface (e.g., the link <b>128</b>), an N2 interface (e.g., the link <b>130</b>), an N12 interface (e.g., the link <b>132</b>), a 802.11 interface, an Ethernet interface, or other wired or wireless network interfaces.</p><p id="p-0062" num="0061">Referring now to <figref idref="DRAWINGS">FIGS. <b>3</b>A-<b>3</b>D</figref>, a flow chart of an example method <b>300</b> for monitoring the 5G network <b>104</b> is depicted, in accordance with some embodiments. The method <b>300</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>300</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>300</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>300</b> may be performed in parallel.</p><p id="p-0063" num="0062">Referring now to <figref idref="DRAWINGS">FIG. <b>3</b>A</figref>, the processor <b>202</b> captures a registration message transmitted over the N1 interface <b>118</b> (at operation <b>302</b>). The processor extracts, from the registration message, a first time stamp (at operation <b>304</b>). The processor <b>202</b> extracts, from the registration message, a temporary ID (at operation <b>306</b>). In some embodiments, the temporary ID includes a TMSI or a GUTI.</p><p id="p-0064" num="0063">The processor <b>202</b> determines that the temporary ID is not in a first table (at operation <b>308</b>). The first table may be a first correlation table (e.g., user database record <b>265</b>). The first table may be a first correlation table that includes mappings of temporary IDs and respective permanent IDs and/or respective cipher keys.</p><p id="p-0065" num="0064">The processor <b>202</b> captures an authentication transaction transmitted over the N12 interface <b>124</b> (at operation <b>310</b>). In some embodiments, the authentication transactions includes a pair of authentication messages. In some embodiments, the authentication transaction includes an authentication request message and an authentication response message. The processor <b>202</b> extracts, from the authentication transaction, an expected response (XRES), a permanent ID, and a cipher key (at operation <b>312</b>). For example, the processor <b>202</b> extracts the XRES and the permanent ID from the authentication request message and the cipher key from the authentication response message.</p><p id="p-0066" num="0065">Referring now to <figref idref="DRAWINGS">FIG. <b>3</b>B</figref>, the processor <b>202</b> stores the XRES, the permanent ID, and the cipher key in one or more correlation tables (at operation <b>314</b>). For example, the XRES and the permanent ID can be stored as a record in a second correlation table (e.g., XRES record <b>260</b>) and the permanent ID and the cipher key can be stored as a record in the first correlation table. In some embodiments, the XRES is stored as a first hash of the XRES and the permanent ID is stored as a hash of the permanent ID. In some embodiments, the permanent ID includes one or more of a Subscription Permanent Identifier (SUFI) or an International Mobile Subscriber Identity (IMSI). In some embodiments, the one or more correlation tables are stored in the first storage medium <b>204</b>.</p><p id="p-0067" num="0066">The processor captures an authentication message transmitted over the N1 interface <b>118</b> (at operation <b>316</b>). The processor <b>202</b> determines whether the authentication message is ciphered (at operation <b>318</b>). In some embodiments, the processor <b>202</b> extracts a ciphering state from an unciphered portion of the authentication message and processes the ciphering state to determine whether the authentication message is ciphered. For example, if the processor <b>202</b> determines that the ciphering state is a first state, the processor <b>202</b> determines that (at least some of) the authentication message is ciphered, whereas if the processor <b>202</b> determines that the ciphering state is a second state, the processor <b>202</b> determines that (the entirety of) the authentication message is unciphered.</p><p id="p-0068" num="0067">In response to determining that the second authentication message is not ciphered, the processor <b>202</b> extracts, from the authentication message, a second XRES (at operation <b>320</b>). In some embodiments, the second XRES matches the XRES extracted from the authentication message. The processor <b>202</b> fetches, from one of the one or more correlation tables, the cipher key, using the second XRES (at operation <b>322</b>). For example, the processor <b>202</b> fetches the permanent ID that the XRES (and, therefore, the second XRES) is mapped to by looking up, in the second correlation table, a record containing the XRES and fetching the respective permanent ID from a field in the record in which the respective permanent ID is located. In some embodiments, looking up the record includes performing a hash of the second XRES. In some embodiments, the processor <b>202</b> fetches, in the first correlation table, the cipher key that the permanent ID is mapped to. The processor <b>202</b> may fetch the cipher key in a similar way to how the processor fetched the permanent ID.</p><p id="p-0069" num="0068">Referring now to <figref idref="DRAWINGS">FIG. <b>3</b>C</figref>, in response to either determining that the authentication message is ciphered, the processor <b>202</b> captures a set of authentication transactions transmitted over the N2 interface (at operation <b>324</b>). The processor <b>202</b> extracts, from each authentication transaction of the set of authentication transactions, a permanent ID, a cipher key, and a second time stamp (at operation <b>326</b>). The processor <b>202</b> stores the permanent ID, the cipher key, and the second time stamp (e.g., for a predetermined time duration) extracted from each authentication transaction of the set of authentication transactions (at operation <b>328</b>). For example, the permanent ID, the cipher key, and the second time stamp for each authentication transaction is stored in a separate record. In some embodiments, the processor <b>202</b> stores the cipher key in a queue such that the cipher key can later be retrieved in order of time stored. In some embodiments, the processor <b>202</b> caches the permanent ID and the cipher key in the cache <b>214</b>. In some embodiments, after the predetermined time duration has passed, the processor <b>202</b> moves the cached items to one of the first storage medium <b>204</b> or the second storage medium <b>206</b>, while in other embodiments, the processor <b>202</b> deletes the cached items.</p><p id="p-0070" num="0069">The processor <b>202</b> captures a security mode command message transmitted over the N1 interface (at operation <b>330</b>). The processor <b>202</b> extracts, from the security mode command message, a third time stamp (at operation <b>332</b>). In some embodiments, the processor <b>202</b> identifies/determines, from a set of second time stamps corresponding to the set of authentication transactions, a subset of second time stamps indicating a first time after (e.g., greater than) a second time indicated by the first time stamp and before (e.g., less than) a third time indicated by the third time stamp.</p><p id="p-0071" num="0070">Referring now to <figref idref="DRAWINGS">FIG. <b>3</b>D</figref>, the processor <b>202</b> identifies/determines/selects/retains, from a set of cipher keys corresponding to the set of authentication transactions, a subset of cipher keys (e.g., and permanent IDs) corresponding to the subset of second time stamps (at operation <b>334</b>). In some embodiments, each cipher key of the subset of cipher keys was extracted from an authentication transaction that was transmitted at a first time after the second time indicated by the first time stamp and before the third time indicated by the third time stamp.</p><p id="p-0072" num="0071">The processor <b>202</b> captures a ciphered message transmitted on the N1 interface <b>118</b> (at operation <b>336</b>). The ciphered message may be captured after the security mode command message is captured. In some embodiments, the ciphered message is a ciphered security mode complete message. In some embodiments, the ciphered message is another message (e.g., an identity message) that comes before the ciphered security mode complete message and that is ciphered. The processor <b>202</b> fetches a first cipher key from the subset of cipher keys (at operation <b>338</b>). In some embodiments, once the first cipher key is fetched, it is deleted from the storage from which it is fetched (e.g., the queue).</p><p id="p-0073" num="0072">The processor <b>202</b> deciphers (e.g., attempts to decipher) a first portion of the ciphered message (at operation <b>340</b>). The processor <b>202</b> determines whether the deciphered message is a security mode complete message (at operation <b>342</b>). In response to determining that the deciphered message is not a security mode complete message, the processor <b>202</b> returns to the operation <b>338</b>. In response to determining that the deciphered message is a security mode complete message, the processor <b>202</b> deciphers the remainder of the ciphered message (at operation <b>344</b>).</p><p id="p-0074" num="0073">Upon completion of either operation <b>322</b> or operation <b>344</b>, in some embodiments, the processor <b>202</b> can use the correlation tables to identify other (e.g., subsequent) NAS messages associated with the user. In some embodiments, the processor <b>202</b> fetches (e.g., retrieves) the cipher key to decipher the other ciphered NAS messages associated with the user. In some embodiments, the processor <b>202</b> extracts session details and stores user data associated with the user in the session detail record <b>270</b> associated with the user in the session detail data structure <b>226</b>.</p><p id="p-0075" num="0074">Referring now to <figref idref="DRAWINGS">FIG. <b>4</b></figref>, a flow chart of an example method <b>400</b> for monitoring the 5G network <b>104</b> is depicted, in accordance with some embodiments. The method <b>400</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. Additional, fewer, or different operations may be performed in the method <b>400</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>400</b> may be performed in parallel. Operations of the method <b>400</b> can be combined with or interchanged with operations of the method <b>300</b>.</p><p id="p-0076" num="0075">The processor <b>202</b> captures a transaction (e.g., a pair of authentication messages, a authentication request and an authentication response, etc.) transmitted over a first interface (e.g., N12 interface) (operation <b>402</b>). The processor <b>202</b> extracts from the transaction, a security parameter (e.g., one of an expected response (XRES), an authentication token (AUTN), or other security parameter), a user identifier (ID), and a cipher key (operation <b>404</b>). The processor <b>202</b> captures a first message (e.g., authentication message) transmitted over a second interface (e.g., N1 interface) (operation <b>406</b>). The processor <b>202</b> determines that the first message is associated with the user ID and the cipher key (operation <b>408</b>). The method <b>400</b> may include additional implementations, such as any single implementation or any combination of implementations described below and/or in connection with one or more other methods described elsewhere herein.</p><p id="p-0077" num="0076">In some implementations, the processor <b>202</b> correlates the XRES with the user ID to determine a first mapping between the XRES and the user ID, correlates the user ID with the cipher key to determine a second mapping between the user ID and the cipher key, and stores the first mapping and the second mapping in a storage. In some implementations, the processor <b>202</b> extracts, from the first message, a second XRES that matches the XRES and retrieves, from the storage, the cipher key and the user ID using the second XRES.</p><p id="p-0078" num="0077">In some implementations, the processor <b>202</b> determines that the first message is ciphered. In some implementations, the processor <b>202</b> captures a second message (e.g., registration message) transmitted over the second interface and extracts, from the second message, a first time that the second message is transmitted. In some implementations, the processor <b>202</b> captures a third message (e.g., security mode command message) transmitted over the second interface and extracts, from the third message, a second time that the third message is transmitted, wherein the transaction is transmitted at a time between the first time and the second time. In some implementations, the processor <b>202</b> captures a fourth message (e.g., a security mode complete message or other message that is transmitted after the security mode command message) that is ciphered and that is transmitted over the second interface.</p><p id="p-0079" num="0078">In some embodiments, the processor <b>202</b> captures a plurality of transactions that are transmitted at the time between the first time and the second time. In some embodiments, the processor <b>202</b> extract a plurality of cipher keys from the plurality of transactions. In some embodiments, the processor <b>202</b> cycles (e.g., iterates) through each cipher key of the plurality of cipher keys, attempting to decipher the fourth message with a current one of the plurality of cipher keys, until successfully deciphering the fourth message using the current one of the plurality of cipher keys.</p><p id="p-0080" num="0079">In some implementations, the processor <b>202</b> captures a subsequent message transmitted over the second interface, and deciphers the subsequent message using the cipher key. In some embodiments, the processor <b>202</b> extracts session details from the subsequent message. In some embodiments, the processor <b>202</b> stores the session details in a storage medium.</p><p id="p-0081" num="0080">It is to be understood that any examples used herein are simply for purposes of explanation and are not intended to be limiting in any way.</p><p id="p-0082" num="0081">The herein described subject matter sometimes illustrates different components contained within, or connected with, different other components. It is to be understood that such depicted architectures are merely exemplary, and that in fact many other architectures can be implemented which achieve the same functionality. In a conceptual sense, any arrangement of components to achieve the same functionality is effectively &#x201c;associated&#x201d; such that the desired functionality is achieved. Hence, any two components herein combined to achieve a particular functionality can be seen as &#x201c;associated with&#x201d; each other such that the desired functionality is achieved, irrespective of architectures or intermedial components. Likewise, any two components so associated can also be viewed as being &#x201c;operably connected,&#x201d; or &#x201c;operably coupled,&#x201d; to each other to achieve the desired functionality, and any two components capable of being so associated can also be viewed as being &#x201c;operably couplable,&#x201d; to each other to achieve the desired functionality. Specific examples of operably couplable include but are not limited to physically mateable and/or physically interacting components and/or wirelessly interactable and/or wirelessly interacting components and/or logically interacting and/or logically interactable components.</p><p id="p-0083" num="0082">With respect to the use of substantially any plural and/or singular terms herein, those having skill in the art can translate from the plural to the singular and/or from the singular to the plural as is appropriate to the context and/or application. The various singular/plural permutations may be expressly set forth herein for sake of clarity.</p><p id="p-0084" num="0083">It will be understood by those within the art that, in general, terms used herein, and especially in the appended claims (e.g., bodies of the appended claims) are generally intended as &#x201c;open&#x201d; terms (e.g., the term &#x201c;including&#x201d; should be interpreted as &#x201c;including but not limited to,&#x201d; the term &#x201c;having&#x201d; should be interpreted as &#x201c;having at least,&#x201d; the term &#x201c;includes&#x201d; should be interpreted as &#x201c;includes but is not limited to,&#x201d; etc.). It will be further understood by those within the art that if a specific number of an introduced claim recitation is intended, such an intent will be explicitly recited in the claim, and in the absence of such recitation no such intent is present. For example, as an aid to understanding, the following appended claims may contain usage of the introductory phrases &#x201c;at least one&#x201d; and &#x201c;one or more&#x201d; to introduce claim recitations. However, the use of such phrases should not be construed to imply that the introduction of a claim recitation by the indefinite articles &#x201c;a&#x201d; or &#x201c;an&#x201d; limits any particular claim containing such introduced claim recitation to disclosures containing only one such recitation, even when the same claim includes the introductory phrases &#x201c;one or more&#x201d; or &#x201c;at least one&#x201d; and indefinite articles such as &#x201c;a&#x201d; or &#x201c;an&#x201d; (e.g., &#x201c;a&#x201d; and/or &#x201c;an&#x201d; should typically be interpreted to mean &#x201c;at least one&#x201d; or &#x201c;one or more&#x201d;); the same holds true for the use of definite articles used to introduce claim recitations. In addition, even if a specific number of an introduced claim recitation is explicitly recited, those skilled in the art will recognize that such recitation should typically be interpreted to mean at least the recited number (e.g., the bare recitation of &#x201c;two recitations,&#x201d; without other modifiers, typically means at least two recitations, or two or more recitations). Furthermore, in those instances where a convention analogous to &#x201c;at least one of A, B, and C, etc.&#x201d; is used, in general such a construction is intended in the sense one having skill in the art would understand the convention (e.g., &#x201c;a system having at least one of A, B, and C&#x201d; would include but not be limited to systems that have A alone, B alone, C alone, A and B together, A and C together, B and C together, and/or A, B, and C together, etc.). In those instances where a convention analogous to &#x201c;at least one of A, B, or C, etc.&#x201d; is used, in general such a construction is intended in the sense one having skill in the art would understand the convention (e.g., &#x201c;a system having at least one of A, B, or C&#x201d; would include but not be limited to systems that have A alone, B alone, C alone, A and B together, A and C together, B and C together, and/or A, B, and C together, etc.). It will be further understood by those within the art that virtually any disjunctive word and/or phrase presenting two or more alternative terms, whether in the description, claims, or drawings, should be understood to contemplate the possibilities of including one of the terms, either of the terms, or both terms. For example, the phrase &#x201c;A or B&#x201d; will be understood to include the possibilities of &#x201c;A&#x201d; or &#x201c;B&#x201d; or &#x201c;A and B.&#x201d; Further, unless otherwise noted, the use of the words &#x201c;approximate,&#x201d; &#x201c;about,&#x201d; &#x201c;around,&#x201d; &#x201c;substantially,&#x201d; etc., mean plus or minus ten percent.</p><p id="p-0085" num="0084">The foregoing description of illustrative embodiments has been presented for purposes of illustration and of description. It is not intended to be exhaustive or limiting with respect to the precise form disclosed, and modifications and variations are possible in light of the above teachings or may be acquired from practice of the disclosed embodiments. It is intended that the scope of the disclosure be defined by the claims appended hereto and their equivalents.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A non-transitory computer readable medium comprising instructions for providing a mobile user monitoring solution that, when executed by a processor, cause the processor to:<claim-text>capture a transaction transmitted over an N12 interface;</claim-text><claim-text>extract, from the transaction, one of an expected response (XRES) or an authentication token (AUTN), a user identifier (ID), and a cipher key;</claim-text><claim-text>capture a first message transmitted over an N1 interface; and</claim-text><claim-text>determine that the first message is associated with the user ID and the cipher key extracted from the transaction.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to store the one of the XRES or the AUTN, the user ID, and the cipher key in a storage medium.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The medium of <claim-ref idref="CLM-00002">claim 2</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to:<claim-text>extract, from the first message, a second one of the XRES or the AUTN that matches the one of the XRES or the AUTN; and</claim-text><claim-text>retrieve, from the storage medium, the cipher key and the user ID using the second one of the XRES or the AUTN.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to:<claim-text>extract, from a second message transmitted over the N1 interface, a first time that the second message is transmitted; and</claim-text><claim-text>extract, from a third message transmitted over the N1 interface, a second time that the third message is transmitted, wherein the transaction is transmitted at a time between the first time and the second time.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The medium of <claim-ref idref="CLM-00004">claim 4</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to:<claim-text>capture a fourth message;</claim-text><claim-text>determine that the fourth message is ciphered; and</claim-text><claim-text>decipher the fourth message using the cipher key.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The medium of <claim-ref idref="CLM-00005">claim 5</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to:<claim-text>extract a plurality of cipher keys from a plurality of transaction that are transmitted at the time between the first time and the second time; and</claim-text><claim-text>cycle through each of the plurality of cipher keys, attempting to decipher the fourth message with a current one of the plurality of cipher keys, until successfully deciphering the fourth message using the current one of the plurality of cipher keys.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The medium of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the transaction is an authentication request and an authentication response, the first message is an authentication message, the second message is a registration message, the third message is a security mode command message, and the fourth message is another message transmitted subsequent to the security mode command message being transmitted.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to:<claim-text>capture a subsequent message transmitted over the N1 interface;</claim-text><claim-text>decipher the subsequent message using the cipher key;</claim-text><claim-text>extract session details from the subsequent message; and</claim-text><claim-text>store the session details in a storage medium.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. An apparatus comprising a processor and a memory, wherein the memory includes programmed instructions that, when executed by the processor, cause the apparatus to<claim-text>capture a transaction transmitted over an N12 interface;</claim-text><claim-text>extract, from the transaction, one of an expected response (XRES) or an authentication token (AUTN), a user identifier (ID), and a cipher key;</claim-text><claim-text>capture a first message transmitted over an N1 interface; and</claim-text><claim-text>determine that the first message is associated with the user ID and the cipher key extracted from the transaction.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The apparatus of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to store the one of the XRES or the AUTN, the user ID, and the cipher key in a storage medium.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The apparatus of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to:<claim-text>extract, from the first message, a second one of the XRES or the AUTN that matches the one of the XRES or the AUTN; and</claim-text><claim-text>retrieve, from the storage medium, the cipher key and the user ID using the second one of the XRES or the AUTN.</claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The apparatus of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to:<claim-text>extract, from a second message transmitted over the N1 interface, a first time that the second message is transmitted; and</claim-text><claim-text>extract, from a third message transmitted over the N1 interface, a second time that the third message is transmitted, wherein the transaction is transmitted at a time between the first time and the second time.</claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to:<claim-text>capture a fourth message;</claim-text><claim-text>determine that the fourth message is ciphered; and</claim-text><claim-text>decipher the fourth message using the cipher key.</claim-text></claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The apparatus of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to:<claim-text>extract a plurality of cipher keys from a plurality of transaction that are transmitted at the time between the first time and the second time; and</claim-text><claim-text>cycle through each of the plurality of cipher keys, attempting to decipher the fourth message with a current one of the plurality of cipher keys, until successfully deciphering the fourth message using the current one of the plurality of cipher keys.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The apparatus of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the transaction is an authentication request and an authentication response, the first message is an authentication message, the second message is a registration message, the third message is a security mode command message, and the fourth message is another message transmitted subsequent to the security mode command message being transmitted.</claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The apparatus of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to:<claim-text>capture a subsequent message transmitted over the N1 interface;</claim-text><claim-text>decipher the subsequent message using the cipher key;</claim-text><claim-text>extract session details from the subsequent message; and</claim-text><claim-text>store the session details in a storage medium.</claim-text></claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. A method comprising:<claim-text>capturing a transaction transmitted over an N12 interface;</claim-text><claim-text>extracting, from the transaction, one of an expected response (XRES) or an authentication token (AUTN), a user identifier (ID), and a cipher key;</claim-text><claim-text>capturing a first message transmitted over an N1 interface; and</claim-text><claim-text>determining that the first message is associated with the user ID and the cipher key extracted from the transaction.</claim-text></claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref>, further comprising storing the one of the XRES or the AUTN, the user ID, and the cipher key in a storage medium.</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, further comprising:<claim-text>extracting, from the first message, a second one of the XRES or the AUTN that matches the one of the XRES or the AUTN; and</claim-text><claim-text>retrieving, from the storage medium, the cipher key and the user ID using the second one of the XRES or the AUTN.</claim-text></claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref>, further comprising:<claim-text>extracting, from a second message transmitted over the N1 interface, a first time that the second message is transmitted; and</claim-text><claim-text>extracting, from a third message transmitted over the N1 interface, a second time that the third message is transmitted, wherein the transaction is transmitted at a time between the first time and the second time.</claim-text></claim-text></claim></claims></us-patent-application>