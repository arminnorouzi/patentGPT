<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230004163A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230004163</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17808615</doc-number><date>20220624</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="regional"><country>EP</country><doc-number>21183223.3</doc-number><date>20210701</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>05</class><subclass>D</subclass><main-group>1</main-group><subgroup>02</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>08</class><subclass>G</subclass><main-group>1</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>05</class><subclass>D</subclass><main-group>1</main-group><subgroup>0217</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>05</class><subclass>D</subclass><main-group>1</main-group><subgroup>0221</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>05</class><subclass>D</subclass><main-group>1</main-group><subgroup>0291</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>08</class><subclass>G</subclass><main-group>1</main-group><subgroup>20</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>05</class><subclass>D</subclass><main-group>2201</main-group><subgroup>0213</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">METHOD AND SYSTEM FOR CONTROLLING A PLURALITY OF VEHICLES, IN PARTICULAR AUTONOMOUS VEHICLES</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Volvo Autonomous Solutions AB</orgname><address><city>G&#xf5;teborg</city><country>SE</country></address></addressbook><residence><country>SE</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>HELLGREN</last-name><first-name>Jonas</first-name><address><city>G&#xf5;teborg</city><country>SE</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>Volvo Autonomous Solutions AB</orgname><role>03</role><address><city>G&#xf5;teborg</city><country>SE</country></address></addressbook></assignee></assignees></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A traffic planning method for controlling a plurality of vehicles, wherein each vehicle occupies one node in a shared set of planning nodes and is movable to other nodes along predefined edges between pairs of the nodes in accordance with a finite set of motion commands. In the method, initial node occupancies of the vehicles are obtained, and a sequence of motion commands are determined by optimizing a state-action value function which depends on node occupancies s and the motion commands a to be given. The state-action value function includes a command-dependent term, which is updated in each iteration based on a reward function, and a command-independent term, which penalizes node occupancies with too small inter-vehicle gaps and is exempted from said updating.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="110.15mm" wi="151.05mm" file="US20230004163A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="173.48mm" wi="113.20mm" file="US20230004163A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="212.09mm" wi="109.81mm" orientation="landscape" file="US20230004163A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="153.08mm" wi="121.50mm" orientation="landscape" file="US20230004163A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="199.98mm" wi="114.05mm" orientation="landscape" file="US20230004163A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="213.19mm" wi="129.29mm" file="US20230004163A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="210.90mm" wi="129.37mm" file="US20230004163A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">TECHNICAL FIELD</heading><p id="p-0002" num="0001">The present disclosure relates to the field of centralized vehicle control, and in particular to a traffic planner for commanding autonomous vehicles in an environment with waypoints and connecting road segments.</p><heading id="h-0002" level="1">BACKGROUND</heading><p id="p-0003" num="0002">A fleet of autonomous vehicles can be controlled in a distributed (individual) or in a centralized (groupwise) fashion. Centralized control may be advantageous when the vehicles are to operate in a closed environment, especially when space is limited, and/or when the vehicles are carrying out a common utility task. Under the centralized control paradigm, tactical decisions, with a typical horizon of the order of minutes, are entrusted to a so-called traffic planner. The traffic planner reads current vehicle positions and other relevant state variables of the traffic system and determines commands to be given to each vehicle at times within a planning horizon. The traffic planner may be instructed to determine the commands with a view to maximizing productivity while minimizing cost, and the fleet owner can express the desired balance between these goals by configuring weighting coefficients. Decision-making on a shorter timescale than the tactical one, including vehicle stabilization and collision avoidance, may be delegated to each vehicle.</p><p id="p-0004" num="0003">For example, US2020097022 discloses a method for forming motion plans for a plurality of mobile objects movable in a system of nodes. The method is arranged to select motion plans that minimize a total movement cost for all mobile objects while considering a route collision evaluation value of a combination for the shortest route and the detour route for each mobile object. The movement cost is the sum of a distance cost and a waiting cost.</p><p id="p-0005" num="0004">An inconvenience encountered in some centrally controlled vehicle systems is that some vehicles occasionally end up in positions where they block the movement of another vehicle or form queues, which keep vehicles from moving at full speed. A state where none of the vehicles in the system can move is referred to as a deadlock (or terminal) state. This may correspond to a real-life scenario where the controlled vehicles need external help to resume operation, such as operator intervention, towing etc.</p><heading id="h-0003" level="1">SUMMARY</heading><p id="p-0006" num="0005">An objective of the present disclosure is to make available a traffic controller with a decreased likelihood of leading the vehicles into mutually blocking states, particularly deadlock states. The traffic planer should preferably be suitable for the control of autonomous vehicles. It is a further objective to provide a traffic planner which can be implemented with a limited amount of processing power. A still further objective is to propose a traffic planning method with these or corresponding characteristics.</p><p id="p-0007" num="0006">At least some of these objectives are achieved by the invention as defined by the independent claims. The dependent claims define advantageous embodiments.</p><p id="p-0008" num="0007">In a first aspect of the invention, there is provided a traffic planning method for controlling a plurality of vehicles, wherein each vehicle occupies one node in a shared set of planning nodes and is movable to other nodes along predefined edges between pairs of the nodes in accordance with a finite set of motion commands. In this method, initial node occupancies of the vehicles are obtained, and a sequence of motion commands is determined by optimizing a state-action value function Q(s,a)=Q<sub>S</sub>(s,a)+Q<sub>L</sub>(s) which depends on node occupancies s and the motion commands a to be given. According to the first aspect, the state-action value function includes at least one command-independent term Q<sub>L</sub>(s), which penalizes node occupancies with too small inter-vehicle gaps, and at least one command-dependent term Q<sub>S</sub>(s,a).</p><p id="p-0009" num="0008">The inventor has realized that small inter-vehicle gaps are strongly related to the formation of queues, blocking states and/or deadlocks in a traffic system. The described method, where the motion commands are determined subject to a penalty on too small gaps, is less likely to produce such states. This may reduce the number of delaying incidents and generally favors smoother operation of the vehicles. The first aspect of the invention furthermore proposes a computationally efficient way of putting this realization to technical practice. This is because the splitting of the state-action value function into two parts (terms), from which one is independent of the commands a to be given, allows more focused updating of the state-action value function. The common practice in reinforcement learning of updating the state-action value function in each iteration in accordance with a reward function is recalled. Since the command-independent term of the state-action value function can be exempted from such updating, the present traffic planning method can be executed with a reduced need for computational resources in comparison with a straightforward reference implementation.</p><p id="p-0010" num="0009">In some embodiments, an inter-vehicle gap which the command-independent term Q<sub>L</sub>(s) penalizes is expressed as a time separation of the vehicles in the direction of movement. Accordingly, the inter-vehicle gap depends not only on the physical separation of the vehicles but also on their speeds. This reflects the reaction time which is available to avoid an undesired or potentially dangerous situation.</p><p id="p-0011" num="0010">In some embodiments, the command-independent term Q<sub>L</sub>(s) depends on a gap-balancing indicator SoB(s), which penalizes too small gaps. Alternatively or additionally, the gap-balancing indicator SoB (s) penalizes unevenly distributed gaps. For this purpose, the gap-balancing indicator SoB(s) may include a variability measure on the gap sizes, as detailed below. The command-independent term Q<sub>L</sub>(s) may further include composition with a smooth activation function, such as ReLU, sigmoid or gaussian. This may improve the stability of the traffic planner's control activities.</p><p id="p-0012" num="0011">In some embodiments, the state-action value function is obtained by a preceding step of reinforcement learning on the basis of a predefined reward function. The reward function may be identical to the reward function used in the updating step.</p><p id="p-0013" num="0012">In some embodiments, the vehicles are autonomous vehicles, in particular self-driving vehicles.</p><p id="p-0014" num="0013">In a second aspect of the present invention, there is provided a device (e.g., traffic planner) configured to control a plurality of vehicles, wherein each vehicle occupies one node in a shared set of planning nodes and is movable to other nodes along predefined edges between pairs of the nodes in accordance with a finite set of motion commands. The device has a first interface configured to receive initial node occupancies of the vehicles; a second interface configured to feed motion commands selected from said finite set to said plurality of vehicles; and processing circuitry configured to perform the above method.</p><p id="p-0015" num="0014">On a general level, the second aspect of the invention shares the effects and advantages of the first aspect, and it can be implemented with a corresponding degree of technical variation.</p><p id="p-0016" num="0015">The invention further relates to a computer program containing instructions for causing a computer (e.g., traffic planner) to carry out the above method. The computer program may be stored or distributed on a data carrier. As used herein, a &#x201c;data carrier&#x201d; may be a transitory data carrier, such as modulated electromagnetic or optical waves, or a non-transitory data carrier. Non-transitory data carriers include volatile and non-volatile memories, such as permanent and non-permanent storage media of magnetic, optical or solid-state type. Still within the scope of &#x201c;data carrier&#x201d;, such memories may be fixedly mounted or portable.</p><p id="p-0017" num="0016">In the vocabulary of the present disclosure, a &#x201c;planning node&#x201d; may refer to a resource which is shared among the vehicles, such as a waypoint or a road segment. Generally, all terms used in the claims are to be interpreted according to their ordinary meaning in the technical field, unless explicitly defined otherwise herein. All references to &#x201c;a/an/the element, apparatus, component, means, step, etc.&#x201d; are to be interpreted openly as referring to at least one instance of the element, apparatus, component, means, step, etc., unless explicitly stated otherwise. The steps of any method disclosed herein do not have to be performed in the exact order described, unless explicitly stated.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0018" num="0017">Aspects and embodiments are now described, by way of example, with reference to the accompanying drawings, on which:</p><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a flowchart of a traffic planning method according to embodiments of the present invention;</p><p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows a device suitable for controlling a plurality of vehicles;</p><p id="p-0021" num="0020"><figref idref="DRAWINGS">FIGS. <b>3</b> and <b>4</b></figref> are schematical representations of road networks with numbered waypoints;</p><p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. <b>5</b></figref> shows example vehicles that can be controlled centrally using embodiments of the invention; and</p><p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a flowchart of a reinforcement learning algorithm.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0005" level="1">DETAILED DESCRIPTION</heading><p id="p-0024" num="0023">The aspects of the present disclosure will now be described more fully hereinafter with reference to the accompanying drawings, on which certain embodiments of the invention are shown. These aspects may, however, be embodied in many different forms and should not be construed as limiting; rather, these embodiments are provided by way of example so that this disclosure will be thorough and complete, and to fully convey the scope of all aspects of the invention to those skilled in the art. Like numbers refer to like elements throughout the description.</p><p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a schematic representation of a road network. Waypoints are defined at the road junctions wp<b>1</b>, wp<b>3</b> and additionally at some intermediate locations wp<b>2</b>, wp<b>4</b>, wp<b>5</b>, . . . , wp<b>8</b>. Some of the intermediate locations may correspond to so-called absorption nodes, where a visiting vehicle is required to dwell for a predetermined or variable time, for purposes of loading, unloading, maintenance etc. The arrangement of the waypoints is not essential to the present invention, rather their locations and number may be chosen (defined) as deemed necessary in each use case to achieve smooth and efficient traffic control. The waypoints are treated as planning nodes which are shared by a plurality of vehicles v<b>1</b>, v<b>2</b>, v<b>3</b>, v<b>4</b>. Abstractly, a planning node may be understood as a logical entity which is either free or occupied by exactly one vehicle at a time. An occupied node is not consumed but can be released for use by the same or another vehicle. Planning nodes may represent physical space for transport or parking, a communication channel, maintenance machinery, additional equipment for optional temporary use, such as tools or trailers.</p><p id="p-0026" num="0025">Each vehicle (see <figref idref="DRAWINGS">FIG. <b>5</b></figref>) is controllable by an individual control signal, which may indicate a command from a finite set of predetermined commands. If the vehicles are autonomous, the control signal may be a machine-oriented signal which controls actuators in the vehicle; if the vehicles are conventional, the control signals may be human-intelligible signals directed to their drivers. It is understood that individual control signals may be multiplexed onto a common carrier. A predefined command may represent an action to be taken at the next waypoint (e.g., continue straight, continue right, continue left, stop), a next destination, a speed adjustment, a loading operation or the like. Implicit signaling is possible, in that a command has a different meaning depending on its current state (e.g., toggle between an electric engine and a combustion engine, toggle between high and low speed, drive/wait at the next waypoint). A vehicle which receives no control signal or a neutrally-valued control signal may be configured to continue the previously instructed action or to halt. The predetermined commands preferably relate to tactical decision-making, which corresponds to a time scale typically shorter than strategic decision-making and typically longer than operational (or machine-level) decision-making. Different vehicles may have different sets of commands.</p><p id="p-0027" num="0026">One aim of the present disclosure is to enable efficient centralized control of the vehicles v<b>1</b>, v<b>2</b>, v<b>3</b>, v<b>4</b>. The vehicles v<b>1</b>, v<b>2</b>, v<b>3</b>, v<b>4</b> are to be controlled as a group, with mutual coordination. The mutual coordination may entail that any planning node utilization conflicts that could arise between vehicles are deferred to a planning algorithm and resolved at the planning stage. The planning may aim to maximize productivity, such as the total quantity of useful transport system work or the percentage of on-schedule deliveries of goods. The planning may additionally aim to minimize cost, including fuel consumption, battery wear, mechanical component wear or the like.</p><p id="p-0028" num="0027">Regarding the planning node utilization conflicts that may arise, it may initially be noted that if each vehicle moves one waypoint per epoch, then no vehicle blocks this movement of any other vehicle for the node occupancies (start state) shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>. These node occupancies are:</p><p id="p-0029" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mrow>  <mrow>   <mi>O</mi>   <mo>&#x2061;</mo>   <mo>(</mo>   <mtable>    <mtr>     <mtd>      <mrow>       <mi>v</mi>       <mo>&#x2062;</mo>       <mn>1</mn>      </mrow>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <mi>v</mi>       <mo>&#x2062;</mo>       <mn>2</mn>      </mrow>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <mi>v</mi>       <mo>&#x2062;</mo>       <mn>3</mn>      </mrow>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <mi>v</mi>       <mo>&#x2062;</mo>       <mn>4</mn>      </mrow>     </mtd>    </mtr>   </mtable>   <mo>)</mo>  </mrow>  <mo>=</mo>  <mrow>   <mrow>    <mo>(</mo>    <mtable>     <mtr>      <mtd>       <mrow>        <mi>wp</mi>        <mo>&#x2062;</mo>        <mn>1</mn>       </mrow>      </mtd>     </mtr>     <mtr>      <mtd>       <mrow>        <mi>wp</mi>        <mo>&#x2062;</mo>        <mn>4</mn>       </mrow>      </mtd>     </mtr>     <mtr>      <mtd>       <mrow>        <mi>wp</mi>        <mo>&#x2062;</mo>        <mn>6</mn>       </mrow>      </mtd>     </mtr>     <mtr>      <mtd>       <mrow>        <mi>wp</mi>        <mo>&#x2062;</mo>        <mn>8</mn>       </mrow>      </mtd>     </mtr>    </mtable>    <mo>)</mo>   </mrow>   <mo>.</mo>  </mrow> </mrow></math></maths></p><p id="p-0030" num="0028">It can also be seen that these node occupancies provide each vehicle with a next waypoint to which it can move in a next epoch. The choice is not arbitrary, however, as both vehicles v<b>1</b> and v<b>4</b> may theoretically move to waypoint wp<b>3</b>, but this conflict can be avoided by routing vehicle v<b>1</b> to waypoint wp<b>2</b> instead. If the system is evolved in the second manner, that is,</p><p id="p-0031" num="0000"><maths id="MATH-US-00002" num="00002"><math overflow="scroll"> <mrow>  <mrow>   <mi>O</mi>   <mo>&#x2061;</mo>   <mo>(</mo>   <mtable>    <mtr>     <mtd>      <mrow>       <mi>v</mi>       <mo>&#x2062;</mo>       <mn>1</mn>      </mrow>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <mi>v</mi>       <mo>&#x2062;</mo>       <mn>2</mn>      </mrow>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <mi>v</mi>       <mo>&#x2062;</mo>       <mn>3</mn>      </mrow>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <mi>v</mi>       <mo>&#x2062;</mo>       <mn>4</mn>      </mrow>     </mtd>    </mtr>   </mtable>   <mo>)</mo>  </mrow>  <mo>=</mo>  <mrow>   <mrow>    <mo>(</mo>    <mtable>     <mtr>      <mtd>       <mrow>        <mi>wp</mi>        <mo>&#x2062;</mo>        <mn>2</mn>       </mrow>      </mtd>     </mtr>     <mtr>      <mtd>       <mrow>        <mi>wp</mi>        <mo>&#x2062;</mo>        <mn>5</mn>       </mrow>      </mtd>     </mtr>     <mtr>      <mtd>       <mrow>        <mi>wp</mi>        <mo>&#x2062;</mo>        <mn>7</mn>       </mrow>      </mtd>     </mtr>     <mtr>      <mtd>       <mrow>        <mi>wp</mi>        <mo>&#x2062;</mo>        <mn>3</mn>       </mrow>      </mtd>     </mtr>    </mtable>    <mo>)</mo>   </mrow>   <mo>.</mo>  </mrow> </mrow></math></maths></p><p id="p-0032" num="0000">then vehicle v<b>4</b> will block vehicle v<b>1</b> from moving to the next waypoint wp<b>3</b>. This blocking state temporarily reduces the vehicle system's productivity but will be resolved once vehicle v<b>4</b> continues to waypoint wp<b>4</b>.</p><p id="p-0033" num="0029">It is easy to realize that the difficulty of the blocking states (as measured, say, by the number of vehicle movements needed to reach a non-blocking state) in a given waypoint topology will increase with the number of vehicles present. The efficiency gain of deploying marginally more vehicles to solve a given utility task in a given environment may therefore be offset by the increased risk of conflicts. A waypoint topology populated with many vehicles may also have more deadlock states, i.e., states where no vehicle movement is possible. As mentioned, a deadlock state may correspond to a real-life scenario where the controlled vehicles need external help to resume operation, such as operator intervention, towing etc.</p><p id="p-0034" num="0030">The following description is made under an assumption of discrete time, that is, the traffic system evolves in evenly spaced epochs. The length of an epoch may be of the order of 0.1 s, 1 s, 10 s or longer. At each epoch, either a command at a<b>2</b> is given to one of the vehicles v<b>1</b>, v<b>2</b>, v<b>3</b>, v<b>4</b>, a command is given to a predefined group of vehicles, or no command is given. Quasi-simultaneous commands v1.a1, v2.a1 to two vehicles v<b>1</b>, v<b>2</b> or two vehicle groups can be distributed over two consecutive epochs. To allow approximate simultaneity, the epoch length may be configured shorter than the typical time scale of the tactical decision-making for one vehicle. With this setup, the space of possible planning outcomes corresponds to the set of all command sequences of length d, where d is the planning horizon (or lookahead horizon).</p><p id="p-0035" num="0031">With reference now to <figref idref="DRAWINGS">FIG. <b>1</b></figref>, a traffic planning method <b>100</b> according to one embodiment of the invention will be described. The method <b>100</b> may be implemented by a general-purpose programmable computer, or in particular by the device <b>200</b> shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref> to be described below.</p><p id="p-0036" num="0032">In a first step no of the method <b>100</b>, a state-action value function Q(s,a)=Q<sub>S</sub>(s,a)+Q<sub>L</sub>(s) is obtained by executing a reinforcement learning scheme, including training. The type of reinforcement learning scheme may for example be Q-learning or temporal-difference learning on the basis of a predefined reward function R(s,a); see R. S. Sutton et al., Reinforcement Learning, MIT Press (2018), ISBN 9780262039246. The reward function R (s,a) may represent productivity minus cost. The productivity term(s) or factor(s) may be an (approximate) quantitative indicator of the amount of the utility task which is completed by the vehicles' movements. It may be a measure of the total distance travelled (e.g., vehicle-kilometers), total distance travelled by vehicles carrying payload, a passenger-distance measure (e.g., passenger-kilometers), a payload-distance measure (e.g., ton-kilometers), a payload quantity delivered to an intended recipient or the like. The cost term(s) or factor(s) in the reward function R(s,a) may reflect energy consumption, a projected maintenance demand in view of mechanical wear (e.g., total velocity variation, peak acceleration, braking events, number of load cycles on structural elements) or chemical wear (e.g., exposure to sunlight, corrosive fluids) and/or safety risks (e.g., minimum vehicle separation). Suitable training data for the reinforcement learning in step <b>110</b> may be obtained by running a large number of computer simulations of traffic based on a mathematical model of the vehicles and planning nodes, e.g., a road-network model. Recorded observations of real vehicle movements in an environment are an alternative source of training data. Hybrids of these are possible too, for instance, to use real-world observations as initial values to the computer simulation.</p><p id="p-0037" num="0033">The state-action value function Q(s,a) obtained in the first step no depends on node occupancies s and on motion commands a to be given within the planning horizon. The state-action value function (which acts as objective function in a subsequent optimization) includes at least one command-independent term Q<sub>L</sub>(s), which penalizes node occupancies with too small inter-vehicle gaps, and at least one command-dependent term Q<sub>S</sub>(s,a). The command-independent term Q<sub>L</sub>(s) and the command-dependent term Q<sub>S</sub>(s,a) may respectively represent a long-term and a short-term memory of the traffic planning method <b>100</b>. It is primarily the command-dependent term Q<sub>S</sub>(s,a) that may be obtained by means of reinforcement training according to the reward function R(s,a). The command-dependent term Q<sub>S</sub>(s,a) may furthermore be updated after step no (training phase) has ended, i.e. in operation, whereas the command-independent term Q<sub>L</sub>(s) may remain constant between planning calls.</p><p id="p-0038" num="0034">The command-independent term Q<sub>L</sub>(s) may be defined by reference to a gap-balancing indicator SoB(s) which, for a state s, expresses the degree of desirability of the prevailing inter-vehicle gaps as a number. For each vehicle, the inter-vehicle gap may be defined as the distance to the vehicle immediately ahead of it. In the example situation of <figref idref="DRAWINGS">FIG. <b>4</b></figref>, the gap of v<b>3</b> at wp<b>6</b> is determined by v<b>4</b> at wp<b>8</b>, since this is v<b>3</b>'s unique direction of movement. The gap may be defined as the number of intervening waypoints, i.e., one (wp<b>7</b>). Vehicle v<b>1</b> at wp<b>1</b> can move via wp<b>2</b> to wp<b>3</b> or directly to wp<b>3</b>, and from wp<b>3</b> to either wp<b>4</b> or wp<b>6</b>. Unless v<b>1</b>'s future route is known (e.g., as a result of route planning), a unique gap size among these four options may be determined based on a predefined rule. The rule may stipulate, for example, that the gap-balancing indicator SoB(s) shall be based on the minimum, maximum or average gap across the available routing options. Alternatively, the rule may be based on a predefined standard circuit for traversing the waypoints. Then, even if deviations from the standard circuit are possible and may be justified to avoid a blocking state, only intervening waypoints along the standard circuit are credited as gaps. The standard circuit may correspond to the preferred route for carrying out a utility task, such as loading, unloading or moving.</p><p id="p-0039" num="0035">As mentioned initially, a gap size in the sense of one of these definitions may refer to a distance or a time separation. If time is used to quantify the gap, it may correspond to the time needed for the rear vehicle to reach the momentary position of the vehicle immediately in front ahead of it at the rear vehicle's current speed. Alternatively, the relative speed of the front and rear vehicles may be used as basis. For example, if the front vehicle is moving more slowly, the gap-size time may correspond to the time to collision absent any intervention, and in the opposite case the gap-size time may be set to a maximum value.</p><p id="p-0040" num="0036">The gap-balancing indicator SoB according to any of these options provides a convenient basis for determining a suitable sequence of motion commands by optimization. In particular, the gap-balancing indicator SoB(s) can be defined so that it assumes values in [0,1], where the value 1 corresponds to a state s such that no further balancing is possible and the value 0 represents the opposite. The gap-balancing indicator SoB(s) may purposefully be defined to be 1 if a state s is well-balanced but not ideally balanced, namely, if the owner of the traffic system does not find it worthwhile or meaningful to spend resources on further intervention aiming to balance the node occupancies of the vehicles.</p><p id="p-0041" num="0037">To mention a few examples, a gap-balancing indicator SoB<sub>1 </sub>can be constructed based on a standard deviation D (s) of the sizes of the inter-vehicle gaps. The following scaling ensures that SoB<sub>1 </sub>takes values in [0,1]:</p><p id="p-0042" num="0000"><maths id="MATH-US-00003" num="00003"><math overflow="scroll"> <mrow>  <mrow>   <mrow>    <msub>     <mi>SoB</mi>     <mn>1</mn>    </msub>    <mo>(</mo>    <mi>s</mi>    <mo>)</mo>   </mrow>   <mo>=</mo>   <mrow>    <mrow>     <mfrac>      <mrow>       <mn>1</mn>       <mo>-</mo>       <mrow>        <mrow>         <mi>D</mi>         <mo>&#x2061;</mo>         <mo>(</mo>         <mi>s</mi>         <mo>)</mo>        </mrow>        <mo>/</mo>        <msub>         <mi>D</mi>         <mi>max</mi>        </msub>       </mrow>      </mrow>      <mrow>       <mn>1</mn>       <mo>+</mo>       <mrow>        <mi>D</mi>        <mo>&#x2061;</mo>        <mo>(</mo>        <mi>s</mi>        <mo>)</mo>       </mrow>      </mrow>     </mfrac>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mi>where</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <msub>      <mi>D</mi>      <mi>max</mi>     </msub>    </mrow>    <mo>=</mo>    <mrow>     <munder>      <mi>max</mi>      <mi>s</mi>     </munder>     <mrow>      <mi>D</mi>      <mo>&#x2061;</mo>      <mo>(</mo>      <mi>s</mi>      <mo>)</mo>     </mrow>    </mrow>   </mrow>  </mrow>  <mo>,</mo> </mrow></math></maths></p><p id="p-0043" num="0000">the theoretical maximum value of the standard deviation. Viable alternatives to the standard deviation D (s) are variance, variability coefficient, range, interquartile range, and other variability measures. A gap-balancing indicator of this type may cause the method <b>100</b> to return motion commands tending to distribute the available total gap size L (in time or distance) equally among the vehicles <b>299</b>.</p><p id="p-0044" num="0038">Another option is to use a gap-balancing indicator SoB<sub>2 </sub>which is proportional to the minimum gap size among the vehicles <b>299</b>. A suitable scaling factor for the minimum gap size may be NIL, where L is the available total gap size and N denotes the number of vehicles. This means SoB<sub>2 </sub>(s)=0 when two vehicles are about to collide and SoB<sub>2 </sub>(s)=1 when the gaps are equally distributed.</p><p id="p-0045" num="0039">A further option is to form a weighted combination SoB<sub>3</sub>(s)=&#x3b1;SoB<sub>1</sub>(s)+(1&#x2212;&#x3b1;)SoB<sub>2</sub>(s), which maintains the interval [<b>0</b>,<b>1</b>] as its image as long as the parameter satisfies 0&#x3c;&#x3b1;&#x3c;1.</p><p id="p-0046" num="0040">In some embodiments, the command-independent term Q<sub>L</sub>(s) includes a composition of a gap-balancing indicator SoB and a step-like function, such as a smooth activation function. This may improve the stability of the traffic system when controlled by outputs of the method <b>100</b>. Suitable step-like functions may be a rectified linear unit (ReLU) activation function or modified ReLU</p><p id="p-0047" num="0000"><maths id="MATH-US-00004" num="00004"><math overflow="scroll"> <mrow>  <mrow>   <msub>    <mi>Q</mi>    <mi>L</mi>   </msub>   <mo>(</mo>   <mi>s</mi>   <mo>)</mo>  </mrow>  <mo>=</mo>  <mrow>   <mrow>    <mi>mReLU</mi>    <mo>&#x2061;</mo>    <mo>(</mo>    <mrow>     <mrow>      <mrow>       <mi>SoB</mi>       <mo>&#x2061;</mo>       <mo>(</mo>       <mi>s</mi>       <mo>)</mo>      </mrow>      <mo>;</mo>      <mi>thr</mi>     </mrow>     <mo>,</mo>     <mi>k</mi>    </mrow>    <mo>)</mo>   </mrow>   <mo>=</mo>   <mrow>    <mo>{</mo>    <mtable>     <mtr>      <mtd>       <mrow>        <mi>k</mi>        <mo>&#x2061;</mo>        <mo>(</mo>        <mrow>         <mrow>          <mi>SoB</mi>          <mo>&#x2061;</mo>          <mo>(</mo>          <mi>s</mi>          <mo>)</mo>         </mrow>         <mo>-</mo>         <mi>thr</mi>        </mrow>        <mo>)</mo>       </mrow>      </mtd>      <mtd>       <mrow>        <mrow>         <mi>SoB</mi>         <mo>&#x2061;</mo>         <mo>(</mo>         <mi>s</mi>         <mo>)</mo>        </mrow>        <mo>&#x3c;</mo>        <mi>thr</mi>       </mrow>      </mtd>     </mtr>     <mtr>      <mtd>       <mn>0</mn>      </mtd>      <mtd>       <mrow>        <mrow>         <mi>SoB</mi>         <mo>&#x2061;</mo>         <mo>(</mo>         <mi>s</mi>         <mo>)</mo>        </mrow>        <mo>&#x2265;</mo>        <mi>thr</mi>       </mrow>      </mtd>     </mtr>    </mtable>   </mrow>  </mrow> </mrow></math></maths></p><p id="p-0048" num="0000">where 0&#x3c;thr&#x2264;1, k&#x3e;0, a gaussian function (or radial basis function)</p><p id="p-0049" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i><sub>L</sub>(<i>S</i>)=<i>Q</i><sub>L</sub><sup>min</sup><i>e</i><sup>&#x2212;&#x2208;&#xb7;SoB(s)</sup><sup><sup2>2</sup2></sup>,&#x2208;&#x3e;0,<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0050" num="0000">a sigmoid function, such as a logistic function</p><p id="p-0051" num="0000"><maths id="MATH-US-00005" num="00005"><math overflow="scroll"> <mrow>  <mrow>   <mrow>    <msub>     <mi>Q</mi>     <mi>L</mi>    </msub>    <mo>(</mo>    <mi>s</mi>    <mo>)</mo>   </mrow>   <mo>=</mo>   <mfrac>    <mn>1</mn>    <mrow>     <mn>1</mn>     <mo>+</mo>     <msup>      <mi>e</mi>      <mrow>       <mrow>        <mo>-</mo>        <mi>&#x3f5;</mi>       </mrow>       <mo>&#xb7;</mo>       <mrow>        <mi>SoB</mi>        <mo>&#x2061;</mo>        <mo>(</mo>        <mi>s</mi>        <mo>)</mo>       </mrow>      </mrow>     </msup>    </mrow>   </mfrac>  </mrow>  <mo>,</mo>  <mrow>   <mi>&#x3f5;</mi>   <mo>&#x3e;</mo>   <mn>0</mn>  </mrow>  <mo>,</mo> </mrow></math></maths></p><p id="p-0052" num="0000">scaled variants of the above functions, or a combination of these.</p><p id="p-0053" num="0041">An advantageous option is the following combination of two modified ReLUs composed with the above-defined gap-balancing indicators SoB<sub>1</sub>, SoB<sub>2</sub>:</p><p id="p-0054" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i><sub>L</sub>(<i>s</i>)=mReLU(<i>SoB</i><sub>1</sub>(<i>s</i>);<i>thr</i><sub>D</sub><i>,k</i><sub>D</sub>)+mReLU(<i>SoB</i><sub>2</sub>(<i>s</i>);<i>thr</i><sub>mingap</sub><i>,k</i><sub>mingap</sub>)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0055" num="0000">For a maximally unbalanced state s<sub>0</sub>, one has Q<sub>L</sub>(s<sub>0</sub>)=&#x2212;k<sub>D</sub>thr<sub>D</sub>&#x2212;k<sub>mingap</sub>thr<sub>mingap</sub>. The thresholds thr<sub>D</sub>, thr<sub>mingap </sub>represents satisfactory gap balancing, beyond which no further improvement is deemed meaningful or worthwhile. The slopes k<sub>D</sub>, k<sub>mingap </sub>are preferably set large enough that the improvement of SoB in Q<sub>L</sub>(s) outweighs the reward in Q<sub>S</sub>(s,a) for moving one vehicle between two waypoints, so that the long-term memory is certain to influence the determination of motion commands. This may be achieved by trial and error, possibly in view of the number of vehicles, geometry of the traffic system and the definition of the reward function R(s,a). This proposed combination of two modified ReLUs is able to manage two desirable goals at once: to maximize the gap spread (i.e., gaps are distributed evenly) and keep vehicles from moving at so small distance that a queue may form.</p><p id="p-0056" num="0042">In a second step <b>112</b> of the method <b>100</b>, the initial node occupancies of the vehicles are obtained. The node occupancies may be represented as a data structure associating each vehicle with a planning node, similar to the occupancy function 0(&#x22c5;) introduced above. Ways of obtaining the node occupancies are described below in connection with <figref idref="DRAWINGS">FIG. <b>2</b></figref>.</p><p id="p-0057" num="0043">In a third step <b>114</b>, a sequence of motion commands a is determined by optimizing the state-action value function Q(s,a). The optimization process may include executing a planning algorithm of any of the types discussed above. It is noted that the optimization process may be allowed to execute until a convergence criterion is met, until an optimality criterion is fulfilled and/or until a predefined time has elapsed. Actually reaching optimality is no necessary condition under the present invention. The optimization process is normally restricted to a planning horizon (or search depth), which may be determined in view of a computational budget (see applicant's co-pending application EP21175955.0) or fixed.</p><p id="p-0058" num="0044">In a fourth step <b>116</b> of the method <b>100</b>, the command-dependent term Q<sub>S</sub>(s,a) of the state-action value function Q(s,a) is updated on the basis of the reward function R(s,a) for every iteration of the third step <b>114</b>. Alternatively, a simplified reward function {tilde over (R)}(s,a) can be used which largely reflects the same desirables as R(s,a) but is cheaper to evaluate. The command-independent term Q<sub>L</sub>(s) is preferably exempted from said iterative updating <b>116</b>, recalling that its role is to act as long-term memory of the traffic planning method <b>100</b>. This does not rule out the possibility of adjusting the command-independent term Q<sub>L</sub>(s) during ongoing traffic planning, though preferably this is done less frequently than at every execution cycle of the command-determining step <b>114</b>.</p><p id="p-0059" num="0045">Unlike steps <b>112</b>, <b>114</b>, <b>116</b>, which may collectively be referred to as a planning call, the step no may constitute a training phase taking place prior to actual operation and need not be repeated after for each commissioned copy of a traffic planner product.</p><p id="p-0060" num="0046">In some embodiments of the method <b>100</b>, the reinforcement learning step no and command-determining step <b>114</b> are performed within a Dyna-2 algorithm or an equivalent algorithm. A characteristic of the Dyna-2 algorithm is that learning occurs both while the machine-learning model is being built (training phase) and while it interacts with the system to be controlled. <figref idref="DRAWINGS">FIG. <b>6</b></figref> is a flowchart of an example Dyna-2 algorithm <b>600</b>, which includes the following steps:<ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0000">    <ul id="ul0002" list-style="none">        <li id="ul0002-0001" num="0047">Step <b>610</b>: A real-world or modelled state s<sub>0 </sub>is given. What to do?</li>        <li id="ul0002-0002" num="0048">Step <b>612</b>: Short-term search. Use search (e.g., temporal-difference search) to set a parameter vector in a short-term memory with respect to a long-term memory and the present state s<sub>0</sub>. An action trajectory a<sub>0 </sub>is created by combining both memories.</li>        <li id="ul0002-0003" num="0049">Step <b>614</b>: Long-term learning. The first action in the action trajectory is executed, which lead to a new state s<sub>1 </sub>for which an associated reward R (s<sub>1</sub>) can be computed. (The reward can depend on the action a<sub>0 </sub>as well, and/or on the difference between the old and new states.) The short-term memory is updated on the basis of the reward R(s<sub>1</sub>), the new state s<sub>1 </sub>and the old state s<sub>0</sub>.</li>        <li id="ul0002-0004" num="0050">Step <b>616</b>: It is determined whether the new state s<sub>1 </sub>is terminal. If not, the execution of the algorithm <b>600</b> resumes from step <b>610</b> on the basis of the new state s<sub>1</sub>. Alternatively, if the new state s<sub>1 </sub>is terminal, the algorithm <b>600</b> ends. Here, a terminal state may for example correspond to a deadlock state or to completion of the prescribed utility task.</li>    </ul>    </li></ul></p><p id="p-0061" num="0051"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows, in accordance with a further embodiment, a device <b>200</b> for controlling a plurality of vehicles <b>299</b> sharing a set of planning nodes. The device <b>200</b>, which may be referred to as a traffic planner, has a first interface <b>210</b> configured to receive initial node occupancies of the vehicles <b>299</b>. Optionally, it may further receive, for each vehicle, information representing a set of predefined commands v1.a1, v1.a2, v2.a1, v2.a2, which can be fed to the respective vehicles, and/or a mission (utility task) to be carried out may by the vehicles <b>299</b>. The initial node occupancies may be obtained from a traffic control entity (not shown) communicating with the vehicles <b>299</b>, from sensors (not shown) detecting the positions of the vehicles <b>299</b>, or from a reply to a self-positioning query issued to the vehicles <b>299</b>. The optional information may be entered into the first interface <b>210</b> by an operator or provided as configuration data once it is known which vehicles <b>299</b> will form the fleet.</p><p id="p-0062" num="0052">The device <b>200</b> further has a second interface <b>220</b> configured to feed commands selected from said predefined commands to said plurality of vehicles, as well as processing circuitry <b>230</b> configured to perform the method <b>100</b> described above. <figref idref="DRAWINGS">FIG. <b>2</b></figref> shows direct wireless links from the second interface <b>220</b> to the vehicles <b>299</b>. In other embodiments, as explained above, the second interface <b>220</b> may instead feed sequences of the predefined commands to the traffic control entity, which takes care of the delivery of the commands to the vehicles <b>299</b>.</p><p id="p-0063" num="0053">A possible behavior of the planning in step <b>114</b> is illustrated in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, which shows a road network where two vehicles v<b>1</b>, v<b>2</b> can move freely along the arrows between planning nodes (or waypoints) <b>1</b>-<b>9</b>. There are no junctions; rather, the arrows define a circuit by which each vehicle traverses all nine planning nodes. If the inter-vehicle gaps are defined as the number of intervening planning nodes along the circuit, the gaps are given by</p><p id="p-0064" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>[(0(<i>v</i>1)&#x2212;0(<i>v</i>2))mod9]&#x2212;1 and [(0(<i>v</i>2)&#x2212;0(<i>v</i>1))mod9]&#x2212;1,<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0065" num="0000">where 0(&#x22c5;) is the occupancy function introduced above. The vehicles v<b>1</b>, v<b>2</b> are not allowed to occupy planning nodes <b>5</b> and <b>8</b> contemporaneously. (It is noted in passing that the road network shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref> would not be equivalent to a network where nodes <b>5</b> and <b>8</b> were combined into one; indeed, such a combined node &#x201c;<b>5</b>+<b>8</b>&#x201d; would not reflect the fact that a vehicle arriving from node <b>4</b> would always continue to node <b>6</b>, and a vehicle reaching the combined node &#x201c;<b>5</b>+<b>8</b>&#x201d; from node <b>7</b> would continue to node <b>9</b>.) Accordingly, when the vehicles v<b>1</b>, v<b>2</b> are positioned as shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the following options are open to the traffic planner: (a) let v<b>1</b> at move to node <b>8</b> and let v<b>2</b> wait at node <b>4</b>, or (b) let v<b>2</b> mot to node <b>5</b> and let v<b>1</b> wait at node <b>7</b>. In terms of the occupancy function, the respective outcomes over epochs t0, t1, t2, t3 are shown in Table 1:</p><p id="p-0066" num="0000"><tables id="TABLE-US-00001" num="00001"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="217pt" align="center"/><thead><row><entry namest="1" nameend="1" rowsep="1">TABLE 1</entry></row></thead><tbody valign="top"><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row><row><entry>Future node occupancies in FIG. 3</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="5"><colspec colname="1" colwidth="42pt" align="center"/><colspec colname="2" colwidth="42pt" align="center"/><colspec colname="3" colwidth="49pt" align="center"/><colspec colname="4" colwidth="42pt" align="center"/><colspec colname="5" colwidth="42pt" align="center"/><tbody valign="top"><row><entry/><entry>t0</entry><entry>t1</entry><entry>t2</entry><entry>t3</entry></row><row><entry namest="1" nameend="5" align="center" rowsep="1"/></row><row><entry>Option a</entry><entry><maths id="MATH-US-00006" num="00006"><math overflow="scroll"> <mrow>  <mo>(</mo>  <mtable>   <mtr>    <mtd>     <mn>7</mn>    </mtd>   </mtr>   <mtr>    <mtd>     <mn>4</mn>    </mtd>   </mtr>  </mtable>  <mo>)</mo> </mrow></math></maths></entry><entry><maths id="MATH-US-00007" num="00007"><math overflow="scroll"> <mrow>  <mo>(</mo>  <mtable>   <mtr>    <mtd>     <mn>8</mn>    </mtd>   </mtr>   <mtr>    <mtd>     <mn>4</mn>    </mtd>   </mtr>  </mtable>  <mo>)</mo> </mrow></math></maths></entry><entry><maths id="MATH-US-00008" num="00008"><math overflow="scroll"> <mrow>  <mo>(</mo>  <mtable>   <mtr>    <mtd>     <mn>9</mn>    </mtd>   </mtr>   <mtr>    <mtd>     <mn>5</mn>    </mtd>   </mtr>  </mtable>  <mo>)</mo> </mrow></math></maths></entry><entry><maths id="MATH-US-00009" num="00009"><math overflow="scroll"> <mrow>  <mo>(</mo>  <mtable>   <mtr>    <mtd>     <mn>1</mn>    </mtd>   </mtr>   <mtr>    <mtd>     <mn>6</mn>    </mtd>   </mtr>  </mtable>  <mo>)</mo> </mrow></math></maths></entry></row><row><entry> </entry></row><row><entry>Option b</entry><entry><maths id="MATH-US-00010" num="00010"><math overflow="scroll"> <mrow>  <mo>(</mo>  <mtable>   <mtr>    <mtd>     <mn>7</mn>    </mtd>   </mtr>   <mtr>    <mtd>     <mn>4</mn>    </mtd>   </mtr>  </mtable>  <mo>)</mo> </mrow></math></maths></entry><entry><maths id="MATH-US-00011" num="00011"><math overflow="scroll"> <mrow>  <mo>(</mo>  <mtable>   <mtr>    <mtd>     <mn>7</mn>    </mtd>   </mtr>   <mtr>    <mtd>     <mn>5</mn>    </mtd>   </mtr>  </mtable>  <mo>)</mo> </mrow></math></maths></entry><entry><maths id="MATH-US-00012" num="00012"><math overflow="scroll"> <mrow>  <mo>(</mo>  <mtable>   <mtr>    <mtd>     <mn>8</mn>    </mtd>   </mtr>   <mtr>    <mtd>     <mn>6</mn>    </mtd>   </mtr>  </mtable>  <mo>)</mo> </mrow></math></maths></entry><entry><maths id="MATH-US-00013" num="00013"><math overflow="scroll"> <mrow>  <mo>(</mo>  <mtable>   <mtr>    <mtd>     <mn>9</mn>    </mtd>   </mtr>   <mtr>    <mtd>     <mn>7</mn>    </mtd>   </mtr>  </mtable>  <mo>)</mo> </mrow></math></maths></entry></row><row><entry namest="1" nameend="5" align="center" rowsep="1"/></row></tbody></tgroup></table></tables><br/>It is seen that option a) will lead to a more even distribution of the inter-vehicle gaps at the final epoch t3. Unlike option b), it also does not allow the minimum gap to reach 1 for any epoch. Therefore, from the point of view of inter-vehicle gap balancing, option a) is perceived as the more advantageous one and is likely to be preferred by the traffic planner.</p><p id="p-0067" num="0054"><figref idref="DRAWINGS">FIG. <b>5</b></figref> shows a truck <b>500</b>, a bus <b>502</b> and a construction equipment vehicle <b>504</b>. A fleet of vehicles of one or more of these types, whether they are autonomous or conventional, can be controlled in a centralized fashion using the method <b>100</b> or the device <b>200</b> described above.</p><p id="p-0068" num="0055">The aspects of the present disclosure have mainly been described above with reference to a few embodiments. However, as is readily appreciated by a person skilled in the art, other embodiments than the ones disclosed above are equally possible within the scope of the invention, as defined by the appended patent claims.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001" nb-file="US20230004163A1-20230105-M00001.NB"><img id="EMI-M00001" he="12.36mm" wi="76.20mm" file="US20230004163A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00002" nb-file="US20230004163A1-20230105-M00002.NB"><img id="EMI-M00002" he="12.36mm" wi="76.20mm" file="US20230004163A1-20230105-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00003" nb-file="US20230004163A1-20230105-M00003.NB"><img id="EMI-M00003" he="6.35mm" wi="76.20mm" file="US20230004163A1-20230105-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00004" nb-file="US20230004163A1-20230105-M00004.NB"><img id="EMI-M00004" he="5.67mm" wi="76.20mm" file="US20230004163A1-20230105-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00005" nb-file="US20230004163A1-20230105-M00005.NB"><img id="EMI-M00005" he="6.01mm" wi="76.20mm" file="US20230004163A1-20230105-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00006" nb-file="US20230004163A1-20230105-M00006.NB"><img id="EMI-M00006" he="5.67mm" wi="4.23mm" file="US20230004163A1-20230105-M00006.TIF" alt="embedded image " img-content="table" img-format="tif"/></us-math><us-math idrefs="MATH-US-00007" nb-file="US20230004163A1-20230105-M00007.NB"><img id="EMI-M00007" he="5.67mm" wi="4.23mm" file="US20230004163A1-20230105-M00007.TIF" alt="embedded image " img-content="table" img-format="tif"/></us-math><us-math idrefs="MATH-US-00008" nb-file="US20230004163A1-20230105-M00008.NB"><img id="EMI-M00008" he="5.67mm" wi="4.23mm" file="US20230004163A1-20230105-M00008.TIF" alt="embedded image " img-content="table" img-format="tif"/></us-math><us-math idrefs="MATH-US-00009" nb-file="US20230004163A1-20230105-M00009.NB"><img id="EMI-M00009" he="5.67mm" wi="4.23mm" file="US20230004163A1-20230105-M00009.TIF" alt="embedded image " img-content="table" img-format="tif"/></us-math><us-math idrefs="MATH-US-00010" nb-file="US20230004163A1-20230105-M00010.NB"><img id="EMI-M00010" he="5.67mm" wi="4.23mm" file="US20230004163A1-20230105-M00010.TIF" alt="embedded image " img-content="table" img-format="tif"/></us-math><us-math idrefs="MATH-US-00011" nb-file="US20230004163A1-20230105-M00011.NB"><img id="EMI-M00011" he="5.67mm" wi="4.23mm" file="US20230004163A1-20230105-M00011.TIF" alt="embedded image " img-content="table" img-format="tif"/></us-math><us-math idrefs="MATH-US-00012" nb-file="US20230004163A1-20230105-M00012.NB"><img id="EMI-M00012" he="5.67mm" wi="4.23mm" file="US20230004163A1-20230105-M00012.TIF" alt="embedded image " img-content="table" img-format="tif"/></us-math><us-math idrefs="MATH-US-00013" nb-file="US20230004163A1-20230105-M00013.NB"><img id="EMI-M00013" he="5.67mm" wi="4.23mm" file="US20230004163A1-20230105-M00013.TIF" alt="embedded image " img-content="table" img-format="tif"/></us-math><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A traffic planning method for controlling a plurality of vehicles, wherein each vehicle occupies one node in a shared set of planning nodes and is movable to other nodes along predefined edges between pairs of the nodes in accordance with a finite set of motion commands, the method comprising:<claim-text>obtaining initial node occupancies of the vehicles; and</claim-text><claim-text>determining a sequence of motion commands by optimizing a state-action value function which depends on node occupancies and the motion commands to be given, the state-action value function including at least one command-independent term, which penalizes node occupancies with too small inter-vehicle gaps, and at least one command-dependent term.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein is executed repeatedly, and the command-dependent term is updated on the basis of a predefined reward function after each execution cycle of said determining.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the command-independent term is exempted from said updating.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the reward function represents productivity minus cost.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the command-independent term penalizes an inter-vehicle gap expressed as a time separation of the vehicles in the respective vehicle's direction of movement.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the command-independent term depends on a gap-balancing indicator which penalizes too small gaps and/or unevenly distributed gaps.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the gap-balancing indicator depends on a variability measure of the gap sizes, such as a standard deviation of the gap sizes.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the command-independent term includes a composition of the gap-balancing indicator with at least one of the following functions:<claim-text>a rectified linear unit, ReLU, activation function;</claim-text><claim-text>a sigmoid function;</claim-text><claim-text>a gaussian function.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising obtaining the state-action value function by a preceding step of reinforcement learning.</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said determining of a sequence of motion commands and any reinforcement learning are performed within a Dyna-2 algorithm.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the vehicles are autonomous vehicles.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. A device configured to control a plurality of vehicles, wherein each vehicle occupies one node in a shared set of planning nodes and is movable to other nodes along predefined edges between pairs of the nodes in accordance with a finite set of motion commands, the device comprising:<claim-text>a first interface configured to receive initial node occupancies of the vehicles;</claim-text><claim-text>a second interface configured to feed motion commands selected from said finite set to said plurality of vehicles; and</claim-text><claim-text>processing circuitry configured to perform the method of <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. A computer program comprising instructions which, when executed, cause a processor to execute the method of any of <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text></claim></claims></us-patent-application>