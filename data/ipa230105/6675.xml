<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230006676A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230006676</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17781063</doc-number><date>20201109</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="regional"><country>EP</country><doc-number>19217797.0</doc-number><date>20191219</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>03</class><subclass>K</subclass><main-group>21</main-group><subgroup>02</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>03</class><subclass>L</subclass><main-group>7</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>03</class><subclass>K</subclass><main-group>21</main-group><subgroup>02</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>03</class><subclass>L</subclass><main-group>7</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">METHOD AND APPARATUS FOR SYNCHRONIZING TWO SYSTEMS</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Microsoft Technology Licensing, LLC</orgname><address><city>Redmond</city><state>WA</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>LASLO</last-name><first-name>Ori</first-name><address><city>Rehovot</city><country>IL</country></address></addressbook></inventor></inventors></us-parties><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/US2020/059599</doc-number><date>20201109</date></document-id><us-371c12-date><date>20220531</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">An apparatus and method for synchronizing a triggered system to a triggering system by tracking the timing of rising and falling edges of a clock signal at the triggered system and using the tracked timing values for phase shift adjustment of a time base at the triggered systems.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="103.29mm" wi="156.72mm" file="US20230006676A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="225.98mm" wi="158.75mm" file="US20230006676A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="216.41mm" wi="141.90mm" file="US20230006676A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="199.56mm" wi="160.87mm" file="US20230006676A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="137.16mm" wi="64.01mm" file="US20230006676A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="243.16mm" wi="167.72mm" file="US20230006676A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="243.16mm" wi="167.72mm" file="US20230006676A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="232.92mm" wi="118.96mm" file="US20230006676A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">BACKGROUND</heading><p id="p-0002" num="0001">In many applications, there are interacting systems that run on independent time bases (e.g. system clocks) which control a timing of their operations (e.g. start, stop, wait, etc.). In such applications, a common time base of these systems controls the independent time bases to ensure that their operations are conducted in a synchronized manner in comparison to one another. Examples for such applications are touch and stylus sensing chips which together control a large or foldable touch screen, or networked devices which communicate with each other, or the like.</p><heading id="h-0002" level="1">SUMMARY</heading><p id="p-0003" num="0002">This Summary is provided to introduce a selection of concepts in simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter, nor is it intended to be used to limit the scope of the claimed subject matter. Nor is the claimed subject matter limited to implementations that solve any or all of the disadvantages noted herein.</p><p id="p-0004" num="0003">The disclosure in some embodiments relates to an apparatus for synchronizing a counter to an input trigger signal, the apparatus comprising a data acquisition module (logger circuit) for sampling and recording values of the counter in response to a detection of rising and/or falling edges of the input trigger signal, wherein the sampling is performed at rising and falling edges of a common clock signal supplied to the counter and the data acquisition module; and a control circuit for reading the recorded values and calculating at least one of an offset and a configurable delay of the counter based on the recorded values and predetermined collected values.</p><p id="p-0005" num="0004">According to a further aspect, a method of synchronizing a counter to an input trigger signal is provided, the method comprising sampling and recording values of a counter in response to a detection of rising and/or falling edges of the input trigger signal, wherein the sampling is performed at rising and falling edges of a common clock signal supplied to the counter; and calculating at least one of an offset and a configurable delay of the counter based on the recorded values and predetermined collected values.</p><p id="p-0006" num="0005">Unless otherwise defined, all technical and/or scientific terms used herein have the same meaning as commonly understood by one of ordinary skill in the art. Although methods, components and signals similar or equivalent to those described herein can be used in practice or testing of embodiments of the disclosure, example methods and/or components and/or signals are described below. In addition, the components, signals, methods, and examples are illustrative only and are not intended to be necessarily limiting.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0007" num="0006">To assist understanding of the present disclosure and to show how embodiments of such may be put into effect, reference is made, by way of example only, to the accompanying drawings in which:</p><p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a schematic block diagram of an example of two interactive systems operated on the basis of a common clock signal,</p><p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a schematic block diagram of an example of a conventional approach for synchronization of two interactive systems operated on the basis of a common clock signal,</p><p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a schematic diagram with examples of waveforms of a trigger signal and related clock signals to explain an indeterministic nature of synchronization of two systems operated on the basis of a common clock signal,</p><p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a schematic block diagram of an example system with enhanced synchronization for improved accuracy,</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a schematic diagram with an example of a waveform of a common clock signal and four regions to explain the indeterministic nature of synchronization,</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a schematic flow diagram of an example of an enhanced synchronization procedure with improved accuracy,</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a first part of a schematic flow diagram of an example of a procedure for determining a counter offset and a configurable delay,</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a second part of the schematic flow diagram of an example of a procedure for determining a counter offset and a configurable delay,</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a diagram of an example of a histogram of resulting inaccuracies between two systems after synchronization with longer hold and setup times, and</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a diagram of an example of a histogram of resulting inaccuracies between two systems after synchronization with shorter hold and setup times.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0004" level="1">DETAILED DESCRIPTION OF EMBODIMENTS</heading><p id="p-0018" num="0017">The present disclosure is directed to an improved synchronization of time bases of two or more systems to one another with higher accuracy of less than one clock cycle. In examples, the accuracy may be in the range from one quarter to one eighth of a clock cycle of the time bases. Conventional synchronization methods are able to synchronize the two systems with a maximum accuracy of one clock cycle of the time base.</p><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a schematic block diagram of an example of two interactive systems A and B <b>10</b>, <b>20</b> operated on the basis of a common clock signal CLK_IN generated by a common clock source (e.g. clock generator) <b>30</b>. The two systems A and B <b>10</b>, <b>20</b> may be implemented as electric circuits implemented on different parts of an integrated circuit or in different integrated circuits. In examples, the common clock signal CLK_IN may be used as a common time base of the two systems A and B <b>10</b>, <b>20</b> to control their independent time bases to ensure that their operations are conducted in a synchronized manner in comparison to one another. Examples for such systems may be touch and stylus sensing chips which together control a large or foldable touch screen, or networked devices which communicate with each other, or any other types of interoperating or interactive systems that need to be synchronized for proper operation.</p><p id="p-0020" num="0019">It is noted that, for reasons of brevity, only those system components are shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref> and the following <figref idref="DRAWINGS">FIGS. <b>2</b> and <b>4</b></figref>, that are useful for explaining specific example operations of example embodiments. Moreover, unless indicated otherwise, components or signals with identical reference signs have same or similar functionalities and/or structures which may be described only once in the present disclosure.</p><p id="p-0021" num="0020">In examples, the common clock signal may be in the form of a square wave with a 50% duty cycle and a fixed, constant frequency. Circuits of the two systems A and B <b>10</b>, <b>20</b> using the clock signal CLK_IN for synchronization may become active at either the rising edge, the falling edge, or, in the case of double data rate (DDR), both at the rising and at the falling edges of the clock cycle.</p><p id="p-0022" num="0021">In examples, the common clock signal CLK_IN or a clock signal derived from the common clock CLK_IN may be gated, that is, combined with a controlling signal (not shown) that enables or disables the clock signal CLK_IN e.g. for a certain part of a circuit of the systems. The time base of the common clock source <b>30</b> may be constantly running at a relatively low speed in comparison to a faster internal clock rate (&#x201c;fast clock&#x201d;) available in each of the systems <b>10</b>, <b>20</b>.</p><p id="p-0023" num="0022">In addition, each of the systems <b>10</b>, <b>20</b> may comprise a phase locked loop (PLL) circuit <b>14</b>, <b>24</b> which generates based on the common clock signal CLK_IN a higher frequency used for internal operations that require higher clock rates (e.g. the fast clock), such as an internal central processing unit (CPU, not shown). The PLL circuits <b>14</b>, <b>24</b> may be control circuits that generate the fast clock with a phase related to the phase of the input clock signal CLK_IN. There are several different types of circuits that may be used to implement the PLL circuits <b>14</b>, <b>24</b>. In examples, a simple option may be an electronic circuit consisting of a variable frequency oscillator and a phase detector in a feedback loop. The oscillator generates a periodic signal, and the phase detector compares the phase of that signal with the phase of the input periodic signal, adjusting the oscillator to keep the phases matched. Keeping the input and output phase in lock step also implies keeping the input and output frequencies the same. Consequently, in addition to synchronizing the fast clock and the common clock signal CLK_IN, the PLL circuits <b>14</b>, <b>24</b> can track the input frequency of the common clock signal CLK_IN, or they can generate a frequency that is a multiple of the input frequency.</p><p id="p-0024" num="0023">In examples, the PLL circuits <b>14</b>, <b>24</b> may be turned off/on frequently to save power, so that the fast clock can be temporarily turned off for power saving considerations. Thereby, power can be saved by effectively shutting down portions of digital circuit(s) of the systems <b>10</b> and <b>20</b> when they are not in use.</p><p id="p-0025" num="0024">In examples, the common clock source <b>30</b> may comprise an electronic oscillator (circuit) that produces the common clock signal CLK_IN which can range from a simple symmetrical square wave to more complex arrangements. The basic parts of the clock source <b>30</b> may be a resonant circuit and an amplifier. The resonant circuit may be a quartz piezo-electric oscillator, although simpler tank circuits and even resistor and capacitance (RC) circuits may be used as well. The amplifier circuit may be used to invert the signal from the oscillator and feed a portion back into the oscillator to maintain oscillation. In examples, the common clock source <b>30</b> may have additional sections to modify a basic clock signal. As an example, the common clock source <b>30</b> may incorporate logic to convert a 50% duty cycle (which is typical of raw oscillators) into a different duty cycle.</p><p id="p-0026" num="0025">In examples, other optional sections of the common clock source <b>30</b> may include hardware and/or software implemented frequency divider or clock multiplier sections. Furthermore, programmable clock generators may allow a number used in the divider or multiplier to be changed, allowing any of a wide variety of output frequencies to be selected without modifying the hardware.</p><p id="p-0027" num="0026">The two systems of <figref idref="DRAWINGS">FIG. <b>1</b></figref> share the common clock source <b>30</b>, e.g., by having one of the two systems <b>10</b>, <b>20</b> (e.g. system A <b>10</b>) drive the CLK_IN input of the other one (e.g. system B <b>20</b>, or by both systems <b>10</b>, <b>20</b> being driven by the common clock source <b>30</b> as shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>. However, due to propagation delays within the systems <b>10</b>, <b>20</b> and/or throughout the clock path between the systems and/or from the common clock source <b>30</b> to each of the systems <b>10</b>, <b>20</b>, there is an unknown phase shift between the two CLK_IN domains (i.e. they are frequency aligned, but not phase aligned). As indicated in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, this unknown phase shift may be caused by respective unknown delays A and B between the common clock source <b>30</b> and the respective CLK_IN inputs of the two systems <b>10</b>, <b>20</b>.</p><p id="p-0028" num="0027">Furthermore, in examples, in each of the two systems <b>10</b>, <b>20</b>, a respective counter <b>12</b>, <b>22</b> is provided which accumulates the number of clock events of the respective clock signals CLK_IN to provide time signals (e.g. time stamps) as a time base that must be calibrated very accurately. Throughout the present disclosure, the time base of each of the two systems <b>10</b>, <b>20</b> will therefore be referred to as &#x201c;counter&#x201d; <b>12</b>, <b>22</b>.</p><p id="p-0029" num="0028">In examples, the counters <b>12</b>, <b>22</b> may store the number of times a particular event (i.e. a clock cycle or edge of the input clock signal CLK_IN) has occurred. They may be implemented as a sequential digital logic circuit with an input line for the clock signal CLK_IN and multiple output lines. The values on the output lines may represent a number in a binary or binary coded digital (BCD) number system. Each pulse or pulse edge applied to the clock input increments or decrements the number in the counter. More specifically, in examples, the circuits of the counters <b>12</b>, <b>22</b> may be constructed of a number of flip-flops connected in cascade. In examples, the counters <b>12</b>, <b>22</b> may be manufactured as separate integrated circuits and also incorporated as parts of larger integrated circuits. In other examples, the counters <b>12</b>, <b>22</b> may be implemented by respective processor circuits that are controlled via a software program that implements a counter function.</p><p id="p-0030" num="0029">In examples, the counters <b>12</b>, <b>22</b> may include some form of amplifier, filtering and shaping circuitry at the input. Digital signal processing (DSP) technology, sensitivity control and hysteresis are other techniques that may be applied to improve performance of the counters <b>12</b>, <b>22</b>.</p><p id="p-0031" num="0030">As shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the internal clock signals CLK_IN of each of the two systems <b>10</b>, <b>20</b> are supplied to the respective counter <b>12</b>, <b>22</b>, so that the respective counter <b>12</b>, <b>22</b> of each system operates on the basis of the CLK_IN domain. However, in examples, each of the two system <b>10</b>, <b>20</b> may be powered up independently, and their boot times may not be identical, so that each of the respective counters <b>12</b>, <b>22</b> may start counting at a different time.</p><p id="p-0032" num="0031">Furthermore, the interaction between the two systems <b>10</b>, <b>20</b> may be based on an exchange of input/output (<b>10</b>) signals <b>100</b> and/or communication signals <b>110</b> via respective connection channels or lines. In examples, such communication signals <b>110</b> may be based on Bluetooth, Wi-Fi, near-field communication (NFC), etc., wherein respective communication units (not shown) may include a transceiver to transmit/receive communication commands, pairing requests, etc. from the communication unit of the respective other system. Additionally or alternatively, the communication between the two systems <b>10</b>, <b>20</b> may be based on wired transmissions, for example, Universal Serial Bus (USB) or Ethernet connections or other wired connection systems.</p><p id="p-0033" num="0032">The systems <b>10</b>, <b>20</b> may further comprise a power supply (not shown), which may comprise a battery for powering the various components of the systems <b>10</b>, <b>20</b>. The battery may be rechargeable, replaceable, disposable, etc.</p><p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a schematic block diagram of an example of an approach for synchronizing the two interactive systems A and B <b>10</b>, <b>20</b> operated on the basis of the common clock signal CLK_IN. According to this approach, one of the two systems <b>10</b>, <b>20</b> (e.g. system A <b>10</b>, triggering system) will send a &#x201c;trigger&#x201d; signal T to the other one of the two systems <b>10</b>, <b>20</b> (e.g. system B <b>20</b>, triggered system) e.g. on one of the I/O connection lines when its counter (e.g. counter <b>12</b>) reaches a certain pre-defined count value. Throughout the present disclosure, this count value is marked with the letter &#x201c;Y&#x201d;.</p><p id="p-0035" num="0034">In examples, the trigger signal T may by a pulse-shaped signal (where a pulse indicates a trigger event) or a binary signal with two states (where a transition from one state to the other indicates a trigger event) or a predefined signal pattern or value (where the pattern or value indicates the trigger event).</p><p id="p-0036" num="0035">When the trigger event of the trigger signal T is detected by the triggered system (e.g. system B <b>20</b>), the triggered system may control the counter <b>22</b> to load a value of Y+&#x394; (wherein the value of A depends on the propagation delay of the trigger signal T and optionally an internal delay of a path of the trigger signal T (e.g. how many sampling flip-flops are in the path of the trigger signal).</p><p id="p-0037" num="0036">However, due to the fact that the two counters <b>12</b>, <b>22</b> of the two systems <b>10</b>, <b>20</b> work on clocks that are not phase-aligned, the triggered system (e.g. system B <b>20</b>) may comprise an initial synchronizing circuit (Sync) <b>26</b> (synchronizer) for the trigger signal T, transferring or adapting it to the timing of its own clock signal CLK_IN, i.e., its own CLK_IN domain.</p><p id="p-0038" num="0037">The synchronizing circuit <b>26</b> may be provided at both systems <b>10</b>, <b>20</b> and may be used as an interface so that the trigger signal T from the triggering system is reliably interpreted by the triggered system. Thus, whenever there is a transfer of the trigger signal T between the two systems <b>10</b>, <b>20</b> operating at same frequency but with different phases, the synchronizing circuit <b>26</b> is used as an interface. In examples, the synchronizing circuit <b>26</b> may use flip flop circuits offering single or double latency delays at the output. For example, the synchronizing circuit <b>26</b> may have a delay of anywhere between two and three cycles of the clock signal CLK_CIN.</p><p id="p-0039" num="0038">However, the synchronizing circuit <b>26</b> adds a delay with an indeterministic portion of one CLK_IN cycle, because it is unknown when the next rising edge of the clock signal CLK_IN after the detection of the trigger signal T (e.g. trigger event) occurs. As a result, the inaccuracy of the synchronization process may reach up to a single cycle of the clock signal CLK_IN. Due to the indeterministic nature of this inherent inaccuracy, it is not possible to compensate for it by software of hardware based on a predetermined fixed compensation value that will always work.</p><p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a schematic diagram with examples of waveforms of the trigger signal T (second waveform from the top) and related clock signals to explain the above indeterministic nature of synchronizing the two systems.</p><p id="p-0041" num="0040">The triggering system (system A) is operated on the basis of a first clock signal CLK_IN (uppermost waveform). Additionally, <figref idref="DRAWINGS">FIG. <b>3</b></figref> shows three options I to III of example timings of the second clock signal CLK_IN at the triggered system (system B), wherein the next rising edge of the second clock signal CLK_IN may be delayed by less than one half clock cycle (option I, middle waveform), more than one half clock cycle (option II, second last waveform form the top), and close to but less than one clock cycle (option III, lowermost waveform) with respect to the rising edge (trigger event) of the trigger signal T.</p><p id="p-0042" num="0041">As can be gathered from <figref idref="DRAWINGS">FIG. <b>3</b></figref>, when the counter <b>12</b> of the triggering system (system A) <b>10</b> has reached the triggering value of &#x201c;Y&#x201d;, the trigger signal T is activated e.g. by changing its binary state and creating a rising edge, or vice versa. With the next rising edge of the clock signal CLK_IN at the triggered system (system B) <b>20</b>, an adjusted or compensated value of Y+&#x394; will be latched to the counter <b>22</b> at the triggered system <b>20</b> after a deterministic delay of e.g. two clock cycles (time periods) of the clock signal CLK_IN caused by the synchronizing circuit <b>26</b>.</p><p id="p-0043" num="0042">Thus, the total delay until the compensated value of Y+&#x394; is latched at the counter <b>22</b> of the triggered system <b>20</b> depends on the initial indeterministic delay caused by the phase difference between the first clock signal CLK_IN of the first system <b>10</b> and the second clock signal CLK_IN of the second system <b>20</b>. For option I, the total delay amounts to about two time periods of the clock signal CLK_IN. For option II, the total delay amounts to about two and a half time periods of the clock signal CLK_IN. For option III, the total delay amounts to about three time periods of the clock signal CLK_IN.</p><p id="p-0044" num="0043">As a result, selecting the delay compensation value of A for the counter <b>22</b> of the triggered system <b>20</b> to be &#x201c;2&#x201d; may result in an inaccuracy of plus one CLK_IN cycle, while selecting the delay compensation value of A to be &#x201c;3&#x201d; may result in an inaccuracy of minus one CLK_IN cycle.</p><p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a schematic block diagram of an example system with an enhanced synchronization approach for improved accuracy.</p><p id="p-0046" num="0045">It is noted that blocks with reference numbers identical to those in <figref idref="DRAWINGS">FIGS. <b>1</b> and <b>2</b></figref> have same or similar functions and structures and are therefore not described again here.</p><p id="p-0047" num="0046">In example embodiments, the triggered system (e.g. system B) <b>20</b> comprises a &#x201c;logger&#x201d; module or circuit <b>27</b> which is configured to detect edges of the trigger signal T (e.g. rising and/or falling edges) and to record the value of the counter <b>22</b> of the triggered system <b>20</b> after which the edge of the trigger signal T was detected. The logger circuit <b>27</b> may comprise a synchronizing circuit similar to the synchronizing circuit <b>26</b> of <figref idref="DRAWINGS">FIG. <b>2</b></figref>. As regards their clocking, both the logger circuit <b>27</b> and the synchronizing circuit are configured to become active at the rising edges and at the falling edges of the clock cycle of the clock signal CLK_IN (i.e. double data rate (DDR) capability). Thus, if the logger circuit <b>27</b> has the synchronizing circuit at its input, an indeterminism of one sampling cycle (i.e. 0.5 CLK_IN clock) is created.</p><p id="p-0048" num="0047">The logger circuit <b>27</b> is a data acquisition module which comprises or cooperates with an on-board memory (not shown) that is used to store acquired data (i.e. counter values). In examples, this memory may be a battery-backed static random access memory, flash memory or electrically erasable programmable read-only memory (EEPROM) or the like.</p><p id="p-0049" num="0048">As indicated above, in example embodiments, the logger circuit <b>27</b> is configured to operate from the CLK_IN domain and to sample the counter values at double sampling rate (i.e. both on rising and falling edge of the clock signal CLK_IN). Therefore, the recorded counter values may be either integer (rising edge sample) or integer+0.5 (falling edge sample).</p><p id="p-0050" num="0049">Furthermore, in example embodiments, the triggered system <b>20</b> may comprise a configurable delay module or circuit <b>28</b> which may add a delay to the input clock signal CLK_IN supplied to the counter <b>22</b> and which may be controlled by the fast clock generated at the output of the PLL circuit <b>24</b> of the triggered system <b>20</b>. In examples, the delay of the configurable delay circuit <b>28</b> may be implemented by a software procedure (e.g. compensation by the software procedure), a controllable delay line, a controllable series of logic gates, or the like. In other sample embodiments, the configurable delay circuit <b>28</b> may be configured to add the delay to an output value of the counter <b>22</b> (e.g. by delaying a binary code output of the counter <b>22</b>). In further sample embodiments, the configurable delay circuit <b>28</b> may be configured to add the delay to a trigger output generated on the basis of the output value of the counter <b>22</b>, e.g., when the output value of the counter <b>22</b> reaches a predetermined value.</p><p id="p-0051" num="0050">Additionally, in example embodiments, the triggered system <b>20</b> may comprises a control circuit <b>25</b> (e.g. a central processing unit (CPU) or another programable logic which can be configured to read the recorded counter values of the logger circuit <b>27</b> and to apply an offset value to the counter <b>22</b> and/or set a delay value at the configurable delay circuit <b>28</b> based on the recorded counter values.</p><p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a schematic diagram with an example of a waveform of the common clock signal CLK_IN at the triggered system <b>20</b> and four regions A to D to explain the indeterministic nature of synchronization. The edge(s) of the trigger signal T (e.g. pulse train) received from the triggering system <b>10</b> (e.g. system A) may be received in one of the four regions A to D in comparison to the CLK_IN domain of the triggered system <b>20</b> (e.g. system B).</p><p id="p-0053" num="0052">More specifically, in examples, region A may designate a region located before a rising edge of the clock signal CLK_IN with appropriate setup and hold times. This region</p><p id="p-0054" num="0053">A therefore results in stable and consistent recording of counter samples for all edges of the trigger signal T and the recordings of the counter values will have integer values (i.e. least significant bit (LSB) of the binary counter value equals &#x201c;0&#x201d;). Furthermore, in examples, region B may designate a region located around a rising edge of the clock signal CLK_IN with insufficient setup and hold times. This region B therefore results in unstable recording of counter samples for the pulse train edges, wherein some counter values are latched on a rising edge (i.e. LSB=0) while other counter values are latched on the next falling edge (i.e. LSB=1). Therefore, this region B, in fact, is what creates the indeterministic nature of the synchronizing circuit at the input of the logger circuit <b>27</b>. Additionally, in examples, region C may designate a region located before a falling edge of the clock signal CLK_IN with appropriate setup and hold times. Therefore, this region C results in stable and consistent recording of counter samples for all pulse train edges of the trigger signal T and the recorded counter values will have integer+0.5 values (LSB=1). Finally, in examples, region D may designate a region located around a falling edge of the clock signal CLK_IN with insufficient setup and hold times. Therefore, this region D again results in unstable recording of counter samples for the edges of the trigger signal T, where some counter values are latched on a falling edge (LSB=1) and other counter values are latched on the next rising edge (LSB=0). Similar to region B, this region D, in fact, is what creates the indeterministic nature of the synchronizing circuit at the input of the logger circuit <b>27</b>.</p><p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a schematic flow diagram of an example of an enhanced synchronization procedure with improved accuracy according to sample embodiments.</p><p id="p-0056" num="0055">The triggering system (e.g. system A) will generate multiple edges of the trigger signal T in response to its counter (e.g. counter <b>12</b> in <figref idref="DRAWINGS">FIG. <b>2</b></figref>). Thus, the edges of the pulses (rising and/or falling) will occur on pre-defined values of the counter of the triggering system. These pre-defined counter values of the triggering system will be marked as an array [Y(<b>0</b>), Y(<b>1</b>), . . . , Y(N&#x2212;1)]. In step S<b>610</b>, these counter values Y(i) of the triggering system will be collected by the control circuit (e.g. control circuit <b>25</b> of <figref idref="DRAWINGS">FIG. <b>4</b></figref>) of the triggered system (e.g. system B). They are predetermined and may be stored at or signalled to the triggered system.</p><p id="p-0057" num="0056">Then, in step S<b>620</b>, the logger circuit of the triggered system (e.g. logger circuit <b>27</b> of <figref idref="DRAWINGS">FIG. <b>4</b></figref>) will record the values of the counter of the triggered system (e.g. counter <b>22</b> of <figref idref="DRAWINGS">FIG. <b>4</b></figref>) after which these edges of the trigger signal T were detected at the triggered system. These values will be marked as an array [X(<b>0</b>), X(<b>1</b>), . . . , X(N&#x2212;1)]. Note that the counter values X(i) recorded at the triggered system may be either an integer or and integer+0.5 due to the double sampling rate of the DDR mechanism.</p><p id="p-0058" num="0057">In other words, each recorded counter value X(i) of the triggered system has one more bit than each collected counter value Y(i) of the triggering system. This additional bit (i.e. LSB) indicates whether the counter value X(i) is an integer (LSB=0) or an integer+0.5 (LSB=1).</p><p id="p-0059" num="0058">In step S<b>630</b>, the control circuit of the triggered system reads the array X after the recording has finished. Then, in step S<b>640</b>, the control circuit of the triggered system analyses the recorded array X based on the collected array Y and sets in step S<b>650</b> at least one of the offset and the configurable delay of the counter of the triggered system accordingly to improve accuracy of synchronization of the triggered system.</p><p id="p-0060" num="0059">Thus, as indicated above, in example embodiments, the edges of the trigger signal T are generated based on the clock signal CLK_IN at the triggering system and are sampled at the triggered system based on the clock signal CLK_IN of the triggered system. Note that because both systems are frequency aligned (even though they're not phase aligned), as they share the same clock signal of the common clock source (e.g. clock source <b>30</b> of <figref idref="DRAWINGS">FIG. <b>1</b></figref>), all the edges of the pulse train of trigger signal T will arrive on the same one of the regions A to D of <figref idref="DRAWINGS">FIG. <b>5</b></figref>.</p><p id="p-0061" num="0060">By analyzing the recorded counter values of the logger circuit <b>27</b>, the offset &#x25a1; between the counters of the two systems can be determined with a resolution of a single cycle of the clock signal CLK_IN. As a further option, based on the above regions A to D in which the edges have arrived, the configurable delay can be determined and set in order to &#x201c;fine-tune&#x201d; the offset of the counter of the triggered system with a resolution lower than a single cycle of the clock signal CLK_IN.</p><p id="p-0062" num="0061">In the following, a detailed procedure for an enhanced synchronization accuracy according to an example embodiment is described with reference to <figref idref="DRAWINGS">FIGS. <b>7</b> and <b>8</b></figref> based on respective flow diagrams, assuming that the number of bits in the counter of the triggered system is &#x201c;M&#x201d; and the number of bits of the counter values recorded by the logger circuit is &#x201c;M+1&#x201d; (due to the double-rate sampling (DDR) at rising and falling edges of the clock signal CLK_IN.</p><p id="p-0063" num="0062">The procedure may be performed by the control circuit of the triggered system (e.g. control circuit <b>25</b> of <figref idref="DRAWINGS">FIG. <b>4</b></figref>) to determine at least one of an optimal offset and a configurable delay for the counter of the triggered system, wherein the flow diagrams of <figref idref="DRAWINGS">FIGS. <b>7</b> and <b>8</b></figref> relate to different cases or branches of the procedure selected in dependence on an initial count value X<b>0</b> of the counter of the triggered system (e.g. counter <b>22</b> of <figref idref="DRAWINGS">FIG. <b>4</b></figref>), e.g., whether an integer value (X<b>0</b>[<b>0</b>]=0) or a non-integer value (X<b>0</b>[<b>0</b>]=1) has been detected as first count value (i.e. time stamp). The maximum value N of the running parameter i corresponds to the number of considered edges of the trigger signal T. As an example, a value N=10 (i.e. 5 cycles) or larger could be selected.</p><p id="p-0064" num="0063"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a first branch of the flow diagram, which is selected if the LSB of the initial counter value X<b>0</b> after receipt of a relevant edge of the trigger signal T is &#x201c;1&#x201d;, i.e., the initial counter value is a non-integer count value (which roughly corresponds to area C of <figref idref="DRAWINGS">FIG. <b>5</b></figref>). However, it is not clear yet whether the relevant edge is located in one of areas B or D of <figref idref="DRAWINGS">FIG. <b>5</b></figref>.</p><p id="p-0065" num="0064">In step S<b>701</b>, the counter offset &#x25a1; is set to the difference (Y<b>0</b>&#x2212;X<b>0</b>[M:<b>1</b>]) between the initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) and the configurable delay is initially set to a quarter of a clock cycle of the clock signal CLK_IN (i.e. 0.25*CLK_IN). Then, in step S<b>702</b>, a running parameter i is set to &#x201c;1&#x201d;. Thereafter, in step S<b>703</b> the current (M+1)-bit counter value (time stamp) Xi[M:<b>0</b>] of the counter of the triggered system is checked. If it is determined that its LSB value is &#x201c;1&#x201d;, the procedure branches to step S<b>704</b> and it is checked whether the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) and the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) are identical. If not, the procedure branches to step S<b>705</b> and an error is determined. Such an error indicates that the measured results are not meaningful, which should normally not happen. If it does, the procedure could be restarted (e.g. the pulse train of the trigger signal could be sent and measured again). If the differences are identical, the procedure branches to step S<b>706</b> where the running parameter i is incremented (e.g. by one) and it is checked whether the maximum value N of the running parameter i has been reached. If not, the procedure jumps back to step S<b>703</b>. Otherwise, if the running parameter i has reached the maximum value N, the procedure branches to step S<b>707</b> and a success is determined, i.e., a correct offset and delay for optimal synchronization has been found</p><p id="p-0066" num="0065">Otherwise, if it is determined in step S<b>703</b> that the LSB value of the current counter value Xi is &#x201c;0&#x201d;, the procedure continues with step S<b>708</b> where it is checked whether the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) and the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) are identical. If not, the procedure branches to step S<b>709</b> where it is checked whether the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system and the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) plus 1 are identical. If not, the procedure branches to step S<b>710</b> and an error is determined.</p><p id="p-0067" num="0066">If it is determined in step S<b>709</b> that the differences are identical, the procedure continues with step S<b>711</b> where the counter offset &#x25a1;&#x25a1; is set to the initial difference (Y<b>0</b>&#x2212;X<b>0</b>[M:<b>1</b>]) between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system and the configurable delay is set to one half of the cycle of the clock signal CLK_IN (i.e. 0.5*CLK_IN). Then, the procedure continues with step S<b>712</b> where the running parameter i is incremented and where it is checked whether the running parameter i has reached its maximum value N. If so, the procedure branches to step S<b>713</b> and a success is determined, i.e., optimum values of area B of <figref idref="DRAWINGS">FIG. <b>5</b></figref> have been set for the counter offset and the configurable delay.</p><p id="p-0068" num="0067">If the running parameter i has not yet reached its maximum value N in step S<b>712</b>, the procedure continues with step S<b>714</b> and the current (M+1)-bit counter value (time stamp) Xi[M:<b>0</b>] of the counter of the triggered system is checked. Then, in step S<b>715</b>, it is checked whether the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) and the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) are identical and the LSB (Xi[<b>0</b>]) is &#x201c;1&#x201d;, or whether the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) plus 1 and the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) are identical and the LSB (Xi[<b>0</b>]) is &#x201c;0&#x201d;. If not, the procedure continues with step S<b>716</b> where an error is determined. Otherwise, if it is determined in step S<b>715</b> that the differences are identical for one of the cases, the procedure jumps back to step S<b>712</b> and the running parameter is incremented again.</p><p id="p-0069" num="0068">If it is determined in step S<b>708</b> that the differences are identical, the procedure continues with step S<b>717</b> where the counter offset &#x25a1;&#x25a1; is set to the initial difference (Y<b>0</b>&#x2212;X<b>0</b>[M:<b>1</b>]) between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system and the configurable delay is set to zero. Then, the procedure continues with step S<b>718</b> where the running parameter i is incremented and where it is checked whether the running parameter i has reached its maximum value N. If so, the procedure branches to step S<b>719</b> and a success is determined, i.e., optimum values of area D of <figref idref="DRAWINGS">FIG. <b>5</b></figref> have been set for the counter offset and the configurable delay.</p><p id="p-0070" num="0069">If the running parameter i has not yet reached its maximum value N in step S<b>718</b>, the procedure continues with step S<b>720</b> and the current (M+1)-bit counter value (time stamp) Xi[M:<b>0</b>] of the counter of the triggered system is checked. Then, in step S<b>721</b>, it is checked whether the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) and the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) are identical. If not, the procedure continues with step S<b>722</b> where an error is determined. Otherwise, if it is determined in step S<b>721</b> that the differences are identical, the procedure jumps back to step S<b>718</b> and the running parameter is incremented again.</p><p id="p-0071" num="0070"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a second branch of the flow diagram, which is selected if the LSB of the initial counter value X<b>0</b> after receipt of a relevant edge of the trigger signal T is &#x201c;0&#x201d;, i.e., the initial counter value is an integer count value (which roughly corresponds to area A of <figref idref="DRAWINGS">FIG. <b>5</b></figref>). However, it is not clear yet whether the relevant edge is located in one of the areas B or D of <figref idref="DRAWINGS">FIG. <b>5</b></figref>.</p><p id="p-0072" num="0071">In step S<b>801</b>, the counter offset &#x25a1; is set to the initial difference between the initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system plus 1 (Y<b>0</b>&#x2212;X<b>0</b>[M:<b>1</b>]+1) and the configurable delay is set to three quarters of a clock cycle of the clock signal CLK_IN (i.e. 0.75*CLK_IN). Then, in step S<b>802</b>, a running parameter i is set to &#x201c;1&#x201d;. Thereafter, in step S<b>803</b> the current (M+1)-bit counter value (time stamp) Xi[M:<b>0</b>] of the counter of the triggered system is checked. If it is determined that its LSB value is &#x201c;0&#x201d;, the procedure branches to step S<b>804</b> and it is checked whether the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) and the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) are identical. If not, the procedure branches to step S<b>805</b> and an error is determined. If the differences are identical, the procedure branches to step S<b>806</b> and the running parameter i is incremented (e.g. by one) and it is checked whether the maximum value N of the running parameter i has been reached. If not, the procedure jumps back to step S<b>803</b>. Otherwise, if the running parameter i has reached the maximum value N, the procedure branches to step S<b>807</b> and a success is determined, i.e., optimum values of area A of <figref idref="DRAWINGS">FIG. <b>5</b></figref> have been set for the counter offset and the configurable delay.</p><p id="p-0073" num="0072">Otherwise, if it is determined in step S<b>803</b> that the LSB value of the current counter value Xi is &#x201c;1&#x201d;, the procedure continues with step S<b>808</b> where it is checked whether the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) and the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) are identical. If not, the procedure branches to step S<b>809</b> where it is checked whether the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) and the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) plus 1 are identical. If not, the procedure branches to step S<b>810</b> and an error is determined.</p><p id="p-0074" num="0073">If it is determined in step S<b>809</b> that the differences are identical, the procedure continues with step S<b>811</b> where the counter offset &#x25a1;&#x25a1; is set to the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system plus 1 (Y<b>0</b>&#x2212;X<b>0</b>[M:<b>1</b>]+1) and the configurable delay is set to one half of the cycle of the clock signal CLK_IN (i.e. <b>0</b>.5*CLK_IN). Then, the procedure continues with step S<b>812</b> where the running parameter i is incremented and where it is checked whether the running parameter i has reached its maximum value N. If so, the procedure branches to step S<b>813</b> and a success is determined, i.e., optimum values of area B of <figref idref="DRAWINGS">FIG. <b>5</b></figref> have been set for the counter offset and the configurable delay.</p><p id="p-0075" num="0074">If the running parameter i has not yet reached its maximum value N in step S<b>812</b>, the procedure continues with step S<b>814</b> and the current (M+1)-bit counter value (time stamp) Xi[M:<b>0</b>] of the counter of the triggered system is checked. Then, in step S<b>815</b>, it is checked whether the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) and the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) are identical and the LSB (Xi[<b>0</b>]) is &#x201c;0&#x201d;, or whether the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) and the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) plus 1 are identical and the LSB (Xi[<b>0</b>]) is &#x201c;1&#x201d;. If not, the procedure continues with step S<b>816</b> where an error is determined. Otherwise, if it is determined in step S<b>815</b> that the differences are identical for one of the cases, the procedure jumps back to step S<b>812</b> and the running parameter is incremented again.</p><p id="p-0076" num="0075">If it is determined in step S<b>808</b> that the differences are identical, the procedure continues with step S<b>817</b> where the counter offset &#x25a1; is set to the initial difference (Y<b>0</b>&#x2212;X<b>0</b>[M:<b>1</b>]) between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system and the configurable delay is set to zero. Then, the procedure continues with step S<b>818</b> where the running parameter i is incremented and where it is checked whether the running parameter i has reached its maximum value N. If so, the procedure branches to step S<b>819</b> and a success is determined, i.e., optimum values of area D of <figref idref="DRAWINGS">FIG. <b>5</b></figref> have been set for the counter offset and the configurable delay.</p><p id="p-0077" num="0076">If the running parameter i has not yet reached its maximum value N in step S<b>818</b>, the procedure continues with step S<b>820</b> and the current (M+1)-bit counter value (time stamp) Xi[M:<b>0</b>] of the counter of the triggered system is checked. Then, in step S<b>821</b>, it is checked whether the difference between the collected related M-bit counter value Yi of the counter of the triggering system and the current M-bit counter value Xi of the counter of the triggered system (without consideration of the LSB) and the initial difference between the collected initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the counter of the triggered system (without consideration of the LSB) are identical. If not, the procedure continues with step S<b>822</b> where an error is determined. Otherwise, if it is determined in step S<b>821</b> that the differences are identical the procedure jumps back to step S<b>818</b> and the running parameter is incremented again.</p><p id="p-0078" num="0077">Thus, in sample embodiments according to the procedures of <figref idref="DRAWINGS">FIGS. <b>7</b> and <b>8</b></figref>, the binary value of the LSB of an initially recorded (M+1)-bit counter value of the counter of the triggered system is used for a preliminary setting of the counter offset &#x25a1; at the triggered system to either the initial difference between the initial M-bit counter value Y<b>0</b> of the counter of the triggering system and the initial M-bit counter value X<b>0</b> of the triggered system (if LSB=1) or the initial difference plus 1 (if LSB=0) and for a preliminary setting of the configurable delay at the triggered system to either 0.25 CLK_IN (if LSB=1, which corresponds to area C) or 0.75 CLK_IN (if LSB=0, which corresponds to area A). These preliminary settings are maintained if the difference between a predetermined number N of succeeding related collected counter values Yi and recorded counter values Xi of both systems stays identical to the initial difference between the initial counter values Y<b>0</b> and X<b>0</b>.</p><p id="p-0079" num="0078">However, if it is determined that the binary value of the LSB of one of the predetermined number N of succeeding recorded counter values Xi has changed, then the preliminary setting of the configurable delay at the triggered system is set to either zero (if the above differences are identical, which corresponds to area D) or 0.5 CLK_IN (if the above differences differ by 1, which corresponds to area B). Furthermore, the counter offset &#x25a1; at the triggered system may then be set to the above initial difference plus 1 if the LSB has changed to &#x201c;1&#x201d;.</p><p id="p-0080" num="0079">It is noted that optimal performance can be achieved if all four regions A to D are equal in size (i.e. 0.25 CLK_IN cycle). This will lead to a synchronization accuracy of one eighth of a cycle period of the clock signal CLK_IN (i.e. &#x2212;/+(CLK_IN cycle)/<b>8</b>).</p><p id="p-0081" num="0080">In example cases, the setup and hold times may be very small, thus making regions B and D negligible in comparison to regions A and C. This scenario will then lead to a synchronization accuracy of one quarter of a cycle period of the clock signal CLK_IN (i.e. &#x2212;/+(CLK_IN cycle)/4).</p><p id="p-0082" num="0081">Therefore, the above procedure for determining the offset and configurable delay of the counter of the triggered system may take advantage of the indeterminism of the synchronizing circuit in order to increase the overall accuracy.</p><p id="p-0083" num="0082">In examples, the counter offset adjustment may be used separately for rough compensation with an accuracy of <b>1</b> clock cycle, while the adjustment of configurable delay may be used for fine compensation with an accuracy below one clock cycle, e.g., between one eighth and one quarter of a clock cycle.</p><p id="p-0084" num="0083">For verification that the synchronization process was successful, the system may re-run the procedure while switching the roles of the triggering system (e.g. system A) and the triggered system (e.g. system B, so that system B is now triggering and system A is triggered) and verifying that the calculated offset is zero. As another option, verification could be achieved by having both systems drive a signal when they reach a specific counter value and then measuring the time difference between the two signals e.g. using a testing equipment.</p><p id="p-0085" num="0084">The processing steps or operations of the procedures of <figref idref="DRAWINGS">FIGS. <b>6</b>, <b>7</b> and <b>8</b></figref> may be implemented by software routines used for controlling the control circuit of the triggered system (e.g. the control circuit <b>25</b> of <figref idref="DRAWINGS">FIG. <b>4</b></figref>) or by hardware circuits or a digital signal processor (DSP) or an application specific integrated circuit (ASIC) or a programmable logic device (PLD) or a programmable gate array (PGA) or the like.</p><p id="p-0086" num="0085">A Matlab simulation was performed which simulated the two systems. The simulation covered both the synchronization procedure (i.e. the physical connection between the two systems, the pulse train, the recording of the logger circuit, etc . . . ) and the procedure of <figref idref="DRAWINGS">FIGS. <b>7</b> and <b>8</b></figref> that determines the optimal offset and configurable delay in order to synchronize the two systems with enhanced accuracy. The simulation was done <b>1000</b> times, each with a random phase shift between the clock signals CLK_IN of the triggering system (system A) and the triggered system (system B). The frequency of the clock signal CLK_IN was set to 20 MHz, the initial offset between the counter of the triggering system and the counter of the triggered system was set to 1000, the number of pulses in pulse train of the trigger signal was set to 8 (i.e. 16 edges), and the frequency of the fast clock at the output of the PLL circuit as set to 150 MHz. This parameter value determine the resolution in which the procedure can set the configurable delay.</p><p id="p-0087" num="0086">The below graphs in <figref idref="DRAWINGS">FIGS. <b>9</b> and <b>10</b></figref> show respective histograms of the resulted inaccuracy between the two counters, after the synchronization procedure was performed, in units of ns.</p><p id="p-0088" num="0087"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a diagram of an example of a histogram of resulting inaccuracies between two systems after synchronization with longer hold and setup times equal to 6 ns, so that regions A, B, C and D of <figref idref="DRAWINGS">FIG. <b>5</b></figref> are roughly equal in size. As can be gathered from <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the inaccuracy is roughly &#x2212;/+6 ns, which is equal to one eighth of the cycle period of the clock signal CLK_IN (i.e. &#x2212;/+(CLK_IN cycle)/8).</p><p id="p-0089" num="0088"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a diagram of an example of a histogram of resulting inaccuracies between two systems after synchronization with a shorter hold and setup times equal to only lns, so that regions A and C are much bigger than regions B and D. As can be gathered from <figref idref="DRAWINGS">FIG. <b>10</b></figref>, the inaccuracy is a little less than &#x2212;/+12 ns, which is equal to one quarter of the cycle period of the clock signal CLK_IN (i.e. &#x2212;/+(CLK_IN cycle)/4).</p><p id="p-0090" num="0089">This disclosure has presented example embodiments of an apparatus and a procedure for synchronizing the time bases of two systems with higher accuracy of less than one clock cycle period, wherein a triggered system is synchronized to a triggering system by tracking the timing of rising and falling edges of a clock signal at the triggered system and using the tracked timing values for phase shift adjustment of the time base at the triggered systems.</p><p id="p-0091" num="0090">More generally, according to one aspect disclosed herein, there is provided an apparatus for synchronizing a synchronization signal to an input trigger signal, the apparatus comprising:</p><p id="p-0092" num="0091">a logger circuit for sampling and recording values of a counter in response to a detection of rising and/or falling edges of the input trigger signal, wherein the sampling is performed at rising and falling edges of a common clock signal supplied to the counter; and</p><p id="p-0093" num="0092">a control circuit for reading the recorded values and calculating at least one of an offset and a configurable delay of the counter based on the recorded values.</p><p id="p-0094" num="0093">In embodiments, the apparatus may further comprise a synchronizing circuit, wherein the logger circuit and the synchronizing circuit are configured to become active at the rising and falling edges of the common clock signal.</p><p id="p-0095" num="0094">In embodiments, the apparatus may further comprise a configurable delay circuit configured to add the configurable delay to the common clock signal before it is supplied to the counter, or to the output of the counter, or to a trigger output generated based on the output of the counter.</p><p id="p-0096" num="0095">In embodiments, the configurable delay circuit may be controlled by a fast clock signal with a clock frequency higher than that of the common clock signal. In examples, the fast clock signal may be generated on the basis of the common clock signal.</p><p id="p-0097" num="0096">In embodiments, the control circuit may be configured to collect predefined counter values which correspond to the rising and/or falling edges of the input trigger signal and to calculate the at least one of the offset and the configurable delay of the counter based on a comparison of the recorded values with the collected predefined counter values.</p><p id="p-0098" num="0097">In embodiments, the recorded values may have one more bit than the collected counter values, and wherein this one more bit is used to indicate whether the recorded value is an integer or a non-integer value depending on whether it is sampled at a rising edge or a falling edge of the clock signal.</p><p id="p-0099" num="0098">In embodiments, the control circuit may be configured to use the binary value of a least significant bit, LSB, of an initial one of the recorded values for a preliminary setting of the offset of the counter to either an initial difference between an initial one of the collected counter values and an one of the recorded values if the LSB indicates a non-integer value, or the initial difference plus 1 if the LSB indicates an integer value.</p><p id="p-0100" num="0099">In embodiments, the control circuit may be configured to use the binary value of the LSB of the initial one of the recorded values for a preliminary setting of the configurable delay to either one quarter of a clock cycle of the common clock signal if the LSB indicates a non-integer value, or three quarters of the clock cycle of the common clock signal if the LSB indicates an integer value.</p><p id="p-0101" num="0100">In embodiments, the control circuit may be configured to maintain the preliminary setting if respective differences between a predetermined number of succeeding related collected counter values and recorded values stay identical to the initial difference.</p><p id="p-0102" num="0101">In embodiments, if the control circuit determines that the binary value of the LSB of one of the predetermined number N of succeeding recorded values has changed, the control unit may be configured to set the preliminary setting of the configurable delay to either zero if the respective difference and the initial difference are identical, or one half of the clock cycle of the common clock signal if the respective difference and the initial difference differ by 1.</p><p id="p-0103" num="0102">In embodiments, the control circuit may be configured to set the offset of the counter to the initial difference plus 1 if the LSB has changed to indicate a non-integer value.</p><p id="p-0104" num="0103">According to another aspect disclosed herein, there is provided a method of synchronizing a synchronization signal to an input trigger signal, the method comprising:</p><p id="p-0105" num="0104">sampling and recording values of a counter in response to a detection of rising and/or falling edges of the input trigger signal, wherein the sampling is performed at rising and falling edges of a common clock signal supplied to the counter; and</p><p id="p-0106" num="0105">calculating at least one of an offset and a configurable delay of the counter based on the recorded values</p><p id="p-0107" num="0106">In embodiments, the method may further comprise adding the configurable delay to the common clock signal before it is supplied to the counter, or to the output of the counter, or to a trigger output generated based on the output of the counter</p><p id="p-0108" num="0107">According to another aspect disclosed herein, there is provided a computer program embodied on computer-readable storage and comprising code configured so as when run on one or more processors to perform the method of any embodiment disclosed herein.</p><p id="p-0109" num="0108">Examples and embodiments described herein may be implemented as logical steps in one or more computer systems. The logical operations may be implemented (1) as a sequence of processor-implemented steps executing in one or more computer systems and (2) as interconnected machine or circuit modules within one or more computer systems. The implementation is a matter of choice, dependent on the performance requirements of the computer system used for implementation. Accordingly, logical operations making up examples or embodiments described herein may be referred to variously as operations, steps, objects, or modules. Furthermore, it should be understood that logical operations may be performed in any order, adding and omitting as desired, unless explicitly claimed otherwise or a specific order is inherently necessitated by the claim language.</p><p id="p-0110" num="0109">Other variants and applications of the disclosed techniques may become apparent to a person skilled in the art once given the present disclosure. The scope of the present disclosure is not limited by the above-described embodiments but only by the accompanying claims.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. An apparatus for synchronizing a counter to an input trigger signal, the apparatus comprising:<claim-text>a data acquisition module for sampling and recording values of the counter in response to a detection of rising and/or falling edges of the input trigger signal, wherein the sampling is performed at rising and falling edges of a common clock signal supplied to the counter and the data acquisition module; and</claim-text><claim-text>a control circuit for reading the recorded values and calculating at least one of an offset and a configurable delay of the counter based on the recorded values and predetermined collected values.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a synchronizing circuit, wherein the data acquisition module and the synchronizing circuit are configured to become active at the rising and falling edges of the common clock signal.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a configurable delay circuit configured to add the configurable delay to the common clock signal before it is supplied to the counter, or to the output of the counter, or to a trigger output generated based on the output of the counter.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The apparatus of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the configurable delay circuit is controlled by a fast clock signal with a clock frequency higher than that of the common clock signal.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The apparatus of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the fast clock signal is generated on the basis of the common clock signal.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the control circuit is configured to obtain the predetermined collected values by collecting predefined counter values which correspond to the rising and/or falling edges of the input trigger signal and to calculate the at least one of the offset and the configurable delay of the counter based on a comparison of the recorded values with the collected predefined counter values.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The apparatus of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the recorded values have one more bit than the collected counter values, and wherein this one more bit is used to indicate whether the recorded value is an integer or a non-integer value depending on whether it is sampled at a rising edge or a falling edge of the clock signal.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The apparatus of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the control circuit is configured to use the binary value of a least significant bit, LSB, of an initial one of the recorded values for a preliminary setting of the offset of the counter to either an initial difference between an initial one of the collected counter values and an one of the recorded values if the LSB indicates a non-integer value, or the initial difference plus 1 if the LSB indicates an integer value.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the control circuit is configured to use the binary value of the LSB of the initial one of the recorded values for a preliminary setting of the configurable delay to either one quarter of a clock cycle of the common clock signal if the LSB indicates a non-integer value, or three quarters of the clock cycle of the common clock signal if the LSB indicates an integer value.</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the control circuit is configured to maintain the preliminary setting if respective differences between a predetermined number of succeeding related collected counter values and recorded values stay identical to the initial difference.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The apparatus of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein if the control circuit determines that the binary value of the LSB of one of the predetermined number N of succeeding recorded values has changed, the control unit is configured to set the preliminary setting of the configurable delay to either zero if the respective difference and the initial difference are identical, or one half of the clock cycle of the common clock signal if the respective difference and the initial difference differ by 1.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The apparatus according of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the control circuit is configured to set the offset of the counter to the initial difference plus 1 if the LSB has changed to indicate a non-integer value.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. A method of synchronizing a counter to an input trigger signal, the method comprising:<claim-text>sampling and recording values of a counter in response to a detection of rising and/or falling edges of the input trigger signal, wherein the sampling is performed at rising and falling edges of a common clock signal supplied to the counter; and</claim-text><claim-text>calculating at least one of an offset and a configurable delay of the counter based on the recorded values and predetermined collected values.</claim-text></claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, further comprising adding the configurable delay to the common clock signal before it is supplied to the counter, or to the output of the counter, or to a trigger output generated based on the output of the counter.</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. A computer program embodied on computer-readable storage and comprising code configured so as when run on one or more processors to perform the method of synchronizing a counter to an input trigger signal:<claim-text>sampling and recording values of a counter in response to a detection of rising and/or falling edges of the input trigger signal, wherein the sampling is performed at rising and falling edges of a common clock signal supplied to the counter; and</claim-text><claim-text>calculating at least one of an offset and a configurable delay of the counter based on the recorded values and predetermined collected values.</claim-text></claim-text></claim></claims></us-patent-application>