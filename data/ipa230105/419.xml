<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230000420A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221220" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230000420</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17940772</doc-number><date>20220908</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>A</section><class>61</class><subclass>B</subclass><main-group>5</main-group><subgroup>349</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>A</section><class>61</class><subclass>B</subclass><main-group>5</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>B</subclass><main-group>5</main-group><subgroup>349</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>B</subclass><main-group>5</main-group><subgroup>4803</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>B</subclass><main-group>5</main-group><subgroup>6817</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>B</subclass><main-group>5</main-group><subgroup>725</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>B</subclass><main-group>2562</main-group><subgroup>0219</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">ON-EAR DETECTION</invention-title><us-related-documents><continuation><relation><parent-doc><document-id><country>US</country><doc-number>17094867</doc-number><date>20201111</date></document-id><parent-status>PENDING</parent-status></parent-doc><child-doc><document-id><country>US</country><doc-number>17940772</doc-number></document-id></child-doc></relation></continuation><us-provisional-application><document-id><country>US</country><doc-number>62949630</doc-number><date>20191218</date></document-id></us-provisional-application></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Cirrus Logic International Semiconductor Ltd.</orgname><address><city>Edinburgh</city><country>GB</country></address></addressbook><residence><country>GB</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>LESSO</last-name><first-name>John P.</first-name><address><city>Edinburgh</city><country>GB</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>Cirrus Logic International Semiconductor Ltd.</orgname><role>03</role><address><city>Edinburgh</city><country>GB</country></address></addressbook></assignee></assignees></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A sensor on an earpiece is used to attempt to detect a signal corresponding to a heartbeat. If a heartbeat is detected, it can be determined that the earpiece is being worn by a user. The sensor may be an acoustic transducer on a surface of the earpiece that is located within the wearer's ear canal, while the earpiece is being worn normally.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="38.27mm" wi="158.75mm" file="US20230000420A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="210.23mm" wi="114.38mm" file="US20230000420A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="204.64mm" wi="130.13mm" file="US20230000420A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="235.80mm" wi="76.88mm" orientation="landscape" file="US20230000420A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="157.40mm" wi="155.53mm" file="US20230000420A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="134.11mm" wi="147.40mm" file="US20230000420A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="143.43mm" wi="141.65mm" file="US20230000420A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">TECHNICAL FIELD</heading><p id="p-0002" num="0001">This relates to an earphone system, and in particular to a system that allows for detection of when an earphone is within a user's ear.</p><heading id="h-0002" level="1">BACKGROUND</heading><p id="p-0003" num="0002">Many electronic devices include earphones, and it is known to be advantageous to detect when the earphones are being worn, that is, when the earphones are on or in the ears of a user. When it is determined that an earphone is not being worn, steps can be taken to reduce power consumption, for example by suspending playback of audio signals through the earphone or powering down an output amplifier connected to a loudspeaker of the earphone.</p><p id="p-0004" num="0003">Many systems for on-ear detection require additional components to be provided in the earphone, thereby adding to the cost and complexity of the device.</p><p id="p-0005" num="0004">As another example, an acoustic on-ear detector may be provided in an earphone that includes two microphones, with one of the microphones facing into the user's ear canal when the earphone is being worn normally, and the other microphone facing outwardly for detecting ambient sounds. This system compares the sounds detected by the two microphones. However, this means that, when the user is not speaking, or when the earphone is not being used to play sounds that the user is listening to, the on-ear detection still requires sounds (typically infrasonic or ultrasonic tones that will not be heard by the user) to be played through the loudspeaker of the earphone. This in turn requires the loudspeaker driver amplifier to be powered up, and this has a significant power consumption.</p><heading id="h-0003" level="1">SUMMARY</heading><p id="p-0006" num="0005">According to a first aspect of the present invention, there is provided a method of detecting whether an earpiece is being worn by a user, the method comprising:<ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0000">    <ul id="ul0002" list-style="none">        <li id="ul0002-0001" num="0006">using at least one sensor on the earpiece to detect a heartbeat; and</li>        <li id="ul0002-0002" num="0007">if a heartbeat is detected, determining that the earpiece is being worn by a user.</li>    </ul>    </li></ul></p><p id="p-0007" num="0008">The method may further comprise:<ul id="ul0003" list-style="none">    <li id="ul0003-0001" num="0000">    <ul id="ul0004" list-style="none">        <li id="ul0004-0001" num="0009">if no heartbeat is detected, determining that the earpiece is not being worn by a user; and</li>        <li id="ul0004-0002" num="0010">determining that a speech signal detected by a microphone on the earpiece may not come from a live speaker.</li>    </ul>    </li></ul></p><p id="p-0008" num="0011">The method may further comprise:<ul id="ul0005" list-style="none">    <li id="ul0005-0001" num="0000">    <ul id="ul0006" list-style="none">        <li id="ul0006-0001" num="0012">if no heartbeat is detected, determining that the earpiece is not being worn by a user; and</li>        <li id="ul0006-0002" num="0013">powering down an output amplifier connected to a loudspeaker of the earpiece.</li>    </ul>    </li></ul></p><p id="p-0009" num="0014">The method may further comprise:<ul id="ul0007" list-style="none">    <li id="ul0007-0001" num="0000">    <ul id="ul0008" list-style="none">        <li id="ul0008-0001" num="0015">if no heartbeat is detected, determining that the earpiece is not being worn by a user; and</li>        <li id="ul0008-0002" num="0016">suspending playback of audio signals through the earpiece.</li>    </ul>    </li></ul></p><p id="p-0010" num="0017">The step of using at least one sensor on the earpiece to detect a heartbeat may comprise using an accelerometer on the earpiece to detect vibrations indicative of a heartbeat.</p><p id="p-0011" num="0018">The step of using at least one sensor on the earpiece to detect a heartbeat may comprise using a contact microphone on the earpiece to detect vibrations indicative of a heartbeat.</p><p id="p-0012" num="0019">The step of using at least one sensor on the earpiece to detect a heartbeat may comprise detecting electrical signals associated with a heartbeat.</p><p id="p-0013" num="0020">The step of using at least one sensor on the earpiece to detect a heartbeat may comprise using an optical sensor to obtain a photoplethysmogram.</p><p id="p-0014" num="0021">The step of using at least one sensor on the earpiece to detect a heartbeat may comprise using an inertial measurement unit configured to detect movement in an ear canal of the user if the earpiece is being worn by the user.</p><p id="p-0015" num="0022">The step of using at least one sensor on the earpiece to detect a heartbeat may comprise using at least one audio transducer to obtain a signal representing sound in the vicinity of the earpiece. The at least one audio transducer may comprise a microphone on the earpiece, or may comprise a loudspeaker on the earpiece.</p><p id="p-0016" num="0023">The method may further comprise:<ul id="ul0009" list-style="none">    <li id="ul0009-0001" num="0000">    <ul id="ul0010" list-style="none">        <li id="ul0010-0001" num="0024">applying said signal representing sound in the vicinity of the earpiece to an analog-digital converter, wherein the analog-digital converter is switched on only when detecting whether the earpiece is being worn by a user.</li>    </ul>    </li></ul></p><p id="p-0017" num="0025">The method may comprise:<ul id="ul0011" list-style="none">    <li id="ul0011-0001" num="0000">    <ul id="ul0012" list-style="none">        <li id="ul0012-0001" num="0026">using a first audio transducer to generate a first audio signal, wherein the first audio transducer is positioned on the earpiece so as to detect sounds in an ear canal of a user, when the earpiece is being worn normally;</li>        <li id="ul0012-0002" num="0027">using a second audio transducer to generate a second audio signal, wherein the second audio transducer is positioned on the earpiece so as to detect sounds outside an ear of a user, when the earpiece is being worn normally;</li>        <li id="ul0012-0003" num="0028">applying the second audio signal to an adaptive filter to generate a filtered second audio signal, wherein the adaptive filter is configured to represent a transfer function experienced by sound travelling from outside the ear of a user to inside the ear canal of the user; and</li>        <li id="ul0012-0004" num="0029">subtracting the filtered second audio signal from the first audio signal to generate said signal representing sound in the vicinity of the earpiece.</li>    </ul>    </li></ul></p><p id="p-0018" num="0030">The method may further comprise:<ul id="ul0013" list-style="none">    <li id="ul0013-0001" num="0000">    <ul id="ul0014" list-style="none">        <li id="ul0014-0001" num="0031">applying the signal representing sound in the vicinity of the earpiece to a first input of a subtractor;</li>        <li id="ul0014-0002" num="0032">applying a signal to be applied to a loudspeaker in the earpiece to an adaptive filter to generate a filtered signal; and</li>        <li id="ul0014-0003" num="0033">applying the filtered signal to a second input of the subtractor,</li>        <li id="ul0014-0004" num="0034">wherein the adaptive filter is adapted to reproduce an effect of applying the signal to the loudspeaker and detecting the resulting sound using said at least one audio transducer, such that an effect of the signal to be applied to the loudspeaker is minimised in an output of the subtractor.</li>    </ul>    </li></ul></p><p id="p-0019" num="0035">The step of using at least one sensor on the earpiece to detect a heartbeat may comprise:<ul id="ul0015" list-style="none">    <li id="ul0015-0001" num="0000">    <ul id="ul0016" list-style="none">        <li id="ul0016-0001" num="0036">receiving a signal from the sensor;</li>        <li id="ul0016-0002" num="0037">obtaining samples of the received signal;</li>        <li id="ul0016-0003" num="0038">calculating an autocorrelation using the samples of the received signal;</li>        <li id="ul0016-0004" num="0039">detecting the heartbeat from at least one peak in the calculated autocorrelation.</li>    </ul>    </li></ul></p><p id="p-0020" num="0040">The method may comprise obtaining said samples of the received signal at a sample rate below 1 kHz.</p><p id="p-0021" num="0041">The method may comprise receiving the signal in digital form with a sample rate higher than 1 kHz, and downsampling the received signal to a sample rate below 1 kHz.</p><p id="p-0022" num="0042">The step of detecting the heartbeat from at least one peak in the calculated autocorrelation may comprises:<ul id="ul0017" list-style="none">    <li id="ul0017-0001" num="0000">    <ul id="ul0018" list-style="none">        <li id="ul0018-0001" num="0043">ignoring peaks that correspond to frequencies below a range of likely human heart rates; and</li>        <li id="ul0018-0002" num="0044">ignoring peaks having a height below a threshold height.</li>    </ul>    </li></ul></p><p id="p-0023" num="0045">The step of using at least one sensor on the earpiece to detect a heartbeat may comprise:<ul id="ul0019" list-style="none">    <li id="ul0019-0001" num="0000">    <ul id="ul0020" list-style="none">        <li id="ul0020-0001" num="0046">receiving a signal from the sensor; and</li>        <li id="ul0020-0002" num="0047">determining whether said signal contains a component at a frequency consistent with a heartbeat, for example in the region of 0.75 Hz-3 Hz.</li>    </ul>    </li></ul></p><p id="p-0024" num="0048">Determining whether said signal contains a component at a frequency consistent with a heartbeat may comprise:<ul id="ul0021" list-style="none">    <li id="ul0021-0001" num="0000">    <ul id="ul0022" list-style="none">        <li id="ul0022-0001" num="0049">band-pass filtering the signal to pass components of the signal in a frequency range consistent with a heartbeat, and</li>        <li id="ul0022-0002" num="0050">detecting a peak component of the band-pass filtered signal.</li>    </ul>    </li></ul></p><p id="p-0025" num="0051">Determining whether said signal contains a component at a frequency consistent with a heartbeat may comprise:<ul id="ul0023" list-style="none">    <li id="ul0023-0001" num="0000">    <ul id="ul0024" list-style="none">        <li id="ul0024-0001" num="0052">applying said signal to a Kalman Filter.</li>    </ul>    </li></ul></p><p id="p-0026" num="0053">Determining whether said signal contains a component at a frequency consistent with a heartbeat may comprise:<ul id="ul0025" list-style="none">    <li id="ul0025-0001" num="0000">    <ul id="ul0026" list-style="none">        <li id="ul0026-0001" num="0054">applying said signal to a phase locked loop, and determining a frequency at which the loop is locked.</li>    </ul>    </li></ul></p><p id="p-0027" num="0055">The step of using at least one sensor on the earpiece to detect a heartbeat may comprise:<ul id="ul0027" list-style="none">    <li id="ul0027-0001" num="0000">    <ul id="ul0028" list-style="none">        <li id="ul0028-0001" num="0056">receiving a signal from the sensor; and</li>        <li id="ul0028-0002" num="0057">applying said signal to a neural network that has been trained to recognise signals representing heartbeats.</li>    </ul>    </li></ul></p><p id="p-0028" num="0058">The method may comprise:<ul id="ul0029" list-style="none">    <li id="ul0029-0001" num="0000">    <ul id="ul0030" list-style="none">        <li id="ul0030-0001" num="0059">using at least one first sensor on the earpiece to detect a heartbeat; and</li>        <li id="ul0030-0002" num="0060">if a heartbeat is detected, making a preliminary determination that the earpiece is being worn by a user, and activating at least one second sensor on the earpiece;</li>        <li id="ul0030-0003" num="0061">using the at least one second sensor on the earpiece to detect a heartbeat; and</li>        <li id="ul0030-0004" num="0062">if a heartbeat is detected, determining that the earpiece is being worn by a user.</li>    </ul>    </li></ul></p><p id="p-0029" num="0063">The method may comprise:<ul id="ul0031" list-style="none">    <li id="ul0031-0001" num="0000">    <ul id="ul0032" list-style="none">        <li id="ul0032-0001" num="0064">receiving a first signal from at least one first sensor on the earpiece, wherein the at least one first sensor is positioned on the earpiece such that it is able to detect a heartbeat, when the earpiece is being worn in an expected way;</li>        <li id="ul0032-0002" num="0065">determining whether the first signal comprises features characteristic of a heartbeat;</li>        <li id="ul0032-0003" num="0066">receiving a second signal from at least one second sensor on the earpiece, wherein the at least one second sensor is positioned on the earpiece such that it is not able to detect a heartbeat, when the earpiece is being worn in the expected way;</li>        <li id="ul0032-0004" num="0067">determining whether the second signal comprises features characteristic of a heartbeat;</li>        <li id="ul0032-0005" num="0068">and</li>        <li id="ul0032-0006" num="0069">if it is determined that the first signal comprises features characteristic of a heartbeat and that the second signal comprises features characteristic of a heartbeat, determining that the earpiece is not being worn in the expected way; or</li>        <li id="ul0032-0007" num="0070">if it is determined that the first signal comprises features characteristic of a heartbeat and that the second signal does not comprise features characteristic of a heartbeat, determining that the earpiece is being worn in the expected way.</li>    </ul>    </li></ul></p><p id="p-0030" num="0071">According to another aspect of the present invention, there is provided a system configured for performing a method according to the first aspect.</p><p id="p-0031" num="0072">According to another aspect of the present invention, there is provided a system comprising a processor, wherein the processor is configured for performing a method according to the first aspect.</p><p id="p-0032" num="0073">According to another aspect of the present invention, there is provided a computer program product, comprising a tangible and/or non-volatile computer readable medium, comprising computer readable instructions for causing a processor to perform a method according to the first aspect and the second aspect.</p><p id="p-0033" num="0074">According to a second aspect of the present invention, there is provided a method of biometric authentication, comprising:<ul id="ul0033" list-style="none">    <li id="ul0033-0001" num="0000">    <ul id="ul0034" list-style="none">        <li id="ul0034-0001" num="0075">using at least one sensor on an earpiece to detect a heartbeat of a person wearing the earpiece;</li>        <li id="ul0034-0002" num="0076">obtaining information about properties of the detected heartbeat; and</li>        <li id="ul0034-0003" num="0077">using the information about the properties of the detected heartbeat as a biometric identifier.</li>    </ul>    </li></ul></p><p id="p-0034" num="0078">The step of using at least one sensor on the earpiece to detect a heartbeat may comprise:<ul id="ul0035" list-style="none">    <li id="ul0035-0001" num="0000">    <ul id="ul0036" list-style="none">        <li id="ul0036-0001" num="0079">using at least one audio transducer to obtain a signal representing a sound, the method further comprising obtaining information about properties of the detected heartbeat from the signal representing the sound.</li>    </ul>    </li></ul></p><p id="p-0035" num="0080">The at least one audio transducer may comprise a loudspeaker on the earpiece.</p><p id="p-0036" num="0081">Said properties of the detected heartbeat may comprise timing properties, and/or may comprise amplitude properties.</p><p id="p-0037" num="0082">The step of using at least one sensor on the earpiece to detect a heartbeat may comprise:<ul id="ul0037" list-style="none">    <li id="ul0037-0001" num="0000">    <ul id="ul0038" list-style="none">        <li id="ul0038-0001" num="0083">receiving a signal from the sensor;</li>        <li id="ul0038-0002" num="0084">obtaining samples of the received signal;</li>        <li id="ul0038-0003" num="0085">calculating an autocorrelation using the samples of the received signal;</li>        <li id="ul0038-0004" num="0086">estimating a heart rate of the person wearing the earpiece from at least one peak in the calculated autocorrelation.</li>    </ul>    </li></ul></p><p id="p-0038" num="0087">The method may comprise:<ul id="ul0039" list-style="none">    <li id="ul0039-0001" num="0000">    <ul id="ul0040" list-style="none">        <li id="ul0040-0001" num="0088">using at least one first sensor on the earpiece to detect a heartbeat; and</li>        <li id="ul0040-0002" num="0089">if a heartbeat is detected, making a preliminary determination that the earpiece is being worn by a user, and activating at least one second sensor on the earpiece; and</li>        <li id="ul0040-0003" num="0090">obtaining said information about properties of the detected heartbeat using the at least one second sensor.</li>    </ul>    </li></ul></p><p id="p-0039" num="0091">According to a further aspect of the present invention, there is provided a system configured for performing a method according to the second aspect.</p><p id="p-0040" num="0092">According to a further aspect of the present invention, there is provided a system comprising a processor, wherein the processor is configured for performing a method according to the second aspect.</p><p id="p-0041" num="0093">According to a further aspect of the present invention, there is provided a computer program product, comprising a tangible and/or non-volatile computer readable medium, comprising computer readable instructions for causing a processor to perform a method according to the second aspect.</p><p id="p-0042" num="0094">According to a third aspect of the present invention, there is provided a method of operation of an earphone, the method comprising:<ul id="ul0041" list-style="none">    <li id="ul0041-0001" num="0000">    <ul id="ul0042" list-style="none">        <li id="ul0042-0001" num="0095">using at least one sensor on the earpiece to generate a sensor signal;</li>        <li id="ul0042-0002" num="0096">using the sensor signal to detect a heartbeat; and</li>        <li id="ul0042-0003" num="0097">if a heartbeat is detected, determining that the earpiece is being worn by a user; and</li>        <li id="ul0042-0004" num="0098">determining a heart rate of the user;</li>        <li id="ul0042-0005" num="0099">obtaining information about properties of the detected heartbeat; and</li>        <li id="ul0042-0006" num="0100">using the information about the timing properties of the detected heartbeat as a biometric identifier of the user.</li>    </ul>    </li></ul></p><p id="p-0043" num="0101">According to a further aspect of the present invention, there is provided a system configured for performing a method according to the third aspect.</p><p id="p-0044" num="0102">According to a further aspect of the present invention, there is provided a system comprising a processor, wherein the processor is configured for performing a method according to the third aspect.</p><p id="p-0045" num="0103">According to a further aspect of the present invention, there is provided a computer program product, comprising a tangible and/or non-volatile computer readable medium, comprising computer readable instructions for causing a processor to perform a method according to the third aspect.</p><p id="p-0046" num="0104">According to a fourth aspect of the present invention, there is provided a method of detecting whether an earphone is being worn by a user, the method comprising, while playing sounds through a loudspeaker in the earphone:<ul id="ul0043" list-style="none">    <li id="ul0043-0001" num="0000">    <ul id="ul0044" list-style="none">        <li id="ul0044-0001" num="0105">using at least one sensor on the earphone to detect a heartbeat; and</li>        <li id="ul0044-0002" num="0106">if no heartbeat is detected, determining that the earphone is not being worn by a user, and pausing playing said sounds through said loudspeaker.</li>    </ul>    </li></ul></p><p id="p-0047" num="0107">The method may further comprise:<ul id="ul0045" list-style="none">    <li id="ul0045-0001" num="0000">    <ul id="ul0046" list-style="none">        <li id="ul0046-0001" num="0108">if no heartbeat is detected for a predetermined period of time, powering down a driver amplifier connected to supply signals to said loudspeaker.</li>    </ul>    </li></ul></p><p id="p-0048" num="0109">According to a further aspect of the present invention, there is provided a system configured for performing a method according to the fourth aspect.</p><p id="p-0049" num="0110">According to a further aspect of the present invention, there is provided a system comprising a processor, wherein the processor is configured for performing a method according to the fourth aspect.</p><p id="p-0050" num="0111">According to a further aspect of the present invention, there is provided a computer program product, comprising a tangible and/or non-volatile computer readable medium, comprising computer readable instructions for causing a processor to perform a method according to the fourth aspect.</p><p id="p-0051" num="0112">In some embodiments, this has the advantage that it can be determined whether an earpiece is being worn by a user, without requiring any additional components, or without generating any signals specifically for that purpose.</p><p id="p-0052" num="0113">In some embodiments, this has the advantage that it provides an additional method of verifying the identity of a person wearing an earpiece.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0004" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p-0053" num="0114">For a better understanding of the invention, and to show how it may be put into effect, reference will now be made, by way of example, to the accompanying drawings, in which: &#x2014;</p><p id="p-0054" num="0115"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates an earbud in an ear;</p><p id="p-0055" num="0116"><figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates a use of a loudspeaker as a microphone in an earbud as shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>;</p><p id="p-0056" num="0117"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates a form of signal processing applied to a signal obtained from a microphone in an earbud as shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>;</p><p id="p-0057" num="0118"><figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates a second form of signal processing applied to a signal obtained from a microphone in an earbud as shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>;</p><p id="p-0058" num="0119"><figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates a system for further processing of a signal obtained from a microphone in an earbud as shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>;</p><p id="p-0059" num="0120"><figref idref="DRAWINGS">FIG. <b>6</b></figref> illustrates a signal generated by the system of <figref idref="DRAWINGS">FIG. <b>5</b></figref>; and</p><p id="p-0060" num="0121"><figref idref="DRAWINGS">FIG. <b>7</b></figref> illustrates a form of a phonocardiogram;</p><p id="p-0061" num="0122"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a flow chart illustrating a method in accordance with aspects of the disclosure.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0005" level="1">DETAILED DESCRIPTION</heading><p id="p-0062" num="0123">The description below sets forth example embodiments according to this disclosure. Further example embodiments and implementations will be apparent to those having ordinary skill in the art. Further, those having ordinary skill in the art will recognize that various equivalent techniques may be applied in lieu of, or in conjunction with, the embodiments discussed below, and all such equivalents should be deemed as being encompassed by the present disclosure.</p><p id="p-0063" num="0124"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a schematic illustration of an earbud in an ear.</p><p id="p-0064" num="0125">Specifically, <figref idref="DRAWINGS">FIG. <b>1</b></figref> shows a part cross-sectional view through the head <b>10</b> of a person wearing an earbud, or in-ear type earphone, <b>12</b>. A part of the earphone extends into the ear canal <b>14</b> of the wearer, while another part is exposed to the air <b>16</b>.</p><p id="p-0065" num="0126">Aspects of this disclosure relate to detecting whether the earphone is being worn, i.e. is in a person's ear, or whether it is not being worn. Specifically, it has now been recognised that this detection can be performed by detecting a heartbeat using at least one sensor on the earphone.</p><p id="p-0066" num="0127">For example, the detection may comprise using an accelerometer on the earphone to detect vibrations, for example vibrations of the surface of the wearer's ear canal, that are indicative of a heartbeat.</p><p id="p-0067" num="0128">As another example, the detection may comprise using an electrical contact to detect electrical signals in the internal surface of the wearer's ear canal, that are associated with a heartbeat.</p><p id="p-0068" num="0129">As another example, the detection may comprise using an optical sensor on the earphone to obtain a photoplethysmogram that can be used to detect a heartbeat.</p><p id="p-0069" num="0130">As another example, the detection may comprise using an inertial measurement unit configured to detect movement that would be expected in an ear canal of the user if the earphone is being worn.</p><p id="p-0070" num="0131">In embodiments described in more detail below, using at least one sensor on the earphone to detect a heartbeat comprises using at least one audio transducer to obtain a signal representing sound in the vicinity of the earphone.</p><p id="p-0071" num="0132">Thus, the heartbeat can be detected using acoustic means. Since the detection works by passively detecting the heartbeat, it is not necessary to power up a loudspeaker driver amplifier in the earphone, and hence power is saved when the device is not in the ear.</p><p id="p-0072" num="0133">In the simplest case, a transducer that is located within the ear canal of a person wearing the earphone can be used to detect an acoustic signal, and sounds that result from blood flow in the wearer's head can be identified. These sounds result ultimately from the wearer's heartbeat, and so they have a component that depends on the wearer's heart rate. Thus, if the transducer detects an acoustic signal that is characteristic of a heartbeat, it can be assumed that the earphone is being worn by a person. A recording of the sounds made by a heart is referred to as a phonocardiogram.</p><p id="p-0073" num="0134">Thus, in its simplest form, the method of on-ear detection can be performed with a single acoustic transducer.</p><p id="p-0074" num="0135">In the embodiment shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the earphone <b>12</b> includes a first transducer <b>18</b> that is located on or within a surface <b>20</b> of the earphone that extends into the ear canal <b>14</b> of the wearer.</p><p id="p-0075" num="0136">The transducer <b>18</b> may be a microphone. However, it has been recognised that many microphones have poor sensitivity at low frequencies. This is because many microphones are specifically designed to attenuate low frequencies (for example below 100 Hz), in order to improve their robustness to wind noise, and because package noise associated with a microphone typically increases at lower frequencies.</p><p id="p-0076" num="0137">Because a heartbeat has a very low frequency, for example in the region of 1-2 Hz for most of the time, some embodiments use the loudspeaker, that is normally used for playing sounds into the ear of the wearer, as the transducer <b>18</b>. Such a loudspeaker may have better sensitivity at these low frequencies than a typical microphone.</p><p id="p-0077" num="0138">In the embodiment shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the earphone <b>12</b> also includes a second transducer <b>22</b> that is located on or within a surface <b>24</b> of the earphone that is exposed to the air <b>16</b>. The transducer <b>22</b> may for example take the form of a microphone, that is provided on the earphone <b>12</b> for a purpose such as detecting the wearer's speech, or detecting ambient noise so that the noise can be cancelled by noise cancellation circuitry.</p><p id="p-0078" num="0139">As described in more detail below, the use of a second transducer allows for the cancellation of sounds that are detected by the first transducer <b>18</b>, but that result from ambient sounds rather than from sounds originating in the wearer's head.</p><p id="p-0079" num="0140"><figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates a use of a loudspeaker as a microphone in an earbud.</p><p id="p-0080" num="0141">Specifically, <figref idref="DRAWINGS">FIG. <b>2</b></figref> shows a loudspeaker <b>30</b>, to which a signal V<sub>out </sub>is applied when it is desired to play sounds through the loudspeaker. In addition, the loudspeaker <b>30</b> responds to a pressure u that is incident on the diaphragm of the loudspeaker.</p><p id="p-0081" num="0142">The result is that the current I<sub>tail </sub>on the output of the loudspeaker <b>30</b> depends not only on the signal V<sub>out</sub>, but also on the pressure u, that results from the sounds originating in the wearer's head.</p><p id="p-0082" num="0143">The current I<sub>tail </sub>is passed to a sensing block <b>32</b>, and the output thereof is passed to a heartbeat detection (HBD) block <b>34</b>.</p><p id="p-0083" num="0144">The sensing block <b>32</b> may include a small, low bandwidth and low power consumption analog-digital converter (ADC) <b>36</b>, for generating a digital signal corresponding to the current I<sub>tail</sub>. In order to save power, the ADC <b>36</b> may be switched on only when it is desired to use the transducer <b>18</b> to detect the wearer's heartbeat.</p><p id="p-0084" num="0145">The use of the loudspeaker <b>30</b> as the transducer for detecting the sounds, i.e. effectively as a microphone, means that the methods described herein can be used in earphones that do not have a dedicated microphone provided on an inward-facing surface of the earphone.</p><p id="p-0085" num="0146">One issue that arises when detecting sounds to obtain a phonocardiogram in a person's ear canal is that external noise will leak into the ear canal and be detected by the acoustic transducer. This is attenuated to some extent when the person is wearing an earbud, but is particularly relevant for leaky earbuds, which do not provide an airtight seal between the wearer's ear canal and the outside.</p><p id="p-0086" num="0147"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates a form of signal processing applied to a signal obtained from a microphone in an earbud, in order to account for this external noise.</p><p id="p-0087" num="0148"><figref idref="DRAWINGS">FIG. <b>3</b></figref> shows an embodiment based on <figref idref="DRAWINGS">FIG. <b>1</b></figref>, in which there is a first transducer <b>18</b> inside the ear canal and a second transducer <b>22</b> on the outside of the earbud. The second transducer <b>22</b> detects external noise n, and this external noise is subject to a transfer function T of the sound leakage path and the associated acoustic coupling before being detected by the first transducer <b>18</b>. The first transducer also detects the sounds P resulting from the wearer's heartbeat. Thus, the first transducer <b>18</b> generates a first signal S<sub>1 </sub>that is dependent on (P+nT), and the second transducer <b>22</b> generates a second signal S<sub>2 </sub>that is dependent on n.</p><p id="p-0088" num="0149">The second signal S<sub>2 </sub>is applied to an adaptive filter <b>40</b>, with a transfer function m. The first signal S<sub>1 </sub>is applied to a first input of a subtractor <b>42</b>, and the output of the adaptive filter <b>40</b> (that is, n. m) is applied to a second input of the subtractor <b>42</b>, where it is subtracted from the first signal S<sub>1</sub>. The output of the subtractor <b>42</b> is denoted as S<sub>out</sub>.</p><p id="p-0089" num="0150">The output of the subtractor S<sub>out </sub>is used as an error signal to control the transfer function m of the adaptive filter <b>40</b>.</p><p id="p-0090" num="0151">Thus, from the discussion above:</p><p id="p-0091" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i><sub>out</sub>=(<i>P+nT</i>)&#x2212;nm<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0092" num="0152">The sounds P resulting from the wearer's heartbeat are relatively slowly changing, and so it is possible to adapt the transfer function m of the adaptive filter <b>40</b> more quickly than P varies.</p><p id="p-0093" num="0153">Thus, it can be assumed that, during adaptation, P=0, and so, from the equation above:</p><p id="p-0094" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i><sub>out</sub><i>=nT&#x2212;nm </i><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0095" num="0154">The process of adaptation is performed so that the error signal S<sub>out </sub>becomes equal to zero, and so this equation becomes:</p><p id="p-0096" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>nT</i>=nm<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0097" num="0155">and therefore:</p><p id="p-0098" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>m=T </i><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0099" num="0156">After the process of adaptation, as discussed above:</p><p id="p-0100" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i><sub>out</sub>=(<i>P+nt</i>)&#x2212;nm<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0101" num="0157">Because the adaptation has ensured that</p><p id="p-0102" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>m=T </i><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0103" num="0158">this in turn means that:</p><p id="p-0104" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i><sub>out</sub>=(<i>P+nt</i>)&#x2212;<i>nT </i><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0105" num="0159">That is,</p><p id="p-0106" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i><sub>out</sub><i>=P </i><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0107" num="0160">Thus, the adaptation means that the effect of external noise is cancelled, and the output of the subtractor S<sub>out </sub>accurately represents the sounds P resulting from the wearer's heartbeat. This also removes any common mode noise between the two transducers <b>18</b>, <b>22</b>, for example cable noise in wired headsets.</p><p id="p-0108" num="0161">Another issue that arises when detecting sounds to obtain a phonocardiogram in a person's ear canal is that sounds being produced by the loudspeaker in the earbud will interfere with the measurement.</p><p id="p-0109" num="0162"><figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates a second form of signal processing applied to a signal obtained from a microphone in an earbud, in order to account for this.</p><p id="p-0110" num="0163"><figref idref="DRAWINGS">FIG. <b>4</b></figref> shows an embodiment based on <figref idref="DRAWINGS">FIGS. <b>1</b> and <b>2</b></figref>, in which a signal V<sub>out </sub>is applied to the loudspeaker <b>30</b> in order to generate sounds that the wearer of the earbud wants to hear, such as speech or music playback, or a telephone call.</p><p id="p-0111" num="0164">The transducer <b>18</b> inside the ear canal detects not only the sounds P resulting from the wearer's heartbeat, but also a sound d that results from the output of the loudspeaker. The sound d is related to the loudspeaker input signal V<sub>out </sub>by a transfer function R that is associated with the loudspeaker transducer and the ear canal such that:</p><p id="p-0112" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>d=R&#xb7;V</i><sub>out </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0113" num="0165">The signal S<sub>in </sub>that is detected by the transducer <b>18</b> will therefore be a function of (P+R&#xb7;V<sub>out</sub>).</p><p id="p-0114" num="0166">In order to remove the effect of the sound din the signal S<sub>in</sub>, the loudspeaker input signal V<sub>out </sub>is applied to an adaptive filter <b>50</b>, with the output of the adaptive filter <b>50</b> being subtracted in a subtractor <b>52</b> from the transducer output signal S<sub>in</sub>. The transfer function R that is associated with the loudspeaker transducer and the ear canal is variable, and so the transfer function T<sub>A </sub>of the adaptive filter <b>50</b> is adapted as R varies such that the effect of the sound d is removed from the signal S<sub>in</sub>, and hence the output signal of the subtractor <b>52</b> only represents the sounds P resulting from the wearer's heartbeat, assuming that the earphone is being worn at that time.</p><p id="p-0115" num="0167">Returning to <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the output signal generated by the audio transducer is passed to the heartbeat detection (HBD) block <b>34</b> for a determination to be made as to whether the output signal represents sounds that are characteristic of a person's heartbeat, and hence whether it can be determined that the earphone is being worn.</p><p id="p-0116" num="0168">The heartbeat detection may be achieved by serval means. Typically, the fact that a heart rate has a typical range of 60-120 bpm or 1-2 Hz is exploited.</p><p id="p-0117" num="0169">For example, the heartbeat detection may be performed by peak detection of a band-limited signal.</p><p id="p-0118" num="0170">As another example, the heartbeat detection may be performed by Kalman Filter tracking, for example using techniques described in connection with obtaining a heart rate measurement from an electrocardiogram signal in &#x201c;Robust heart rate estimation from multiple asynchronous noisy sources using signal quality indices and a Kalman filter&#x201d;, Li, et al, Physiol Meas. 2008 January; 29(1): 15-32.</p><p id="p-0119" num="0171">As another example, the heartbeat detection may be performed using a phase-locked loop locking to the peaks in the phonocardiogram.</p><p id="p-0120" num="0172">As another example, the detected acoustic signal may be input into a Neural Network that has been trained using (a) inputs that represent heartbeats and (b) inputs that do not represent heartbeats, in order to distinguish whether the input acoustic signal does represent a heartbeat.</p><p id="p-0121" num="0173">As another example, a system using an autocorrelation may be used for heartbeat detection.</p><p id="p-0122" num="0174"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a block diagram, illustrating a system for heartbeat detection using autocorrelation to detect the presence of a signal component at a frequency that is typical of a heart rate. Any of the processing steps described herein may be performed by a suitably programmed processor, for example a digital signal processor (DSP) or a general purpose processor, for example in the earphone device, or in a host device to which the earphone is connected.</p><p id="p-0123" num="0175">Thus, <figref idref="DRAWINGS">FIG. <b>5</b></figref> shows a transducer, which is provided on an earphone, such that it is located in (acoustically coupled to) the ear of a person when they are wearing the earphone. As described above, the transducer may be an acoustic transducer <b>18</b>, for example a microphone, a loudspeaker being used as a microphone, or an inertial measurement unit.</p><p id="p-0124" num="0176">After any initial processing, for example as described with reference to <figref idref="DRAWINGS">FIG. <b>3</b></figref> or <figref idref="DRAWINGS">FIG. <b>4</b></figref> above, the input signal may be passed to an analog-digital converter. If this is a standard analog-digital converter, with a sample rate of, say, 192 kHz, then this sample rate is unnecessarily high, because the important information in a phonocardiogram has a bandwidth of around 500 Hz.</p><p id="p-0125" num="0177">Therefore, this signal may be passed to a downsampler <b>70</b>, which may for example downsample the acoustic signal to a sample rate of 1 kHz.</p><p id="p-0126" num="0178">The downsampled signal may then be passed to a block <b>72</b> where it is split into frames. The length of a frame may for example be at least 1s, and preferably long enough to include 2 cycles of the heartbeat, which may for example be 1.5-2s.</p><p id="p-0127" num="0179">The framed signal may then be denoised in block <b>74</b>, for example using a wavelet.</p><p id="p-0128" num="0180">The resulting signal may be passed to a filter <b>76</b>, for example to remove spurious signal components that are not related to the heartbeat, originating for example from the movement (including the breathing) of the wearer. For example, the signal may be filtered with a high-pass filter having a cut-off frequency of (say) 20 Hz and/or may be filtered with a low-pass filter having a cut-off frequency of (say) 200 Hz. However, this filtering may not be necessary, because the spurious components may be ignored when the autocorrelation is generated.</p><p id="p-0129" num="0181">In the embodiment shown in <figref idref="DRAWINGS">FIG. <b>5</b></figref>, the signal is then passed to an optional envelope extraction block <b>78</b>. For example, this may simply take the absolute value of the signal, though using a Hilbert transform is also possible.</p><p id="p-0130" num="0182">The resulting signal is passed to a normalisation block <b>80</b>, where it is normalised, for example the mean is removed.</p><p id="p-0131" num="0183">The normalised signal is passed to a block <b>82</b> where the autocorrelation Rxx is calculated. In this embodiment, it is only necessary to calculate the autocorrelation value for positive lags. The autocorrelation may then be normalised, for example such that Rxx(0)=1.</p><p id="p-0132" num="0184">In the block <b>84</b>, the autocorrelation is analysed, in order to determine whether the input audio signal contains components characteristic of a heartbeat.</p><p id="p-0133" num="0185"><figref idref="DRAWINGS">FIG. <b>6</b></figref> shows the form of the autocorrelation function <b>100</b> that is generated by the block <b>82</b> in one example. <figref idref="DRAWINGS">FIG. <b>6</b></figref> shows an electrocardiogram (ECG) signal for the purposes of comparison, and also shows the phonocardiogram (PCG). It will be noted that the phonocardiogram is a relatively noisy signal, from which it would be difficult to derive a heart rate value directly. However, <figref idref="DRAWINGS">FIG. <b>6</b></figref> also shows the form of the autocorrelation function <b>100</b> that is generated by the block <b>82</b> from that PCG, and it can be seen that this contains clearer peaks that can be used for determining the heart rate. As mentioned above, the autocorrelation value only needs to be calculated for positive lags, and so the values shown for the negative lags in <figref idref="DRAWINGS">FIG. <b>6</b></figref> are for illustrative purposes only.</p><p id="p-0134" num="0186">In the autocorrelation function that is sent to the analysis block <b>84</b>, the peaks <b>102</b>, <b>104</b>, <b>106</b>, <b>108</b>, <b>110</b>, <b>112</b>, <b>114</b>, <b>116</b>, shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, are present. A minimum delay period dmin is set, corresponding to a very short period and hence to a frequency that is too high to be considered a likely heart rate. Thus, peaks in the autocorrelation that are too close to the delay=0 point are ignored.</p><p id="p-0135" num="0187">In addition, a threshold amplitude of the peaks, for example equal to 0.1, is set, since peaks that are below this amplitude indicate a poor signal, and hence peaks in the autocorrelation that are below this amplitude are ignored.</p><p id="p-0136" num="0188">In the example shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the peaks <b>102</b>, <b>104</b>, <b>106</b>, <b>108</b> corresponding to negative lags are ignored. In addition, because they are within the minimum delay period dmin and/or below the threshold amplitude, the peaks <b>110</b>, <b>112</b> are also ignored.</p><p id="p-0137" num="0189">Thus, only the peaks <b>114</b>, <b>116</b> are considered. These are spaced at integer multiples of 824 samples from the delay=0 point. With a sample rate of 1 kHz, a delay of 824 samples corresponds to a pulse period of 824 ms, and hence a heart rate of 72.77 bpm (&#x2032; 1.213 Hz).</p><p id="p-0138" num="0190">If the earphone is not being worn, the calculated autocorrelation will probably not contain any peaks that correspond to any likely heart rate. Hence, when a calculated autocorrelation does not contain any significant peaks that correspond to any likely heart rate, it can be determined that the earphone is not being worn.</p><p id="p-0139" num="0191">Thus, the autocorrelation can be used to identify signal components characteristic of a heartbeat, and hence can be used to determine that the sounds detected by the transducer include heartbeat sounds, and thus that the earphone is being worn.</p><p id="p-0140" num="0192">Moreover, although one purpose of detecting the heartbeat in this example is to determine whether the earphone is being worn, it will be noted that the autocorrelation produces an accurate measurement for the heart rate of the person wearing the earphone. This can be supplied to any desired application for health-related use, for example for fitness tracking.</p><p id="p-0141" num="0193">The embodiment above uses an autocorrelation technique to detect a heartbeat but, as a further alternative, there may be a two-stage approach, where the input signal is provided to a simple lossy neural network to make a quick initial determination of whether a heartbeat is present, while an autocorrelation is also performed as described above, in order to produce a potentially more accurate result, that requires data to be gathered over a longer time.</p><p id="p-0142" num="0194">If a heartbeat is detected, using a transducer that is located within the ear canal of a person wearing the earphone, then it may be determined that the earphone is being worn by a user. By contrast, if no heartbeat is detected, it may be determined that the earphone is not being worn by a user.</p><p id="p-0143" num="0195">In some embodiments, the process for detecting a heartbeat, as described above, may also be applied to a signal received from another transducer. For example, in the case of the earphone <b>12</b> shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the method may be applied to the signal received from the first transducer <b>18</b> that is located on or within a surface <b>20</b> of the earphone that extends into the ear canal <b>14</b> of the wearer, and may also be applied to the signal received from the second transducer <b>22</b> that is located on or within a surface <b>24</b> of the earphone that is exposed to the air <b>16</b>. In some situations, the transducer that is located within the ear canal of a person wearing the earphone may appear to detect a heartbeat, but the second transducer may also appear to detect a heartbeat.</p><p id="p-0144" num="0196">The second transducer is not located in a position where it would be expected to detect sounds resulting from a heartbeat. Therefore, if both of these signals appear to detect a heartbeat, it can be assumed that this is for some spurious reason, and the detection made by the transducer that is located within the ear canal can be disregarded, and it can be assumed that the earphone is not being worn as intended.</p><p id="p-0145" num="0197">Therefore, if no heartbeat is detected, or it is otherwise determined that the earphone is not being worn, the system may pause the playback of recorded sounds through the earphone. This allows the user to effectively pause playback of recorded sounds simply by removing the earphone, without needing to press a specific &#x201c;pause&#x201d; or &#x201c;stop&#x201d; button. If the absence of a heartbeat persists for a predetermined period of time, the system may power down a loudspeaker driver amplifier in order to save power.</p><p id="p-0146" num="0198">The determination as to whether an earphone is being worn by a user may be used to detect a replay attack on a voice operated system. For example, in the case of a smartphone or other device operating on the basis of voice commands, in particular where speaker recognition is used to determine whether the commands have been spoken by an enrolled user of the system, one attack on such a system is to record the enrolled user's voice, and replay the recording to gain access to the system when the enrolled user is not present.</p><p id="p-0147" num="0199">When such a voice command is detected by a microphone on an earphone (for example the microphone <b>22</b> in the earphone <b>12</b> shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>), a determination can be made as to whether the earphone is being worn by a user. If it is not being worn by a user, there is a possibility that the voice command detected by the microphone is not the voice of a live speaker, but is a recording.</p><p id="p-0148" num="0200">As mentioned above, systems using voice as a biometric are in widespread use.</p><p id="p-0149" num="0201">In a system as described with reference to the embodiments above, at least one sensor on an earphone is used to detect a heartbeat of a person wearing the earphone. According to further embodiments of the present disclosure, information can be obtained about properties of the detected heartbeat. This information about the properties of the detected heartbeat can then be used as a biometric identifier for the person wearing the earphone.</p><p id="p-0150" num="0202">In certain embodiments, the sensor is an acoustic transducer, and more specifically might be a wide-band microphone that is able to generate signals across the useful bandwidth from about 20 Hz-500 Hz. In certain embodiments, a transducer that is able to produce low frequency signals with the required sensitivity (which might be a loudspeaker acting as a microphone as shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>) is used to detect whether the earphone is being worn, because the heartbeat detection only requires a bandwidth of a few Hz. If it is, then a transducer that is able to produce signals across a wider bandwidth may be activated. The transducer that is able to produce signals across a wider bandwidth may take the form of a loudspeaker acting as a microphone, in combination with a conventional microphone.</p><p id="p-0151" num="0203">In certain embodiments, information about the timing properties of the detected heartbeat can be used as a biometric identifier for the person wearing the earphone.</p><p id="p-0152" num="0204">As described above, an acoustic measurement of heart sounds is known as a phonocardiogram (PCG), which has a very different structure to the better-known electrocardiogram (ECG).</p><p id="p-0153" num="0205"><figref idref="DRAWINGS">FIG. <b>7</b></figref> illustrates a form of a phonocardiogram. Specifically, <figref idref="DRAWINGS">FIG. <b>7</b>(<i>a</i>)</figref> shows the form of a phonocardiogram (PCG), and <figref idref="DRAWINGS">FIG. <b>7</b>(<i>b</i>)</figref> shows the form of a corresponding electrocardiogram.</p><p id="p-0154" num="0206">In a healthy heart, there are two key acoustic signatures, namely the first heart sound S1 corresponding to the systole, or contraction of the heart muscles, and the second heart sound S2 corresponding to the diastole, or relaxation of the heart muscles. These sounds represent the blood flow around the heart, but as mentioned above they can be measured in the ear canal.</p><p id="p-0155" num="0207"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a flow chart illustrating a method in accordance with this aspect of the disclosure. Any of the processing steps described herein may be performed by a suitably programmed processor, for example in the earphone device, or in a host device to which the earphone is connected.</p><p id="p-0156" num="0208">Specifically, <figref idref="DRAWINGS">FIG. <b>8</b></figref> shows a method of biometric authentication.</p><p id="p-0157" num="0209">The method comprises, in step <b>130</b>, using at least one sensor on an earpiece to detect a heartbeat of a person wearing the earpiece. As mentioned above, in certain embodiments, the sensor is an acoustic transducer, and more specifically might be a wide-band microphone that is able to generate signals across the useful bandwidth from about 20 Hz-500 Hz.</p><p id="p-0158" num="0210">As described with reference to <figref idref="DRAWINGS">FIG. <b>2</b></figref>, a loudspeaker may be used as a microphone to detect low frequency signals. In order to detect signals across the useful bandwidth from 20 Hz-500 Hz, it may be necessary to detect signals using both a loudspeaker and another transducer, for example a conventional microphone, and to combine the signals generated by the two devices.</p><p id="p-0159" num="0211">In one embodiment, a loudspeaker is used to detect acoustic signals. Because a heartbeat has a very low frequency, the loudspeaker is able to detect the signals that are necessary for the detection of the heartbeat, and hence for determining whether the earpiece is being worn by a user. In this one embodiment, this may be taken as a preliminary determination as to whether the earpiece is being worn.</p><p id="p-0160" num="0212">If it is determined that the earpiece is being worn, then the second transducer can be activated, in order to generate signals at the higher frequencies. The resulting signal can then optionally be used in the more detailed on-ear detection method described with reference to <figref idref="DRAWINGS">FIG. <b>5</b></figref>.</p><p id="p-0161" num="0213">When the second transducer has been activated, this allows the phonocardiogram waveform shown in <figref idref="DRAWINGS">FIG. <b>7</b>(<i>a</i>)</figref> to be determined, and this allows the properties of the heartbeat to be studied in detail, as described below.</p><p id="p-0162" num="0214">In step <b>132</b>, the method comprises obtaining information about properties of the detected heartbeat.</p><p id="p-0163" num="0215">In the case of an ECG, as shown in <figref idref="DRAWINGS">FIG. <b>7</b>(<i>b</i>)</figref>, the discriminative information is contained in the relative timing information between events. <figref idref="DRAWINGS">FIG. <b>7</b>(<i>b</i>)</figref> shows the time intervals between successive R events as rr1, rr2, rr3, etc. The time difference between two events, for example the P event and the T event in any given cycle normalised relative to the period between successive R events, which can either be the period of the last cycle or can be averaged over a number of cycles.</p><p id="p-0164" num="0216">In the case of a phonocardiogram, or PCG, as shown in <figref idref="DRAWINGS">FIG. <b>7</b>(<i>a</i>)</figref>, in general, there are two classes of information, namely time-based and amplitude-based. For both the S1 and S2 events there are onset (alpha), peak (beta) and end (gamma) events. <figref idref="DRAWINGS">FIG. <b>7</b>(<i>a</i>)</figref> shows the time intervals between successive peaks in the S1 event as RR1, RR2, RR3, etc.</p><p id="p-0165" num="0217">In the case of time-based information, the biometric information contained in the PCG is given by the relative timing of events in the PCG. For example, if the timings of the onset, peak, and end for the S1 event are designated T&#x3b1;1, T&#x3b2;1 and T&#x3b3;1 respectively, and the onset, peak, and end for the S2 event are designated T&#x3b1;2, T&#x3b2;2 and T&#x3b3;2 respectively, then useful biometric information can be contained in the value of the time between any pair of these timings, either relative to a time between another pair of these timings or relative to the duration of RR1, RR2, RR3, etc. The value of RR1, RR2, RR3 that is used can be the period in the current cycle or the average period over a number of cycles.</p><p id="p-0166" num="0218">For example the duration of the S1 event (from T&#x3b1;1 to T&#x3b3;1) as a fraction of the cycle period RR may provide useful biometric information. Alternatively, the duration of the S2 event (from T&#x3b1;2 to T&#x3b3;2) as a fraction of the period between S2 events and S1 events (from T&#x3b3;2 to T&#x3b1;1) may provide useful biometric information, just by way of example.</p><p id="p-0167" num="0219">In the case of amplitude-based information, the positive and negative peak amplitudes of an S1 event can be designated as A1P and A1N respectively, while the positive and negative peak amplitudes of an S2 event can be designated as A2P and A2N respectively.</p><p id="p-0168" num="0220">The amplitude-based biometric information contained in the PCG can then for example take the form of the ratio of any two such amplitude values, for example the ratio of A1P to A2N.</p><p id="p-0169" num="0221">In practice, to improve performance several of these time-based and/or amplitude-based values can be fused to form a vector containing highly discriminative biometric information.</p><p id="p-0170" num="0222">Thus, the step of obtaining information about properties of the detected heartbeat may comprise obtaining information about timing properties of the detected heartbeat and/or may comprise obtaining information about amplitude properties of the detected heartbeat.</p><p id="p-0171" num="0223">The method of <figref idref="DRAWINGS">FIG. <b>8</b></figref> then comprises step <b>134</b>, namely using the information about the properties of the detected heartbeat as a biometric identifier.</p><p id="p-0172" num="0224">Thus, in an enrolment phase, the selected biometric information is extracted while the known enrolling user is wearing the earphone, and stored in a database. For example, the metrics might be subjected to feature compression or reduction such as Linear Discriminative Analysis (LDA) before storage.</p><p id="p-0173" num="0225">During a verification phase, the selected biometric information is extracted while a person is wearing the earphone, and the vector of the biometric information is compared with the information stored in the database for the enrolled user. Where the metrics are subjected to feature compression or reduction before storage in the enrolment phase, the same feature compression or reduction may be applied in the verification phase. A similarity test is then applied, to determine whether the person wearing the earphone is the enrolled user. For example, the distance between the stored metrics obtained during enrolment and the metrics obtained during verification may be calculated using cosine similarity.</p><p id="p-0174" num="0226">There is thus described a system for detecting whether an earphone is being worn by a user, and a method of using information about the properties of a heartbeat, detected by a sensor on an earphone, as a biometric identifier.</p><p id="p-0175" num="0227">Embodiments may be implemented as an integrated circuit which in some examples could be a codec or similar. Embodiments may be implemented in a host device, especially a portable and/or battery powered host device such as a mobile computing device for example a laptop, notebook or tablet computer, a games console, a remote control device, a home automation controller or a domestic appliance including a domestic temperature or lighting control system, a toy, a machine such as a robot, an audio player, a video player, or a mobile telephone for example a smartphone. The device could be a wearable device such as a smartwatch. It will be understood that embodiments may be implemented as part of a system provided in a home appliance or in a vehicle or interactive display. The amplifier circuit may be an audio amplifier used to drive an audio transducer such as a loudspeaker or surface audio system, but it will be understood that the amplifier may be used to drive other transducers, e.g. a vibrational transducer such as a linear resonant actuator for the generation of haptic effects. There is further provided a host device incorporating the above-described system.</p><p id="p-0176" num="0228">The skilled person will recognise that some aspects of the above-described apparatus and methods, for example the discovery and configuration methods may be embodied as processor control code, for example on a non-volatile carrier medium such as a disk, CD- or DVD-ROM, programmed memory such as read only memory (Firmware), or on a data carrier such as an optical or electrical signal carrier. For many applications, embodiments will be implemented on a DSP (Digital Signal Processor), ASIC (Application Specific Integrated Circuit) or FPGA (Field Programmable Gate Array). Thus the code may comprise conventional program code or microcode or, for example code for setting up or controlling an ASIC or FPGA. The code may also comprise code for dynamically configuring re-configurable apparatus such as re-programmable logic gate arrays. Similarly the code may comprise code for a hardware description language such as Verilog&#x2122; or VHDL (Very high speed integrated circuit Hardware Description Language). As the skilled person will appreciate, the code may be distributed between a plurality of coupled components in communication with one another. Where appropriate, the embodiments may also be implemented using code running on a field-(re)programmable analogue array or similar device in order to configure analogue hardware.</p><p id="p-0177" num="0229">It should be noted that the above-mentioned embodiments illustrate rather than limit the invention, and that those skilled in the art will be able to design many alternative embodiments without departing from the scope of the appended claims. The word &#x201c;comprising&#x201d; does not exclude the presence of elements or steps other than those listed in a claim, &#x201c;a&#x201d; or &#x201c;an&#x201d; does not exclude a plurality, and a single feature or other unit may fulfil the functions of several units recited in the claims. Any reference numerals or labels in the claims shall not be construed so as to limit their scope.</p><p id="p-0178" num="0230">As used herein, when two or more elements are referred to as &#x201c;coupled&#x201d; to one another, such term indicates that such two or more elements are in electronic communication or mechanical communication, as applicable, whether connected indirectly or directly, with or without intervening elements.</p><p id="p-0179" num="0231">This disclosure encompasses all changes, substitutions, variations, alterations, and modifications to the example embodiments herein that a person having ordinary skill in the art would comprehend. Similarly, where appropriate, the appended claims encompass all changes, substitutions, variations, alterations, and modifications to the example embodiments herein that a person having ordinary skill in the art would comprehend. Moreover, reference in the appended claims to an apparatus or system or a component of an apparatus or system being adapted to, arranged to, capable of, configured to, enabled to, operable to, or operative to perform a particular function encompasses that apparatus, system, or component, whether or not it or that particular function is activated, turned on, or unlocked, as long as that apparatus, system, or component is so adapted, arranged, capable, configured, enabled, operable, or operative. Accordingly, modifications, additions, or omissions may be made to the systems, apparatuses, and methods described herein without departing from the scope of the disclosure. For example, the components of the systems and apparatuses may be integrated or separated. Moreover, the operations of the systems and apparatuses disclosed herein may be performed by more, fewer, or other components and the methods described may include more, fewer, or other steps. Additionally, steps may be performed in any suitable order. As used in this document, &#x201c;each&#x201d; refers to each member of a set or each member of a subset of a set.</p><p id="p-0180" num="0232">Although exemplary embodiments are illustrated in the figures and described below, the principles of the present disclosure may be implemented using any number of techniques, whether currently known or not. The present disclosure should in no way be limited to the exemplary implementations and techniques illustrated in the drawings and described above.</p><p id="p-0181" num="0233">Unless otherwise specifically noted, articles depicted in the drawings are not necessarily drawn to scale.</p><p id="p-0182" num="0234">All examples and conditional language recited herein are intended for pedagogical objects to aid the reader in understanding the disclosure and the concepts contributed by the inventor to furthering the art, and are construed as being without limitation to such specifically recited examples and conditions. Although embodiments of the present disclosure have been described in detail, it should be understood that various changes, substitutions, and alterations could be made hereto without departing from the spirit and scope of the disclosure.</p><p id="p-0183" num="0235">Although specific advantages have been enumerated above, various embodiments may include some, none, or all of the enumerated advantages. Additionally, other technical advantages may become readily apparent to one of ordinary skill in the art after review of the foregoing figures and description.</p><p id="p-0184" num="0236">To aid the Patent Office and any readers of any patent issued on this application in interpreting the claims appended hereto, applicants wish to note that they do not intend any of the appended claims or claim elements to invoke 35 U.S.C. &#xa7; 112(f) unless the words &#x201c;means for&#x201d; or &#x201c;step for&#x201d; are explicitly used in the particular claim.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A method of detecting whether an earpiece is being worn by a user, the method comprising:<claim-text>receiving a signal from at least one sensor on the earpiece; and</claim-text><claim-text>if a heartbeat is detected, determining that the earpiece is being worn by a user, wherein detecting a heartbeat in the received signal comprises:</claim-text><claim-text>band-pass filtering the signal to pass components of the signal in a frequency range consistent with the heartbeat, and</claim-text><claim-text>detecting a peak component of the band-pass filtered signal.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>if no heartbeat is detected, determining that the earpiece is not being worn by a user; and</claim-text><claim-text>determining that a speech signal detected by a microphone on the earpiece may not come from a live speaker.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>if no heartbeat is detected, determining that the earpiece is not being worn by a user; and</claim-text><claim-text>powering down an output amplifier connected to a loudspeaker of the earpiece or suspending playback of audio signals through the earpiece.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. (canceled)</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein using at least one sensor on the earpiece to detect a heartbeat comprises:<claim-text>using an accelerometer or a contact microphone on the earpiece to detect vibrations indicative of a heartbeat.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. (canceled)</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein using at least one sensor on the earpiece to detect a heartbeat comprises:<claim-text>detecting electrical signals associated with a heartbeat using an optical sensor to obtain a photoplethysmogram.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. (canceled)</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein using at least one sensor on the earpiece to detect a heartbeat comprises:<claim-text>using an inertial measurement unit configured to detect movement in an ear canal of the user if the earpiece is being worn by the user.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein using at least one sensor on the earpiece to detect a heartbeat comprises:<claim-text>using at least one audio transducer to obtain a signal representing sound in the vicinity of the earpiece.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. A method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the at least one audio transducer comprises a microphone on the earpiece.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. A method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the at least one audio transducer comprises a loudspeaker on the earpiece.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. A method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, further comprising:<claim-text>applying said signal representing sound in the vicinity of the earpiece to an analog-digital converter, wherein the analog-digital converter is switched on only when detecting whether the earpiece is being worn by a user.</claim-text></claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. A method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, comprising:<claim-text>using a first audio transducer to generate a first audio signal, wherein the first audio transducer is positioned on the earpiece so as to detect sounds in an ear canal of a user, when the earpiece is being worn normally;</claim-text><claim-text>using a second audio transducer to generate a second audio signal, wherein the second audio transducer is positioned on the earpiece so as to detect sounds outside an ear of a user, when the earpiece is being worn normally;</claim-text><claim-text>applying the second audio signal to an adaptive filter to generate a filtered second audio signal, wherein the adaptive filter is configured to represent a transfer function experienced by sound travelling from outside the ear of a user to inside the ear canal of the user; and</claim-text><claim-text>subtracting the filtered second audio signal from the first audio signal to generate said signal representing sound in the vicinity of the earpiece.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. A method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, further comprising:<claim-text>applying the signal representing sound in the vicinity of the earpiece to a first input of a subtractor;</claim-text><claim-text>applying a signal to be applied to a loudspeaker in the earpiece to an adaptive filter to generate a filtered signal; and</claim-text><claim-text>applying the filtered signal to a second input of the subtractor,</claim-text><claim-text>wherein the adaptive filter is adapted to reproduce an effect of applying the signal to the loudspeaker and detecting the resulting sound using said at least one audio transducer, such that an effect of the signal to be applied to the loudspeaker is minimised in an output of the subtractor.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. A method according to any preceding claim, wherein using at least one sensor on the earpiece to detect a heartbeat comprises:<claim-text>receiving a signal from the sensor;</claim-text><claim-text>obtaining samples of the received signal;</claim-text><claim-text>calculating an autocorrelation using the samples of the received signal;</claim-text><claim-text>detecting the heartbeat from at least one peak in the calculated autocorrelation.</claim-text></claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. A method according to <claim-ref idref="CLM-00016">claim 16</claim-ref>, comprising obtaining said samples of the received signal at a sample rate below 1 kHz.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. A method according to <claim-ref idref="CLM-00017">claim 17</claim-ref>, comprising receiving the signal in digital form with a sample rate higher than 1 kHz, and downsampling the received signal to a sample rate below 1 kHz.</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. A method according to <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein detecting the heartbeat from at least one peak in the calculated autocorrelation comprises:<claim-text>ignoring peaks that correspond to frequencies below a range of likely human heart rates; and</claim-text><claim-text>ignoring peaks having a height below a threshold height.</claim-text></claim-text></claim><claim id="CLM-20-21" num="20-21"><claim-text><b>20</b>.-<b>21</b>. (canceled)</claim-text></claim><claim id="CLM-00022" num="00022"><claim-text><b>22</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein determining whether said signal contains a component at a frequency consistent with a heartbeat comprises:<claim-text>applying said signal to a Kalman Filter.</claim-text></claim-text></claim><claim id="CLM-00023" num="00023"><claim-text><b>23</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein determining whether said signal contains a component at a frequency consistent with a heartbeat comprises:<claim-text>applying said signal to a phase locked loop, and determining a frequency at which the loop is locked.</claim-text></claim-text></claim><claim id="CLM-00024" num="00024"><claim-text><b>24</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein using at least one sensor on the earpiece to detect a heartbeat comprises:<claim-text>receiving a signal from the sensor; and</claim-text><claim-text>applying said signal to a neural network that has been trained to recognise signals representing heartbeats.</claim-text></claim-text></claim><claim id="CLM-00025" num="00025"><claim-text><b>25</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising:<claim-text>using at least one first sensor on the earpiece to detect a heartbeat; and</claim-text><claim-text>if a heartbeat is detected, making a preliminary determination that the earpiece is being worn by a user, and activating at least one second sensor on the earpiece;</claim-text><claim-text>using the at least one second sensor on the earpiece to detect a heartbeat; and</claim-text><claim-text>if a heartbeat is detected, determining that the earpiece is being worn by a user.</claim-text></claim-text></claim><claim id="CLM-00026" num="00026"><claim-text><b>26</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising:<claim-text>receiving a first signal from at least one first sensor on the earpiece, wherein the at least one first sensor is positioned on the earpiece such that it is able to detect a heartbeat, when the earpiece is being worn in an expected way;</claim-text><claim-text>determining whether the first signal comprises features characteristic of a heartbeat;</claim-text><claim-text>receiving a second signal from at least one second sensor on the earpiece, wherein the at least one second sensor is positioned on the earpiece such that it is not able to detect a heartbeat, when the earpiece is being worn in the expected way;</claim-text><claim-text>determining whether the second signal comprises features characteristic of a heartbeat;</claim-text><claim-text>and</claim-text><claim-text>if it is determined that the first signal comprises features characteristic of a heartbeat and that the second signal comprises features characteristic of a heartbeat, determining that the earpiece is not being worn in the expected way; or</claim-text><claim-text>if it is determined that the first signal comprises features characteristic of a heartbeat and that the second signal does not comprise features characteristic of a heartbeat, determining that the earpiece is being worn in the expected way.</claim-text></claim-text></claim><claim id="CLM-00027" num="00027"><claim-text><b>27</b>. (canceled)</claim-text></claim><claim id="CLM-00028" num="00028"><claim-text><b>28</b>. A system comprising a processor, wherein the processor is configured for performing a method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text></claim><claim id="CLM-00029" num="00029"><claim-text><b>29</b>. A computer program product, comprising a tangible and/or non-volatile computer readable medium, comprising computer readable instructions for causing a processor to perform a method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text></claim><claim id="CLM-30-42" num="30-42"><claim-text><b>30</b>.-<b>42</b>. (canceled)</claim-text></claim><claim id="CLM-00043" num="00043"><claim-text><b>43</b>. A method of detecting whether an earpiece is being worn by a user, the method comprising:<claim-text>using at least one sensor on the earpiece to detect a heartbeat; and</claim-text><claim-text>if a heartbeat is detected, determining that the earpiece is being worn by a user;</claim-text><claim-text>if no heartbeat is detected:<claim-text>determining that the earpiece is not being worn by a user; and</claim-text><claim-text>determining that a speech signal detected by a microphone on the earpiece may not come from a live speaker.</claim-text></claim-text></claim-text></claim></claims></us-patent-application>