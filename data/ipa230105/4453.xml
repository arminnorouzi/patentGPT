<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230004454A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230004454</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17809273</doc-number><date>20220628</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>JP</country><doc-number>2021-109172</doc-number><date>20210630</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>F</subclass><main-group>11</main-group><subgroup>00</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>N</subclass><main-group>7</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>11</main-group><subgroup>006</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>N</subclass><main-group>7</main-group><subgroup>005</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">DATA ABNORMALITY DETERMINATION APPARATUS AND INTERNAL STATE PREDICTION SYSTEM</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>HONDA MOTOR CO., LTD.</orgname><address><city>Tokyo</city><country>JP</country></address></addressbook><residence><country>JP</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>KONISHI</last-name><first-name>Shunsuke</first-name><address><city>Saitama</city><country>JP</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>UTSUMI</last-name><first-name>Hidetoshi</first-name><address><city>Saitama</city><country>JP</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>TSUGE</last-name><first-name>Hodaka</first-name><address><city>Saitama</city><country>JP</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>KOKETSU</last-name><first-name>Seiichi</first-name><address><city>Saitama</city><country>JP</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A data abnormality determination apparatus <b>1</b> determines that there is an abnormality in input data and is provided with: a probability density calculator <b>11</b> that calculates, as an input density value, a probability density value for the input data in a probability density function constructed based on a data set; an occurrence probability calculator <b>12</b> that calculates, as an occurrence probability with respect to the input data, a value corresponding to an integral of the probability density function across a tail region in which the probability density value in the probability density function is equal to or less than the input density value; and an abnormality determiner <b>13</b> determines that there is an abnormality in the input data based on the occurrence probability.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="27.94mm" wi="158.75mm" file="US20230004454A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="248.58mm" wi="70.61mm" orientation="landscape" file="US20230004454A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="230.29mm" wi="90.76mm" file="US20230004454A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="236.73mm" wi="114.89mm" file="US20230004454A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="229.45mm" wi="152.91mm" orientation="landscape" file="US20230004454A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><p id="p-0002" num="0001">This application is based on and claims the benefit of priority from Japanese Patent Application No. 2021-109172, filed on 30 Jun. 2021, the content of which is incorporated herein by reference.</p><heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading><heading id="h-0002" level="1">Field of the Invention</heading><p id="p-0003" num="0002">The present invention pertains to a data abnormality determination apparatus and an internal state prediction system. In more detail, the present invention pertains to a data abnormality determination apparatus that determines that there is an abnormality in input data, and an internal state prediction system provided with this data abnormality determination apparatus.</p><heading id="h-0003" level="1">Related Art</heading><p id="p-0004" num="0003">In the past, many proposals have been made for techniques for, in a state where a certain quantity of data sets have been acquired, determining that there is an abnormality in newly acquired data. For example, Patent Documents 1 and 2 describe techniques for determining abnormalities in data based on a Hotelling T<sup>2 </sup>method.</p><p id="p-0005" num="0004">Patent Document 1: Japanese Unexamined Patent Application, Publication No. 2020-131443</p><p id="p-0006" num="0005">Patent Document 2: Japanese Unexamined Patent Application, Publication No. 2017-151593</p><heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading><p id="p-0007" num="0006">However, the Hotelling T<sup>2 </sup>method has a premise that a data set conforms to a normal distribution. Accordingly, the Hotelling T<sup>2 </sup>method cannot be applied in the case where a data set conforms to another distribution shape, for example a multimodal distribution shape.</p><p id="p-0008" num="0007">The present invention has an objective of providing a data abnormality determination apparatus that can determine that there is an abnormality in data regardless of the distribution shape of a data set, and an internal state prediction system provided with this data abnormality determination apparatus.</p><p id="p-0009" num="0008">(1) A data abnormality determination apparatus (for example, data abnormality determination apparatuses <b>1</b>, <b>8</b> described below) according to the present invention is for determining that there is an abnormality in input data and includes: a probability density calculator (for example, probability density calculators <b>11</b>, <b>81</b> described below) configured to calculate, as an input density value, a probability density value for the input data in a probability density function constructed based on a data set; an occurrence probability calculator (for example, occurrence probability calculators <b>12</b>, <b>82</b> described below) configured to calculate, as an occurrence probability for the input data, a value corresponding to an integral, for the probability density function across a tail region in which a probability density value in the probability density function is equal to or less than the input density value; and an abnormality determiner (for example, abnormality determiners <b>13</b>, <b>83</b> described below) configured to determine that there is an abnormality in the input data, based on the occurrence probability.</p><p id="p-0010" num="0009">(2) In this case, it is desirable for the occurrence probability calculator to have calibration curve data that associates a probability density value in the probability density function with an integral of the probability density function across the tail region, and calculate, as the occurrence probability, an integral associated with the input density value by the calibration curve data.</p><p id="p-0011" num="0010">(3) In this case, it is desirable for the occurrence probability calculator to calculate, as the occurrence probability, a ratio of the number of data points included in the tail region with respect to a total number of data points, from among a plurality of data points generated in accordance with the probability density function, based on a Monte Carlo method.</p><p id="p-0012" num="0011">(4) An internal state prediction system (for example, an internal state prediction system <b>5</b> described below) according to the present invention predicts an internal state of a target object and includes: an input data obtainment apparatus (for example, an input data obtainment apparatus <b>6</b> described below) configured to obtain input data correlated to the internal state; a model prediction apparatus (for example, a model prediction apparatus <b>7</b> described below) configured to, based on the input data and a prediction model constructed based on a training data set, predict the internal state; a data abnormality determination apparatus (for example, a data abnormality determination apparatus <b>8</b> described below) configured to determine that there is an abnormality in the input data; and a reliability determination apparatus (for example, a reliability determination apparatus <b>9</b> described below) configured to, based on a determination result by the data abnormality determination apparatus, determine a reliability for a prediction result from the model prediction apparatus, in which the data abnormality determination apparatus includes a probability density calculator (for example, a probability density calculator <b>81</b> described below) configured to calculate, as an input density value, a probability density value for the input data in a probability density function constructed based on the training data set, an occurrence probability calculator (for example, an occurrence probability calculator <b>82</b> described below) configured to calculate, as an occurrence probability for the input data, a value corresponding to an integral for the probability density function across a tail region in which a probability density value in the probability density function is equal to or less than the input density value, and an abnormality determiner (for example, an abnormality determiner <b>83</b> described below) configured to determine that there is an abnormality in the input data, based on the occurrence probability.</p><p id="p-0013" num="0012">(1) In the data abnormality determination apparatus according to the present invention, the probability density calculator calculates, as an input density value, a probability density value for input data in a probability density function constructed based on a data set, the occurrence probability calculator calculates, as an occurrence probability with respect to the input data, a value corresponding to an integral of the probability density function across a tail region in which the probability density value in the probability density function is equal to or less than the input density value, and the abnormality determiner determines that there is an abnormality in the input data based on the occurrence probability. By virtue of the present invention, it is possible to calculate the occurrence probability for the input data regardless of the number of dimensions for the data set and the shape of the probability density function, which is based on this data set, and it is also possible to appropriately determine that there is an abnormality in the input data.</p><p id="p-0014" num="0013">(2) In the data abnormality determination apparatus according to the present invention, the occurrence probability calculator has calibration curve data that associates a probability density value in the probability density function with an integral of the probability density function across the tali region, and calculates, as the occurrence probability, an integral associated with the input density value by the calibration curve data. By virtue of the present invention, it is possible to quietly determine that there is an abnormality in input data.</p><p id="p-0015" num="0014">(3) There is typically a tendency for creation of calibration curve data as described above to take more time the greater the number of dimensions in the data set. In contrast to this, in the data abnormality determination apparatus according to the present invention, the occurrence probability calculator calculates, as the occurrence probability, the ratio of the number of data points included in the tail region with respect to the total number of data points, from among a plurality of data points generated in accordance with the probability density function, based on a Monte Carlo method. Accordingly, by virtue of the present invention, in particular implementation becomes easy in a case where there is a large number of dimensions for a data set.</p><p id="p-0016" num="0015">(4) In the internal state prediction system according to the present invention, the model prediction apparatus, based on input, data obtained by the input data obtainment apparatus and a prediction model constructed based on a training data set, predicts an internal state for a target object. Here, in a case where the input data deviates from the training data set used when the prediction model was constructed, a prediction result by the model prediction apparatus based on such input, data can be considered to have low reliability. In response to this, in the internal state prediction system according to the present invention, the data abnormality determination apparatus determines that there is an abnormality in the input data based on a probability density function constructed based on a training data set, and the reliability determination apparatus, based on a determination result by the data abnormality determination apparatus, determines a reliability for the prediction result by the model prediction apparatus. As a result, it is possible to guarantee the reliability of a prediction result produced by the model prediction apparatus regarding the internal state.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a functional block diagram that illustrates a configuration of a data abnormality determination apparatus according to a first embodiment of the present invention;</p><p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> is a view that illustrates an example of a two-dimensional data set used when constructing a probability density function;</p><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>2</b>B</figref> is a view that illustrates an example of a probability density function constructed based on the data set illustrated in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>;</p><p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a view for describing a procedure for, in an occurrence probability calculator, calculating an occurrence probability for input data;</p><p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a view that illustrates an example of calibration curve data; and</p><p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a functional block diagram that illustrates a configuration of an internal state prediction system according to a second embodiment of the present invention.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading><heading id="h-0007" level="1">First Embodiment</heading><p id="p-0023" num="0022">With reference to the drawings, description is given below regarding a data abnormality determination apparatus according to a first embodiment of the present invention.</p><p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a functional block diagram that illustrates a configuration of a data abnormality determination apparatus <b>1</b> according to the present embodiment. The data abnormality determination apparatus <b>1</b> uses a probability density function constructed based on a set of N-dimensional data (N is an integer equal to or greater than 1) to thereby determine that there is an abnormality in N-dimensional input data newly inputted from a data input apparatus <b>2</b>.</p><p id="p-0025" num="0024">Description is given below regarding a case where the number of dimensions N for data handled in the data abnormality determination apparatus <b>1</b> is set to 2, in other words a case where the data abnormality determination apparatus <b>1</b> handles two-dimensional data, but the present invention is not limited to this. Data handled in the data abnormality determination apparatus <b>1</b> may be one-dimensional or may be multi-dimensional and have three or more dimensions.</p><p id="p-0026" num="0025">The data abnormality determination apparatus <b>1</b> is a computer configured by hardware including an arithmetic processing means such as a CPU, an auxiliary storage means such as an HDD or an SSD that stores various programs, and a main storage means such as a RAM that stores data which is temporarily necessary for the arithmetic processing means to execute a program. By such a hardware configuration, various functionality such as a probability density calculator <b>11</b>, an occurrence probability calculator <b>12</b>, and an abnormality determiner <b>13</b> are realized in the data abnormality determination apparatus <b>1</b>.</p><p id="p-0027" num="0026">The probability density calculator <b>11</b> has a probability density function constructed using, for example, kernel density estimation based on an N-dimensional data set collected in advance. When newly inputted with N-dimensiona<b>1</b> input data from the data input apparatus <b>2</b>, the probability density calculator <b>11</b> calculates, as an input density value, a probability density value for the input data in the probability density function, and outputs the input density value to the occurrence probability calculator <b>12</b>. Note that a probability density function referred to below is assumed to be normalized so that an integral for the probability density function across the entire domain for a random variable (in other words, input data) becomes &#x201c;1&#x201d;.</p><p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> is a view that illustrates an example of a data set for two-dimensional data (X, Y) used when constructing a probability density function. <figref idref="DRAWINGS">FIG. <b>2</b>B</figref> is a view that illustrates an example of a probability density function constructed based on the data set illustrated in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>. Note that, in <figref idref="DRAWINGS">FIG. <b>2</b>B</figref>, the probability density function is a function of two variables, and the height of the function, in other words the magnitude of the probability density values, is represented by shading.</p><p id="p-0029" num="0028">The data set exemplified in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref> includes a first cluster C<b>1</b> that constitutes a plurality of items of data concentratedly distributed in an arc shape that protrudes upward in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>, and a second cluster C<b>2</b> that constitutes a plurality of items of data concenlratedly distributed in an arc shape that protrudes downward in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>. In this manner, a probability density function construct based on the data set that includes the plurality of clusters C<b>1</b> and C<b>2</b> becomes multimodal as exemplified in <figref idref="DRAWINGS">FIG. <b>2</b>B</figref>.</p><p id="p-0030" num="0029">Based on the input density value for the input data and the probability density function referred to when the input density value was calculated in the probability density calculator <b>11</b>, the occurrence probability calculator <b>12</b> calculates an occurrence probability [%] with respect to the input data, and outputs the occurrence probability to the abnormality determiner <b>13</b>.</p><p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a view for describing a procedure for, in the occurrence probability calculator <b>12</b>, calculating an occurrence probability for input data D<b>1</b>. The occurrence probability calculator <b>12</b> defines a tail region R<b>1</b> (region indicated by hatching in <figref idref="DRAWINGS">FIG. <b>3</b></figref>) to be a region in which a probability density value in the probability density function becomes less than or equal to the input density value calculated for the input data D<b>1</b>. The occurrence probability calculator <b>12</b> also calculates, as an occurrence probability for the input data D<b>1</b>, a value corresponding to an integral for the probability density function across the entire tail region R<b>1</b>. Description is given below for a first example and a second example of a specific procedure for calculating a value corresponding to the integral of the probability density function across the tail region as above.</p><heading id="h-0008" level="1">FIRST EXAMPLE</heading><p id="p-0032" num="0031">As described with reference to <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the tail region R<b>1</b> is uniquely defined for each input density value. In other words, as long as the input density value does not change, the tail region R<b>1</b> is constant regardless of a position in the input data D<b>1</b>. Accordingly, because the integral across the tail region R<b>1</b> for the probability density function is also uniquely defined for each input density value, it is possible to use calibration curve data to associate the input density value with the integral across the tail region R<b>1</b> for the probability density function. Accordingly, in the first example, by calculating an integral for the probability density function across a tail region defined for each probability density value, calibration curve data (refer to <figref idref="DRAWINGS">FIG. <b>4</b></figref>) that associates the input density value with the integral (in other words, a cumulative probability) is created in advance. More specifically, it is possible to create the calibration curve data by, for example, creating a plurality of contours (in other words, lines on the probability density function that are defined by a plurality of items of input data having the same probability density value) on the probability density function and calculating integrals of the probability density function across tail regions demarcated by these contours. In accordance with a procedure such as the above, the occurrence probability calculator <b>12</b> uses calibration curve data created in advance to calculate, as the occurrence probability, an integral associated with an input density value.</p><heading id="h-0009" level="1">SECOND EXAMPLE</heading><p id="p-0033" num="0032">In the second example, an integral of a probability density function across a tail region as described above is calculated based on a Monte Carlo method. In other words, from among a plurality of data points randomly generated in accordance with the probability density function, the ratio of a number of data points included in the taxi region with respect to the total number of data points is approximately equal to an integral for the probability density function across the tail region. Accordingly, in the second example, the occurrence probability calculator <b>12</b> calculates, as the occurrence probability, the ratio of the number of data points included in the tail region with respect to the total number of data points, from among a plurality of data points generated in accordance with the probability density function, based on the Monte Carlo method. Note that, in the second example, based on the Monte Carlo method as described above, it is also possible to map in advance a relationship between a derived input density value and the occurrence probability. In this case, the occurrence probability calculator <b>12</b> uses an input density value to search a map as described above to thereby be able to quickly calculate an occurrence probability that corresponds to the input density value.</p><p id="p-0034" num="0033">Based on the occurrence probability calculated by the occurrence probability calculator <b>12</b>, the abnormality determiner <b>13</b> determines that there is an abnormality in input data. More specifically, in a case where the occurrence probability is less than a predefined abnormality determination threshold (for example, a few percent), the abnormality determiner <b>13</b> determines that the input data has an abnormality. In a case where the occurrence probability is equal to or greater than the abnormality determination threshold, the abnormality determiner <b>13</b> determines that the input data is normal.</p><p id="p-0035" num="0034">By virtue of the data abnormality determination apparatus <b>1</b> according to the present embodiment, the following effects are achieved.</p><p id="p-0036" num="0035">(1) In the data abnormality determination apparatus <b>1</b>, the probability density calculator <b>11</b> calculates, as an input density value, a probability density value for input data in a probability density function constructed based on a data set, the occurrence probability calculator <b>12</b> calculates, as an occurrence probability with respect to the input data, a value corresponding to an integral of the probability density function across a tail region in which the probability density value in the probability density function is equal to or less than the input density value, and the abnormality determiner <b>13</b> determines that there is an abnormality in the input data based on the occurrence probability. By virtue of the data abnormality determination apparatus <b>1</b>, it is possible to calculate the occurrence probability for the input data regardless of the number of dimensions for the data set and the shape of the probability density function, which is based on this data set, and it is also possible to appropriately determine that there is an abnormality in the input data.</p><p id="p-0037" num="0036">(2) The occurrence probability calculator <b>12</b> in the first example has calibration curve data that associates a probability density value in the probability density function with an integral of the probability density function across the tail region, and calculates, as the occurrence probability, an integral associated with the input density value by the calibration curve data. By virtue of the data abnormality determination apparatus <b>1</b>, it is possible to quickly determine that there is an abnormality in input data.</p><p id="p-0038" num="0037">(3) There is typically a tendency for creation of the calibration curve data in the first example described above to take more time the greater the number of dimensions in a data set. In contrast to this, the occurrence probability calculator <b>12</b> in the second example calculates, as the occurrence probability, the ratio of the number of data points included in the tail region with respect to the total number of data points, from among a plurality of data points generated in accordance with the probability density function, based on a Monte Carlo method. Accordingly, by virtue of the data abnormality determination apparatus <b>1</b>. In particular Implementation becomes easier in the case where there is a large number of dimensions in a data set.</p><heading id="h-0010" level="1">Second Embodiment</heading><p id="p-0039" num="0038">Next, with reference to the drawings, description is given regarding an internal state prediction system according to a second embodiment of the present invention.</p><p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a functional block diagram that illustrates a configuration of an internal state prediction system <b>5</b> according to the present embodiment. The internal state prediction system <b>5</b> is, for example, mounted in an electric vehicle (not illustrated) that travels using electric power supplied from a battery, and predicts an internal state (for example, a future deteriorated state) for the battery in the traveling electric vehicle.</p><p id="p-0041" num="0040">The internal state prediction system <b>5</b> is a computer configured by hardware including an arithmetic processing means such as a CPU, an auxiliary storage means such as a HDD or an SSD that stores various programs, and a main storage means such as a RAM that stores data temporarily necessary for the arithmetic processing means to execute a program. By such a hardware configuration, various functionality such as an input data obtainment apparatus <b>6</b>, a model prediction apparatus <b>7</b>, a data abnormality determination apparatus <b>3</b>, and a reliability determination apparatus <b>9</b> are realized in the internal state prediction system <b>5</b>.</p><p id="p-0042" num="0041">The input data obtainment apparatus <b>6</b> obtains M-dimensional (M is an integer equal to or greater than 1) input data correlated with a future deteriorated state of a battery, which is a target object for a prediction by the internal state prediction system <b>5</b>, and transmits the M-dimensional input data to the model prediction apparatus <b>7</b> and the data abnormality determination apparatus <b>8</b>. Here, the input data correlated with the future deteriorated state of the battery is, for example, a temperature history, current history, and voltage history for the battery.</p><p id="p-0043" num="0042">The model prediction apparatus <b>7</b> is provided with a prediction model that has been constructed based on an M-dimensional training data set using a known learning algorithm so that the prediction model, when inputted with M-dimensional input data, outputs a prediction value for a future deteriorated state for the battery. When new input data is transmitted from the input data obtainment apparatus <b>6</b>, the model prediction apparatus <b>7</b> inputs this input data to the prediction model to thereby predict a future deteriorated state for the battery.</p><p id="p-0044" num="0043">With a configuration that is approximately the same as that of the data abnormality determination apparatus <b>1</b> according to the first embodiment, the data abnormality determination apparatus <b>8</b> determines that there is an abnormality in new input data transmitted from the input data obtainment apparatus <b>6</b>. More specifically, the data abnormality determination apparatus <b>8</b> is provided with: a probability density calculator <b>81</b> that calculates, as an input density value, a probability density value for input data in a probability density function constructed based on the same training data set used when constructing the prediction model described above; an occurrence probability calculator <b>82</b> that calculates, as an occurrence probability with respect to the input data, a value corresponding to an integral of the probability density function across a tail region in which the probability density value in the probability density function is equal to or less than the input density value; and an abnormality determiner <b>83</b> that determines that there is an abnormality in the input data based on the occurrence probability. Note that, except for configurations of input data and data sets and the configuration of the probability density function, the configurations of the probability density calculator <b>81</b>, the occurrence probability calculator <b>82</b>, and the abnormality determiner <b>83</b> are respectively approximately the same as the configurations of the probability density calculator <b>11</b>, the occurrence probability calculator <b>12</b>, and the abnormality determiner <b>13</b> according to the first embodiment, and detailed description is omitted.</p><p id="p-0045" num="0044">Based on a determination result by the data abnormality determination apparatus <b>8</b> pertaining to an abnormality in input data newly obtained by the input data obtainment apparatus <b>6</b>, the reliability determination apparatus <b>9</b> determines a reliability for a prediction result from the model prediction apparatus <b>7</b> that is based on the same input data. More specifically, the reliability determination apparatus <b>9</b> determines that the reliability of a prediction result from the model prediction apparatus <b>7</b> is low in a case where the data abnormality determination apparatus <b>8</b> has determined that there is an abnormality in input data newly obtained by the input data obtainment apparatus <b>6</b>, and determines that the reliability of a prediction result from the model prediction apparatus <b>7</b> is high in a case where the data abnormality determination apparatus <b>8</b> has determined that the input data is normal.</p><p id="p-0046" num="0045">By virtue of the internal state prediction system <b>5</b> according to the present embodiment, the following effect is achieved.</p><p id="p-0047" num="0046">(4) In the internal state prediction system <b>5</b>, the model prediction apparatus <b>7</b>, based on input data obtained by the input data obtainment apparatus <b>6</b> and a prediction model constructed based on a training data set, predicts a future deteriorated state of a battery. Here, in a case where the input data deviates from the training data set used when the prediction model was constructed, a prediction result by the model prediction apparatus <b>7</b> based on such input data can be considered to have, low reliability. In response to this, in the internal state prediction system <b>5</b>, the data abnormality determination apparatus <b>3</b> determines that there is an abnormality in the input data based on a probability density function constructed based on a training data set, and the reliability determination apparatus <b>9</b>, based on a determination result by the data abnormality determination apparatus <b>3</b>, determines a reliability for the prediction result by the model prediction apparatus <b>7</b>. As a result, it is possible to guarantee the reliability of a prediction result produced by the model prediction apparatus <b>7</b> regarding the future deteriorated state for a battery.</p><p id="p-0048" num="0047">Description was given above regarding embodiments of the present invention, but the present invention is not limited to this. The detailed configurations may be changed, as appropriate, within the scope of the gist of the present invention.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A data abnormality determination apparatus for determining that there is an abnormality in input; data, comprising:<claim-text>a probability density calculator configured to calculate, as an input density value, a probability density value for the input data in a probability density function constructed based on a data set;</claim-text><claim-text>an occurrence probability calculator configured to calculate, as an occurrence probability for the input data, a value corresponding to an integral for the probability density function across a tail region in which a probability density value in the probability density function is equal to or less than the input, density value; and</claim-text><claim-text>an abnormality determiner configured to determine that there is an abnormality in the input data, based on the occurrence probability.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The data abnormality determination apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the occurrence probability calculator has calibration curve data that associates a probability density value in the probability density function with an integral of the probability density function across the tail region, and calculates, as the occurrence probability, an integral associated with the input density value by the calibration curve data.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The data abnormality determination apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the occurrence probability calculator calculates, as the occurrence probability, a ratio of a number of data points included in the tail region with respect to a total number of data points from among a plurality of data points generated in accordance with the probability density function, based on a Monte Carlo method.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. An internal state prediction system for predicting an internal state of a target object, comprising:<claim-text>an input data obtainment apparatus configured to obtain input data correlated to the internal state;</claim-text><claim-text>a model prediction apparatus configured to, based on the input data and a prediction model constructed based on a training data set, predict the internal state;</claim-text><claim-text>a data abnormality determination apparatus configured to determine that there is an abnormality in the input data; and</claim-text><claim-text>a reliability determination apparatus configured to, based on a determination result by the data abnormality determination apparatus, determine a reliability for a prediction result from the model prediction apparatus,</claim-text><claim-text>wherein the data abnormality determination apparatus includes</claim-text><claim-text>a probability density calculator configured to calculate, as an input density value, a probability density value for the input data in a probability density function constructed based on the training data set,</claim-text><claim-text>an occurrence probability calculator configured to calculate, as an occurrence probability for the input data, a value corresponding to an integral for the probability density function across a tail region in which a probability density value in the probability density function is equal to or less than the input density value, and</claim-text><claim-text>an abnormality determiner configured to determine that there is an abnormality in the input data, based on the occurrence probability.</claim-text></claim-text></claim></claims></us-patent-application>