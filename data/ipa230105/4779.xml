<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230004780A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230004780</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17678998</doc-number><date>20220223</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>CN</country><doc-number>202110733306.8</doc-number><date>20210630</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>04</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>063</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>C</section><class>02</class><subclass>F</subclass><main-group>1</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>0436</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>0454</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>063</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>C</section><class>02</class><subclass>F</subclass><main-group>1</main-group><subgroup>008</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>C</section><class>02</class><subclass>F</subclass><main-group>2209</main-group><subgroup>15</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>C</section><class>02</class><subclass>F</subclass><main-group>2209</main-group><subgroup>22</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>C</section><class>02</class><subclass>F</subclass><main-group>2209</main-group><subgroup>001</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>C</section><class>02</class><subclass>F</subclass><main-group>2209</main-group><subgroup>006</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">Multi-time Scale Model Predictive Control of Wastewater Treatment Process</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>BEIJING UNIVERSITY OF TECHNOLOGY</orgname><address><city>BEIJING</city><country>CN</country></address></addressbook><residence><country>CN</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Han</last-name><first-name>Honggui</first-name><address><city>BEIJING</city><country>CN</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Fu</last-name><first-name>Shijia</first-name><address><city>BEIJING</city><country>CN</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Sun</last-name><first-name>Haoyuan</first-name><address><city>BEIJING</city><country>CN</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>Qiao</last-name><first-name>Junfei</first-name><address><city>BEIJING</city><country>CN</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A multi-time scale model predictive control method for wastewater treatment process is designed to control the dissolved oxygen concentration and nitrate nitrogen concentration in different time scales to ensure that the effluent quality meets the standard. In view of the difference of time scales in wastewater treatment process caused by different sampling periods of dissolved oxygen concentration and nitrate nitrogen concentration, prediction models with different time scales are firstly designed to unify the prediction outputs to the fast time scale. Then, the gradient descent algorithm is used to solve the optimal solution with fast time scale to control the wastewater treatment system. It not only conforms to the operation characteristics of wastewater treatment process, but also solves the problem of poor operation performance of multiobjective model predictive control caused by different time scales. The experimental results show that the multi-time scale model predictive control method can achieve accurate on-line control of dissolved oxygen concentration and nitrate nitrogen concentration with fast time scales.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="154.26mm" wi="104.56mm" file="US20230004780A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="184.57mm" wi="159.00mm" file="US20230004780A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="215.48mm" wi="136.48mm" file="US20230004780A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="174.92mm" wi="116.25mm" file="US20230004780A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="181.78mm" wi="113.88mm" file="US20230004780A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading><p id="p-0002" num="0001">This application claims the priority benefits to Chinese Patent Application No. 202110733306.8 filed on Jun. 30, 2021, the content of which is hereby incorporated by reference in its entirety.</p><heading id="h-0002" level="1">TECHNOLOGY AREA</heading><p id="p-0003" num="0002">In this invention, the different time scale prediction models are used to predict the dissolved oxygen concentration and nitrate nitrogen concentration of wastewater treatment process in real time online in a fast time scale, and the control laws are calculated in the fast time scale to realize the accurate control of dissolved oxygen concentration and nitrate nitrogen concentration. As an important part of wastewater treatment process, the control of dissolved oxygen concentration and nitrate nitrogen concentration is an important branch of advanced manufacturing technology, which belongs to the field of intelligent control and water treatment.</p><heading id="h-0003" level="1">TECHNOLOGY BACKGROUND</heading><p id="p-0004" num="0003">The discharged wastewater contains a lot of organic matter, nitrogen, phosphorus and other substances, which is the main reason of water pollution. Wastewater treatment plant is one of the important ways to purify wastewater and realize the recycling of water resources. With the increasingly strict wastewater discharge standards, the control requirements for wastewater treatment process are also increasing. wastewater treatment process, as a complex process, has the characteristics of uncertainty, nonlinearity, time scale difference and so on. After years of construction, China's wastewater treatment industry has obtained lots of achievements. However, the backward production technology and extensive management mode make most wastewater treatment plants have high treatment cost and low efficiency. Therefore, it is an urgent problem to reduce energy consumption and improve wastewater treatment efficiency on the premise that the effluent quality of wastewater treatment plant meets the standard at this stage.</p><p id="p-0005" num="0004">The concentration of dissolved oxygen in aerobic zone and nitrate nitrogen in anoxic zone of wastewater treatment process directly reflect the process of nitrification and denitrification. Controlling the dissolved oxygen concentration and nitrate nitrogen concentration within an appropriate range can improve the wastewater treatment capacity and ensure that the effluent quality meets the standard. Therefore, it is very important to control the dissolved oxygen concentration and nitrate nitrogen concentration in wastewater treatment process. However, due to the limitation of measuring instruments, the sampling periods of dissolved oxygen concentration and nitrate nitrogen concentration are different, which has the characteristics of inconsistent time scales. Meanwhile, the control of wastewater treatment process is difficult because the complexity of the physical, chemical and biological phenomena and the fluctuation of the influent flow and components. Traditional PID controller or nonlinear model predictive control cannot adapt to the above characteristics, which may reduce the system performance and wastewater treatment efficiency, and even difficult to maintain the stability of the closed-loop system.</p><p id="p-0006" num="0005">The invention designs an multi-time scale model predictive control method for wastewater treatment process. In this method, different time scale prediction models are introduced to unify the prediction outputs of dissolved oxygen concentration and nitrate nitrogen concentration to the fast time scale, and the gradient descent algorithm is used to solve the control law on the fast time scale to realize the accurate on-line control of dissolved oxygen concentration and nitrate nitrogen concentration in the fast time scale.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0007" num="0006">In view of the difference of time scales in wastewater treatment process caused by different sampling periods of dissolved oxygen concentration and nitrate nitrogen concentration, the invention proposes a multi-time scale model predictive control method for wastewater treatment process. Prediction models with different time scales are designed to unify the prediction outputs to the fast time scale and the gradient descent algorithm is used to solve the optimal solution with fast time scale to control the wastewater treatment process system. The invention solves the problem of poor operation performance of multivariable model predictive control for multi time scale system and effectively improves the accuracy of online control of dissolved oxygen concentration and nitrate nitrogen concentration; The invention adopts the following technical scheme and implementation steps:</p><p id="p-0008" num="0007">1. A multi-time scale model predictive control method of wastewater treatment process, comprising the following steps:</p><p id="p-0009" num="0008">(1) the multi-time scale model predictive control system for wastewater treatment process control comprising a set of measuring devices arranged to obtain a dataset, measuring devices include dissolved oxygen detector, nitrate nitrogen detector, the dataset comprises a plurality of process variables related to a parameter of wastewater treatment process; a programmable logic controller arranged to perform digital/analog conversion and analog/digital conversion; a variable-frequency drive arranged to control the air-blower and electronic valve by changing the working power frequency of motor; an air-blower arranged to provide the required oxygen to the microorganisms in the wastewater treatment process; an electronic valve arranged to adjust internal return flow; a multi-time scale model predictive control module arranged to calculate the control law to track the dissolved oxygen concentration and nitrate nitrogen concentration in wastewater treatment process with different time scales; the multi-time scale model predictive control module comprising two fuzzy neural network to predict the system outputs, a time scale conversion mechanism to unify the prediction time scales to fast time scale, and an optimization control module to calculate the control law;</p><p id="p-0010" num="0009">(2) the time scales of dissolved oxygen concentration and nitrate nitrogen concentration in wastewater treatment process are different, specifically:</p><p id="p-0011" num="0010">T<sub>f </sub>is the sampling interval of dissolved oxygen concentration, T<sub>f</sub>&#x2208;[6, 10] is a positive integer in minutes, t<sub>f</sub>=fT<sub>f </sub>represents the sampling instant of dissolved oxygen concentration, f is the number of sampling steps of dissolved oxygen concentration, and f&#x2208;[1, 1000] is a positive integer;</p><p id="p-0012" num="0011">T<sub>s </sub>is the sampling interval of nitrate nitrogen concentration, T<sub>s</sub>&#x2208;[12, 20] is a positive integer in minutes, t<sub>s</sub>=sT<sub>s </sub>represents the sampling instant of nitrate nitrogen concentration, s is the number of sampling steps of nitrate nitrogen concentration, and s&#x2208;[1, 400] is a positive integer;</p><p id="p-0013" num="0012">&#x3b6; is the maximum common divisor of T<sub>f </sub>and T<sub>s</sub>, t<sub>&#x3b7;</sub>=&#x3b7;&#x3b6; is the prediction instant of slow sampling fuzzy neural network, &#x3b7; is the number of prediction steps of slow sampling fuzzy neural network, &#x3b7;&#x2208;[1, 2000] is a positive integer;</p><p id="p-0014" num="0013">(3) a fast sampling fuzzy neural network is designed to predict dissolved oxygen concentration with time scale T<sub>f</sub>, which is as follows:</p><p id="p-0015" num="0014">the input of the fast sampling fuzzy neural network is x<sub>f</sub>(t<sub>f</sub>)=[x<sub>f1</sub>(t<sub>f&#x2212;1</sub>), x<sub>f2</sub>(t<sub>f&#x2212;1</sub>), x<sub>f3</sub>(t<sub>f&#x2212;1</sub>)]<sup>T</sup>, T is the transposition of the matrix, and the output of the fast sampling fuzzy neural network is the predicted value of dissolved oxygen concentration &#x177;<sub>f</sub>(t<sub>f</sub>) at time t<sub>f</sub>, the output is defined as follows</p><p id="p-0016" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <msub>       <mover accent="true">        <mi>y</mi>        <mi>&#x2c6;</mi>       </mover>       <mi>f</mi>      </msub>      <mo>(</mo>      <msub>       <mi>t</mi>       <mi>f</mi>      </msub>      <mo>)</mo>     </mrow>     <mo>=</mo>     <mfrac>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <mrow>        <mrow>         <msub>          <mi>w</mi>          <mi>fj</mi>         </msub>         <mo>(</mo>         <msub>          <mi>t</mi>          <mi>f</mi>         </msub>         <mo>)</mo>        </mrow>        <mo>&#x2062;</mo>        <msup>         <mi>e</mi>         <mrow>          <mo>-</mo>          <mrow>           <munderover>            <mo>&#x2211;</mo>            <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">             <mrow>              <mi>i</mi>              <mo>=</mo>              <mn>1</mn>             </mrow>            </mpadded>            <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">             <mn>3</mn>            </mpadded>           </munderover>           <mpadded width="1.07692em" lspace="-1.07692em" depth="0ex" height="0ex">            <mfrac>             <msup>              <mrow>               <mo>(</mo>               <mrow>                <mrow>                 <msub>                  <mi>x</mi>                  <mi>fi</mi>                 </msub>                 <mo>(</mo>                 <mrow>                  <msub>                   <mi>t</mi>                   <mi>f</mi>                  </msub>                  <mo>-</mo>                  <mn>1</mn>                 </mrow>                 <mo>)</mo>                </mrow>                <mo>-</mo>                <mrow>                 <msub>                  <mi>c</mi>                  <mi>fij</mi>                 </msub>                 <mo>(</mo>                 <msub>                  <mi>t</mi>                  <mi>f</mi>                 </msub>                 <mo>)</mo>                </mrow>               </mrow>               <mo>)</mo>              </mrow>              <mn>2</mn>             </msup>             <mrow>              <mn>2</mn>              <mo>&#x2062;</mo>              <mrow>               <msubsup>                <mi>&#x3c3;</mi>                <mi>fij</mi>                <mn>2</mn>               </msubsup>               <mo>(</mo>               <msub>                <mi>t</mi>                <mi>f</mi>               </msub>               <mo>)</mo>              </mrow>             </mrow>            </mfrac>           </mpadded>          </mrow>         </mrow>        </msup>       </mrow>      </mrow>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <msup>        <mi>e</mi>        <mrow>         <mo>-</mo>         <mrow>          <munderover>           <mo>&#x2211;</mo>           <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">            <mrow>             <mi>i</mi>             <mo>=</mo>             <mn>1</mn>            </mrow>           </mpadded>           <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">            <mn>3</mn>           </mpadded>          </munderover>          <mpadded width="0.846154em" lspace="-0.846154em" depth="0ex" height="0ex">           <mfrac>            <msup>             <mrow>              <mo>(</mo>              <mrow>               <mrow>                <msub>                 <mi>x</mi>                 <mi>fi</mi>                </msub>                <mo>(</mo>                <mrow>                 <msub>                  <mi>t</mi>                  <mi>f</mi>                 </msub>                 <mo>-</mo>                 <mn>1</mn>                </mrow>                <mo>)</mo>               </mrow>               <mo>-</mo>               <mrow>                <msub>                 <mi>c</mi>                 <mi>fij</mi>                </msub>                <mo>(</mo>                <msub>                 <mi>t</mi>                 <mi>f</mi>                </msub>                <mo>)</mo>               </mrow>              </mrow>              <mo>)</mo>             </mrow>             <mn>2</mn>            </msup>            <mrow>             <mn>2</mn>             <mo>&#x2062;</mo>             <mrow>              <msubsup>               <mi>&#x3c3;</mi>               <mi>fij</mi>               <mn>2</mn>              </msubsup>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>          </mpadded>         </mrow>        </mrow>       </msup>      </mrow>     </mfrac>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>1</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0017" num="0000">where x<sub>f</sub>(t<sub>f&#x2212;1</sub>) is the ith input of the fast sampling fuzzy neural network at time t<sub>f</sub>, i=1, 2, 3, w<sub>fj</sub>(t<sub>f</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the fast sampling fuzzy neural network at time t<sub>f</sub>, w<sub>fj</sub>(t<sub>0</sub>) is randomly assigned within [0, 1], j=1, 2, 3, 4, 5, 6, t<sub>0 </sub>is the initial instant, c<sub>fij</sub>(t<sub>f</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f</sub>, &#x3c3;<sub>fij</sub>(t<sub>0</sub>) is randomly assigned within [0,1], &#x3c3;<sub>fij</sub>(t<sub>f</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f</sub>, and &#x3c3;<sub>fij</sub>(t<sub>0</sub>) is randomly assigned within [0,1];</p><p id="p-0018" num="0015">(4) a slow sampling fuzzy neural network is designed to predict nitrate nitrogen concentration with time scale &#x3b6;, which is as follows:</p><p id="p-0019" num="0016">The input of the slow sampling fuzzy neural network is x<sub>s</sub>(t<sub>&#x3b7;</sub>)=[x<sub>s1</sub>(t<sub>&#x3b7;&#x2212;1</sub>), x<sub>s2</sub>(t<sub>&#x3b7;&#x2212;1</sub>), x<sub>s3</sub>(t<sub>&#x3b7;&#x2212;1</sub>)]<sup>T</sup>, and the output of the slow sampling fuzzy neural network is the predicted value of nitrate nitrogen concentration &#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>) at time t<sub>&#x3b7;</sub>, the output is defined as follows</p><p id="p-0020" num="0000"><maths id="MATH-US-00002" num="00002"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <msub>       <mover accent="true">        <mi>y</mi>        <mi>&#x2c6;</mi>       </mover>       <mi>f</mi>      </msub>      <mo>(</mo>      <msub>       <mi>t</mi>       <mi>&#x3b7;</mi>      </msub>      <mo>)</mo>     </mrow>     <mo>=</mo>     <mfrac>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <mrow>        <mrow>         <msub>          <mi>&#x3c9;</mi>          <mi>sj</mi>         </msub>         <mo>(</mo>         <msub>          <mi>t</mi>          <mi>&#x3b7;</mi>         </msub>         <mo>)</mo>        </mrow>        <mo>&#x2062;</mo>        <msup>         <mi>e</mi>         <mrow>          <mo>-</mo>          <mrow>           <munderover>            <mo>&#x2211;</mo>            <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">             <mrow>              <mi>i</mi>              <mo>=</mo>              <mn>1</mn>             </mrow>            </mpadded>            <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">             <mn>3</mn>            </mpadded>           </munderover>           <mpadded width="0.846154em" lspace="-0.846154em" depth="0ex" height="0ex">            <mfrac>             <msup>              <mrow>               <mo>(</mo>               <mrow>                <mrow>                 <msub>                  <mi>x</mi>                  <mi>si</mi>                 </msub>                 <mo>(</mo>                 <mrow>                  <msub>                   <mi>t</mi>                   <mi>&#x3b7;</mi>                  </msub>                  <mo>-</mo>                  <mn>1</mn>                 </mrow>                 <mo>)</mo>                </mrow>                <mo>-</mo>                <mrow>                 <msub>                  <mi>c</mi>                  <mi>sij</mi>                 </msub>                 <mo>(</mo>                 <msub>                  <mi>t</mi>                  <mi>&#x3b7;</mi>                 </msub>                 <mo>)</mo>                </mrow>               </mrow>               <mo>)</mo>              </mrow>              <mn>2</mn>             </msup>             <mrow>              <mn>2</mn>              <mo>&#x2062;</mo>              <mrow>               <msubsup>                <mi>&#x3c3;</mi>                <mi>sij</mi>                <mn>2</mn>               </msubsup>               <mo>(</mo>               <msub>                <mi>t</mi>                <mi>&#x3b7;</mi>               </msub>               <mo>)</mo>              </mrow>             </mrow>            </mfrac>           </mpadded>          </mrow>         </mrow>        </msup>       </mrow>      </mrow>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <msup>        <mi>e</mi>        <mrow>         <mo>-</mo>         <mrow>          <munderover>           <mo>&#x2211;</mo>           <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">            <mrow>             <mi>i</mi>             <mo>=</mo>             <mn>1</mn>            </mrow>           </mpadded>           <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">            <mn>3</mn>           </mpadded>          </munderover>          <mpadded width="0.923077em" lspace="-0.923077em" depth="0ex" height="0ex">           <mfrac>            <msup>             <mrow>              <mo>(</mo>              <mrow>               <mrow>                <msub>                 <mi>x</mi>                 <mi>si</mi>                </msub>                <mo>(</mo>                <mrow>                 <msub>                  <mi>t</mi>                  <mi>&#x3b7;</mi>                 </msub>                 <mo>-</mo>                 <mn>1</mn>                </mrow>                <mo>)</mo>               </mrow>               <mo>-</mo>               <mrow>                <msub>                 <mi>c</mi>                 <mi>sij</mi>                </msub>                <mo>(</mo>                <msub>                 <mi>t</mi>                 <mi>&#x3b7;</mi>                </msub>                <mo>)</mo>               </mrow>              </mrow>              <mo>)</mo>             </mrow>             <mn>2</mn>            </msup>            <mrow>             <mn>2</mn>             <mo>&#x2062;</mo>             <mrow>              <msubsup>               <mi>&#x3c3;</mi>               <mi>sij</mi>               <mn>2</mn>              </msubsup>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>&#x3b7;</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>          </mpadded>         </mrow>        </mrow>       </msup>      </mrow>     </mfrac>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>2</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0021" num="0000">where x<sub>si</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the ith input of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, w<sub>sj</sub>(t<sub>&#x3b7;</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, w<sub>sj</sub>(t<sub>0</sub>) is randomly assigned within [0, 1], &#x3c3;<sub>sij</sub>(t<sub>&#x3b7;</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, c<sub>sij</sub>(t<sub>0</sub>) is randomly assigned within [0,1], &#x3c3;<sub>sij</sub>(t<sub>&#x3b7;</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, and &#x3c3;<sub>sij</sub>(t<sub>0</sub>) is randomly assigned within [0,1];</p><p id="p-0022" num="0017">a dataset &#x3a9; whose time scale is &#x3b6; is constructed as follows, when t<sub>s</sub>&#x2264;t<sub>&#x3b7;</sub>&#x3c;t<sub>s+1</sub>:</p><p id="p-0023" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i><sub>s1</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)=<i>u</i><sub>s1</sub>(<i>t</i><sub>s</sub>)&#x2003;&#x2003;(3)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0024" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i><sub>s2</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)=<i>u</i><sub>s2</sub>(<i>t</i><sub>s</sub>)&#x2003;&#x2003;(4)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0025" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>y</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)=<i>y</i><sub>s</sub>(<i>t</i><sub>s</sub>)+<i>T</i><sub>s</sub>(<i>y</i><sub>s</sub>(<i>t</i><sub>s+1</sub>)&#x2212;<i>y</i><sub>s</sub>(<i>t</i><sub>s</sub>))/<i>t</i><sub>&#x3b7;</sub>&#x2003;&#x2003;(5)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0026" num="0000">where u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) is the virtual value of aeration rate at time t<sub>&#x3b7;</sub>, u<sub>s1</sub>(t<sub>s</sub>) is the actual value of aeration rate at time t<sub>s</sub>, u<sub>s2</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) is the virtual value of internal reflux at time t<sub>&#x3b7;</sub>, u<sub>s2</sub>(t<sub>s</sub>) is the actual value is of internal reflux at time t<sub>s</sub>, y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) is the virtual estimated value of nitrate nitrogen concentration at time t<sub>&#x3b7;</sub>, y<sub>s</sub>(t<sub>s</sub>) is the actual value of the nitrate nitrogen concentration converted by the programmable logic controller at time t<sub>s</sub>, y<sub>s</sub>(t<sub>s+1</sub>) is the actual value of the nitrate nitrogen concentration converted by the programmable logic controller at time t<sub>s+1</sub>; the dataset &#x3a9; is composed of u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>), u<sub>s2</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>), and y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>);</p><p id="p-0027" num="0018">The dataset &#x3a9; is used to pre-train the slow sampling fuzzy neural network offline, and the training input is x<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)=[y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>), u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>), u<sub>s2</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>)]<sup>T</sup>, y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>) is the nitrate nitrogen concentration at time t<sub>&#x3b7;&#x2212;1 </sub>in &#x3a9;, u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>) is the aeration rate at time t<sub>&#x3b7;&#x2212;1 </sub>in &#x3a9;, u<sub>s2 </sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the internal reflux at time t<sub>&#x3b7;&#x2212;1 </sub>in &#x3a9;, the training output is the prediction value of nitrate nitrogen concentration &#x177;<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) at time t<sub>&#x3b7;</sub>; using the error between nitrate nitrogen concentration value in dataset &#x3a9; and predicted value E<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)=&#xbd;[y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)&#x2212;&#x177;<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)]<sup>2 </sup>at time t<sub>&#x3b7;</sub>, correct parameters of slow sampling fuzzy neural network:</p><p id="p-0028" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(6)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0029" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2<i>E</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(7)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0030" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(8)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0031" num="0000">where w<sub>sj</sub>(t<sub>&#x3b7;+1</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;+1</sub>, c<sub>sij</sub>(t<sub>&#x3b7;+1</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;+1</sub>, &#x3c3;<sub>sij</sub>(t<sub>&#x3b7;+1</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;+1</sub>;</p><p id="p-0032" num="0019">(5) The multi-time scale model predictive control method is designed to control the dissolved oxygen concentration and nitrate nitrogen concentration in time scale T<sub>f</sub>, specifically:</p><p id="p-0033" num="0020">{circle around (1)} set s=1, f=1, &#x3b7;=1;</p><p id="p-0034" num="0021">{circle around (2)} according to the sampling information converted by programmable logic controller, predict nitrate nitrogen concentration at time t<sub>&#x3b7;</sub> using slow sampling fuzzy neural network; the inputs of the slow sampling fuzzy neural network are as follows: x<sub>s1</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the actual value of nitrate nitrogen concentration y<sub>s</sub>(t<sub>&#x3b7;&#x2212;1</sub>) at time t<sub>&#x3b7;&#x2212;1</sub>, x<sub>s2</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the aeration rate u<sub>1</sub>(t<sub>&#x3b7;&#x2212;1</sub>) at time t<sub>&#x3b7;&#x2212;1</sub>, x<sub>s3</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the internal reflux u<sub>2</sub>(t<sub>&#x3b7;&#x2212;1</sub>) at time t<sub>&#x3b7;&#x2212;1</sub>; the output of the slow sampling fuzzy neural network is the prediction value of nitrate nitrogen concentration &#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>) at time t<sub>&#x3b7;</sub>;</p><p id="p-0035" num="0022">{circle around (3)} if t<sub>&#x3b7;</sub>=t<sub>f</sub>, set &#x177;<sub>s</sub>(t<sub>f</sub>)=f<sub>s</sub>(t<sub>&#x3b7;</sub>), where &#x177;<sub>s</sub>(t<sub>f</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f</sub>, go to step {circle around (6)} after performing step {circle around (4)}; if t<sub>&#x3b7;</sub>&#x2260;t<sub>f</sub>, go to step {circle around (6)} after performing step {circle around (5)};</p><p id="p-0036" num="0023">{circle around (4)} if t<sub>&#x3b7;</sub>=t<sub>s</sub>, increase the value of s by 1, update the parameters of the slow sampling fuzzy neural network by the error between the predicted value and the actual value of nitrate nitrogen concentration E<sub>s</sub>(t<sub>&#x3b7;</sub>)=&#xbd;[y<sub>s</sub>(t<sub>s</sub>)&#x2212;&#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>)]<sup>2</sup>:</p><p id="p-0037" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(9)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0038" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(10)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0039" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(11)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0040" num="0000">if t<sub>&#x3b7;</sub>&#x2260;t<sub>s</sub>, the parameters of slow sampling fuzzy neural network are not updated;</p><p id="p-0041" num="0024">{circle around (5)} set y<sub>s</sub>(t<sub>&#x3b7;</sub>)=&#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>), u<sub>1</sub>(t<sub>&#x3b7;</sub>)=u<sub>1</sub>(t<sub>f</sub>), u<sub>2</sub>(t<sub>&#x3b7;</sub>)=u<sub>2</sub>(t<sub>f</sub>), increase the value of &#x3b7; by 1, go to step {circle around (2)}, where y<sub>s</sub>(t<sub>&#x3b7;</sub>) is the actual nitrate nitrogen concentration converted by the programmable logic controller at time t<sub>&#x3b7;</sub>, u<sub>1</sub>(t<sub>&#x3b7;</sub>) is the aeration rate at time t<sub>&#x3b7;</sub>, u<sub>2</sub>(t<sub>&#x3b7;</sub>) is the internal reflux at time t<sub>&#x3b7;</sub>, u<sub>1</sub>(t<sub>f</sub>) is the aeration rate at time t<sub>f</sub>, u<sub>2</sub>(t<sub>f</sub>) is the internal reflux at time t<sub>f</sub>;</p><p id="p-0042" num="0025">{circle around (6)} predict dissolved oxygen concentration at time t<sub>f </sub>by the fast sampling fuzzy neural network; the inputs of the fast sampling fuzzy neural network are as follows: x<sub>f1</sub>(t<sub>f&#x2212;1</sub>) is the actual value of dissolved oxygen concentration &#x177;<sub>f</sub>(t<sub>f&#x2212;1</sub>) converted by the programmable logic controller at time t<sub>f&#x2212;1</sub>, x<sub>f2</sub>(t<sub>f&#x2212;1</sub>) is the aeration rate u<sub>1</sub>(t<sub>f&#x2212;1</sub>) at time t<sub>f&#x2212;1</sub>, x<sub>f3</sub>(t<sub>f&#x2212;1</sub>) is the internal reflux u<sub>2</sub>(t<sub>f&#x2212;1</sub>) at time t<sub>f&#x2212;1</sub>; the output of the fast sampling fuzzy neural network is the prediction value of dissolved oxygen concentration &#x177;<sub>f</sub>(t<sub>f</sub>) at time t<sub>f</sub>; update the parameters of the fast sampling fuzzy neural network by the error between the predicted value and the actual value of dissolved oxygen concentration E<sub>f</sub>(t<sub>f</sub>)=&#xbd;[y<sub>f</sub>(t<sub>f</sub>)&#x2212;&#x177;<sub>f</sub>(t<sub>f</sub>)]<sup>2</sup>:</p><p id="p-0043" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>w</i><sub>fj</sub>(<i>t</i><sub>f+1</sub>)=<i>w</i><sub>fj</sub>(<i>t</i><sub>f</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>f</sub>(<i>t</i><sub>f</sub>)/&#x2202;<i>w</i><sub>fj</sub>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(12)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0044" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>fij</sub>(<i>t</i><sub>f+1</sub>)=<i>c</i><sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>f</sub>(<i>t</i><sub>f</sub>)/&#x2202;<i>c</i><sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(13)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0045" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c3;<sub>fij</sub>(<i>t</i><sub>f+1</sub>)=&#x3c3;<sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>f</sub>(<i>t</i><sub>f</sub>)/&#x2202;&#x3c3;<sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(14)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0046" num="0000">where w<sub>fj</sub>(t<sub>f+1</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the slow sampling fuzzy neural network at time t<sub>f+1</sub>, c<sub>fij</sub>(t<sub>f+1</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f+1</sub>, &#x3c3;<sub>fij</sub>(t<sub>f+1</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f+1</sub>;</p><p id="p-0047" num="0026">{circle around (7)} design an objective function of multi-time scale model predictive control to track the set-points of nitrate nitrogen concentration and dissolved oxygen concentration, and calculate the control law at time t<sub>f</sub>:</p><p id="p-0048" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>J</i>(<i>t</i><sub>f</sub>)=0.25[[<i>r</i><sub>f</sub>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>f</sub>(<i>t</i><sub>f</sub>)]<sup>T</sup>[<i>r</i><sub>f</sub>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>f</sub>(<i>t</i><sub>f</sub>)]+&#x394;<i>u</i>(<i>t</i><sub>f</sub>)<sup>T</sup><i>&#x394;u</i>(<i>t</i><sub>f</sub>)]+0.45[<i>r</i><sub>s</sub>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>s</sub>(<i>t</i><sub>f</sub>)]<sup>T</sup>[<i>r</i><sub>s</sub>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>s</sub>(<i>t</i><sub>f</sub>)]+&#x394;<i>u</i>(<i>t</i><sub>f</sub>)<sup>T</sup><i>&#x394;u</i>(<i>t</i><sub>f</sub>)&#x2003;&#x2003; (15)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0049" num="0000">where r<sub>f</sub>(t<sub>f</sub>)=[r<sub>f</sub>(t<sub>f+1</sub>), r<sub>f</sub>(t<sub>f+2</sub>), r<sub>f</sub>(t<sub>f+3</sub>)]<sup>T </sup>is the set-point of dissolved oxygen concentration, r<sub>f</sub>(t<sub>f+1</sub>)=2 mg/l represents the set-point of dissolved oxygen concentration at time t<sub>f+1</sub>, r<sub>f</sub>(t<sub>f+2</sub>)=2 mg/l represents the set-point of dissolved oxygen concentration at time t<sub>f+2</sub>, r<sub>f</sub>(t<sub>f+3</sub>)=2 mg/l represents the set-point of dissolved oxygen concentration at time t<sub>f+3</sub>; &#x177;<sub>f</sub>(t<sub>f</sub>)=[&#x177;<sub>f</sub>(t<sub>f+1</sub>), &#x177;<sub>f</sub>(t<sub>f+2</sub>), &#x177;<sub>f</sub>(t<sub>f+3</sub>)]<sup>T </sup>is the prediction output of the fast sampling fuzzy neural network, &#x177;<sub>f</sub>(t<sub>f&#x2212;1</sub>) is the prediction value of dissolved oxygen concentration at time t<sub>f+1</sub>, &#x177;<sub>f</sub>(t<sub>f+2</sub>) is the prediction value of dissolved oxygen concentration at time t<sub>f+2</sub>, &#x177;<sub>f</sub>(t<sub>f+3</sub>) is the prediction value of dissolved oxygen concentration at time t<sub>f+3</sub>; r<sub>s</sub>(t<sub>f</sub>)=[r<sub>s</sub>(t<sub>f+1</sub>), r<sub>s</sub>(t<sub>f+2</sub>), r<sub>s</sub>(t<sub>f+3</sub>)]<sup>T </sup>is the set-point of nitrate nitrogen concentration; r<sub>s</sub>(t<sub>f+1</sub>)=1 mg/l represents the set-point of nitrate nitrogen concentration at time t<sub>f+1</sub>, r<sub>s</sub>(t<sub>f+2</sub>)=1 mg/l represents the set-point of nitrate nitrogen concentration at time t<sub>f+2</sub>, r<sub>s</sub>(t<sub>f+3</sub>)=1 mg/l represents the set-point of nitrate nitrogen concentration at time t<sub>f+3</sub>; &#x177;<sub>s</sub>(t<sub>s</sub>)=[&#x177;<sub>s</sub>(t<sub>s+1</sub>), &#x177;<sub>s</sub>(t<sub>s+2</sub>), &#x177;<sub>s</sub>(t<sub>s+3</sub>)]<sup>T </sup>is the prediction output of slow sampling fuzzy neural network, &#x177;<sub>s</sub>(t<sub>f&#x2212;1</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f+1</sub>, &#x177;<sub>s</sub>(t<sub>f+2</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f+2</sub>, &#x177;<sub>s</sub>(t<sub>f+3</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f+3</sub>; &#x394;u(t<sub>f</sub>)=[&#x394;u<sub>1</sub>(t<sub>f</sub>), &#x394;u<sub>2</sub>(t<sub>f</sub>)]<sup>T </sup>is the incremental control moves at time t<sub>f</sub>, &#x394;u<sub>1</sub>(t<sub>f</sub>) is the aeration rate adjustment amount at time t<sub>f</sub>, &#x394;u<sub>2</sub>(t<sub>f</sub>) is the internal reflux adjustment amount at time t<sub>f</sub>, where</p><p id="p-0050" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>u</i>(<i>t</i><sub>f</sub>)=<i>u</i>(<i>t</i><sub>f+1</sub>)&#x2212;<i>u</i>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(16)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0051" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>|&#x394;<i>u</i>(<i>t</i><sub>f</sub>)|&#x2264;&#x394;<i>u</i><sub>max</sub>&#x2003;&#x2003;(17)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0052" num="0000">u(t<sub>f</sub>)=[u<sub>1</sub>(t<sub>f</sub>), u<sub>2</sub>(t<sub>f</sub>)]<sup>T </sup>is control vector converting into analog signal through programmable logic controller and transmitting to variable frequency driver at time t<sub>f</sub>, u(t<sub>f&#x2212;1</sub>)=[u<sub>1</sub>(t<sub>f&#x2212;1</sub>), u<sub>2</sub>(t<sub>f&#x2212;1</sub>)]<sup>T </sup>is control vector converting into analog signal through programmable logic controller and transmitting to variable frequency driver at time t<sub>f+1</sub>, u<sub>1</sub>(t<sub>f&#x2212;1</sub>) is the aeration rate at time t<sub>f+1</sub>, u<sub>2</sub>(t<sub>f+1</sub>) is the internal reflux at time t<sub>f+1</sub>; &#x394;u<sub>max</sub>=[&#x394;K<sub>L</sub>a<sub>max</sub>, &#x394;Q<sub>amax</sub>]<sup>T </sup>is the maximum adjustment vector allowed by the controller, &#x394;K<sub>L</sub>a<sub>max</sub>=100 L/min is the maximum aeration adjustment amount, &#x394;Q<sub>amax</sub>=50000 L/min is the maximum internal reflux adjustment amount, &#x394;u<sub>max </sub>is set through the blower and internal reflux valve in the control system equipment;</p><p id="p-0053" num="0027">an aeration rate and internal reflux adjustment vector are calculated by minimizing Eq.(15):</p><p id="p-0054" num="0000"><maths id="MATH-US-00003" num="00003"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <mrow>       <mi>u</mi>       <mo>&#x2061;</mo>       <mo>(</mo>       <msub>        <mi>t</mi>        <mi>f</mi>       </msub>       <mo>)</mo>      </mrow>     </mrow>     <mo>=</mo>     <mrow>      <mo>(</mo>      <mrow>       <mrow>        <mn>0.</mn>        <mn>4</mn>        <mo>&#x2062;</mo>        <mrow>         <msup>          <mrow>           <mo>(</mo>           <mfrac>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <msub>               <mover accent="true">                <mi>y</mi>                <mi>&#x2c6;</mi>               </mover>               <mi>f</mi>              </msub>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <mi>u</mi>              <mo>&#x2061;</mo>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>           <mo>)</mo>          </mrow>          <mi>T</mi>         </msup>         <mo>[</mo>         <mrow>          <mrow>           <msub>            <mi>r</mi>            <mi>f</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>          <mo>-</mo>          <mrow>           <msub>            <mover accent="true">             <mi>y</mi>             <mi>&#x2c6;</mi>            </mover>            <mi>f</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>         </mrow>         <mo>]</mo>        </mrow>       </mrow>       <mo>+</mo>       <mrow>        <mrow>         <mn>0</mn>         <mo>.</mo>         <mn>0</mn>        </mrow>        <mo>&#x2062;</mo>        <mn>8</mn>        <mo>&#x2062;</mo>        <mrow>         <msup>          <mrow>           <mo>(</mo>           <mfrac>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <msub>               <mover accent="true">                <mi>y</mi>                <mi>&#x2c6;</mi>               </mover>               <mi>s</mi>              </msub>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <mi>u</mi>              <mo>&#x2061;</mo>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>           <mo>)</mo>          </mrow>          <mi>T</mi>         </msup>         <mo>[</mo>         <mrow>          <mrow>           <msub>            <mi>r</mi>            <mi>s</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>          <mo>-</mo>          <mrow>           <msub>            <mover accent="true">             <mi>y</mi>             <mi>&#x2c6;</mi>            </mover>            <mi>s</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>         </mrow>         <mo>]</mo>        </mrow>       </mrow>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>18</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0055" num="0000">adjust the aeration rate and internal reflux at time t<sub>f</sub>:</p><p id="p-0056" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i>(<i>t</i><sub>f+1</sub>)=<i>u</i>(<i>t</i><sub>f</sub>)+&#x394;<i>u</i>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(19)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0057" num="0028">{circle around (8)} if f&#x2264;1000, increase the value of f by 1, increase the value of &#x3b7; by 1, go to step {circle around (2)}; if f&#x3e;1000, end the cycle;</p><p id="p-0058" num="0029">(6) the concentration of nitrate nitrogen and dissolved oxygen is controlled by u(t<sub>f</sub>), and u(t<sub>f</sub>)=[u<sub>1</sub>(t<sub>f</sub>), u<sub>2</sub>(t<sub>f</sub>)]<sup>T </sup>is transferred to programmable logic controller for digital/analog conversion to obtain U(t<sub>f</sub>)=[U<sub>1</sub>(t<sub>f</sub>), U<sub>2</sub>(t<sub>f</sub>)]<sup>T</sup>, which is the input of variable-frequency drive, the variable-frequency drive changes the working power frequency of motor to control the aeration pump and electronic valve, then, the aeration rate and internal reflux are controlled, the output of the system is the actual value of nitrate nitrogen concentration and dissolved oxygen concentration.</p><p id="p-0059" num="0030">The Novelties of this Patent Contain:</p><p id="p-0060" num="0031">(1) Aiming at the problem that the control variables of wastewater treatment process have different time scales, a multi-time scale model predictive control method is established to control the concentration of dissolved oxygen and nitrate nitrogen with fast time scale.</p><p id="p-0061" num="0032">(2) To deal with the strong nonlinearity of wastewater treatment process, two fuzzy neural networks with different time scales are designed to model the concentration of dissolved oxygen and nitrate nitrogen, which solves the problem that the nonlinear system is difficult to model and obtains the prediction outputs of dissolved oxygen concentration and nitrate nitrogen concentration in the fast time scale.</p><p id="p-0062" num="0033">(3) The invention introduced a gradient descent algorithm to solve the above multiobjective optimization problem, so as to calculate the control law.</p><p id="p-0063" num="0034">(4) The multi-time scale model predictive control method in this invention has the characteristics of high precision, low energy consumption, strong stability, etc.</p><p id="p-0064" num="0035">The invention adopts the model predictive control method to solve the control law in the fast time scale, realizes the accurate on-line control of dissolved oxygen concentration and nitrate nitrogen concentration, and has the characteristics of high precision, high efficiency, strong stability, etc;</p><p id="p-0065" num="0036">Attention: for convenience of description, the invention only adopt the control of dissolved oxygen concentration and nitrate nitrogen concentration. The invention can also be used for the control of ammonia nitrogen in wastewater treatment process, etc. As long as the principle of the invention is adopted for control, it shall be the scope of the invention.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">DESCRIPTION OF DRAWINGS</heading><p id="p-0066" num="0037"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is diagram of the multi-time scale model predictive control system of wastewater treatment process.</p><p id="p-0067" num="0038"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a control structure diagram of the invention.</p><p id="p-0068" num="0039"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is an algorithm diagram of the invention.</p><p id="p-0069" num="0040"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is the time diagram of the invention.</p><p id="p-0070" num="0041"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is the result diagram of the dissolved oxygen concentration control in this invention.</p><p id="p-0071" num="0042"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is the error diagram of the dissolved oxygen concentration control result in this invention.</p><p id="p-0072" num="0043"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is the result diagram of nitrate nitrogen concentration control in this invention.</p><p id="p-0073" num="0044"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is the error diagram of the nitrate nitrogen concentration control result in this invention.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading><p id="p-0074" num="0045">1. A multi-time scale model predictive control method of wastewater treatment process, comprising the following steps:</p><p id="p-0075" num="0046">(1) the multi-time scale model predictive control system for wastewater treatment process control comprising a set of measuring devices arranged to obtain a dataset, measuring devices include dissolved oxygen detector, nitrate nitrogen detector, the dataset comprises a plurality of process variables related to a parameter of wastewater treatment process; a programmable logic controller arranged to perform digital/analog conversion and analog/digital conversion; a variable-frequency drive arranged to control the air-blower and electronic valve by changing the working power frequency of motor; an air-blower arranged to provide the required oxygen to the microorganisms in the wastewater treatment process; an electronic valve arranged to adjust internal return flow; a multi-time scale model predictive control module arranged to calculate the control law to track the dissolved oxygen concentration and nitrate nitrogen concentration in wastewater treatment process with different time scales; the multi-time scale model predictive control module comprising two fuzzy neural network to predict the system outputs, a time scale conversion mechanism to unify the prediction time scales to fast time scale, and an optimization control module to calculate the control law;</p><p id="p-0076" num="0047">(2) the time scales of dissolved oxygen concentration and nitrate nitrogen concentration in wastewater treatment process are different, specifically:</p><p id="p-0077" num="0048">T<sub>f </sub>is the sampling interval of dissolved oxygen concentration, T<sub>f</sub>&#x2208;[6, 10] is a positive integer in minutes, t<sub>f</sub>=fT<sub>f </sub>represents the sampling instant of dissolved oxygen concentration, f is the number of sampling steps of dissolved oxygen concentration, and f&#x2208;[1, 1000] is a positive integer;</p><p id="p-0078" num="0049">T<sub>s </sub>is the sampling interval of nitrate nitrogen concentration, T<sub>s</sub>&#x2208;[12, 20] is a positive integer in minutes, t<sub>s</sub>=sT<sub>s </sub>represents the sampling instant of nitrate nitrogen concentration, s is the number of sampling steps of nitrate nitrogen concentration, and s&#x2208;[1, 400] is a positive integer;</p><p id="p-0079" num="0050">&#x3b6; is the maximum common divisor of T<sub>f </sub>and T<sub>s</sub>, t<sub>&#x3b7;</sub>=&#x3b7;&#x3b6; is the prediction instant of slow sampling fuzzy neural network, &#x3b7; is the number of prediction steps of slow sampling fuzzy neural network, &#x3b7;&#x2208;[1, 2000] is a positive integer;</p><p id="p-0080" num="0051">(3) a fast sampling fuzzy neural network is designed to predict dissolved oxygen concentration with time scale T<sub>f</sub>, which is as follows:</p><p id="p-0081" num="0052">the input of the fast sampling fuzzy neural network is x<sub>f</sub>(t<sub>f</sub>)=[x<sub>f1</sub>(t<sub>f&#x2212;1</sub>), x<sub>f2</sub>(t<sub>f&#x2212;1</sub>), x<sub>f3</sub>(t<sub>f&#x2212;1</sub>)]<sup>T</sup>, T is the transposition of the matrix, and the output of the fast sampling fuzzy neural network is the predicted value of dissolved oxygen concentration &#x177;<sub>f</sub>(t<sub>f</sub>) at time t<sub>f</sub>, the output is defined as follows</p><p id="p-0082" num="0000"><maths id="MATH-US-00004" num="00004"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <msub>       <mover accent="true">        <mi>y</mi>        <mi>&#x2c6;</mi>       </mover>       <mi>f</mi>      </msub>      <mo>&#x2062;</mo>      <mrow>       <mo>(</mo>       <msub>        <mi>t</mi>        <mi>f</mi>       </msub>       <mo>)</mo>      </mrow>     </mrow>     <mo>=</mo>     <mfrac>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <mrow>        <mrow>         <msub>          <mi>w</mi>          <mi>fj</mi>         </msub>         <mo>(</mo>         <msub>          <mi>t</mi>          <mi>f</mi>         </msub>         <mo>)</mo>        </mrow>        <mo>&#x2062;</mo>        <msup>         <mi>e</mi>         <mrow>          <mo>-</mo>          <mrow>           <munderover>            <mo>&#x2211;</mo>            <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">             <mrow>              <mi>i</mi>              <mo>=</mo>              <mn>1</mn>             </mrow>            </mpadded>            <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">             <mn>3</mn>            </mpadded>           </munderover>           <mpadded width="1.07692em" lspace="-1.07692em" depth="0ex" height="0ex">            <mfrac>             <msup>              <mrow>               <mo>(</mo>               <mrow>                <mrow>                 <msub>                  <mi>x</mi>                  <mi>fi</mi>                 </msub>                 <mo>(</mo>                 <mrow>                  <msub>                   <mi>t</mi>                   <mi>f</mi>                  </msub>                  <mo>-</mo>                  <mn>1</mn>                 </mrow>                 <mo>)</mo>                </mrow>                <mo>-</mo>                <mrow>                 <msub>                  <mi>c</mi>                  <mi>fij</mi>                 </msub>                 <mo>(</mo>                 <msub>                  <mi>t</mi>                  <mi>f</mi>                 </msub>                 <mo>)</mo>                </mrow>               </mrow>               <mo>)</mo>              </mrow>              <mn>2</mn>             </msup>             <mrow>              <mn>2</mn>              <mo>&#x2062;</mo>              <mrow>               <msubsup>                <mi>&#x3c3;</mi>                <mi>fij</mi>                <mn>2</mn>               </msubsup>               <mo>(</mo>               <msub>                <mi>t</mi>                <mi>f</mi>               </msub>               <mo>)</mo>              </mrow>             </mrow>            </mfrac>           </mpadded>          </mrow>         </mrow>        </msup>       </mrow>      </mrow>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <msup>        <mi>e</mi>        <mrow>         <mo>-</mo>         <mrow>          <munderover>           <mo>&#x2211;</mo>           <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">            <mrow>             <mi>i</mi>             <mo>=</mo>             <mn>1</mn>            </mrow>           </mpadded>           <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">            <mn>3</mn>           </mpadded>          </munderover>          <mpadded width="0.846154em" lspace="-0.846154em" depth="0ex" height="0ex">           <mfrac>            <msup>             <mrow>              <mo>(</mo>              <mrow>               <mrow>                <msub>                 <mi>x</mi>                 <mi>fi</mi>                </msub>                <mo>(</mo>                <mrow>                 <msub>                  <mi>t</mi>                  <mi>f</mi>                 </msub>                 <mo>-</mo>                 <mn>1</mn>                </mrow>                <mo>)</mo>               </mrow>               <mo>-</mo>               <mrow>                <msub>                 <mi>c</mi>                 <mi>fij</mi>                </msub>                <mo>(</mo>                <msub>                 <mi>t</mi>                 <mi>f</mi>                </msub>                <mo>)</mo>               </mrow>              </mrow>              <mo>)</mo>             </mrow>             <mn>2</mn>            </msup>            <mrow>             <mn>2</mn>             <mo>&#x2062;</mo>             <mrow>              <msubsup>               <mi>&#x3c3;</mi>               <mi>fij</mi>               <mn>2</mn>              </msubsup>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>          </mpadded>         </mrow>        </mrow>       </msup>      </mrow>     </mfrac>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>20</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0083" num="0000">where x<sub>fi</sub>(t<sub>f&#x2212;1</sub>) is the ith input of the fast sampling fuzzy neural network at time t<sub>f</sub>, i=1, 2, 3, w<sub>fj</sub>(t<sub>f</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the fast sampling fuzzy neural network at time t<sub>f</sub>, w<sub>fj</sub>(t<sub>0</sub>) is randomly assigned within [0, 1], j=1, 2, 3, 4, 5, 6, t<sub>0 </sub>is the initial instant, c<sub>fij</sub>(t<sub>f</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f</sub>, c<sub>fij</sub>(t<sub>0</sub>) is randomly assigned within [0,1], &#x3c3;<sub>fij</sub>(t<sub>f</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f</sub>, and &#x3c3;<sub>fij</sub>(t<sub>0</sub>) is randomly assigned within [0,1];</p><p id="p-0084" num="0053">(4) a slow sampling fuzzy neural network is designed to predict nitrate nitrogen concentration with time scale &#x3b6;, which is as follows:</p><p id="p-0085" num="0054">The input of the slow sampling fuzzy neural network is x<sub>s</sub>(t<sub>&#x3b7;</sub>)=[x<sub>s1</sub>(t<sub>&#x3b7;&#x2212;1</sub>), x<sub>s2</sub>(t<sub>&#x3b7;&#x2212;1</sub>), x<sub>s3</sub>(t<sub>&#x3b7;&#x2212;1</sub>)]<sup>T</sup>, and the output of the slow sampling fuzzy neural network is the predicted value of nitrate nitrogen concentration &#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>) at time t<sub>&#x3b7;</sub>, the output is defined as follows</p><p id="p-0086" num="0000"><maths id="MATH-US-00005" num="00005"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <msub>       <mover accent="true">        <mi>y</mi>        <mi>&#x2c6;</mi>       </mover>       <mi>f</mi>      </msub>      <mo>&#x2062;</mo>      <mrow>       <mo>(</mo>       <msub>        <mi>t</mi>        <mi>&#x3b7;</mi>       </msub>       <mo>)</mo>      </mrow>     </mrow>     <mo>=</mo>     <mfrac>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <mrow>        <mrow>         <msub>          <mi>&#x3c9;</mi>          <mi>sj</mi>         </msub>         <mo>(</mo>         <msub>          <mi>t</mi>          <mi>&#x3b7;</mi>         </msub>         <mo>)</mo>        </mrow>        <mo>&#x2062;</mo>        <msup>         <mi>e</mi>         <mrow>          <mo>-</mo>          <mrow>           <munderover>            <mo>&#x2211;</mo>            <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">             <mrow>              <mi>i</mi>              <mo>=</mo>              <mn>1</mn>             </mrow>            </mpadded>            <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">             <mn>3</mn>            </mpadded>           </munderover>           <mpadded width="0.846154em" lspace="-0.846154em" depth="0ex" height="0ex">            <mfrac>             <msup>              <mrow>               <mo>(</mo>               <mrow>                <mrow>                 <msub>                  <mi>x</mi>                  <mi>si</mi>                 </msub>                 <mo>(</mo>                 <mrow>                  <msub>                   <mi>t</mi>                   <mi>&#x3b7;</mi>                  </msub>                  <mo>-</mo>                  <mn>1</mn>                 </mrow>                 <mo>)</mo>                </mrow>                <mo>-</mo>                <mrow>                 <msub>                  <mi>c</mi>                  <mi>sij</mi>                 </msub>                 <mo>(</mo>                 <msub>                  <mi>t</mi>                  <mi>&#x3b7;</mi>                 </msub>                 <mo>)</mo>                </mrow>               </mrow>               <mo>)</mo>              </mrow>              <mn>2</mn>             </msup>             <mrow>              <mn>2</mn>              <mo>&#x2062;</mo>              <mrow>               <msubsup>                <mi>&#x3c3;</mi>                <mi>sij</mi>                <mn>2</mn>               </msubsup>               <mo>(</mo>               <msub>                <mi>t</mi>                <mi>&#x3b7;</mi>               </msub>               <mo>)</mo>              </mrow>             </mrow>            </mfrac>           </mpadded>          </mrow>         </mrow>        </msup>       </mrow>      </mrow>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <msup>        <mi>e</mi>        <mrow>         <mo>-</mo>         <mrow>          <munderover>           <mo>&#x2211;</mo>           <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">            <mrow>             <mi>i</mi>             <mo>=</mo>             <mn>1</mn>            </mrow>           </mpadded>           <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">            <mn>3</mn>           </mpadded>          </munderover>          <mpadded width="0.923077em" lspace="-0.923077em" depth="0ex" height="0ex">           <mfrac>            <msup>             <mrow>              <mo>(</mo>              <mrow>               <mrow>                <msub>                 <mi>x</mi>                 <mi>si</mi>                </msub>                <mo>(</mo>                <mrow>                 <msub>                  <mi>t</mi>                  <mi>&#x3b7;</mi>                 </msub>                 <mo>-</mo>                 <mn>1</mn>                </mrow>                <mo>)</mo>               </mrow>               <mo>-</mo>               <mrow>                <msub>                 <mi>c</mi>                 <mi>sij</mi>                </msub>                <mo>(</mo>                <msub>                 <mi>t</mi>                 <mi>&#x3b7;</mi>                </msub>                <mo>)</mo>               </mrow>              </mrow>              <mo>)</mo>             </mrow>             <mn>2</mn>            </msup>            <mrow>             <mn>2</mn>             <mo>&#x2062;</mo>             <mrow>              <msubsup>               <mi>&#x3c3;</mi>               <mi>sij</mi>               <mn>2</mn>              </msubsup>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>&#x3b7;</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>          </mpadded>         </mrow>        </mrow>       </msup>      </mrow>     </mfrac>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>21</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0087" num="0000">where x<sub>si</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the ith input of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, w<sub>sj</sub>(t<sub>&#x3b7;</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, w<sub>sj</sub>(t<sub>0</sub>) is randomly assigned within [0, 1], c<sub>sij</sub>(t<sub>&#x3b7;</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, c<sub>sij</sub>(t<sub>0</sub>) is randomly assigned within [0,1], &#x3c3;<sub>sij</sub>(t<sub>&#x3b7;</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, and &#x3c3;<sub>sij</sub>(t<sub>0</sub>) is randomly assigned within [0,1];</p><p id="p-0088" num="0055">a dataset &#x3a9; whose time scale is &#x3b6; is constructed as follows, when t<sub>s</sub>&#x2264;t<sub>&#x3b7;</sub>&#x3c;t<sub>s+1</sub>.</p><p id="p-0089" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i><sub>s1</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)=<i>u</i><sub>s1</sub>(<i>t</i><sub>s</sub>)&#x2003;&#x2003;(22)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0090" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i><sub>s2</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)==<i>u</i><sub>s2</sub>(<i>t</i><sub>s</sub>)&#x2003;&#x2003;(23)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0091" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>y</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)=<i>y</i><sub>s</sub>(<i>t</i><sub>s</sub>)+<i>T</i><sub>s</sub>(<i>y</i><sub>s</sub>(<i>t</i><sub>s+1</sub>)&#x2212;<i>y</i><sub>s</sub>(<i>t</i><sub>s</sub>))/<i>t</i><sub>&#x3b7;</sub>&#x2003;&#x2003;(24)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0092" num="0000">where u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) is the virtual value of aeration rate at time t<sub>&#x3b7;</sub>, u<sub>s1</sub>(t<sub>s</sub>) is the actual value of aeration rate at time t<sub>s</sub>, u<sub>s2</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) is the virtual value of internal reflux at time t<sub>&#x3b7;</sub>, u<sub>s2</sub>(t<sub>s</sub>) is the actual value of internal reflux at time t<sub>s</sub>, y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) is the virtual estimated value of nitrate nitrogen concentration at time t<sub>&#x3b7;</sub>, y<sub>s</sub>(t<sub>s</sub>) is the actual value of the nitrate nitrogen concentration converted by the programmable logic controller at time t<sub>s</sub>, y<sub>s</sub>(t<sub>s+1</sub>) is the actual value of the nitrate nitrogen concentration converted by the programmable logic controller at time t<sub>s+1</sub>; the dataset &#x3a9; is composed of u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>), u<sub>s2</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>), and y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>);</p><p id="p-0093" num="0056">The dataset &#x3a9; is used to pre-train the slow sampling fuzzy neural network offline, and the training input is x<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)=[y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>), u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>), u<sub>s2</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>)]<sup>T</sup>, y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>) is the nitrate nitrogen concentration at time t<sub>&#x3b7;&#x2212;1 </sub>in &#x3a9;, u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>) is the aeration rate at time t<sub>&#x3b7;&#x2212;1 </sub>in &#x3a9;, u<sub>s2</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>) is the internal reflux at time t<sub>&#x3b7;&#x2212;1 </sub>in &#x3a9;, the training output is the prediction value of nitrate nitrogen concentration &#x177;<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) at time t<sub>&#x3b7;</sub>; using the error between nitrate nitrogen concentration value in dataset &#x3a9; and predicted value E<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)=&#xbd;[y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)&#x2212;&#x177;<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)]<sup>2 </sup>at time t<sub>&#x3b7;</sub>, correct parameters of slow sampling fuzzy neural network:</p><p id="p-0094" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(25)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0095" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(26)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0096" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(27)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0097" num="0000">where w<sub>sj</sub>(t<sub>&#x3b7;+1</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;+1</sub>, c<sub>sij</sub>(t<sub>&#x3b7;+1</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;+1</sub>, &#x3c3;<sub>sij</sub>(t<sub>&#x3b7;+1</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t+1;</p><p id="p-0098" num="0057">(5) The multi-time scale model predictive control method is designed to control the dissolved oxygen concentration and nitrate nitrogen concentration in time scale T<sub>f</sub>, specifically:</p><p id="p-0099" num="0058">{circle around (1)} set s=1, f=1, &#x3b7;=1;</p><p id="p-0100" num="0059">{circle around (2)} according to the sampling information converted by programmable logic controller, predict nitrate nitrogen concentration at time t<sub>&#x3b7;</sub> using slow sampling fuzzy neural network; the inputs of the slow sampling fuzzy neural network are as follows: x<sub>s1</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the actual value of nitrate nitrogen concentration y<sub>s</sub>(t<sub>&#x3b7;&#x2212;1</sub>) at time t<sub>&#x3b7;&#x2212;1</sub>, x<sub>s2</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the aeration rate u<sub>1</sub>(t<sub>&#x3b7;&#x2212;1</sub>) at time t<sub>&#x3b7;&#x2212;1</sub>, x<sub>s3</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the internal reflux u<sub>2</sub>(t<sub>&#x3b7;&#x2212;1</sub>) at time t<sub>&#x3b7;&#x2212;1</sub>; the output of the slow sampling fuzzy neural network is the prediction value of nitrate nitrogen concentration &#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>) at time t<sub>&#x3b7;</sub>;</p><p id="p-0101" num="0060">{circle around (3)} if t<sub>&#x3b7;</sub>=t<sub>f</sub>, set &#x177;<sub>s</sub>(t<sub>f</sub>)=&#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>), where &#x177;<sub>s</sub>(t<sub>f</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f</sub>, go to step {circle around (6)} after performing step {circle around (4)}; if t<sub>&#x3b7;</sub>&#x2260;t<sub>f</sub>, go to step {circle around (6)} after performing step {circle around (5)};</p><p id="p-0102" num="0061">{circle around (4)} if t<sub>&#x3b7;</sub>=t<sub>s</sub>, increase the value of s by 1, update the parameters of the slow sampling fuzzy neural network by the error between the predicted value and the actual value of nitrate nitrogen concentration E<sub>s</sub>(t<sub>&#x3b7;</sub>)=&#xbd;[y<sub>s</sub>(t<sub>s</sub>)&#x2212;&#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>)]<sup>2</sup>:</p><p id="p-0103" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(28)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0104" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(29)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0105" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(30)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0106" num="0000">if t<sub>&#x3b7;</sub>&#x2260;t<sub>s</sub>, the parameters of slow sampling fuzzy neural network are not updated;</p><p id="p-0107" num="0062">{circle around (5)} set y<sub>s</sub>(t<sub>&#x3b7;</sub>)=&#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>), u<sub>1</sub>(t<sub>&#x3b7;</sub>)=u<sub>1</sub>(t<sub>f</sub>), u<sub>2</sub>(t<sub>&#x3b7;</sub>)=u<sub>2</sub>(t<sub>f</sub>), increase the value of &#x3b7; by 1, go to step {circle around (2)}, where y<sub>s</sub>(t<sub>&#x3b7;</sub>) is the actual nitrate nitrogen concentration converted by the programmable logic controller at time t<sub>&#x3b7;</sub>, u<sub>1</sub>(t<sub>&#x3b8;</sub>) is the aeration rate at time t<sub>&#x3b7;</sub>, u<sub>2</sub>(t<sub>&#x3b8;</sub>) is the internal reflux at time t<sub>&#x3b7;</sub>, u<sub>1</sub>(t<sub>f</sub>) is the aeration rate at time t<sub>f</sub>, u<sub>2</sub>(t<sub>f</sub>) is the internal reflux at time t<sub>f</sub>;</p><p id="p-0108" num="0063">{circle around (6)} predict dissolved oxygen concentration at time t<sub>f </sub>by the fast sampling fuzzy neural network; the inputs of the fast sampling fuzzy neural network are as follows: x<sub>f1</sub>(t<sub>f&#x2212;1</sub>) is the actual value of dissolved oxygen concentration y<sub>f</sub>(t<sub>f&#x2212;1</sub>) converted by the programmable logic controller at time t<sub>f&#x2212;1</sub>, x<sub>f2</sub>(t<sub>f&#x2212;1</sub>) is the aeration rate u<sub>1</sub>(t<sub>f&#x2212;1</sub>) at time t<sub>f&#x2212;1</sub>, x<sub>f3</sub>(t<sub>f&#x2212;1</sub>) is the internal reflux u<sub>2</sub>(t<sub>f&#x2212;1</sub>) at time t<sub>f&#x2212;1</sub>; the output of the fast sampling fuzzy neural network is the prediction value of dissolved oxygen concentration &#x177;<sub>f</sub>(t<sub>f</sub>) at time t<sub>f</sub>; update the parameters of the fast sampling fuzzy neural network by the error between the predicted value and the actual value of dissolved oxygen concentration E<sub>f</sub>(t<sub>f</sub>)=&#xbd;[y<sub>f</sub>(t<sub>f</sub>)&#x2212;&#x177;<sub>f</sub>(t<sub>f</sub>)]<sup>2</sup>:</p><p id="p-0109" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>w</i><sub>fj</sub>(<i>t</i><sub>f+1</sub>)=<i>w</i><sub>fj</sub>(<i>t</i><sub>f</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>f</sub>(<i>t</i><sub>f</sub>)/&#x2202;<i>w</i><sub>fj</sub>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(31)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0110" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>fij</sub>(<i>t</i><sub>f+1</sub>)=<i>c</i><sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>f</sub>(<i>t</i><sub>f</sub>)/&#x2202;<i>c</i><sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(32)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0111" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c3;<sub>fij</sub>(<i>t</i><sub>f+1</sub>)=&#x3c3;<sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>f</sub>(<i>t</i><sub>f</sub>)/&#x2202;&#x3c3;<sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(33)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0112" num="0000">where w<sub>fj</sub>(t<sub>f+1</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the slow sampling fuzzy neural network at time t<sub>f+1</sub>, c<sub>fij</sub>(t<sub>f&#x2212;1</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f+1</sub>, &#x3c3;<sub>fij</sub>(t<sub>f+1</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f+1</sub>;</p><p id="p-0113" num="0064">{circle around (7)} design an objective function of multi-time scale model predictive control to track the set-points of nitrate nitrogen concentration and dissolved oxygen concentration, and calculate the control law at time t<sub>f</sub>:</p><p id="p-0114" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>J</i>(<i>t</i><sub>f</sub>)=0.25[[<i>r</i><sub>f</sub>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>f</sub>(<i>t</i><sub>f</sub>)]<sup>T</sup>[<i>r</i>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>f</sub>(<i>t</i><sub>f</sub>)]+&#x394;<i>u</i>(<i>t</i><sub>f</sub>)<sup>T</sup><i>&#x394;u</i>(<i>t</i><sub>f</sub>)]+0.45[<i>r</i><sub>s</sub>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>s</sub>(<i>t</i><sub>f</sub>)]<sup>T</sup>[<i>r</i><sub>s</sub>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>s</sub>(<i>t</i><sub>f</sub>)]+&#x394;<i>u</i>(<i>t</i><sub>f</sub>)<sup>T</sup><i>&#x394;u</i>(<i>t</i><sub>f</sub>)&#x2003;&#x2003; (34)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0115" num="0000">where r<sub>f</sub>(t<sub>f</sub>)=[r<sub>f</sub>(t<sub>f&#x2212;1</sub>), r<sub>f</sub>(t<sub>f+2</sub>), r<sub>f</sub>(t<sub>f+3</sub>)]<sup>T </sup>is the set-point of dissolved oxygen concentration, r<sub>f</sub>(t<sub>f+1</sub>)=2 mg/l represents the set-point of dissolved oxygen concentration at time t<sub>f+1</sub>, r<sub>f</sub>(t<sub>f+2</sub>)=2 mg/l represents the set-point of dissolved oxygen concentration at time t<sub>f+2</sub>, r<sub>f</sub>(t<sub>f+3</sub>)=2 mg/l represents the set-point of dissolved oxygen concentration at time t<sub>f+3</sub>; &#x177;<sub>f</sub>(t<sub>f</sub>)=[&#x177;<sub>f</sub>(t<sub>f+1</sub>), &#x177;<sub>f</sub>(t<sub>f+2</sub>), &#x177;<sub>f</sub>(t<sub>f+3</sub>)]<sup>T </sup>is the prediction output of the fast sampling fuzzy neural network, &#x177;<sub>f</sub>(t<sub>f&#x2212;1</sub>) is the prediction value of dissolved oxygen concentration at time t<sub>f+1</sub>, &#x177;<sub>f</sub>(t<sub>f+2</sub>) is the prediction value of dissolved oxygen concentration at time t<sub>f+2</sub>, &#x177;<sub>f</sub>(t<sub>f+3</sub>) is the prediction value of dissolved oxygen concentration at time t<sub>f+3</sub>; r<sub>s</sub>(t<sub>f</sub>)=[r<sub>s</sub>(t<sub>f+1</sub>), r<sub>s</sub>(t<sub>f+2</sub>), r<sub>s</sub>(t<sub>f+3</sub>)]<sup>T </sup>is the set-point of nitrate nitrogen concentration; r<sub>s</sub>(t<sub>f+1</sub>)=1 mg/l represents the set-point of nitrate nitrogen concentration at time t<sub>f+1</sub>, r<sub>s</sub>(t<sub>f+2</sub>)=1 mg/l represents the set-point of nitrate nitrogen concentration at time t<sub>f+2</sub>, r<sub>s</sub>(t<sub>f+3</sub>)=1 mg/l represents the set-point of nitrate nitrogen concentration at time t<sub>f+3</sub>; &#x177;<sub>s</sub>(t<sub>s</sub>)=[&#x177;<sub>s</sub>(t<sub>s+1</sub>), &#x177;<sub>s</sub>(t<sub>s+2</sub>), &#x177;<sub>s</sub>(t<sub>s+3</sub>)]<sup>T </sup>is the prediction output of slow sampling fuzzy neural network, &#x177;<sub>s</sub>(t<sub>f+1</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f+1</sub>, &#x177;<sub>s</sub>(t<sub>f+2</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f+2</sub>, &#x177;<sub>s</sub>(t<sub>f+3</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f+3</sub>; &#x394;u(t<sub>f</sub>)=[&#x394;u<sub>1</sub>(t<sub>f</sub>), &#x394;u<sub>2</sub>(t<sub>f</sub>)]<sup>T </sup>is the incremental control moves at time t<sub>f</sub>, &#x394;u<sub>1</sub>(t<sub>f</sub>) is the aeration rate adjustment amount at time t<sub>f</sub>, &#x394;u<sub>2</sub>(t<sub>f</sub>) is the internal reflux adjustment amount at time t<sub>f</sub>, where</p><p id="p-0116" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>u</i>(<i>t</i><sub>f</sub>)=<i>u</i>(<i>t</i><sub>f+1</sub>)&#x2212;<i>u</i>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(35)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0117" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>|&#x394;<i>u</i>(<i>t</i><sub>f</sub>)|&#x2264;&#x394;<i>u</i><sub>max</sub>&#x2003;&#x2003;(36)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0118" num="0000">u(t<sub>f</sub>)=[u<sub>1</sub>(t<sub>f</sub>), u<sub>2</sub>(t<sub>f</sub>)]<sup>T </sup>is control vector converting into analog signal through programmable logic controller and transmitting to variable frequency driver at time t<sub>f</sub>, u(t<sub>f+1</sub>)=[u<sub>1</sub>(t<sub>f+1</sub>), u<sub>2</sub>(t<sub>f&#x2212;1</sub>)]<sup>T </sup>is control vector converting into analog signal through programmable logic controller and transmitting to variable frequency driver at time t<sub>f+1</sub>, u<sub>1</sub>(t<sub>f+1</sub>) is the aeration rate at time t<sub>f+1</sub>, u<sub>2</sub>(t<sub>f+1</sub>) is the internal reflux at time t<sub>f+1</sub>; &#x394;u<sub>max</sub>=[&#x394;K<sub>L</sub>a<sub>max</sub>, &#x394;Q<sub>amax</sub>]<sup>T </sup>is the maximum adjustment vector allowed by the controller, &#x394;K<sub>L</sub>a<sub>max</sub>=100 L/min is the maximum aeration adjustment amount, &#x394;Q<sub>amax</sub>=50000 L/min is the maximum internal reflux adjustment amount, &#x394;u<sub>max </sub>is set through the blower and internal reflux valve in the control system equipment;</p><p id="p-0119" num="0065">an aeration rate and internal reflux adjustment vector are calculated by minimizing Eq.(15):</p><p id="p-0120" num="0000"><maths id="MATH-US-00006" num="00006"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <mrow>       <mi>u</mi>       <mo>&#x2061;</mo>       <mo>(</mo>       <msub>        <mi>t</mi>        <mi>f</mi>       </msub>       <mo>)</mo>      </mrow>     </mrow>     <mo>=</mo>     <mrow>      <mo>(</mo>      <mrow>       <mrow>        <mn>0.</mn>        <mn>4</mn>        <mo>&#x2062;</mo>        <mrow>         <msup>          <mrow>           <mo>(</mo>           <mfrac>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <msub>               <mover accent="true">                <mi>y</mi>                <mi>&#x2c6;</mi>               </mover>               <mi>f</mi>              </msub>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <mi>u</mi>              <mo>&#x2061;</mo>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>           <mo>)</mo>          </mrow>          <mi>T</mi>         </msup>         <mo>[</mo>         <mrow>          <mrow>           <msub>            <mi>r</mi>            <mi>f</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>          <mo>-</mo>          <mrow>           <msub>            <mover accent="true">             <mi>y</mi>             <mi>&#x2c6;</mi>            </mover>            <mi>f</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>         </mrow>         <mo>]</mo>        </mrow>       </mrow>       <mo>+</mo>       <mrow>        <mrow>         <mn>0</mn>         <mo>.</mo>         <mn>0</mn>        </mrow>        <mo>&#x2062;</mo>        <mn>8</mn>        <mo>&#x2062;</mo>        <mrow>         <msup>          <mrow>           <mo>(</mo>           <mfrac>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <msub>               <mover accent="true">                <mi>y</mi>                <mi>&#x2c6;</mi>               </mover>               <mi>s</mi>              </msub>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <mi>u</mi>              <mo>&#x2061;</mo>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>           <mo>)</mo>          </mrow>          <mi>T</mi>         </msup>         <mo>[</mo>         <mrow>          <mrow>           <msub>            <mi>r</mi>            <mi>s</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>          <mo>-</mo>          <mrow>           <msub>            <mover accent="true">             <mi>y</mi>             <mi>&#x2c6;</mi>            </mover>            <mi>s</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>         </mrow>         <mo>]</mo>        </mrow>       </mrow>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>37</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0121" num="0000">adjust the aeration rate and internal reflux at time t<sub>f</sub>:</p><p id="p-0122" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i>(<i>t</i><sub>f+1</sub>)=<i>u</i>(<i>t</i><sub>f</sub>)+&#x394;<i>u</i>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(38)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0123" num="0066">{circle around (8)} if f&#x2264;1000, increase the value of f by 1, increase the value of &#x3b7; by 1, go to step {circle around (2)}; if f&#x3e;1000, end the cycle;</p><p id="p-0124" num="0067">(6) the concentration of nitrate nitrogen and dissolved oxygen is controlled by u(t<sub>f</sub>), and u(t<sub>f</sub>)=[u<sub>1</sub>(t<sub>f</sub>), u<sub>2</sub>(t<sub>f</sub>)]<sup>T </sup>is transferred to programmable logic controller for digital/analog conversion to obtain U(t<sub>f</sub>)=[U<sub>1</sub>(t<sub>f</sub>), U<sub>2</sub>(t<sub>f</sub>)]<sup>T</sup>, which is the input of variable-frequency drive, the variable-frequency drive changes the working power frequency of motor to control the aeration pump and electronic valve, then, the aeration rate and internal reflux are controlled, the output of the system is the actual value of nitrate nitrogen concentration and dissolved oxygen concentration. <figref idref="DRAWINGS">FIG. <b>4</b></figref> shows the dissolved oxygen concentration of the system, X-axis: time, unit: day, Y-axis: dissolved oxygen concentration, unit: mg/L, the solid line is the expected dissolved oxygen concentration, the dotted line is the actual dissolved oxygen concentration; the error between the actual output dissolved oxygen concentration and the expected dissolved oxygen concentration is shown in <figref idref="DRAWINGS">FIG. <b>5</b></figref>, X-axis: time, unit: day, Y-axis: dissolved oxygen concentration error, unit: mg/L <figref idref="DRAWINGS">FIG. <b>6</b></figref> shows the nitrate concentration value of the system, X-axis: time, unit: day, Y-axis: nitrate concentration value, unit: mg/L, solid line is expected nitrate concentration value, dotted line is actual nitrate concentration value; the error between actual output nitrate concentration and expected nitrate concentration is shown in <figref idref="DRAWINGS">FIG. <b>7</b></figref>, X-axis: time, unit: day, Y-axis: nitrate concentration error value, unit: mg/L. The results show that the method is effective.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001" nb-file="US20230004780A1-20230105-M00001.NB"><img id="EMI-M00001" he="19.05mm" wi="76.20mm" file="US20230004780A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00002" nb-file="US20230004780A1-20230105-M00002.NB"><img id="EMI-M00002" he="17.27mm" wi="76.20mm" file="US20230004780A1-20230105-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00003" nb-file="US20230004780A1-20230105-M00003.NB"><img id="EMI-M00003" he="13.72mm" wi="76.20mm" file="US20230004780A1-20230105-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00004" nb-file="US20230004780A1-20230105-M00004.NB"><img id="EMI-M00004" he="19.05mm" wi="76.20mm" file="US20230004780A1-20230105-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00005" nb-file="US20230004780A1-20230105-M00005.NB"><img id="EMI-M00005" he="17.27mm" wi="76.20mm" file="US20230004780A1-20230105-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00006" nb-file="US20230004780A1-20230105-M00006.NB"><img id="EMI-M00006" he="13.72mm" wi="76.20mm" file="US20230004780A1-20230105-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00007" nb-file="US20230004780A1-20230105-M00007.NB"><img id="EMI-M00007" he="19.05mm" wi="76.20mm" file="US20230004780A1-20230105-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00008" nb-file="US20230004780A1-20230105-M00008.NB"><img id="EMI-M00008" he="17.27mm" wi="76.20mm" file="US20230004780A1-20230105-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00009" nb-file="US20230004780A1-20230105-M00009.NB"><img id="EMI-M00009" he="13.72mm" wi="76.20mm" file="US20230004780A1-20230105-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A multi-time scale model predictive control method of wastewater treatment process, comprising the following steps:<claim-text>(1) the multi-time scale model predictive control system for wastewater treatment process control comprising a set of measuring devices arranged to obtain a dataset, measuring devices include dissolved oxygen detector, nitrate nitrogen detector, the dataset comprises a plurality of process variables related to a parameter of wastewater treatment process; a programmable logic controller arranged to perform digital/analog conversion and analog/digital conversion; a variable-frequency drive arranged to control the air-blower and electronic valve by changing the working power frequency of motor; an air-blower arranged to provide the required oxygen to the microorganisms in the wastewater treatment process; an electronic valve arranged to adjust internal return flow; a multi-time scale model predictive control module arranged to calculate the control law to track the dissolved oxygen concentration and nitrate nitrogen concentration in wastewater treatment process with different time scales; the multi-time scale model predictive control module comprising two fuzzy neural network to predict the system outputs, a time scale conversion mechanism to unify the prediction time scales to fast time scale, and an optimization control module to calculate the control law;</claim-text><claim-text>(2) the time scales of dissolved oxygen concentration and nitrate nitrogen concentration in wastewater treatment process are different, specifically:</claim-text><claim-text>T<sub>f </sub>is the sampling interval of dissolved oxygen concentration, T<sub>f</sub>&#x2208;[6, 10] is a positive integer in minutes, t<sub>f</sub>=fT<sub>f </sub>represents the sampling instant of dissolved oxygen concentration, f is the number of sampling steps of dissolved oxygen concentration, and f&#x2208;[1, 1000] is a positive integer;</claim-text><claim-text>T<sub>s </sub>is the sampling interval of nitrate nitrogen concentration, T<sub>s</sub>&#x2208;[12, 20] is a positive integer in minutes, t<sub>s</sub>=sT<sub>s </sub>represents the sampling instant of nitrate nitrogen concentration, s is the number of sampling steps of nitrate nitrogen concentration, and s&#x2208;[1, 400] is a positive integer;</claim-text><claim-text>&#x3b6; is the maximum common divisor of T<sub>f </sub>and T<sub>s</sub>, t<sub>&#x3b7;</sub>=&#x3b7;&#x3b6; is the prediction instant of slow sampling fuzzy neural network, &#x3b7; is the number of prediction steps of slow sampling fuzzy neural network, &#x3b7;&#x2208;[1, 2000] is a positive integer;</claim-text><claim-text>(3) a fast sampling fuzzy neural network is designed to predict dissolved oxygen concentration with time scale T<sub>f</sub>, which is as follows:</claim-text><claim-text>the input of the fast sampling fuzzy neural network is x<sub>f</sub>(t<sub>f</sub>)=[x<sub>f1</sub>(t<sub>f&#x2212;1</sub>), x<sub>f2</sub>(t<sub>f&#x2212;1</sub>), x<sub>f3</sub>(t<sub>f&#x2212;1</sub>)]<sup>T</sup>, T is the transposition of the matrix, and the output of the fast sampling fuzzy neural network is the predicted value of dissolved oxygen concentration &#x177;<sub>f</sub>(t<sub>f</sub>) at time t<sub>f</sub>, the output is defined as follows</claim-text></claim-text><claim-text><maths id="MATH-US-00007" num="00007"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <msub>       <mover accent="true">        <mi>y</mi>        <mi>&#x2c6;</mi>       </mover>       <mi>f</mi>      </msub>      <mo>&#x2062;</mo>      <mrow>       <mo>(</mo>       <msub>        <mi>t</mi>        <mi>f</mi>       </msub>       <mo>)</mo>      </mrow>     </mrow>     <mo>=</mo>     <mfrac>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <mrow>        <mrow>         <msub>          <mi>w</mi>          <mi>fj</mi>         </msub>         <mo>(</mo>         <msub>          <mi>t</mi>          <mi>f</mi>         </msub>         <mo>)</mo>        </mrow>        <mo>&#x2062;</mo>        <msup>         <mi>e</mi>         <mrow>          <mo>-</mo>          <mrow>           <munderover>            <mo>&#x2211;</mo>            <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">             <mrow>              <mi>i</mi>              <mo>=</mo>              <mn>1</mn>             </mrow>            </mpadded>            <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">             <mn>3</mn>            </mpadded>           </munderover>           <mpadded width="1.07692em" lspace="-1.07692em" depth="0ex" height="0ex">            <mfrac>             <msup>              <mrow>               <mo>(</mo>               <mrow>                <mrow>                 <msub>                  <mi>x</mi>                  <mi>fi</mi>                 </msub>                 <mo>(</mo>                 <mrow>                  <msub>                   <mi>t</mi>                   <mi>f</mi>                  </msub>                  <mo>-</mo>                  <mn>1</mn>                 </mrow>                 <mo>)</mo>                </mrow>                <mo>-</mo>                <mrow>                 <msub>                  <mi>c</mi>                  <mi>fij</mi>                 </msub>                 <mo>(</mo>                 <msub>                  <mi>t</mi>                  <mi>f</mi>                 </msub>                 <mo>)</mo>                </mrow>               </mrow>               <mo>)</mo>              </mrow>              <mn>2</mn>             </msup>             <mrow>              <mn>2</mn>              <mo>&#x2062;</mo>              <mrow>               <msubsup>                <mi>&#x3c3;</mi>                <mi>fij</mi>                <mn>2</mn>               </msubsup>               <mo>(</mo>               <msub>                <mi>t</mi>                <mi>f</mi>               </msub>               <mo>)</mo>              </mrow>             </mrow>            </mfrac>           </mpadded>          </mrow>         </mrow>        </msup>       </mrow>      </mrow>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <msup>        <mi>e</mi>        <mrow>         <mo>-</mo>         <mrow>          <munderover>           <mo>&#x2211;</mo>           <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">            <mrow>             <mi>i</mi>             <mo>=</mo>             <mn>1</mn>            </mrow>           </mpadded>           <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">            <mn>3</mn>           </mpadded>          </munderover>          <mpadded width="0.846154em" lspace="-0.846154em" depth="0ex" height="0ex">           <mfrac>            <msup>             <mrow>              <mo>(</mo>              <mrow>               <mrow>                <msub>                 <mi>x</mi>                 <mi>fi</mi>                </msub>                <mo>(</mo>                <mrow>                 <msub>                  <mi>t</mi>                  <mi>f</mi>                 </msub>                 <mo>-</mo>                 <mn>1</mn>                </mrow>                <mo>)</mo>               </mrow>               <mo>-</mo>               <mrow>                <msub>                 <mi>c</mi>                 <mi>fij</mi>                </msub>                <mo>(</mo>                <msub>                 <mi>t</mi>                 <mi>f</mi>                </msub>                <mo>)</mo>               </mrow>              </mrow>              <mo>)</mo>             </mrow>             <mn>2</mn>            </msup>            <mrow>             <mn>2</mn>             <mo>&#x2062;</mo>             <mrow>              <msubsup>               <mi>&#x3c3;</mi>               <mi>fij</mi>               <mn>2</mn>              </msubsup>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>          </mpadded>         </mrow>        </mrow>       </msup>      </mrow>     </mfrac>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>1</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></claim-text><claim-text>where x<sub>fi</sub>(t<sub>f&#x2212;1</sub>) is the ith input of the fast sampling fuzzy neural network at time t<sub>f</sub>, i=1, 2, 3, w<sub>fj</sub>(t<sub>f</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the fast sampling fuzzy neural network at time t<sub>f</sub>, w<sub>fj</sub>(t<sub>0</sub>) is randomly assigned within [0, 1], j=1, 2, 3, 4, 5, 6, t<sub>0 </sub>is the initial instant, c<sub>fij</sub>(t<sub>f</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f</sub>, c<sub>fij</sub>(t<sub>0</sub>) is randomly assigned within [0,1], &#x3c3;<sub>fij</sub>(t<sub>f</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f</sub>, and &#x3c3;<sub>fij</sub>(t<sub>0</sub>) is randomly assigned within [0,1];<claim-text>(4) a slow sampling fuzzy neural network is designed to predict nitrate nitrogen concentration with time scale &#x3b6;, which is as follows:</claim-text><claim-text>The input of the slow sampling fuzzy neural network is x<sub>s</sub>(t<sub>&#x3b7;</sub>)=[x<sub>s1</sub>(t<sub>&#x3b7;&#x2212;1</sub>), x<sub>s2</sub>(t<sub>&#x3b7;&#x2212;1</sub>), x<sub>s3</sub>(t<sub>&#x3b7;&#x2212;1</sub>)]<sup>T</sup>, and the output of the slow sampling fuzzy neural network is the predicted value of nitrate nitrogen concentration &#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>) at time t<sub>&#x3b7;</sub>, the output is defined as follows</claim-text></claim-text><claim-text><maths id="MATH-US-00008" num="00008"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <msub>       <mover accent="true">        <mi>y</mi>        <mi>&#x2c6;</mi>       </mover>       <mi>f</mi>      </msub>      <mo>&#x2062;</mo>      <mrow>       <mo>(</mo>       <msub>        <mi>t</mi>        <mi>&#x3b7;</mi>       </msub>       <mo>)</mo>      </mrow>     </mrow>     <mo>=</mo>     <mfrac>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <mrow>        <mrow>         <msub>          <mi>&#x3c9;</mi>          <mi>sj</mi>         </msub>         <mo>(</mo>         <msub>          <mi>t</mi>          <mi>&#x3b7;</mi>         </msub>         <mo>)</mo>        </mrow>        <mo>&#x2062;</mo>        <msup>         <mi>e</mi>         <mrow>          <mo>-</mo>          <mrow>           <munderover>            <mo>&#x2211;</mo>            <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">             <mrow>              <mi>i</mi>              <mo>=</mo>              <mn>1</mn>             </mrow>            </mpadded>            <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">             <mn>3</mn>            </mpadded>           </munderover>           <mpadded width="0.846154em" lspace="-0.846154em" depth="0ex" height="0ex">            <mfrac>             <msup>              <mrow>               <mo>(</mo>               <mrow>                <mrow>                 <msub>                  <mi>x</mi>                  <mi>si</mi>                 </msub>                 <mo>(</mo>                 <mrow>                  <msub>                   <mi>t</mi>                   <mi>&#x3b7;</mi>                  </msub>                  <mo>-</mo>                  <mn>1</mn>                 </mrow>                 <mo>)</mo>                </mrow>                <mo>-</mo>                <mrow>                 <msub>                  <mi>c</mi>                  <mi>sij</mi>                 </msub>                 <mo>(</mo>                 <msub>                  <mi>t</mi>                  <mi>&#x3b7;</mi>                 </msub>                 <mo>)</mo>                </mrow>               </mrow>               <mo>)</mo>              </mrow>              <mn>2</mn>             </msup>             <mrow>              <mn>2</mn>              <mo>&#x2062;</mo>              <mrow>               <msubsup>                <mi>&#x3c3;</mi>                <mi>sij</mi>                <mn>2</mn>               </msubsup>               <mo>(</mo>               <msub>                <mi>t</mi>                <mi>&#x3b7;</mi>               </msub>               <mo>)</mo>              </mrow>             </mrow>            </mfrac>           </mpadded>          </mrow>         </mrow>        </msup>       </mrow>      </mrow>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <mn>6</mn>       </msubsup>       <msup>        <mi>e</mi>        <mrow>         <mo>-</mo>         <mrow>          <munderover>           <mo>&#x2211;</mo>           <mpadded width="1.07692em" lspace="-1.07692em" depth="-1.14286ex" height="1.14286ex">            <mrow>             <mi>i</mi>             <mo>=</mo>             <mn>1</mn>            </mrow>           </mpadded>           <mpadded width="0.538462em" lspace="-0.538462em" depth="0.857143ex" height="-0.857143ex">            <mn>3</mn>           </mpadded>          </munderover>          <mpadded width="0.923077em" lspace="-0.923077em" depth="0ex" height="0ex">           <mfrac>            <msup>             <mrow>              <mo>(</mo>              <mrow>               <mrow>                <msub>                 <mi>x</mi>                 <mi>si</mi>                </msub>                <mo>(</mo>                <mrow>                 <msub>                  <mi>t</mi>                  <mi>&#x3b7;</mi>                 </msub>                 <mo>-</mo>                 <mn>1</mn>                </mrow>                <mo>)</mo>               </mrow>               <mo>-</mo>               <mrow>                <msub>                 <mi>c</mi>                 <mi>sij</mi>                </msub>                <mo>(</mo>                <msub>                 <mi>t</mi>                 <mi>&#x3b7;</mi>                </msub>                <mo>)</mo>               </mrow>              </mrow>              <mo>)</mo>             </mrow>             <mn>2</mn>            </msup>            <mrow>             <mn>2</mn>             <mo>&#x2062;</mo>             <mrow>              <msubsup>               <mi>&#x3c3;</mi>               <mi>sij</mi>               <mn>2</mn>              </msubsup>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>&#x3b7;</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>          </mpadded>         </mrow>        </mrow>       </msup>      </mrow>     </mfrac>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>2</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></claim-text><claim-text>where x<sub>si</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the ith input of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, w<sub>sj</sub>(t<sub>&#x3b7;</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, w<sub>sj</sub>(t<sub>0</sub>) is randomly assigned within [0, 1], c<sub>sij</sub>(t<sub>&#x3b7;</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, c<sub>sij</sub>(t<sub>0</sub>) is randomly assigned within [0,1], &#x3c3;<sub>sij</sub>(t<sub>&#x3b7;</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;</sub>, and &#x3c3;<sub>sij</sub>(t<sub>0</sub>) is randomly assigned within [0,1];<claim-text>a dataset &#x3a9; whose time scale is &#x3b6; is constructed as follows, when t<sub>s</sub>&#x2264;t<sub>&#x3b7;</sub>&#x3c;t<sub>s+1</sub>:<claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i><sub>s1</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)=<i>u</i><sub>s1</sub>(<i>t</i><sub>s</sub>)&#x2003;&#x2003;(3)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i><sub>s2</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)=<i>u</i><sub>s2</sub>(<i>t</i><sub>s</sub>)&#x2003;&#x2003;(4)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>y</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)=<i>y</i><sub>s</sub>(<i>t</i><sub>s</sub>)+<i>T</i><sub>s</sub>(<i>y</i><sub>s</sub>(<i>t</i><sub>s+1</sub>)&#x2212;<i>y</i><sub>s</sub>(<i>t</i><sub>s</sub>))/<i>t</i><sub>&#x3b7;</sub>&#x2003;&#x2003;(5)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text></claim-text></claim-text><claim-text>where u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) is the virtual value of aeration rate at time t<sub>&#x3b7;</sub>, u<sub>s1</sub>(t<sub>s</sub>) is the actual value of aeration rate at time t<sub>s</sub>, u<sub>s2</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) is the virtual value of internal reflux at time t<sub>&#x3b7;</sub>, u<sub>s2</sub>(t<sub>s</sub>) is the actual value of internal reflux at time t<sub>s</sub>, y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) is the virtual estimated value of nitrate nitrogen concentration at time t<sub>&#x3b7;</sub>, y<sub>s</sub>(t<sub>s</sub>) is the actual value of the nitrate nitrogen concentration converted by the programmable logic controller at time t<sub>s</sub>, y<sub>s</sub>(t<sub>s+1</sub>) is the actual value of the nitrate nitrogen concentration converted by the programmable logic controller at time t<sub>s+1</sub>; the dataset &#x3a9; is composed of u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>), u<sub>s2</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>), and y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>);<claim-text>The dataset &#x3a9; is used to pre-train the slow sampling fuzzy neural network offline, and the training input is x<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)=[y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>), u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>), u<sub>s2</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>)]<sup>T</sup>, y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>) is the nitrate nitrogen concentration at time t<sub>&#x3b7;&#x2212;1 </sub>in &#x3a9;, u<sub>s1</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>) is the aeration rate at time t<sub>&#x3b7;&#x2212;1 </sub>in &#x3a9;, u<sub>s2</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;&#x2212;1</sub>) is the internal reflux at time t<sub>&#x3b7;&#x2212;1 </sub>in &#x3a9;, the training output is the prediction value of nitrate nitrogen concentration &#x177;<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>) at time t<sub>&#x3b7;</sub>; using the error between nitrate nitrogen concentration value in dataset &#x3a9; and predicted value E<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)=&#xbd;[y<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)&#x2212;&#x177;<sub>s</sub><sup>&#x3b7;</sup>(t<sub>&#x3b7;</sub>)]<sup>2 </sup>at time t<sub>&#x3b7;</sub>, correct parameters of slow sampling fuzzy neural network:<claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(6)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(7)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub><sup>&#x3b7;</sup>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(8)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text></claim-text></claim-text><claim-text>where w<sub>sj</sub>(t<sub>&#x3b7;+1</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;+1</sub>, c<sub>sij</sub>(t<sub>&#x3b7;+1</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;+1</sub>, &#x3c3;<sub>sij</sub>(t<sub>&#x3b7;+1</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the slow sampling fuzzy neural network at time t<sub>&#x3b7;+1; </sub><claim-text>(5) The multi-time scale model predictive control method is designed to control the dissolved oxygen concentration and nitrate nitrogen concentration in time scale T<sub>f</sub>, specifically:</claim-text><claim-text>{circle around (1)} set s=1, f=1, &#x3b7;=1;</claim-text><claim-text>{circle around (2)} according to the sampling information converted by programmable logic controller, predict nitrate nitrogen concentration at time t<sub>&#x3b7;</sub> using slow sampling fuzzy neural network; the inputs of the slow sampling fuzzy neural network are as follows: x<sub>s1</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the actual value of nitrate nitrogen concentration y<sub>s</sub>(t<sub>&#x3b7;&#x2212;1</sub>) at time t<sub>&#x3b7;&#x2212;1</sub>, x<sub>s2</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the aeration rate u<sub>1</sub>(t<sub>&#x3b7;&#x2212;1</sub>) at time t<sub>&#x3b7;&#x2212;1</sub>, x<sub>s3</sub>(t<sub>&#x3b7;&#x2212;1</sub>) is the internal reflux u<sub>2</sub>(t<sub>&#x3b7;&#x2212;1</sub>) at time t<sub>&#x3b7;&#x2212;1</sub>; the output of the slow sampling fuzzy neural network is the prediction value of nitrate nitrogen concentration &#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>) at time t<sub>&#x3b7;</sub>;</claim-text><claim-text>{circumflex over (3)} if t<sub>&#x3b7;</sub>=t<sub>f</sub>, set &#x177;<sub>s</sub>(t<sub>f</sub>)=&#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>), where &#x177;<sub>s</sub>(t<sub>f</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f</sub>, go to step {circle around (6)} after performing step {circle around (4)}; if t<sub>&#x3b7;</sub>&#x2260;t<sub>f</sub>, go to step {circle around (6)} after performing step {circle around (5)};</claim-text><claim-text>{circle around (4)} if t<sub>&#x3b7;</sub>=t<sub>s</sub>, increase the value of s by 1, update the parameters of the slow sampling fuzzy neural network by the error between the predicted value and the actual value of nitrate nitrogen concentration E<sub>s</sub>(t<sub>&#x3b7;</sub>)=&#xbd;[y<sub>s</sub>(t<sub>s</sub>)&#x2212;&#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>)]<sup>2</sup>:<claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>))&#x2212;0.2&#x2202;<i>E</i><sub>s</sub>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>w</i><sub>sj</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(9)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;<i>c</i><sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(10)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;+1</sub>)=&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>s</sub>(<i>t</i><sub>&#x3b7;</sub>)/&#x2202;&#x3c3;<sub>sij</sub>(<i>t</i><sub>&#x3b7;</sub>)&#x2003;&#x2003;(11)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text></claim-text><claim-text>if t<sub>&#x3b7;</sub>&#x2260;t<sub>s</sub>, the parameters of slow sampling fuzzy neural network are not updated;</claim-text><claim-text>{circumflex over (5)} set y<sub>s</sub>(t<sub>&#x3b7;</sub>)=&#x177;<sub>s</sub>(t<sub>&#x3b7;</sub>), u<sub>1</sub>(t<sub>&#x3b7;</sub>)=u<sub>1</sub>(t<sub>f</sub>), u<sub>2</sub>(t<sub>&#x3b7;</sub>)=u<sub>2</sub>(t<sub>f</sub>), increase the value of &#x3b7; by 1, go to step {circle around (2)}, where y<sub>s</sub>(t<sub>&#x3b7;</sub>) is the actual nitrate nitrogen concentration converted by the programmable logic controller at time t<sub>&#x3b7;</sub>, u<sub>1</sub>(t<sub>&#x3b7;</sub>) is the aeration rate at time t<sub>&#x3b7;</sub>, u<sub>2</sub>(t<sub>&#x3b7;</sub>) is the internal reflux at time t<sub>&#x3b7;</sub>, u<sub>1</sub>(t<sub>f</sub>) is the aeration rate at time t<sub>f</sub>, u<sub>2</sub>(t<sub>f</sub>) is the internal reflux at time t<sub>f</sub>;</claim-text><claim-text>{circumflex over (6)} predict dissolved oxygen concentration at time t<sub>f </sub>by the fast sampling fuzzy neural network; the inputs of the fast sampling fuzzy neural network are as follows: x<sub>f1</sub>(t<sub>f&#x2212;1</sub>) is the actual value of dissolved oxygen concentration y<sub>f</sub>(t<sub>f&#x2212;1</sub>) converted by the programmable logic controller at time t<sub>f&#x2212;1</sub>, x<sub>f2</sub>(t<sub>f&#x2212;1</sub>) is the aeration rate u<sub>1</sub>(t<sub>f&#x2212;1</sub>) at time t<sub>f&#x2212;1</sub>, x<sub>f3</sub>(t<sub>f&#x2212;1</sub>) is the internal reflux u<sub>2</sub>(t<sub>f&#x2212;1</sub>) at time t<sub>f&#x2212;1</sub>; the output of the fast sampling fuzzy neural network is the prediction value of dissolved oxygen concentration &#x177;<sub>f</sub>(t<sub>f</sub>) at time t<sub>f</sub>; update the parameters of the fast sampling fuzzy neural network by the error between the predicted value and the actual value of dissolved oxygen concentration E<sub>f</sub>(t<sub>f</sub>)=&#xbd;[y<sub>f</sub>(t<sub>f</sub>)&#x2212;&#x177;<sub>f</sub>(t<sub>f</sub>)]<sup>2</sup>:<claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>w</i><sub>fj</sub>(<i>t</i><sub>f+1</sub>)=<i>w</i><sub>fj</sub>(<i>t</i><sub>f</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>f</sub>(<i>t</i><sub>f</sub>)/&#x2202;<i>w</i><sub>fj</sub>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(12)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>fij</sub>(<i>t</i><sub>f+1</sub>)=<i>c</i><sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>f</sub>(<i>t</i><sub>f</sub>)/&#x2202;<i>c</i><sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(13)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3c3;<sub>fij</sub>(<i>t</i><sub>f+1</sub>)=&#x3c3;<sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2212;0.2&#x2202;<i>E</i><sub>f</sub>(<i>t</i><sub>f</sub>)/&#x2202;&#x3c3;<sub>fij</sub>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(14)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text></claim-text></claim-text><claim-text>where w<sub>fj</sub>(t<sub>f+1</sub>) is the weight between the jth regular layer neuron and the output layer neuron of the slow sampling fuzzy neural network at time t<sub>f+1</sub>, c<sub>fij</sub>(t<sub>f+1</sub>) is the center of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f+1</sub>, &#x3c3;<sub>fij</sub>(t<sub>f+1</sub>) is the width of the ith input neuron corresponding to the jth radial basis function neuron of the fast sampling fuzzy neural network at time t<sub>f+1</sub>;<claim-text>{circle around (7)} design an objective function of multi-time scale model predictive control to track the set-points of nitrate nitrogen concentration and dissolved oxygen concentration, and calculate the control law at time t<sub>f</sub>:<claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>J</i>(<i>t</i><sub>f</sub>)=0.25[[<i>r</i><sub>f</sub>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>f</sub>(<i>t</i><sub>f</sub>)]<sup>T</sup>[<i>r</i><sub>f</sub>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>f</sub>(<i>t</i><sub>f</sub>)]+&#x394;<i>u</i>(<i>t</i><sub>f</sub>)<sup>T</sup><i>&#x394;u</i>(<i>t</i><sub>f</sub>)]+0.45[<i>r</i><sub>s</sub>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>s</sub>(<i>t</i><sub>f</sub>)]<sup>T</sup>[<i>r</i><sub>s</sub>(<i>t</i><sub>f</sub>)&#x2212;<i>&#x177;</i><sub>s</sub>(<i>t</i><sub>f</sub>)]&#x394;<i>u</i>(<i>t</i><sub>f</sub>)<sup>T</sup><i>&#x394;u</i>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(15)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text></claim-text></claim-text><claim-text>where r<sub>f</sub>(t<sub>f</sub>)=[r<sub>f</sub>(t<sub>f+1</sub>), r<sub>f</sub>(t<sub>f+2</sub>), r<sub>f</sub>(t<sub>f+3</sub>)]<sup>T </sup>is the set-point of dissolved oxygen concentration, r<sub>f</sub>(t<sub>f+1</sub>)=2 mg/l represents the set-point of dissolved oxygen concentration at time t<sub>f+1</sub>, r<sub>f</sub>(t<sub>f+2</sub>)=2 mg/l represents the set-point of dissolved oxygen concentration at time t<sub>f+2</sub>, r<sub>f</sub>(t<sub>f+3</sub>)=2 mg/l represents the set-point of dissolved oxygen concentration at time t<sub>f+3</sub>; &#x177;<sub>f</sub>(t<sub>f</sub>)=[&#x177;<sub>f</sub>(t<sub>f+1</sub>), &#x177;<sub>f</sub>(t<sub>f+2</sub>), &#x177;<sub>f</sub>(t<sub>f+3</sub>)]<sup>T </sup>is the prediction output of the fast sampling fuzzy neural network, &#x177;<sub>f</sub>(t<sub>f+1</sub>) is the prediction value of dissolved oxygen concentration at time t<sub>f+1</sub>, &#x177;<sub>f</sub>(t<sub>f+2</sub>) is the prediction value of dissolved oxygen concentration at time t<sub>f+2</sub>, &#x177;<sub>f</sub>(t<sub>f+3</sub>) is the prediction value of dissolved oxygen concentration at time t<sub>f+3</sub>; r<sub>s</sub>(t<sub>f</sub>)=[r<sub>s</sub>(t<sub>f+1</sub>), r<sub>s</sub>(t<sub>f+2</sub>), r<sub>s</sub>(t<sub>f+3</sub>)]<sup>T </sup>is the set-point of nitrate nitrogen concentration; r<sub>s</sub>(t<sub>f+1</sub>)=1 mg/l represents the set-point of nitrate nitrogen concentration at time t<sub>f+1</sub>, r<sub>s</sub>(t<sub>f+2</sub>)=1 mg/l represents the set-point of nitrate nitrogen concentration at time t<sub>f+2</sub>, r<sub>s</sub>(t<sub>f+3</sub>)=1 mg/l represents the set-point of nitrate nitrogen concentration at time t<sub>f+3</sub>; &#x177;<sub>s</sub>(t<sub>s</sub>)=[&#x177;<sub>s</sub>(t<sub>s+1</sub>), &#x177;<sub>s</sub>(t<sub>s+2</sub>), &#x177;<sub>s</sub>(t<sub>s+3</sub>)]<sup>T </sup>is the prediction output of slow sampling fuzzy neural network, &#x177;<sub>s</sub>(t<sub>f&#x2212;1</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f+1</sub>, &#x177;<sub>s</sub>(t<sub>f+2</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f+2</sub>, &#x177;<sub>s</sub>(t<sub>f+3</sub>) is the prediction value of nitrate nitrogen concentration at time t<sub>f+3</sub>; &#x394;u(t<sub>f</sub>)=[&#x394;u<sub>1</sub>(t<sub>f</sub>), &#x394;u<sub>2</sub>(t<sub>f</sub>)]<sup>T </sup>is the incremental control moves at time t<sub>f</sub>, &#x394;u<sub>1</sub>(t<sub>f</sub>) is the aeration rate adjustment amount at time t<sub>f</sub>, &#x394;u<sub>2</sub>(t<sub>f</sub>) is the internal reflux adjustment amount at time t<sub>f</sub>, where<claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>u</i>(<i>t</i><sub>f</sub>)=<i>u</i>(<i>t</i><sub>f+1</sub>)&#x2212;<i>u</i>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(16)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?>|&#x394;<i>u</i>(<i>t</i><sub>f</sub>)|&#x2264;&#x394;<i>u</i><sub>max</sub>&#x2003;&#x2003;(17)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text></claim-text><claim-text>u(t<sub>f</sub>)=[u<sub>1</sub>(t<sub>f</sub>), u<sub>2</sub>(t<sub>f</sub>)]<sup>T </sup>is control vector converting into analog signal through programmable logic controller and transmitting to variable frequency driver at time t<sub>f</sub>, u(t<sub>f+1</sub>)=[u<sub>1</sub>(t<sub>f+1</sub>), u<sub>2</sub>(t<sub>f+1</sub>)]<sup>T </sup>is control vector converting into analog signal through programmable logic controller and transmitting to variable frequency driver at time t<sub>f+1</sub>, u<sub>1</sub>(t<sub>f+1</sub>) is the aeration rate at time t<sub>f+1</sub>, u<sub>2</sub>(t<sub>f+1</sub>) is the internal reflux at time t<sub>f+1</sub>; &#x394;u<sub>max</sub>=[&#x394;K<sub>L</sub>a<sub>max</sub>, &#x394;Q<sub>amax</sub>]<sup>T </sup>is the maximum adjustment vector allowed by the controller, &#x394;K<sub>L</sub>a<sub>max</sub>=100 L/min is the maximum aeration adjustment amount, &#x394;Q<sub>amax</sub>=50000 L/min is the maximum internal reflux adjustment amount, &#x394;u<sub>max </sub>is set through the blower and internal reflux valve in the control system equipment;<claim-text>an aeration rate and internal reflux adjustment vector are calculated by minimizing Eq.(15):</claim-text></claim-text><claim-text><maths id="MATH-US-00009" num="00009"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <mrow>       <mi>u</mi>       <mo>&#x2061;</mo>       <mo>(</mo>       <msub>        <mi>t</mi>        <mi>f</mi>       </msub>       <mo>)</mo>      </mrow>     </mrow>     <mo>=</mo>     <mrow>      <mo>(</mo>      <mrow>       <mrow>        <mn>0.</mn>        <mn>4</mn>        <mo>&#x2062;</mo>        <mrow>         <msup>          <mrow>           <mo>(</mo>           <mfrac>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <msub>               <mover accent="true">                <mi>y</mi>                <mi>&#x2c6;</mi>               </mover>               <mi>f</mi>              </msub>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <mi>u</mi>              <mo>&#x2061;</mo>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>           <mo>)</mo>          </mrow>          <mi>T</mi>         </msup>         <mo>[</mo>         <mrow>          <mrow>           <msub>            <mi>r</mi>            <mi>f</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>          <mo>-</mo>          <mrow>           <msub>            <mover accent="true">             <mi>y</mi>             <mi>&#x2c6;</mi>            </mover>            <mi>f</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>         </mrow>         <mo>]</mo>        </mrow>       </mrow>       <mo>+</mo>       <mrow>        <mrow>         <mn>0</mn>         <mo>.</mo>         <mn>0</mn>        </mrow>        <mo>&#x2062;</mo>        <mn>8</mn>        <mo>&#x2062;</mo>        <mrow>         <msup>          <mrow>           <mo>(</mo>           <mfrac>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <msub>               <mover accent="true">                <mi>y</mi>                <mi>&#x2c6;</mi>               </mover>               <mi>s</mi>              </msub>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>            <mrow>             <mo>&#x2202;</mo>             <mrow>              <mi>u</mi>              <mo>&#x2061;</mo>              <mo>(</mo>              <msub>               <mi>t</mi>               <mi>f</mi>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mfrac>           <mo>)</mo>          </mrow>          <mi>T</mi>         </msup>         <mo>[</mo>         <mrow>          <mrow>           <msub>            <mi>r</mi>            <mi>s</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>          <mo>-</mo>          <mrow>           <msub>            <mover accent="true">             <mi>y</mi>             <mi>&#x2c6;</mi>            </mover>            <mi>s</mi>           </msub>           <mo>(</mo>           <msub>            <mi>t</mi>            <mi>f</mi>           </msub>           <mo>)</mo>          </mrow>         </mrow>         <mo>]</mo>        </mrow>       </mrow>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>18</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></claim-text><claim-text>adjust the aeration rate and internal reflux at time t<sub>f</sub>:<claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i>(<i>t</i><sub>f+1</sub>)=<i>u</i>(<i>t</i><sub>f</sub>)+&#x394;<i>u</i>(<i>t</i><sub>f</sub>)&#x2003;&#x2003;(19)<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text>{circle around (8)} if f&#x2264;1000, increase the value of f by 1, increase the value of &#x3b7; by 1, go to step {circle around (2)}; if f&#x3e;1000, end the cycle;</claim-text><claim-text>(6) the concentration of nitrate nitrogen and dissolved oxygen is controlled by u(t<sub>f</sub>), and u(t<sub>f</sub>)=[u<sub>1</sub>(t<sub>f</sub>), u<sub>2</sub>(t<sub>f</sub>)]<sup>T </sup>is transferred to programmable logic controller for digital/analog conversion to obtain U(t<sub>f</sub>)=[U<sub>1</sub>(t<sub>f</sub>), U<sub>2</sub>(t<sub>f</sub>)]<sup>T</sup>, which is the input of variable-frequency drive, the variable-frequency drive changes the working power frequency of motor to control the aeration pump and electronic valve, then, the aeration rate and internal reflux are controlled, the output of the system is the actual value of nitrate nitrogen concentration and dissolved oxygen concentration.</claim-text></claim-text></claim></claims></us-patent-application>