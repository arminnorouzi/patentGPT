<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007045A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007045</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17366285</doc-number><date>20210702</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>29</main-group><subgroup>06</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>20</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>029</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">ACCESS POLICY MANAGEMENT</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Adaptiv Networks Inc.</orgname><address><city>Gatineau</city><country>CA</country></address></addressbook><residence><country>CA</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>KLEMETTI</last-name><first-name>Miika Anttoni</first-name><address><city>Kanata</city><country>CA</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A system for access policy management of a plurality of valid entities communicating over a network comprising a server executing an application programming interface for registration and authentication of said entities directly or via an edge router, one or more encrypted tunnels between entities and one or more gateways. Wherein said server assigns a private IP address to each authenticated entities and propagates said IP address and associated access policies to each of said one or more gateway; and said one or more gateway processing and routing a plurality of packets received from each entity and enforcing one or more access policies associated with the private IP address assigned to the authenticated entity; and said one or more gateways manage routes based on the propagated private IP addresses of each authenticated entities and routes packets to reach one or more remote entities via one or more tunnels to one or more other gateways creating a network overlay between authenticated entities.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="89.32mm" wi="158.75mm" file="US20230007045A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="233.43mm" wi="167.05mm" orientation="landscape" file="US20230007045A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="233.43mm" wi="167.05mm" orientation="landscape" file="US20230007045A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="175.18mm" wi="87.12mm" file="US20230007045A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="203.79mm" wi="161.46mm" orientation="landscape" file="US20230007045A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">BACKGROUND</heading><p id="p-0002" num="0001">In order to maintain secure communications, it is necessary to police the access of entities trying to communicate through the network. <figref idref="DRAWINGS">FIG. <b>1</b></figref> depicts an existing policing system where an edge router <b>104</b> performs the access policing for several entities <b>102</b> in a physical branch/office <b>110</b> in communication, over the internet <b>106</b> with remote entities <b>112</b> and other remote entities <b>114</b>. The other remote entities <b>114</b> can include private clouds, physical branches/offices or simple entities. An entity <b>102</b> can be for example, but not limited to, a user, a group, a device, an application, a service, an Internet of Things device or system or an edge computing location.</p><p id="p-0003" num="0002">Nowadays, a lot of the workflows or communications between entities <b>102</b> is cloud-based. Policing access at the edge router <b>104</b> is not performant for cloud-based workflows, especially if remote entities <b>112</b> require secure access to other remote entities <b>114</b>. Hence, instead of enforcing policies only at the physical network perimeter <b>104</b>, security gateways can be deployed in the cloud, protecting resources regardless of their physical location (e.g., on premises, on cloud).</p><p id="p-0004" num="0003">Zero Trust Network Access (ZTNA) is an approach that removes assumptions and implicit trust from network access control. That is, each request to a resource is individually evaluated, based on the identity of the requesting entity, the context of the request, and risk assessments based on dynamic usage patterns. In ZTNA, belonging to a physical network does not grant access unless it is explicitly configured in the edge router <b>104</b>.</p><p id="p-0005" num="0004">In a typical Zero Trust Architecture (ZTA) the following high-level components are often implemented, where the policy enforcement at the access gateway usually resides in the cloud.<ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0000">    <ul id="ul0002" list-style="none">        <li id="ul0002-0001" num="0005">User identity management and authentication</li>        <li id="ul0002-0002" num="0006">Policy management</li>        <li id="ul0002-0003" num="0007">Policy evaluation and enforcement</li>        <li id="ul0002-0004" num="0008">Security event processing</li>        <li id="ul0002-0005" num="0009">Dynamic risk assessment</li>    </ul>    </li></ul></p><heading id="h-0002" level="1">BRIEF SUMMARY</heading><p id="p-0006" num="0010">In a first embodiment, a system for access policy management of a plurality of valid entities communicating over a network comprising:</p><p id="p-0007" num="0011">a server executing an application programming interface for registration and authentication of said entities;</p><p id="p-0008" num="0012">one or more encrypted tunnels between entities and one or more gateways;</p><p id="p-0009" num="0013">wherein said server assigns a private IP address to each authenticated entities and propagates said IP address and associated access policies to each of said one or more gateway; and said one or more gateway processing and routing a plurality of packets received from each entity and enforcing one or more access policies associated with the private IP address assigned to the authenticated entity; and said one or more gateways manage routes based on the propagated private IP addresses of each authenticated entities and routes packets to reach one or more remote entities via one or more tunnels to one or more other gateways creating a network overlay between authenticated entities.</p><p id="p-0010" num="0000">In a second embodiment, an edge router is performing the authentication and registration for said entities.<br/>In a third embodiment, a method for access policy management of a plurality of valid entities communicating over a network comprising:</p><p id="p-0011" num="0014">managing one or more encrypted tunnels between entities and one or more gateways;</p><p id="p-0012" num="0015">authenticating and registering said entities by a server;</p><p id="p-0013" num="0016">assigning, by said server, a private IP address to each authenticated entities and propagating said IP address and associated access policies to each of said one or more gateway; and processing and routing, by said one or more gateway, a plurality of packets received from each entity and enforcing one or more access policies associated with the private IP address assigned to the authenticated entity; and managing, by said one or more gateways, routes based on the propagated private IP addresses of each authenticated entities and routing packets to reach one or more remote entities via one or more tunnels to one or more other gateways creating a network overlay between authenticated entities.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE SEVERAL VIEWS OF THE DRAWINGS</heading><p id="p-0014" num="0017">To easily identify the discussion of any particular element or act, the most significant digit or digits in a reference number refer to the figure number in which that element is first introduced.</p><p id="p-0015" num="0018"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates existing solutions with central server.</p><p id="p-0016" num="0019"><figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates an embodiment with gateways and authentication API.</p><p id="p-0017" num="0020"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates an embodiment of the gateway.</p><p id="p-0018" num="0021"><figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates an embodiment of the authentication API.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0004" level="1">DETAILED DESCRIPTION</heading><p id="p-0019" num="0022"><figref idref="DRAWINGS">FIG. <b>2</b></figref> depicts an access policy management system comprising an authentication API <b>202</b> and one or more gateway <b>206</b>. The authentication API <b>202</b> is a server that acts as the security broker. Each entity registers to the network via the authentication API <b>202</b> and is explicitly granted access to the network with zero trust. The authentication API <b>202</b> associates a private IP address to each entity <b>102</b> and configures one or more gateway <b>206</b> with access policies for each private IP addresses.</p><p id="p-0020" num="0023">As per <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the gateway <b>206</b> performs packet processing and routing <b>302</b> as known in the art. Furthermore, the gateway <b>206</b> performs access enforcement <b>304</b> based on the private IP address and associated predetermined policies and context provided by the authentication API <b>202</b>. The access from each entity <b>102</b> is monitored and the trust is continuously reassessed. The gateway <b>206</b> uses one or more encrypted tunnels <b>204</b> to carry the packets. The tunnels create an overlay network between known entities.</p><p id="p-0021" num="0024"><figref idref="DRAWINGS">FIG. <b>4</b></figref> depicts an embodiment of the authentication API <b>202</b>. The implementation of the authentication component can be driven by open standards (e.g., OAuth, OpenID, SAML), and may interact with 3<sup>rd </sup>party identity and authentication management (IAM) systems. Once the entity requesting network access has authenticated, the signed access token provided by the authentication service may be used to register themselves for network access.</p><p id="p-0022" num="0025">The authentication and registration for network access is done by entities <b>112</b> directly, and by edge router <b>104</b> on behalf of entities <b>102</b>. The edge router <b>104</b> may be configured to associate each LAN device with a specific user.</p><p id="p-0023" num="0026">In one embodiment entities <b>102</b> explicitly authenticate with edge router <b>104</b> or authentication API <b>202</b> to associate their private IP address with a specific user.</p><p id="p-0024" num="0027">In another embodiment, DHCP server configuration on the edge router <b>104</b> is used to identify each LAN device, and to assign private IP addresses to each device from a pool of IP addresses reserved by the edge router <b>104</b>. As with entities <b>112</b>, the private IP address is used by the gateway to enforce access policies.</p><p id="p-0025" num="0028">Any access policy management framework known in the art can be used, such as, but not limited to, role based access control with inheritance or attribute based access control.</p><p id="p-0026" num="0029">The one or more gateway <b>206</b> manage routes based on the propagated private IP addresses of each authenticated entities <b>102</b> said access gateway routes packets to reach each remote entity <b>112</b> via tunnels to one or more other gateways <b>206</b> to create a network overlay between authenticated entities <b>102</b>.</p><p id="p-0027" num="0030">As an example, a new employee joins a physical branch/office <b>110</b>. An email address is created for the employee in the branch's IAM. The employee may now register for remote network access by providing their email and credentials to the authentication API <b>202</b>. The authentication API <b>202</b> authenticates the email and associates policies based on the user's access roles. The authentication API <b>202</b> then assigns a private IP address and configures access on the gateway <b>206</b> with the appropriate policies. The packets sent by the new employees have the private IP address in the header and are carried on the tunnels of the overlay network based on the policies.</p><p id="p-0028" num="0031">The entity management <b>402</b> and authentication API <b>202</b> allow entities to be managed via an API, with integrations to directory protocols and external identity management services.</p><p id="p-0029" num="0032">Entity registration <b>404</b> is done by assigning a unique identifier (e.g., private IP address) to each entity <b>102</b>, that will be embedded in packet encapsulation and used for identification by the data plane modules. For entities <b>102</b> at branch locations, it is the edge router <b>104</b> responsibility to register itself for network access, and to associate entities <b>102</b> with unique identifiers.</p><p id="p-0030" num="0033">In addition to unique identifier assignment, entity registration is also used to share ephemeral access keys, required to establish encrypted tunnels to gateway <b>206</b>.</p><p id="p-0031" num="0034">For ZTA to enhance security transparently to entities <b>102</b>, special attention needs to be directed towards configuration management options. While many technical or repetitive configuration details may be hidden behind graphical user interfaces and templates, the policies need to be represented in a format that minimizes opportunities for configuration mistakes.</p><p id="p-0032" num="0035">The access policy management <b>406</b> is provided via an API, where policies can be defined according to Role Based Access Control (RBAC) schemes or any other schemes known in the art. Assigning policies to various roles, and assigning roles to entities <b>102</b> or groups of entities <b>102</b>, allows for configurational flexibility and ease of administration.</p><p id="p-0033" num="0036">In one embodiment, the policies are based on static IP address filters, such as subnet filters, to either allow or deny requests. Additional policies to restrict access to higher-level services or applications can also be used (e.g., L7 filters).</p><p id="p-0034" num="0037">Policy evaluation and enforcement will be handled by a data plane module, integrated within the packet processing and routing <b>302</b> engine of the gateway <b>206</b>. These modules match the unique entity <b>102</b> identifiers with configured access policies. As all traffic between the user and the access gateway is encrypted, the authenticity of the packet contents can be verified. The result of the policy evaluation may be either allowed or denied, where denial may happen in either passive fashion by dropping packets, or actively by sending a response for the protocol in question (e.g. TCP RST or HTTP Forbidden).</p><p id="p-0035" num="0038">The mapping of entities <b>102</b> identity to their access roles, and roles to policies, is done by a policy engine <b>408</b>. As policies are managed via API calls, any applicable changes are propagated only to access gateways of concern. The control plane service running on the gateway <b>206</b> configures appropriate data plane modules in real-time, updating the lookup tables used by the data plane modules.</p><p id="p-0036" num="0039">In another embodiment, caching of policy verdicts for individual packet flows is done to ensure acceptable performance. Policy evaluations during packet processing must be kept fast using static policies, with table lookups optimized for quick access. Any advanced threat vector identification may need to happen out-of-band, with dynamic revocation of the cached verdicts.</p><p id="p-0037" num="0040">Networking components are collecting and reporting monitoring data and usage logs. Hence, a cluster of nodes need to be provisioned to consume events, acting as distributed event brokers <b>410</b>. These clusters may need to be scaled horizontally at run-time, with flexibility to buffer events until other services consume them. Optionally, industry standard solutions for the distributed event streaming can be used.</p><p id="p-0038" num="0041">The system provides the foundation for enforcing a great variety of static ZTNA policies suitable for remote access and private networking. However, when policing access to the internet, static policies fall short both in terms of configurational flexibility as well as threat management. Threat vectors may be presented originating from private resources accessing the internet, as well as compromised remote agents connecting to private resources.</p><p id="p-0039" num="0042">A security analytics <b>412</b> module can be used to recognize attacks of malicious insiders or compromised remote agents are both quite difficult without a vast amount of data to analyze. In another embodiment, the context of the request, optionally combined with logs of previous requests are used for risk assessment. A machine learning based algorithm can be trained on real data. In another embodiment, <b>3</b>rd party analytics platforms can be used to complement such analysis on the data collected.</p><p id="p-0040" num="0043">The foregoing descriptions of specific embodiments of the present invention have been presented for purposes of illustration and description. They are not intended to be exhaustive or to limit the invention and method of use to the precise forms disclosed. Obviously, many modifications and variations are possible in light of the above teaching. The embodiments described were chosen and described in order to best explain the principles of the invention and its practical application, and to thereby enable others skilled in the art to best utilize the invention and various embodiments with various modifications as are suited to the particular use contemplated. It is understood that various omissions or substitutions of equivalents are contemplated as circumstance may suggest or render expedient but is intended to cover the application or implementation without departing from the spirit or scope of the claims of the present invention.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A system for access policy management of a plurality of valid entities communicating over a network comprising:<claim-text>a server executing an application programming interface for registration and authentication of said entities;</claim-text><claim-text>one or more encrypted tunnels between entities and one or more gateways;</claim-text><claim-text>wherein said server assigns a private IP address to each authenticated entities and propagates said IP address and associated access policies to each of said one or more gateway; and</claim-text><claim-text>said one or more gateway processing and routing a plurality of packets received from each entity and enforcing one or more access policies associated with the private IP address assigned to the authenticated entity; and</claim-text><claim-text>said one or more gateways manage routes based on the propagated private IP addresses of each authenticated entities and routes packets to reach one or more remote entities via one or more tunnels to one or more other gateways creating a network overlay between authenticated entities.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising an edge router performing the authentication and registration for said entities.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. A method for access policy management of a plurality of valid entities communicating over a network comprising:<claim-text>managing one or more encrypted tunnels between entities and one or more gateways;</claim-text><claim-text>authenticating and registering said entities by a server;</claim-text><claim-text>assigning, by said server, a private IP address to each authenticated entities and propagating said IP address and associated access policies to each of said one or more gateway; and</claim-text><claim-text>processing and routing, by said one or more gateway, a plurality of packets received from each entity and enforcing one or more access policies associated with the private IP address assigned to the authenticated entity; and</claim-text><claim-text>managing, by said one or more gateways, routes based on the propagated private IP addresses of each authenticated entities and routing packets to reach one or more remote entities via one or more tunnels to one or more other gateways creating a network overlay between authenticated entities.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref> further comprising performing, by an edge router, the authentication and registration for said entities.</claim-text></claim></claims></us-patent-application>