<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230006611A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230006611</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17857132</doc-number><date>20220704</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>03</class><subclass>F</subclass><main-group>1</main-group><subgroup>32</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>03</class><subclass>F</subclass><main-group>1</main-group><subgroup>02</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>K</subclass><main-group>9</main-group><subgroup>62</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>063</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>03</class><subclass>F</subclass><main-group>1</main-group><subgroup>3205</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>03</class><subclass>F</subclass><main-group>1</main-group><subgroup>0222</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>K</subclass><main-group>9</main-group><subgroup>6256</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>063</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">AI-ASSISTED POWER AMPLIFIER OPTIMIZATION</invention-title><us-related-documents><us-provisional-application><document-id><country>US</country><doc-number>63218435</doc-number><date>20210705</date></document-id></us-provisional-application></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>MediaTek Inc.</orgname><address><city>Hsinchu City</city><country>TW</country></address></addressbook><residence><country>TW</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Chen</last-name><first-name>Po-Yu</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Chen</last-name><first-name>Hao</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Tsai</last-name><first-name>Yi-Min</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>Chen</last-name><first-name>Hao Yun</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>Kuo</last-name><first-name>Hsien-Kai</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="05" designation="us-only"><addressbook><last-name>Huang</last-name><first-name>Hantao</first-name><address><city>Singapore</city><country>SG</country></address></addressbook></inventor><inventor sequence="06" designation="us-only"><addressbook><last-name>Chen</last-name><first-name>Hsin-Hung</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="07" designation="us-only"><addressbook><last-name>Chang</last-name><first-name>Yu Hsien</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="08" designation="us-only"><addressbook><last-name>Lai</last-name><first-name>Yu-Ming</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="09" designation="us-only"><addressbook><last-name>Wang</last-name><first-name>Lin Sen</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="10" designation="us-only"><addressbook><last-name>Chen</last-name><first-name>Chi-Tsan</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor><inventor sequence="11" designation="us-only"><addressbook><last-name>Yan</last-name><first-name>Sheng-Hong</first-name><address><city>Hsinchu City</city><country>TW</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A compensator compensates for the distortions of a power amplifier circuit. A power amplifier neural network (PAN) is trained to model the power amplifier circuit using pre-determined input and output signal pairs that characterize the power amplifier circuit. Then a compensator is trained to pre-distort a signal received by the PAN. The compensator uses a neural network trained to optimize a loss between a compensator input and a PAN output, and the loss is calculated according to a multi-objective loss function that includes one or more time-domain loss function and one or more frequency-domain loss functions. The trained compensator performs signal compensation to thereby output a pre-distorted signal to the power amplifier circuit.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="78.32mm" wi="158.75mm" file="US20230006611A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="217.00mm" wi="163.49mm" file="US20230006611A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="218.44mm" wi="163.32mm" file="US20230006611A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="198.46mm" wi="149.69mm" file="US20230006611A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="135.89mm" wi="147.32mm" file="US20230006611A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="164.08mm" wi="125.65mm" file="US20230006611A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="96.35mm" wi="86.87mm" file="US20230006611A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading><p id="p-0002" num="0001">This application claims the benefit of U.S. Provisional Application No. 63/218,435 filed on Jul. 5, 2021, the entirety of which is incorporated by reference herein.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">Embodiments of the invention relate to the optimization of a power amplifier using neural networks.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">In most radio frequency (RF) communication systems, power amplifiers (PAs) are a major source of nonlinear and memory effects that can cause severe spectral regrowth. Spectral regrowth significantly degrades the signal quality due to high out-of-band power. Memory effects cause asymmetricity in a transmitted signal. These problems become critical issues for the next-generation 5G technologies. Moreover, in an edge device of 5G communication systems, both the high transmission power and the limited supply voltage can worsen the non-linearity of power amplifiers.</p><p id="p-0005" num="0004">To overcome the aforementioned problems of power amplifiers, digital pre-distortion (DPD) has become a common and practical mechanism considering both integration complexity and effectiveness. A DPD generates a pre-distorted signal to compensate for the impairment caused by a power amplifier. Conventional techniques for DPD designs typically include the derivation of a mathematical power amplifier model and the calculation of the corresponding reverse function that characterizes a DPD. Due to the complex characteristics of 5G communication systems, designing RF components through mathematical modeling is a challenging task. Moreover, these mathematical models need numerous manual adjustments for various specification requirements. Thus, there is a need for the improvement of power amplifier designs.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0006" num="0005">In one embodiment, a method of compensating for power amplifier distortions is provided. The method includes the steps of training a power amplifier neural network (PAN) to model a power amplifier circuit using pre-determined input and output signal pairs that characterize the power amplifier circuit; and training a compensator to pre-distort a signal received by the PAN. The compensator uses a neural network trained to optimize a loss between a compensator input and a PAN output, and the loss is calculated according to a multi-objective loss function that includes one or more time-domain loss function and one or more frequency-domain loss functions. The method further includes the step of performing signal compensation by the trained compensator to thereby output a pre-distorted signal to the power amplifier circuit.</p><p id="p-0007" num="0006">In another embodiment, a system operative to compensate for power amplifier distortions is provided. The system includes memory to store neural network models and processing hardware coupled to the memory. The processing hardware is operative to train a PAN to model a power amplifier circuit using pre-determined input and output signal pairs that characterize the power amplifier circuit; and train a compensator to pre-distort a signal received by the PAN. Thhe compensator uses a neural network trained to optimize a loss between a compensator input and a PAN output, and the loss is calculated according to a multi-objective loss function that includes one or more time-domain loss function and one or more frequency-domain loss functions. The processing hardware is further operative to perform signal compensation by the trained compensator to thereby output a pre-distorted signal to the power amplifier circuit.</p><p id="p-0008" num="0007">Other aspects and features will become apparent to those ordinarily skilled in the art upon review of the following description of specific embodiments in conjunction with the accompanying figures.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0009" num="0008">The present invention is illustrated by way of example, and not by way of limitation, in the figures of the accompanying drawings in which like references indicate similar elements. It should be noted that different references to &#x201c;an&#x201d; or &#x201c;one&#x201d; embodiment in this disclosure are not necessarily to the same embodiment, and such references mean at least one. Further, when a particular feature, structure, or characteristic is described in connection with an embodiment, it is submitted that it is within the knowledge of one skilled in the art to effect such feature, structure, or characteristic in connection with other embodiments whether or not explicitly described.</p><p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. <b>1</b>A</figref> illustrates a system compensating for distortions caused by a power amplifier according to a first embodiment.</p><p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. <b>1</b>B</figref> is a block diagram illustrating a training configuration according to the first embodiment.</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> illustrates a system compensating for distortions caused by a power amplifier according to a second embodiment.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>2</b>B</figref> is a block diagram illustrating a training configuration according to the second embodiment.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>3</b>A</figref> illustrates a system compensating for distortions caused by a power amplifier according to a third embodiment.</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>3</b>B</figref> is a block diagram illustrating a training configuration according to the third embodiment.</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>4</b>A</figref> illustrates a system compensating for distortions caused by a power amplifier according to a fourth embodiment.</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>4</b>B</figref> is a block diagram illustrating a training configuration according to the fourth embodiment.</p><p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a flow diagram illustrating a method of compensating for distortions caused by a power amplifier according to one embodiment.</p><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a block diagram illustrating a device that includes a compensator according to one embodiment.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION</heading><p id="p-0020" num="0019">In the following description, numerous specific details are set forth. However, it is understood that embodiments of the invention may be practiced without these specific details. In other instances, well-known circuits, structures, and techniques have not been shown in detail in order not to obscure the understanding of this description. It will be appreciated, however, by one skilled in the art, that the invention may be practiced without such specific details. Those of ordinary skill in the art, with the included descriptions, will be able to implement appropriate functionality without undue experimentation.</p><p id="p-0021" num="0020">Embodiments of the invention provide an artificial-intelligent (AI)-based method and system to compensate for impairments caused by an RF circuit, such as distortions caused by a power amplifier. Initially, a first neural network is trained to model the characteristics of a power amplifier. Then a compensator is connected to an input end of the trained first neural network, where the compensator includes a second neural network. In one embodiment, the second neural network is a coefficient generator neural network (CGN) that is trained to generate filter coefficients for a digital pre-distorter (DPD). The DPD generates a pre-distorted signal to counteract power amplifier distortions. In another embodiment, the second neural network is a DPD neural network that is trained to generate a pre-distorted signal to counteract power amplifier distortions.</p><p id="p-0022" num="0021">According to embodiments of the invention, the training of the first neural network and the second neural network may be based on a combination of one or more time-domain losses and one or more frequency-domain losses. For example, the time-domain losses may include the mean square error (MSE) and the error vector magnitude (EVM). The frequency-domain losses may include the mean absolute error (MAE) and a specification loss. The combination of the two frequency-domain losses can simultaneously minimize spectral regrowth and optimize the circuit design according to communication specifications.</p><p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. <b>1</b>A</figref> illustrates a system <b>100</b> operative to compensate for distortions caused by a power amplifier <b>110</b> according to an embodiment. The system <b>100</b> may be deployed in a wireless device; more specifically, in the transmitter portion of a wireless device. The system <b>100</b> includes a DPD <b>120</b>, a CGN <b>130</b>, and a digital clipping unit <b>150</b>. The DPD <b>120</b> and the CGN <b>130</b> are collectively referred to as a compensator <b>180</b>. The system <b>100</b> is coupled to the power amplifier <b>110</b>. The system <b>100</b> may further include a digital-to-analog converter (DAC) <b>151</b> and an analog power amplifier <b>152</b> in an embodiment where the power amplifier <b>110</b> is an analog power amplifier. In another embodiment where the power amplifier <b>110</b> is a digital power amplifier, digital signals can be transmitted between the system <b>100</b> and the power amplifier <b>110</b> without conversions by the DAC <b>151</b> and the ADC <b>152</b>. Thus, the DAC <b>151</b> and the ADC <b>152</b> are shown in dotted blocks to indicate that they may not be included in the system <b>100</b> in an alternative embodiment. The following description of signal compensation uses an analog power amplifier as an example; it is understood that the disclosed signal compensation also apply to a digital power amplifier.</p><p id="p-0024" num="0023">The DPD <b>120</b> receives an input signal x and generates a pre-distorted signal z to compensate for the distortions caused by the power amplifier <b>110</b>. In one embodiment, the DPD <b>120</b> is configurable with a set of compensator coefficients. The pre-distorted signal z output from the DPD <b>120</b> is clipped by a digital clipping unit <b>150</b> to limit the signal amplitude received by the power amplifier <b>110</b>. The clipping may speed up the convergence in the training phase of the CGN <b>130</b>. The clipped signal is converted by the DAC <b>151</b> into an analog signal, and the analog signal is amplified by the power amplifier <b>110</b> into an output signal x&#x2032;. For each time instant t, the output signal x&#x2032;(t) is generated from a time sequence of input signal x(t&#x2212;p:t), where p is a configurable value.</p><p id="p-0025" num="0024">The DPD's coefficients are calculated by the CGN <b>130</b>. In one embodiment, the CGN <b>130</b> calculates the filter coefficients c(i)'s is a running index for a total of N filter coefficients) at time instant t using the clipped signal and the ADC-converted power amplifier output x&#x2032;(t&#x2212;1&#x2212;q:t&#x2212;1), where q is a configurable value. The CGN <b>130</b> can update the filter coefficients c(i)'s at runtime.</p><p id="p-0026" num="0025">In one embodiment, the CGN <b>130</b> is a neural network that is trained to generate coefficients for the DPD <b>120</b>. Additionally, the power amplifier <b>110</b> can be modeled by a neural network that is trained to be used in the CGN training.</p><p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. <b>1</b>B</figref> is a block diagram illustrating a training configuration of the system <b>100</b> (<figref idref="DRAWINGS">FIG. <b>1</b>A</figref>) according to one embodiment. The system <b>100</b> can be trained in two training stages. In the first stage, a power amplifier neural network (PAN) <b>111</b> is trained to characterize nonlinear behaviors and memory effects of non-differentiable power amplifier circuits (e.g., the power amplifier <b>110</b> in <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>). After the training of the PAN <b>111</b> is finished, its weights are fixed and used in the second training stage. The CGN <b>130</b> is trained in the second training stage. In one embodiment, one or both the PAN <b>111</b> and the CGN <b>130</b> are trained to optimize a multi-objective loss function. In one embodiment, the PAN <b>111</b> and the CGN <b>130</b> may be trained to optimize the same multi-objective loss function or two different multi-objective loss functions.</p><p id="p-0028" num="0027">The training data for PAN <b>111</b> may be obtained from multiple real power amplifiers (i.e., power amplifier circuits) and processed as time sequence data with two channels including an in-phase (I) channel and a quadrature (Q) channel (e.g., x={I<sub>t</sub>, Q<sub>t</sub>}, t=0, 1, . . . T). When training the PAN <b>111</b>, the real power amplifiers' output is the ground truth and the losses are measured in terms of the difference between the ground truth and the PAN output. After the PAN <b>111</b> is trained and its filter weights are fixed, the trained PAN <b>111</b> is used in the training of the CGN <b>130</b>. When training the CGN <b>130</b>, the input to the DPD <b>120</b> is the ground truth and the losses are measured in terms of the difference between this ground truth and the PAN's output. In the following description of the multi-objective loss function, the ground truth is denoted as x and the PAN output is denoted as {circumflex over (x)}. It is noted that the ground truth x in the PAN <b>111</b> training is the real power amplifiers' output, and the ground truth x in the CGN <b>130</b> training is the input signal. Amplitude normalization is applied to the ground truth x and the PAN output {circumflex over (x)} before the loss is calculated.</p><p id="p-0029" num="0028">In one embodiment, the multi-objective loss function includes a combination of time-domain losses and frequency-domain losses. These losses may be weighted and summed up to generate a total loss value. During each epoch in the training phase, a loss calculator <b>160</b> evaluates the loss function (e.g., calculates the total loss value) and a weight update module <b>170</b> calculates a gradient with respect to the neural network weights. As an example, the weight update module <b>170</b> may implement a gradient-based optimization algorithm such as the Adam algorithm (Kingma et al., ADAM: a method for stochastic optimization, arXiv:1412.6980).</p><p id="p-0030" num="0029">In one embodiment, the multi-objective loss function may include a time-domain loss such as the mean square error (MSE) between the ground truth x and the PAN output {circumflex over (x)}. The MSE can be formulated as follows:</p><p id="p-0031" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>loss<sub>tMSE</sub>(<i>x, {circumflex over (x)}</i>)=log &#x3a3;&#x2225;<i>x&#x2212;{circumflex over (x)}&#x2225;</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0032" num="0030">In the Fourier-transformed spectrum domain, each complex number in an interval represents a specific frequency range. The absolute value describes power magnitude in the specific frequency point. Because the power magnitude of the transmitted signal is generally larger than the out-of-band signal, the mean absolute error (MAE) may be used instead of, or in addition to, the time-domain loss MSE to avoid over biasing on the in-band signals. Thus, the multi-objective loss function may include a frequency-domain loss such as the MAE between the STFT of the ground truth x and the STFT of the PAN output {circumflex over (x)}, where STFT stands for Short Time Fourier Transform which is applied on both x and {circumflex over (x)}. The MAE can be formulated as follows:</p><p id="p-0033" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>loss<sub>fMAE</sub>(<i>x, {circumflex over (x)}</i>)=log &#x3a3;&#x2225;STFT(<i>x</i>)&#x2212;STFT(<i>{circumflex over (x)}</i>)&#x2225;<sub>1 </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0034" num="0031">Instead of or in addition to the aforementioned losses, the multi-objective loss function may include a frequency-domain loss such as the specification loss computed from the adjacent channel leakage power ratio (ACLR). According to the 3GPP specification, ACLR is the ratio of the filtered mean power centered on the assigned channel frequency (i.e., in-band frequency) to the filtered mean power centered on an adjacent channel frequency (i.e., out-of-band frequency). The specification loss is defined to minimize the ACLR difference between the ground truth x and the PAN output {circumflex over (x)}. The formulations of ACLR and the specification loss are as follows:</p><p id="p-0035" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mrow>  <mrow>   <mi>ACLR</mi>   <mo>&#x2061;</mo>   <mo>(</mo>   <mi>x</mi>   <mo>)</mo>  </mrow>  <mo>=</mo>  <mrow>   <mi>log</mi>   <mo>&#x2062;</mo>   <mtext>   </mtext>   <mrow>    <mo>(</mo>    <mfrac>     <mrow>      <msub>       <mo>&#x2211;</mo>       <mi>in_band</mi>      </msub>      <msup>       <mrow>        <semantics definitionURL="">         <mo>&#x2758;</mo>         <annotation encoding="Mathematica">"\[LeftBracketingBar]"</annotation>        </semantics>        <mrow>         <mi>STFT</mi>         <mo>&#x2061;</mo>         <mo>(</mo>         <mi>x</mi>         <mo>)</mo>        </mrow>        <semantics definitionURL="">         <mo>&#x2758;</mo>         <annotation encoding="Mathematica">"\[RightBracketingBar]"</annotation>        </semantics>       </mrow>       <mn>2</mn>      </msup>     </mrow>     <mrow>      <msub>       <mo>&#x2211;</mo>       <mi>out_band</mi>      </msub>      <msup>       <mrow>        <semantics definitionURL="">         <mo>&#x2758;</mo>         <annotation encoding="Mathematica">"\[LeftBracketingBar]"</annotation>        </semantics>        <mrow>         <mi>STFT</mi>         <mo>&#x2061;</mo>         <mo>(</mo>         <mi>x</mi>         <mo>)</mo>        </mrow>        <semantics definitionURL="">         <mo>&#x2758;</mo>         <annotation encoding="Mathematica">"\[RightBracketingBar]"</annotation>        </semantics>       </mrow>       <mn>2</mn>      </msup>     </mrow>    </mfrac>    <mo>)</mo>   </mrow>  </mrow> </mrow></math></maths><maths id="MATH-US-00001-2" num="00001.2"><math overflow="scroll"> <mrow>  <mrow>   <msub>    <mi>loss</mi>    <mrow>     <mi>f</mi>     <mo>&#x2062;</mo>     <mi>SPEC</mi>    </mrow>   </msub>   <mo>(</mo>   <mrow>    <mi>x</mi>    <mo>,</mo>    <mover>     <mi>x</mi>     <mo>^</mo>    </mover>   </mrow>   <mo>)</mo>  </mrow>  <mo>=</mo>  <mrow>   <semantics definitionURL="">    <mo>&#x2758;</mo>    <annotation encoding="Mathematica">"\[LeftBracketingBar]"</annotation>   </semantics>   <mrow>    <mrow>     <mi>ACLR</mi>     <mo>&#x2061;</mo>     <mo>(</mo>     <mi>x</mi>     <mo>)</mo>    </mrow>    <mo>-</mo>    <mrow>     <mi>ACLR</mi>     <mo>&#x2061;</mo>     <mo>(</mo>     <mover>      <mi>x</mi>      <mo>^</mo>     </mover>     <mo>)</mo>    </mrow>   </mrow>   <semantics definitionURL="">    <mo>&#x2758;</mo>    <annotation encoding="Mathematica">"\[RightBracketingBar]"</annotation>   </semantics>  </mrow> </mrow></math></maths></p><p id="p-0036" num="0032">Instead of or in addition to the aforementioned losses, the multi-objective loss function may include a time-domain loss such as the error vector magnitude (EVM). The EVM measures how far the constellation points of a signal deviate from the ideal locations; e.g., the difference (i.e., error vectors) between PAN output symbols and ideal quadrature amplitude modulation (QAM) symbols. The EVM may be calculated as the root mean square (RMS) average amplitude of the error vectors, normalized to an ideal signal amplitude reference. Methods for measuring a transmitter's EVM are known in the art. EVM can be used to quantify the performance loss in the PAN output and can be optimized during training of the CGN <b>130</b>.</p><p id="p-0037" num="0033">In one embodiment, operations of the loss calculator <b>160</b> and the weight update module <b>170</b> may be performed by a general-purpose processor on a device where the power amplifier <b>110</b> is located. In another embodiment, the system <b>100</b> may include specialized hardware or accelerator for training neural networks. The multi-objective loss function used in the training of the PAN <b>111</b> and the CGN <b>130</b> may include the same or a different combination of the aforementioned losses.</p><p id="p-0038" num="0034"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> is a block diagram of a system <b>200</b> operative to compensate for distortions caused by the power amplifier <b>110</b> according to another embodiment. The system <b>200</b> may be deployed in a wireless device; more specifically, in the transmitter portion of a wireless device. The system <b>200</b> includes the DPD <b>120</b> and a CGN <b>230</b>, which are collectively referred to as a compensator <b>280</b>. The system <b>200</b> may also include the DAC <b>151</b> and the ADC <b>152</b> if the power amplifier <b>110</b> is an analog power amplifier.</p><p id="p-0039" num="0035">The CGN <b>230</b> receives its inputs from the output of the power amplifier <b>110</b> and the input signal x. From the inputs, the CGN <b>230</b> generates delta coefficients &#x394;c(i)'s, where i is a running index for a total of N filter coefficients. The delta coefficients are the increments or decrements of the coefficients in two consecutive update time instants. The compensator <b>280</b> includes an accumulator <b>250</b> to accumulate the delta coefficients, and to send the accumulated output (i.e., the filter coefficients c(i)'s) to the DPD <b>120</b>. The coefficients may be initialized to zeros.</p><p id="p-0040" num="0036"><figref idref="DRAWINGS">FIG. <b>2</b>B</figref> is a block diagram illustrating the components used for training the CGN <b>230</b> according to one embodiment. The training follows the same two-stage training process as described before in connection with <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>. When training the PAN <b>111</b> and then the CGN <b>230</b>, a loss calculator <b>260</b> calculates a multi-objective loss function that measures the difference between the ground truth x and the PAN output {circumflex over (x)}. The ground truth x in the PAN <b>111</b> training is the real power amplifiers' output, and the ground truth x in the DPD neural network <b>420</b> training is the input signal. A weight update module <b>270</b> updates the neural network weights based on a gradient with respect to the neural network weights. The multi-objective loss function may be a combination of one or more time-domain losses (e.g., MSE, EVM) and one or more frequency-domain losses (e.g., MAE, ACLR-based specification loss). The multi-objective loss function used in the training of the PAN <b>111</b> and the CGN <b>230</b> may include the same or a different combination of the aforementioned losses.</p><p id="p-0041" num="0037"><figref idref="DRAWINGS">FIG. <b>3</b>A</figref> is a block diagram of a system <b>300</b> operative to compensate for distortions caused by the power amplifier <b>110</b> according to another embodiment. The system <b>300</b> may be deployed in a wireless device; more specifically, in the transmitter portion of a wireless device. The system <b>300</b> includes the DPD <b>120</b> and a CGN <b>330</b>, which are collectively referred to as a compensator <b>380</b>. The system <b>300</b> may also include the DAC <b>151</b> and the ADC <b>152</b> if the power amplifier <b>110</b> is an analog power amplifier.</p><p id="p-0042" num="0038">The CGN <b>330</b> receives its inputs from the output of the power amplifier <b>110</b>, the input signal x, and the previously-generated coefficients. From the inputs, the CGN <b>230</b> generates filter coefficients c(i)'s, where i is a running index for a total of N filter coefficients. The output of the CGN <b>330</b> is sent to the DPD <b>120</b>.</p><p id="p-0043" num="0039"><figref idref="DRAWINGS">FIG. <b>3</b>B</figref> is a block diagram illustrating the components used for training the CGN <b>330</b> according to one embodiment. The training follows the same two-stage training process as described before in connection with <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>. When training the PAN <b>111</b> and then the CGN <b>330</b>, a loss calculator <b>360</b> calculates a multi-objective loss function that measures the difference between the ground truth x and the PAN output {circumflex over (x)}. The ground truth x in the PAN <b>111</b> training is the real power amplifiers' output, and the ground truth x in the DPD neural network <b>420</b> training is the input signal. A weight update module <b>370</b> updates the neural network weights based on a gradient with respect to the neural network weights. The multi-objective loss function may be a combination of one or more time-domain losses (e.g., MSE, EVM) and one or more frequency-domain losses (e.g., MAE, ACLR-based specification loss). The multi-objective loss function used in the training of the PAN <b>111</b> and the CGN <b>330</b> may include the same or a different combination of the aforementioned losses.</p><p id="p-0044" num="0040"><figref idref="DRAWINGS">FIG. <b>4</b>A</figref> is a block diagram of a system <b>400</b> operative to compensate for distortions caused by the power amplifier <b>110</b> according to another embodiment. The system <b>400</b> includes a DPD neural network <b>420</b>, which is a neural network trained to generate a pre-distorted signal z. The DPD neural network <b>420</b> is the compensator for the power amplifier <b>110</b>. In an embodiment where the power amplifier is analog, the pre-distorted signal z is converted to an analog signal by the DAC <b>151</b> for the power amplifier <b>110</b>.</p><p id="p-0045" num="0041"><figref idref="DRAWINGS">FIG. <b>4</b>B</figref> is a block diagram illustrating the components used for training the DPD neural network <b>420</b> according to one embodiment. The training follows the same two-stage training process as described before in connection with <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>. When training the PAN <b>111</b> and then the DPD neural network <b>420</b>, a loss calculator <b>460</b> calculates a multi-objective loss function that measures the difference between the ground truth x and the PAN output {circumflex over (x)}. The ground truth x in the PAN <b>111</b> training is the real power amplifiers' output, and the ground truth x in the DPD neural network <b>420</b> training is the input signal. A weight update module <b>470</b> updates the neural network weights based on a gradient with respect to the neural network weights. The multi-objective loss function may be a combination of one or more time-domain losses (e.g., MSE, EVM) and one or more frequency-domain losses (e.g., MAE, ACLR-based specification loss). The multi-objective loss function used in the training of the PAN <b>111</b> and the DPD neural network <b>420</b> may include the same or a different combination of the aforementioned losses.</p><p id="p-0046" num="0042"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a flow diagram illustrating a method <b>500</b> of compensating for power amplifier distortions according to one embodiment. Method <b>500</b> may be performed by an electronic device, such as the device <b>600</b> in <figref idref="DRAWINGS">FIG. <b>6</b></figref>. In some embodiments, method <b>500</b> may be performed by any of the systems <b>100</b>, <b>200</b>, <b>300</b>, and <b>400</b> in <figref idref="DRAWINGS">FIGS. <b>1</b>A, <b>2</b>A, <b>3</b>A, and <b>4</b>A</figref>, respectively. Alternatively, method <b>500</b> may be performed by a server computer system including memory and processing hardware. The processing hardware performs neural network training and provides the trained neural networks to a device in which the power amplifier is located.</p><p id="p-0047" num="0043">The system at step <b>510</b> trains a power amplifier neural network (PAN) to model a power amplifier circuit using pre-determined input and output signal pairs that characterize the power amplifier circuit. The system at step <b>520</b> trains a compensator to pre-distort a signal received by the PAN. The compensator may be the compensator <b>180</b> in <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, which includes both the DPD <b>120</b> and the CGN <b>130</b>. Alternatively, the compensator may be the compensator <b>280</b> in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>, which includes the DPD <b>120</b>, the accumulator <b>250</b>, and the CGN <b>230</b>. In another embodiment, the compensator may be the compensator <b>380</b> in <figref idref="DRAWINGS">FIG. <b>3</b>A</figref>, which includes the DPD <b>120</b> and the CGN <b>330</b>. In yet another embodiment, the compensator may be the compensator <b>420</b> in <figref idref="DRAWINGS">FIG. <b>4</b>A</figref>, which is also referred to as the DPD neural network <b>420</b>.</p><p id="p-0048" num="0044">The compensator uses a neural network that is trained to optimize a loss between a compensator input and a PAN output. The loss is calculated according to a multi-objective loss function that includes one or more time-domain losses and one or more frequency-domain losses. After the training phase at steps <b>510</b> and <b>520</b> are completed, the system starts an inference phase at step <b>530</b> where the compensator performs signal compensation to output a pre-distorted signal to the power amplifier circuit.</p><p id="p-0049" num="0045">In one embodiment, the multi-objective loss function may include at least a frequency-domain specification loss, which is a difference between an ACLR of the compensator input and an ACLR of the PAN output. In one embodiment, the multi-objective loss function may include at least a frequency-domain MAE calculated from a difference between the STFT of the compensator input and the STFT of the PAN output. In one embodiment, the multi-objective loss function may include at least a time-domain EVM calculated from a difference between PAN output symbols and ideal quadrature amplitude modulation (QAM) symbols. In one embodiment, the multi-objective loss function may include at least a time-domain MSE calculated from a difference between the compensator input and the PAN output. In one embodiment, the multi-objective loss function for training the PAN and the compensator may include any combination of the aforementioned frequency-domain and time-domain losses; a non-limiting example includes a combination of the time-domain MSE, the frequency-domain MAE, and the frequency-domain specification loss.</p><p id="p-0050" num="0046">In one embodiment, training the compensator includes the operations of training a CGN to generate filter coefficients for a DPD that pre-distorts the signal received by the PAN. The CGN is trained to optimize the loss between the input of the DPD and the PAN output. The inputs of the CGN may include the PAN output and a digitally-clipped output of the DPD.</p><p id="p-0051" num="0047">In another embodiment, training the compensator includes the operations of training a CGN to generate delta coefficients and to accumulate the delta coefficients over time to generate filter coefficients for a DPD that pre-distorts the signal received by the PAN. The CGN is trained to optimize the loss between the input of the DPD and the PAN output. In yet another embodiment, training the compensator includes the operations of training a DPD neural network that pre-distorts the signal received by the PAN. The DPD neural network is trained to optimize the loss between the input of the DPD neural network and the PAN output.</p><p id="p-0052" num="0048"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a diagram illustrating a device <b>600</b> including a compensator to compensate for the distortions caused by a power amplifier according to one embodiment. The device <b>600</b> may be a wireless device. The device <b>600</b> includes processing hardware <b>630</b>, which can include any general-purpose and/or special-purpose computing circuitry, such as a central processing circuit (CPU), a graphics processing unit (GPU), a digital signal processor (DSP), a media processor, a neural processing circuit (NPU), AI accelerator, application-specific integrated circuit (ASIC), or the like. In one embodiment, the processing hardware <b>630</b> may evaluate the aforementioned multi-objective loss function and neural network weight updates during training of a power amplifier neural network (PAN), a coefficient generator neural network (CGN), and/or a digital pre-distorter (DPD) neural network.</p><p id="p-0053" num="0049">The device <b>600</b> further includes a memory <b>620</b>. The memory <b>620</b> may include on-chip and off-chip memory devices such as dynamic random access memory (DRAM), static RAM (SRAM), flash memory, and other volatile or non-volatile memory devices. The memory <b>620</b> may include instructions, which when executed by the processing hardware <b>610</b>, cause the processing hardware <b>610</b> to perform neural network training of a PAN, a CGN, and/or a DPD neural network. The memory <b>620</b> may also store neural network models for use as the aforementioned PAN, CGN, and/or DPD neural network.</p><p id="p-0054" num="0050">The neural networks or neural network modules described herein may include one or more of a fully-connected network (FC), a convolutional neural network (CNN), a recurrent neural network (RNN), a graph neural network (GNN), a self-attestation-based network such as a transformer, and the like. The aforementioned PAN, CGN, and/or DPD neural network may be the same or different neural networks.</p><p id="p-0055" num="0051">A non-limiting example of the aforementioned PAN, CGN, and/or DPD neural network is a CNN composed of 6 convolution layers with an input sequence of 128 sample points (input length). In each sample, two input channels are used for I and Q. Each layer is a 1-D convolution with a kernel size of 3 and a stride of 1, and the output channel number for each layer is 16-32-64-64-128-2. Except for the last output layer, each convolution layer is followed by a batch normalization layer and PReLU activation function.</p><p id="p-0056" num="0052">The device <b>600</b> also includes RF circuits <b>640</b>, which further includes at least a power amplifier circuit <b>610</b>. The power amplifier circuit <b>610</b> may be an analog power amplifier circuit or a digital power amplifier circuit. Distortions caused by the power amplifier circuit <b>610</b> can be compensated by a compensator <b>680</b>, which may be any of the compensators <b>180</b> (<figref idref="DRAWINGS">FIG. <b>1</b>A</figref>), <b>280</b> (<figref idref="DRAWINGS">FIG. <b>2</b>A</figref>), <b>380</b> (<figref idref="DRAWINGS">FIG. <b>3</b>A</figref>), or <b>420</b> (<figref idref="DRAWINGS">FIG. <b>4</b>A</figref>). The compensator <b>680</b> includes a neural network for generating filter coefficients, delta coefficients, or pre-distorted signals. The compensator <b>680</b> may include general-purpose or specialized hardware to perform neural network operations. It is understood the embodiment of <figref idref="DRAWINGS">FIG. <b>6</b></figref> is simplified for illustration purposes. Additional hardware components may be included.</p><p id="p-0057" num="0053">Referring to <figref idref="DRAWINGS">FIGS. <b>1</b>B, <b>2</b>B, <b>3</b>B, and <b>4</b>B</figref>, one or more of the PAN <b>111</b>, the compensators (<b>180</b>, <b>280</b>, <b>380</b>, <b>420</b>), the CGNs (<b>130</b>, <b>230</b>, <b>330</b>), and the DPDs (<b>120</b>, <b>220</b>, <b>320</b>) may be implemented in hardware circuitry, software executed by hardware circuitry, or a combination of hardware and software. The hardware circuitry may be special-purpose or general-purpose hardware. Software may be stored on any non-transitory computer-readable medium for use by the device <b>600</b> or by methods executed by the device <b>600</b>.</p><p id="p-0058" num="0054">In this disclosure, a learning-based framework is proposed for power amplifier compensation. The framework improves the performance of power amplifiers used in a 5G communication network. The framework uses deep neural networks (DNNs) to learn the power amplifier's behaviors and characteristics. With the trained neural networks which represent the non-differentiable power amplifier circuits, the corresponding pre-distortion compensation is then learned in an end-to-end training paradigm. In addition, two frequency-domain losses (i.e., MAE and the ACLR-based specification loss) can be used to simultaneously minimize spectral regrowth and optimize the circuit design according to communication specifications.</p><p id="p-0059" num="0055">Various functional components, blocks, or modules have been described herein. As will be appreciated by persons skilled in the art, the functional blocks or modules may be implemented through circuits (either dedicated circuits or general-purpose circuits, which operate under the control of one or more processors and coded instructions), which will typically comprise transistors that are configured in such a way as to control the operation of the circuity in accordance with the functions and operations described herein.</p><p id="p-0060" num="0056">While the invention has been described in terms of several embodiments, those skilled in the art will recognize that the invention is not limited to the embodiments described, and can be practiced with modification and alteration within the spirit and scope of the appended claims. The description is thus to be regarded as illustrative instead of limiting.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001 MATH-US-00001-2" nb-file="US20230006611A1-20230105-M00001.NB"><img id="EMI-M00001" he="14.14mm" wi="76.20mm" file="US20230006611A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A method of compensating for power amplifier distortions, comprising:<claim-text>training a power amplifier neural network (PAN) to model a power amplifier circuit using pre-determined input and output signal pairs that characterize the power amplifier circuit;</claim-text><claim-text>training a compensator to pre-distort a signal received by the PAN, wherein the compensator uses a neural network trained to optimize a loss between a compensator input and a PAN output, and the loss is calculated according to a multi-objective loss function that includes one or more time-domain loss function and one or more frequency-domain loss functions; and</claim-text><claim-text>performing signal compensation by the trained compensator to thereby output a pre-distorted signal to the power amplifier circuit.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the multi-objective loss function includes at least a frequency-domain specification loss, which is a difference between an adjacent channel leakage power ratio (ACLR) of the compensator input and an ACLR of the PAN output, wherein the ACLR is a ratio of filtered mean power centered on an assigned channel frequency to filtered mean power centered on an adjacent channel frequency.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the multi-objective loss function for training the PAN and the compensator includes at least the frequency-domain specification loss, a frequency-domain mean absolute error (MAE) calculated from a difference between Short Time Fourier Transform (STFT) of the compensator input and STFT of the PAN output, and a time-domain mean square error (MSE) calculated from a difference between the compensator input and the PAN output.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the multi-objective loss function includes at least a frequency-domain mean absolute error (MAE) calculated from a difference between Short Time Fourier Transform (STFT) of the compensator input and STFT of the PAN output.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the multi-objective loss function includes at least a time-domain error vector magnitude (EVM) calculated from a difference between PAN output symbols and ideal quadrature amplitude modulation (QAM) symbols.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the multi-objective loss function includes at least a time-domain mean square error (MSE) calculated from a difference between the compensator input and the PAN output.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein training the compensator further comprises:<claim-text>training a coefficient generator neural network (CGN) to generate filter coefficients for a digital pre-distorter (DPD) that pre-distorts the signal received by the PAN, wherein the CGN is trained to optimize the loss between the input of the DPD and the PAN output.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein inputs of the CGN includes the PAN output and a digitally-clipped output of the DPD.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein training the compensator further comprises:<claim-text>training a coefficient generator neural network (CGN) to generate delta coefficients; and</claim-text><claim-text>accumulating the delta coefficients over time to generate filter coefficients for a digital pre-distorter (DPD) that pre-distorts the signal received by the PAN, wherein the CGN is trained to optimize the loss between the input of the DPD and the PAN output.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein training the compensator further comprises:<claim-text>training a digital pre-distorter (DPD) neural network that pre-distorts the signal received by the PAN, wherein the DPD neural network is trained to optimize the loss between the input of the DPD neural network and the PAN output.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. A system comprising:<claim-text>memory to store neural network models; and</claim-text><claim-text>processing hardware coupled to the memory, the processing hardware operative to:<claim-text>train a power amplifier neural network (PAN) to model a power amplifier circuit using pre-determined input and output signal pairs that characterize the power amplifier circuit;</claim-text><claim-text>train a compensator to pre-distort a signal received by the PAN, wherein the compensator uses a neural network trained to optimize a loss between a compensator input and a PAN output, and the loss is calculated according to a multi-objective loss function that includes one or more time-domain loss function and one or more frequency-domain loss functions; and</claim-text><claim-text>perform signal compensation by the trained compensator to thereby output a pre-distorted signal to the power amplifier circuit.</claim-text></claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the power amplifier circuit is a digital circuit.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the power amplifier circuit is an analog circuit.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the multi-objective loss function includes at least a frequency-domain specification loss, which is a difference between an adjacent channel leakage power ratio (ACLR) of the compensator input and an ACLR of the PAN output, wherein the ACLR is a ratio of filtered mean power centered on an assigned channel frequency to filtered mean power centered on an adjacent channel frequency.</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the multi-objective loss function includes at least a frequency-domain mean absolute error (MAE) calculated from a difference between Short Time Fourier Transform (STFT) of the compensator input and STFT of the PAN output.</claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the multi-objective loss function includes at least a time-domain error vector magnitude (EVM) calculated from a difference between PAN output symbols and ideal quadrature amplitude modulation (QAM) symbols.</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the multi-objective loss function includes at least a time-domain mean square error (MSE) calculated from a difference between the compensator input and the PAN output.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the processing hardware is further operative to:<claim-text>train a coefficient generator neural network (CGN) to generate filter coefficients for a digital pre-distorter (DPD) that pre-distorts the signal received by the PAN, wherein the CGN is trained to optimize the loss between the input of the DPD and the PAN output.</claim-text></claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the processing hardware is further operative to:<claim-text>train a coefficient generator neural network (CGN) to generate delta coefficients; and</claim-text><claim-text>accumulate the delta coefficients over time to generate filter coefficients for a digital pre-distorter (DPD) that pre-distorts the signal received by the PAN, wherein the CGN is trained to optimize the loss between the input of the DPD and the PAN output.</claim-text></claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the processing hardware is further operative to:<claim-text>train a digital pre-distorter (DPD) neural network that pre-distorts the signal received by the PAN, wherein the DPD neural network is trained to optimize the loss between the input of the DPD neural network and the PAN output.</claim-text></claim-text></claim></claims></us-patent-application>