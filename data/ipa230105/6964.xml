<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230006965A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230006965</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17896751</doc-number><date>20220826</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>61</main-group><subgroup>4511</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20220501</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>61</main-group><subgroup>4511</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc></classifications-cpc><invention-title id="d2e43">APPLICATION DISCOVERY METHOD AND APPARATUS, AND SYSTEM</invention-title><us-related-documents><continuation><relation><parent-doc><document-id><country>US</country><doc-number>PCT/CN2020/076856</doc-number><date>20200226</date></document-id><parent-status>PENDING</parent-status></parent-doc><child-doc><document-id><country>US</country><doc-number>17896751</doc-number></document-id></child-doc></relation></continuation></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="obligated-assignee"><addressbook><orgname>HUAWEI TECHNOLOGIES CO., LTD.</orgname><address><city>Shenzhen</city><country>CN</country></address></addressbook><residence><country>CN</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>ZHU</last-name><first-name>Fangyuan</first-name><address><city>Beijing</city><country>CN</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>NI</last-name><first-name>Hui</first-name><address><city>Beijing</city><country>CN</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>LI</last-name><first-name>Yan</first-name><address><city>Beijing</city><country>CN</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">This application discloses an application discovery method and apparatus, and a system. A session management function network element receives first information from a first network element, and determines second information based on at least the first information and location information of a terminal device. The session management function network element sends the second information to the first network element. The second information is for obtaining a first IP address corresponding to a first domain name.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="142.58mm" wi="114.55mm" file="US20230006965A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="172.72mm" wi="160.27mm" file="US20230006965A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="154.26mm" wi="116.59mm" file="US20230006965A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="215.48mm" wi="155.19mm" orientation="landscape" file="US20230006965A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="72.73mm" wi="160.36mm" file="US20230006965A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="148.34mm" wi="135.47mm" file="US20230006965A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="195.50mm" wi="155.11mm" file="US20230006965A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="151.47mm" wi="140.63mm" file="US20230006965A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="195.50mm" wi="155.11mm" file="US20230006965A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="151.47mm" wi="140.63mm" file="US20230006965A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="195.50mm" wi="155.11mm" file="US20230006965A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="151.47mm" wi="140.63mm" file="US20230006965A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="195.50mm" wi="157.40mm" file="US20230006965A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00013" num="00013"><img id="EMI-D00013" he="119.63mm" wi="136.57mm" file="US20230006965A1-20230105-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00014" num="00014"><img id="EMI-D00014" he="195.50mm" wi="157.40mm" file="US20230006965A1-20230105-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00015" num="00015"><img id="EMI-D00015" he="119.63mm" wi="136.57mm" file="US20230006965A1-20230105-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00016" num="00016"><img id="EMI-D00016" he="195.50mm" wi="155.11mm" file="US20230006965A1-20230105-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00017" num="00017"><img id="EMI-D00017" he="151.47mm" wi="140.63mm" file="US20230006965A1-20230105-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00018" num="00018"><img id="EMI-D00018" he="222.42mm" wi="130.13mm" orientation="landscape" file="US20230006965A1-20230105-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00019" num="00019"><img id="EMI-D00019" he="178.56mm" wi="117.94mm" file="US20230006965A1-20230105-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading><p id="p-0002" num="0001">This application is a continuation of International Application No. PCT/CN2020/076856, filed on Feb. 26, 2020, the disclosure of which is hereby incorporated by reference in its entirety.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">This application relates to the field of communication technologies, and in particular, to an application discovery method and apparatus, and a system.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">As there are more mobile terminal (for example, mobile phone) users, service functions supported by various mobile terminals keep increasing. For example, functions such as instant messaging, securities, web page browsing, and file download have gradually become mainstream applications on terminal devices, especially smartphones. In an Internet access process, a terminal device needs to query for an Internet protocol (internet protocol, IP) address corresponding to a fully qualified domain name (fully qualified domain name, FQDN), to send a data packet. Usually, the terminal device may send a domain name resolution request to a domain name system (domain name system, DNS) server, where the domain name resolution request carries a domain name that needs to be queried for, and the DNS server returns an IP address corresponding to the domain name, so that the terminal device may access the domain name by using the IP address.</p><p id="p-0005" num="0004">An access network service and an Internet service can be deeply converged by using a mobile edge computing (mobile edge computing, MEC) technology. In the MEC technology, an application server (application server, AS) and some service processing and resource scheduling functions of a mobile broadband (mobile broadband, MBB) core network are deployed at a network edge close to the access network. Services are processed close to users, to provide ultimate service experience with reliability and an ultra-low latency. For example, in a 5th generation (5th generation, 5G) evolution architecture, the terminal device sends the domain name resolution request to the DNS server through a user plane function (user plane function, UPF) network element connected to a MEC platform. However, because application servers deployed on different MEC platforms and providing a same service have a same domain name but different IP addresses, how the DNS server returns an IP address of an application server closer to the terminal device to the terminal device so that the terminal device can access a local service nearby is a problem to be urgently resolved.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0006" num="0005">Embodiments of this application provide an application discovery method and apparatus, and a system, to enable a DNS server to return an IP address of an application server closer to a terminal device to the terminal device, so that the terminal device can access a local service nearby.</p><p id="p-0007" num="0006">According to a first aspect, this application provides an application discovery method. The method includes:</p><p id="p-0008" num="0007">A session management function network element receives first information from a first network element. The session management function network element determines second information based on at least the first information and location information of a terminal device. The session management function network element sends the second information to the first network element. The first information includes at least one of a first domain name or an identifier of a first application that corresponds to the first domain name, and the first domain name is sent by the terminal device. The second information is for obtaining a first IP address corresponding to the first domain name.</p><p id="p-0009" num="0008">In the foregoing method, the session management function network element determines the second information based on the location information of the terminal device and the first information sent by the first network element, and sends the second information to the first network element, so that the first network element sends the first IP address to the terminal device after obtaining the first IP address. When the terminal device accesses the first domain name by using the first IP address at a location indicated by the location information of the terminal device, the terminal device can access a local service nearby, so that a service access latency can be short, to ensure high communication efficiency.</p><p id="p-0010" num="0009">In a possible design, the session management function network element determines, based on the first information, the location information of the terminal device, and location information of at least one application platform on which the first application is deployed, a first application platform in the at least one application platform, where the second information corresponds to the first application platform.</p><p id="p-0011" num="0010">In the foregoing design, the session management function network element may determine, based on the location information of the terminal device and the first information, an application platform in the at least one application platform on which the first application is deployed.</p><p id="p-0012" num="0011">In a possible design, the location information of the at least one application platform on which the first application is deployed includes at least one data network access identifier (DNAI) respectively corresponding to the at least one application platform.</p><p id="p-0013" num="0012">In a possible design, the second information includes a data network access identifier (DNAI) corresponding to the first application platform.</p><p id="p-0014" num="0013">In the foregoing design, an application platform closer to the terminal device may be determined, and an IP address of a server that is of the first application and that is deployed on the application platform is further determined as the first IP address corresponding to the first domain name.</p><p id="p-0015" num="0014">In a possible design, the session management function network element determines the second information based on the first application platform and at least one IP address respectively corresponding to the at least one application platform, where the second information includes an IP address corresponding to the first application platform.</p><p id="p-0016" num="0015">In the foregoing design, an application platform closer to the terminal device may be determined, and an IP address of a server that is of the first application and that is deployed on the application platform is further determined as the first IP address corresponding to the first domain name.</p><p id="p-0017" num="0016">In a possible design, the session management function network element determines the second information based on the first application platform and at least one IP address that is of a local domain name system (DNS) server and that respectively corresponds to the at least one application platform, where the second information includes an IP address of a first local DNS server, and the first local DNS server serves the first application platform.</p><p id="p-0018" num="0017">In the foregoing design, the first local DNS server may be determined, so that the first local DNS server determines an application platform closer to the terminal device, and further determines an IP address of a server that is of the first application and that is deployed on the application platform as the first IP address corresponding to the first domain name.</p><p id="p-0019" num="0018">In a possible design, the session management function network element receives third information from the first network element, and the session management function network element selects a local protocol data unit (PDU) session anchor and an uplink classifier (UL CL) or a branching point (BP) for a PDU session of the terminal device based on the third information. The third information includes at least one of a DNAI corresponding to a second application platform on which the first application is deployed, an IP address corresponding to the second application platform on which the first application is deployed, or the first IP address, and the first IP address is an IP address of a server that is of the first application and that is deployed on the second application platform.</p><p id="p-0020" num="0019">In the foregoing design, the session management function network element may select the local PDU session anchor based on the third information, and further select the UL CL or the BP for the PDU session, to implement local steering, optimize a service access path, and improve the communication efficiency.</p><p id="p-0021" num="0020">In a possible design, the first network element is a DNS proxy, an address resolution function network element, or a centralized DNS server.</p><p id="p-0022" num="0021">According to a second aspect, this application provides an application discovery method. The method includes:</p><p id="p-0023" num="0022">A first network element obtains first information. The first network element sends the first information to a session management function network element. The first network element receives second information from the session management function network element. The first network element sends a first IP address to a terminal device. The first information includes at least one of a first domain name or an identifier of a first application that corresponds to the first domain name, and the first domain name is sent by the terminal device. The second information is for obtaining the first IP address corresponding to the first domain name.</p><p id="p-0024" num="0023">In the foregoing method, the first network element sends the first information to the session management function network element, and receives the second information from the session management function network element. The second information is determined based on location information of the terminal device. After obtaining the first IP address, the first network element sends the first IP address to the terminal device. When the terminal device accesses the first domain name by using the first IP address at a location indicated by the location information of the terminal device, the terminal device can access a local service nearby, so that a service access latency can be short, to ensure high communication efficiency.</p><p id="p-0025" num="0024">In a possible design, the second information includes a DNAI corresponding to a first application platform, and at least one application platform on which the first application is deployed includes the first application platform.</p><p id="p-0026" num="0025">In the foregoing design, an application platform closer to the terminal device may be determined, and an IP address of a server that is of the first application and that is deployed on the application platform is further determined as the first IP address corresponding to the first domain name.</p><p id="p-0027" num="0026">In a possible design, the second information includes an IP address corresponding to a first application platform, and at least one application platform on which the first application is deployed includes the first application platform.</p><p id="p-0028" num="0027">In the foregoing design, an application platform closer to the terminal device may be determined, and an IP address of a server that is of the first application and that is deployed on the application platform is further determined as the first IP address corresponding to the first domain name.</p><p id="p-0029" num="0028">In a possible design, the second information includes an IP address of a first local DNS server, the first local DNS server serves a first application platform, and at least one application platform on which the first application is deployed includes the first application platform.</p><p id="p-0030" num="0029">In the foregoing design, the first local DNS server may be determined, so that the first local DNS server determines an application platform closer to the terminal device, and further determines an IP address of a server that is of the first application and that is deployed on the application platform as the first IP address corresponding to the first domain name.</p><p id="p-0031" num="0030">In a possible design, the first network element is a DNS proxy or an address resolution function network element.</p><p id="p-0032" num="0031">The first network element sends the second information to a communication peer end. The first network element receives fourth information from the communication peer end, where the fourth information includes the first IP address.</p><p id="p-0033" num="0032">In the foregoing design, the first network element may obtain the first IP address.</p><p id="p-0034" num="0033">In a possible design, the first network element is a centralized DNS server. The first network element determines the first IP address based on the second information.</p><p id="p-0035" num="0034">In the foregoing design, the first network element may obtain the first IP address.</p><p id="p-0036" num="0035">In a possible design, the first network element is a DNS proxy, an address resolution function network element, or a centralized DNS server. The first network element sends, to the first local DNS server, a DNS query request received from the terminal device, where the DNS query request includes the first domain name. The first network element receives fourth information from the first local DNS server, where the fourth information includes the first <b>1</b>P address.</p><p id="p-0037" num="0036">In the foregoing design, the first network element may obtain the first IP address.</p><p id="p-0038" num="0037">In a possible design, the first network element sends third information to the session management function network element, where the third information includes at least one of a DNAI corresponding to a second application platform on which the first application is deployed, an IP address corresponding to the second application platform on which the first application is deployed, or the first IP address, and the first IP address is an IP address of a server that is of the first application and that is deployed on the second application platform.</p><p id="p-0039" num="0038">In the foregoing design, the session management function network element may select a local PDU session anchor based on the third information, and further select a UL CL or a BP for a PDU session, to implement local steering, optimize a service access path, and improve the communication efficiency.</p><p id="p-0040" num="0039">According to a third aspect, this application provides a communication apparatus. The apparatus may be a session management function network element, or may be a chip in the session management function network element. The apparatus may include a processing unit, a sending unit, and a receiving unit. It should be understood that the sending unit and the receiving unit herein may alternatively be a transceiver unit. When the apparatus is the session management function network element, the processing unit may be a processor, and the sending unit and the receiving unit may be a transceiver. The session management function network element may further include a storage unit, and the storage unit may be a memory. The storage unit is configured to store instructions. The processing unit executes the instructions stored in the storage unit, so that the session management function network element performs the method according to any one of the first aspect or the possible designs of the first aspect. When the apparatus is the chip in the session management function network element, the processing unit may be a processor, and the sending unit and the receiving unit may be input/output interfaces, pins, circuits, or the like. The processing unit executes instructions stored in a storage unit, so that the chip performs the method according to any one of the first aspect or the possible designs of the first aspect. The storage unit is configured to store the instructions. The storage unit may be a storage unit (for example, a register or a cache) inside the chip, or may be a storage unit (for example, a read-only memory or a random access memory) in the session management function network element and outside the chip.</p><p id="p-0041" num="0040">According to a fourth aspect, this application provides a communication apparatus. The apparatus may be a first network element, or may be a chip in the first network element. The apparatus may include a processing unit, a sending unit, and a receiving unit. It should be understood that the sending unit and the receiving unit herein may alternatively be a transceiver unit. When the apparatus is the first network element, the processing unit may be a processor, and the sending unit and the receiving unit may be a transceiver. The first network element may further include a storage unit, and the storage unit may be a memory. The storage unit is configured to store instructions. The processing unit executes the instructions stored in the storage unit, so that the first network element performs the method according to any one of the second aspect or the possible designs of the second aspect. When the apparatus is the chip in the first network element, the processing unit may be a processor, and the sending unit and the receiving unit may be input/output interfaces, pins, circuits, or the like. The processing unit executes instructions stored in a storage unit, so that the chip performs the method according to any one of the second aspect or the possible designs of the second aspect. The storage unit is configured to store the instructions. The storage unit may be a storage unit (for example, a register or a cache) inside the chip, or may be a storage unit (for example, a read-only memory or a random access memory) in the first network element and outside the chip.</p><p id="p-0042" num="0041">According to a fifth aspect, this application further provides a computer-readable storage medium, where the readable storage medium stores instructions; and when the instructions are executed, the method in the first aspect or the second aspect is implemented.</p><p id="p-0043" num="0042">According to a sixth aspect, this application further provides computer program code. When the computer program code is run on a computer, the computer is enabled to perform the method in the first aspect or the second aspect.</p><p id="p-0044" num="0043">According to a seventh aspect, this application further provides a computer program product including a program. When the computer program product runs on a computer, the computer is enabled to perform the method in the first aspect or the second aspect.</p><p id="p-0045" num="0044">According to an eighth aspect, this application further provides a communication apparatus, including a processor and a memory. The memory is configured to store computer-executable instructions, and the processor is configured to execute the computer-executable instructions stored in the memory, to enable the communication apparatus to perform the method in the first aspect or the second aspect.</p><p id="p-0046" num="0045">According to a ninth aspect, this application further provides a communication apparatus, including a processor and an interface circuit. The interface circuit is configured to receive code instructions and transmit the code instructions to the processor, and the processor runs the code instructions to perform the method in the first aspect or the second aspect.</p><p id="p-0047" num="0046">According to a tenth aspect, this application further provides a communication system. The communication system includes a session management function network element and a first network element, where the session management function network element performs the method in the first aspect, and the first network element performs the method in the second aspect.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a first schematic diagram of a 5G system architecture according to this application;</p><p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a second schematic diagram of a 5G system architecture according to this application;</p><p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a schematic diagram of domain name access according to this application;</p><p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a schematic diagram of a PDU session establishment process according to this application;</p><p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a schematic diagram in which a terminal device requests, after initial PDU session establishment is completed, an IP address corresponding to a domain name according to this application;</p><p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a flowchart of an application discovery method according to this application;</p><p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. <b>7</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>7</b>B</figref> are a first specific flowchart of requesting an IP address corresponding to a domain name by UE according to this application;</p><p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. <b>8</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>8</b>B</figref> are a second specific flowchart of requesting an IP address corresponding to a domain name by UE according to this application;</p><p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. <b>9</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>9</b>B</figref> are a third specific flowchart of requesting an IP address corresponding to a domain name by UE according to this application;</p><p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. <b>10</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>10</b>B</figref> are a fourth specific flowchart of requesting an IP address corresponding to a domain name by UE according to this application;</p><p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. <b>11</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>11</b>B</figref> are a fifth specific flowchart of requesting an IP address corresponding to a domain name by UE according to this application;</p><p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. <b>12</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>12</b>B</figref> are a sixth specific flowchart of requesting an IP address corresponding to a domain name by UE according to this application;</p><p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. <b>13</b></figref> is a schematic diagram of a network architecture including network elements that may be involved in requesting an IP address corresponding to a domain name by UE according to this application;</p><p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. <b>14</b></figref> is a first schematic diagram of a structure of an apparatus according to this application; and</p><p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. <b>15</b></figref> is a second schematic diagram of a structure of an apparatus according to this application.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DESCRIPTION OF EMBODIMENTS</heading><p id="p-0063" num="0062">The following describes embodiments of this application in detail with reference to accompanying drawings.</p><p id="p-0064" num="0063">Embodiments of this application are mainly applied to a 5G system architecture, as shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref> and <figref idref="DRAWINGS">FIG. <b>2</b></figref>. <figref idref="DRAWINGS">FIG. <b>2</b></figref> is a schematic diagram of a 5G network architecture that is based on point-to-point interfaces. A main difference between <figref idref="DRAWINGS">FIG. <b>1</b></figref> and <figref idref="DRAWINGS">FIG. <b>2</b></figref> lies in that an interface between network elements in <figref idref="DRAWINGS">FIG. <b>2</b></figref> is a point-to-point interface instead of a service-oriented interface. It should be understood that all the following embodiments shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref> to <figref idref="DRAWINGS">FIG. <b>12</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>12</b>B</figref> may be applied to but are not limited to the network architectures shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref> and <figref idref="DRAWINGS">FIG. <b>2</b></figref>.</p><p id="p-0065" num="0064">The 5G network architecture may include three parts: a terminal device, a data network (data network, DN), and a carrier network.</p><p id="p-0066" num="0065">The terminal device may also be referred to as a terminal (terminal), user equipment (user equipment, UE), a mobile station (mobile station, MS), a mobile terminal (mobile terminal, MT), or the like. The terminal device may be a mobile phone (mobile phone), a tablet computer (Pad), a computer with a wireless transceiver function, a virtual reality (Virtual Reality, VR) terminal device, an augmented reality (Augmented Reality, AR) terminal device, a wireless terminal in industrial control (industrial control), a wireless terminal in self-driving (self-driving), a wireless terminal in a remote medical surgery (remote medical surgery), a wireless terminal in a smart grid (smart grid), a wireless terminal in transportation safety (transportation safety), a wireless terminal in a smart city (smart city), a wireless terminal in a smart home (smart home), or the like.</p><p id="p-0067" num="0066">The carrier network may include one or more of the following network elements: an authentication server function (authentication server function, AUSF) network element, a network exposure function (network exposure function, NEF) network element, a policy control function (policy control function, PCF) network element, a unified data management (unified data management, UDM) network element, a unified data repository (unified data repository, UDR), a network repository function (network repository function, NRF) network element, an application function (application function, AF) network element, an access and mobility management function (access and mobility management function, AMF) network element, a session management function (session management function, SMF) network element, a radio access network (radio access network, RAN), a user plane function (user plane function, UPF) network element, and the like. In the foregoing carrier network, parts other than the radio access network may be referred to as a core network.</p><p id="p-0068" num="0067">The RAN is configured to implement radio access-related functions.</p><p id="p-0069" num="0068">The AMF network element is configured to implement mobility management functions, and is responsible for user mobility management, including mobility status management, temporary user identity allocation, and user authentication and authorization.</p><p id="p-0070" num="0069">The SMF network element is configured to implement session management functions, and is responsible for UPF network element selection, UPF network element reselection, IP address assignment, bearer establishment, modification, and release, and quality of service (quality of service, QoS) control.</p><p id="p-0071" num="0070">The PCF network element has functions of policy control decision and flow-based charging control, and the functions include a user subscription data management function, a policy control function, a charging policy control function, QoS control, and the like.</p><p id="p-0072" num="0071">The UDM network element is responsible for managing subscription data, and is responsible for notifying a corresponding network element when the subscription data is modified.</p><p id="p-0073" num="0072">The UDR is configured to store and retrieve the subscription data, policy data, common architecture data, and the like, so that the UDM network element, the PCF network element, and the NEF network element obtain related data. The UDR can provide different data access authentication mechanisms for different types of data (such as the subscription data and the policy data), to ensure data access security. For an unauthorized service-oriented operation or data access request, the UDR can return a failure response carrying an appropriate cause value.</p><p id="p-0074" num="0073">The AF network element is configured to provide an application-layer service to the UE. When providing the service to the UE, the AF has requirements on a QoS policy and a charging (charging) policy, and needs to notify a network. In addition, the AF also requires application-related information fed back from the core network.</p><p id="p-0075" num="0074">The NEF network element mainly supports a network capability exposure function, and externally exposes network capabilities and services. A 3GPP network function (network function, NF) publishes a function and an event to another NF through the NEF. The capability and the event that are exposed by the NF may be securely exposed to a third-party application. The NEF stores or retrieves structured data by using a standard interface (Nudr) of the UDR, and translates exchanged information of the AF and exchanged information of an internal network function. For example, the NEF performs conversion between an AF service identifier (AF-Service-Identifier) and internal 5G core information (for example, a data network name (data network name, DNN) and single network slice selection assistance information (single network slice selection assistance information, S-NSSAI)).</p><p id="p-0076" num="0075">The UPF (User Plane Function) network element may support all or a part of the following functions: interconnecting a protocol data unit (protocol data unit, PDU) session with the data network, packet routing and forwarding (for example, supporting forwarding traffic to the data network after the traffic passes through an uplink classifier (uplink classifier, UL CL), and supporting a branching point (branching point, BP) to support a multi-homed (multi-homed) PDU session), and data packet detection.</p><p id="p-0077" num="0076">In addition, network elements in embodiments of this application further include a DNS proxy (proxy), an address resolution function (address resolution function, ARF) network element, and a DNS server (server).</p><p id="p-0078" num="0077">The DNS proxy means enabling a DNS proxy function on a firewall. In this way, when no DNS server is available in a local area network, a client in the local area network may be connected to an external DNS server through the firewall, so that the external DNS server performs correct DNS resolution to implement Internet (internet) access.</p><p id="p-0079" num="0078">A working mechanism of the DNS proxy is as follows: A DNS client sends a DNS request packet to the DNS proxy. In this case, a destination address in the packet is an IP address of the DNS proxy. After receiving the packet, the DNS proxy replaces the destination address in the packet with an IP address of a DNS server, and then forwards the packet to the DNS server based on the configured address of the DNS server. If addresses of a plurality of DNS servers are configured on the DNS proxy, the DNS proxy first sends the packet to the first DNS server. If the first DNS server makes no response, the DNS client resends the DNS request packet after wait duration expires. After receiving the resent DNS request packet, the DNS proxy forwards the DNS request packet to the second DNS server. The rest can be deduced by analogy until a DNS server sends a response packet.</p><p id="p-0080" num="0079">The DNS server is responsible for resolving a domain name to an IP address. For example, a client sends a domain name query request to the DNS server, and the DNS server returns an IP address corresponding to a domain name, so that the terminal device can access the domain name by using the IP address.</p><p id="p-0081" num="0080">The address resolution function network element can support the functions of both the DNS proxy and the DNS server, or support the function of only the DNS proxy or the DNS server.</p><p id="p-0082" num="0081">It should be understood that the descriptions of the functions of the foregoing network elements are not intended to limit this application.</p><p id="p-0083" num="0082">The following briefly describes an existing domain name access process:</p><p id="p-0084" num="0083">As shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, currently, the domain name access process is as follows: Using an example in which a terminal device accesses a domain name A (for example, www.qq.com), when accessing the domain name A, the terminal device queries whether an IP address corresponding to the domain name A exists in a cache of the terminal device. If the IP address exists, the terminal device may directly obtain the IP address, and access the domain name A by using the IP address. If the IP address does not exist, the terminal device may send a domain name resolution request to a DNS server, where the domain name resolution request carries the domain name A. The DNS server returns the IP address corresponding to the domain name A, and the terminal device may access the domain name A by using the <b>1</b>P address.</p><p id="p-0085" num="0084">In addition, after obtaining the IP address corresponding to the domain name A, the terminal device generates and caches a DNS cache record. The DNS cache record represents a correspondence between the domain name A and the IP address. The terminal device further maintains a corresponding time to live (time to live, TTL) for the DNS cache record. The TTL of the DNS cache record is a time period for which the DNS cache record is stored in the cache of the terminal device. In this way, when the terminal device needs to access the domain name A in the DNS cache record again within the TTL of the DNS cache record, the terminal device may directly obtain, based on the DNS cache record, the IP address corresponding to the domain name A. After the TTL of the DNS cache record expires, the terminal device needs to obtain, via the DNS server through the foregoing process, the IP address corresponding to the domain name A.</p><p id="p-0086" num="0085">As shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>, in an initial PDU session establishment process, to select an optimal anchor UPF, a core network selects a PDU session anchor (PDU session anchor, PSA) with reference to a location of a terminal device. However, due to mobility of the terminal device, a location of a remote PSA (namely, the PSA selected in the initial PDU session establishment process) cannot represent a current physical location of the terminal device. Based on <figref idref="DRAWINGS">FIG. <b>4</b></figref>, <figref idref="DRAWINGS">FIG. <b>5</b></figref> is a schematic diagram in which the terminal device requests, after the initial PDU session establishment is completed, an IP address corresponding to a domain name. As shown in <figref idref="DRAWINGS">FIG. <b>5</b></figref>, it is assumed that an address assigned by the core network to the terminal device in the initial PDU session establishment process is IP-3. When the terminal device requests, via the remote PSA, a DNS server to query for a domain name A, the remote PSA sends a DNS query request of the terminal device to the DNS server. The domain name A may correspond to a plurality of application servers deployed in different locations. For example, the application servers corresponding to the domain name A are deployed on two different MEC platforms: an MEC platform-1 and an MEC platform-2. IP addresses of the two application servers are IP-3A and IP-1. The application server whose IP address is the IP-3A is deployed on the MEC platform-1, and the application server whose IP address is the IP-1 is deployed on the MEC platform-2. A deployment location of the MEC platform-1 is closer to the remote PSA, and is farther from the current location of the terminal device. A deployment location of the MEC platform-2 is farther from the remote PSA, and is closer to the current location of the terminal device. Because the DNS server is unaware of the current location of the terminal device, after receiving, from the remote PSA, the DNS query request from the terminal device, the DNS server returns, based on address affinity and the requested domain name A, an IP address of an application server closer to the remote PSA. Therefore, the DNS server returns the address (for example, the IP-3A in <figref idref="DRAWINGS">FIG. <b>5</b></figref>) of the application server deployed on the MEC platform-1. In this case, the terminal device cannot obtain the IP address of the application server deployed on the MEC platform-2, and consequently cannot access a service nearby through the application server deployed on the MEC platform-2. In addition, because the terminal device accesses the service via a remote application server, a latency in accessing the service by the terminal device is increased, and communication efficiency is reduced.</p><p id="p-0087" num="0086">It should be understood that embodiments of this application are also applicable to another future-oriented communication technology. The network architectures and service scenarios described in this application are intended to describe technical solutions in this application more clearly, and do not constitute a limitation on the technical solutions provided in this application. A person of ordinary skill in the art may learn that: With evolution of the network architectures and emergence of new service scenarios, the technical solutions provided in this application are also applicable to similar technical problems.</p><p id="p-0088" num="0087">An embodiment of this application provides an application discovery method. The method enables a DNS server to return an IP address of an application server closer to a terminal device to the terminal device, so that the terminal device can access a local service nearby. In addition, according to the method provided in this embodiment of this application, after the DNS server returns the IP address of the application server closer to the terminal device to the terminal device, service traffic can be selectively routed to an application platform on which the application server is deployed.</p><p id="p-0089" num="0088">As shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the method includes the following steps.</p><p id="p-0090" num="0089">Step <b>600</b>: The terminal device sends a DNS query request to a first network element.</p><p id="p-0091" num="0090">The DNS query request may also be referred to as a domain name resolution request, and includes a first domain name.</p><p id="p-0092" num="0091">Step <b>610</b>: The first network element sends first information to an SMF network element, where the first information includes at least one of the first domain name or an identifier of a first application that corresponds to the first domain name, and the first domain name is sent by the terminal device, namely, the domain name included in the DNS query request in step <b>600</b>.</p><p id="p-0093" num="0092">In an example, the first network element is a DNS proxy, an ARF, or a centralized DNS server, and the first network element receives the DNS query request from the terminal device, where the DNS query request includes the first domain name. In this case, the first network element may send the first information to the SMF network element through a NEF network element, where the first information includes the identifier of the first application that corresponds to the first domain name, or includes the first domain name and the identifier of the first application that corresponds to the first domain name. The first network element may store a correspondence between a domain name and an identifier of an application, to determine, based on the first domain name, the identifier of the first application that corresponds to the first domain name. For example, an AF network element may configure the correspondence for the first network element.</p><p id="p-0094" num="0093">It should be understood that, how the first network element sends the first information to the SMF network element through the NEF network element is described below by using only an example in which the first information includes the identifier of the first application that corresponds to the first domain name. This constitutes no limitation on this application.</p><p id="p-0095" num="0094">The first network element sends a request message to the NEF network element, where the request message carries the identifier of the first application and an IP address of the terminal device. For example, the request message may be an application location request (Nsmf_ApplicationLocation_Request). The NEF network element determines an ID of the terminal device based on the IP address of the terminal device, and determines, based on the ID of the terminal device, an SMF network element serving the terminal device. For example, the ID of the terminal device may be a permanent identifier (subscription Permanent Identifier, SUPI) of the terminal device. The NEF network element sends a request message to the SMF network element serving the terminal device, where the request message carries the identifier of the first application and the ID of the terminal device. For example, the request message may be an application location request.</p><p id="p-0096" num="0095">In another example, the first network element is a DNS proxy, an ARF, or a centralized DNS server, and the first network element receives the DNS query request from the terminal device, where the DNS query request includes the first domain name. In this case, the first network element may send the first information to the SMF network element through a NEF network element, where the first information includes the first domain name. The SMF network element may store a correspondence between a domain name and an identifier of an application, to determine, based on the first domain name, the identifier of the first application that corresponds to the first domain name. For a specific procedure in which the first network element sends the first information to the SMF network element through the NEF network element, refer to the previous example. Details are not described herein again.</p><p id="p-0097" num="0096">It should be noted that the DNS proxy or the ARF may be deployed as an independent network element, or may be integrated with the NEF network element, the AF network element, or another network element in deployment. Therefore, when the DNS proxy or the ARF is integrated with the NEF network element in deployment, the SMF network element may directly interact with the DNS proxy.</p><p id="p-0098" num="0097">Step <b>620</b>: The SMF network element determines second information based on at least the first information and location information of the terminal device.</p><p id="p-0099" num="0098">In a possible design, the SMF network element determines, based on the first information, the location information of the terminal device, and location information of at least one application platform on which the first application is deployed, a first application platform in the at least one application platform on which the first application is deployed. It should be understood that the at least one application platform on which the first application is deployed indicates that there is one or more application platforms, and a server of the first application is deployed on these application platforms.</p><p id="p-0100" num="0099">The location information of the terminal device may be a tracking area identity (tracking area identity, TAI) of the terminal device.</p><p id="p-0101" num="0100">An implementation method used by the SMF network element to obtain the location information of the terminal device is that the SMF network element may obtain the location information of the terminal device from another network element. For example, the SMF network element may obtain the TAI of the terminal device from an AMF network element. In addition, the SMF network element may request the TAI of the terminal device from the AMF network element. When a location of the terminal device changes, the AMF network element may provide a current latest TAI of the terminal device to the SMF network element, so that the SMF network element can determine the location information of the terminal device based on the current latest TAI of the terminal device.</p><p id="p-0102" num="0101">The location information of the at least one application platform on which the first application is deployed may also be described as location information of the at least one application platform on which the server of the first application is deployed. The application platform herein may be a MEC platform, which may also be referred to as a management platform or an application management platform. This is not limited in this application.</p><p id="p-0103" num="0102">An implementation method used by the SMF network element to obtain the location information of the at least one application platform on which the first application is deployed is that the SMF network element may locally configure the location information of the at least one application platform on which the first application is deployed. Another implementation method is that the SMF network element obtains, from another network element, the location information of the at least one application platform on which the first application is deployed. For example, the SMF network element obtains, from a PCF network element or the NEF network element, the location information of the at least one application platform on which the first application is deployed, where the PCF network element or the NEF network element stores the location information of the at least one application platform on which the first application is deployed.</p><p id="p-0104" num="0103">It may be understood that based on the foregoing three pieces of information, the SMF network element may determine, in the at least one application platform on which the first application is deployed, at least one application platform, namely, the first application platform, that is closer to the terminal device. The server of the first application is deployed on the first application platform, and there may be one or more first application platforms. This is not limited in this application.</p><p id="p-0105" num="0104">It may be understood that the first application platform is an application platform on which the server that is of the first application and that is accessed by the terminal device at a current location through an optimal path is located. In other words, when the terminal device sends a data packet to the server that is of the first application and that is deployed on the first application platform, a routing path of the data packet is an optimal path in a current network topology condition. When the terminal device accesses the server of the first application at the current location through the optimal path, if the server of the first application is deployed on a plurality of application platforms, there are a plurality of first application platforms.</p><p id="p-0106" num="0105">It should be understood that the SMF network element may alternatively determine, in the at least one application platform on which the first application is deployed, the first application platform with reference to other information such as load information of the application platform and network topology information. This is not limited in this application. For example, the SMF network element determines, based on the first information, the location information of the terminal device, and the location information of the at least one application platform on which the first application is deployed, a plurality of application platforms in the at least one application platform on which the first application is deployed. The SMF network element further determines, with reference to load information corresponding to the plurality of application platforms, an application platform with lowest load as the first application platform.</p><p id="p-0107" num="0106">For example, the location information of the at least one application platform on which the first application is deployed may include at least one data network access identifier (DN Access Identifier, DNAI) respectively corresponding to the at least one application platform on which the first application is deployed. For example, if the first information includes an FQDN-A, the location information of the at least one application platform on which the first application is deployed may be as shown in Table 1. If the first information includes an APP ID-1, the location information of the at least one application platform on which the first application is deployed may be as shown in Table 2. If the first information includes an FQDN-A and an APP ID-1, the location information of the at least one application platform on which the first application is deployed may be as shown in Table 1, Table 2, or Table 3.</p><p id="p-0108" num="0000"><tables id="TABLE-US-00001" num="00001"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="offset" colwidth="28pt" align="left"/><colspec colname="1" colwidth="77pt" align="left"/><colspec colname="2" colwidth="112pt" align="left"/><thead><row><entry/><entry namest="offset" nameend="2" rowsep="1">TABLE 1</entry></row><row><entry/><entry namest="offset" nameend="2" align="center" rowsep="1"/></row><row><entry/><entry>Domain name</entry><entry>DNAI list (list)</entry></row><row><entry/><entry namest="offset" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/><entry>FQDN-A</entry><entry>DNAI 1 (MEC platform-1)</entry></row><row><entry/><entry/><entry>DNAI 2 (MEC platform-2)</entry></row><row><entry/><entry namest="offset" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0109" num="0000"><tables id="TABLE-US-00002" num="00002"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="offset" colwidth="28pt" align="left"/><colspec colname="1" colwidth="70pt" align="left"/><colspec colname="2" colwidth="119pt" align="left"/><thead><row><entry/><entry namest="offset" nameend="2" rowsep="1">TABLE 2</entry></row><row><entry/><entry namest="offset" nameend="2" align="center" rowsep="1"/></row><row><entry/><entry>APP ID</entry><entry>DNAI list</entry></row><row><entry/><entry namest="offset" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/><entry>APP ID-1</entry><entry>DNAI 1 (MEC platform-1)</entry></row><row><entry/><entry/><entry>DNAI 2 (MEC platform-2)</entry></row><row><entry/><entry namest="offset" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0110" num="0000"><tables id="TABLE-US-00003" num="00003"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="4"><colspec colname="offset" colwidth="14pt" align="left"/><colspec colname="1" colwidth="56pt" align="left"/><colspec colname="2" colwidth="49pt" align="left"/><colspec colname="3" colwidth="98pt" align="left"/><thead><row><entry/><entry namest="offset" nameend="3" rowsep="1">TABLE 3</entry></row><row><entry/><entry namest="offset" nameend="3" align="center" rowsep="1"/></row><row><entry/><entry>Domain name</entry><entry>APP ID</entry><entry>DNAI list</entry></row><row><entry/><entry namest="offset" nameend="3" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/><entry>FQDN-A</entry><entry>APP ID-1</entry><entry>DNAI 1 (MEC platform-1)</entry></row><row><entry/><entry/><entry/><entry>DNAI 2 (MEC platform-2)</entry></row><row><entry/><entry namest="offset" nameend="3" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0111" num="0107">In an example, if the location information of the at least one application platform on which the first application is deployed is the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed, the SMF network element may determine, in the at least one application platform on which the first application is deployed, at least one first application platform based on the first information, the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed, and the location information, such as the TAI, of the terminal device. The at least one DNAI respectively corresponding to the at least one application platform may alternatively be specifically indicated by a DNAI list, where the DNAI list includes at least one DNAI. Specifically, there may be a mapping relationship or a correspondence between the location information of the terminal device and the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed. The SMF network element may determine, based on the location information of the terminal device, the at least one first application platform in the at least one application platform on which the first application is deployed.</p><p id="p-0112" num="0108">Based on this, the SMF network element may determine the second information in manners including but not limited to the following three manners.</p><p id="p-0113" num="0109">Manner 1:</p><p id="p-0114" num="0110">The SMF network element determines the first application platform in the at least one application platform based on the first information, the location information of the terminal device, and the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed. Because there is a correspondence between an application platform and a DNAI corresponding to the application platform, after determining the first application platform, the SMF network element may obtain a DNAI corresponding to the first application platform as the second information. For example, if the first information includes the FQDN-A, and the location information of the at least one application platform on which the first application is deployed may be as shown in Table 1, when the first application platform is the MEC platform-1, the second information includes the DNAI 1.</p><p id="p-0115" num="0111">It may be understood that a DNAI corresponding to an application platform may represent location information of the application platform. Therefore, when obtaining the DNAI corresponding to the first application platform, the first network element obtains location information of the first application platform.</p><p id="p-0116" num="0112">Manner 2:</p><p id="p-0117" num="0113">The SMF network element determines the first application platform in the at least one application platform based on the first information, the location information of the terminal device, and the location information of the at least one application platform on which the first application is deployed. Further, because there is a correspondence between an application platform and an IP address corresponding to the application platform, after determining the first application platform, the SMF network element determines, based on at least one IP address respectively corresponding to the at least one application platform on which the first application is deployed, an IP address corresponding to the first application platform as the second information.</p><p id="p-0118" num="0114">According to existing extension mechanisms for DNS (Extension Mechanisms for DNS, EDNS), an EDNS client subnet option (ECS (EDNS Client Subnet) option) may be added to a DNS query request, and the ECS option includes an IP address of a client, so that a DNS server better determines, based on the IP address of the client, an IP address corresponding to a domain name that the client requests to query for. In this application, because the IP address of the terminal device cannot reflect the location of the terminal device, the first network element needs to request the SMF network element to obtain the second information, where the second information may be added as an ECS option to the DNS query request, so that the DNS server better determines, based on the ECS option, an IP address corresponding to the first domain name that the terminal device requests to query for.</p><p id="p-0119" num="0115">An IP address corresponding to an application platform is an IP address required on a routing path when a network element device in a network accesses the application platform or an IP address required on a communication path when a network element device in a network communicates with the application platform.</p><p id="p-0120" num="0116">For example, an IP address corresponding to an application platform may be a public IP address required for accessing the application platform. For example, the public IP address is any public IP address in a public IP address space at an entrance of the application platform.</p><p id="p-0121" num="0117">For example, an IP address corresponding to an application platform may be a subnet (subnet) IP address or a full IP address (full IP address) required for accessing the application platform. For example, the subnet IP address is a subnet or full IP address that points to the application platform after a UPF network element performs network address translation (Network address translation, NAT) when accessing the application platform over an N6 interface, where the subnet or full IP address is referred to as a subnet IP address (or full IP address) after NAT. It may be understood that an IP address corresponding to an application platform may represent location information of the application platform. Therefore, when obtaining the IP address corresponding to the first application platform, the first network element obtains location information of the first application platform.</p><p id="p-0122" num="0118">For example, the location information of the at least one application platform on which the first application is deployed includes the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed, and the at least one IP address respectively corresponding to the at least one application platform on which the first application is deployed is at least one IP address respectively corresponding to the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed. In other words, the at least one application platform on which the first application is deployed is represented by the corresponding DNAI. For example, the location information of the at least one application platform on which the first application is deployed is as shown in Table 1, and the at least one IP address respectively corresponding to the at least one application platform on which the first application is deployed is as shown in Table 4. When the first application platform is the MEC platform-1, the second information includes IP-1.</p><p id="p-0123" num="0000"><tables id="TABLE-US-00004" num="00004"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="offset" colwidth="14pt" align="left"/><colspec colname="1" colwidth="91pt" align="left"/><colspec colname="2" colwidth="112pt" align="left"/><thead><row><entry/><entry namest="offset" nameend="2" rowsep="1">TABLE 4</entry></row><row><entry/><entry namest="offset" nameend="2" align="center" rowsep="1"/></row><row><entry/><entry>DNAI list</entry><entry>EDNS client subnet (ECS) option</entry></row><row><entry/><entry namest="offset" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/><entry>DNAI 1 (MEC platform-1)</entry><entry>IP-1</entry></row><row><entry/><entry>DNAI 2 (MEC platform-2)</entry><entry>IP-2</entry></row><row><entry/><entry namest="offset" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0124" num="0119">Manner 3:</p><p id="p-0125" num="0120">The SMF network element determines the first application platform in the at least one application platform based on the first information, the location information of the terminal device, and the location information of the at least one application platform on which the first application is deployed. Further, because there is a correspondence between an application platform and an IP address that is of a local DNS server and that corresponds to the application platform, after determining the first application platform, the SMF network element determines an IP address of a first local DNS server as the second information based on at least one IP address that is of a local DNS server and that respectively corresponds to the at least one application platform on which the first application is deployed, where the first local DNS server serves the first application platform.</p><p id="p-0126" num="0121">The local DNS server may be understood as a DNS server located in a local data center. The local DNS server is mainly responsible for performing domain name resolution on an application deployed on a local application platform or the MEC platform. When the at least one application platform on which the first application is deployed includes the local application platform or the MEC platform, a DNS server that serves the local application platform or the MEC platform may be referred to as the local DNS server, and the local DNS server performs domain name resolution on the application deployed on the local application platform or the MEC platform. In this application, the first application platform may be understood as the local application platform or the MEC platform. In this case, a local DNS server that serves the first application platform is referred to as the first local DNS server. In addition, if the at least one application platform on which the first application is deployed includes a plurality of local application platforms or a plurality of MEC platforms, there may be a plurality of local DNS servers serving the local application platforms or the MEC platforms. It may be understood that if there are a plurality of first application platforms, and there are also a plurality of local DNS servers respectively corresponding to the plurality of first application platforms, the SMF network element may select one local DNS server as the first local DNS server according to a local policy. In an implementation, the SMF network element uses a local DNS server with lower load as the first local DNS server based on a load status of each of the plurality of local DNS servers. In another implementation, the SMF network element uses, based on a domain name query list supported by each of the plurality of local DNS servers, a local DNS server that supports a larger quantity of domain name query lists as the first local DNS server.</p><p id="p-0127" num="0122">For example, the location information of the at least one application platform on which the first application is deployed includes the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed, and the at least one IP address that is of the local DNS server and that respectively corresponds to the at least one application platform on which the first application is deployed is at least one IP address that is of the local DNS server and that respectively corresponds to the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed. In other words, the at least one application platform on which the first application is deployed is represented by the corresponding DNAI. For example, the location information of the at least one application platform on which the first application is deployed is as shown in Table 2, and the at least one IP address that is of the local DNS server and that respectively corresponds to the at least one application platform on which the first application is deployed is as shown in Table 5. When the first application platform is the MEC platform-1, the second information includes local DNS server IP-1.</p><p id="p-0128" num="0000"><tables id="TABLE-US-00005" num="00005"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="98pt" align="left"/><colspec colname="2" colwidth="119pt" align="left"/><thead><row><entry namest="1" nameend="2" rowsep="1">TABLE 5</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry/><entry>IP address for local DNS server (IP</entry></row><row><entry>DNAI list</entry><entry>address of a local DNS server)</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>DNAI 1 (MEC platform-1)</entry><entry>local DNS server IP-1</entry></row><row><entry>DNAI 2 (MEC platform-2)</entry><entry>local DNS server IP-2</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0129" num="0123">It should be understood that the foregoing examples are not intended to limit this application.</p><p id="p-0130" num="0124">Step <b>630</b>: The SMF network element sends the second information to the first network element, where the second information is for obtaining a first IP address corresponding to the first domain name.</p><p id="p-0131" num="0125">For example, the SMF network element sends a response message to the first network element through the NEF network element, where the response message includes the second information.</p><p id="p-0132" num="0126">After receiving the first information from the first network element, the SMF network element determines the second information based on at least the first information and the location information of the terminal device. Because the second information is determined based on the location information of the terminal device, the second information is for obtaining, when the terminal device is at a location indicated by the location information, the first IP address corresponding to the first domain name, and the terminal device accesses the first domain name by using the first IP address when the terminal device is at the location indicated by the location information, so that the terminal device can access a local service nearby.</p><p id="p-0133" num="0127">Step <b>640</b>: The first network element sends the first IP address to the terminal device.</p><p id="p-0134" num="0128">After the first network element receives the second information sent by the SMF network element, with reference to step <b>620</b>, because content included in the second information varies, the first network element may obtain the first IP address by using possible designs including but not limited to the following three possible designs.</p><p id="p-0135" num="0129">In a first possible design, if the second information includes the DNAI corresponding to the first application platform or the IP address corresponding to the first application platform, and the first network element is the DNS proxy or the ARF, the first network element sends the second information to a communication peer end. The first network element receives fourth information from the communication peer end, where the fourth information includes the first IP address.</p><p id="p-0136" num="0130">In a second possible design, if the second information includes the DNAI corresponding to the first application platform or the IP address corresponding to the first application platform, and the first network element is the centralized DNS server, the first network element determines the first IP address based on the second information.</p><p id="p-0137" num="0131">In a third possible design, if the second information includes the IP address of the first local DNS server, and the first network element is the DNS proxy, the ARF, or the centralized DNS server, the first network element sends, to the first local DNS server, the DNS query request received from the terminal device, where the DNS query request includes the first domain name. The first network element receives fourth information from the first local DNS server, where the fourth information includes the first IP address.</p><p id="p-0138" num="0132">The following describes the foregoing possible designs with reference to specific examples.</p><p id="p-0139" num="0133">Example 1: The second information includes the DNAI corresponding to the first application platform, and the first network element is the DNS proxy. Specifically, in the following, a DNAI list may represent the second information, and the DNAI list includes the DNAI corresponding to the first application platform. The DNS proxy determines, based on the correspondence between the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed and the at least one IP address respectively corresponding to the at least one application platform on which the first application is deployed, the <b>1</b>P address corresponding to the first application platform, and adds, as an ECS option list, the IP address corresponding to the first application platform to a DNS request message. The ECS option list includes one or more ECS options, and each ECS option includes the IP address corresponding to the first application platform. If there are a plurality of first application platforms, there are also a plurality of IP addresses corresponding to the plurality of first application platforms. The DNS proxy adds, as the ECS option list, the IP addresses respectively corresponding to the plurality of application platforms to the DNS request message. If a destination address in the DNS query request is an address of the DNS proxy, the DNS proxy sends the DNS request message including the ECS option list to the centralized DNS server based on a configured address of the centralized DNS server. If a destination address in the DNS query request is an address of the centralized DNS server, the DNS proxy sends the DNS request message including the ECS option list to the centralized DNS server. The centralized DNS server determines, based on the first domain name and the ECS option list that are included in the DNS query request, an application platform to which the IP address in the ECS option list points, and further determines an IP address of a server that is of the first application and that is deployed on the application platform, namely, the first IP address. The centralized DNS server supports the first domain name. The centralized DNS server sends a DNS response message to the DNS proxy, where the DNS response message includes the first IP address. The DNS proxy sends a DNS response message to the terminal device, where the DNS response message includes the first IP address.</p><p id="p-0140" num="0134">In addition, when there are a plurality of first application platforms, the DNAI list includes a plurality of DNAIs, and the DNS proxy determines the ECS option list based on the correspondence between the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed and the at least one IP address respectively corresponding to the at least one application platform on which the first application is deployed, where the ECS option list includes IP addresses respectively corresponding to the plurality of DNAIs. The centralized DNS server determines a target ECS option based on the first domain name and the ECS option list, determines an application platform to which an IP address corresponding to the target ECS option points, and further determines an IP address of a server that is of the first application and that is deployed on the application platform as the first IP address. It may be understood that the IP address included in the ECS option may represent location information of the application platform. In this case, the DNS server determines, based on the IP address included in each ECS option in the ECS option list, location information of an application platform represented by the IP address, and further determines an IP address of a server that is of the first application and that is deployed on the application platform as the first IP address.</p><p id="p-0141" num="0135">When the ECS option list includes a plurality of IP addresses, the centralized DNS server may determine the target ECS option in the ECS option list according to a local policy. In an implementation, when the DNS server determines a plurality of MEC platforms based on the plurality of IP addresses included in the ECS option list, the DNS server uses an MEC platform with lower load as a target MEC platform based on load statuses of the plurality of MEC platforms, and uses, as the target ECS option, an ECS option including an IP address corresponding to the MEC platform.</p><p id="p-0142" num="0136">It should be noted that the DNS proxy in the example 1 may be replaced with the ARF.</p><p id="p-0143" num="0137">Example 2: The second information includes the IP address corresponding to the first application platform, and the first network element is the DNS proxy. Specifically, in the following, an ECS option list may represent the second information, and the ECS option list includes the IP address corresponding to the first application platform. The ECS option list includes one or more ECS options, and each ECS option includes the IP address corresponding to the first application platform. If there are a plurality of first application platforms, there are also a plurality of IP addresses corresponding to the plurality of first application platforms. The DNS proxy adds, as the ECS option list, the IP addresses respectively corresponding to the plurality of application platforms to a DNS request message. If a destination address in the DNS query request is an address of the DNS proxy, the DNS proxy sends the DNS request message including the ECS option list to the centralized DNS server based on a configured address of the centralized DNS server. If a destination address in the DNS query request is an address of the centralized DNS server, the DNS proxy sends the DNS request message including the ECS option list to the centralized DNS server. The centralized DNS server determines, based on the first domain name and the ECS option list that are included in the DNS query request, an application platform to which the IP address in the ECS option list points, and further determines an IP address of a server that is of the first application and that is deployed on the application platform, namely, the first IP address. The centralized DNS server supports the first domain name. The centralized DNS server sends a DNS response message to the DNS proxy, where the DNS response message includes the first IP address. The DNS proxy sends a DNS response message to the terminal device, where the DNS response message includes the first IP address.</p><p id="p-0144" num="0138">In addition, when there are a plurality of first application platforms, the ECS option list includes a plurality of IP addresses. The centralized DNS server determines a target ECS option based on the first domain name and the ECS option list, determines an application platform to which an IP address corresponding to the target ECS option points, and further determines an IP address of a server that is of the first application and that is deployed on the application platform as the first IP address. It may be understood that the IP address included in the ECS option may represent location information of the application platform. In this case, the DNS server determines, based on the IP address included in each ECS option in the ECS option list, location information of an application platform represented by the IP address, and further determines an IP address of a server that is of the first application and that is deployed on the application platform as the first IP address.</p><p id="p-0145" num="0139">Similarly, when the ECS option list includes a plurality of IP addresses, the centralized DNS server may determine the target ECS option in the ECS option list according to a local policy. Repeated content is not described again.</p><p id="p-0146" num="0140">It should be noted that the DNS proxy in the example 2 may be replaced with the ARF.</p><p id="p-0147" num="0141">Example 3: The second information includes the DNAI corresponding to the first application platform, and the first network element is the centralized DNS server. Specifically, in the following, a DNAI list may represent the second information, and the DNAI list includes the DNAI corresponding to the first application platform. An ECS option list includes one or more ECS options, and each ECS option includes the IP address corresponding to the first application platform. If there are a plurality of first application platforms, there are also a plurality of IP addresses corresponding to the plurality of first application platforms. The centralized DNS server determines, based on the correspondence between the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed and the at least one IP address respectively corresponding to the at least one application platform on which the first application is deployed, the IP address corresponding to the first application platform, and uses the <b>1</b>P address corresponding to the first application platform as the ECS option list. The centralized DNS server determines, based on the first domain name and the ECS option list, an application platform to which the IP address in the ECS option list points, and further determines an IP address of a server that is of the first application and that is deployed on the application platform, namely, the first IP address. The centralized DNS server supports the first domain name. The centralized DNS server sends a DNS response message to the terminal device, where the DNS response message includes the first IP address.</p><p id="p-0148" num="0142">In addition, when there are a plurality of first application platforms, the DNAI list includes a plurality of DNAIs, and the DNS proxy determines the ECS option list based on the correspondence between the at least one DNAI respectively corresponding to the at least one application platform on which the first application is deployed and the at least one IP address respectively corresponding to the at least one application platform on which the first application is deployed, where the ECS option list includes IP addresses respectively corresponding to the plurality of DNAIs. The centralized DNS server determines a target ECS option based on the first domain name and the ECS option list, determines an application platform to which an IP address corresponding to the target ECS option points, and further determines an IP address of a server that is of the first application and that is deployed on the application platform as the first IP address. It may be understood that the IP address included in the ECS option may represent location information of the application platform. In this case, the DNS server determines, based on the IP address included in each ECS option in the ECS option list, location information of an application platform represented by the IP address, and further determines an IP address of a server that is of the first application and that is deployed on the application platform as the first IP address.</p><p id="p-0149" num="0143">When the ECS option list includes a plurality of IP addresses, the centralized DNS server may determine the target ECS option in the ECS option list according to a local policy. The centralized DNS server sends a DNS response message to the terminal device, where the DNS response message includes the first IP address. Repeated content is not described again.</p><p id="p-0150" num="0144">It should be noted that the centralized DNS server in the example 3 may be replaced with the ARF.</p><p id="p-0151" num="0145">Example 4: The second information includes the IP address corresponding to the first application platform, and the first network element is the centralized DNS server. Specifically, in the following, an ECS option list may represent the second information, and the ECS option list includes the IP address corresponding to the first application platform. The ECS option list includes one or more ECS options, and each ECS option includes the IP address corresponding to the first application platform. If there are a plurality of first application platforms, there are also a plurality of IP addresses corresponding to the plurality of first application platforms. The centralized DNS server determines, based on the first domain name and the ECS option list, an application platform to which the IP address in the ECS option list points, and further determines an IP address of a server that is of the first application and that is deployed on the application platform, namely, the first IP address. The centralized DNS server supports the first domain name. The centralized DNS server sends a DNS response message to the terminal device, where the DNS response message includes the first IP address.</p><p id="p-0152" num="0146">In addition, when there are a plurality of first application platforms, the ECS option list includes a plurality of IP addresses. The centralized DNS server determines a target ECS option based on the first domain name and the ECS option list, determines an application platform to which an IP address corresponding to the target ECS option points, and further determines an IP address of a server that is of the first application and that is deployed on the application platform as the first IP address. It may be understood that the IP address included in the ECS option may represent location information of the application platform. In this case, the DNS server determines, based on the IP address included in each ECS option in the ECS option list, location information of an application platform represented by the IP address, and further determines an IP address of a server that is of the first application and that is deployed on the application platform as the first IP address.</p><p id="p-0153" num="0147">Similarly, when the ECS option list includes a plurality of IP addresses, the centralized DNS server may determine the target ECS option in the ECS option list according to a local policy. Repeated content is not described again.</p><p id="p-0154" num="0148">It should be noted that the centralized DNS server in the example 4 may be replaced with the ARF.</p><p id="p-0155" num="0149">In addition, in a possible design, the first network element sends third information to the SMF network element, where the third information includes at least one of a DNAI corresponding to a second application platform on which the first application is deployed, an IP address corresponding to the second application platform on which the first application is deployed, or the first IP address. The first IP address is an IP address of a server that is of the first application and that is deployed on the second application platform. The SMF network element selects a UL CL or a BP and a local PDU session anchor for a PDU session of the terminal device based on the third information, so that after the DNS server returns an IP address of an application server closer to the terminal device to the terminal device, service traffic is selectively routed to an application platform on which the application server is deployed. It should be understood that the second application platform is an application platform in the at least one first application platform.</p><p id="p-0156" num="0150">In conclusion, the first network element sends the first information to the SMF network element. The SMF network element determines the second information based on the location information of the UE and the first information, and sends the second information to the first network element, where the second information is for obtaining the first IP address corresponding to the first domain name sent by the terminal device. After obtaining the first IP address, the first network element sends the first IP address to the terminal device. Therefore, when the terminal device accesses the first domain name by using the first IP address at the location indicated by the location information of the terminal device, the terminal device can access a local service nearby, so that a service access latency can be reduced, to improve communication efficiency.</p><p id="p-0157" num="0151">The following describes the embodiment shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref> in detail with reference to specific embodiments.</p><p id="p-0158" num="0152">Embodiment 1: <figref idref="DRAWINGS">FIG. <b>7</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>7</b>B</figref> are a first specific flowchart of requesting an IP address corresponding to a domain name by UE when a first network element is a DNS proxy. <figref idref="DRAWINGS">FIG. <b>13</b></figref> is a schematic diagram of a network architecture including network elements that may be involved in the embodiment shown in <figref idref="DRAWINGS">FIG. <b>7</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>7</b>B</figref>. A correspondence among a domain name, an identifier of an application, and at least one DNAI respectively corresponding to at least one application platform on which each application is deployed is configured on the DNS proxy. The DNS proxy may obtain the configured content through an AF. In addition, an IP address corresponding to each application platform is configured on an SMF network element. Each application platform is represented by a DNAI corresponding to the application platform.</p><p id="p-0159" num="0153">S<b>701</b>: The UE initiates a PDU session establishment procedure.</p><p id="p-0160" num="0154">Specifically, the UE sends parameters such as a PDU session identifier, S-NSSAI, and a DNN to an AMF network element. The AMF network element selects the SMF network element based on the S-NSSAI and the DNN, and sends parameters such as an identifier of the AMF network element, a permanent identifier of the UE, location information of the UE, the PDU session identifier, the S-NSSAI, and the DNN to the SMF network element. The location information of the UE includes a TAI of the UE. The SMF selects an anchor UPF network element for a PDU session.</p><p id="p-0161" num="0155">S<b>702</b>: The UE sends a DNS query request to the anchor UPF network element through an access network device.</p><p id="p-0162" num="0156">The DNS query request carries a domain name, and further includes a destination address, where the destination address is an address of the DNS proxy or an address of a centralized DNS server. The centralized DNS server may be a centralized DNS server deployed by a carrier. The domain name carried in the DNS query request may be an FQDN or a domain name in another form. This is not limited in this application. The following only uses the FQDN as an example for description.</p><p id="p-0163" num="0157">S<b>703</b>: The UPF network element sends the DNS query request to the DNS proxy.</p><p id="p-0164" num="0158">Specifically, after the UPF network element receives the DNS query request, if the destination address in the DNS query request is the address of the DNS proxy, the UPF sends the DNS query request to the DNS proxy; or if the destination address in the DNS query request is the address of the centralized DNS server, in a routing process in which the UPF sends the DNS query request to the centralized DNS server, the DNS query request first passes through the DNS proxy before reaching the centralized DNS server.</p><p id="p-0165" num="0159">S<b>704</b>: The DNS proxy obtains first information.</p><p id="p-0166" num="0160">Specifically, the DNS proxy determines, based on the FQDN in the DNS query request and the correspondence between a domain name and an identifier of an application, an APP ID corresponding to the FQDN in the DNS query request. The first information includes the APP ID.</p><p id="p-0167" num="0161">S<b>705</b>: The DNS proxy sends a request message to a NEF network element, where the request message carries the APP ID and UE <b>1</b>P.</p><p id="p-0168" num="0162">S<b>706</b>: The NEF network element sends a request message to the SMF network element, where the request message carries the APP ID and a UE ID or the UE IP.</p><p id="p-0169" num="0163">Specifically, the NEF network element determines the UE ID based on the UE IP, and determines, based on the UE ID, the SMF network element that serves the UE, where the UE ID may be the permanent identifier SUPI of the UE.</p><p id="p-0170" num="0164">S<b>707</b>: The SMF network element determines an ECS option list.</p><p id="p-0171" num="0165">Specifically, the SMF network element determines a DNAI list based on the APP ID, a current TAI of the UE, and at least one DNAI respectively corresponding to at least one application platform on which an application identified by the APP ID is deployed, and determines, based on the DNAI list and an IP address corresponding to each application platform, an IP address corresponding to each DNAI in the DNAI list, to obtain the ECS option list.</p><p id="p-0172" num="0166">The DNAI list includes at least one DNAI, and the ECS option list includes at least one ECS option respectively corresponding to the at least one DNAI. Each ECS option includes one IP address.</p><p id="p-0173" num="0167">S<b>708</b>: The SMF sends a response message to the DNS proxy through the NEF network element, where the response message carries the ECS option list and the UE IP.</p><p id="p-0174" num="0168">S<b>709</b>: The DNS proxy adds the ECS option list to the DNS query request, and sends the DNS query request including the ECS option list to the centralized DNS server.</p><p id="p-0175" num="0169">If the destination address in the DNS query request sent by the UE is the IP address of the DNS proxy, the DNS proxy adds the ECS option list to the DNS query request, and sends the DNS query request including the ECS option list to the centralized DNS server based on the IP address of the centralized DNS server configured on the DNS proxy.</p><p id="p-0176" num="0170">If the destination address in the DNS query request sent by the UE is the IP address of the centralized DNS server, the DNS proxy adds the ECS option list to the DNS query request, and sends the DNS query request including the ECS option list to the centralized DNS server based on the destination address.</p><p id="p-0177" num="0171">S<b>710</b>: The centralized DNS server sends a DNS response message to the DNS proxy, where the DNS response message carries an IP address corresponding to the FQDN.</p><p id="p-0178" num="0172">Specifically, the centralized DNS server determines, based on the FQDN and the ECS option list that are in the DNS query request, an application platform to which the IP address in the ECS option points, and further determines an IP address of a server deployed on the application platform as the IP address corresponding to the FQDN. The server supports the FQDN in the DNS query request.</p><p id="p-0179" num="0173">If the ECS option list includes a plurality of ECS options, the centralized DNS server may select a target ECS option from the plurality of ECS options, and further determine, as the IP address corresponding to the FQDN, an IP address of a server deployed on an application platform corresponding to the target ECS option. The server supports the FQDN in the DNS query request.</p><p id="p-0180" num="0174">S<b>711</b>: The DNS proxy sends a target DNAI and the UE IP to the SMF network element through the NEF.</p><p id="p-0181" num="0175">Specifically, the DNS proxy determines, based on the IP address that corresponds to the FQDN and that is carried in the DNS response message, a DNAI (referred to as the target DNAI) of the application platform on which the server to which the IP address points is deployed.</p><p id="p-0182" num="0176">For example, a correspondence between an IP address space (or an IP address segment) and a DNAI of an application platform corresponding to the IP address space is configured on the DNS proxy. For example, the DNS proxy may obtain the configured content through the AF. When obtaining the IP address corresponding to the FQDN, the DNS proxy may determine an address space (or an IP address segment) to which the IP address belongs, and further determine a DNAI of an application platform corresponding to the address space (or the IP address segment).</p><p id="p-0183" num="0177">The UE IP may be used to identify the UE.</p><p id="p-0184" num="0178">S<b>712</b>: The SMF network element selects a local PSA network element and a UL CL or a BP for the PDU session based on the target DNAI.</p><p id="p-0185" num="0179">Specifically, the SMF network element determines the PDU session of the UE based on the UE IP, and selects the local PSA network element for the PDU session based on the target DNAI. Further, the SMF selects the UL CL or the BP for the PDU session based on the target DNAI, to implement local steering, optimize a service access path, and improve communication efficiency.</p><p id="p-0186" num="0180">S<b>713</b>: After performing S<b>711</b>, the SMF network element sends an acknowledgment message to the DNS proxy.</p><p id="p-0187" num="0181">The acknowledgment message carries the UE IP.</p><p id="p-0188" num="0182">S<b>714</b>: The DNS proxy sends a DNS response message to the UE through the anchor UPF, where the DNS response message carries the IP address corresponding to the FQDN.</p><p id="p-0189" num="0183">It should be noted that, the DNS proxy in Embodiment 1 may be replaced with an ARF.</p><p id="p-0190" num="0184">In Embodiment 1, in a scenario in which the first network element is the DNS proxy, and second information includes the ECS option list, when the UE accesses, by using the IP address returned by the first network element, the FQDN at a location indicated by the location information of the UE, the UE can access a local service nearby, and a service access latency can be reduced, to improve the communication efficiency.</p><p id="p-0191" num="0185">Embodiment 2: <figref idref="DRAWINGS">FIG. <b>8</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>8</b>B</figref> are a second specific flowchart of requesting an IP address corresponding to a domain name by UE when a first network element is a DNS proxy. <figref idref="DRAWINGS">FIG. <b>13</b></figref> is a schematic diagram of a network architecture including network elements that may be involved in the embodiment shown in <figref idref="DRAWINGS">FIG. <b>8</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>8</b>B</figref>. A correspondence among a domain name, an identifier of an application, and at least one DNAI respectively corresponding to at least one application platform on which each application is deployed and an IP address corresponding to each application platform are configured on the DNS proxy. Each application platform is represented by a DNAI corresponding to the application platform. The DNS proxy may obtain the configured content through an AF.</p><p id="p-0192" num="0186">For details of S<b>801</b> to S<b>806</b>, refer to S<b>701</b> to S<b>706</b>, and repeated content is not described again.</p><p id="p-0193" num="0187">S<b>807</b>: The SMF network element determines a DNAI list.</p><p id="p-0194" num="0188">Specifically, the SMF network element determines the DNAI list based on the APP ID, a current TAI of the UE, and at least one DNAI respectively corresponding to at least one application platform on which an application identified by the APP ID is deployed, where the DNAI list includes at least one DNAI.</p><p id="p-0195" num="0189">S<b>808</b>: The SMF sends a response message to the DNS proxy through the NEF network element, where the response message carries the DNAI list and the UE IP.</p><p id="p-0196" num="0190">S<b>809</b>: The DNS proxy determines an ECS option list based on the DNAI list, adds the ECS option list to the DNS query request, and sends the DNS query request including the ECS option list to the centralized DNS server.</p><p id="p-0197" num="0191">Specifically, the DNS proxy determines, based on the DNAI list and the IP address corresponding to each application platform, an IP address corresponding to each DNAI in the DNAI list, to obtain the ECS option list. The ECS option list includes at least one ECS option respectively corresponding to the at least one DNAI, and each ECS option includes one IP address.</p><p id="p-0198" num="0192">If the destination address in the DNS query request sent by the UE is the address of the DNS proxy, the DNS proxy adds the ECS option list to the DNS query request, and sends the DNS query request including the ECS option list to the centralized DNS server based on the address of the centralized DNS server configured on the DNS proxy.</p><p id="p-0199" num="0193">If the destination address in the DNS query request sent by the UE is the address of the centralized DNS server, the DNS proxy adds the ECS option list to the DNS query request, and sends the DNS query request including the ECS option list to the centralized DNS server based on the destination address.</p><p id="p-0200" num="0194">For details of S<b>810</b> to S<b>814</b>, refer to S<b>710</b> to S<b>714</b>, and repeated content is not described again.</p><p id="p-0201" num="0195">It should be noted that, the DNS proxy in Embodiment 2 may be replaced with an ARF.</p><p id="p-0202" num="0196">In Embodiment 2, in a scenario in which the first network element is the DNS proxy, and second information includes the DNAI list, when the UE accesses, by using the IP address returned by the first network element, the FQDN at a location indicated by the location information of the UE, the UE can access a local service nearby, and a service access latency can be reduced, to improve communication efficiency.</p><p id="p-0203" num="0197">Embodiment 3: <figref idref="DRAWINGS">FIG. <b>9</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>9</b>B</figref> are a third specific flowchart of requesting an IP address corresponding to a domain name by UE when a first network element is a DNS proxy. <figref idref="DRAWINGS">FIG. <b>13</b></figref> is a schematic diagram of a network architecture including network elements that may be involved in the embodiment shown in <figref idref="DRAWINGS">FIG. <b>9</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>9</b>B</figref>. A correspondence among a domain name, an identifier of an application, and at least one DNAI respectively corresponding to at least one application platform on which each application is deployed is configured on the DNS proxy. The DNS proxy may obtain the configured content through an AF. In addition, an IP address that is of a local DNS server and that corresponds to each application platform is configured on an SMF network element. Each application platform is represented by a DNAI corresponding to the application platform.</p><p id="p-0204" num="0198">For details of S<b>901</b> to S<b>906</b>, refer to S<b>701</b> to S<b>706</b>, and repeated content is not described again.</p><p id="p-0205" num="0199">S<b>907</b>: The SMF network element determines an IP address of a first local DNS server.</p><p id="p-0206" num="0200">Specifically, the SMF network element determines a DNAI list based on the APP ID, a current TAI of the UE, and at least one DNAI respectively corresponding to at least one application platform on which an application identified by the APP ID is deployed, where the DNAI list includes at least one DNAI.</p><p id="p-0207" num="0201">The SMF network element further determines, based on the DNAI list and the IP address that is of the local DNS server and that corresponds to each application platform, an IP address that is of a local DNS server and that corresponds to each DNAI in the DNAI list. If the DNAI list includes one DNAI, an IP address that is of a local DNS server and that corresponds to the DNAI is used as the IP address of the first local DNS server. If the DNAI list includes a plurality of DNAIs, IP addresses of a plurality of local DNS servers are determined, and an IP address of a local DNS server is determined, as the IP address of the first local DNS server, in the IP addresses of the plurality of local DNS servers according to a local policy.</p><p id="p-0208" num="0202">S<b>908</b>: The SMF sends a response message to the DNS proxy through the NEF network element, where the response message carries the IP address of the first local DNS server and the UE IP.</p><p id="p-0209" num="0203">S<b>909</b>: The DNS proxy sends the DNS query request to the first local DNS server.</p><p id="p-0210" num="0204">Specifically, because the destination address in the DNS query request is the address of the DNS proxy or the address of the centralized DNS server, the DNS proxy may replace the destination address in the DNS query request with the IP address of the first local DNS server, and send the DNS query request to the first local DNS server.</p><p id="p-0211" num="0205">S<b>910</b>: The first local DNS server sends a DNS response message to the DNS proxy, where the DNS response message carries an IP address corresponding to the FQDN.</p><p id="p-0212" num="0206">Specifically, the first local DNS server determines, based on the FQDN in the DNS query request, an IP address of a server deployed on an application platform as the IP address corresponding to the FQDN. The server supports the FQDN in the DNS query request.</p><p id="p-0213" num="0207">For details of S<b>911</b> to S<b>914</b>, refer to S<b>711</b> to S<b>714</b>, and repeated content is not described again.</p><p id="p-0214" num="0208">It should be noted that, the DNS proxy in Embodiment 3 may be replaced with an ARF.</p><p id="p-0215" num="0209">In Embodiment 3, in a scenario in which the first network element is the DNS proxy, and second information includes the IP address of the first local DNS server, when the UE accesses, by using the IP address returned by the first network element, the FQDN at a location indicated by the location information of the UE, the UE can access a local service nearby, and a service access latency can be reduced, to improve communication efficiency.</p><p id="p-0216" num="0210">Embodiment 4: As shown in <figref idref="DRAWINGS">FIG. <b>10</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>10</b>B</figref>, a first network element is a centralized DNS server. A correspondence among a domain name, an identifier of an application, and at least one DNAI respectively corresponding to at least one application platform on which each application is deployed is configured on the centralized DNS server. The centralized DNS server may obtain the configured content through an AF. In addition, an IP address corresponding to each application platform is configured on an SMF network element. Each application platform is represented by a DNAI corresponding to the application platform.</p><p id="p-0217" num="0211">S<b>1001</b>: UE initiates a PDU session establishment procedure.</p><p id="p-0218" num="0212">Specifically, the UE sends parameters such as a PDU session identifier, S-NSSAI, and a DNN to an AMF network element. The AMF network element selects the SMF network element based on the S-NSSAI and the DNN, and sends parameters such as an identifier of the AMF network element, a permanent identifier of the UE, location information of the UE, the PDU session identifier, the S-NSSAI, and the DNN to the SMF network element. The location information of the UE includes a TAI of the UE. The SMF selects an anchor UPF network element for a PDU session.</p><p id="p-0219" num="0213">S<b>1002</b>: The UE sends a DNS query request to the anchor UPF network element through an access network device.</p><p id="p-0220" num="0214">The DNS query request carries a domain name, and further includes a destination address, where the destination address is an IP address of the centralized DNS server. The centralized DNS server may be a centralized DNS server deployed by a carrier. The domain name carried in the DNS query request may be an FQDN or a domain name in another form. This is not limited in this application. The following only uses the FQDN as an example for description.</p><p id="p-0221" num="0215">S<b>1003</b>: The UPF network element sends the DNS query request to the centralized DNS server.</p><p id="p-0222" num="0216">S<b>1004</b>: The centralized DNS server obtains first information.</p><p id="p-0223" num="0217">Specifically, the centralized DNS server determines, based on the FQDN in the DNS query request and the correspondence between a domain name and an identifier of an application, an APP ID corresponding to the FQDN in the DNS query request. The first information includes the APP ID.</p><p id="p-0224" num="0218">S<b>1005</b>: The centralized DNS server sends a request message to a NEF network element, where the request message carries the APP ID and UE IP.</p><p id="p-0225" num="0219">S<b>1006</b>: The NEF network element sends a request message to the SMF network element, where the request message carries the APP ID and a UE ID or the UE IP.</p><p id="p-0226" num="0220">Specifically, the NEF network element determines the UE ID based on the UE IP, and determines, based on the UE ID, the SMF network element that serves the UE, where the UE ID may be the permanent identifier SUPI of the UE.</p><p id="p-0227" num="0221">S<b>1007</b>: The SMF network element determines an ECS option list.</p><p id="p-0228" num="0222">Specifically, the SMF network element determines a DNAI list based on the APP ID, a current TAT of the UE, and at least one DNAI respectively corresponding to at least one application platform on which an application identified by the APP ID is deployed, and determines, based on the DNAI list and the IP address corresponding to each application platform, an IP address corresponding to each DNAI in the DNAI list, to obtain the ECS option list.</p><p id="p-0229" num="0223">The DNAI list includes at least one DNAI, and the ECS option list includes at least one ECS option respectively corresponding to the at least one DNAI. Each ECS option includes one IP address.</p><p id="p-0230" num="0224">S<b>1008</b>: The SMF sends a response message to the centralized DNS server through the NEF network element, where the response message carries the ECS option list and the UE IP.</p><p id="p-0231" num="0225">S<b>1009</b>: The centralized DNS server determines an IP address corresponding to the FQDN and a target DNAI.</p><p id="p-0232" num="0226">Specifically, the centralized DNS server determines, based on the FQDN in the DNS query request and the ECS option list, an application platform to which the IP address in the ECS option points, and further determines an IP address of a server deployed on the application platform as the IP address corresponding to the FQDN. The server supports the FQDN in the DNS query request. After determining the application platform to which the IP address in the ECS option points, the centralized DNS server uses a DNAI of the application platform as the target DNAI.</p><p id="p-0233" num="0227">If the ECS option list includes a plurality of ECS options, the centralized DNS server may select a target ECS option from the plurality of ECS options, and further determine, as the IP address corresponding to the FQDN, an IP address of a server deployed on an application platform corresponding to the target ECS option. The server supports the FQDN in the DNS query request. The centralized DNS server determines that a DNAI of the application platform to which the target ECS option points is referred to as the target DNAI.</p><p id="p-0234" num="0228">For example, a correspondence between an IP address space (or an IP address segment) and a DNAI of an application platform corresponding to the IP address space is configured on the centralized DNS server. For example, the centralized DNS server may obtain the configured content through the AF. When obtaining the IP address corresponding to the FQDN, the centralized DNS server may determine an address space (or an IP address segment) to which the IP address belongs, and further determine a DNAI of an application platform corresponding to the address space (or the IP address segment).</p><p id="p-0235" num="0229">S<b>1010</b>: The centralized DNS server sends the target DNAI and the UE IP to the SMF network element through the NEF.</p><p id="p-0236" num="0230">The UE IP may be used to identify the UE.</p><p id="p-0237" num="0231">S<b>1011</b>: The SMF network element selects a local PSA network element and a UL CL or a BP for the PDU session based on the target DNAI.</p><p id="p-0238" num="0232">Specifically, the SMF network element determines the PDU session of the UE based on the UE IP, and selects the local PSA network element for the PDU session based on the target DNAI. Further, the SMF network element selects the UL CL or the BP for the PDU session based on the target DNAI, to implement local steering, optimize a service access path, and improve communication efficiency.</p><p id="p-0239" num="0233">S<b>1012</b>: After performing S<b>1011</b>, the SMF network element sends an acknowledgment message to the centralized DNS server.</p><p id="p-0240" num="0234">The acknowledgment message carries the UE IP.</p><p id="p-0241" num="0235">S<b>1013</b>: The centralized DNS server sends a DNS response message to the UE through the anchor UPF, where the DNS response message carries the IP address corresponding to the FQDN.</p><p id="p-0242" num="0236">It should be noted that the centralized DNS server in Embodiment 4 may be replaced with an ARF.</p><p id="p-0243" num="0237">In Embodiment 4, in a scenario in which the first network element is the centralized DNS server, and second information includes the ECS option list, when the UE accesses, by using the IP address returned by the first network element, the FQDN at a location indicated by the location information of the UE, the UE can access a local service nearby, and a service access latency can be reduced, to improve the communication efficiency.</p><p id="p-0244" num="0238">Embodiment 5: As shown in <figref idref="DRAWINGS">FIG. <b>11</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>11</b>B</figref>, a first network element is a centralized DNS server. A correspondence among a domain name, an identifier of an application, and at least one DNAI respectively corresponding to at least one application platform on which each application is deployed and an IP address corresponding to each application platform are configured on the centralized DNS server. Each application platform is represented by a DNAI corresponding to the application platform. The centralized DNS server may obtain the configured content through an AF.</p><p id="p-0245" num="0239">For details of S<b>1101</b> to S<b>1106</b>, refer to S<b>1001</b> to S<b>1006</b>, and repeated content is not described again.</p><p id="p-0246" num="0240">S<b>1107</b>: The SMF network element determines a DNAI list.</p><p id="p-0247" num="0241">Specifically, the SMF network element determines the DNAI list based on the APP ID, a current TAI of the UE, and at least one DNAI respectively corresponding to at least one application platform on which an application identified by the APP ID is deployed, where the DNAI list includes at least one DNAI.</p><p id="p-0248" num="0242">S<b>1108</b>: The SMF sends a response message to the centralized DNS server through the NEF network element, where the response message carries the DNAI list and the UE IP.</p><p id="p-0249" num="0243">S<b>1109</b>: The centralized DNS server determines, based on the DNAI list, an IP address corresponding to the FQDN and a target DNAI.</p><p id="p-0250" num="0244">Specifically, the centralized DNS server determines, based on the DNAI list and the IP address corresponding to each application platform, an IP address corresponding to each DNAI in the DNAI list, to obtain an ECS option list. The ECS option list includes at least one ECS option respectively corresponding to the at least one DNAI, and each ECS option includes one IP address.</p><p id="p-0251" num="0245">The centralized DNS server determines, based on the FQDN in the DNS query request and the ECS option list, an application platform to which the IP address in the ECS option points, and further determines an IP address of a server deployed on the application platform as the IP address corresponding to the FQDN. The server supports the FQDN in the DNS query request. After determining the application platform to which the IP address in the ECS option points, the centralized DNS server uses a DNAI of the application platform as the target DNAI.</p><p id="p-0252" num="0246">If the ECS option list includes a plurality of ECS options, the centralized DNS server may select a target ECS option from the plurality of ECS options, and further determine, as the IP address corresponding to the FQDN, an IP address of a server deployed on an application platform corresponding to the target ECS option. The server supports the FQDN in the DNS query request. The centralized DNS server determines that a DNAI of the application platform to which the target ECS option points is referred to as the target DNAI.</p><p id="p-0253" num="0247">For details of S<b>1110</b> to S<b>1113</b>, refer to S<b>1010</b> to S<b>1013</b>, and repeated content is not described again.</p><p id="p-0254" num="0248">It should be noted that the centralized DNS server in Embodiment 5 may be replaced with an ARF.</p><p id="p-0255" num="0249">In Embodiment 5, in a scenario in which the first network element is the centralized DNS server, and second information includes the DNAI list, when the UE accesses, by using the IP address returned by the first network element, the FQDN at a location indicated by the location information of the UE, the UE can access a local service nearby, and a service access latency can be reduced, to improve communication efficiency.</p><p id="p-0256" num="0250">Embodiment 6: As shown in <figref idref="DRAWINGS">FIG. <b>12</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>12</b>B</figref>, a first network element is a centralized DNS server. A correspondence among a domain name, an identifier of an application, and at least one DNAI respectively corresponding to at least one application platform on which each application is deployed and an IP address corresponding to each application platform are configured on the centralized DNS server. Each application platform is represented by a DNAI corresponding to the application platform. The centralized DNS server may obtain the configured content through an AF.</p><p id="p-0257" num="0251">For details of S<b>1201</b> to S<b>1206</b>, refer to S<b>1001</b> to S<b>1006</b>, and repeated content is not described again.</p><p id="p-0258" num="0252">S<b>1207</b>: The SMF network element determines an IP address of a first local DNS server.</p><p id="p-0259" num="0253">Specifically, the SMF network element determines a DNAI list based on the APP ID, a current TAI of the UE, and at least one DNAI respectively corresponding to at least one application platform on which an application identified by the APP ID is deployed, where the DNAI list includes at least one DNAI.</p><p id="p-0260" num="0254">The SMF network element further determines, based on the DNAI list and an IP address that is of a local DNS server and that corresponds to each application platform, an IP address that is of a local DNS server and that corresponds to each DNAI in the DNAI list. If the DNAI list includes one DNAI, an IP address that is of a local DNS server and that corresponds to the DNAI is used as the IP address of the first local DNS server. If the DNAI list includes a plurality of DNAIs, IP addresses of a plurality of local DNS servers are determined, and an IP address of a local DNS server is determined, as the IP address of the first local DNS server, in the IP addresses of the plurality of local DNS servers according to a local policy.</p><p id="p-0261" num="0255">S<b>1208</b>: The SMF sends a response message to the centralized DNS server through the NEF network element, where the response message carries the IP address of the first local DNS server.</p><p id="p-0262" num="0256">S<b>1209</b>: The centralized DNS server sends the DNS query request to the first local DNS server.</p><p id="p-0263" num="0257">Specifically, the centralized DNS server may replace the destination address in the DNS query request with the IP address of the first local DNS server, and send the DNS query request to the first local DNS server.</p><p id="p-0264" num="0258">S<b>1210</b>: The first local DNS server sends a DNS response message to the centralized DNS server, where the DNS response message carries an IP address corresponding to the FQDN.</p><p id="p-0265" num="0259">Specifically, the first local DNS server determines, based on the FQDN in the DNS query request, an IP address of a server deployed on an application platform as the IP address corresponding to the FQDN. The server supports the FQDN in the DNS query request.</p><p id="p-0266" num="0260">S<b>1211</b>: The centralized DNS server sends a target DNAI and the UE IP to the SMF network element through the NEF.</p><p id="p-0267" num="0261">The centralized DNS server determines, based on the IP address that corresponds to the FQDN and that is carried in the DNS response message, a DNAI (referred to as the target DNAI) of the application platform on which the server to which the IP address points is deployed.</p><p id="p-0268" num="0262">For example, a correspondence between an IP address space (or an IP address segment) and a DNAI of an application platform corresponding to the IP address space is locally configured on the centralized DNS server or is obtained from another network element. For example, the centralized DNS server may obtain the configured content through the AF. When obtaining the IP address corresponding to the FQDN, the centralized DNS server may determine an address space (or an IP address segment) to which the IP address belongs, and further determine a DNAI of an application platform corresponding to the address space (or the IP address segment).</p><p id="p-0269" num="0263">S<b>1212</b>: The SMF network element selects a UL CL or a BP and a local PSA network element for the PDU session based on the target DNAI.</p><p id="p-0270" num="0264">Specifically, the SMF network element determines the PDU session of the UE based on the UE IP, and selects the local PSA network element for the PDU session based on the target DNAI. Further, the SMF selects the UL CL or the BP for the PDU session based on the target DNAI, to implement local steering, optimize a service access path, and improve communication efficiency.</p><p id="p-0271" num="0265">S<b>1213</b>: After performing S<b>1011</b>, the SMF network element sends an acknowledgment message to the centralized DNS server.</p><p id="p-0272" num="0266">The acknowledgment message carries the UE IP.</p><p id="p-0273" num="0267">S<b>1214</b>: The centralized DNS server sends a DNS response message to the UE through the anchor UPF, where the DNS response message carries the IP address corresponding to the FQDN.</p><p id="p-0274" num="0268">It should be noted that the centralized DNS server in Embodiment 6 may be replaced with an ARF.</p><p id="p-0275" num="0269">In Embodiment 6, in a scenario in which the first network element is the centralized DNS server, and second information includes the IP address of the first local DNS server, when the UE accesses, by using the IP address returned by the first network element, the FQDN at a location indicated by the location information of the UE, the UE can access a local service nearby, and a service access latency can be reduced, to improve the communication efficiency.</p><p id="p-0276" num="0270">It may be understood that, in embodiments of this application, the session management function network element and/or the first network element may perform a part or all of the steps in embodiments of this application. These steps or operations are merely examples. In embodiments of this application, other operations or variants of various operations may be further performed. In addition, the steps may be performed in a sequence different from a sequence presented in embodiments of this application, and not all the operations in embodiments of this application may be necessarily performed.</p><p id="p-0277" num="0271">In embodiments of this application, unless otherwise stated or there is a logic conflict, terms and/or descriptions in different embodiments are consistent and may be mutually referenced, and technical features in different embodiments may be combined based on an internal logical relationship thereof, to form a new embodiment.</p><p id="p-0278" num="0272">In the foregoing embodiments provided in this application, various solutions of the application discovery method provided in embodiments of this application are separately described from perspectives of the network elements and interaction between the network elements. It may be understood that to implement the foregoing functions, each network element such as the session management function network element and the first network element includes a corresponding hardware structure and/or software module for performing each function. A person skilled in the art should be easily aware that, in combination with units and algorithm steps of the examples described in embodiments disclosed in this specification, this application can be implemented by hardware or a combination of hardware and computer software. Whether a function is performed by hardware or hardware driven by computer software depends on particular applications and design constraints of the technical solutions. A person skilled in the art may use different methods to implement the described functions for each particular application, but it should not be considered that the implementation goes beyond the scope of this application.</p><p id="p-0279" num="0273">Same as the foregoing idea, as shown in <figref idref="DRAWINGS">FIG. <b>14</b></figref>, an embodiment of this application further provides an apparatus <b>1400</b>. The apparatus <b>1400</b> includes a transceiver unit <b>1402</b> and a processing unit <b>1401</b>.</p><p id="p-0280" num="0274">In an example, the apparatus <b>1400</b> is configured to implement functions of the session management function network element in the foregoing methods. The apparatus may be a session management function network element.</p><p id="p-0281" num="0275">The transceiver unit <b>1402</b> is configured to receive first information from a first network element, where the first information includes at least one of a first domain name or an identifier of a first application that corresponds to the first domain name, and the first domain name is sent by a terminal device.</p><p id="p-0282" num="0276">The processing unit <b>1401</b> is configured to determine second information based on at least the first information and location information of the terminal device.</p><p id="p-0283" num="0277">The transceiver unit <b>1402</b> is configured to send the second information to the first network element, where the second information is for obtaining a first IP address corresponding to the first domain name.</p><p id="p-0284" num="0278">In an example, the apparatus <b>1400</b> is configured to implement functions of the first network element in the foregoing methods. The apparatus may be a first network element.</p><p id="p-0285" num="0279">The processing unit <b>1401</b> is configured to obtain first information, where the first information includes at least one of a first domain name or an identifier of a first application that corresponds to the first domain name, and the first domain name is sent by a terminal device.</p><p id="p-0286" num="0280">The transceiver unit <b>1402</b> is configured to send the first information to a session management function network element.</p><p id="p-0287" num="0281">The transceiver unit <b>1402</b> is configured to receive second information from the session management function network element, where the second information is for obtaining a first IP address corresponding to the first domain name.</p><p id="p-0288" num="0282">The transceiver unit <b>1402</b> is configured to send the first IP address to the terminal device.</p><p id="p-0289" num="0283">For specific execution processes of the processing unit <b>1401</b> and the transceiver unit <b>1402</b>, refer to the descriptions in the foregoing method embodiments. Division into modules in embodiments of this application is an example, is merely logical function division, and may be other division during actual implementation. In addition, functional modules in embodiments of this application may be integrated into one processor, each of the modules may exist alone physically, or two or more modules may be integrated into one module. The integrated module may be implemented by hardware, or may be implemented by a software functional module.</p><p id="p-0290" num="0284">In another optional variant, the apparatus may be a chip system. In this embodiment of this application, the chip system may include a chip, or may include a chip and another discrete component. For example, the apparatus includes a processor and an interface, and the interface may be an input/output interface. The processor implements functions of the processing unit <b>1401</b>, and the interface implements functions of the transceiver unit <b>1402</b>. The apparatus may further include a memory. The memory is configured to store a program that may be run on the processor, and the processor implements the methods in the foregoing embodiments when executing the program.</p><p id="p-0291" num="0285">Same as the foregoing idea, as shown in <figref idref="DRAWINGS">FIG. <b>15</b></figref>, an embodiment of this application further provides an apparatus <b>1500</b>. The apparatus <b>1500</b> includes a communication interface <b>1501</b>, at least one processor <b>1502</b>, and at least one memory <b>1503</b>. The communication interface <b>1501</b> is configured to communicate with another device by using a transmission medium, so that an apparatus in the apparatus <b>1500</b> can communicate with the another device. The memory <b>1503</b> is configured to store a computer program. The processor <b>1502</b> invokes the computer program stored in the memory <b>1503</b>, to send and receive data through the communication interface <b>1501</b>, to implement the methods in the foregoing embodiments.</p><p id="p-0292" num="0286">For example, when the apparatus is a session management function network element, the memory <b>1503</b> is configured to store a computer program, and the processor <b>1502</b> invokes the computer program stored in the memory <b>1503</b> to perform, through the communication interface <b>1501</b>, the method performed by the session management function network element in the foregoing embodiments. When the apparatus is a first network element, the memory <b>1503</b> is configured to store a computer program, and the processor <b>1502</b> invokes the computer program stored in the memory <b>1503</b> to perform, through the communication interface <b>1501</b>, the method performed by the first network element in the foregoing embodiments.</p><p id="p-0293" num="0287">In this embodiment of this application, the communication interface <b>1501</b> may be a transceiver, a circuit, a bus, a module, or a communication interface of another type. The processor <b>1502</b> may be a general-purpose processor, a digital signal processor, an application-specific integrated circuit, a field programmable gate array or another programmable logic device, a discrete gate or transistor logic device, or a discrete hardware component, and may implement or perform the methods, steps, and logical block diagrams disclosed in embodiments of this application. The general-purpose processor may be a microprocessor, any conventional processor, or the like. The steps in the methods disclosed with reference to embodiments of this application may be directly performed by a hardware processor, or may be performed by a combination of hardware in the processor and a software module. The memory <b>1503</b> may be a nonvolatile memory, for example, a hard disk drive (hard disk drive, HDD) or a solid-state drive (solid-state drive, SSD), or may be a volatile memory (volatile memory), for example, a random access memory (random access memory, RAM). The memory is any other medium that can carry or store expected program code in a form of an instruction or a data structure and that can be accessed by a computer, but is not limited thereto. The memory in this embodiment of this application may alternatively be a circuit or any other apparatus that can implement a storage function. The memory <b>1503</b> is coupled to the processor <b>1502</b>. Coupling in this embodiment of this application is indirect coupling or a communication connection between apparatuses, units, or modules, may be in an electrical form, a mechanical form, or another form, and is used for information exchange between the apparatuses, units, or modules. In another implementation, the memory <b>1503</b> may alternatively be located outside the apparatus <b>1500</b>. The processor <b>1502</b> may operate in collaboration with the memory <b>1503</b>. The processor <b>1502</b> may execute program instructions stored in the memory <b>1503</b>. At least one of the at least one memory <b>1503</b> may alternatively be included in the processor <b>1502</b>. In this embodiment of this application, a connection medium among the communication interface <b>1501</b>, the processor <b>1502</b>, and the memory <b>1503</b> is not limited. For example, in this embodiment of this application, the memory <b>1503</b>, the processor <b>1502</b>, and the communication interface <b>1501</b> may be connected through a bus in <figref idref="DRAWINGS">FIG. <b>15</b></figref>. The bus may be classified into an address bus, a data bus, a control bus, or the like.</p><p id="p-0294" num="0288">It may be understood that the apparatus in the embodiment shown in <figref idref="DRAWINGS">FIG. <b>14</b></figref> may be implemented by the apparatus <b>1500</b> shown in <figref idref="DRAWINGS">FIG. <b>15</b></figref>. Specifically, the processing unit <b>1401</b> may be implemented by the processor <b>1502</b>, and the transceiver unit <b>1402</b> may be implemented by the communication interface <b>1501</b>.</p><p id="p-0295" num="0289">An embodiment of this application further provides a computer-readable storage medium. The computer-readable storage medium stores a computer program. When the computer program is run on a device, the device is enabled to perform the methods in the foregoing embodiments.</p><p id="p-0296" num="0290">An embodiment of this application further provides a communication system. The communication system includes a session management function network element and a first network element. The first network element may be any one of a DNS proxy, an address resolution function network element, or a centralized DNS server.</p><p id="p-0297" num="0291">All or some of the methods in embodiments of this application may be implemented by using software, hardware, firmware, or any combination thereof. When software is for implementing the methods, all or some of the methods may be implemented in a form of a computer program product. The computer program product includes one or more computer instructions. When the computer program instructions are loaded and executed on a computer, the procedures or functions according to the embodiments of the present invention are all or partially generated. The computer may be a general-purpose computer, a special-purpose computer, a computer network, a network device, user equipment, or another programmable apparatus. The computer instructions may be stored in a computer-readable storage medium or may be transmitted from a computer-readable storage medium to another computer-readable storage medium. For example, the computer instructions may be transmitted from a website, computer, server, or data center to another website, computer, server, or data center in a wired (for example, a coaxial cable, an optical fiber, or a digital subscriber line (digital subscriber line, DSL for short)) or wireless (for example, infrared, radio, or microwave) manner. The computer-readable storage medium may be any usable medium accessible by a computer, or a data storage device, for example, a server or a data center, integrating one or more usable media. The usable medium may be a magnetic medium (for example, a floppy disk, a hard disk, or a magnetic tape), an optical medium (for example, a digital video disc (digital video disc, DVD for short)), a semiconductor medium (for example, a solid-state drive (Solid-State Drive, SSD)), or the like.</p><p id="p-0298" num="0292">The foregoing embodiments are merely used to describe the technical solutions of this application in detail. The descriptions of the foregoing embodiments are merely intended to help understand the methods in embodiments of the present invention, and shall not be construed as any limitation on embodiments of the present invention. Variants or replacements readily figured out by a person skilled in the art shall fall within the protection scope of embodiments of the present invention.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. An application discovery method, comprising:<claim-text>receiving, by a session management function network element, first information from a network element, wherein the first information comprises at least one of a domain name or an identifier of a first application that corresponds to the domain name, and the domain name is sent by a terminal device;</claim-text><claim-text>determining, by the session management function network element, second information based on the first information and location information of the terminal device, wherein the second information is for obtaining an Internet Protocol (IP) address corresponding to the domain name; and</claim-text><claim-text>sending, by the session management function network element, the second information to the network element.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the determining, by the session management function network element, second information based on the first information and location information of the terminal device comprises:<claim-text>determining a first application platform in at least one application platform, by the session management function network element based on the first information, the location information of the terminal device, and location information of the at least one application platform on which the first application is deployed, wherein the second information corresponds to the first application platform.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the network element is a DNS proxy, an address resolution function network element, or a centralized DNS server.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. An application discovery method, comprising:<claim-text>obtaining, by a network element, first information, wherein the first information comprises at least one of a domain name or an identifier of a first application that corresponds to the domain name, and the domain name is sent by a terminal device;</claim-text><claim-text>sending, by the network element, the first information to a session management function network element;</claim-text><claim-text>receiving, by the network element, second information from the session management function network element, wherein the second information is for obtaining an Internet Protocol (IP) address corresponding to the domain name; and</claim-text><claim-text>sending, by the network element, the IP address to the terminal device.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the second information comprises an IP address corresponding to a first application platform, and at least one application platform on which the first application is deployed comprises the first application platform.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the second information comprises an IP address of a first local DNS server, the first local DNS server serves a first application platform, and at least one application platform on which the first application is deployed comprises the first application platform.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the network element is a DNS proxy, an address resolution function network element, or a centralized DNS server; and the method further comprises:<claim-text>sending, by the network element to the first local DNS server, a DNS query request received from the terminal device, wherein the DNS query request comprises the domain name; and</claim-text><claim-text>receiving, by the network element, fourth information from the first local DNS server, wherein the fourth information comprises the IP address.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. An application discovery method, comprising:<claim-text>obtaining, by a network element, first information, wherein the first information comprises at least one of a domain name or an identifier of a first application that corresponds to the domain name, and the domain name is sent by a terminal device;</claim-text><claim-text>sending, by the network element, the first information to a session management function network element;</claim-text><claim-text>receiving, by the session management function network element, the first information;</claim-text><claim-text>determining, by the session management function network element, second information based on the first information and location information of the terminal device, wherein the second information is for obtaining an Internet Protocol (IP) address corresponding to the domain name;</claim-text><claim-text>sending, by the session management function network element, the second information to the network element;</claim-text><claim-text>receiving, by the network element, second information from the session management function network element; and</claim-text><claim-text>sending, by the network element, the IP address to the terminal device.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the determining, by the session management function network element, second information based on the first information and location information of the terminal device comprises:<claim-text>determining a first application platform in at least one application platform, by the session management function network element based on the first information, the location information of the terminal device, and location information of the at least one application platform on which the first application is deployed, wherein the second information corresponds to the first application platform.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the network element is a DNS proxy, an address resolution function network element, or a centralized DNS server; and the method further comprises:<claim-text>sending, by the network element to a first local DNS server, a DNS query request received from the terminal device, wherein the DNS query request comprises the domain name; and</claim-text><claim-text>receiving, by the network element, fourth information from the first local DNS server, wherein the fourth information comprises the IP address.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The method according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the second information comprises an IP address corresponding to a first application platform, and at least one application platform on which the first application is deployed comprises the first application platform.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. An application discovery apparatus, comprising:<claim-text>at least one processor; and</claim-text><claim-text>one or more memories coupled to the at least one processor and storing programming instructions for execution by the at least one processor to:</claim-text><claim-text>receive first information from a network element, wherein the first information comprises at least one of a domain name or an identifier of a first application that corresponds to the domain name, and the domain name is sent by a terminal device;</claim-text><claim-text>determine second information based on the first information and location information of the terminal device; and</claim-text><claim-text>send the second information to the network element, wherein the second information is for obtaining an Internet Protocol (IP) address corresponding to the domain name.</claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The apparatus according to <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the one or more memories store the programming instructions for execution by the at least one processor to:<claim-text>determine, based on the first information, the location information of the terminal device, and location information of at least one application platform on which the first application is deployed, a first application platform in the at least one application platform, wherein the second information corresponds to the first application platform.</claim-text></claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The apparatus according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the one or more memories store the programming instructions for execution by the at least one processor to:<claim-text>determine the second information based on the first application platform and at least one IP address respectively corresponding to the at least one application platform, wherein the second information comprises an IP address corresponding to the first application platform.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The apparatus according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the one or more memories store the programming instructions for execution by the at least one processor to:<claim-text>determine the second information based on the first application platform and at least one IP address that is of a local domain name system (DNS) server and that respectively corresponds to the at least one application platform, wherein the second information comprises an IP address of a first local DNS server, and the first local DNS server serves the first application platform.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The apparatus according to <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the network element is a DNS proxy, an address resolution function network element, or a centralized DNS server.</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. An application discovery apparatus, comprising:<claim-text>at least one processor; and</claim-text><claim-text>one or more memories coupled to the at least one processor and storing programming instructions for execution by the at least one processor to:</claim-text><claim-text>obtain first information, wherein the first information comprises at least one of a domain name or an identifier of a first application that corresponds to the domain name, and the domain name is sent by a terminal device;</claim-text><claim-text>send the first information to a session management function network element;</claim-text><claim-text>receive second information from the session management function network element, wherein the second information is for obtaining an Internet Protocol (IP) address corresponding to the domain name; and</claim-text><claim-text>send the IP address to the terminal device.</claim-text></claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The apparatus according to <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the second information comprises an IP address corresponding to a first application platform, and at least one application platform on which the first application is deployed comprises the first application platform.</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The apparatus according to <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the second information comprises an IP address of a first local DNS server, the first local DNS server serves a first application platform, and at least one application platform on which the first application is deployed comprises the first application platform.</claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The apparatus according to <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the apparatus is a DNS proxy, an address resolution function network element, or a centralized DNS server; and<claim-text>the one or more memories store the programming instructions for execution by the at least one processor to:<claim-text>send, to the first local DNS server, a DNS query request received from the terminal device, wherein the DNS query request comprises the domain name; and</claim-text><claim-text>receive fourth information from the first local DNS server, wherein the fourth information comprises the IP address.</claim-text></claim-text></claim-text></claim><claim id="CLM-00021" num="00021"><claim-text><b>21</b>. A communications system, comprising:<claim-text>a first application discovery apparatus, comprising one or more first processors and one or more first memories coupled to the one or more first processors; and</claim-text><claim-text>a second application discovery apparatus, comprising one or more second processors and one or more second memories coupled to the one or more second processors;</claim-text><claim-text>wherein the one or more second memories store second programming instructions for execution by the one or more second processors to:<claim-text>obtain first information, wherein the first information comprises at least one of a domain name or an identifier of a first application that corresponds to the domain name, and the domain name is sent by a terminal device; and</claim-text><claim-text>send the first information to the first application discovery apparatus;</claim-text></claim-text><claim-text>wherein the one or more first memories store first programming instructions for execution by the one or more first processors to:<claim-text>receive first information from the second application discovery apparatus, wherein the first information comprises at least one of a domain name or an identifier of a first application that corresponds to the domain name, and the domain name is sent by a terminal device;</claim-text><claim-text>determine second information based on the first information and location information of the terminal device; and</claim-text><claim-text>send the second information to the second application discovery apparatus, wherein the second information is for obtaining an Internet Protocol (IP) address corresponding to the domain name;</claim-text></claim-text><claim-text>and wherein the one or more second memories store second programming instructions for execution by the one or more second processors to:<claim-text>receive second information from the first application discovery apparatus, wherein the second information is for obtaining an Internet Protocol (IP) address corresponding to the domain name; and</claim-text><claim-text>send the IP address to the terminal device.</claim-text></claim-text></claim-text></claim><claim id="CLM-00022" num="00022"><claim-text><b>22</b>. The communication system according to <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the one or more first memories store the first programming instructions for execution by the at least one first processor to:<claim-text>determine, based on the first information, the location information of the terminal device, and location information of at least one application platform on which the first application is deployed, a first application platform in the at least one application platform, wherein the second information corresponds to the first application platform.</claim-text></claim-text></claim><claim id="CLM-00023" num="00023"><claim-text><b>23</b>. The communication system according to <claim-ref idref="CLM-00021">claim 21</claim-ref>, the second application discovery apparatus is a DNS proxy, an address resolution function network element, or a centralized DNS server, and wherein the one or more second memories store the second programming instructions for execution by the at least one second processor to:<claim-text>send, to a first local DNS server, a DNS query request received from the terminal device, wherein the DNS query request comprises the domain name; and</claim-text><claim-text>receive, fourth information from the first local DNS server, wherein the fourth information comprises the IP address.</claim-text></claim-text></claim><claim id="CLM-00024" num="00024"><claim-text><b>24</b>. The communication system according to <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the second information comprises an IP address corresponding to a first application platform, and at least one application platform on which the first application is deployed comprises the first application platform.</claim-text></claim></claims></us-patent-application>