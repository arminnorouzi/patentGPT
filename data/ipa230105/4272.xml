<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230004273A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230004273</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17757221</doc-number><date>20200221</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>CN</country><doc-number>201911270742.5</doc-number><date>20191212</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>F</subclass><main-group>3</main-group><subgroup>041</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20190501</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>3</main-group><subgroup>04166</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>2203</main-group><subgroup>04101</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>3</main-group><subgroup>044</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">RANGING METHOD AND APPARATUS THEREOF, STORAGE MEDIUM, AND TERMINAL DEVICE</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>HUIZHOU TCL MOBILE COMMUNICATION CO., LTD</orgname><address><city>Huizhou, Guangdong</city><country>CN</country></address></addressbook><residence><country>CN</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Song</last-name><first-name>Bin</first-name><address><city>Huizhou, Guangdong</city><country>CN</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Chen</last-name><first-name>Hailong</first-name><address><city>Huizhou, Guangdong</city><country>CN</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Liu</last-name><first-name>Junting</first-name><address><city>Huizhou, Guangdong</city><country>CN</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>Gong</last-name><first-name>Yan</first-name><address><city>Huizhou, Guangdong</city><country>CN</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>HUIZHOU TCL MOBILE COMMUNICATION CO., LTD</orgname><role>03</role><address><city>Huizhou, Guangdong</city><country>CN</country></address></addressbook></assignee></assignees><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/CN2020/076242</doc-number><date>20200221</date></document-id><us-371c12-date><date>20220610</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A ranging method and an apparatus thereof, a storage medium, and a terminal device. By adding a processing unit into a hardware abstraction layer of the terminal device, a software method is thus used to replace a physical proximity sensor (Psensor); in addition, costs are effectively reduced.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="183.39mm" wi="148.59mm" file="US20230004273A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="186.44mm" wi="155.45mm" file="US20230004273A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="194.82mm" wi="150.62mm" file="US20230004273A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="205.32mm" wi="148.51mm" file="US20230004273A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading><p id="p-0002" num="0001">This disclosure claims priority benefit to Chinese Patent Application No. 201911270742.5, filed on Dec. 12, 2019, and entitled &#x201c;RANGING METHOD AND APPARATUS THEREOF, STORAGE MEDIUM, AND TERMINAL DEVICE&#x201d;, the entire contents of which are hereby incorporated by reference in its entirety in this disclosure.</p><heading id="h-0002" level="1">FIELD OF THE DISCLOSURE</heading><p id="p-0003" num="0002">The present application relates to the field of computer technology, and more specifically, to a ranging method and an apparatus thereof, a storage medium, and a terminal device.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">A general capacitive touch panel (CTP) simulates a proximity sensor (Psensor) by calling an interface of the Psensor in a driver for CTP to register a virtual Psensor device. The CTP can report an approaching or departing status through the interface of the Psensor.</p><p id="p-0005" num="0004">A driver of the proximity sensor is built in a separate Digital Signal Processor (DSP) on the Qualcomm platform after a terminal device uses an MSM8960 chip, so that a normal operation of the sensor in a low power mode will be realized. In this case, there is no direct communication between the driver for the CTP and the driver for the Psensor, and thus the approaching or departing status cannot be reported.</p><p id="p-0006" num="0005">Therefore, a new technology is urgently needed to solve a problem of communication between the driver for the CTP and the driver for the Psensor.</p><heading id="h-0004" level="1">SUMMARY</heading><heading id="h-0005" level="1">Technical Problem</heading><p id="p-0007" num="0006">The present application provides a ranging method and an apparatus thereof, a storage medium, and a terminal device, which can effectively solve problems that a conventional driver for CTP and a driver for Psensor cannot communicate directly and distance events cannot be reported.</p><heading id="h-0006" level="1">Technical Solutions</heading><p id="p-0008" num="0007">According to an aspect of the present application, an embodiment of the present application provides a ranging method, which is applicable to a terminal device. The method comprises the following steps: enabling a capacitive touch panel (CTP) of the terminal device through a capacitive touch panel driving module in a kernel system of the terminal device; sending an enabling instruction to a proximity sensor (Psensor) driving module provided in a digital signal processor of the terminal device; receiving a distance event sent by the Psensor driving module; and acquiring distance information of an object and the CTP through the CTP driving module.</p><p id="p-0009" num="0008">Further, after the step of enabling the CTP of the terminal device through the CTP driving module, the method further comprises a step of: receiving a ranging request.</p><p id="p-0010" num="0009">Further, after the step of sending the enabling instruction to the Psensor driving module provided in the digital signal processor of the terminal device and before the step of receiving the distance event sent by the Psensor driving module, the method further comprises steps of: detecting the distance event by the CTP; and sending an interrupt signal to the CTP driving module by the CTP.</p><p id="p-0011" num="0010">Further, after the step of sending the interrupt signal to the CTP driving module by the CTP, the method further comprises: sending a pulse signal having a preset duration to the Psensor driving module by the CTP driving module.</p><p id="p-0012" num="0011">Further, the preset duration is 1 ms-20 ms.</p><p id="p-0013" num="0012">Further, after the step of acquiring distance information of the object and the CTP through the CTP driving module, the method further comprises: reporting a determination result to the terminal device according to the distance information.</p><p id="p-0014" num="0013">According to another aspect of the present application, an embodiment of the present application provides a ranging apparatus, and the ranging apparatus comprises: a capacitive touch panel enabling unit configured to enable a capacitive touch panel (CTP) through a capacitive touch panel driving module in a kernel system of a terminal device; a proximity sensor driving module enabling unit connected to the CTP enabling unit, and the proximity sensor driving module enabling unit is configured to send an enabling instruction to a proximity sensor (Psensor) driving module provided in a digital signal processor of the terminal device; a distance event receiving unit connected to the Psensor driving module enabling unit and configured to receive a distance event sent by the Psensor driving module; and a distance information acquiring unit connected to the distance event receiving unit and configured to acquire distance information of an object and the CTP through the CTP driving module.</p><p id="p-0015" num="0014">Further, the apparatus for simulating the Psensor further comprises: a ranging request unit connected to the CTP enabling unit and the ranging request unit is configured to receive the ranging request, and a distance information reporting unit connected to the distance information acquiring unit and the distance information reporting unit is configured to report a determination result to the terminal device according to the distance information.</p><p id="p-0016" num="0015">According to another aspect of the present application, an embodiment of the present application provides a computer-readable storage medium, wherein a plurality of instructions are stored in the storage medium, and the instructions are adapted to be loaded by a processor to execute the ranging method, the ranging method comprises: enabling a capacitive touch panel (CTP) of the terminal device through a capacitive touch panel driving module in a kernel system of a terminal device, wherein the CTP driving module is controlled by a CTP driving program; sending an enabling instruction to a proximity sensor (Psensor) driving module provided in a digital signal processor of the terminal device, wherein the Psensor driving module is controlled by a Psensor driving program; receiving a distance event sent by the Psensor driving module; and acquiring distance information of an object and the CTP through the CTP driving module.</p><p id="p-0017" num="0016">Further, after the step of enabling the CTP of the terminal device through the CTP driving module, the method further comprises a step of: receiving a ranging request.</p><p id="p-0018" num="0017">Further, after the step of sending the enabling instruction to the Psensor driving module provided in the digital signal processor of the terminal device and before the step of receiving the distance event sent by the Psensor driving module, the method further comprises steps of: detecting the distance event by the CTP; and sending an interrupt signal to the CTP driving module by the CTP.</p><p id="p-0019" num="0018">Further, after the step of sending the interrupt signal to the CTP driving module by the CTP, the method further comprises: sending a pulse signal having a preset duration to the Psensor driving module by the CTP driving module.</p><p id="p-0020" num="0019">Further, the preset duration is 1 ms-20 ms.</p><p id="p-0021" num="0020">According to another aspect of the present application, an embodiment of the present application provides a terminal device, including a processor and a memory, the processor is electrically connected to the memory, the memory is configured to store instructions and data, and the processor is configured to implement the steps in the ranging method, and the ranging method comprises the following steps: enabling a capacitive touch panel (CTP) of the terminal device through a capacitive touch panel driving module in a kernel system of a terminal device, wherein the CTP driving module is controlled by a CTP driving program; sending an enabling instruction to a proximity sensor (Psensor) driving module provided in a digital signal processor of the terminal device, wherein the Psensor driving module is controlled by a Psensor driving program; receiving a distance event sent by the Psensor driving module; and acquiring distance information of an object and the CTP through the CTP driving module.</p><p id="p-0022" num="0021">Further, after the step of enabling the CTP of the terminal device through the CTP driving module, the method further comprises a step of: receiving a ranging request.</p><p id="p-0023" num="0022">Further, after the step of sending the enabling instruction to the Psensor driving module provided in the digital signal processor of the terminal device and before the step of receiving the distance event sent by the Psensor driving module, the method further comprises steps of: detecting the distance event by the CTP; and sending an interrupt signal to the CTP driving module by the CTP.</p><p id="p-0024" num="0023">Further, after the step of sending the interrupt signal to the CTP driving module by the CTP, the method further comprises: sending a pulse signal having a preset duration to the Psensor driving module by the CTP driving module.</p><p id="p-0025" num="0024">Further, the preset duration is 1 ms-20 ms.</p><heading id="h-0007" level="1">Advantages of the Present Disclosure</heading><p id="p-0026" num="0025">The advantage of the present application is that, by adding a processing unit to the hardware abstraction layer of the terminal device, the present application is used for establishing a communication channel between the capacitive touch panel driving module in the kernel system of the terminal device and the proximity sensor driving module in the digital signal processor of the terminal device. In addition, the terminal device also adds an external interrupt signal, so that the Psensor driving module provided in the digital signal processor of the terminal device can send a distance event in time, thereby replacing a physical Psensor with a software method and effectively reducing costs.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0008" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0027" num="0026">To describe the technical solutions of the embodiments of this disclosure more clearly, the following briefly introduces the accompanying drawings required for describing the embodiments. Apparently, the accompanying drawings in the following description show only some embodiments of this disclosure, and a person of ordinary skill in the art may still derive other drawings from these accompanying drawings without creative efforts.</p><p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a flowchart of steps of a ranging method provided by an embodiment of the present application.</p><p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a schematic structural diagram of a ranging apparatus provided by an embodiment of the present application.</p><p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a schematic structural diagram of a terminal device provided by an embodiment of the present application.</p><p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is another schematic structural diagram of the terminal device provided by an embodiment of the present application.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0009" level="1">DETAILED DESCRIPTION</heading><p id="p-0032" num="0031">The following clearly and completely describes the technical solutions in the embodiments of this disclosure with reference to the accompanying drawings in the embodiments of this disclosure. Apparently, the described embodiments are some of the embodiments of this disclosure rather than all of the embodiments. All other embodiments obtained by a person skilled in the art based on the embodiments of this disclosure without creative efforts shall fall within the protection scope of this disclosure.</p><p id="p-0033" num="0032">In the description of the present application, it is to be understood that terms such as &#x201c;center&#x201d;, &#x201c;longitudinal&#x201d;, &#x201c;lateral&#x201d;, &#x201c;length&#x201d;, &#x201c;width&#x201d;, &#x201c;thickness&#x201d;, &#x201c;upper&#x201d;, &#x201c;lower&#x201d;, &#x201c;front&#x201d;, &#x201c;back&#x201d;, &#x201c;left&#x201d;, &#x201c;right&#x201d;, &#x201c;vertical&#x201d;, &#x201c;horizontal&#x201d;, &#x201c;top&#x201d;, &#x201c;bottom&#x201d;, &#x201c;inner&#x201d;, &#x201c;outer&#x201d;, &#x201c;clockwise&#x201d;, &#x201c;counterclockwise&#x201d;, &#x201c;axial&#x201d;, &#x201c;radial&#x201d;, &#x201c;circumferential&#x201d; should be construed to refer to the orientation as then described or as shown in the drawings under discussion. These relative terms are for convenience of description only and do not require that the present application be constructed or operated in a particular orientation. Accordingly, this disclosure should not therefore be construed as a limitation on the present application.</p><p id="p-0034" num="0033">In addition, terms such as &#x201c;first&#x201d; and &#x201c;second&#x201d; are used herein for purposes of description and are intended to indicate or imply relative importance or significance or to imply the number of indicated technical features. Thus, the feature defined with &#x201c;first&#x201d;, &#x201c;second&#x201d; may explicitly or implicitly include at least one of the features. Furthermore, in the description of the present application, &#x201c;multiple&#x201d; means at least two, such as two, three, etc., unless clearly specified otherwise.</p><p id="p-0035" num="0034">As shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, a ranging method provided by an embodiment of the present application includes following steps:</p><p id="p-0036" num="0035">Step S<b>110</b>: receiving a ranging request.</p><p id="p-0037" num="0036">An operating system of a terminal device sends a ranging request to a hardware abstraction layer <b>10</b> of the terminal device. The hardware abstraction layer <b>10</b> of the terminal device is disposed between an operating system kernel of the terminal device and a hardware circuit of the terminal device. A function of the hardware abstraction layer <b>10</b> of the terminal device is to abstract the hardware (that is, a hardware is virtualized into corresponding functional units). At present, the operating system kernel of the terminal device is typically divided into the operating system kernel for Android and the operating system kernel for IOS (APPLE). The hardware circuit mainly is a connecting circuit between one hardware and another hardware of the terminal device.</p><p id="p-0038" num="0037">Step S<b>120</b>: enabling a capacitive touch panel (CTP) of the terminal device through a capacitive touch panel driving module in a kernel system (Kernel) of the terminal device.</p><p id="p-0039" num="0038">Step S<b>130</b>: sending an enabling instruction to a proximity sensor (Psensor) driving module provided in a digital signal processor (DSP) of the terminal device.</p><p id="p-0040" num="0039">In step S<b>120</b> and step S<b>130</b>, after receiving the ranging request, the hardware abstraction layer <b>10</b> will respectively enable the capacitive touch panel of the terminal device and the proximity sensor driving module provided in the digital signal processor of the terminal device. The capacitive touch panel will switch to a working mode after receiving the enabling instruction. The digital signal processor is configured to detect continuous analog signals.</p><p id="p-0041" num="0040">Step S<b>140</b>: detecting a distance event by the capacitive touch panel.</p><p id="p-0042" num="0041">The capacitive touch panel determines a result of distance detection event and generates distance information according to a current movement state of an object. The distance information includes approaching information and departing information between the object and the capacitive touch panel.</p><p id="p-0043" num="0042">Step S<b>150</b>: sending an interrupt signal to the capacitive touch panel driving module by the capacitive touch panel.</p><p id="p-0044" num="0043">In step S<b>150</b>, the capacitive touch panel will also send the interrupt signal to the capacitive touch panel driving module in the kernel system at this time. The interrupt signal is used to interrupt a program currently being processed by the capacitive touch panel driving module, so that the capacitive touch panel driving module executes step S<b>160</b>. Therefore, the interrupt signal allows the capacitive touch panel driving module to execute information provided in Step S<b>160</b> in a timely manner.</p><p id="p-0045" num="0044">Step S<b>160</b>: sending a pulse signal having a preset duration to the proximity sensor driving module by the capacitive touch panel driving module.</p><p id="p-0046" num="0045">After the capacitive touch panel driving module receives the interrupt signal, the capacitive touch panel driving module sends the pulse signal having the preset duration to the proximity sensor driving module, and the preset duration is 1 ms-20 ms. In an embodiment, the preset duration is 10 ms, but not limited thereto. In other embodiments, the preset duration may also be 15 ms or 20 ms.</p><p id="p-0047" num="0046">Step S<b>170</b>: receiving a distance event sent by the proximity sensor driving module.</p><p id="p-0048" num="0047">After the proximity sensor driving module receives the pulse signal, the proximity sensor driving module will send the distance event to the hardware abstraction layer <b>10</b> of the terminal device.</p><p id="p-0049" num="0048">Step S<b>180</b>: acquiring distance information between the object and the capacitive touch panel through the capacitive touch panel driving module.</p><p id="p-0050" num="0049">After receiving the distance event, the hardware abstraction layer <b>10</b> of the terminal device will acquire the distance information between the object and the capacitive touch panel through the capacitive touch panel driving module.</p><p id="p-0051" num="0050">Under collective action of step S<b>120</b>, step S<b>130</b>, step S<b>170</b>, and step S<b>180</b>, it is possible to effectively solve the problem that direct communication between the driver for CTP and the driver for Psensor in the prior art is not possible, and to realize the establishment of a communication channel between the capacitive touch panel driving module in the kernel system of the terminal device and the proximity sensor driving module provided in the digital signal processor of the terminal device.</p><p id="p-0052" num="0051">Step S<b>190</b>: reporting a determination result to the terminal device according to the distance information.</p><p id="p-0053" num="0052">The hardware abstraction layer <b>10</b> of the terminal device reports the determination result to the terminal device according to the distance information.</p><p id="p-0054" num="0053">An advantage of the present application is that, by adding a processing unit to the hardware abstraction layer of the terminal device, the present application is used for establishing a communication channel between the capacitive touch panel driving module in the kernel system of the terminal device and the proximity sensor driving module in the digital signal processor of the terminal device. In addition, the terminal device also adds an external interrupt signal, so that the proximity sensor driving module provided in the digital signal processor of the terminal device can send a distance event in time. The present application can realize the replacement of the physical proximity sensor with the software method through the foregoing structural design and implementation of the steps, thereby effectively reducing costs.</p><p id="p-0055" num="0054">As shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, which is a schematic structural diagram of a ranging apparatus provided by an embodiment of the disclosure, the ranging apparatus includes: a ranging request unit <b>1</b>, a capacitive touch panel enabling unit <b>2</b>, a proximity sensor driving module enabling unit <b>3</b>, a distance event receiving unit <b>4</b>, a distance information acquiring unit <b>5</b>, a distance information reporting unit <b>6</b>, a capacitive touch panel driving unit <b>21</b>, a capacitive touch panel <b>22</b>, and a proximity sensor driving unit <b>31</b>.</p><p id="p-0056" num="0055">The ranging request unit <b>1</b>, the capacitive touch panel enabling unit <b>2</b>, the proximity sensor driving module enabling unit <b>3</b>, the distance event receiving unit <b>4</b>, the distance information acquiring unit <b>5</b>, and the distance information reporting unit <b>6</b> are disposed in the hardware abstraction layer <b>10</b>. The hardware abstraction layer <b>10</b> of the terminal device is disposed between the operating system kernel of the terminal device and the hardware circuit of the terminal device. The function of the hardware abstraction layer <b>10</b> of the terminal device is to abstract the hardware.</p><p id="p-0057" num="0056">In this embodiment, a processing unit <b>11</b> is provided in the hardware abstraction layer <b>10</b> of the terminal device, and the processing unit includes: the ranging request unit <b>1</b>, the capacitive touch panel enabling unit <b>2</b>, the proximity sensor driving module enabling unit <b>3</b>, the distance event receiving unit <b>4</b>, the distance information acquiring unit <b>5</b>, and the distance information reporting unit <b>6</b>. In this application, the processing unit is added to the hardware abstraction layer of the terminal device to establish the communication channel between the capacitive touch panel driving module in the kernel system of the terminal device and the proximity sensor driving module provided in the digital signal processor of the terminal device.</p><p id="p-0058" num="0057">The ranging request unit <b>1</b> is connected to the capacitive touch panel enabling unit <b>2</b>, and the ranging request unit <b>1</b> is configured to receive a ranging request. The operating system of the terminal device sends a ranging request to the ranging request unit <b>1</b> in the hardware abstraction layer <b>10</b> of the terminal device.</p><p id="p-0059" num="0058">The capacitive touch panel enabling unit <b>2</b> is configured to enable the capacitive touch panel <b>22</b> through the capacitive touch panel driving unit <b>21</b> in the kernel system of the terminal device. After receiving the ranging request, the hardware abstraction layer <b>10</b> of the terminal device will respectively enable the capacitive touch panel <b>22</b> of the terminal device and the proximity sensor driving unit <b>31</b> provided in the digital signal processor <b>30</b> of the terminal device. The capacitive touch panel <b>22</b> will switch to the working mode after receiving the enabling instruction.</p><p id="p-0060" num="0059">The proximity sensor driving module enabling unit <b>3</b> is connected to the capacitive touch panel enabling unit <b>21</b>, and the proximity sensor driving module enabling unit <b>3</b> is configured to send an enabling instruction to the proximity sensor driving unit <b>31</b> provided in the digital signal processor <b>30</b> of the terminal device.</p><p id="p-0061" num="0060">The distance event receiving unit <b>4</b> is connected to the proximity sensor driving module enabling unit <b>3</b>, and the distance event receiving unit <b>4</b> is configured to receive a distance event sent by the proximity sensor driving unit <b>31</b>.</p><p id="p-0062" num="0061">The distance information acquiring unit <b>5</b> is connected to the distance event receiving unit <b>4</b>, and the distance information acquiring unit <b>5</b> is configured to acquire distance information between an object and the capacitive touch panel <b>22</b> through the capacitive touch panel driving unit <b>21</b>.</p><p id="p-0063" num="0062">The capacitive touch panel driving unit <b>21</b> is disposed in the kernel system <b>20</b>. The proximity sensor driving unit <b>31</b> is disposed in the digital signal processor <b>30</b>.</p><p id="p-0064" num="0063">The capacitive touch panel driving unit <b>21</b> is connected to the capacitive touch panel enabling unit <b>2</b>. The capacitive touch panel <b>22</b> is connected to the capacitive touch panel driving unit <b>3</b>. The proximity sensor driving unit <b>31</b> is connected to the proximity sensor driving module enabling unit <b>3</b>.</p><p id="p-0065" num="0064">The advantage of the present application is that, by adding the processing unit to the hardware abstraction layer of the terminal device, the present application is used for establishing the communication channel between the capacitive touch panel driving module in the kernel system of the terminal device and the proximity sensor driving module in the digital signal processor of the terminal device. In addition, the terminal device also adds an external interrupt signal, so that the proximity sensor driving module in the digital signal processor of the terminal device can send the distance event in time. The present application can realize the replacement of the physical proximity sensor with the software method through the foregoing structural design and implementation of steps, thereby effectively reducing costs.</p><p id="p-0066" num="0065">As shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, an embodiment of the present application further provides a terminal device, where the terminal device may be a smartphone, a tablet computer, or other devices. Specifically, as shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the terminal device <b>200</b> includes a processor <b>201</b> and a memory <b>202</b>. The processor <b>201</b> is electrically connected to the memory <b>202</b>.</p><p id="p-0067" num="0066">The processor <b>201</b> is a control center of the terminal device <b>200</b> and is connected to various parts of the terminal device using various interfaces and lines. By running or loading applications stored in the memory <b>202</b> and invoking data stored in the memory <b>202</b>, the processor <b>201</b> executes various functions of the terminal device and performs data processing, thereby performing an overall monitoring on the terminal device.</p><p id="p-0068" num="0067">In this embodiment, the terminal device <b>200</b> is provided with multiple storage partitions, and the multiple storage partitions include a system partition and a target partition. The processor <b>201</b> in the terminal device <b>200</b> loads instructions corresponding to processes of one or more applications into the memory <b>202</b> in the following steps, and the processor <b>201</b> runs the applications stored in the memory <b>202</b> so as to implement various functions:</p><p id="p-0069" num="0068">enabling a capacitive touch panel of the terminal device through a capacitive touch panel driving module in a kernel system of the terminal device;</p><p id="p-0070" num="0069">sending an enabling instruction to a proximity sensor driving module provided in a digital signal processor of the terminal device;</p><p id="p-0071" num="0070">receiving a distance event sent by the proximity sensor driving module; and</p><p id="p-0072" num="0071">acquiring distance information of an object and the capacitive touch panel through the capacitive touch panel driving module.</p><p id="p-0073" num="0072"><figref idref="DRAWINGS">FIG. <b>4</b></figref> shows a specific structural block diagram of the terminal device provided by an embodiment of the present application, and the terminal device can be used to implement the ranging method provided in the foregoing embodiments. The terminal device <b>300</b> may be a smart phone or a tablet computer.</p><p id="p-0074" num="0073">A radio frequency (RF) circuit <b>310</b> may be configured to receive and transmit electromagnetic waves and to realize mutual conversions of the electromagnetic waves and electrical signals, thereby communicating with a communication network or any other devices. The RF circuit <b>310</b> may include various existing circuit elements used for performing these functions, for example, an antenna, a radio frequency transceiver, a digital signal processor, an encryption/decryption chip, a subscriber identification module (SIM) card, a memory, and the like. The RF circuit <b>310</b> may communicate with various networks, for example, an internet, an intranet, or a wireless network, or may communicate with any other devices via a wireless network. The foregoing wireless network may include a cellular telephone network, a wireless local area network, or a metropolitan area network. The foregoing wireless network may use various communication standards, protocols, and technologies and may include but not limited to, Global System of Mobile Communication (GSM), Enhanced Data GSM Environment (EDGE), wideband code-division multiple access (WCDMA), code-division multiple access (CDMA), time-division multiple access (TDMA), Wireless Fidelity (WI-FI, for example, Institute of Electrical and Electronics Engineers (IEEE) 802.11a, IEEE 802.11b, IEEE 802.11g and/or IEEE 802.11n), Voice over Internet Protocol (VoIP), Worldwide Interoperability for Microwave Access (Wi-MAX), other protocols for E-mail, instant messaging, and Short Messaging Service (SMS), and other suitable communication protocols, and may even include protocols which are not developed currently.</p><p id="p-0075" num="0074">A memory <b>320</b> may be configured to store software programs and modules, for example, the program instructions/modules corresponding to the ranging method in accordance with the foregoing embodiments. A processor <b>380</b> performs a variety of functional applications and data processing (that is, to achieve the functions of ranging method) by executing the software programs and the modules stored in the memory <b>320</b>. The memory <b>320</b> may include a high speed random access memory, and may further include a nonvolatile memory, such as one or more of a magnetic disk storage device, a flash memory, or other non-volatile solid state storage devices. In some instances, the memory <b>320</b> may further include memory remotely located relative to the processor <b>380</b>, and such remote memory can be connected to the terminal device <b>300</b> via a network. Examples of the network include, but are not limited to, an internet, an intranet, a local area network, a mobile communication network, and any combinations thereof.</p><p id="p-0076" num="0075">An input unit <b>330</b> may be configured to receive numeric or character information inputted and to generate input signals of a keyboard, a mouse, a lever, an optics, or a trackball related to object settings and functional controls. Specifically, the input unit <b>330</b> may include a touch-sensitive surface <b>331</b> and other input devices <b>332</b>. The touch-sensitive surface <b>331</b>, also known as a touch display or a trackpad, collects touch operations of object on or near the surface, such as operations on the touch-sensitive surface <b>331</b> or near the touch-sensitive surface <b>331</b> triggered by the object using a finger, stylus, or any suitable object or accessory, and drives a corresponding device connected therewith according to a preset program. The touch-sensitive surface <b>331</b> can optionally include two parts: a touch detection device and a touch controller. Wherein, the touch detection device detects touch locations and directions of the users, detects signals generated by touch operations, and transmits the signals to the touch controller. The touch controller receives touch information from the touch detection device, converts the touch information into contact coordinates, and sends the contact coordinates to the processor <b>380</b>, and can receive and execute commands from the processor <b>380</b>. Additionally, the touch-sensitive surface <b>331</b> can be implemented by various types of resistive, capacitive, infrared, and surface acoustic wave touch-sensitive surfaces. In addition to the touch-sensitive surface <b>331</b>, the input unit <b>330</b> can also include the other input devices <b>332</b>. Specifically, the other input devices <b>332</b> may include, but are not limited to, one or more of physical keyboards, function keys such as volume control keys, switching keys, etc., trackballs, mice, levers, and the like.</p><p id="p-0077" num="0076">A display unit <b>340</b> may be configured to display information input by users or presented the information to the users as well as to various graphical user interfaces (GUIs) of the terminal device <b>300</b>, which can include graphics, texts, icons, videos, and any combinations thereof. The display unit <b>340</b> may include a display panel <b>341</b>, which may be optionally configured with forms of a liquid crystal display (LCD), an organic light-emitting diode (OLED), etc. Further, the touch-sensitive surface <b>331</b> can cover the display panel <b>341</b>. When detecting the touch operations on surface or the touch operations in proximity, the touch-sensitive surface <b>331</b> transmits the detected operations to the processor <b>380</b> to determine a type of a touch event. The processor <b>380</b> provides a corresponding visual output on the display panel <b>341</b> according to the type of the touch event. Although the touch-sensitive surface <b>331</b> and the display panel <b>341</b> in <figref idref="DRAWINGS">FIG. <b>4</b></figref> are used as two separate components to implement input and output functions, in some embodiments, the touch-sensitive surface <b>331</b> can be integrated with the display panel <b>341</b> to implement the input and output functions.</p><p id="p-0078" num="0077">The terminal device <b>300</b> may also include at least one sensor <b>350</b>, such as an optical sensor, a motion sensor, and a sensor of other types. Specifically, the optical sensor may include an ambient light sensor and a proximity sensor. Wherein, the ambient light sensor can adjust brightness of the display panel <b>341</b> according to brightness and darkness of ambient light. The proximity sensor can turn off the display panel <b>341</b> and/or backlight when the terminal device <b>300</b> moves near an ear. As a type of a motion sensor, a gravity acceleration sensor can detect magnitude of acceleration in all directions, generally three axes, and detect a level and a direction of gravity at rest. The gravity acceleration sensor can be used in applications of identifying mobile phone orientation, such as vertical and horizontal screen switching, games, and magnetometer calibration, applications of vibration recognition related functions, such as pedometers and tapping. The terminal device <b>300</b> can also be configured with gyroscopes, barometers, hygrometers, thermometers, infrared sensors, and other sensors, and details are not described here.</p><p id="p-0079" num="0078">An audio circuit <b>360</b>, a speaker <b>361</b>, and a microphone <b>362</b> can provide an audio interface between a user and the terminal device <b>300</b>. The audio circuit <b>360</b> can receive electrical signals converted from audio data and transmit received electrical signals to the speaker <b>361</b>. The speaker <b>361</b> converts the electrical signals to sound signals for output. On another hand, the microphone <b>362</b> converts collected sound signals into electrical signals, which are received and converted by the audio circuit <b>360</b> into audio data. The audio data is output to the processor <b>380</b> for processing and is sent to, for example, another terminal device through the RF circuit <b>310</b>. Alternatively, the audio data is output to the memory <b>320</b> for further processing. The audio circuit <b>360</b> may also include a headset jack for communicationally interfacing a peripheral headset and the terminal device <b>300</b>.</p><p id="p-0080" num="0079">The terminal device <b>300</b> facilitates a user to send and receive e-mail, browse the web, and access streaming media via a transmission module <b>370</b>, such as a WI-FI module, which provides the user with wireless broadband Internet access. Although <figref idref="DRAWINGS">FIG. <b>4</b></figref> shows the transmission module <b>370</b>, it may be understood that the transmission module <b>370</b> is not an essential component of the terminal device <b>300</b>, and can be optionally omitted without changing the nature and scope of this disclosure.</p><p id="p-0081" num="0080">The processor <b>380</b> is a control center of the terminal device <b>300</b> and is connected to various parts of the phone by using various interfaces and lines. By running or executing a software program and/or module stored in the memory <b>320</b> and invoking data stored in the memory <b>320</b>, the processor <b>380</b> executes various functions of the terminal device and performs data processing, thereby performing an overall monitoring on a cell phone. The processor <b>380</b> may optionally include one or more processing cores. In some embodiments, the processor <b>380</b> may integrate an application processor and a modem processor. The application processor mainly processes an operating system, a user interface, an application program, and the like. The modem processor mainly processes wireless communication. It may be understood that the foregoing modem processor may alternatively not be integrated into the processor <b>380</b>.</p><p id="p-0082" num="0081">The terminal device <b>300</b> further includes a power supply <b>390</b>, such as batteries, for supplying power to various components. In some embodiments, the power supply may be logically connected to the processor <b>380</b> by a power management system, thereby implementing management functions such as charging, discharging, and power consumption management by the power management system. The power supply <b>390</b> may further include one or more of a direct current (DC) or alternate current (AC) power supply, a re-charging system, a power fault detection circuit, a power converter or inverter, a power state indicator, or any other components.</p><p id="p-0083" num="0082">Although not shown in the figure, the terminal device <b>300</b> may further include a camera, such as a front camera and a rear camera, a BLUETOOTH module, etc., and details are not further described here. Specifically, in this embodiment, the display unit of the terminal device is a touch screen display. The terminal device further includes memory as well as one or more programs, one or more of which are stored in the memory. The one or more programs configured to be executed by one or more processors contain instructions for performing following operations of:</p><p id="p-0084" num="0083">enabling a capacitive touch panel of the terminal device through a capacitive touch panel driving module in a kernel system of the terminal device;</p><p id="p-0085" num="0084">sending an enabling instruction to a proximity sensor driving module provided in a digital signal processor of the terminal device;</p><p id="p-0086" num="0085">receiving a distance event sent by the proximity sensor driving module; and</p><p id="p-0087" num="0086">acquiring a distance information of an object and the capacitive touch panel through the capacitive touch panel driving module.</p><p id="p-0088" num="0087">In a specific implementation, the above modules may be implemented as independent entities, or may be arbitrarily combined, to implement as a same or several entities. For the specific implementation of the above modules, the above method embodiments may be referred to, which will not be further described here again.</p><p id="p-0089" num="0088">A person of ordinary skill in the art could understand that, all or some steps of various methods in the embodiments may be implemented through instructions, or implemented through hardware related to instructions control, and the instructions may be stored in a computer-readable storage medium and loaded and executed by a processor.</p><p id="p-0090" num="0089">To this end, an embodiment of this application provides a storage medium storing a plurality of instructions therein, and the instructions are suitable to be loaded by the processor to perform the steps in any ranging method according to the embodiments of this application.</p><p id="p-0091" num="0090">The storage medium may include: a read-only memory (ROM), a random access memory (RAM), a magnetic disk, an optical disc, or the like.</p><p id="p-0092" num="0091">Since the instructions stored in the storage medium may perform the steps of any ranging method in the embodiments of this disclosure, the instructions can achieve beneficial effects that may be achieved by any ranging method in the embodiments of this disclosure. For details, reference may be made to the foregoing embodiments. Details are not further described here.</p><p id="p-0093" num="0092">For a specific implementation of each of the foregoing operations, reference may be made to the foregoing embodiments. This is not further described here again.</p><p id="p-0094" num="0093">To sum up, although the present application has been disclosed in terms of the preferred embodiment, the foregoing preferred embodiment is not intended to limit the present application. Those skilled in the art can make various changes and modifications without departing from the spirit and scope of the present application. Therefore, the scope of protection of the present application shall be as defined in the claims.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A ranging method, which is applicable to a terminal device, wherein the method comprises following steps:<claim-text>enabling a capacitive touch panel of the terminal device through a capacitive touch panel driving module in a kernel system of the terminal device, wherein the capacitive touch panel driving module is controlled by a capacitive touch panel driving program;</claim-text><claim-text>sending an enabling instruction to a proximity sensor driving module provided in a digital signal processor of the terminal device, wherein the proximity sensor driving module is controlled by a proximity sensor driving program;</claim-text><claim-text>receiving a distance event sent by the proximity sensor driving module; and</claim-text><claim-text>acquiring distance information of an object and the capacitive touch panel through the capacitive touch panel driving module.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The ranging method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein after the step of enabling the capacitive touch panel of the terminal device through the capacitive touch panel driving module, the method further comprises a step of: receiving a ranging request.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The ranging method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein after the step of sending the enabling instruction to the proximity sensor driving module provided in the digital signal processor of the terminal device and before the step of receiving the distance event sent by the proximity sensor driving module, the method further comprises steps of: detecting the distance event by the capacitive touch panel; and sending an interrupt signal to the capacitive touch panel driving module by the capacitive touch panel.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The ranging method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein after the step of sending the interrupt signal to the capacitive touch panel driving module by the capacitive touch panel, the method further comprises: sending a pulse signal having a preset duration to the proximity sensor driving module by the capacitive touch panel driving module.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The ranging method as claimed in <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the preset duration is 1 ms-20 ms.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The ranging method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein after the step of acquiring the distance information of the object and the capacitive touch panel through the capacitive touch panel driving module, the method further comprises: reporting a determination result to the terminal device according to the distance information.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. (canceled)</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. (canceled)</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. A computer-readable storage medium, wherein a plurality of instructions are stored in the storage medium, and the instructions are adapted to be loaded by a processor to execute a ranging method; the ranging method comprises:<claim-text>enabling a capacitive touch panel of a terminal device through a capacitive touch panel driving module in a kernel system of the terminal device, wherein the capacitive touch panel driving module is controlled by a capacitive touch panel driving program;</claim-text><claim-text>sending an enabling instruction to a proximity sensor driving module provided in a digital signal processor of the terminal device, wherein the proximity sensor driving module is controlled by a proximity sensor driving program;</claim-text><claim-text>receiving a distance event sent by the proximity sensor driving module; and</claim-text><claim-text>acquiring distance information of an object and the capacitive touch panel through the capacitive touch panel driving module.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The computer-readable storage medium as claimed in <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein after the step of enabling the capacitive touch panel of the terminal device through the capacitive touch panel driving module, the method further comprises a step of: receiving a ranging request.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The computer-readable storage medium as claimed in <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein after the step of sending the enabling instruction to the proximity sensor driving module provided in the digital signal processor of the terminal device and before the step of receiving the distance event sent by the proximity sensor driving module, the method further comprises steps of: detecting the distance event by the capacitive touch panel; and sending an interrupt signal to the capacitive touch panel driving module by the capacitive touch panel.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The computer-readable storage medium as claimed in <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein after the step of sending the interrupt signal to the capacitive touch panel driving module by the capacitive touch panel, the method further comprises: sending a pulse signal having a preset duration to the proximity sensor driving module by the capacitive touch panel driving module.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The computer-readable storage medium as claimed in <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the preset duration is 1 ms-20 ms.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The computer-readable storage medium as claimed in <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein after the step of acquiring the distance information of the object and the capacitive touch panel through the capacitive touch panel driving module, the method further comprises: reporting a determination result to the terminal device according to the distance information.</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. A terminal device, comprising a processor and a memory, the processor is electrically connected to the memory, the memory is configured to store instructions and data, and the processor is configured to implement steps in a ranging method, and the ranging method comprises following steps:<claim-text>enabling a capacitive touch panel of the terminal device through a capacitive touch panel driving module in a kernel system of the terminal device, wherein the capacitive touch panel driving module is controlled by a capacitive touch panel driving program;</claim-text><claim-text>sending an enabling instruction to a proximity sensor driving module provided in a digital signal processor of the terminal device, wherein the proximity sensor driving module is controlled by a proximity sensor driving program;</claim-text><claim-text>receiving a distance event sent by the proximity sensor driving module; and</claim-text><claim-text>acquiring distance information of an object and the capacitive touch panel through the capacitive touch panel driving module.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The terminal device as claimed in <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein after the step of enabling the capacitive touch panel of the terminal device through the capacitive touch panel driving module, the method further comprises a step of: receiving a ranging request.</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The terminal device as claimed in <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein after the step of sending the enabling instruction to the proximity sensor driving module provided in the digital signal processor of the terminal device and before the step of receiving the distance event sent by the proximity sensor driving module, the method further comprises steps of: detecting the distance event by the capacitive touch panel; and sending an interrupt signal to the capacitive touch panel driving module by the capacitive touch panel.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The terminal device as claimed in <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein after the step of sending the interrupt signal to the capacitive touch panel driving module by the capacitive touch panel, the method further comprises: sending a pulse signal having a preset duration to the proximity sensor driving module by the capacitive touch panel driving module.</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The terminal device as claimed in <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein the preset duration is 1 ms-20 ms.</claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The terminal device as claimed in <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein after the step of acquiring the distance information of the object and the capacitive touch panel through the capacitive touch panel driving module, the method further comprises: reporting a determination result to the terminal device according to the distance information.</claim-text></claim></claims></us-patent-application>