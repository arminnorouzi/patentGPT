<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230004431A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230004431</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17357529</doc-number><date>20210624</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>F</subclass><main-group>9</main-group><subgroup>50</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>F</subclass><main-group>9</main-group><subgroup>445</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>9</main-group><subgroup>5005</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>9</main-group><subgroup>44505</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">REMEDIATING DRIFT IN THE CLOUD</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Microsoft Technology Licensing, LLC</orgname><address><city>Redmond</city><state>WA</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>LEE</last-name><first-name>Yu-Chieh</first-name><address><city>Santa Clara</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>TANDON</last-name><first-name>Vaibhav</first-name><address><city>Santa Clara</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>PATEL</last-name><first-name>Dhaval H.</first-name><address><city>Fremont</city><state>CA</state><country>US</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">Techniques for remediating drift in real cloud infrastructure from desired cloud infrastructure. In one technique, a configuration graph is generated based on first infrastructure configuration code. A deployed state of a cloud infrastructure is generated based on a data schema and a current state of the cloud infrastructure. Resources indicated in the deployed state are matched to nodes in the configuration graph. Based on differences between the resources and the nodes, the configuration graph is updated to generate an updated configuration graph. Based on the updated configuration graph, second infrastructure configuration code is generated that is different than the first infrastructure configuration code.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="105.83mm" wi="158.75mm" file="US20230004431A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="254.08mm" wi="165.61mm" orientation="landscape" file="US20230004431A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="254.00mm" wi="168.91mm" orientation="landscape" file="US20230004431A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="257.89mm" wi="123.02mm" file="US20230004431A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="186.18mm" wi="168.49mm" file="US20230004431A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="258.74mm" wi="158.83mm" file="US20230004431A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="206.16mm" wi="164.51mm" file="US20230004431A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="206.16mm" wi="127.51mm" file="US20230004431A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="210.48mm" wi="152.99mm" file="US20230004431A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="251.46mm" wi="160.36mm" orientation="landscape" file="US20230004431A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">TECHNICAL FIELD</heading><p id="p-0002" num="0001">The present disclosure generally relates to cloud infrastructure management and, more particularly to, remediating drift of cloud configuration code.</p><heading id="h-0002" level="1">BACKGROUND</heading><p id="p-0003" num="0002">Cloud computing is the on-demand availability of computer system resources, such as data storage (&#x201c;cloud storage&#x201d;) and computing power, without direct active management by the user. &#x201c;Cloud computing&#x201d; is generally used to describe data centers available to many users over the Internet. Large clouds have functions distributed over multiple locations from central servers. A &#x201c;cloud&#x201d; may be limited to a single organization (referred to as an &#x201c;enterprise cloud&#x201d;) or may be available to multiple organizations (referred to as a &#x201c;public cloud&#x201d;).</p><p id="p-0004" num="0003">Cloud computing relies on sharing of resources to achieve coherence and economies of scale, allows companies to avoid or minimize up-front IT infrastructure costs, allows enterprises to get their applications up and running faster (with improved manageability and less maintenance), and enables IT teams to more rapidly adjust resources to meet fluctuating and unpredictable demand, thus providing burst computing capability, i.e., high computing power at certain periods of peak demand. Factors in the growth of cloud computing include the availability of high-capacity networks, low-cost computers and storage devices, and the widespread adoption of hardware virtualization.</p><p id="p-0005" num="0004">Infrastructure as code (IAC) software tools have been developed that allow enterprises to define and provide data center infrastructure using a declarative configuration language. An example of an open source version of such a software tool is Terraform and examples of declarative configuration languages include HashiCorp Configuration Language (HCL) and JavaScript Objection Notation (JSON).</p><p id="p-0006" num="0005">IAC is the process of managing and provisioning computer data centers through machine-readable definition files, rather than physical hardware configuration or interactive configuration tools. The IT infrastructure managed by this process comprises both physical equipment, such as bare-metal servers, as well as virtual machines, and associated configuration resources. The ability to treat infrastructure like code and use the same tools as any other software project allows developers to rapidly deploy applications.</p><p id="p-0007" num="0006">Using IAC software tools, such as Terraform, to manage and keep track of an enterprise's resources in the cloud has risks, drift being one of them. &#x201c;Drift&#x201d; happens when desired infrastructure deviates from real infrastructure. For example, an enterprise user employs a user interface provided by a cloud provider that hosts the enterprise's cloud to add a new database and load data into the new database. At this point, the deployed or &#x201c;real&#x201d; infrastructure of the enterprise's resources has deviated from the desired infrastructure that is reflected in the (e.g., Terraform) IAC code that describes the desired infrastructure. Another enterprise user, employing a user interface provided by an IAC software tool, may make a change to the IAC code and then apply the change to the current cloud. Because the modified IAC code does not refer to the new database, applying the modified IAC code would result in erasing the new database. And if the modified IAC code is applied in another data center or fabric, doing so will result in a cloud infrastructure that lacks the new database. Thus, resources created in the cloud might not be tracked, resulting in multiple potential issues, such as over-provisioning. As an example of over-provisioning, suppose an enterprise user creates a VMSS (virtual-machine-scale-set) with Azure Cloud for an enterprise. However, the enterprise manages one hundred subscriptions and thousands of resource groups, each of which contains potentially hundreds of resources. Having a human manually track resources and determine which resources and resource groups are no longer being used is difficult.</p><p id="p-0008" num="0007">Remediating drift, or conforming desired infrastructure to real infrastructure, requires manual intervention by one or more human operators. When operating at scale with hundreds of thousands of cloud resources, remediation can quickly become an operational nightmare with operators having to constantly edit infrastructure code. A log of changes may be kept to track changes to the cloud provider code. However, someone with familiarity with the (e.g., Terraform) configuration code must manually go through that log and translate each change into a change of the configuration code.</p><p id="p-0009" num="0008">If the IAC code does not accurately reflect the true or actual infrastructure, then using the IAC code to roll out new fabrics will result in fabrics that have differences compared to the true infrastructure. If a critical service in the true infrastructure is not reflected in the IAC code, then those rolled out fabrics could result in an outage.</p><p id="p-0010" num="0009">The approaches described in this section are approaches that could be pursued, but not necessarily approaches that have been previously conceived or pursued. Therefore, unless otherwise indicated, it should not be assumed that any of the approaches described in this section qualify as prior art merely by virtue of their inclusion in this section.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0011" num="0010">In the drawings:</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a block diagram that depicts an example system for automatically performing drift remediation, in an embodiment;</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a block diagram that depicts an example configuration graph that is generated based on an IAC, in an embodiment;</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIGS. <b>3</b>A-<b>3</b>B</figref> is a flow diagram that depicts an example process for propagating claims in a configuration graph, in an embodiment;</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flow diagram that depicts an example process for traversing a configuration graph, in an embodiment;</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>5</b>A-<b>5</b>C</figref> are block diagrams that depict an example configuration graph and multiple claims associated with the same node in configuration graph, in an embodiment;</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a block diagram that illustrates a computer system upon which an embodiment of the invention may be implemented.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0004" level="1">DETAILED DESCRIPTION</heading><p id="p-0018" num="0017">In the following description, for the purposes of explanation, numerous specific details are set forth in order to provide a thorough understanding of the present invention. It will be apparent, however, that the present invention may be practiced without these specific details. In other instances, well-known structures and devices are shown in block diagram form in order to avoid unnecessarily obscuring the present invention.</p><heading id="h-0005" level="1">General Overview</heading><p id="p-0019" num="0018">A system and method for remediating drift in infrastructure code are provided. In one technique, a directed graph is generated based on first infrastructure code that reflects a desired cloud infrastructure for an enterprise. The directed graph comprises (1) nodes representing infrastructure items, such as modules, resources, and data sources and (2) edges connecting some of the nodes. A deployed state data of the actual cloud infrastructure is generated based on current state data and a provider schema. Once the directed graph and the deployed state data are generated, infrastructure items indicated in the deployed state data are matched to infrastructure items indicated in the directed graph. Based on differences between the two sets of infrastructure items, the directed graph is updated to generate an updated graph. Based on the updated graph, second infrastructure code is automatically generated that is different than the first infrastructure code and reflects the differences between the desired cloud infrastructure and the actual cloud infrastructure.</p><p id="p-0020" num="0019">Embodiments improve computer-related technology by automatically remediating drift in infrastructure code. Embodiments allow drift to be fixed automatically and data center rollout to be consistent.</p><heading id="h-0006" level="1">Example Infrastructure Configuration Code</heading><p id="p-0021" num="0020">The following is a simple example of desired infrastructure configuration code (labeled &#x201c;Original Configuration Code&#x201d;) for an enterprise in order to illustrate drift remediation:</p><p id="p-0022" num="0000"><tables id="TABLE-US-00001" num="00001"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="259pt" align="center"/><thead><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row><row><entry>Original Configuration Code</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="259pt" align="left"/><tbody valign="top"><row><entry>provider &#x201c;azurerm&#x201d; {</entry></row><row><entry>&#x2003;subscription_id = &#x201c;*************************&#x201d;</entry></row><row><entry>&#x2003;tenant_id&#x2003;&#x2003;= &#x201c;*************************&#x201d;</entry></row><row><entry>&#x2003;features { }</entry></row><row><entry>&#x2003;skip_provider_registration = true</entry></row><row><entry>}</entry></row><row><entry>resource &#x201c;azurerm_cosmosdb_account&#x201d; &#x201c;tfaas_db&#x201d; {</entry></row><row><entry>&#x2003;enable_automatic_failover&#x2003;&#x2003;= true</entry></row><row><entry>&#x2003;enable_multiple_write_locations&#x2003;= false</entry></row><row><entry>&#x2003;ip_range_filter&#x2003;&#x2003;&#x2003;= &#x201c;&#x201d;</entry></row><row><entry>&#x2003;is_virtual_network_filter_enabled = false</entry></row><row><entry>&#x2003;kind&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;= &#x201c;GlobalDocumentDB&#x201d;</entry></row><row><entry>&#x2003;location&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;= &#x201c;southcentralus&#x201d;</entry></row><row><entry>&#x2003;name&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;= &#x201c;cosmosdb-dev-tfaas-*********&#x201d;</entry></row><row><entry>&#x2003;offer_type&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;= &#x201c;Standard&#x201d;</entry></row><row><entry>&#x2003;resource_group_name&#x2003;&#x2003;&#x2003;= &#x201c;rg-dev-tfaas-1&#x201d;</entry></row><row><entry>&#x2003;consistency_policy {</entry></row><row><entry>&#x2003;&#x2003;consistency_level&#x2003;&#x2003;= &#x201c;BoundedStaleness&#x201d;</entry></row><row><entry>&#x2003;&#x2003;max_interval_in_seconds = 500</entry></row><row><entry>&#x2003;&#x2003;max_staleness_prefix&#x2003;= 100000</entry></row><row><entry>&#x2003;}</entry></row><row><entry>&#x2003;geo_location {</entry></row><row><entry>&#x2003;&#x2003;failover_priority = 0</entry></row><row><entry>&#x2003;&#x2003;location&#x2003;&#x2003;&#x2003;= &#x201c;southcentralus&#x201d;</entry></row><row><entry>&#x2003;&#x2003;prefix&#x2003;&#x2003;&#x2003;= &#x201c;&#x201d;</entry></row><row><entry>&#x2003;}</entry></row><row><entry>}</entry></row><row><entry>resource &#x201c; azurerm_private_endpoint&#x201d; &#x201c;db_endpoint&#x201d; {</entry></row><row><entry>&#x2003;location&#x2003;&#x2003;&#x2003;= &#x201c;eastus&#x201d;</entry></row><row><entry>&#x2003;name&#x2003;&#x2003;&#x2003;= &#x201c;cosmosdb-dev-tfaas-*********-eastus-pe&#x201d;</entry></row><row><entry>&#x2003;resource_group_name = &#x201c;rg-dev-tfaas-1&#x201d;</entry></row><row><entry>&#x2003;subnet_id&#x2003;&#x2003;&#x2003;=</entry></row><row><entry>&#x201c;/subscriptions/*************************/resourceGroups/arp-lnkdprod-</entry></row><row><entry>eastus-vnet-</entry></row><row><entry>29/providers/Microsoft.Network/virtualNetworks/vnet3/subnets/subnet479842&#x201d;</entry></row><row><entry>&#x2003;private_service_connection {</entry></row><row><entry>&#x2003;&#x2003;is_manual_connection&#x2003;&#x2003;= false</entry></row><row><entry>&#x2003;&#x2003;name&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;= &#x201c;cosmosdb-dev-tfaas-*********-pe&#x201d;</entry></row><row><entry>&#x2003;&#x2003;private_connection_resource_id =</entry></row><row><entry>&#x201c;/subscriptions/*************************/resourceGroups/rg-dev-tfaas-</entry></row><row><entry>1/providers/Microsoft.DocumentDB/databaseAccounts/cosmosdb-dev-tfaas-</entry></row><row><entry>*********&#x201d;</entry></row><row><entry>&#x2003;&#x2003;request_message&#x2003;&#x2003;&#x2003;&#x2003;= &#x201c;&#x201d;</entry></row><row><entry>&#x2003;&#x2003;subresource_names&#x2003;&#x2003;&#x2003;&#x2003;= [&#x201c;Sql&#x201d;]</entry></row><row><entry>&#x2003;}</entry></row><row><entry>}</entry></row><row><entry>resource &#x201c;azurerm_private_endpoint&#x201d; &#x201c;db_endpoint_southcentral&#x201d; {</entry></row><row><entry>&#x2003;location&#x2003;&#x2003;&#x2003;&#x2003;= &#x201c;southcentralus&#x201d;</entry></row><row><entry>&#x2003;name&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;= &#x201c;cosmosdb-dev-tfaas-*********-southcentralus-pe&#x201d;</entry></row><row><entry>&#x2003;resource_group_name = &#x201c;rg-dev-tfaas-1&#x201d;</entry></row><row><entry>&#x2003;subnet_id&#x2003;&#x2003;&#x2003;=</entry></row><row><entry>&#x201c;/subscriptions/*************************/resourceGroups/scus-ei-lid-</entry></row><row><entry>network-</entry></row><row><entry>rg/providers/Microsoft.Network/virtualNetworks/eiLidAppVnet/subnets/App4Su</entry></row><row><entry>bnet&#x201d;</entry></row><row><entry>&#x2003;private_service_connection {</entry></row><row><entry>&#x2003;&#x2003;is_manual_connection&#x2003;&#x2003;= false</entry></row><row><entry>&#x2003;&#x2003;name&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;= &#x201c;cosmosdb-dev-tfaas-*********-pe&#x201d;</entry></row><row><entry>&#x2003;&#x2003;private_connection_resource_id =</entry></row><row><entry>&#x201c;/subscriptions/*************************/resourceGroups/rg-dev-tfaas-</entry></row><row><entry>1/providers/Microsoft.DocumentDB/databaseAccounts/cosmosdb-dev-tfaas-</entry></row><row><entry>*********&#x201d;</entry></row><row><entry>&#x2003;&#x2003;request_message&#x2003;&#x2003;&#x2003;= &#x201c;&#x201d;</entry></row><row><entry>&#x2003;&#x2003;subresource_names&#x2003;&#x2003;&#x2003;= [&#x201c;Sql&#x201d;]</entry></row><row><entry>&#x2003;}</entry></row><row><entry>}</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0023" num="0021">Original Configuration Code is an example of Terraform IAC configuration code. (An updated version of this configuration code is provided herein entitled &#x201c;Updated Configuration Code&#x201d; that may have been generated using techniques described herein.) In this example, there are two workload blocks within an intended state block, which is within a scale set resource block. In this example, the cloud provider is Microsoft Azure, but other example cloud providers include Google Cloud and Amazon Web Services.</p><p id="p-0024" num="0022">IAC configuration code (or infrastructure configuration code, or IAC for short) describes a configuration. A configuration may consist of multiple files and directories. A file containing IAC is referred to as a configuration file. A configuration informs a software tool (such as Terraform) how to manage an enterprise's infrastructure.</p><p id="p-0025" num="0023">IAC language is built around two main syntax constructs: arguments and configuration blocks (or &#x201c;blocks&#x201d; for short). An argument assigns a value to a particular name, referred to as an argument name or an attribute name. A value may be a primitive value (e.g., a string value, a Boolean value, or an integer value), a reference (i.e., to another block), or a combination of any of the two, such as two primitive values joined by an operator, or an aggregation of a primitive value and a reference.</p><p id="p-0026" num="0024">A block is a container for content and has a type. Examples of types of blocks include Resources, Local Variables, Data Sources, and Modules. A Module is a special block that acts as a container for Resources, Local Variables, and Data Sources.</p><p id="p-0027" num="0025">Each block includes a type name that indicates the block type (e.g., &#x201c;resource&#x201d; for resource, &#x201c;local&#x201d; for local variables and &#x201c;data&#x201d; for data sources). A module may be remote or local. A local module has local sources and a remote module has remote sources. For example, a local module references a configuration code path in a local directory containing Terraform code, while a remote module references a downloadable directory containing Terraform code.</p><p id="p-0028" num="0026">Each block type defines a number of labels that follow the type name. For example, the resource block type expects two labels. A particular block type may have any number of required labels, or it may require none, such as with the nested geo location block type.</p><p id="p-0029" num="0027">After the block type name and any labels, the body of the block is delimited by the and characters. Within the block body, further arguments and blocks may be nested, creating a hierarchy of blocks and their associated arguments.</p><p id="p-0030" num="0028">For the &#x201c;tfaas_db&#x201d; resource block in the example IAC above, attribute/argument names include &#x201c;enable_automatic_failover,&#x201d; &#x201c;enable_multiple_write_locations,&#x201d; and &#x201c;ip_range_filters,&#x201d; while attribute/argument names of the consistency_policy block include &#x201c;consistency_level&#x201d; and &#x201c;max_interval_in_seconds.&#x201d; In these examples, the values of the attribute/argument names (or &#x201c;attributes&#x201d; for short) are character strings. However, a value of an attribute may be an integer or reference to another block.</p><heading id="h-0007" level="1">System Overview</heading><p id="p-0031" num="0029"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a block diagram that depicts an example system <b>100</b> for automatically performing drift remediation, in an embodiment. System <b>100</b> includes a provider schema data <b>110</b>, current state data <b>120</b>, infrastructure as code (IAC) <b>130</b>, a remediation engine <b>140</b>, and updated IAC <b>160</b>. Remediation engine <b>140</b> includes a state generator <b>142</b>, deployed state data <b>144</b>, a graph generator <b>146</b>, a configuration graph <b>148</b>, a claims propagator <b>150</b>, and a claims resolver <b>152</b>.</p><p id="p-0032" num="0030">State generator <b>142</b> takes, as input, provider schema data <b>110</b> and current state data <b>120</b> and generates deployed state data <b>144</b> as output. Graph generator <b>146</b> takes IAC <b>130</b> as input and generates configuration graph <b>148</b> as output. Claims propagator <b>150</b> takes, as input, configuration graph <b>148</b> and deployed state data <b>144</b> and updates configuration graph <b>148</b> with one or more claims. A claim is a temporary assignment of an attribute value from deployed state data <b>144</b> to an attribute of a node in configuration graph <b>148</b>. After claims propagator <b>150</b> generates all claims, some attributes of nodes in configuration graph <b>148</b> may be associated with multiple claims.</p><p id="p-0033" num="0031">Claims resolver <b>152</b> resolves any situation where multiple claims are associated with the same node in configuration graph <b>148</b> and updates configuration graph <b>148</b> accordingly. Remediation engine <b>140</b> (or a component thereof) takes the updated version of configuration graph <b>148</b> and generates updated IAC <b>160</b> as output.</p><heading id="h-0008" level="1">Provider Schema Data</heading><p id="p-0034" num="0032">Provider schema data <b>110</b> includes schema data that defines what attributes can and cannot be part of configuration. Provider schema data <b>110</b> is used to convert current state data <b>120</b> to an equivalent configuration code. For example, removing corresponding &#x201c;&#x2018;computed&#x2019;: &#x2018;true&#x2019;&#x201d; fields in provider schema data <b>110</b> from current state data <b>120</b> is part of the conversion from the current state to configuration code. Once this step is completed, the result is a full representation of everything that is deployed in real/actual infrastructure in JSON form.</p><p id="p-0035" num="0033">Different cloud providers have different schemas. Thus, provider schema data <b>110</b> may contain multiple provider schemas.</p><p id="p-0036" num="0034">For each instance of a provider's schema, provider schema data <b>110</b> contains field types of a resource (e.g., string, Boolean, number) and the schema of the resource (e.g., provider_schemas. registry.terraform.io/hashicorp/azurerm. resource_schemas .azurerm_cosmosdb_account, and whether attributes of the resource cannot be part of the configuration. The following is a portion of an example provider schema:</p><heading id="h-0009" level="1">Current State Data</heading><p id="p-0037" num="0035">Current state data <b>120</b> is configuration code that reflects the current state of an enterprise's infrastructure in a format recognizable to the cloud provider that implements the enterprise's infrastructure. Thus, current state data <b>120</b> conforms to a schema of that cloud provider. As described herein, different cloud providers have different configuration code schemas.</p><p id="p-0038" num="0036">An example of current state data <b>120</b> is as follows:</p><p id="p-0039" num="0000"><tables id="TABLE-US-00002" num="00002"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="280pt" align="center"/><thead><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row><row><entry>Current State</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="280pt" align="left"/><tbody valign="top"><row><entry>&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x201c;format_version&#x201d;: &#x201c;0.1&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x201c;terraform_version&#x201d;: &#x201c;0.14.5&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x201c;values&#x201d;: {</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x201c;root_module&#x201d;: {</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;resources&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;address&#x201d;: &#x201c;azurerm_cosmosdb_account.tfaas_db&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;mode&#x201d;: &#x201c;managed&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;type&#x201d;: &#x201c;azurerm_cosmosdb_account&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;name&#x201d;: &#x201c;tfaas_db&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;provider_name&#x201d;: &#x201c;registry.terraform.io/hashicorp/azurerm&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;schema_version&#x201d;: 0,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;values&#x201d;: {</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;capabilities&#x201d;: [ ],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;connection_strings&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;AccountEndpoint=https://cosmosdb-dev-tfaas-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;********* documents.azure.com:443/;AccountKey=****;;&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;AccountEndpoint=https://cosmosdb-dev-tfaas-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;*********documents.azure.com:443/;AccountKey=****;&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;AccountEndpoint=https://cosmosdb-dev-tfaas-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;*********documents.azure.com:443/;AccountKey=****;&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;AccountEndpoint=https://cosmosdb-dev-tfaas-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;*********documents.azure.com:443/;AccountKey=****;&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;consistency_policy&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;consistency_level&#x201d;: &#x201c;BoundedStaleness&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;max_interval_in_seconds&#x201d;: 300,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;max_staleness_prefix&#x201d;: 100000</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;enable_automatic_failover&#x201d;: true,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;enable_multiple_write_locations&#x201d;: false,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;endpoint&#x201d;: &#x201c;https://cosmosdb-dev-tfaas-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;*********.documents.azure.com:443/&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;geo_location&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;failover_priority&#x201d;: 0,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;id&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********-southcentralus&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;location&#x201d;: &#x201c;southcentralus&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;prefix&#x201d;: &#x201c;&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;},</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;failover_priority&#x201d;: 1,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;id&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********-eastus&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;location&#x201d;: &#x201c;eastus&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;prefix&#x201d;: &#x201c;&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;id&#x201d;: &#x201c;/subscriptions/*************************/resourceGroups/rg-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;dev-tfaas-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;1/providers/Microsoft.DocumentDB/databaseAccounts/cosmosdb-dev-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;tfaas-*********&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;ip_range_filter&#x201d;:</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;is_virtual_network_filter_enabled&#x201d;: false,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;kind&#x201d;: &#x201c;GlobalDocumentDB&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;location&#x201d;: &#x201c;southcentralus&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;name&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;offer_type&#x201d;: &#x201c;Standard&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;primary_master_key&#x201d;: &#x201c;****&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;primary_readonly_master_key&#x201d;: &#x201c;****&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;read_endpoints&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;https ://cosmosdb-dev-tfaas-*********-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;southcentralus.documents.azure.com:443/&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;https ://cosmosdb-dev-tfaas-*********-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;eastus.documents.azure.com:443/&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;resource_group_name&#x201d;: &#x201c;rg-dev-tfaas-1&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;secondary_master_key&#x201d;: &#x201c;*****&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;secondary_readonly_master_key&#x201d;: &#x201c;****&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;tags&#x201d;: { },</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;timeouts&#x201d;: {</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;create&#x201d;: null,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;delete&#x201d;: null,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;read&#x201d;: null,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;update&#x201d;: null</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;},</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;virtual_network_rule&#x201d;: [ ],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;write_endpoints&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;https ://cosmosdb-dev-tfaas-*********-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;southcentralus.documents.azure.com:443/&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;},</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;address&#x201d;: &#x201c;azurerm_private_endpoint.db_endpoint&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;mode&#x201d;: &#x201c;managed&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;type&#x201d;: &#x201c;azurerm_private_endpoint&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;name&#x201d;: &#x201c;db_endpoint&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;provider_name&#x201d;: &#x201c;registry.terraform.io/hashicorp/azurerm&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;schema_version&#x201d;: 0,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;values&#x201d;: {</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;custom_dns_configs&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;fqdn&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********documents.azure.com&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;ip_addresses&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;***.***.***&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;},</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;fqdn&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********-</entry></row><row><entry>southcentralus.documents.azure.com&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;ip_addresses&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;***.***.***&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;},</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;fqdn&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********-eastus.documents.azure.com&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;ip_addresses&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;***.***.***&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;id&#x201d;: &#x201c;/subscriptions/*************************/resourceGroups/rg-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;dev-tfaas-1/providers/Microsoft.Network/privateEndpoints/cosmosdb-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;dev-tfaas-*********-eastus-pe&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;location&#x201d;: &#x201c;eastus&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;name&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********-eastus-pe&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;private_dns_zone_configs&#x201d;: [ ],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;private_dns_zone_group&#x201d;: [ ],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;private_service_connection&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;is_manual_connection&#x201d;: false,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;name&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********-pe&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;private_connection_resource_id&#x201d;: &#x201c;/subscriptions/*****************</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;********/resourceGroups/rg-dev-tfaas-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;1/providers/Microsoft.DocumentDB/databaseAccounts/cosmosdb-dev-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;tfaas-*********&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;private_ip_address&#x201d;: &#x201c;***.***.***&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;request_message&#x201d;:</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;subresource_names&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;Sql&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;resource_group_name&#x201d;: &#x201c;rg-dev-tfaas-1&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;subnet_id&#x201d;: &#x201c;/subscriptions/*************************/resourceGrou</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;ps/arp-lnkdprod-eastus-vnet-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;29/providers/Microsoft.Network/virtualNetworks/vnet3/subnets/subnet479</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;842&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;tags&#x201d;: { },</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;timeouts&#x201d;: {</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;create&#x201d;: null,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;delete&#x201d;: null,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;read&#x201d;: null,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;update&#x201d;: null</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;},</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;address&#x201d;: &#x201c;azurerm_private_endpoint.db_endpoint_southcentral&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;mode&#x201d;: &#x201c;managed&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;type&#x201d;: &#x201c;azurerm_private_endpoint&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;name&#x201d;: &#x201c;db_endpoint_southcentral&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;provider_name&#x201d;: &#x201c;registry.terraform.io/hashicorp/azurerm&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;schema_version&#x201d;: 0,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;values&#x201d;: {</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;custom_dns_configs&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;fqdn&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********.documents.azure.com&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;ip_addresses&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;***.***.***&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;},</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;fqdn&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;southcentralus.documents.azure.com&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;ip_addresses&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;***.***.***&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;},</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;fqdn&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********-eastus.documents.azure.com&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;ip_addresses&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;***.***.***&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;id&#x201d;: &#x201c;/subscriptions/*************************/resourceGroups/rg-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;dev-tfaas-1/providers/Microsoft.Network/privateEndpoints/cosmosdb-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;dev-tfaas-*********-southcentralus-pe&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;location&#x201d;: &#x201c;southcentralus&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;name&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********-southcentralus-pe&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;private_dns_zone_configs&#x201d;: [ ],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;private_dns_zone_group&#x201d;: [ ],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;private_service_connection&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;{</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;is_manual_connection&#x201d;: false,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;name&#x201d;: &#x201c;cosmosdb-dev-tfaas-*********-pe&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;private_connection_resource_id&#x201d;: &#x201c;/subscriptions/*****************</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;********/resourceGroups/rg_dev_tfaas-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;1/providers/Microsoft.DocumentDB/databaseAccounts/cosmosdb-dev-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;tfaas-*********&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;private_ip_address&#x201d;: &#x201c;***.***.***&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;request_message&#x201d;:</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;subresource_names&#x201d;: [</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;Sql&#x201d;</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;],</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;resource_group_name&#x201d;: &#x201c;rg-dev-tfaas-1&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;subnet_id&#x201d;: &#x201c;/subscriptions/*************************/resourceGrou</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;ps/scus-ei-lid-network-</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;rg/providers/Microsoft.Network/virtualNetworks/eiLidAppVnet/subnets/A</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;pp4Subnet&#x201d;,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;tags&#x201d;: { },</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;timeouts&#x201d;: {</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;create&#x201d;: null,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;delete&#x201d;: null,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;read&#x201d;: null,</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x201c;update&#x201d;: null</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;&#x2003;}</entry></row><row><entry>&#x2003;}</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0040" num="0037">Because resources can be grouped by containers called modules, current state data <b>120</b> organizes resources by modules in a certain format, such as JSON.</p><p id="p-0041" num="0038">Current state data <b>120</b> may comprise multiple current states, each describing the current state of different cloud infrastructure, which may or may not be of a different enterprise. Current state data of a cloud infrastructure may indicate the provider schema to which the current state data conforms. This information assists state generator <b>142</b> in identifying the correct provider schema data given the current state data.</p><heading id="h-0010" level="1">State Generation</heading><p id="p-0042" num="0039">In order to generate updated IAC <b>160</b>, remediation engine <b>140</b> needs to know the state of the deployed infrastructure. State generator <b>142</b> generates this state, referred to herein as deployed state data <b>144</b>. State generator <b>142</b> takes two sets of data as inputs in order to generate deployed state data <b>144</b>: provider schema data <b>110</b> and current state data <b>120</b>. An example of deployed state data <b>144</b> is as follows:</p><p id="p-0043" num="0000"><tables id="TABLE-US-00003" num="00003"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="259pt" align="left"/><thead><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>API server listening at: 127.0.0.1:4961</entry></row><row><entry>&#x26; {Modules:map[:0xc00090b340]}</entry></row><row><entry>container</entry></row><row><entry>&#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Container&#x3e;(0xc00059ee68)</entry></row><row><entry>&#x3c;golang.linkedin.com/ligo-terraform-dsl/terraformdsl/state.Container&#x3e;</entry></row><row><entry>Modules: &#x3c;map[string]*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Module&#x3e; (length: 1)</entry></row><row><entry>&#x201c;&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Module&#x3e;(0xc00090b340)</entry></row><row><entry>&#x3c;golang.linkedin.com/ligo-terraform-dsl/terraformdsl/state.Module&#x3e;</entry></row><row><entry>Addr: nil &#x3c;github.com/hashicorp/terraform/addrs.ModuleInstance&#x3e;</entry></row><row><entry>Resources: &#x3c;map[string]*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Resource&#x3e; (length: 3)</entry></row><row><entry>&#x201c;azurerm_cosmosdb_account.tfaas_db&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Resource&#x3e;(0xc0001e8000)</entry></row><row><entry>&#x3c;golang.linkedin.com/ligo-terraform-dsl/terraformdsl/state.Resource&#x3e;</entry></row><row><entry>Addr: &#x3c;github.com/hashicorp/terraform/addrs.AbsResource&#x3e;</entry></row><row><entry>targetable: &#x3c;github.com/hashicorp/terraform/addrs.targetable&#x3e;</entry></row><row><entry>Module: nil &#x3c;github.com/hashicorp/terraform/addrs.ModuleInstance&#x3e;</entry></row><row><entry>Resource: &#x3c;github.com/hashicorp/terraform/addrs.Resource&#x3e;</entry></row><row><entry>referenceable: &#x3c;github.com/hashicorp/terraform/addrs.referenceable&#x3e;</entry></row><row><entry>Mode: ManagedResourceMode (77)</entry></row><row><entry>Type: &#x201c;azurerm_cosmosdb_account&#x201d;</entry></row><row><entry>Name: &#x201c;tfaas_db&#x201d;</entry></row><row><entry>ProviderName: &#x201c;registry.terraform.io/hashicorp/azurerm&#x201d;</entry></row><row><entry>DependsOn: nil &#x3c;[ ]github.com/hashicorp/hcl/v2.Traversal&#x3e;</entry></row><row><entry>Instances:</entry></row><row><entry>&#x3c;map[github.com/hashicorp/terraform/addrs.InstanceKey]*golang.linkedin.com/li</entry></row><row><entry>go-terraform-dsl/terraformdsl/state.ResourceInstance&#x3e; (length: 1)</entry></row><row><entry>nil &#x3c;github.com/hashicorp/terraform/addrs.InstanceKey&#x3e;:</entry></row><row><entry>&#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.ResourceInstance&#x3e;(0xc0008f77a0)</entry></row><row><entry>&#x3c;golang.linkedin.com/ligo-terraform-dsl/terraformdsl/state.ResourceInstance&#x3e;</entry></row><row><entry>Block: &#x3c;golang.linkedin.com/ligo-terraform-dsl/terraformdsl/state.Block&#x3e;</entry></row><row><entry>Attributes: &#x3c;map[string]*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e; (length: 19)</entry></row><row><entry>&#x201c;read_endpoints&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026180)</entry></row><row><entry>&#x3c;golang.linkedin.com/ligo-terraform-dsl/terraformdsl/state.Attribute&#x3e;</entry></row><row><entry>Type: &#x3c;github.com/zclconf/go-cty/cty.Type&#x3e;</entry></row><row><entry>Description: &#x201c;&#x201d;</entry></row><row><entry>DescriptionKind: &#x201c;plain&#x201d;</entry></row><row><entry>Required: false</entry></row><row><entry>Optional: false</entry></row><row><entry>Computed: true</entry></row><row><entry>Sensitive: false</entry></row><row><entry>Deprecated: false</entry></row><row><entry>Value: &#x3c;github.com/zclconf/go-cty/cty.Value&#x3e;</entry></row><row><entry>&#x201c;enable_multiple_write_locations&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc0000263c0)</entry></row><row><entry>&#x201c;is_virtual_network_filter_enabled&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc0000264e0)</entry></row><row><entry>&#x201c;location&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026540)</entry></row><row><entry>&#x201c;secondary_readonly_master_key&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc0000266c0)</entry></row><row><entry>&#x201c;connection_strings&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026060)</entry></row><row><entry>&#x201c;kind&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc0000260c0)</entry></row><row><entry>&#x201c;offer_type&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026120)</entry></row><row><entry>&#x201c;write_endpoints&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc0000261e0)</entry></row><row><entry>&#x201c;endpoint&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026420)</entry></row><row><entry>&#x201c;name&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc0000265a0)</entry></row><row><entry>&#x201c;secondary_master_key&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026600)</entry></row><row><entry>&#x201c;tags&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026720)</entry></row><row><entry>&#x201c;ip_range_filter&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026240)</entry></row><row><entry>&#x201c;primary_master_key&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc0000262a0)</entry></row><row><entry>&#x201c;primary_readonly_master_key&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026300)</entry></row><row><entry>&#x201c;enable_automatic_failover&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026360)</entry></row><row><entry>&#x201c;id&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026480)</entry></row><row><entry>&#x201c;resource_group_name&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026660)</entry></row><row><entry>BlockTypes: &#x3c;map[string]*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.NestedBlock&#x3e; (length: 5)</entry></row><row><entry>&#x201c;geo_location&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.NestedBlock&#x3e;(0xc00090b480)</entry></row><row><entry>&#x201c;timeouts&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.NestedBlock&#x3e;(0xc00090b4c0)</entry></row><row><entry>&#x201c;virtual_network_rule&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.NestedBlock&#x3e;(0xc00090b500)</entry></row><row><entry>&#x201c;capabilities&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.NestedBlock&#x3e;(0xc00090b540)</entry></row><row><entry>&#x201c;consistency_policy&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.NestedBlock&#x3e;(0xc00090b580)</entry></row><row><entry>Description: &#x201c;&#x201d;</entry></row><row><entry>Deprecated: false</entry></row><row><entry>&#x201c;azurerm_private_endpoint.db_endpoint&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Resource&#x3e;(0xc0001e8070)</entry></row><row><entry>&#x3c;golang.linkedin.com/ligo-terraform-dsl/terraformdsl/state.Resource&#x3e;</entry></row><row><entry>Addr: &#x3c;github.com/hashicorp/terraform/addrs.AbsResource&#x3e;</entry></row><row><entry>targetable: &#x3c;github.com/hashicorp/terraform/addrs.targetable&#x3e;</entry></row><row><entry>Module: nil &#x3c;github.com/hashicorp/terraform/addrs.ModuleInstance&#x3e;</entry></row><row><entry>Re source: &#x3c;github.com/hashicorp/terraform/addrs.Resource&#x3e;</entry></row><row><entry>referenceable: &#x3c;github.com/hashicorp/terraform/addrs.referenceable&#x3e;</entry></row><row><entry>Mode: ManagedResourceMode (77)</entry></row><row><entry>Type: &#x201c;azurerm_private_endpoint&#x201d;</entry></row><row><entry>Name: &#x201c;db_endpoint&#x201d;</entry></row><row><entry>ProviderName: &#x201c;registry.terraform.io/hashicorp/azurerm&#x201d;</entry></row><row><entry>DependsOn: nil &#x3c;[ ]github.com/hashicorp/hcl/v2.Traversal&#x3e;</entry></row><row><entry>Instances:</entry></row><row><entry>&#x3c;map[github.com/hashicorp/terraform/addrs.InstanceKey]*golang.linkedin.com/li</entry></row><row><entry>go-terraform-dsl/terraformdsl/state.ResourceInstance&#x3e; (length: 1)</entry></row><row><entry>nil &#x3c;github.com/hashicorp/terraform/addrs.InstanceKey&#x3e;:</entry></row><row><entry>&#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.ResourceInstance&#x3e;(0xc0008f7b90)</entry></row><row><entry>&#x3c;golang.linkedin.com/ligo-terraform-dsl/terraformdsl/state.ResourceInstance&#x3e;</entry></row><row><entry>Block: &#x3c;golang.linkedin.com/ligo-terraform-dsl/terraformdsl/state.Block&#x3e;</entry></row><row><entry>Attributes: &#x3c;map[string]*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e; (length: 8)</entry></row><row><entry>&#x201c;name&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026d20)</entry></row><row><entry>&#x201c;private_dns_zone_configs&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026d80)</entry></row><row><entry>&#x201c;resource_group_name&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026de0)</entry></row><row><entry>&#x201c;subnet_id&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026e40)</entry></row><row><entry>&#x201c;tags&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026ea0)</entry></row><row><entry>&#x201c;custom_dns configs&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026f00)</entry></row><row><entry>&#x201c;id&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026f60)</entry></row><row><entry>&#x201c;location&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Attribute&#x3e;(0xc000026fc0)</entry></row><row><entry>BlockTypes: &#x3c;map[string]*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.NestedBlock&#x3e; (length: 3)</entry></row><row><entry>&#x201c;private_dns_zone_group&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.NestedBlock&#x3e;(0xc00090b600)</entry></row><row><entry>&#x201c;private_service_connection&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.NestedBlock&#x3e;(0xc00090b640)</entry></row><row><entry>&#x201c;timeouts&#x201d;: &#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.NestedBlock&#x3e;(0xc00090b680)</entry></row><row><entry>Description: &#x201c;&#x201c;</entry></row><row><entry>Deprecated: false</entry></row><row><entry>&#x201c;azurerm_private_endpoint.db_endpoint_southcentral&#x201d;:</entry></row><row><entry>&#x3c;*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Resource&#x3e;(0xc0001e80e0)</entry></row><row><entry>&#x3c;golang.linkedin.com/ligo-terraform-dsl/terraformdsl/state.Resource&#x3e;</entry></row><row><entry>Addr: &#x3c;github.com/hashicorp/terraform/addrs.AbsResource&#x3e;</entry></row><row><entry>targetable: &#x3c;github.com/hashicorp/terraform/addrs.targetable&#x3e;</entry></row><row><entry>Module: nil &#x3c;github.com/hashicorp/terraform/addrs.ModuleInstance&#x3e;</entry></row><row><entry>Resource: &#x3c;github.com/hashicorp/terraform/addrs.Resource&#x3e;</entry></row><row><entry>referenceable: &#x3c;github.com/hashicorp/terraform/addrs.referenceable&#x3e;</entry></row><row><entry>Mode: ManagedResourceMode (77)</entry></row><row><entry>Type: &#x201c;azurerm_private_endpoint&#x201d;</entry></row><row><entry>Name: &#x201c;db_endpoint_southcentral&#x201d;</entry></row><row><entry>ProviderName: &#x201c;registry.terraform.io/hashicorp/azurerm&#x201d;</entry></row><row><entry>DependsOn: nil &#x3c;[ ]github.com/hashicorp/hcl/v2.Traversal&#x3e;</entry></row><row><entry>Instances:</entry></row><row><entry>&#x3c;map[github.com/hashicorp/terraform/addrs.InstanceKey]*golang.linkedin.com/li</entry></row><row><entry>go-terraform-dsl/terraformdsl/state.ResourceInstance&#x3e; (length: 1)</entry></row><row><entry>ChildModules: nil &#x3c;map[string]*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.Module&#x3e;</entry></row><row><entry>InputValues: nil &#x3c;map[string]*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.InputValue&#x3e;</entry></row><row><entry>OutputValues: nil &#x3c;map[string]*golang.linkedin.com/ligo-terraform-</entry></row><row><entry>dsl/terraformdsl/state.OutputValue&#x3e;</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0044" num="0040">With information from provider schema data <b>110</b> (such as field type and structure), state generator <b>142</b> generates equivalent data structures from current state data <b>120</b> using a statically typed language, such as Golang.</p><p id="p-0045" num="0041">Because resources can be grouped by modules, state generator <b>142</b> groups resources by module within a data structure (e.g., Golang struct) so that every single resource in the deployed state data in <b>144</b> can be properly mapped to a globally unique resource identifier in the IAC. This identifier maps to the parent module address plus the resource address per resource (e.g. module.parent1.module.parent2.azurerm_cosmosdb_account.some_db), allowing for the matching resource block in the IAC to serve as the starting evaluation point.</p><p id="p-0046" num="0042">The data structures (e.g., Golang structs) may be viewed as three layers of nodes: a (1) top-level container node that contains several (2) module nodes, which contain (3) resource nodes.</p><heading id="h-0011" level="1">Graph Generation</heading><p id="p-0047" num="0043">Graph generator <b>146</b> generates configuration graph <b>148</b>, which is a graph representation of IAC <b>130</b>. A purpose of configuration graph <b>148</b> is so that claims propagator <b>150</b> can traverse the graph and determine where configuration code edits should be made. Current IAC evaluators, such as Terraform, do not provide a way to propagate state information backwards to the source (i.e., from the deployed state to IAC).</p><p id="p-0048" num="0044">Configuration graph <b>148</b> comprises nodes and edges. A node represents a block in IAC <b>130</b>. A node may one of multiple types, each corresponding to one of the block types in the configuration code language (e.g., HCL or JSON). Thus, examples of node types include a module node, a resource node, a data node, and a local node. A module node represents a module or container of child resources, examples of which include a resource, a data source, and a local variable. Thus, a module node may &#x201c;contain&#x201d; or otherwise be associated with one or more resource nodes, one or more data nodes, and/or one or more local nodes. A module node is also associated with (1) an input node representing inputs to the corresponding module and (2) an output node representing an output of the corresponding module.</p><p id="p-0049" num="0045">Configuration graph <b>148</b> includes a module node as a root node. Each other module node in configuration graph <b>148</b> is a child node of another module node and has an edge to its parent module node.</p><p id="p-0050" num="0046">Some nodes in connection graph <b>148</b> have edges connecting them. A first node in configuration graph <b>148</b> has a directed edge pointing to a second node if the second node references the first node. Each edge corresponds to a different attribute.</p><heading id="h-0012" level="1">Example Configuration Graph</heading><p id="p-0051" num="0047"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a block diagram that depicts an example configuration graph <b>200</b> that is generated based on an IAC, in an embodiment. Configuration graph <b>200</b> is an example of configuration graph <b>148</b> and may have been generated by graph generator <b>146</b>.</p><p id="p-0052" num="0048">Configuration graph <b>200</b> includes a root node <b>210</b>, a child module (M1) node <b>230</b>, a child module (M2) node <b>250</b>, and a remote module (M3) node <b>270</b>. Root node <b>210</b> comprises a resource node <b>212</b>, a local node <b>214</b>, a data source node <b>216</b>, and a module node <b>218</b>.</p><p id="p-0053" num="0049">M1 node <b>230</b> comprises a resource node <b>232</b>, a local node <b>234</b>, a module node <b>236</b>, and a module node <b>238</b>. M1 node <b>230</b> is also associated with an M1 input node <b>240</b> and an M1 output node <b>242</b>. Input nodes and output nodes correspond to single block attributes and, respectively, to input variables and output variables. Examples of input variables from an IAC are the following:</p><p id="p-0054" num="0000"><tables id="TABLE-US-00004" num="00004"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="offset" colwidth="14pt" align="left"/><colspec colname="1" colwidth="203pt" align="left"/><thead><row><entry/><entry namest="offset" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/><entry>variable &#x201c;uss_azure_url&#x201d; {</entry></row><row><entry/><entry>&#x2003;description = &#x201c;USS Azure URL&#x201d;</entry></row><row><entry/><entry>&#x2003;default = &#x201c;https://lb-uss-azure.lit-zeus-1.linkedin.com: 10957&#x201d;</entry></row><row><entry/><entry>}</entry></row><row><entry/><entry>variable &#x201c;uss_azure_debug&#x201d; {</entry></row><row><entry/><entry>&#x2003;description = &#x201c;USS Azure debug setting&#x201d;</entry></row><row><entry/><entry>&#x2003;default = true</entry></row><row><entry/><entry>}</entry></row><row><entry/><entry>variable &#x201c;fabric&#x201d; {</entry></row><row><entry/><entry>&#x2003;description = &#x201c;Fabric where the application is deployed.&#x201d;</entry></row><row><entry/><entry>}</entry></row><row><entry/><entry namest="offset" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup></table></tables><br/>Examples of output variables from an IAC are the following:</p><p id="p-0055" num="0000"><tables id="TABLE-US-00005" num="00005"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="217pt" align="left"/><thead><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>output &#x201c;tfaas-resource-group-name&#x201d; {</entry></row><row><entry>&#x2003;value = azurerm_resource_group.tfaas.name</entry></row><row><entry>&#x2003;description = &#x201c;Name of the resource group where all the resources are</entry></row><row><entry>&#x2003;created&#x201d;</entry></row><row><entry>}</entry></row><row><entry>output &#x201c;tfaas-kms-root&#x201d; {</entry></row><row><entry>&#x2003;value = module.tfaas-kms-root.name</entry></row><row><entry>}</entry></row><row><entry>output &#x201c;cosmos-account-name&#x201d; {</entry></row><row><entry>&#x2003;value = module.tfaas-cosmosdb.account_name</entry></row><row><entry>&#x2003;description = &#x201c;Name of the cosmos db account&#x201d;</entry></row><row><entry>}</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0056" num="0050">M2 node <b>250</b> comprises a resource node <b>252</b>, a local node <b>254</b>, a module node <b>256</b>, and a module node <b>258</b>. M2 node <b>250</b> is also associated with an M2 input node <b>260</b> and an M2 output node <b>262</b>.</p><p id="p-0057" num="0051">M3 node <b>270</b> comprises a resource node <b>272</b>, a local node <b>274</b>, a resource node <b>276</b>, and a resource node <b>278</b>. M3 node <b>270</b> is also associated with an M3 input node <b>280</b> and an M3 output node <b>282</b>.</p><p id="p-0058" num="0052">Configuration graph <b>200</b> also has a number of edges. Edge <b>220</b> indicates that resource node <b>212</b> is referenced by local node <b>214</b>, edge <b>222</b> indicates that resource node <b>212</b> is also referenced by output node <b>242</b>, and edge <b>224</b> indicates that resource node <b>212</b> is also referenced by data source node <b>216</b>.</p><p id="p-0059" num="0053">Similarly, edge <b>244</b> indicates that input node <b>240</b> is referenced by module node <b>218</b>, edge <b>246</b> indicates that M1 node <b>230</b> is referenced by M1 input node <b>240</b>, edge <b>248</b> indicates that output node <b>242</b> is referenced by M1 node <b>230</b>, and edge <b>249</b> indicates that module node <b>238</b> is referenced by M2 output node <b>262</b>.</p><p id="p-0060" num="0054">Similarly, edge <b>264</b> indicates that module node <b>236</b> is referenced by M2 input node <b>260</b>, edge <b>266</b> indicates that M2 input node <b>260</b> is referenced by M2 node <b>250</b>, edge <b>268</b> indicates that M2 input node <b>260</b> is also referenced by resource node <b>252</b>, and edge <b>269</b> indicates that M2 node <b>250</b> is referenced by M2 output node <b>262</b>.</p><p id="p-0061" num="0055">Similarly, edge <b>284</b> indicates that module node <b>238</b> is referenced by M3 input node <b>280</b>, edge <b>286</b> indicates that M3 input node <b>268</b> is referenced by M3 node <b>270</b>, and edge <b>288</b> indicates that M3 node <b>270</b> is referenced by M3 output node <b>282</b>.</p><p id="p-0062" num="0056">With configuration graph <b>200</b> (or configuration graph <b>148</b>), state propagation across modules, resources, and expressions is made possible. Configuration graph <b>200</b> allows for the translation from (a) evaluated resource values of tracked cloud instances to (2) code edits in (e.g., Terraform) configuration code. Claims propagation and claims resolution details a methodology through which evaluated resource values of tracked cloud instances are mapped to configuration code edits. After claims propagation, a single attribute of a node in configuration graph <b>200</b> may be associated with multiple claims. Claims resolution for that node is the process of selecting one of those claims, as described in more detail herein.</p><heading id="h-0013" level="1">Claims Propagator</heading><p id="p-0063" num="0057">Claims propagator <b>150</b> takes configuration graph <b>148</b> and deployed state data <b>144</b> as input and updates configuration graph <b>148</b> with one or more claims. A claim is a proposed edit, or a temporary assignment of an attribute value from deployed state data <b>144</b> to an attribute of a node in configuration graph <b>148</b>. After claims propagator <b>150</b> generates all claims, some attributes of nodes in configuration graph <b>148</b> may be associated with multiple claims. A purpose of claim propagation is to propagate any attribute value (from the deployed state) that differs from what the resource configuration specifies (or cannot be determined) as far up configuration graph <b>148</b> as possible. This is because IAC (e.g., Terraform code) is structured in terms of modules and, during standard evaluation of Terraform code, user-configurable values are at the source (or at or near the root) of configuration graph <b>148</b>. As a specific example, inputs to IAC <b>130</b> are defined in &#x2018;tfvars&#x2019; or &#x2018;tfvars.json&#x2019; files and the user may define multiple modules (or file system directories) containing multiple nodes (terraform configuration files). Thus, during the drift remediation phase, it is important to &#x201c;de-evaluate&#x201d; or make sure any values which have deviated from the IAC are propagated, whenever possible, closer to where &#x2018;tfvars&#x2019; file are defined or as upward toward the parent module when possible. This path of propagation is determined based on configuration graph <b>148</b>. Enterprise users intend to set configurable inputs as close to where tfvars files are defined as possible. A policy is to propagate an attribute value (from the deployed state) based on whether the attribute value (in the matching node in configuration graph <b>148</b>) is a reference to another node's attribute or is a primitive value itself. A claim pertaining to a reference is always propagated (since the node that is pointed to by the reference is closer to the user input), while a primitive value is not propagated (since there is no clear higher reference). For example, if M3 node <b>270</b> is a matching node in configuration graph <b>200</b> (i.e., it matches a selected resource from deployed state data <b>144</b>) and an attribute value of a particular attribute in M3 node <b>270</b> is a reference, then edge <b>286</b> is followed to input variable <b>280</b>, and then edge <b>284</b> is followed to module node <b>238</b>. If the module node <b>238</b> includes the particular attribute and its value is a primitive value, then a claim is made on the particular attribute of module node <b>238</b>. If the particular attribute's value is instead a reference, then edges <b>249</b> and <b>269</b> are followed to M2 node <b>250</b> and the primitive value/reference check is made again.</p><p id="p-0064" num="0058"><figref idref="DRAWINGS">FIGS. <b>3</b>A-<b>3</b>B</figref> is a flow diagram that depicts an example process <b>300</b> for propagating claims in a configuration graph, in an embodiment. Process <b>300</b> may be performed by claims propagator <b>150</b> and/or other components of remediation engine <b>140</b>.</p><p id="p-0065" num="0059">At block <b>310</b>, a resource indicated in deployed state data <b>144</b> is selected. The selection in block <b>310</b> may be random or may be performed by selecting resources in a particular order, such as selecting the first resource indicated in deployed state data <b>144</b> that has not already been selected.</p><p id="p-0066" num="0060">At block <b>320</b>, it is determined whether a resource name of the selected resource matches a resource name/identifier (also referred to as a &#x201c;resource address&#x201d;) of a resource indicated in configuration graph <b>148</b>. If not, then process <b>300</b> proceeds to block <b>330</b>. (In this case, it is presumed that the selected resource is new or was added after IAC <b>130</b> was created.) Otherwise, process <b>300</b> proceeds to block <b>340</b>.</p><p id="p-0067" num="0061">Block <b>320</b> may involve comparing the resource name of the selected resource to each resource name indicated in each node of configuration graph <b>148</b> until a match is found. The search for a matching node in configuration graph <b>148</b> may proceed until all nodes (of configuration graph <b>148</b>) that have not already been matched have been considered. Once a matching node is found, the search of configuration graph <b>148</b> based on the selected resource ends. A matching node will be a leaf node in configuration graph <b>148</b>.</p><p id="p-0068" num="0062">The order in which the nodes of configuration graph <b>148</b> are searched in block <b>320</b> may be random or may start with the root node, or the highest level node (in configuration graph <b>148</b>) that has not yet been matched and then proceed to lower level nodes.</p><p id="p-0069" num="0063">At block <b>330</b>, configuration graph <b>148</b> is updated to include a new node that corresponds to the selected resource. The new node includes attribute names and values indicated in the selected resource from deployed state data <b>144</b>. A parent resource of the selected resource is determined and matched to a node in configuration graph <b>148</b>. The new node becomes a child node of that node. Process <b>300</b> proceeds to block <b>360</b>.</p><p id="p-0070" num="0064">At block <b>340</b>, it is determined whether a first set of attributes of the selected resource match a second set of attributes of the matched node in configuration graph <b>148</b>. For example, the first set of attributes may be more or less than the second set of attributes. As another example, one of the attributes in the first set of attributes might not exist in the second set of attributes, and/or vice versa. If the two sets of attributes do not match, then process <b>300</b> proceeds to block <b>350</b>; otherwise, process <b>300</b> proceeds to block <b>360</b>. Block <b>340</b> may also involve marking the matched node to indicate that there was a match, or otherwise storing data that identifies the matched node as being part of a match. This data is used later in block <b>370</b> to determine whether there were any nodes that did not experience any match to a resource in deployed state data <b>144</b>.</p><p id="p-0071" num="0065">At block <b>350</b>, the matched node in configuration graph <b>148</b> is updated to include the first set of attributes. For example, one of the attributes in the second set of attributes is deleted and/or an attribute is added to the second set of attributes. Process <b>300</b> then proceeds to block <b>360</b>.</p><p id="p-0072" num="0066">At block <b>360</b>, it is determined whether there are any more resources that have not yet been selected from deployed state data <b>144</b>. If so, then process <b>300</b> returns to block <b>310</b>. Otherwise, process <b>300</b> proceeds to block <b>365</b>, which begins a trimming phase that involves blocks <b>365</b> and <b>370</b>.</p><p id="p-0073" num="0067">At block <b>365</b>, it is determined whether there are any nodes in configuration graph <b>148</b> that have not been matched to a resource from deployed state data <b>144</b>. If so, then process <b>300</b> proceeds to block <b>370</b>; otherwise, process <b>300</b> proceeds to block <b>380</b>. Block <b>365</b> may involve checking each node in configuration graph <b>148</b> to determine whether it is associated with match data that indicates that a resource from deployed state data <b>144</b> matched to that node.</p><p id="p-0074" num="0068">At block <b>370</b>, the identified nodes in block <b>365</b> are deleted from configuration graph <b>148</b>. After the trimming phase, process <b>300</b> enters the claim generation phase, comprising blocks <b>375</b>-<b>395</b>.</p><p id="p-0075" num="0069">At block <b>375</b>, a matched node in configuration graph <b>148</b> is selected.</p><p id="p-0076" num="0070">At block <b>380</b>, for each attribute in the matched node that corresponds to a resource from deployed state, it is determined whether the attribute value of that attribute (of the matched node) is a reference or a primitive value. Examples of primitive values include a specific string, a specific integer, or a specific Boolean value. In fact, in JSON, the only attribute values are Strings, Booleans, and Integers. The matched node in configuration graph <b>148</b> indicates whether the attribute is a reference or a primitive value. If the attribute is a primitive value, then process <b>300</b> proceeds to block <b>385</b>; otherwise, process <b>300</b> proceeds to block <b>390</b>.</p><p id="p-0077" num="0071">At block <b>385</b>, a claim of the attribute value from the selected resource is made with the matched node. In other words, the attribute value from the selected resource is associated with (at least temporarily) with the matched node. A claim may also comprise an identifier of the matched node.</p><p id="p-0078" num="0072">At block <b>390</b>, one or more ancestor nodes of the matched node in configuration graph <b>148</b> are traversed to identify an ancestor node whose corresponding block has the attribute and that attribute is assigned a primitive value. Block <b>390</b> results in creating a claim to that ancestor node. In other words, the attribute value from the selected resource is associated with that ancestor node. The claim comprises an identifier of the matched node, an identifier of the ancestor node, and a path identifying any nodes that were traversed between the matched node and the ancestor node. Block <b>390</b> is explained in more detail in <figref idref="DRAWINGS">FIG. <b>4</b></figref>.</p><p id="p-0079" num="0073">At block <b>395</b>, it is determined whether there any matched nodes in (configuration graph <b>148</b>) that have not yet been selected in block <b>375</b>. If so, then process <b>300</b> returns to block <b>375</b>; otherwise, process <b>300</b> ends.</p><heading id="h-0014" level="1">Traversing the Configuration Graph</heading><p id="p-0080" num="0074"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flow diagram that depicts an example process <b>400</b> for traversing configuration graph <b>148</b> from a matched node based on a particular attribute that is assigned a reference in the IAC block that corresponds to the matched node, in an embodiment. &#x201c;Traversing&#x201d; refers to following one or more edges and nodes in configuration graph <b>148</b> beginning at a matched node that has been identified based on a selected resource indicated in deployed state data <b>144</b>. The matched node is referred to as the &#x201c;source&#x201d; with respect to the particular attribute. The selected resource is assigned a value for the particular attribute. As noted herein, the purpose of traversing is to identify the highest level node to make a primitive value edit, which involves (1) assigning a primitive value of an attribute of a selected resource to (2) the attribute in a node indicated in configuration graph <b>148</b>, where the node is either the matched node or a node that is higher up the configuration graph <b>148</b> (i.e., toward the root node) than the matched node. Making primitive value edits as high in the configuration graph <b>148</b> as possible makes maintaining IAC <b>130</b>/<b>160</b> more manageable because end-users and automated programs expect to provide inputs for these attributes where those attributes are likely to be defined, i.e., as close to the root node as possible.</p><p id="p-0081" num="0075">At block <b>410</b>, an edge of a current node in the configuration graph <b>148</b> is identified. In the first iteration of block <b>410</b>, the current node is the source, or matched node. In subsequent iterations of block <b>410</b>, the current node is an ancestor node of the source.</p><p id="p-0082" num="0076">The edge points from the current node to another node. Such an edge is referred to as an outgoing edge with respect to the node of block <b>410</b>. In some cases, a node has multiple outgoing edges. For example, resource node <b>212</b> has multiple outgoing edges. Therefore, block <b>410</b> may involve selecting one of multiple outgoing edges.</p><p id="p-0083" num="0077">At block <b>420</b>, an ancestor node is identified based on the edge identified in block <b>410</b>. If the ancestor node is a module input node or a module output node, then an outgoing edge from that node is followed until a non-input/non-output ancestor node is identified.</p><p id="p-0084" num="0078">At block <b>430</b>, it is determined whether the ancestor node has an attribute that matches the particular attribute (in question). If so, then process <b>400</b> proceeds to block <b>440</b>. Otherwise, process <b>400</b> proceeds to block <b>470</b>.</p><p id="p-0085" num="0079">At block <b>440</b>, an identifier of the ancestor node is recorded in path data that indicates the path of nodes (beginning with the source) that are traversed based on the particular attribute and a corresponding selected resource from the deployed state that triggered the present traversal.</p><p id="p-0086" num="0080">At block <b>450</b>, it is determined whether the value of attribute of the ancestor node is a reference. If not, then process <b>400</b> proceeds to block <b>460</b>. Otherwise, process <b>400</b> proceeds to block <b>470</b>, where the ancestor node becomes the current node.</p><p id="p-0087" num="0081">At block <b>460</b>, a claim is created to the ancestor node. In other words, the attribute value from the selected resource is temporarily associated with that ancestor node. The claim also indicates the name of the attribute, an identifier of the source, an identifier of the ancestor node, and the path data. The ancestor node is referred to as the &#x201c;sink.&#x201d;</p><p id="p-0088" num="0082">For example, a selected resource matches a configuration node that corresponds to resource node <b>252</b>. If the resource of resource node <b>252</b> includes an attribute that is assigned to a reference, then edge <b>268</b> is followed to M2 input node <b>260</b> and (as long as M2 input node <b>260</b> does not have a definition for the attribute) edge <b>266</b> is followed to module node <b>236</b>. If module node <b>236</b> includes the attribute, then it is determined whether the attribute is assigned a reference or a primitive value. If the former, then the edges are followed and this traversal process is repeated; if the latter, then module node <b>236</b> is temporarily associated with the corresponding attribute value from the selected resource.</p><p id="p-0089" num="0083">At block <b>470</b>, the current node becomes the ancestor node. Then, when process <b>400</b> returns to block <b>410</b>, an edge of the ancestor node will be identified.</p><heading id="h-0015" level="1">Claims Resolution</heading><p id="p-0090" num="0084">After each resource in deployed state data <b>144</b> is analyzed, one or more nodes in configuration graph <b>148</b> may include multiple claims pertaining to the same attribute. For example, module node <b>218</b> may include multiple claims, each corresponding to the same attribute. As a specific example, the configuration block in IAC <b>130</b> may include an attribute whose name is &#x201c;count&#x201d; and different claims pertaining to a value for the count attribute.</p><p id="p-0091" num="0085">Claim resolution begins with leaf nodes (e.g., resource nodes) and propagate upward toward the root module node. Claims resolver <b>152</b> selects a node in configuration graph <b>148</b> and determines whether the node is associated with multiple claims pertaining to the same attribute. If so, then claims resolver <b>152</b> considers one or more factors to select one of the multiple claims for applying to the attribute of the node. &#x201c;Applying a claim to a node&#x201d; involves updating the node to assign the value of the claim to the corresponding attribute of the node. If there are multiple factors, then the factors may be hierarchical or prioritized such that the factors are considered in order from highest priority to lowest priority.</p><p id="p-0092" num="0086">A principle of claims resolution is determining which claim is least changeable. For example, a first factor is whether the claim is on the source. In other words, the source and the sink of the claim are the same node. Thus, the claim cannot be propagated upward, or further up configuration graph <b>148</b>. This first factor may be the highest priority factor and, therefore, may be applied first. Any other claims on the attribute are propagated backwards/downwards toward the sources of those claim(s).</p><p id="p-0093" num="0087">A second factor is whether the claim is on a computed attribute. A computed attribute is one where the value is computed server-side rather than being provided as inputs in IAC <b>130</b>. If a claim's value matches the computed attribute's value, then that claim takes the next highest precedence. Otherwise, the claim is invalidated and propagated backward since computed fields are generally read-only.</p><p id="p-0094" num="0088">A third factor is whether the claim is on an attribute that depends on a remote source. A remote source is a source that is not configured in IAC <b>130</b>. For example, the attribute may be a reference to a source that is elsewhere in the cloud or a repository outside the infrastructure. Such a claim is removed (or disassociated) from the attribute and path data of the claim is used to propagate backward (or down towards a leaf node). Thus, the path data is used to identify a preceding node in the claim's path and the claim is associated with that preceding node.</p><p id="p-0095" num="0089">If there are still multiple claims associated with an attribute of a node, then a fourth factor for selecting one of the multiple claims is determining whether any of the multiple claims has a path that is a subpath of a path of another one of the multiple claims. The claim with the subpath will always have precedence; otherwise, the claim with the subpath will not be able to make a reference to a node.</p><p id="p-0096" num="0090">If there are still multiple claims associated with a node, then a fifth factor is selecting the claim that has the shortest path. For example, if (1) claim A has a path whose length is three nodes from the claim's sink to the source of claim A and (2) claim B has a path whose length is five nodes from the claim's sink to the source of claim B, then claim A is applied to the current node. If, after all these factors are considered, there are still multiple claims associated with a node, then one of the claims is randomly selected and the other claim(s) is/are propagated backward down their respective paths.</p><p id="p-0097" num="0091">After applying one or more of these factors to a node with multiple claims, the node will have a single claim. That single claim is applied to the node. All other claims to that node propagate down one node based on their respective paths. The respective paths may be the same or different. For example, node X is a sink for claims A, B, and C. After applying the one or more factors, claim A is applied to node X. Claim B is then assigned to node Y and Claim C is assigned to node Z, where nodes Y and Z are child nodes of node X. Node Y is in the path of claim B and node Z is in the path of claim C.</p><p id="p-0098" num="0092"><figref idref="DRAWINGS">FIG. <b>5</b>A-<b>5</b>C</figref> are block diagrams that depict an example configuration graph <b>500</b> and illustrate how multiple claims associated with the same node in configuration graph <b>500</b> may be resolved, in an embodiment. Configuration graph <b>500</b> includes N1 <b>502</b> (a root node), N2 <b>504</b>, N3 <b>506</b>, N4 <b>508</b>, N5 <b>510</b>, and N6 <b>512</b>. N2 <b>504</b> is a child node of N1 <b>502</b>, N3 <b>506</b> and N4 <b>508</b> are child nodes of N2 <b>504</b>, N5 <b>510</b> is a child node of N4 <b>508</b>, and N6 <b>512</b> is a child node of N5 <b>510</b>.</p><p id="p-0099" num="0093"><figref idref="DRAWINGS">FIG. <b>5</b>A</figref> indicates that, after claim propagation, there are three claims associated with N1 <b>502</b>: Claims A-C. Each claim indicates its source and its sink. The sink is the same for each one: N1 <b>502</b>. Because the sink and the source for Claim B is the same, Claim B is applied to N1 <b>502</b> and the other two claims are propagated back down configuration graph <b>500</b> to the child node of N1 <b>502</b>, which is N2 <b>504</b>, which is reflected in <figref idref="DRAWINGS">FIG. <b>5</b>B</figref>.</p><p id="p-0100" num="0094"><figref idref="DRAWINGS">FIG. <b>5</b>B</figref> indicates that there are two claims associated with N2 <b>504</b>: Claims A and C. Because the source for Claim A (i.e., N3 <b>506</b>) is closer to N2 <b>504</b> than the source for Claim B (i.e., N6 <b>512</b>), Claim A is applied to N2 <b>504</b> and Claim C is propagated down configuration graph <b>500</b> towards the source of Claim C, which is N4 <b>508</b> in this example.</p><p id="p-0101" num="0095"><figref idref="DRAWINGS">FIG. <b>5</b>C</figref> indicates that there is one claim associated with N4 <b>508</b>. There are no nodes in configuration graph <b>500</b> that are associated with multiple claims. Therefore, claims resolution is complete.</p><heading id="h-0016" level="1">Generated Updated Infrastructure Configuration Code</heading><p id="p-0102" num="0096">In an embodiment, one or more of these factors are considered at each node in configuration graph <b>148</b> until no node is associated with multiple claims. After all claims are applied to their respective nodes in configuration graph <b>148</b>, remediation engine <b>140</b> (or another component thereof) generates updated IAC <b>160</b> based on the updated version of configuration graph <b>148</b>. For example, for each node in configuration graph <b>148</b>, a configuration block is generated and included in IAC <b>160</b>, which initially may be empty, i.e., without any data. If the node has any attributes, then those attributes are included in the configuration block. Attributes that are optional, have no values, or are computed are not included in the configuration block. A module node is a special case where its respective attributes are stored in a file with a certain file extension, such as a .tfvars extension.</p><p id="p-0103" num="0097">Each node in the configuration graph comes with a resource address that uniquely identifies the resource in a (e.g., Terraform) file. A resource address may be of the format &#x3c;module_path&#x3e;.&#x3c;resource_type&#x3e;.&#x3c;resource_name&#x3e;. The &#x3c;module_path&#x3e; element maps to a directory in a file system. The &#x3c;resource_type&#x3e;.&#x3c;resource_name&#x3e; element maps to a resource block within that directory. With this mapping, the exact file and location in the file where the resource resides for every node in the configuration graph is known. The directory path and &#x3c;resource_type&#x3e;.&#x3c;resource_name&#x3e; element is sufficient in implementations that maintain the location of all resources for a particular module.</p><p id="p-0104" num="0098">The following is example IAC code that corresponds to Original Configuration Code above, but is updated based on deployed state:</p><p id="p-0105" num="0000"><tables id="TABLE-US-00006" num="00006"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="217pt" align="center"/><thead><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row><row><entry>Updated Configuration Code</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="offset" colwidth="14pt" align="left"/><colspec colname="1" colwidth="203pt" align="left"/><tbody valign="top"><row><entry/><entry>@@ &#x2212;10,7 +10,7 @@ resource &#x201c;azurerm_cosmosdb_account&#x201d;</entry></row><row><entry/><entry>&#x201c;tfaas_db&#x201d; {</entry></row><row><entry/><entry>&#x2003;resource_group_name&#x2003;&#x2003;&#x2003;&#x2003;= &#x201c;rg-dev-tfaas-1&#x201d;</entry></row><row><entry/><entry>&#x2003;consistency_policy {</entry></row><row><entry/><entry>&#x2003;&#x2003;consistency_level&#x2003;&#x2003;= &#x201c;BoundedStaleness&#x201d;</entry></row><row><entry/><entry>&#x2212;&#x2003;&#x2009;max_interval_seconds = 500</entry></row><row><entry/><entry>+&#x2003;&#x2003;max_interval_in_seconds = 300</entry></row><row><entry/><entry>&#x2003;&#x2003;max_staleness_prefix&#x2003;= 100000</entry></row><row><entry/><entry>&#x2003;}</entry></row><row><entry/><entry>&#x2003;geo_location {</entry></row><row><entry/><entry>@@ &#x2212;18,4 +18,9 @@ resource &#x201c;azurerm_cosmosdb_account&#x201d;</entry></row><row><entry/><entry>&#x201c;tfaas_db&#x201d; {</entry></row><row><entry/><entry>&#x2003;&#x2003;location&#x2003;&#x2003;= &#x201c;southcentralus&#x201d;</entry></row><row><entry/><entry>&#x2003;&#x2003;prefix&#x2003;&#x2003;&#x2002;= &#x201c;&#x201d;</entry></row><row><entry/><entry>&#x2003;}</entry></row><row><entry/><entry>+&#x2003;&#x2009;geo_location {</entry></row><row><entry/><entry>+&#x2003;&#x2003;failover_priority = 1</entry></row><row><entry/><entry>+&#x2003;&#x2003;location&#x2003;&#x2003;&#x2003;= &#x201c;eastus&#x201d;</entry></row><row><entry/><entry>+&#x2003;&#x2003;prefix&#x2003;&#x2003;&#x2003;&#x2002;= &#x201c;&#x201d;</entry></row><row><entry/><entry>+&#x2003;&#x2009;}</entry></row><row><entry/><entry namest="offset" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0106" num="0099">Differences between this Updated Configuration Code and the Original Configuration Code include the Updated Configuration Code having a new geo location failover and updated max_interval_in_seconds marked in +.</p><heading id="h-0017" level="1">Hardware Overview</heading><p id="p-0107" num="0100">According to one embodiment, the techniques described herein are implemented by one or more special-purpose computing devices. The special-purpose computing devices may be hard-wired to perform the techniques, or may include digital electronic devices such as one or more application-specific integrated circuits (ASICs) or field programmable gate arrays (FPGAs) that are persistently programmed to perform the techniques, or may include one or more general purpose hardware processors programmed to perform the techniques pursuant to program instructions in firmware, memory, other storage, or a combination. Such special-purpose computing devices may also combine custom hard-wired logic, ASICs, or FPGAs with custom programming to accomplish the techniques. The special-purpose computing devices may be desktop computer systems, portable computer systems, handheld devices, networking devices or any other device that incorporates hard-wired and/or program logic to implement the techniques.</p><p id="p-0108" num="0101">For example, <figref idref="DRAWINGS">FIG. <b>6</b></figref> is a block diagram that illustrates a computer system <b>600</b> upon which an embodiment of the invention may be implemented. Computer system <b>600</b> includes a bus <b>602</b> or other communication mechanism for communicating information, and a hardware processor <b>604</b> coupled with bus <b>602</b> for processing information. Hardware processor <b>604</b> may be, for example, a general purpose microprocessor.</p><p id="p-0109" num="0102">Computer system <b>600</b> also includes a main memory <b>606</b>, such as a random access memory (RAM) or other dynamic storage device, coupled to bus <b>602</b> for storing information and instructions to be executed by processor <b>604</b>. Main memory <b>606</b> also may be used for storing temporary variables or other intermediate information during execution of instructions to be executed by processor <b>604</b>. Such instructions, when stored in non-transitory storage media accessible to processor <b>604</b>, render computer system <b>600</b> into a special-purpose machine that is customized to perform the operations specified in the instructions.</p><p id="p-0110" num="0103">Computer system <b>600</b> further includes a read only memory (ROM) <b>608</b> or other static storage device coupled to bus <b>602</b> for storing static information and instructions for processor <b>604</b>. A storage device <b>610</b>, such as a magnetic disk, optical disk, or solid-state drive is provided and coupled to bus <b>602</b> for storing information and instructions.</p><p id="p-0111" num="0104">Computer system <b>600</b> may be coupled via bus <b>602</b> to a display <b>612</b>, such as a cathode ray tube (CRT), for displaying information to a computer user. An input device <b>614</b>, including alphanumeric and other keys, is coupled to bus <b>602</b> for communicating information and command selections to processor <b>604</b>. Another type of user input device is cursor control <b>616</b>, such as a mouse, a trackball, or cursor direction keys for communicating direction information and command selections to processor <b>604</b> and for controlling cursor movement on display <b>612</b>. This input device typically has two degrees of freedom in two axes, a first axis (e.g., x) and a second axis (e.g., y), that allows the device to specify positions in a plane.</p><p id="p-0112" num="0105">Computer system <b>600</b> may implement the techniques described herein using customized hard-wired logic, one or more ASICs or FPGAs, firmware and/or program logic which in combination with the computer system causes or programs computer system <b>600</b> to be a special-purpose machine. According to one embodiment, the techniques herein are performed by computer system <b>600</b> in response to processor <b>604</b> executing one or more sequences of one or more instructions contained in main memory <b>606</b>. Such instructions may be read into main memory <b>606</b> from another storage medium, such as storage device <b>610</b>. Execution of the sequences of instructions contained in main memory <b>606</b> causes processor <b>604</b> to perform the process steps described herein. In alternative embodiments, hard-wired circuitry may be used in place of or in combination with software instructions.</p><p id="p-0113" num="0106">The term &#x201c;storage media&#x201d; as used herein refers to any non-transitory media that store data and/or instructions that cause a machine to operate in a specific fashion. Such storage media may comprise non-volatile media and/or volatile media. Non-volatile media includes, for example, optical disks, magnetic disks, or solid-state drives, such as storage device <b>610</b>. Volatile media includes dynamic memory, such as main memory <b>606</b>. Common forms of storage media include, for example, a floppy disk, a flexible disk, hard disk, solid-state drive, magnetic tape, or any other magnetic data storage medium, a CD-ROM, any other optical data storage medium, any physical medium with patterns of holes, a RAM, a PROM, and EPROM, a FLASH-EPROM, NVRAM, any other memory chip or cartridge.</p><p id="p-0114" num="0107">Storage media is distinct from but may be used in conjunction with transmission media. Transmission media participates in transferring information between storage media. For example, transmission media includes coaxial cables, copper wire and fiber optics, including the wires that comprise bus <b>602</b>. Transmission media can also take the form of acoustic or light waves, such as those generated during radio-wave and infra-red data communications.</p><p id="p-0115" num="0108">Various forms of media may be involved in carrying one or more sequences of one or more instructions to processor <b>604</b> for execution. For example, the instructions may initially be carried on a magnetic disk or solid-state drive of a remote computer. The remote computer can load the instructions into its dynamic memory and send the instructions over a telephone line using a modem. A modem local to computer system <b>600</b> can receive the data on the telephone line and use an infra-red transmitter to convert the data to an infra-red signal. An infra-red detector can receive the data carried in the infra-red signal and appropriate circuitry can place the data on bus <b>602</b>. Bus <b>602</b> carries the data to main memory <b>606</b>, from which processor <b>604</b> retrieves and executes the instructions. The instructions received by main memory <b>606</b> may optionally be stored on storage device <b>610</b> either before or after execution by processor <b>604</b>.</p><p id="p-0116" num="0109">Computer system <b>600</b> also includes a communication interface <b>618</b> coupled to bus <b>602</b>. Communication interface <b>618</b> provides a two-way data communication coupling to a network link <b>620</b> that is connected to a local network <b>622</b>. For example, communication interface <b>618</b> may be an integrated services digital network (ISDN) card, cable modem, satellite modem, or a modem to provide a data communication connection to a corresponding type of telephone line. As another example, communication interface <b>618</b> may be a local area network (LAN) card to provide a data communication connection to a compatible LAN. Wireless links may also be implemented. In any such implementation, communication interface <b>618</b> sends and receives electrical, electromagnetic or optical signals that carry digital data streams representing various types of information.</p><p id="p-0117" num="0110">Network link <b>620</b> typically provides data communication through one or more networks to other data devices. For example, network link <b>620</b> may provide a connection through local network <b>622</b> to a host computer <b>624</b> or to data equipment operated by an Internet Service Provider (ISP) <b>626</b>. ISP <b>626</b> in turn provides data communication services through the world wide packet data communication network now commonly referred to as the &#x201c;Internet&#x201d; <b>628</b>. Local network <b>622</b> and Internet <b>628</b> both use electrical, electromagnetic or optical signals that carry digital data streams. The signals through the various networks and the signals on network link <b>620</b> and through communication interface <b>618</b>, which carry the digital data to and from computer system <b>600</b>, are example forms of transmission media.</p><p id="p-0118" num="0111">Computer system <b>600</b> can send messages and receive data, including program code, through the network(s), network link <b>620</b> and communication interface <b>618</b>. In the Internet example, a server <b>630</b> might transmit a requested code for an application program through Internet <b>628</b>, ISP <b>626</b>, local network <b>622</b> and communication interface <b>618</b>.</p><p id="p-0119" num="0112">The received code may be executed by processor <b>604</b> as it is received, and/or stored in storage device <b>610</b>, or other non-volatile storage for later execution.</p><p id="p-0120" num="0113">In the foregoing specification, embodiments of the invention have been described with reference to numerous specific details that may vary from implementation to implementation. The specification and drawings are, accordingly, to be regarded in an illustrative rather than a restrictive sense. The sole and exclusive indicator of the scope of the invention, and what is intended by the applicants to be the scope of the invention, is the literal and equivalent scope of the set of claims that issue from this application, in the specific form in which such claims issue, including any subsequent correction.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A method comprising:<claim-text>generating a configuration graph based on first infrastructure configuration code;</claim-text><claim-text>generating a deployed state of a cloud infrastructure based on a data schema and a current state of the cloud infrastructure;</claim-text><claim-text>matching resources indicated in the deployed state to nodes in the configuration graph;</claim-text><claim-text>based on differences between the resources and the nodes, updating the configuration graph to generate an updated configuration graph;</claim-text><claim-text>based on the updated configuration graph, generating second infrastructure configuration code that is different than the first infrastructure configuration code;</claim-text><claim-text>wherein the method is performed by one or more computing devices.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein updating the configuration graph comprises:<claim-text>identifying a resource that is indicated in the deployed state;</claim-text><claim-text>determining whether the resource corresponds to a node in the configuration graph;</claim-text><claim-text>in response to determining that no node in the configuration graph corresponds to the resource, updating the configuration graph to include information about the resource.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein updating the configuration graph comprises:<claim-text>after matching resources indicated in the deployed state to nodes in the configuration graph, determining whether there are any nodes in the configuration graph that do not match to a resource in the deployed state;</claim-text><claim-text>in response to determining that a node in the configuration graph does not match any resource indicated in the deployed state, updating the configuration graph by removing the node from the configuration graph.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein updating the configuration graph comprises:<claim-text>identifying a resource that is indicated in the deployed state;</claim-text><claim-text>determining whether the resource corresponds to any node in the configuration graph;</claim-text><claim-text>in response to determining that the resource indicated in the deployed state matches a node in the configuration graph, determining whether first attribute values of the resource match second attribute values of the node.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, further comprising:<claim-text>in response to determining that a first attribute value of the resource does not match a second attribute value, of the node, that corresponds to the first attribute value, updating the configuration graph to replace the second attribute value of the node with the first attribute value.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, further comprising:<claim-text>identifying an attribute in the resource;</claim-text><claim-text>identifying the attribute in the node;</claim-text><claim-text>determining that an attribute value of the attribute in the node is a reference;</claim-text><claim-text>in response to determining that the attribute value of the attribute in the node is a reference:<claim-text>traversing one or more edges in the configuration graph beginning with the node until a second node is reached that does not include a reference as an attribute value for the attribute;</claim-text><claim-text>creating a first claim that associates a first attribute value of the attribute in the resource with the second node.</claim-text></claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the first claim identifies the node, the second node, a path in the configuration graph from the node to the second node, the attribute, and the first attribute value.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, further comprising:<claim-text>identifying a first resource that is indicated in the deployed state;</claim-text><claim-text>determining whether the first resource corresponds to a node in the configuration graph;</claim-text><claim-text>in response to determining that the first resource corresponds to a third node in the configuration graph, determining that a value of the attribute in the third node of the graph is a reference;</claim-text><claim-text>in response to determining that the value of the attribute in the third node is a reference:<claim-text>traversing one or more second edges in the configuration graph beginning with the third node until the second node is reached;</claim-text><claim-text>associating a second attribute value of the attribute of the first resource with the second node.</claim-text></claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein updating the configuration graph comprises:<claim-text>determining that a node in the configuration graph is associated with a plurality of claims that includes a first claim and a second claim;</claim-text><claim-text>based on one or more criteria, selecting the first claim and applying the first claim to the node;</claim-text><claim-text>propagating the second claim down the configuration graph from the node toward a source of the second claim.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the one or more criteria includes one or more of:<claim-text>whether a source of a claim is the same as a sink of the claim;</claim-text><claim-text>whether any of the plurality of claims has a path that is a subpath of a path of another claim of the plurality of claims; or</claim-text><claim-text>which of the plurality of claims has the shortest path to its respective source.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. One or more storage media storing instructions which, when executed by one or more processors, cause:<claim-text>generating a configuration graph based on first infrastructure configuration code;</claim-text><claim-text>generating a deployed state of a cloud infrastructure based on a data schema and a current state of the cloud infrastructure;</claim-text><claim-text>matching resources indicated in the deployed state to nodes in the configuration graph;</claim-text><claim-text>based on differences between the resources and the nodes, updating the configuration graph to generate an updated configuration graph;</claim-text><claim-text>based on the updated configuration graph, generating second infrastructure configuration code that is different than the first infrastructure configuration code.</claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The one or more storage media of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein updating the configuration graph comprises:<claim-text>identifying a resource that is indicated in the deployed state;</claim-text><claim-text>determining whether the resource corresponds to a node in the configuration graph;</claim-text><claim-text>in response to determining that no node in the configuration graph corresponds to the resource, updating the configuration graph to include information about the resource.</claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The one or more storage media of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein updating the configuration graph comprises:<claim-text>after matching resources indicated in the deployed state to nodes in the configuration graph, determining whether there are any nodes in the configuration graph that do not match to a resource in the deployed state;</claim-text><claim-text>in response to determining that a node in the configuration graph does not match any resource indicated in the deployed state, updating the configuration graph by removing the node from the configuration graph.</claim-text></claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The one or more storage media of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein updating the configuration graph comprises:<claim-text>identifying a resource that is indicated in the deployed state;</claim-text><claim-text>determining whether the resource corresponds to any node in the configuration graph;</claim-text><claim-text>in response to determining that the resource indicated in the deployed state matches a node in the configuration graph, determining whether first attribute values of the resource match second attribute values of the node.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The one or more storage media of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the instructions, when executed by the one or more processors, further cause:<claim-text>in response to determining that a first attribute value of the resource does not match a second attribute value, of the node, that corresponds to the first attribute value, updating the configuration graph to replace the second attribute value of the node with the first attribute value.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The one or more storage media of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the instructions, when executed by the one or more processors, further cause:<claim-text>identifying an attribute in the resource;</claim-text><claim-text>identifying the attribute in the node;</claim-text><claim-text>determining that an attribute value of the attribute in the node is a reference;</claim-text><claim-text>in response to determining that the attribute value of the attribute in the node is a reference:<claim-text>traversing one or more edges in the configuration graph beginning with the node until a second node is reached that does not include a reference as an attribute value for the attribute;</claim-text><claim-text>creating a first claim that associates a first attribute value of the attribute in the resource with the second node.</claim-text></claim-text></claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The one or more storage media of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the first claim identifies the node, the second node, a path in the configuration graph from the node to the second node, the attribute, and the first attribute value.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The one or more storage media of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the instructions, when executed by the one or more processors, further cause:<claim-text>identifying a first resource that is indicated in the deployed state;</claim-text><claim-text>determining whether the first resource corresponds to a node in the configuration graph;</claim-text><claim-text>in response to determining that the first resource corresponds to a third node in the configuration graph, determining that a value of the attribute in the third node of the graph is a reference;</claim-text><claim-text>in response to determining that the value of the attribute in the third node is a reference:<claim-text>traversing one or more second edges in the configuration graph beginning with the third node until the second node is reached;</claim-text><claim-text>associating a second attribute value of the attribute of the first resource with the second node.</claim-text></claim-text></claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The one or more storage media of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein updating the configuration graph comprises:<claim-text>determining that a node in the configuration graph is associated with a plurality of claims that includes a first claim and a second claim;</claim-text><claim-text>based on one or more criteria, selecting the first claim and applying the first claim to the node;</claim-text><claim-text>propagating the second claim down the configuration graph from the node toward a source of the second claim.</claim-text></claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The one or more storage media of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the one or more criteria includes one or more of:<claim-text>whether a source of a claim is the same as a sink of the claim;</claim-text><claim-text>whether any of the plurality of claims has a path that is a subpath of a path of another claim of the plurality of claims; or</claim-text><claim-text>which of the plurality of claims has the shortest path to its respective source.</claim-text></claim-text></claim></claims></us-patent-application>