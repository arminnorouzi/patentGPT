<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230004647A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230004647</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17782195</doc-number><date>20200114</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>F</subclass><main-group>21</main-group><subgroup>57</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>N</subclass><main-group>20</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>21</main-group><subgroup>57</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20190101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>N</subclass><main-group>20</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">RISK EVALUATION APPARATUS, RISK EVALUATION METHOD, AND NON-TRANSITORY COMPUTER-READABLE RECORDING MEDIUM</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>NIPPON TELEGRAPH AND TELEPHONE CORPORATION</orgname><address><city>Tokyo</city><country>JP</country></address></addressbook><residence><country>JP</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>OKADA</last-name><first-name>Rina</first-name><address><city>Musashino-shi, Tokyo</city><country>JP</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>HASEGAWA</last-name><first-name>Satoshi</first-name><address><city>Musashino-shi, Tokyo</city><country>JP</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>NIPPON TELEGRAPH AND TELEPHONE CORPORATION</orgname><role>03</role><address><city>Tokyo</city><country>JP</country></address></addressbook></assignee></assignees><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/JP2020/000862</doc-number><date>20200114</date></document-id><us-371c12-date><date>20220603</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">The risk evaluation apparatus evaluates the risk of a machine learning model. The risk evaluation apparatus includes a recording unit, a loss function regression model acquirer, an attack noise addition unit, an error acquisition unit, and an evaluation unit. The recording unit records a set of predetermined loss functions and a set of pairs of data and labels predetermined. The loss function regression model acquirer determines a regression model of the loss function in the vicinity of data by nonparametric regression. The attack noise addition unit creates attack data that is an Adversarial Example using the regression model. The error acquisition unit determines the error between the output of the machine learning model when the data is input and the output of the machine learning model when the attack data is input. The evaluation unit evaluates the risk based on a set of errors.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="227.92mm" wi="148.76mm" file="US20230004647A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="149.94mm" wi="149.35mm" file="US20230004647A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="231.22mm" wi="161.80mm" file="US20230004647A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="192.62mm" wi="167.64mm" file="US20230004647A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="140.97mm" wi="177.63mm" file="US20230004647A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">TECHNICAL FIELD</heading><p id="p-0002" num="0001">The present invention relates to a risk evaluation apparatus, a risk evaluation method, and a risk evaluation program for evaluating the risk of a machine learning model.</p><heading id="h-0002" level="1">BACKGROUND ART</heading><p id="p-0003" num="0002">There are machine learning services that construct a machine learning model and allow users to utilize the machine learning model. In such a service, data that the user wants to predict or classify is input into the machine learning model, and the output from the machine learning model is used as a prediction result or a classification result.</p><p id="p-0004" num="0003">&#x201c;Adversarial Example&#x201d; is data in which a small amount of noise is added to the data to be predicted or classified in order to respond with a result different from the original prediction result or the classification result. For example, consider recognizing the color of a traffic light in a machine learning model during automatic driving of an automobile. When the image of the traffic light is input into the machine learning model, if an attacker adds noise on the image of the traffic light, and the image of the traffic light is changed to the Adversarial Example, there is a risk of the image that should be recognized as &#x201c;red&#x201d; being recognized as &#x201c;blue&#x201d; or &#x201c;yellow&#x201d;. This is a critical attack that leads to a traffic accident.</p><p id="p-0005" num="0004">As a method for creating an Adversarial Example, a method called &#x201c;Fast Gradient Sign Method (FGSM)&#x201d; is known. NPLs 1 and 2 describe techniques for creating Adversarial Examples in combination with an attack called &#x201c;model extraction&#x201d;.</p><heading id="h-0003" level="1">CITATION LIST</heading><heading id="h-0004" level="1">Non Patent Literature</heading><p id="p-0006" num="0000"><ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0005">NPL 1: Mika Juuti, Sebastian Szyller, Samuel Marchal, and N Asokan. Prada: protecting against dim model stealing attacks. In 2019 IEEE European Symposium on Security and Privacy (EuroS&#x26;P), pp. 512-527. IEEE, 2019.</li>    <li id="ul0001-0002" num="0006">NPL 2: Florian Tram&#xe8;r, Fan Zhang, Ari Juels, Michael K Reiter, and Thomas Ristenpart., Stealing machine learning models via prediction apis. In 25th USENIX Security Symposium (USENIX Security 16), pp. 601-618, 2016.</li></ul></p><heading id="h-0005" level="1">SUMMARY OF THE INVENTION</heading><heading id="h-0006" level="1">Technical Problem</heading><p id="p-0007" num="0007">The elements constituting a machine learning model include a model structure, activation function, loss function, and hyperparameters. A model extraction attack is a technique for estimating a machine learning model from an input/output relationship of the machine learning model. However, the model extraction attack assumes a slightly looser situation in which an attacker knows some of the elements constituting the machine learning model. However, most of machine learning services are provided to users with the detailed mechanism of a machine learning model that is not easily known. Thus, an object of the present invention is to create an Adversarial Example without combining a model extraction attack to evaluate a risk.</p><heading id="h-0007" level="1">Means for Solving the Problem</heading><p id="p-0008" num="0008">A risk evaluation apparatus of the present invention evaluates a risk of a machine learning model. The risk evaluation apparatus includes a recording unit, a loss function regression model acquirer, an attack noise addition unit, an error acquisition unit, and an evaluation unit. The recording unit records a set of predetermined loss functions and a set of pairs of predetermined data and labels. The loss function regression model acquirer determines, for each loss function and for each pair of data and labels, a regression model of the loss function in the vicinity of the data by nonparametric regression. The attack noise addition unit creates, using a regression model, attack data for each loss function and for each pair of data and labels. The error acquisition unit determines an error between an output of the machine learning model in a case where the data is input and an output of the machine learning model in a case where the attack data is input, for each loss function and for each pair of data and labels. The evaluation unit evaluates the risk based on a set of errors determined for each loss function and for each pair of data and labels.</p><heading id="h-0008" level="1">Effects of the Invention</heading><p id="p-0009" num="0009">The risk evaluation apparatus according to the present invention determines a regression model of a loss function while placing limitation to the vicinity of the data and creates an Adversarial Example using the determined regression model. Thus, it is possible to create an Adversarial Example and evaluate a risk without performing a model extraction attack</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0009" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p-0010" num="0010"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a diagram illustrating a functional configuration example of a risk evaluation apparatus <b>100</b> according to the present invention.</p><p id="p-0011" num="0011"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a diagram illustrating an example of a processing flowchart of the risk evaluation apparatus according to the present invention.</p><p id="p-0012" num="0012"><figref idref="DRAWINGS">FIG. <b>3</b>A</figref> illustrates a Gaussian process regression model in a case where the number of regression training data is one.</p><p id="p-0013" num="0013"><figref idref="DRAWINGS">FIG. <b>3</b>B</figref> illustrates a Gaussian process regression model in a case where the number of regression training data is two.</p><p id="p-0014" num="0014"><figref idref="DRAWINGS">FIG. <b>3</b>C</figref> illustrates a Gaussian process regression model in a case where the number of regression training data is three.</p><p id="p-0015" num="0015"><figref idref="DRAWINGS">FIG. <b>3</b>D</figref> illustrates a Gaussian process regression model in a case where the number of regression training data is thirteen.</p><p id="p-0016" num="0016"><figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates a structure of a computer.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0010" level="1">DESCRIPTION OF EMBODIMENTS</heading><p id="p-0017" num="0017">Hereinafter, embodiments of the present invention will be described in detail. Note that components having the same functions are denoted by the same reference signs, and redundant description thereof will be omitted.</p><heading id="h-0011" level="1">First Embodiment</heading><p id="p-0018" num="0018">In the Fast Gradient Sign Method (FGSM), Adversarial Example d&#x2032; is determined as follows.</p><p id="p-0019" num="0019">[Math. 1]</p><p id="p-0020" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>d&#x2032;=d</i>+&#x3b5;&#xb7;sign(&#x2207;<sub>d</sub><i>L</i>(<i>M</i>(<i>d</i>),<i>s</i>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0021" num="0020">Where, L indicates a loss function, d indicates data input into a machine learning model, M(d) indicates an output when the data d is input into the machine learning model, s indicates a correct output (label) for the data d, c indicates the magnitude of predetermined noise, sign indicates a function for acquiring the direction of a vector, and &#x2207;<sub>d </sub>indicates a partial derivative at a variable d.</p><p id="p-0022" num="0021">An attacker needs to know the loss function when using the FGSM described above.</p><p id="p-0023" num="0022">Thus, a set of possible loss functions L and data sets D including pairs of data d and labels s, are prepared in advance. Then, by estimating the loss function in the vicinity of the data d by nonparametric regression, risk evaluation is performed efficiently.</p><p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates a functional configuration example of a risk evaluation apparatus <b>100</b> according to the present invention, and <figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates an example of the processing flowchart of the risk evaluation apparatus according to the present invention. The risk evaluation apparatus <b>100</b> evaluates the risk of a machine learning model. The risk evaluation apparatus <b>100</b> includes a recording unit <b>190</b>, a loss function regression model acquirer <b>105</b>, an attack noise addition unit <b>140</b>, an error acquisition unit <b>150</b>, and an evaluation unit <b>160</b>.</p><p id="p-0025" num="0024">The recording unit <b>190</b> records a set of predetermined loss functions L and the data sets D including pairs (d, s) of the predetermined data d and labels s. The data d is present in a space that can be input into the machine learning model. For example, in a case where the data d is present in real coordinate space R, d&#x2208;R holds. Further, in the m-dimensional real coordinate space, d&#x2208; R<sup>m </sup>holds. The label s is a correct output corresponding to the data d, and is present in the space where the machine learning model can output. The label s may be present in the real coordinate space or may be present in the discrete space. For example, when the prediction result is output as a real numerical value, the label s is in the real coordinate space, and when the classification result is indicated by a discrete numerical value, the label s is in the discrete space. In a case where the label s is present in the real coordinate space, a squared loss, a &#x3b3;-quantile loss, a Huber loss, a &#x3b5;-insensitive loss, and the like are recorded as a loss function L in the recording unit <b>190</b>. In the case where the label s is present in the discrete space, and in the case of a binary classification, a 0-1 loss function, a logistic loss, an exponential loss, a flattening hinge loss, and the like are recorded as the loss function L in the recording unit <b>190</b>. In a case where the label s is present in the discrete space, and in the case of the multiclass classification, the cross entropy and the like are recorded as the loss function L in the recording unit <b>190</b>.</p><p id="p-0026" num="0025">Note that assuming an actual attacker for the machine learning model, the attacker does not know the data set utilized for training, so that the data sets for attack may include a data set utilized for training the machine learning model to be evaluated. Thus, a data set utilized for training the machine learning model to be evaluated may be included in the data sets D. However, when a risk evaluation of a machine learning model trained by itself is performed, data sets other than the data sets utilized for training the machine learning model to be evaluated is prepared as the data sets D. For example, a part of the data sets prepared for training the machine learning model is used as the data sets D for risk evaluation without being used for training.</p><p id="p-0027" num="0026">First, the risk evaluation apparatus <b>100</b> initializes a set of errors E (S<b>101</b>). The loss function regression model acquirer <b>105</b> determines a regression model G of the loss function L in the vicinity of the data d by &#x201c;nonparametric regression&#x201d; for each predetermined loss function L and for each pair of data and labels (d, s) (S<b>105</b>). &#x201c;Nonparametric regression&#x201d; includes smoothing splines, Gaussian process regression, kernel regression, and the like. These regression methods are used as appropriate. In particular, Gaussian process regression is easily used. More specifically, the loss function regression model acquirer <b>105</b> includes a data changing unit <b>110</b>, a training data acquisition unit <b>120</b>, and a regression model acquisition unit <b>130</b>.</p><p id="p-0028" num="0027">The loss function regression model acquirer <b>105</b> initializes a set of regression training data D<sub>train </sub>(S<b>106</b>). The data changing unit <b>110</b> randomly changes the data d in the vicinity of the data d in accordance with a predetermined distribution within the space that can be input into the machine learning model, to determine random change data r&#x2032; (S<b>110</b>). For example, a random number r generated in accordance with the predetermined distribution is added to the data d, and adjustment is performed such that the addition result (r+d) is within the space that can be input into the machine learning model. For example, the normal distribution may be used as the predetermined distribution to determine the random change data r&#x2032; as follows.</p><p id="p-0029" num="0028">[Math. 2]</p><p id="p-0030" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>r=N</i>(<i>O,&#x3c3;</i><sup>2 </sup><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0031" num="0029">[Math. 3]</p><p id="p-0032" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>r</i>&#x2032;=adjust(<i>d+r</i>)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0033" num="0030">Alternatively, the random change data r&#x2032; may be determined as follows.</p><p id="p-0034" num="0031">[Math. 4]</p><p id="p-0035" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>r</i>&#x2032;=adjust(<i>N</i>(<i>d,&#x3c3;</i><sup>2</sup>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0036" num="0032">Where, N(a, &#x3c3;<sup>2</sup>) is a function to randomly select a random number from the normal distribution with a mean value a and a variance &#x3c3;<sup>2 </sup>in the space that can be input into the machine learning model. b=adjust(a) indicates a function to format the variable a such that b is in the space that can be input into the machine learning model. For example, in a case where a is out of the space, a method may be used in which the part out of the space is replaced with the minimum value or the maximum value. Note that, if the variance &#x3c3;<sup>2 </sup>of the normal distribution is appropriately selected, it is easy to acquire the regression training data necessary to acquire the regression model in the vicinity of the data d.</p><p id="p-0037" num="0033">The training data acquisition unit <b>120</b> determines the regression training data (r&#x2032;, L(M(r&#x2032;), s)) which is a pair of the random change data r&#x2032; and a loss value L(M(r&#x2032;), s) obtained from the loss function in a case where the output M(r&#x2032;) of the machine learning model when the random change data is input and the label s are input (S<b>120</b>). Then, the regression training data (r&#x2032;, L(M(r&#x2032;), s)) is added to the set of the regression training data D<sub>train</sub>. Specifically, the regression training data (r&#x2032;, L(M(r&#x2032;), s)) is added to the set of the regression training data D<sub>train </sub>in as follows.</p><p id="p-0038" num="0034">[Math. 5]</p><p id="p-0039" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>D</i><sub>train</sub><i>=D</i><sub>train</sub>&#x222a;(<i>r&#x2032;,L</i>(<i>M</i>(<i>r</i>&#x2032;),<i>s</i>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0040" num="0035">The loss function regression model acquirer <b>105</b> repeats a data change step S<b>110</b> and a training data acquisition step S<b>120</b> for a predetermined number of times (S<b>121</b>). The number of repetitions is determined as appropriate. If the number of repetitions is approximately ten to twenty, the regression model of the loss function can be easily determined in the vicinity of the data d, and efficient risk evaluation can be easily performed.</p><p id="p-0041" num="0036">The regression model acquisition unit <b>130</b> uses the set of regression training data to determine the regression model of the loss function in the vicinity of the data d (S<b>130</b>). Specifically, the regression model G is determined by using the set of the regression training data D<sub>train </sub>as follows.</p><p id="p-0042" num="0037">[Math. 6]</p><p id="p-0043" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>G=REG</i><sub>train</sub>(<i>D</i><sub>train</sub>)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0044" num="0000">Where, REG<sub>train</sub>(D<sub>train</sub>) is a function to receive the set D<sub>train </sub>as training data and output the regression model.</p><p id="p-0045" num="0038"><figref idref="DRAWINGS">FIGS. <b>3</b>A to <b>3</b>D</figref> illustrates the relationship between the number of repetitions (that is, the number of regression training data) and the Gaussian process regression model. <figref idref="DRAWINGS">FIG. <b>3</b>A</figref> illustrates a Gaussian process regression model in a case where the number of regression training data is one. <figref idref="DRAWINGS">FIG. <b>3</b>B</figref> illustrates a Gaussian process regression model in a case where the number of regression training data is two. <figref idref="DRAWINGS">FIG. <b>3</b>C</figref> illustrates a Gaussian process regression model in a case where the number of regression training data is three. <figref idref="DRAWINGS">FIG. <b>3</b>D</figref> illustrates a Gaussian process regression model in a case where the number of regression training data is thirteen. The horizontal axis indicates the space that can be input into the machine learning model. The vertical axis indicates the loss value of the loss function. &#x201c;d&#x201d; in the horizontal axis indicates an example of d of a pair of predetermined data and labels (d, s). The thin dotted line indicates the loss function of the machine learning model for risk evaluation. The thick dotted line indicates the slope of the loss function at the data d. The thin solid line indicates a Gaussian process regression model of the loss function. The thick solid line indicates the slope of the Gaussian process regression model at the data d. The dots indicate the regression training data. It can be seen that the slope of the loss function of the machine learning model for the risk evaluation and the slope of the Gaussian process regression model are nearly the same when the number of regression training data is thirteen. In addition, it can also be seen that the regression model of the loss function in the vicinity of the data d can be determined by the loss function regression model acquisition step S<b>105</b>.</p><p id="p-0046" num="0039">The attack noise addition unit <b>140</b> creates, using the regression model G, attack data that is an Adversarial Example for each predetermined loss function L and for each pair of data and labels (d, s) (S<b>140</b>). Specifically, attack data d&#x2032; is determined as follows.</p><p id="p-0047" num="0040">[Math. 7]</p><p id="p-0048" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>d&#x2032;=d</i>+&#x3b5;&#xb7;sign(&#x2207;<sub>d</sub><i>G</i>(<i>M</i>(<i>d</i>),<i>s</i>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0049" num="0041">&#x3b5; indicates the magnitude of predetermined noise. sign indicates a function to acquire the direction of a vector. &#x2207;<sub>d </sub>indicates a partial derivative at the variable d and is a function to determine the slope of the regression model G.</p><p id="p-0050" num="0042">The error acquisition unit <b>150</b> determines an error error(M(d), M(d&#x2032;)) between the output M(d) of the machine learning model in a case where the data d is input and the output M(d&#x2032;) of the machine learning model in a case where the attack data is input, for each predetermined loss function and for each pair of data and labels (d, s) (S<b>150</b>). Then, the error error(M(d), M(d&#x2032;)) is added to the set of errors E. Specifically, the error error(M(d), M(d&#x2032;)) is added to the set of errors E as follows.</p><p id="p-0051" num="0043">[Math. 8]</p><p id="p-0052" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>E=E</i>&#x222a;error(<i>M</i>(<i>d</i>),<i>M</i>(<i>d</i>&#x2032;))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0053" num="0044">The error(M(d), M(d&#x2032;)) indicates a function to determine the error between M(d) and M(d&#x2032;). For example, in a case where M(d) and M(d&#x2032;) are in the real coordinate space, the error acquisition unit <b>150</b> determines L2 norm as an error as follows.</p><p id="p-0054" num="0045">[Math. 9]</p><p id="p-0055" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>error(<i>M</i>(<i>d</i>),<i>M</i>(<i>d</i>&#x2032;))=&#x2225;<i>M</i>(<i>d</i>)&#x2212;<i>M</i>(<i>d</i>&#x2032;)&#x2225;<sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0056" num="0046">In a case where M(d) and M(d&#x2032;) are in the discrete space (binary classification or multiclass classification), the error acquisition unit <b>150</b> determines the error as follows.</p><p id="p-0057" num="0047">[Math. 10]</p><p id="p-0058" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mrow>  <mrow>   <mi>error</mi>   <mo>(</mo>   <mrow>    <mrow>     <mi>M</mi>     <mo>&#x2061;</mo>     <mo>(</mo>     <mi>d</mi>     <mo>)</mo>    </mrow>    <mo>,</mo>    <mrow>     <mi>M</mi>     <mo>&#x2061;</mo>     <mo>(</mo>     <msup>      <mi>d</mi>      <mo>&#x2032;</mo>     </msup>     <mo>)</mo>    </mrow>   </mrow>   <mo>)</mo>  </mrow>  <mo>=</mo>  <mrow>   <mo>{</mo>   <mtable>    <mtr>     <mtd>      <mn>0</mn>     </mtd>     <mtd>      <mrow>       <mo>(</mo>       <mrow>        <mrow>         <mi>M</mi>         <mo>&#x2061;</mo>         <mo>(</mo>         <mi>d</mi>         <mo>)</mo>        </mrow>        <mo>=</mo>        <mrow>         <mi>M</mi>         <mo>&#x2061;</mo>         <mo>(</mo>         <msup>          <mi>d</mi>          <mo>&#x2032;</mo>         </msup>         <mo>)</mo>        </mrow>       </mrow>       <mo>)</mo>      </mrow>     </mtd>    </mtr>    <mtr>     <mtd>      <mn>1</mn>     </mtd>     <mtd>      <mrow>       <mo>(</mo>       <mrow>        <mrow>         <mi>M</mi>         <mo>&#x2061;</mo>         <mo>(</mo>         <mi>d</mi>         <mo>)</mo>        </mrow>        <mo>&#x2260;</mo>        <mrow>         <mi>M</mi>         <mo>&#x2061;</mo>         <mo>(</mo>         <msup>          <mi>d</mi>          <mo>&#x2032;</mo>         </msup>         <mo>)</mo>        </mrow>       </mrow>       <mo>)</mo>      </mrow>     </mtd>    </mtr>   </mtable>  </mrow> </mrow></math></maths></p><p id="p-0059" num="0048">The risk evaluation apparatus <b>100</b> repeats the loss function regression model acquisition step S<b>105</b>, the attack noise addition step S<b>140</b>, and the error acquisition step S<b>150</b> for all the predetermined sets (d, s) of data d and labels s (S<b>151</b>). The risk evaluation apparatus <b>100</b> repeats the loss function regression model acquisition step S<b>105</b>, the attack noise addition step S<b>140</b>, the error acquisition step S<b>150</b>, and the repeating step S<b>151</b> for all the predetermined loss functions L recorded in the recording unit <b>190</b> (S<b>152</b>). Note that the order of the repeating steps S<b>151</b> and S<b>152</b> may be reversed.</p><p id="p-0060" num="0049">The evaluation unit <b>160</b> evaluates the risk based on a set of errors determined for each loss function and for each pair of data and labels (S<b>160</b>). Specifically, the evaluation e is determined using the set of errors E as follows.</p><p id="p-0061" num="0050">[Math. 11]</p><p id="p-0062" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>e</i>=RE(<i>E</i>)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0063" num="0051">Where, RE(E) is a function to receive the set E and output the evaluation. For example, in a case where M(d) and M(d&#x2032;) are in the real coordinate space, the evaluation unit <b>160</b> determines the maximum value of the errors included in the set E as an evaluation as follows.</p><p id="p-0064" num="0052">[Math. 12]</p><p id="p-0065" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>RE(<i>E</i>)max(<i>E</i>)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0066" num="0053">In a case where M(d) and M(d&#x2032;) are in the discrete spaces (binary classification or multiclass classification), the evaluation unit <b>160</b> determines the average of the set E errors as an evaluation as follows.</p><p id="p-0067" num="0054">[Math. 13]</p><p id="p-0068" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>RE(<i>E</i>)=<i>ave</i>(<i>E</i>)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0069" num="0055">The risk evaluation apparatus <b>100</b> determines a regression model of a loss function while placing limitation to the vicinity of the data d, and creates an Adversarial Example using the determined regression model. Thus, it is possible to create the Adversarial Example and evaluate a risk without performing a model extraction attack. According to the risk evaluation apparatus <b>100</b>, it is possible to prepare a predetermined data set D in a situation where the data set utilized for training the machine learning model is unknown, and evaluate the risk. Furthermore, the risk can be evaluated even if the loss function is unknown. Thus, the risk can be evaluated in a realistic situation where the detailed mechanism of the machine learning model is not known.</p><p id="p-0070" num="0056">Program and Recording Medium</p><p id="p-0071" num="0000">The above-described various processes can be implemented by reading programs for executing each step of the above-mentioned method in a recording unit <b>2020</b> of a computer <b>2000</b> illustrated in <figref idref="DRAWINGS">FIG. <b>4</b></figref>, and operating a control unit <b>2010</b>, an input unit <b>2030</b>, an output unit <b>2040</b>, a display unit <b>2050</b>, and the like.</p><p id="p-0072" num="0057">The program in which the processing details are described can be recorded on a computer-readable recording medium. The computer-readable recording medium, for example, may be any type of medium such as a magnetic recording device, an optical disc, a magneto-optical recording medium, or a semiconductor memory.</p><p id="p-0073" num="0058">In addition, the program is distributed, for example, by selling, transferring, or lending a portable recording medium such as a DVD or a CD-ROM with the program recorded on it. Further, the program may be stored in a storage device of a server computer and transmitted from the server computer to another computer via a network, so that the program is distributed.</p><p id="p-0074" num="0059">For example, a computer executing the program first temporarily stores the program recorded on the portable recording medium or the program transmitted from the server computer in its own storage device. When the computer executes the processing, the computer reads the program stored in the recording medium of the computer and executes a process according to the read program. Further, as another execution mode of this program, the computer may directly read the program from the portable recording medium and execute processing in accordance with the program, or, further, may sequentially execute the processing in accordance with the received program each time the program is transferred from the server computer to the computer. In addition, another configuration may be employed to execute the processing through a so-called application service provider (ASP) service in which processing functions are implemented just by issuing an instruction to execute the program and obtaining results without transmitting the program from the server computer to the computer. Further, the program in this mode is assumed to include information which is provided for processing of a computer and is equivalent to a program (data or the like that has characteristics of regulating processing of the computer rather than being a direct instruction to the computer).</p><p id="p-0075" num="0060">In addition, although the device is configured by executing a predetermined program on a computer in this mode, at least a part of the processing details may be implemented by hardware.</p><heading id="h-0012" level="1">REFERENCE SIGNS LIST</heading><p id="p-0076" num="0000"><ul id="ul0002" list-style="none">    <li id="ul0002-0001" num="0061"><b>100</b> Risk evaluation apparatus</li>    <li id="ul0002-0002" num="0062"><b>105</b> Loss function regression model acquirer</li>    <li id="ul0002-0003" num="0063"><b>110</b> Data changing unit</li>    <li id="ul0002-0004" num="0064"><b>120</b> Training data acquisition unit</li>    <li id="ul0002-0005" num="0065"><b>130</b> Regression model acquisition unit</li>    <li id="ul0002-0006" num="0066"><b>140</b> Attack noise addition unit</li>    <li id="ul0002-0007" num="0067"><b>150</b> Error acquisition unit</li>    <li id="ul0002-0008" num="0068"><b>160</b> Evaluation unit</li>    <li id="ul0002-0009" num="0069"><b>190</b> Recording unit</li></ul></p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001" nb-file="US20230004647A1-20230105-M00001.NB"><img id="EMI-M00001" he="6.01mm" wi="76.20mm" file="US20230004647A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A risk evaluation apparatus for evaluating a risk of a machine learning model, the risk evaluation apparatus comprising:<claim-text>a recording medium configured to record a set of loss functions predetermined and a set of a plurality of pairs of data and labels predetermined; and</claim-text><claim-text>processing circuitry configured to:</claim-text><claim-text>execute a loss function regression model acquirer processing which determines, for each of the loss functions and for each of the plurality of pairs of data and labels, a regression model of the loss function in a vicinity of the data by nonparametric regression;</claim-text><claim-text>execute an attack noise addition processing which creates attack data using the regression model for each of the loss functions and for each of the plurality of pairs of data and labels;</claim-text><claim-text>execute an error acquisition processing which determines, for each of the loss functions and for each of the plurality of pairs of data and labels, an error between an output of the machine learning model in a case where the data is input and an output of the machine learning model in a case where the attack data is input; and</claim-text><claim-text>execute an evaluation processing which evaluate a risk based on a set of errors determined for each of the loss functions and for each of the plurality of pairs of data and labels.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The risk evaluation apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the loss function regression model acquirer processing:</claim-text><claim-text>randomly changes the data in a vicinity of the data in accordance with a predetermined distribution within a space that can be input into the machine learning model, to determine random change data;</claim-text><claim-text>determines regression training data, the regression training data being a pair of the random change data and a loss value obtained from the loss function in a case where an output of the machine learning model when the random change data is input and the label are input; and</claim-text><claim-text>determines the regression model using a set of the regression training data.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The risk evaluation apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein<claim-text>the random change data is obtained by:</claim-text><claim-text>adding, to the data, a random number generated in accordance with the predetermined distribution and performing adjustment for obtaining an addition result being within a space that can be input into the machine learning model.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The risk evaluation apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein<claim-text>the predetermined distribution is a normal distribution.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The risk evaluation apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the nonparametric regression is a Gaussian process regression.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. A risk evaluation method for evaluating a risk of a machine learning model, the risk evaluation method comprising:<claim-text>preparing a set of loss functions predetermined and a set of a plurality of pairs of data and labels predetermined;</claim-text><claim-text>determining, for each of the loss functions and for each of the plurality of pairs of data and labels, a regression model of the loss function in a vicinity of the data by nonparametric regression;</claim-text><claim-text>creating, for each of the loss functions and for each of the plurality of pairs of data and labels, attack data being an Adversarial Example using the regression model;</claim-text><claim-text>determining, for each of the loss functions and for each of the plurality of pairs of data and labels, an error between an output of the machine learning model in a case where the data is input and an output of the machine learning model in a case where the attack data is input; and</claim-text><claim-text>evaluating a risk based on a set of errors determined for each of the loss functions and for each of the plurality of pairs of data and labels.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. A non-transitory computer-readable recording medium on which the risk evaluation program for causing a computer to operate as the risk evaluation apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The risk evaluation apparatus according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein<claim-text>the predetermined distribution is a normal distribution.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The risk evaluation apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein<claim-text>the nonparametric regression is a Gaussian process regression.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The risk evaluation apparatus according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein<claim-text>the nonparametric regression is a Gaussian process regression.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The risk evaluation apparatus according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein<claim-text>the nonparametric regression is a Gaussian process regression.</claim-text></claim-text></claim></claims></us-patent-application>