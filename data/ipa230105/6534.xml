<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230006535A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230006535</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17941169</doc-number><date>20220909</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>02</class><subclass>M</subclass><main-group>1</main-group><subgroup>00</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>02</class><subclass>M</subclass><main-group>7</main-group><subgroup>483</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>02</class><subclass>M</subclass><main-group>7</main-group><subgroup>5387</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20210501</date></cpc-version-indicator><section>H</section><class>02</class><subclass>M</subclass><main-group>1</main-group><subgroup>0025</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20210501</date></cpc-version-indicator><section>H</section><class>02</class><subclass>M</subclass><main-group>1</main-group><subgroup>007</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20210501</date></cpc-version-indicator><section>H</section><class>02</class><subclass>M</subclass><main-group>7</main-group><subgroup>4835</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>02</class><subclass>M</subclass><main-group>7</main-group><subgroup>53873</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20210501</date></cpc-version-indicator><section>H</section><class>02</class><subclass>M</subclass><main-group>1</main-group><subgroup>0009</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">CONTROLLING A CASCADED MULTILEVEL CONVERTER</invention-title><us-related-documents><continuation><relation><parent-doc><document-id><country>US</country><doc-number>PCT/EP2020/056658</doc-number><date>20200312</date></document-id><parent-status>PENDING</parent-status></parent-doc><child-doc><document-id><country>US</country><doc-number>17941169</doc-number></document-id></child-doc></relation></continuation></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>HUAWEI TECHNOLOGIES CO., LTD.</orgname><address><city>Shenzhen</city><country>CN</country></address></addressbook><residence><country>CN</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>FREIJEDO FERN&#xc1;NDEZ</last-name><first-name>Francisco Daniel</first-name><address><city>Nuremberg</city><country>DE</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A cascaded multilevel converter is disclosed. The converter comprises a plurality of modules coupled to form a branch, each of the modules comprising a switching circuit and a DC link for supplying DC voltage to the switching circuit. The converter further comprises a controller for controlling the switching circuit of each module to generate an AC voltage in the branch, wherein the controller is configured to: determine for each module a voltage across a capacitor of the DC link of the module, determine for each module a reference power value for charging the capacitor of the DC link of the module to a reference voltage value for the module, determine, from the reference power values of the modules, a common reference AC current value for AC current in the branch, determine, from the common reference AC current value, a common reference AC voltage value for AC voltage in the branch.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="220.73mm" wi="158.75mm" file="US20230006535A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="232.41mm" wi="167.05mm" file="US20230006535A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="218.19mm" wi="156.21mm" file="US20230006535A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="223.18mm" wi="170.26mm" orientation="landscape" file="US20230006535A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="220.39mm" wi="143.68mm" orientation="landscape" file="US20230006535A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="248.41mm" wi="164.34mm" orientation="landscape" file="US20230006535A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="244.26mm" wi="172.72mm" orientation="landscape" file="US20230006535A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="214.12mm" wi="151.55mm" orientation="landscape" file="US20230006535A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading><p id="p-0002" num="0001">This application is a continuation of International Application No. PCT/EP2020/056658, filed on Mar. 12, 2020, the disclosure of which is hereby incorporated by reference in its entirety.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">The present disclosure relates to a cascaded multilevel converter and a method of controlling a cascaded multilevel converter.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">Cascaded multilevel converters are power electronic devices used for providing an alternating voltage level at the output using multiple lower level DC voltages as an input. One application of cascaded multilevel converters is in solid state transformers, used in electrical power transmission and distribution grids in place of conventional line-frequency transformers for interfacing different AC voltage levels.</p><p id="p-0005" num="0004">A cascaded multilevel converter comprises plural inverter modules, each module comprising a plurality of power electronics switches operable to generate an AC output from the DC input by controlling the switching sequence of the switches. The AC outputs of the plural inverter modules are cascaded, i.e. connected in series, to form a branch, such that the AC output voltage in the branch is synthesised by the sum of the outputs of the inverter modules. Each inverter module is supplied with DC voltage by an individual DC-link, which may, for example, be coupled to a DC voltage output of a rectifier circuit. This cascaded structure has a number of advantages. Firstly, because the AC output voltages of the modules add in the branch, each module is only required to be capable of handling relatively lower voltages and powers, thereby allowing the use at the module level of low voltage power electronics components in medium/high voltage converter applications. Further, the power quality of the AC output signal in the branch may be improved relatively easily, simply by adding additional modules in the cascade, to thereby increase the number of different voltage levels available for synthesising the AC output signal, resulting in reduced harmonic distortion in the output signal.</p><p id="p-0006" num="0005">However, the aforementioned advantages of cascaded multilevel converters come at the expense of increasing complexity, both in terms of topology of the circuit and control of the multiple inverter modules. Considering in particular control, it is desirable to achieve independent control of the individual DC-link voltages which feed the inverter modules. For example, independent control of the DC-link voltages enables maintaining equal charge in the DC-links of each inverter modules in a branch, which may advantageously prevent modules from exceeding their operating range, even under unequal inter-module load conditions and Dc-link capacitance values. Further, independent control of the DC-link voltages may advantageously allow for detection and isolation of a faulty module, thereby allowing continued operation of the converter even in the event of failure of one or more of the constituent modules.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0007" num="0006">An object of the present disclosure is to provide a cascaded multilevel converter in which switching sequences of inverter stages are controlled in dependence on a determination of the voltages of the individual DC-link circuits. This may advantageously achieve good decoupling of the dynamics of the DC-link circuits, allow independent control of the individual DC-link voltages, and/or facilitate fault detection, and accordingly module isolation, on an individual module-level.</p><p id="p-0008" num="0007">The foregoing and other objects are achieved by the features of the independent claims. Further implementation forms are apparent from the dependent claims, the description and the Figures.</p><p id="p-0009" num="0008">A first aspect of the present disclosure provides a cascaded multilevel converter comprising a plurality of modules coupled to form a branch, each of the modules comprising a switching circuit and a DC-link for supplying DC voltage to the switching circuit, and a controller for controlling the switching circuit of each module to generate an AC voltage in the branch, wherein the controller is configured to: determine for each module a voltage across a capacitor of the DC-link of the module, determine for each module a reference power value for charging the capacitor of the DC-link of the module to a reference voltage value for the module, determine, from the reference power values of the modules, a common reference AC current value for AC current in the branch, determine, from the common reference AC current value, a common reference AC voltage value for AC voltage in the branch, determine for each module a reference AC voltage value using the common reference AC voltage value and the reference power value for the module, and generate a pulse width modulation signal for controlling the switching circuit of each module based on the reference AC voltage value for the module and the voltage across the capacitor of the module.</p><p id="p-0010" num="0009">The switching circuit of each module may thus be controlled by the controller to generate an AC voltage output in the branch from the DC voltage input supplied by the DC-link. The controller calculates the switching circuit duty cycle by generation of a suitable pulse width modulation signal. The pulse width modulation signal is generated in dependence on both the AC voltage reference and the determined voltage across the capacitor of each individual DC-link. Taking account of individually determined DC-link voltages in the control of the switching circuits advantageously achieves good decoupling of the dynamics of the DC-link circuits and allows independent control of the DC-link voltages. Furthermore, determining the individual DC-link voltages may advantageously enable fault detection on an individual module level, thereby facilitating bypassing of a faulty module without causing failure of the complete converter. In the present disclosure, just a single current control task is implemented, in recognition that the current draw through each of the modules should be the same. In other words, only a single current reference and current control task is implemented for all of the modules in the branch. The switching circuit of one or each module could be implemented by a half-bridge circuit, or more preferably by a full-bridge circuit.</p><p id="p-0011" num="0010">The voltage across the capacitor of the DC-link of each module could, for example, be determined by measuring the voltage across the capacitor using a voltage sensor. The controller of the converter could comprise a plurality of devices each performing a subset of the various tasks, or alternatively the tasks could be performed by one or more multi-tasking devices. The capacitor of the Dc-link could be formed by a single capacitor component, or alternative could comprise more than one capacitor coupled in series, i.e. as used herein the term &#x2018;capacitor&#x2019; should be understood to mean &#x2018;equivalent capacitor&#x2019;.</p><p id="p-0012" num="0011">In an implementation, the reference voltage value for each module may be a predetermined value stored in memory in the controller. The use of a predetermined value for the reference voltage, e g a manually defined value set in the controller, advantageously allows for setting of a reference voltage that is optimised for the particular application in which the converter is deployed. For example, the reference voltage value may be set taking into account the output AC voltage and the power ratings of the components of the converter.</p><p id="p-0013" num="0012">In an implementation, the reference power value for each module may be determined based on a difference between squared values of the voltage across the capacitor of the DC-link of the module and the reference voltage value for the module. Because both the determined and reference voltage values are squared prior to determination of the per-module reference power value, the inputs of the control loop are each linearly proportional to the energy stored in each DC-link capacitor.</p><p id="p-0014" num="0013">In an implementation, the controller may comprise a reference current control device configured to receive the reference power values for each of the plurality of modules and determine the common reference AC current value. In other words, the current control task could be implemented by a single device having view of the all of the power references in the branch. Implementing all current control tasks on the same device, rather than for example on a plurality of physically distributed devices, may advantageously minimise latencies in communication between devices conducting different tasks. Delays in the response of the converter to instructions from the controller may thereby be reduced, along with delays in the response of the controller to changes in the operation of the converter.</p><p id="p-0015" num="0014">In an implementation, the controller may comprise a plurality of switching circuit control devices each configured to receive the reference AC voltage value of one of the plurality of modules and control the switching circuit of that module. The plurality of switching circuit control devices may be assigned to respective modules, such that each device receives the reference AC voltage value for a module and calculates the duty-cycle for generation of a pulse-width modulation signal to control the switching circuit of that module. In other words, the duty cycle calculation is implemented by individual control devices at module level. This may advantageously reduce latencies in communication between the duty cycle calculation device and the switching circuit of the module. Delays in the response of the converter to instructions from the controller may thereby advantageously be reduced, along with delays in the response of the controller to changes in the operation of the converter.</p><p id="p-0016" num="0015">In an implementation, the controller may be configured to: control the switching circuits of each module in accordance with an initial mode of operation, determine the power demands of each of the modules, determine whether each of the modules has a power demand of the same sign, and control the switching circuits of each module in accordance with the method if each of the modules has a power demand of the same sign. In other words, the controller may control the switching circuits of the modules in accordance with a first mode operation if the power demands of the modules are mutually different. For example, in this first mode of operation, the switching circuits could be controlled in accordance with a conventional clustered mode of operation, in which the reference voltage of each DC-link is set in the controller as an average of the total branch voltage. This may advantageously avoid spurious operation of the switching circuits where one or more of the modules has a power demand of a different sign to another of the modules.</p><p id="p-0017" num="0016">In an implementation, the controller may be further configured to compare the voltage of at least one of the modules to a predetermined threshold voltage, and in response to the voltage of the module being higher or lower than the threshold voltage configure the module to form a path for AC voltage in the branch that bypasses the DC-link of the module. The predetermined threshold voltage values may be set as voltage values to be expected of the module in normal operation for the application. Accordingly, if the determined voltage does not match the predetermined voltage values, it may be inferred that the module itself is faulty, or that the voltage determined for that module is incorrect, and bypass the faulty module. This may advantageously facilitate continued operation of the converter even where one or modules is faulty, thereby avoiding complete failure of the system. For example, the DC-link of the module could be bypassed by suitable configuration of the switching circuit such that the path for AC voltage in the branch bypasses the DC-link. This mode of bypassing is reliant however on the switching circuit being sufficiently operable to adopt the bypass configuration. It may thus be desirable for example to provide dedicated means for bypassing even the switching circuit of the module. The controller may in actuality be configured to compare the voltage of more than one, and preferably each, of the modules to a predetermined threshold voltage, and implement the bypass operation for each of the more than one modules. Accordingly, failure of each of the modules may be accommodated, thereby providing improved resilience.</p><p id="p-0018" num="0017">In an implementation, the module may comprise a relay operable by the controller to bypass the switching circuit of the module, wherein configuring the module to form a path for AC voltage in the branch that bypasses the DC-link of the module comprises configuring the relay to bypass the switching circuit of the module. The provision of an auxiliary relay for bypassing the switching circuit of the module provides additional resilience to the converter, inasmuch that the module may be bypassed even in a situation where the switching circuit is not sufficiently operable to adopt a bypass configuration. In particular, a relay may be expected to be more mechanically robust than switches of the switching circuit, and may thus be less prone to failure than the switches of the switching circuit. Thus, in this implementation, even if the switches of the switching circuit are inoperative, the module may still be effectively bypassed. Each of the modules may preferably comprise a relay for bypassing the switching circuit of the module.</p><p id="p-0019" num="0018">In an implementation, each of the switching circuits may be configured as an H-bridge. An H-bridge circuit may advantageously exhibit relatively simple control characteristics. In particular, the plural switching devices of an H-bridge circuit may advantageously be controlled by a single common signal.</p><p id="p-0020" num="0019">In an implementation, the cascaded multilevel converter may further comprise a plurality of further modules coupled to form a further branch, each of the plurality of further modules comprising a switching circuit and a DC-link for supplying DC voltage to the switching circuit, and a controller for controlling the switching circuit of each further module to generate an AC voltage in the further branch, wherein the further branch is arranged in parallel to the branch.</p><p id="p-0021" num="0020">In other words, the multilevel converter could be configured as a multiphase multilevel converter, having multiple branches for supplying multiple phases of AC power. The converter could even comprise more than one further branch, for example, two further branches, such that the converter is suitable for supplying three-phase AC power. The controller(s) could be configured to control the switching circuits of the further branches in the same mode as the mode of controlling the switching circuits of the modules of the branch. The controller could comprise a common system for controlling the switching circuits of each of the branch and the further branches.</p><p id="p-0022" num="0021">In an implementation, each of the branch and the one or more further branches may have the same number of modules. In a multiphase system the power supplied by each of the phases is typically mutually the same. Employing a same number of modules to meet the power demand in each phase may advantageously simplify the design and control of the system.</p><p id="p-0023" num="0022">In an implementation, the reference power value for each module may be determined using a digital filter.</p><p id="p-0024" num="0023">In an implementation, the controller may be configured to compare the reference power value to a threshold power value and implement an anti-windup operation if the reference power value exceeds the threshold power value. In other words, if the DC-link controller reports an unfeasibly high-power demand, it may be inferred that the operation of the Dc-link controller is impaired, and the anti-windup operation may thus involve resetting the memory of the digital filter. For example, the threshold power value could be a predetermined value stored in memory of the controller representing an expected upper threshold power demand for the particular application, and the controller may be configured to compare the reference power value per module to the threshold value.</p><p id="p-0025" num="0024">A second aspect of the present disclosure provides a method of controlling a cascaded multilevel converter comprising a plurality of modules coupled to form a branch, each of the modules comprising a switching circuit and a DC-link for supplying DC voltage to the switching circuit, the method comprising: determining for each module a voltage across a capacitor of the DC-link of the module, determining for each module a reference power value for charging the capacitor of the DC-link of the module to a reference voltage value for the module, determining, from the reference power values of the modules, a common reference AC current value for AC current in the branch, determining from the common reference AC current value, a common reference AC voltage value for AC voltage in the branch, determining for each module a reference AC voltage value using the common reference AC voltage value and the reference power value for the module, and generating a pulse width modulation signal for controlling the switching circuit of each module based on the reference AC voltage value for the module and the voltage across the capacitor of the module.</p><p id="p-0026" num="0025">A third aspect of the present disclosure provides a controller for controlling a cascaded multilevel converter to generate an AC voltage in an output branch, wherein the controller is configured to: determine for each module of the converter a voltage across a capacitor of a DC-link of each module, determine for each module a reference power value for charging a capacitor of the DC link of the module to a reference voltage value for the module, determine, from the reference power values of the modules, a common reference AC current value for AC current in the branch, determine, from the common reference AC current value, a common reference AC voltage value for AC voltage in the branch, determine for each module a reference AC voltage value using the common reference AC voltage value and the reference power value for the module, and generate a pulse width modulation signal for controlling a switching circuit of each module based on the reference AC voltage value for the module and the voltage across the capacitor of the module.</p><p id="p-0027" num="0026">These and other aspects of the disclosure will be apparent from the embodiment(s) described below.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0028" num="0027">In order that the present disclosure may be more readily understood, embodiments of the disclosure will now be described, by way of example, with reference to the accompanying drawings, in which:</p><p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows schematically an example of a solid-state transformer comprising a cascaded H-bridge (CHB) multilevel converter embodying an aspect of the disclosure;</p><p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows schematically an inverter module of the CHB multilevel converter identified in <figref idref="DRAWINGS">FIG. <b>1</b></figref> comprising a DC-link for suppling DC voltage to a switching circuit of the module;</p><p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. <b>3</b></figref> shows schematically an equivalent circuit representation of the inverter module identified in <figref idref="DRAWINGS">FIG. <b>2</b></figref>;</p><p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a block diagram showing schematically a control scheme for controlling the operation of the multilevel converter;</p><p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a block diagram showing schematically a control scheme for regulating the voltage of the DC-link for each inverter module;</p><p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a graphical representation of simulated DC-link voltage characteristics achieved by the control scheme depicted in <figref idref="DRAWINGS">FIG. <b>4</b></figref>;</p><p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a graphical representation of simulated DC-link voltage characteristics achieved by the control scheme depicted in <figref idref="DRAWINGS">FIG. <b>4</b></figref> under a fault condition; and</p><p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a block diagram showing schematically an alternative control scheme for regulating the voltage of the DC-link for each inverter module.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION</heading><p id="p-0037" num="0036">A cascaded multilevel converter embodying an aspect of the present disclosure is illustrated schematically in the Figures.</p><p id="p-0038" num="0037">Referring firstly to <figref idref="DRAWINGS">FIG. <b>1</b></figref>, outputs of a solid-state transformer <b>101</b> are coupled to a three-phase power transmission grid <b>102</b> comprising grid conductors <b>103</b>, <b>104</b> and <b>105</b> for conducting &#x2018;a&#x2019;, &#x2018;b&#x2019; and &#x2018;c&#x2019; phases respectively of electrical current. The solid-state transformer <b>102</b> comprises a multilevel converter <b>107</b> for converting plural DC voltage sources <b>108</b>, <b>109</b> and <b>110</b>, for example provided by discrete outputs of an initial rectifier stage, to AC voltage for supply to the transmission grid <b>102</b>.</p><p id="p-0039" num="0038">The multilevel converter <b>107</b> comprises Q branches, in the example three, <b>111</b>, <b>112</b> and <b>113</b>, for supplying &#x2018;a&#x2019;, &#x2018;b&#x2019; and &#x2018;c&#x2019; phase AC voltages respectively to the grid conductors <b>103</b>, <b>104</b>, <b>105</b> respectively. In the example therefore the multilevel converter <b>107</b> is configured as a three-phase converter for outputting three-phase electrical current. Each branch <b>111</b>, <b>112</b>, <b>113</b> of the converter <b>107</b> is substantially identical in construction. For brevity therefore only branch <b>111</b>, configured for supplying the &#x2018;a&#x2019; phase current to grid conductor <b>103</b>, will be described in detail herein, on the understanding that substantially the same teachings apply to branches <b>112</b> and <b>113</b>, responsible for suppling the &#x2018;b&#x2019; and &#x2018;c&#x2019; phase currents respectively to grid conductors <b>104</b>, <b>105</b> respectively.</p><p id="p-0040" num="0039">Branch <b>111</b> of the multilevel converter <b>107</b> comprises a plurality, M, of inverter modules, such as module <b>1</b> denoted <b>114</b>, module <b>2</b> denoted <b>115</b>, and module M denoted <b>116</b>, having their outputs coupled in series to a common conductor <b>117</b>, such that the AC output voltages of each of the inverter modules <b>114</b> to <b>116</b> sum on the conductor <b>117</b>. A controller <b>118</b> is provided for controlling the operation of each of the inverter modules <b>114</b> to <b>116</b> in the branch <b>111</b>. The plurality of inverter modules <b>114</b> to <b>116</b> are substantially similar in construction, save for practically unavoidable differences resulting from imperfect tolerance in the various components, and are operated in substantially the same way. Again, for brevity therefore only inverter module <b>114</b> will be described in detail herein, on the understanding that substantially the same teachings apply to each of the other M modules in the branch. In the example, the multilevel converter has a three-phase cascaded H-bridge configuration.</p><p id="p-0041" num="0040">Referring to <figref idref="DRAWINGS">FIGS. <b>2</b> and <b>3</b></figref>, each inverter module, such as the inverter module <b>114</b>, comprises a switching circuit, indicated generally at <b>201</b>, a DC-link circuit, indicated generally at <b>202</b>, for supplying DC voltage to the switching circuit from the DC source <b>108</b>, and a bypass switch circuit, indicated generally at <b>204</b>, for bypassing the switching circuit <b>201</b> of the module.</p><p id="p-0042" num="0041">The switching circuit <b>201</b> comprises a plurality, in the example four, power electronics switches <b>205</b>, <b>206</b>, <b>207</b> and <b>208</b>, in an H-bridge configuration. Output terminals <b>209</b>, <b>210</b> are located on opposite branches of the H-bridge switching circuit. As will be understood by the skilled person, by suitable control of the switching sequences of the switches <b>205</b> to <b>208</b> three different voltage levels, +Vdc, &#x2212;Vdc, and 0 Vdc, may be supplied by each module to the common conductor <b>117</b>. Thus, by suitable control of the relative switching sequences of all of the modules in the branch, an AC voltage may be generated on the conductor <b>117</b> having a magnitude that is the sum of the voltage outputs of each of the M inverter modules. In the example, each of the power electronics switches <b>205</b> to <b>208</b> is an insulated-gate bipolar transistor (IGBT). An IGBT is a preferred type of power electronics switch for this application due to its relatively high efficiency, fast switching capability, and high voltage rating. It will be appreciated by the skilled person however that the utility of the disclosure is not limited to any particular type of switch, and alternative power electronics switches could be readily deployed in substitute of the IGBTs <b>205</b> to <b>208</b> in alternative embodiments.</p><p id="p-0043" num="0042">The DC-link circuit <b>202</b> comprises conductors <b>211</b>, <b>212</b> arranged in series with the DC source <b>108</b>, and a DC-link capacitor <b>213</b> coupled between the conductors <b>211</b>, <b>212</b> in parallel with the DC source <b>108</b>. The capacitor <b>213</b> thus acts as a buffer to store energy for supply to the switching circuit <b>201</b> on demand. The DC-link circuit <b>202</b> further comprises a voltage sensor circuit <b>214</b> operable to measure the voltage across the capacitor <b>213</b> and supply a voltage measurement to the controller <b>118</b>.</p><p id="p-0044" num="0043">The bypass switch circuit <b>204</b> is coupled between the output terminals <b>209</b>, <b>210</b> of the switching circuit <b>201</b>. The bypass switch circuit <b>201</b> comprises a relay <b>215</b>, that is operable, for example, under the control of controller <b>118</b>, to controllably make and break the bypass switch circuit <b>204</b>, to thereby controllably bypass the switching circuit <b>201</b> of the module <b>114</b>. The bypass switch circuit <b>204</b> is thus operable to bypass the switching circuit <b>201</b> and form an alternative path for current flowing in the conductor <b>117</b>. Bypassing the switching circuit <b>201</b> may be desirable where the switching circuit <b>201</b> is experiencing a fault condition, for example, where one or more of the switches <b>205</b> to <b>208</b> has failed, to thereby isolate the faulty switching circuit <b>201</b> from the conductor <b>117</b>.</p><p id="p-0045" num="0044">The controller <b>118</b> is coupled to the power electronics switches <b>205</b> to <b>208</b> of the switching module <b>201</b> of each of the M inverter modules <b>114</b> to <b>116</b> in each of the Q branches <b>111</b> to <b>113</b> of the multilevel converter <b>107</b>. The controller <b>118</b> is thus operable to control the switching circuit <b>201</b> of each module <b>114</b> to thereby control the output AC voltage of each branch <b>111</b>. In the example, the various functions of the controller <b>118</b> are carried out by common or co-located computing devices, but it will be appreciated that the functions could alternatively be carried out by mutually remote computing devices in communication with one another.</p><p id="p-0046" num="0045">Referring to <figref idref="DRAWINGS">FIGS. <b>4</b> and <b>5</b></figref> collectively, the proposed control scheme implemented by the controller is represented schematically using the nomenclature shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>.</p><p id="p-0047" num="0046">The controller <b>118</b> implements four main control processes. In summary, at block <b>401</b> a reference power value for each module of each branch is calculated, the reference power value defining the magnitude of a power demanded by each DC-link to charge the DC-link capacitor to a, predetermined, reference voltage; at block <b>402</b> a current reference value is generated for each of the Q branches of the converter, the current reference value defining the average current demanded per module; at block <b>403</b> an individual AC voltage reference is determined for each module; and at block <b>404</b> a pulse width modulation signal is generated for controlling the switching circuit of each module in dependence on the individual AC voltage reference per module and the determined voltage across the capacitor of the module.</p><p id="p-0048" num="0047">Block <b>401</b> of the controller <b>118</b> represents plural, Q&#xd7;M (i.e. the number of branches Q of the converter multiplied by the number of modules M in each branch), DC-link energy controllers for controlling the energy stored in the capacitor <b>213</b> of the DC-link of each of the M inverter modules of each of the Q branches of the multilevel converter <b>107</b>. The functions of each of the Q&#xd7;M DC-link energy controllers are depicted in <figref idref="DRAWINGS">FIG. <b>5</b></figref>. Referring to <figref idref="DRAWINGS">FIG. <b>5</b></figref>, the inputs to each DC-link energy controller <b>401</b> are the Q&#xd7;M DC-link voltage measurements (vdc,q,m matrix), which may for example be measured using the voltage sensor circuit <b>214</b> of each module <b>114</b>, reference values for the Q&#xd7;M Dc-link voltages (vrefq,m matrix), grid voltages (eq vector), and ac currents (iq vector). In the example, the reference values for the Q&#xd7;M dc-link voltages (vrefq,m matrix) are represented as an input to the DC-link energy controllers <b>401</b>. For example, the voltage reference values could be received from a dedicated memory of the controller <b>118</b> external to the DC-link energy controllers <b>401</b>. Alternatively however the reference values could be predefined in internal memory of the DC-link energy controllers <b>401</b>.</p><p id="p-0049" num="0048">Referring in particular to <figref idref="DRAWINGS">FIG. <b>5</b></figref>, before the closed-loop operation, both the measured voltage signals (vdc,q,m matrix) and the reference voltage signals (vrefq,m matrix) are squared. By this operation the inputs of the closed-loop operation are variables linearly proportional to the energy stored in the dc-link capacitors, which is given by the equation Edc=C/2 vdc2, where C is the capacitance value.</p><p id="p-0050" num="0049">It should be appreciated in this regard that, due for example to tolerance in capacitor components, the real value of C may not be accurately known. However, in the proposed closed-loop mode of operation this error is not problematic, as the C/2 term is included in the loop gains of the closed-loop operation Kqm(kTs), and the squared value w=vdc(t)2, or a variable mathematically equivalent to vdc(t)2, is the controlled variable. This feedback linearization technique thus calculates, on-demand, the power demanded by each dc-link to charge the dc-link capacitor to the reference voltage (vrefq,m matrix).</p><p id="p-0051" num="0050">The output of each DC-link controller <b>401</b> is a reference power value. This reference power value is used by block <b>402</b> for reference current generation and current control, and by block <b>403</b> for individual reference AC voltage calculations.</p><p id="p-0052" num="0051">Referring secondly to block <b>402</b>, in a first step, the current reference is constructed per branch, i.e. all the individual power references, from the working modules in the branch, are summed to obtain a total branch power demand given by Prefq. Subsequently, active current amplitude is calculated by the equation: |irefq|=Gq Prefq/|eF|, where Gq is a gain factor, and |eF| is the amplitude of the AC grid voltage. In practice, Gq=2 is selected, since in steady state the power per branch is Pq (dc)=|iq&#x2225;eF|/2.</p><p id="p-0053" num="0052">Next, the current amplitude is multiplied by a sinusoidal signal in-phase with the fundamental component of voltage in the same branch, as defined by the phase-locked loop (PLL) block <b>405</b>. The angle of this signal can be defined in many equivalent forms, for example, (i) Q individual single-phase synchronization algorithms can synchronize independently, or (ii) using synchronization techniques that track the positive main component dq-PLL. The result from this operation is a vector of AC reference currents irefq, which feed the current control loops. Various suitable alternative PLL synchronization methods for performing the same function will be well known to the skilled person. The amplitude of the AC grid voltage |eF| can also be estimated by a PLL.</p><p id="p-0054" num="0053">The current controller block <b>402</b> thus functions as a closed loop controller that aims to follow its current references (Q=1, 2, 3, . . . references in a single/multiphase system). The control action variable, defined per branch, is the total AC branch voltage vq reference. The current control loop may optionally use information defining the grid voltage as a feed-forward.</p><p id="p-0055" num="0054">Once vq reference is calculated by the closed-loop control algorithm, this value is divided over prefq, giving rise to the variable defining the inverse average current per module (irefq,m)&#x2212;1. It will be appreciated that the (irefq,m)&#x2212;1 value is directly proportional to the entire branch voltage, but is entirely independent of how this voltage is shared among the modules. This thus advantageously provides a natural decoupling action of the dynamics between modules of a branch.</p><p id="p-0056" num="0055">Referring next to block <b>403</b>, the power demanded by each module is also used to calculate the reference AC voltage values for the PWM block <b>404</b>.</p><p id="p-0057" num="0056">The individual voltage references are obtained from the inverse average current variable, which is common to all modules in the same branch, and the individual power demand of each module. The voltage reference per module is then given by the equation: vrefq,m=(irefq,m)&#x2212;1 prefq,m. The module voltages are then set at the module level using vrefq,m as a PWM input. The DC-link voltages, represented in matrix form as vrefdc,q,m, are typically employed to calculate the module duty cycles, i.e. the AC voltage reference divided by the DC-link voltage, which gives a normalized duty cycle, thereby avoiding any cross-coupling in the circuit. That is to say, by this method each module only uses its own DC-link voltage value.</p><p id="p-0058" num="0057">This operation takes into account that the power demanded by each DC-link load is proportional to the ac voltage, the current is common to all modules in the branch, so the only degree if freedom to feed the dc-link with the required power is by acting at the module level on the AC voltage references.</p><p id="p-0059" num="0058">Referring finally to block <b>406</b>, the proposed operation of the converter can be referred to as &#x201c;active sharing operation&#x201d;, because the module voltages are a function of real-time power consumption. It will be appreciated however, that this mode of operation is only practicable in conditions where all modules of the same branch have power demands of the same sign, i.e. where all modules of a branch demand a positive input power, or otherwise, all negative.</p><p id="p-0060" num="0059">This defines a necessary condition to enable the control scheme depicted in <figref idref="DRAWINGS">FIG. <b>4</b></figref>. In practice, this condition is fulfilled in normal operation of the system, since in ideal conditions all the modules are sized to share equally the total power available in the dc supply side. However, in practice the operation of a system may deviate from an ideal operation, and thus the system should be capable of accommodating such a deviation.</p><p id="p-0061" num="0060">Thus, at block <b>406</b> a comparison is made between the power demands of each of the modules to determine whether each of the modules has a power demand of the same sign. If the determination is in the affirmative, i.e. if the modules do all have a power demand of the same sign, the voltage reference per module vrefq,m is used in the generation of the pulse width modulation signal by the block <b>404</b>. In contrast, if it is determined that the power demands of the modules do not have the sign, i.e. if one module demands a positive power and another module a negative power, the voltage reference per module vrefq,m is substituted by a value representing an average of the total branch voltage, i.e. set by the function vrefq/M, where M is the number of modules in the branch, to thereby avoid spurious operation of the converter.</p><p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. <b>6</b></figref> shows simulation results for a multilevel converter as depicted in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, where Q=3 and M=12.</p><p id="p-0063" num="0062">In the simulation the reference working value for each of the DC-link capacitances is set as 1000 Volts, and the capacitance values are randomly assigned within a 20% tolerance of a nominal capacitance value. When loads are connected, at T=1 second, the consumption of the loads are randomly assigned with a 20% tolerance.</p><p id="p-0064" num="0063">During an initial period of operation, from T=0 seconds to T=1 second, an initial sequence is simulated of pre-charging, first activation of the PWM controllers, and a light load operation with active-sharing deactivated. In a subsequent period of operation, beginning at T=1 second, the active-sharing mode of operation is activated under full-load conditions. As will be observed, with active sharing conditions enabled, an average zero error between DC-link voltages is achieved. The simulation thus proves the fast and robust adaptation of the converter when the active-sharing mode of operation is enabled.</p><p id="p-0065" num="0064"><figref idref="DRAWINGS">FIG. <b>7</b></figref> shows simulation results for a multilevel converter as depicted in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, using the same parameters as the simulation depicted in <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0066" num="0065">In this second simulation, after an initial period of light-load operation in which the DC-link voltage controller reference value is set as vrefq/M, i.e. where the reference value is an average of the total branch voltage, at T=0.5 seconds a load is connected and the active-sharing mode of operation is enabled. As will be observed, upon initiation of the active sharing mode of operation, the DC-link voltage error tends quickly towards zero, reaching zero at approximately T=0.6 seconds. At approximately T=0.6 seconds a fault condition is simulated, in which the voltage sensor of the module M=1 reports a 0 Volt measurement, thereby resulting in faulty operation of the associated dc-link controller. The fault condition has the effect of causing the dc-link controller to demand a power consumption above a threshold for charging the dc-link capacitor of the module M=1.</p><p id="p-0067" num="0066">The controller <b>118</b> is operable in response to the faulty condition to enact a bypass operation in which the switching circuit <b>201</b> of the module <b>114</b> is bypassed. In the example, the bypass operation is achieved by closing the relay <b>215</b> of the bypass switching circuit to thereby form a short-circuit for current in the branch around the switching circuit of the faulty module. As can be observed, the DC-link capacitor of the faulty module is then discharged, and the operation of the remaining M&#x2212;1 modules are unaffected. It can thus be observed from the response of the system to the failure of module M=1 that the operation of each module is highly decoupled from the operation of other modules in the branch.</p><p id="p-0068" num="0067"><figref idref="DRAWINGS">FIG. <b>8</b></figref> shows the implementation of the DC-link energy controller considering a multi-task, where two different control samples are considered now Ts<b>1</b> and Ts<b>2</b>, where Ts<b>1</b>&#x3c;Ts<b>2</b>.</p><p id="p-0069" num="0068">It will be understood that the nature of the digital controller implementation of the plural Q&#xd7;M DC-link controllers <b>401</b> allows different tasks of the control to be shared among different physical devices. However, such task-sharing may cause latencies in communication between the different devices, which may in turn result in delays in the control system. In practice therefore it may be desirable that the current control task is implemented by a device that has information from all power references in the same branch. However, the duty cycle calculation can be made at the module level. Implementing duty cycle calculations at the module level may be relatively faster, since communication between different devices is avoided.</p><p id="p-0070" num="0069">Although the present disclosure and its advantages have been described in detail, it should be understood that various changes, substitutions and alterations can be made herein without departing from the spirit and scope of the disclosure as defined by the appended claims. In the claims, the word &#x201c;comprising&#x201d; does not exclude other elements or steps, and the indefinite article &#x201c;a&#x201d; or &#x201c;an&#x201d; does not exclude a plurality.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A cascaded multilevel converter comprising a plurality of modules coupled to form a branch, each of the modules comprising a switching circuit and a DC link for supplying DC voltage to the switching circuit, and a controller for controlling the switching circuit of each module to generate an AC voltage in the branch, wherein the controller is configured to:<claim-text>determine for each module a voltage across a capacitor of the DC link of the module,</claim-text><claim-text>determine for each module a reference power value for charging the capacitor of the DC link of the module to a reference voltage value for the module,</claim-text><claim-text>determine, from the reference power values of the modules, a common reference AC current value for AC current in the branch,</claim-text><claim-text>determine, from the common reference AC current value, a common reference AC voltage value for AC voltage in the branch,</claim-text><claim-text>determine for each module a reference AC voltage value using the common reference AC voltage value and the reference power value for the module, and</claim-text><claim-text>generate a pulse width modulation signal for controlling the switching circuit of each module based on the reference AC voltage value for the module and the voltage across the capacitor of the module.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the reference voltage value for each module is a predetermined value stored in memory in the controller.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the reference power value for each module is determined based on a difference between squared values of the voltage across the capacitor of the DC link of the module and the reference voltage value for the module.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the reference power value for each module is determined based on a difference between squared values of the voltage across the capacitor of the DC link of the module and the reference voltage value for the module.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the controller comprises a reference current control device configured to receive the reference power values for each of the plurality of modules and determine the common reference AC current value.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the controller comprises a reference current control device configured to receive the reference power values for each of the plurality of modules and determine the common reference AC current value.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the controller comprises a reference current control device configured to receive the reference power values for each of the plurality of modules and determine the common reference AC current value.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the controller comprises a plurality of switching circuit control devices each configured to receive the reference AC voltage value of one of the plurality of modules and control the switching circuit of that module.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the controller is configured to:<claim-text>control the switching circuits of each module in accordance with an initial mode of operation,</claim-text><claim-text>determine the power demands of each of the modules,</claim-text><claim-text>determine whether each of the modules has a power demand of the same sign, and</claim-text><claim-text>control the switching circuits of each module in accordance with the method if each of the modules has a power demand of the same sign.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the controller is further configured to compare the voltage of at least one of the modules to a predetermined threshold voltage, and in response to the voltage of the module being higher or lower than the threshold voltage configure the module to form a path for AC voltage in the branch that bypasses the DC link of the module.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the module further comprises a relay operable by the controller to bypass the switching circuit of the module, wherein configuring the module to form a path for AC voltage in the branch that bypasses the DC link of the module comprises configuring the relay to bypass the switching circuit of the module.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein each of the switching circuits is configured as an H-bridge.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising a plurality of further modules coupled to form a further branch, each of the plurality of further modules comprising a switching circuit and a DC link for supplying DC voltage to the switching circuit, and a controller for controlling the switching circuit of each further module to generate an AC voltage in the further branch, wherein the further branch is arranged in parallel to the branch.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein each of the branch and the one or more further branches has the same number of modules.</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the reference power value for each module is determined using a digital filter.</claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. A cascaded multilevel converter as claimed in <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the controller is configured to compare the reference power value to a threshold power value and implement an anti-windup operation if the reference power value exceeds the threshold power value.</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. A method of controlling a cascaded multilevel converter comprising a plurality of modules coupled to form a branch, each of the modules comprising a switching circuit and a DC link for supplying DC voltage to the switching circuit, the method comprising:<claim-text>determining for each module a voltage across a capacitor of the DC link of the module,</claim-text><claim-text>determining for each module a reference power value for charging the capacitor of the DC link of the module to a reference voltage value for the module,</claim-text><claim-text>determining, from the reference power values of the modules, a common reference AC current value for AC current in the branch,</claim-text><claim-text>determining from the common reference AC current value, a common reference AC voltage value for AC voltage in the branch,</claim-text><claim-text>determining for each module a reference AC voltage value using the common reference AC voltage value and the reference power value for the module, and</claim-text><claim-text>generating a pulse width modulation signal for controlling the switching circuit of each module based on the reference AC voltage value for the module and the voltage across the capacitor of the module.</claim-text></claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. A controller for controlling a cascaded multilevel converter to generate an AC voltage in an output branch, wherein the controller is configured to:<claim-text>determine for each module of the converter a voltage across a capacitor of a DC link of each module,</claim-text><claim-text>determine for each module a reference power value for charging a capacitor of the DC link of the module to a reference voltage value for the module,</claim-text><claim-text>determine, from the reference power values of the modules, a common reference AC current value for AC current in the branch,</claim-text><claim-text>determine, from the common reference AC current value, a common reference AC voltage value for AC voltage in the branch,</claim-text><claim-text>determine for each module a reference AC voltage value using the common reference AC voltage value and the reference power value for the module, and</claim-text></claim-text><claim-text>generate a pulse width modulation signal for controlling a switching circuit of each module based on the reference AC voltage value for the module and the voltage across the capacitor of the module.</claim-text></claim></claims></us-patent-application>