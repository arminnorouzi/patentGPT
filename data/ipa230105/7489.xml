<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007490A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007490</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17364740</doc-number><date>20210630</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>128</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>122</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>106</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>128</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>122</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>106</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">NGFW (NEXT GENERATION FIREWALL) SECURITY INSPECTION OVER MULTIPLE SESSIONS OF MESSAGE SESSION RELAY PROTOCOL (MSRP) ON A DATA COMMUNICATION NETWORK</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Fortinet, Inc.</orgname><address><city>Sunnyvale</city><state>CA</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Boreham</last-name><first-name>Douglas Malcolm</first-name><address><city>Kearny</city><state>NJ</state><country>US</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">One or more MSRP data packets are received from a first MSRP session and creates a first log entry. One or more MSRP data packets are also received from a second MSRP session and create a second log entry. A correlation between the first and second MSRP sessions based on MDNs can be detected, and mapped correlating information to malicious activity. The mapping includes reconstructing MSRP messages sent from a source and encapsulated in a data field of the packets, including MDNs, and matching to at least one threat from a malicious activity database. In response to the threat matching, to conduct a security action on the first and second MSRP sessions.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="155.70mm" wi="98.72mm" file="US20230007490A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="129.71mm" wi="178.73mm" file="US20230007490A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="136.65mm" wi="155.62mm" file="US20230007490A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="179.75mm" wi="100.75mm" file="US20230007490A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="174.07mm" wi="155.36mm" file="US20230007490A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="162.22mm" wi="165.18mm" file="US20230007490A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">FIELD OF THE INVENTION</heading><p id="p-0002" num="0001">The invention relates generally to computer networking, and more specifically, to a NGFW (next generation firewall) scrutinizing across a plurality of MSRP text message sessions to identify malicious activity.</p><heading id="h-0002" level="1">BACKGROUND</heading><p id="p-0003" num="0002">Text to 911 and Next-Generation 911 systems are available on large cellular providers (e.g., AT&#x26;T, Sprint, T-Mobile and Verizon) and are being rolled out by many Emergency Services/First Responder providers around the globe in conjunction with a SIP (session initiation protocol) architecture. These Emergency Services/First Responder systems provide a life-critical service to local communities around the world, including police, fire, and ambulance dispatch, as well to report terrorist attacks and mass casualty events. They enable PSAPs to perform call transfer and data sharing and allow them to accept calls from mobile, text and voice applications. Text to 911 is critical in situations when a voice call would be dangerous, for young people that prefer text communication, and when anonymity of text makes a caller choose it over voice. A failure of these systems could be catastrophic to the local community it serves.</p><p id="p-0004" num="0003">For example, NextGen 911 are vulnerable to code snippets, such as SQL injection, malicious URL or file attachments, man-in-the-middle attacks, DoS attacks, and unauthorized network access to name a few. The systems that process the MSRP traffic are proprietary and self-contained, and it is therefore not possible to perform security inspection after this traffic has been decoded by TCCs (text control centers). As a result, it is possible for MSRP to tunnel malware to the end station and potentially infect or otherwise compromise its integrity. MSRP is defined by RFC 4975 as an instant message protocol for sharing messages as well as other data within attachments. It is used to facilitate large-scale instant messaging. MSRP can act as stand-alone protocol but is also often negotiated via SIP/SDP (message type) similar to the way RTP is negotiated.</p><p id="p-0005" num="0004">Additionally, these Emergency Services/First Responder systems have limited processing power, and they are vulnerable to Denial of Service (DoS)/Distributed Denial of Service (DDoS) attacks. Often these DoS/DDoS attacks take the form of repeated text messages that are being transmitted far faster than a human sending text messages can produce.</p><p id="p-0006" num="0005">Therefore, what is needed is a robust technique for scrutinizing across a plurality MSRP text message sessions to identify malicious activity.</p><heading id="h-0003" level="1">SUMMARY</heading><p id="p-0007" num="0006">These shortcomings are addressed by the present disclosure of methods, computer program products, and systems for scrutinizing across a plurality of MSRP text message sessions to identify malicious activity.</p><p id="p-0008" num="0007">In one embodiment, a first module receives one or more MSRP data packets from a first MSRP session and creates a first log entry. The first module also receives one or more MSRP data packets from a second MSRP session and create a second log entry. A second module detects a correlation between the first and second MSRP sessions based on MDNs, and maps correlating information to malicious activity. The mapping includes reconstructing MSRP messages sent from a source and encapsulated in a data field of the packets, including MDNs, and matching to at least one threat from a malicious activity database.</p><p id="p-0009" num="0008">In another embodiment, a third module, in response to the threat matching, to conduct a security action on the first and second MSRP sessions. For example, text message rates can be controlled by MDN (mobile device number) to correlate attacks on the system spread out over multiple MSRP sessions.</p><p id="p-0010" num="0009">Advantageously, network performance and computer network performance are improved by increased protection to MSRP sessions and E911 call centers.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0011" num="0010">In the following drawings, like reference numbers are used to refer to like elements. Although the following figures depict various examples of the invention, the invention is not limited to the examples depicted in the figures.</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>1</b></figref> are high-level block diagrams illustrating a system for scrutinizing across multiple MSRP text message sessions to identify malicious activity, according to one embodiment.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a more detailed block diagram illustrating a gateway device of the system of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, according to an embodiment.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a more detailed block diagram illustrating a MSRP attack prevention module of the gateway device of <figref idref="DRAWINGS">FIG. <b>2</b></figref>, according to an embodiment.</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a high-level flow diagram illustrating a method for scrutinizing across a plurality MSRP text message sessions to identify malicious activity, according to one embodiment.</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a more detailed flow diagram illustrating a step of deploying idle transceivers of MIMO transceiver chains for rapid connection of Wi-Fi clients of the method of <figref idref="DRAWINGS">FIG. <b>4</b></figref>, according to an embodiment.</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a block diagram illustrating an example computing device for malicious activity detection techniques, according to one embodiment.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0005" level="1">DETAILED DESCRIPTION</heading><p id="p-0018" num="0017">The description below provides methods, computer program products, and systems for scrutinizing across multiple MSRP text message sessions to identify malicious activity. One of ordinary skill in the art will recognize many additional variations made possible by the succinct description of techniques below.</p><heading id="h-0006" level="1">I. Systems for Multiple MSRP Text Message Session Attack Prevention (FIG. <b>1</b>-<b>2</b>)</heading><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>1</b></figref> are high-level block diagrams illustrating a system <b>100</b> for scrutinizing across multiple MSRP text message sessions to identify malicious activity, according to one embodiment. The system <b>100</b> includes a gateway device <b>110</b>, a session border controller <b>120</b>, a switch <b>130</b>, and E911 terminals <b>140</b>A-C. Many other embodiments are possible, for example, with more or fewer access points, more or fewer stations, and additional components, such as firewalls, routers and switches. Hardware and software components can be implemented similar to the example of <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0020" num="0019">A wide area network <b>199</b> links components of the system <b>100</b> with a channel for data communication. The gateway device <b>110</b>, the session border controller <b>120</b>, the switch <b>130</b> and the terminals <b>140</b> are preferably connected to the wide area network <b>199</b> via hardwire.</p><p id="p-0021" num="0020">The gateway device <b>110</b>, in one embodiment, filters data messages flowing into and out of the network <b>199</b> including MSRP data sessions from E911 text messages headed to PSAPs (public safety answering points), for malicious attacks. As a result, a single attack spread over different telephone numbers can be identified, such as code snippets, SQL injection, malicious URL or file attachments, and the like. The MSRP messages can be sent from a mobile telephone <b>150</b> across a cellular network to an SMSC (short message center) <b>170</b> to a TCC (text control center). The TCC can combine the SMSC message sent over SMPP, a location sent by a commercial location server over MLP, and a SMSC (multimedia message center) message from an ESRP (Emergency Services Routing Proxy). The ESRP conducts uninspected SIP and MSRP sessions with the gateway device <b>110</b>. The uninspected sessions are then scrutinized for malicious behavior using a common telephone number or MDN before allowing messages to proceed to the E911 call center. The gateway device <b>110</b> is described in more detail below.</p><p id="p-0022" num="0021">The session border converter <b>120</b> can connect support multiple concurrent MSRP and SIP sessions connected through the switch <b>130</b> to the terminals <b>140</b>.</p><p id="p-0023" num="0022">The E911 terminals <b>140</b>A-C allow communication between a dispatch officer and a user of cell phone <b>150</b>. The communication can be completely by back-and-forth text. The communication can also switch from text to a telephone call over a cellular or VOIP network.</p><p id="p-0024" num="0023">The network components of the system <b>100</b> can implemented in any of the computing devices discussed herein, for example, a personal computer, a laptop computer, a tablet computer, a smart phone, a smart watch, a mobile computing device, a server, a cloud-based device, a virtual device, an Internet appliance, an IoT (Internet of things) device, or any of the computing devices described herein, using hardware and/or software (see e.g., <figref idref="DRAWINGS">FIG. <b>6</b></figref>).</p><p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a more detailed block diagram illustrating the gateway device <b>110</b> of the system <b>100</b>, according to an embodiment. The gateway device <b>110</b> comprises a packet processing queue <b>210</b>, a network policy module <b>220</b>, a NGFW module <b>230</b>, and a network communication interface <b>240</b>. Many other variations are possible. The components can be implemented in hardware, software, or a combination of both.</p><p id="p-0026" num="0025">Inbound and outbound packets are stored in the packet processing queue <b>210</b> for scrutinizing before passing in or out of an enterprise network. The network policy module <b>220</b> implements rules set by administrators and automatically by the system <b>100</b>. The network communication interface <b>240</b> provides a connection port to the communication channel and protocol support for packetizing data.</p><p id="p-0027" num="0026">In <figref idref="DRAWINGS">FIG. <b>3</b></figref>, one embodiment of the NGFW module <b>230</b> is shown in more detail. The NGFW module <b>230</b> includes a MSRP packet session module <b>310</b>, an MDN (mobile device number) correlation module <b>320</b>, and a security action module <b>330</b>.</p><p id="p-0028" num="0027">The MSRP packet session module <b>210</b>, in an embodiment, receive one or more MSRP data packets from a first MSRP session and create a first log entry, receives one or more MSRP data packets from a second MSRP session and create a second log entry.</p><p id="p-0029" num="0028">The MDN correlation module <b>220</b> comprises an MSRP decoder to detect a correlation between the first and second MSRP sessions based on MDNs, and map correlating information to malicious activity. The mapping includes reconstructing MSRP messages sent from a source and encapsulated in a data field of the packets, including MDNs, and matching to at least one threat from a malicious activity database. For example, a DoS attack can be identified as generating MSRP messages much faster than a human can type and block actual E911 calls.</p><p id="p-0030" num="0029">The security action module <b>230</b>, in response to the threat matching, conducts a security action on the first and second MSRP sessions. In one instance, rate limiting is implemented for MSRP messages overall, message rate control on SIP and MSRP based on MDN, text messages are inspected for malware-based attacks such as XSS (cross-site scripting) and SQL injection, embedded URL and files are inspected for malicious components, IPS signature sets are applied to MSRP traffic, and detection and flagging of repeated MSRP messages.</p><heading id="h-0007" level="1">II. Methods for Multiple MSRP Text Message Session Attack Prevention (FIGS. <b>4</b>-<b>5</b>)</heading><p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a high-level flow diagram illustrating a method for scrutinizing across a plurality MSRP text message sessions to identify malicious activity, according to one embodiment. The method <b>400</b> can be implemented, for example, by the system <b>100</b> of <figref idref="DRAWINGS">FIG. <b>1</b></figref>. The steps are merely representative groupings of functionality, as there can be more or fewer steps, and the steps can be performed in different orders. Many other variations of the method <b>400</b> are possible.</p><p id="p-0032" num="0031">At step <b>410</b>, one or more MSRP data packets is received from a first MSRP session and create a first log entry, and to receive the one or more MSRP data packets from a second MSRP session and create a second log entry.</p><p id="p-0033" num="0032">At step <b>420</b>, a correlation is detected between the first and second MSRP sessions based on MDNs, and map correlating information to malicious activity. The mapping includes reconstructing MSRP messages sent from a source and encapsulated in a data field of the packets, including MDNs, and matching to at least one threat from a malicious activity database.</p><p id="p-0034" num="0033">As shown in more detail in <figref idref="DRAWINGS">FIG. <b>5</b></figref>, step <b>420</b> can be implemented at step <b>510</b>, in which MSPR messages are decoded. At step <b>520</b>, messages are temporarily queued by MDN. At step <b>530</b> string of messages for the same MDN can be reconstructed and tested for malicious activity by comparison to a database of known malicious activity.</p><p id="p-0035" num="0034">Referring again to <figref idref="DRAWINGS">FIG. <b>4</b></figref>, at step <b>430</b>, in response to the threat matching, a security action is conducted on the first and second MSRP sessions.</p><heading id="h-0008" level="1">III. Generic Computing Device for MSRP Attack Prevention (FIG. <b>6</b>)</heading><p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a block diagram illustrating an example computing device <b>600</b> for use in the system <b>100</b> of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, according to one embodiment. The computing device <b>600</b> is implementable for each of the components of the system <b>100</b> including the gateway device <b>110</b>, the session border controller <b>120</b>, the switch <b>130</b>, and the terminals <b>140</b>. The computing device <b>600</b> can be a mobile computing device, a laptop device, a smartphone, a tablet device, a phablet device, a video game console, a personal computing device, a stationary computing device, a server blade, an Internet appliance, a virtual computing device, a distributed computing device, a cloud-based computing device, or any appropriate processor-driven device.</p><p id="p-0037" num="0036">The computing device <b>600</b>, of the present embodiment, includes a memory <b>610</b>, a processor <b>620</b>, a storage drive <b>630</b>, and an I/O port <b>640</b>. Each of the components is coupled for electronic communication via a bus <b>699</b>. Communication can be digital and/or analog and use any suitable protocol.</p><p id="p-0038" num="0037">The memory <b>610</b> further comprises network applications <b>612</b> and an operating system <b>614</b>. The network applications <b>612</b> can include a web browser, a mobile application, an application that uses networking, a remote application executing locally, a network protocol application, a network management application, a network routing application, or the like.</p><p id="p-0039" num="0038">The operating system <b>614</b> can be one of the Microsoft Windows&#xae; family of operating systems (e.g., Windows 96, 98, Me, Windows NT, Windows 2000, Windows XP, Windows XP x64 Edition, Windows Vista, Windows CE, Windows Mobile, Windows 6 or Windows 8), Linux, HP-UX, UNIX, Sun OS, Solaris, Mac OS X, Alpha OS, AIX, IRIX32, IRIX64, or Android. Other operating systems may be used. Microsoft Windows is a trademark of Microsoft Corporation.</p><p id="p-0040" num="0039">The processor <b>620</b> can be a network processor (e.g., optimized for IEEE 802.11, IEEE 802.11AC or IEEE 802.11AX), a general-purpose processor, an application-specific integrated circuit (ASIC), a field programmable gate array (FPGA), a reduced instruction set controller (RISC) processor, an integrated circuit, or the like. Qualcomm Atheros, Broadcom Corporation, and Marvell Semiconductors manufacture processors that are optimized for IEEE 802.11 devices. The processor <b>620</b> can be single core, multiple core, or include more than one processing elements. The processor <b>620</b> can be disposed on silicon or any other suitable material. The processor <b>620</b> can receive and execute instructions and data stored in the memory <b>610</b> or the storage drive <b>630</b>.</p><p id="p-0041" num="0040">The storage drive <b>630</b> can be any non-volatile type of storage such as a magnetic disc, EEPROM (electronically erasable programmable read-only memory), Flash, or the like. The storage drive <b>630</b> stores code and data for applications.</p><p id="p-0042" num="0041">The I/O port <b>640</b> further comprises a user interface <b>642</b> and a network interface <b>644</b>. The user interface <b>642</b> can output to a display device and receive input from, for example, a keyboard. The network interface <b>644</b> (e.g. RF antennae) connects to a medium such as Ethernet or Wi-Fi for data input and output.</p><p id="p-0043" num="0042">Many of the functionalities described herein can be implemented with computer software, computer hardware, or a combination.</p><p id="p-0044" num="0043">Computer software products (e.g., non-transitory computer products storing source code) may be written in any of various suitable programming languages, such as C, C++, C#, Oracle&#xae; Java, JavaScript, PHP, Python, Perl, Ruby, AJAX, and Adobe&#xae; Flash&#xae;. The computer software product may be an independent application with data input and data display modules. Alternatively, the computer software products may be classes that are instantiated as distributed objects. The computer software products may also be component software such as Java Beans (from Sun Microsystems) or Enterprise Java Beans (EJB from Sun Microsystems). Some embodiments can be implemented with artificial intelligence.</p><p id="p-0045" num="0044">Furthermore, the computer that is running the previously mentioned computer software may be connected to a network and may interface with other computers using this network. The network may be on an intranet or the Internet, among others. The network may be a wired network (e.g., using copper), telephone network, packet network, an optical network (e.g., using optical fiber), or a wireless network, or any combination of these. For example, data and other information may be passed between the computer and components (or steps) of a system of the invention using a wireless network using a protocol such as Wi-Fi (IEEE standards 802.11, 802.11a, 802.11b, 802.11e, 802.11g, 802.11i, 802.11n, and 802.11ac, just to name a few examples). For example, signals from a computer may be transferred, at least in part, wirelessly to components or other computers.</p><p id="p-0046" num="0045">In an embodiment, with a Web browser executing on a computer workstation system, a user accesses a system on the World Wide Web (WWW) through a network such as the Internet. The Web browser is used to download web pages or other content in various formats including HTML, XML, text, PDF, and postscript, and may be used to upload information to other parts of the system. The Web browser may use uniform resource identifiers (URLs) to identify resources on the Web and hypertext transfer protocol (HTTP) in transferring files on the Web.</p><p id="p-0047" num="0046">This description of the invention has been presented for the purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise form described, and many modifications and variations are possible in light of the teaching above. The embodiments were chosen and described in order to best explain the principles of the invention and its practical applications. This description will enable others skilled in the art to best utilize and practice the invention in various embodiments and with various modifications as are suited to a particular use. The scope of the invention is defined by the following claims.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>We claim:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A network device on a data communication network for scrutinizing across a plurality MSRP text message sessions to identify malicious activity, the network device comprising:<claim-text>a processor;</claim-text><claim-text>a network interface, communicatively coupled to the data communication network and to a Wi-Fi network; and</claim-text><claim-text>a memory, storing source code comprising:<claim-text>a first module to receive one or more MSRP data packets from a first MSRP session and create a first log entry, and to receive the one or more MSRP data packets from a second MSRP session and create a second log entry;</claim-text><claim-text>a second module to detect a correlation between the first and second MSRP sessions based on MDNs, and map correlating information to malicious activity, wherein the mapping includes reconstructing MSRP messages sent from a source and encapsulated in a data field of the packets, including MDNs, and matching to at least one threat from a malicious activity database; and</claim-text><claim-text>a third module, in response to the threat matching, to conduct a security action on the first and second MSRP sessions.</claim-text></claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The network device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first and second MSRP messages comprise E911 type messages.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The network device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the malicious activity comprises identical messages sourced from distinct MDNs.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The network device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the malicious activity comprises identical messages sourced from the same MDN.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The network device of <claim-ref idref="CLM-00001">claim 1</claim-ref>,<claim-text>detecting time of message field to determine message transmission rate,</claim-text><claim-text>wherein mapping to malicious activity includes an anomaly in the message transmission rate.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The network device of <claim-ref idref="CLM-00001">claim 1</claim-ref>,<claim-text>detecting GPS coordinate field from the first and second MSRP session,</claim-text><claim-text>wherein mapping to malicious activity includes an anomaly between GPS coordinate values</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The network device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein taking the security action comprises at least one of: blocking the messages, notifying a network administrator, notifying the sender or receiver.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. A non-transitory computer-readable media storing source code that, when executed by a processor, performs a computer-implemented method, in a gateway device coupled to a plurality of access points on a data communication network, for scrutinizing across a plurality MSRP text message sessions to identify malicious activity, the method comprising the steps of:<claim-text>receiving one or more MSRP data packets from a first MSRP session and create a first log entry, and to receive the one or more MSRP data packets from a second MSRP session and create a second log entry;</claim-text><claim-text>detecting a correlation between the first and second MSRP sessions based on MDNs, and map correlating information to malicious activity, wherein the mapping includes reconstructing MSRP messages sent from a source and encapsulated in a data field of the packets, including MDNs, and matching to at least one threat from a malicious activity database; and</claim-text><claim-text>in response to the threat matching, conducting a security action on the first and second MSRP sessions.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. A computer-implemented method a gateway device coupled to a plurality of access points on a data communication network, for scrutinizing across a plurality MSRP text message sessions to identify malicious activity, the Wi-Fi controller comprising:<claim-text>receiving one or more MSRP data packets from a first MSRP session and create a first log entry, and to receive the one or more MSRP data packets from a second MSRP session and create a second log entry;</claim-text><claim-text>detecting a correlation between the first and second MSRP sessions based on MDNs, and map correlating information to malicious activity, wherein the mapping includes reconstructing MSRP messages sent from a source and encapsulated in a data field of the packets, including MDNs, and matching to at least one threat from a malicious activity database; and</claim-text><claim-text>in response to the threat matching, conducting a security action on the first and second MSRP sessions.</claim-text></claim-text></claim></claims></us-patent-application>