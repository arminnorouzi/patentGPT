<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007395A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007395</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17808622</doc-number><date>20220624</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="regional"><country>EP</country><doc-number>21183787.7</doc-number><date>20210705</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>R</subclass><main-group>3</main-group><subgroup>04</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>R</subclass><main-group>3</main-group><subgroup>04</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc></classifications-cpc><invention-title id="d2e61">AUDIO PROCESSOR</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>NXP B.V.</orgname><address><city>Eindhoven</city><country>NL</country></address></addressbook><residence><country>NL</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Gautama</last-name><first-name>Temujin</first-name><address><city>Boutersem</city><country>BE</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Macours</last-name><first-name>Christophe Marc</first-name><address><city>Hodelge</city><country>BE</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Hedebouw</last-name><first-name>Bram</first-name><address><city>Heverlee</city><country>BE</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">An audio processor and method of audio processing for an amplifier system is described. The audio processor may receive an audio signal and adapt the audio signal generating a time varying offset. The time varying offset may be combined with the audio signal resulting in a shifted the audio signal level. The processed audio signal may also be clipped to remove the negative samples values. The processed signal may be used to drive an amplifier designed to only accept positive (or negative) signals such as a class C amplifier.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="116.59mm" wi="55.80mm" file="US20230007395A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="223.94mm" wi="143.00mm" file="US20230007395A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="186.61mm" wi="133.52mm" file="US20230007395A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="131.23mm" wi="57.91mm" file="US20230007395A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="132.33mm" wi="57.83mm" file="US20230007395A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">FIELD</heading><p id="p-0002" num="0001">This disclosure relates to an audio processor and method of audio processing for an amplifier system.</p><heading id="h-0002" level="1">BACKGROUND</heading><p id="p-0003" num="0002">A typical audio amplifier is designed to apply positive and negative voltages across an output load which is typically a loudspeaker. This is necessary to reproduce an audio signal, which has an average value of zero, with positive and negative signal values. Typical audio amplifier types are class A, class AB, and class D amplifiers.</p><p id="p-0004" num="0003">Class A amplifiers require the lowest number of active components: only a single transistor. The transistor needs to be appropriately biased by setting its central operating point, which is called the &#x201c;Quiescent Operating Point&#x201d;, or Q-point for short. In a class A amplifier, the transistor is biased so that the Q-point is near the middle of its operating range approximately halfway between the cut-off and saturation points. In this configuration, the output voltage can vary around the Q-point without distortion as the input varies. As a consequence, there is always a DC quiescent current flowing through the transistor even if there is no input signal to amplify. This means that the output load current is approximately the same with and without an audio input signal, making a heatsink necessary in most cases.</p><p id="p-0005" num="0004">A class C amplifier is also a single transistor amplifier but is not used as an audio amplifier because of the high distortion levels. In a class C amplifier the transistor is on only for the positive values of the input signal, and is off for the negative or sub-threshold values. The Q-point is set much lower than for a class A near the cut-off point of the transistor. The net result is roughly that the input signal is negatively limited or clipped to 0 which results in high audio distortion.</p><p id="p-0006" num="0005">Pulse-width-modulation (PWM) can be used to represent an audio signal. PWM encodes the digital sample value by varying a duty cycle of a rectangular wave at a frequency typically much higher than the audio sampling rate. A class D audio amplifier uses a PWM signal at its input to generate an amplified audio signal at its output by appropriately switching transistors on and off. Typically the class D amplifier has an H-bridge configuration using two transistors. <figref idref="DRAWINGS">FIG. <b>1</b></figref> shows an example known PWM amplifier <b>100</b> using a single transistor T<b>1</b> which as illustrated is an NPN transistor. The base and emitter of T<b>1</b> are connected to ground <b>108</b>. The PWM input <b>102</b> may be connected via a resistance <b>106</b> to the base of transistor T<b>1</b>. Circuit node <b>110</b> may be connected to the collector of T<b>1</b>. The load <b>112</b> which is typically a loudspeaker is connected between circuit node <b>110</b> and the supply <b>104</b>. An optional fly-back diode D<b>1</b> which is typical for a partly inductive load such as a loudspeaker may be connected between circuit node <b>110</b> and supply <b>104</b>. When the audio signal is zero corresponding to a period of silence, the PWM duty cycle is 50%, and the transistor T<b>1</b> will be on half of the time.</p><heading id="h-0003" level="1">SUMMARY</heading><p id="p-0007" num="0006">Various aspects of the disclosure are defined in the accompanying claims. In a first aspect there is provided an audio processor for an amplifier system, the audio processor comprising: an audio processor input configured to receive an audio signal; an audio processor output configured to be coupled to an amplifier; wherein the audio processor is configured to process the audio signal by: determining a time-varying offset from the audio signal; either (i) combining the time-varying offset with the audio signal resulting in an offset audio signal, and clipping the offset audio signal, or (ii) clipping the audio signal with a clip level being determined from the time-varying offset value, and combining the time-varying offset with the clipped audio signal; outputting the processed audio signal on the audio processor output.</p><p id="p-0008" num="0007">In one or more embodiments, the audio processor may comprise: an offset estimator having an offset estimator input coupled to the audio processor input and an offset estimator output; a series arrangement of a combiner and a clipper between the audio processor input and the audio processor output; and wherein the offset estimator is configured to generate the time-varying offset; the combiner is configured to add the time-varying offset to or subtract the time-varying offset from one of the audio signal and the offset audio signal; and the clipper is configured to clip one of the audio signal and the offset audio signal by modifying at least one of the respective audio signal values above a first clip level value and the respective audio signal values below a second clip level value.</p><p id="p-0009" num="0008">In one or more embodiments, a first combiner input is coupled to the audio processor input, a second combiner input is coupled to the offset estimator output, a combiner output is coupled to a first clipper input, the audio processor output is coupled to a clipper output; and a second clipper input is configured to receive the clip level.</p><p id="p-0010" num="0009">In one or more embodiments, a first clipper input is coupled to the audio processor input, a second clipper input is coupled to the offset estimator output, and a clipper output coupled to a first combiner input, a second combiner input is coupled to the offset estimator output, and the audio processor output is coupled to the combiner output wherein one of the first clip level and the second clip level is determined from the offset estimator output.</p><p id="p-0011" num="0010">In one or more embodiments, the clipper may comprise at least one of a rectifying linear activation unit and a logistic function module.</p><p id="p-0012" num="0011">In one or more embodiments, the offset estimator may comprise a peak detector and is configured to determine the time-varying offset value from one of detected negative peak values and detected positive peak values of the audio signal.</p><p id="p-0013" num="0012">In one or more embodiments, the peak detector may comprise a smoothing filter, and the absolute value of the detected peak value may increase at a first rate and decrease at a second rate, and wherein the first rate is less than the second rate.</p><p id="p-0014" num="0013">In one or more embodiments, the audio processor may comprise an attenuator arranged between the audio processor input and the combiner.</p><p id="p-0015" num="0014">In one or more embodiments, the audio processor may comprise a delay element arranged to delay the audio signal received at the first combiner input relative to the audio signal received at the offset estimator input.</p><p id="p-0016" num="0015">In one or more embodiments, the audio processor may be included in an audio amplifier system. The amplifier system may further comprise a series arrangement of a digital to analog converter (DAC) and an amplifier circuit, wherein the audio processor output is coupled to the DAC input and wherein the amplifier circuit is configured as one of a class C amplifier and a class D amplifier. The amplifier circuit may comprise a single-transistor amplifier circuit.</p><p id="p-0017" num="0016">In a second aspect there is provided a method of audio processing for an amplifier system, the method comprising: providing an audio signal; generating a time-varying offset value determined from the audio signal; providing a processed audio signal by either: (i) combining the time-varying offset with the audio signal resulting in an offset audio signal, and clipping the offset audio signal; or (ii) clipping the audio signal with a clip level being determined from the time-varying offset value, and combining the time-varying offset with the clipped audio signal; outputting the processed audio signal.</p><p id="p-0018" num="0017">In one or more embodiments, clipping the audio signal or offset audio signal may further comprise modifying at least one of the respective audio signal values above a first clip level value and the respective audio signal values below a second clip level value.</p><p id="p-0019" num="0018">In one or more embodiments, clipping the audio signal or offset audio signal may further comprise applying one of a rectifying linear activation function and a logistic function.</p><p id="p-0020" num="0019">In one or more embodiments, generating a time-varying offset comprises detecting a negative peak value or positive peak value of the audio signal.</p><p id="p-0021" num="0020">In one or more embodiments, detecting a negative peak value or positive peak value may comprise applying a smoothing filter, and wherein the absolute value of the detected peak value increases at a first rate and decreases at a second rate, and wherein the first rate is less than the second rate.</p><p id="p-0022" num="0021">In one or more embodiments, the method may further comprise attenuating the audio signal.</p><p id="p-0023" num="0022">In one or more embodiments, the method may further comprise delaying the audio signal before combining the time-varying offset with the audio signal or the clipped audio signal.</p><p id="p-0024" num="0023">In a third aspect there is provided a non-transitory computer readable media comprising a computer program comprising computer executable instructions which, when executed by a computer, causes the computer to perform the steps of audio processing for an amplifier system by: providing an audio signal; generating a time-varying offset value determined from the audio signal; providing a processed audio signal by either: (i) combining the time-varying offset with the audio signal resulting in an offset audio signal, and clipping the offset audio signal; or (ii) clipping the audio signal with a clip level being determined from the time-varying offset value, and combining the time-varying offset with the clipped audio signal; outputting the processed audio signal.</p><p id="p-0025" num="0024">In one or more embodiments, the computer executable instructions when executed by a computer, causes the computer to further perform the steps of: generating a time-varying offset by detecting a negative peak value or positive peak value of the audio signal; wherein the absolute value of the detected peak value increases at a first rate and decreases at a second rate, and wherein the first rate is less than the second rate.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0026" num="0025">In the figures and description like reference numerals refer to like features. Embodiments are now described in detail, by way of example only, illustrated by the accompanying drawings in which:</p><p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows a known single transistor PWM amplifier circuit.</p><p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates a class C amplifier system including an audio processor according to an embodiment.</p><p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. <b>3</b></figref> shows an example waveform of an audio signal and a processed audio signal.</p><p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates a class C amplifier system including an audio processor according to an embodiment.</p><p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. <b>5</b></figref> shows an example waveform of an audio signal and a processed audio signal.</p><p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. <b>6</b></figref> shows a method of audio processing for an amplifier system according to an embodiment.</p><p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. <b>7</b></figref> shows a method of audio processing for an amplifier system according to an embodiment.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0005" level="1">DETAILED DESCRIPTION OF EMBODIMENTS</heading><p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows an amplifier system <b>200</b> including an audio processor <b>210</b> according to an embodiment. The audio processor <b>210</b> includes an optional attenuator <b>204</b>, an offset estimator <b>208</b>. An optional delay element <b>214</b>, a combiner <b>218</b>, and a clipper <b>220</b>.</p><p id="p-0035" num="0034">An audio processor input <b>202</b> may be connected to an input of the attenuator <b>204</b>. An attenuator output <b>206</b> may be connected to an input of the offset estimator <b>208</b> and an input of the delay element <b>214</b>. The delay element output <b>216</b> may be connected to a first input of the combiner <b>218</b>. The offset estimator output <b>212</b> may be connected to a second input of the combiner <b>218</b>. The combiner output may be connected to a first input <b>222</b> of the clipper <b>220</b>. The clipper <b>220</b> may also have a second input <b>224</b> for receiving a clip level. In some examples the clip level may be fixed and so the second clipper input <b>224</b> may be omitted. The clipper output may be connected to the audio processor output <b>226</b> of the audio processor <b>210</b>.</p><p id="p-0036" num="0035">The audio processor output <b>226</b> may be connected to an input of a digital to analog converter (DAC) <b>228</b>. The digital to analog converter output <b>232</b> may be connected to an input of a class C amplifier <b>230</b> having a power supply input <b>234</b> and a ground input <b>236</b>. The class C amplifier output may be connected to the amplifier system audio output <b>238</b> which may be connected to a loudspeaker (not shown). The audio processor <b>210</b> may be implemented in hardware or a combination of hardware and software.</p><p id="p-0037" num="0036">In operation, a digital audio input signal, s<b>1</b>, may be received at the audio processor input <b>202</b>. The digital audio signal has an average value (DC value) near or equal to zero, and contains positive and negative values which can be considered for example as having a dynamic range of &#xb1;1. For the sake of convenience, signal s<b>1</b> may be referred to as a symmetrical signal, even though the positive half does not necessarily mirror the negative half received at the audio processor input <b>202</b>. The audio signal may optionally be attenuated by a gain factor, g<b>1</b>, which may be a gain factor of 0.5. Attenuating the signal may be required if the addition of an offset may cause signal values exceeding 1 which may correspond to the digital full-scale value. From this audio input signal s<b>1</b>, an offset value may be determined by the offset estimator <b>208</b>. In some examples the offset may be estimated by detecting the negative peak values of s<b>1</b>. In one example, all negative peak values may be increased or lifted by addition of an offset to exceed a value s<b>0</b>, which is the minimal digital sample value corresponding to the analog input voltage that can be adequately amplified. For a class C amplifier, the s<b>0</b> value may correspond to the voltage that is necessary to bias the transistor. In this case, the offset is the absolute value of the lowest negative peak encountered so far.</p><p id="p-0038" num="0037">The resulting time-varying offset value may be added to the audio signal by the combiner <b>218</b>. The clipper <b>220</b> may include a rectifying linear activation unit (ReLU) and the resulting signal may be negatively clipped. The clip level may be determined from a clip level signal received at second clipper input <b>224</b>. The clip level may be fixed or varying.</p><p id="p-0039" num="0038">The resulting clipped audio signal output from the clipper <b>220</b> is output on the audio processor output <b>226</b> as a processed signal s<b>2</b>. In this way a signal s<b>1</b> having a dynamic range [&#x2212;1,1] may be mapped to a processed signal having a dynamic range [<b>0</b>,<b>1</b>], that is to say positive values only. The processed signal s<b>2</b> may be converted to an analog signal by digital-to-analog converter (DAC) <b>228</b> and then amplified by class C amplifier <b>230</b>.</p><p id="p-0040" num="0039">In some examples the DAC <b>228</b> may generate a PWM signal and the class C amplifier <b>230</b> may be implemented as a single-transistor class D amplifier <b>100</b>. Contrary to a traditional class D amplifier, however, a zero signal value corresponds to a 0% duty cycle, rather than a 50% duty cycle. In other examples the audio processor may map a signal having a dynamic range denoted [&#x2212;1,1] to a processed signal having a range [0,&#x2212;1]. This may be done for example by the offset estimator detecting positive peak values, combining the audio signal with the resulting time-varying offset value, and then positive clipping so retaining the negative part of the audio signal. In this case the processed audio signal may then be inverted before amplifying.</p><p id="p-0041" num="0040">The audio processor <b>210</b> may allow a class C amplifier to be used in an audio amplifier with reduced distortion and power consumption. Conventionally to amplify a signal s<b>1</b> using a single supply voltage V<sub>cc</sub>, there are several possibilities, such as a class A and a class AB amplifier. The amplified signal will have a DC value of typically V<sub>cc</sub>/2 and a dynamic range close to &#xb1;V<sub>cc</sub>/2, the gain factor from digital to amplified signal is V<sub>cc</sub>/2. When a loudspeaker is connected, the ground terminal needs to be connected to a virtual ground of V<sub>cc</sub>/2, or the output signal needs to be high-pass filtered, such that the DC component is removed. If a non-zero DC value is present across the loudspeaker terminals, it will result in an offset of the loudspeaker diaphragm, thereby limiting the possible diaphragm displacement.</p><p id="p-0042" num="0041">For amplifying only the positive half of the audio signal, a single-transistor class C amplifier would be sufficient, and the positive half of the digital signal could be mapped to the complete [0;V<sub>cc</sub>]-range, thereby doubling the gain factor. However, it is well-known that this leads to distortions that are unacceptable for audio. The digital audio signal could be scaled down by a factor of 2 and offset by 0.5. However, this would decrease the gain factor to V<sub>cc</sub>/2 and lead to a constant current during silence and a DC of V<sub>cc</sub>/2 at the output. The result would be comparable to the traditional class A amplifier. Alternatively, the negative values of the audio signal can be set to zero, which is then the counterpart of the class C amplifier configuration. This negative clipping leads to heavy distortions and an unacceptable audio quality.</p><p id="p-0043" num="0042">The audio processor <b>210</b> modifies a digital audio signal such that it may be amplified by a single transistor amplifier that is designed to amplify only positive or only negative signals at its input, that is to say the respective negative or positive audio samples are clipped to zero. An example amplifier is a class C amplifier which is not typically used for audio because of unacceptable distortion. The audio processor <b>210</b> may reduce distortion to an acceptable level which allows a class C amplifier to be used for audio amplification. A class C amplifier can be implemented as a single transistor amplifier and is more efficient than class A or class AB amplifiers. Furthermore, since only the positive (or negative) part of the audio signal is used, the audio processor <b>210</b> output may be used to drive a single transistor class D amplifier having a PWM signal with zero duty cycle when there is silence. This may reduce power consumption compared to a conventional class D amplifier. Furthermore the audio processor <b>210</b> may be included in a haptic feedback system which may allow a haptic driver implemented as a single-transistor class C or class D amplifier and a haptic transducer to be used for audio with acceptable audio quality.</p><p id="p-0044" num="0043">The inventors have further appreciated that a digital offset of 0.5 is only necessary for worst-case scenarios, where the signal s<b>1</b> is full-scale and the peak values are consistently hitting full-scale. This can be the case for synthetically generated tones or highly (dynamically) compressed audio. Typical audio signals (both speech and music) show much more dynamic behaviour. In the case of speech, there are even many silent segments during speech pauses. The audio processor <b>210</b> uses a varying offset value rather than a fixed value of 0.5 which allows a class C amplifier to be used for audio amplification with reduced distortion and power consumption.</p><p id="p-0045" num="0044">In some examples the offset estimator <b>208</b> may asymmetrically smooth the (negative) sample values over time: the resulting peak value, n[k] increases slower than it decreases. An example implementation is:</p><p id="p-0046" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>n</mi>      <mo>[</mo>      <mi>k</mi>      <mo>]</mo>     </mrow>     <mo>=</mo>     <mrow>      <mrow>       <mi>&#x3b1;</mi>       <mo>&#x2062;</mo>       <mrow>        <mi>n</mi>        <mo>[</mo>        <mrow>         <mi>k</mi>         <mo>-</mo>         <mn>1</mn>        </mrow>        <mo>]</mo>       </mrow>      </mrow>      <mo>+</mo>      <mrow>       <mrow>        <mo>(</mo>        <mrow>         <mn>1</mn>         <mo>-</mo>         <mi>&#x3b1;</mi>        </mrow>        <mo>)</mo>       </mrow>       <mo>&#x2062;</mo>       <mi>g</mi>       <mo>&#x2062;</mo>       <mn>1</mn>       <mo>&#x2062;</mo>       <mi>s</mi>       <mo>&#x2062;</mo>       <mrow>        <mn>1</mn>        <mo>[</mo>        <mi>k</mi>        <mo>]</mo>       </mrow>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>1</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00001-2" num="00001.2"><math overflow="scroll"> <mi>where</mi></math></maths><maths id="MATH-US-00001-3" num="00001.3"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x3b1;</mi>      <mo>=</mo>      <mrow>       <mi>exp</mi>       <mo>&#x2061;</mo>       <mo>(</mo>       <mfrac>        <mrow>         <mo>-</mo>         <mn>1</mn>        </mrow>        <mrow>         <msub>          <mi>&#x3c4;</mi>          <mi>u</mi>         </msub>         <mo>&#x2062;</mo>         <msub>          <mi>f</mi>          <mi>s</mi>         </msub>        </mrow>       </mfrac>       <mo>)</mo>      </mrow>     </mrow>     <mo>;</mo>     <mrow>      <mrow>       <mi>if</mi>       <mo>&#x2062;</mo>       <mtext>   </mtext>       <mrow>        <mi>n</mi>        <mo>[</mo>        <mi>k</mi>        <mo>]</mo>       </mrow>      </mrow>      <mo>&#x3e;</mo>      <mrow>       <mi>g</mi>       <mo>&#x2062;</mo>       <mn>1</mn>       <mo>&#x2062;</mo>       <mi>s</mi>       <mo>&#x2062;</mo>       <mrow>        <mn>1</mn>        <mo>[</mo>        <mi>k</mi>        <mo>]</mo>       </mrow>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>2</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00001-4" num="00001.4"><math overflow="scroll"> <mi>and</mi></math></maths><maths id="MATH-US-00001-5" num="00001.5"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x3b1;</mi>      <mo>=</mo>      <mrow>       <mi>exp</mi>       <mo>&#x2061;</mo>       <mo>(</mo>       <mfrac>        <mrow>         <mo>-</mo>         <mn>1</mn>        </mrow>        <mrow>         <msub>          <mi>&#x3c4;</mi>          <mi>d</mi>         </msub>         <mo>&#x2062;</mo>         <msub>          <mi>f</mi>          <mi>s</mi>         </msub>        </mrow>       </mfrac>       <mo>)</mo>      </mrow>     </mrow>     <mo>;</mo>     <mrow>      <mrow>       <mi>if</mi>       <mo>&#x2062;</mo>       <mtext>   </mtext>       <mrow>        <mi>n</mi>        <mo>[</mo>        <mi>k</mi>        <mo>]</mo>       </mrow>      </mrow>      <mo>&#x2264;</mo>      <mrow>       <mi>g</mi>       <mo>&#x2062;</mo>       <mn>1</mn>       <mo>&#x2062;</mo>       <mi>s</mi>       <mo>&#x2062;</mo>       <mrow>        <mn>1</mn>        <mo>[</mo>        <mi>k</mi>        <mo>]</mo>       </mrow>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>3</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0047" num="0000">where &#x3c4;<sub>u </sub>is an upwards smoothing time constant applied where the signal values are increasing and &#x3c4;<sub>d </sub>is a downwards smoothing time constant applied where signal values are decreasing, k indicates time and f<sub>s </sub>is the audio sampling rate. In some examples &#x3c4;<sub>d</sub>&#x3c;&#x3c4;<sub>u</sub>, for example are &#x3c4;<sub>u</sub>=0.1 s and &#x3c4;<sub>d</sub>=0.01 s.</p><p id="p-0048" num="0045"><figref idref="DRAWINGS">FIG. <b>3</b></figref> shows an example waveform <b>250</b> for a speech segment. The top panel <b>252</b> shows a waveform <b>254</b>, which is the audio input signal s<b>1</b>, and the estimated time-varying offset <b>256</b> generated using smoothed negative peak detection. The middle panel <b>258</b> shows the signal <b>260</b> at the output of the combiner <b>218</b>. The offset audio signal is effectively the input signal s<b>1</b> with the negative of the varying offset signal added in. If the resulting offset signal value is greater than &#x201c;1&#x201d; then it is clipped. The combiner <b>218</b> may add the negative of the offset to the audio input signal. The bottom panel <b>262</b> shows the processed audio signal <b>264</b> with the offset added after negative clipping. In this example the clip level <b>266</b> is set to zero. It can be observed in the resulting signal that the audio signal is &#x2018;lifted up&#x2019; when the signal is non-zero and that the offset returns to zero during the speech pauses.</p><p id="p-0049" num="0046">The ratio of the smoothing time constants &#x3c4;<sub>u</sub>, &#x3c4;<sub>d </sub>control the trade-off between power consumption, which is partly determined by the average value of the output audio signal, and the signal quality. If the downwards smoothing time constant is much faster than the upwards smoothing time constant, the signal peaks will be followed more closely, due to which the offset will be higher. As a result, the signal quality will be higher, and the average value of the output audio signal and consequently power consumption in the amplifier will be higher as well.</p><p id="p-0050" num="0047">Different smoothing time constants may be used, depending on the type of signal that is expected. For speech signals, in some examples more distortion could be acceptable, and a lower</p><p id="p-0051" num="0000"><maths id="MATH-US-00002" num="00002"><math overflow="scroll"> <mfrac>  <msub>   <mi>&#x3c4;</mi>   <mi>u</mi>  </msub>  <msub>   <mi>&#x3c4;</mi>   <mi>d</mi>  </msub> </mfrac></math></maths></p><p id="p-0052" num="0000">ratio could be used. For music signals, a higher audio quality may be desirable, and so a higher</p><p id="p-0053" num="0000"><maths id="MATH-US-00003" num="00003"><math overflow="scroll"> <mfrac>  <msub>   <mi>&#x3c4;</mi>   <mi>u</mi>  </msub>  <msub>   <mi>&#x3c4;</mi>   <mi>d</mi>  </msub> </mfrac></math></maths></p><p id="p-0054" num="0000">ratio could be used.</p><p id="p-0055" num="0048">The attenuator <b>204</b> at the input ensures that the digital signal values will not digitally clip i.e. exceed unity. Alternatively or in additional, a dynamic range compressor (DRC) and/or limiter may be added after the negative clipper. Adding one of an attenuator, limiter or DRC may avoid digital clipping of the processed signal.</p><p id="p-0056" num="0049">One criterion to illustrate the increased efficiency of the audio amplifier system <b>100</b> is the ratio between the AC signal and its DC value or offset. The AC signal can be estimated using the standard deviation of the signal values, as this is the square root of the mean square deviation with respect to the mean. This yields a score of 0.35 for the &#x2018;class A&#x2019; approach, a score of 1.35 for the amplifier system <b>200</b>, and 2.35 for the conventional &#x2018;class C&#x2019; amplifier which would clip the negative signal. The conventional &#x2018;class C&#x2019; approach is most efficient but this is at the cost of unacceptable distortion for audio amplification. The &#x2018;class A&#x2019; approach clearly is less efficient than the other two, but does not introduce distortion.</p><p id="p-0057" num="0050">The perceptual quality can for example be estimated using a PESQ score (perceptual evaluation of speech quality). Taking s<b>1</b> as the reference speech file, the audio amplifier system <b>200</b> returns a PESQ score of 2.88, and the negative clipped version i.e. using a conventional class C amplifier returns a score of 2.25, indicating a much lower speech quality.</p><p id="p-0058" num="0051">The offset that is present in the (digital) processed output signal may be considered as similar to the biasing of the transistor in the analog domain. By increasing the offset, the Q-point of the amplifier can be interpreted to be shifted, allowing negative values. When the digital offset is 0.5, the behaviour of the class C amplifier may be comparable to a class A amplifier. By varying the offset value according to the input signal, the processed signal may result in an audio amplifier with acceptable audio quality and improved efficiency compared to a class A configuration.</p><p id="p-0059" num="0052">In some examples, the clipper <b>224</b> may clip the audio signal by applying a soft non-linearity such as a soft version of the rectifying linear activation unit (by implementing a soft knee) or a logistic function:</p><p id="p-0060" num="0000"><maths id="MATH-US-00004" num="00004"><math overflow="scroll"> <mrow>  <mrow>   <mrow>    <mi>f</mi>    <mo>&#x2061;</mo>    <mo>(</mo>    <mi>x</mi>    <mo>)</mo>   </mrow>   <mo>=</mo>   <mfrac>    <mi>L</mi>    <mrow>     <mn>1</mn>     <mo>+</mo>     <msup>      <mi>e</mi>      <mrow>       <mi>k</mi>       <mo>&#x2061;</mo>       <mo>(</mo>       <mrow>        <mi>x</mi>        <mo>-</mo>        <mrow>         <mi>x</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </mrow>       <mo>)</mo>      </mrow>     </msup>    </mrow>   </mfrac>  </mrow>  <mo>,</mo> </mrow></math></maths></p><p id="p-0061" num="0000">where k is a parameter describing the steepness of the logistic function, and x0 is the centre point of the logistic function, which in the current application, may be a function of the estimated offset.</p><p id="p-0062" num="0053">The audio processor <b>210</b> may be used in audio amplifier systems with other amplifiers for example single transistor class D or PWM amplifier <b>100</b>. In this case the digital-to-analog conversion can be a pulse-width-modulation. The PWM can be designed such that only the positive range of the input signal is mapped to a valid duty cycle and such that the negative values correspond to 0V. That way, the single transistor PWM amplifier <b>100</b> designed to amplify only positive samples may be used with acceptable audio quality. If necessary, additional low-pass filtering may be applied.</p><p id="p-0063" num="0054"><figref idref="DRAWINGS">FIG. <b>4</b></figref> shows an amplifier system <b>300</b> including an audio processor <b>310</b> according to an embodiment. The audio processor <b>310</b> includes, an attenuator <b>304</b>, an offset estimator <b>308</b>, an combiner <b>318</b> and a clipper <b>320</b>.</p><p id="p-0064" num="0055">An audio processor input <b>302</b> may be connected to an input of the attenuator <b>304</b>. An attenuator output <b>306</b> may be connected to an input of the offset estimator <b>308</b> and an input of the clipper <b>320</b>. The clipper output <b>314</b> may be connected to a first input of the combiner <b>318</b>. The offset estimator output <b>312</b> may be connected to a second input of the combiner <b>318</b>. The combiner output may be connected to the audio processor output <b>316</b> of the audio processor <b>310</b>.</p><p id="p-0065" num="0056">The audio processor output <b>316</b> may be connected to an input of a digital to analog converter (DAC) <b>328</b>. The digital to analog converter output <b>332</b> may be connected to an input of a class C amplifier <b>330</b> having a power supply input <b>334</b> and a ground input <b>336</b>. The class C amplifier output may be connected to the amplifier system audio output <b>338</b>.</p><p id="p-0066" num="0057">In operation, a digital audio input signal, s<b>1</b>, may be received at the audio processor input <b>302</b>. The audio signal may optionally be attenuated by the attenuator <b>304</b> by a gain factor, g<b>1</b>, which may be a gain factor of 0.5. Attenuating the signal may be required if the addition of an offset may cause signal values exceed the digital full-scale value. From this audio input signal s<b>1</b>, an offset value is estimated by the offset estimator <b>308</b>. In some examples the offset may be estimated by detecting the negative peak values of s<b>1</b>. In one example, all negative peak values may be increased or lifted by addition of an offset to a value s<b>0</b>, which is the minimal digital sample value corresponding to the analog input voltage that can be adequately amplified. For a class C amplifier, the s<b>0</b> value corresponds to the voltage that is necessary to bias the transistor. In this case, the offset is the absolute value of the lowest negative peak encountered so far.</p><p id="p-0067" num="0058">The clipper <b>320</b> may include a rectifying linear activation unit, ReLU, and the resulting signal may be negatively clipped. The clip level may correspond to the time-varying offset value. The resulting clipped audio signal output from the clipper <b>320</b> is output to the combiner <b>318</b>. The offset value from the offset estimator <b>308</b> may then be combined by the combiner <b>318</b> by adding the negative of the offset value to or subtracting the offset value from the clipped audio signal. The processed signal from the combiner output may then be provided to the audio processor output <b>316</b>. In some examples a DRC or limiter (not shown) may receive the signal from the combiner output and limit the audio signal to avoid positive clipping before providing the processed signal to the audio processor output <b>316</b>.</p><p id="p-0068" num="0059">In this way, a signal s<b>1</b> having a dynamic range denoted for example as [&#x2212;1,1] may be mapped to a processed signal having a dynamic range [0,1], that is to say positive values only. The processed signal s<b>2</b> may be converted to an analog signal by digital-to-analog converter (DAC) <b>328</b> and then amplified by class C amplifier <b>330</b>. The audio processor <b>310</b> applies clipping and offset combining in a different order to the audio processor <b>210</b> but the resulting processed signal is similar in both cases.</p><p id="p-0069" num="0060">This is illustrated in <figref idref="DRAWINGS">FIG. <b>5</b></figref> which shows an example waveform <b>350</b> for a speech segment showing the effect of processing by the audio processor <b>310</b>. The top panel <b>352</b> shows a waveform <b>354</b>, which is the audio input signal s<b>1</b>, and the estimated time-varying offset <b>356</b> generated using smoothed negative peak detection. The middle panel <b>358</b> shows the signal <b>360</b> at the output of the clipper <b>320</b> showing the effect of the variable clip level. The bottom panel <b>362</b> shows the processed audio signal <b>364</b> with the offset added after negative clipping. It can be observed in the resulting signal that the audio signal is &#x2018;lifted up&#x2019; when the signal is non-zero and that the offset returns to zero during the speech pauses. The resulting processed signal <b>364</b> is similar to that produced by audio processor <b>210</b>.</p><p id="p-0070" num="0061">In some examples the DAC <b>328</b> may generate a PWM signal and the Class-C amplifier <b>330</b> may be replaced by the single-transistor class D amplifier <b>100</b>. In other examples the audio processor <b>310</b> may map a signal having a range [&#x2212;1,1] to a processed signal having a range [0,&#x2212;1]. This may be done for example be the offset estimator detecting positive peak values and then positive clipping so retaining the negative part of the audio signal. In this case the processed audio signal may then be inverted before amplifying.</p><p id="p-0071" num="0062">Audio processor <b>310</b> modifies a digital audio signal such that it may be amplified by an amplifier that is designed to only amplify only positive or negative signals at its input (i.e., the respective negative or positive audio samples are clipped to zero). An example amplifier is a class C amplifier which is not typically used for audio because of unacceptable distortion. The audio processor <b>310</b> may reduce distortion to an acceptable level which allows a class C amplifier to be used for audio amplification. A class C amplifier can be implemented as a single transistor amplifier and is more efficient than class A or class AB amplifiers.</p><p id="p-0072" num="0063"><figref idref="DRAWINGS">FIG. <b>6</b></figref> shows a method of audio processing <b>400</b> suitable for an amplifier system including a class C amplifier or single transistor class D amplifier according to an embodiment. In step <b>402</b> an audio signal is provided. In step <b>404</b> a time-varying offset value determined from the audio input signal may be generated. In step <b>406</b> the time-varying (variable) offset may be combined with the audio signal by addition or subtraction. In step <b>408</b> the offset audio signal may be clipped for example by applying a RELU, logistic function or other function to the signal. The clip level may be fixed or variable. In some examples the clip level may be zero. Following from step <b>408</b>, in step <b>410</b> the clipped audio signal may be provided as the processed audio signal for a class C amplifier or single transistor PWM amplifier after digital to analog conversion.</p><p id="p-0073" num="0064"><figref idref="DRAWINGS">FIG. <b>7</b></figref> shows a method of audio processing <b>450</b> suitable for an amplifier system including a class C amplifier or single transistor class D amplifier according to an embodiment. In step <b>452</b> an audio signal is provided. In step <b>454</b> a time-varying offset value determined from the audio input signal may be generated. In step <b>456</b> the audio signal may be clipped for example by applying a RELU, logistic function or other function to the signal. The clip level may be the variable offset value or value determined from the variable offset value. In step <b>458</b> the time-varying (variable) offset may be combined with the clipped audio signal by addition or subtraction. Following from step <b>458</b>, in step <b>460</b> the offset audio signal may be provided as the processed audio signal to an amplifier such as a class C amplifier or single transistor PWM amplifier after digital to analog conversion.</p><p id="p-0074" num="0065">The methods <b>400</b>, <b>450</b> when used in an audio amplifier system may allow a more efficient single transistor class C amplifier to be used instead of class A, or class AB amplifiers with acceptable audio quality. Alternatively a single transistor class D amplifier may be used with a zero duty cycle when there is no audio which is also more efficient than class A or class AB amplifiers.</p><p id="p-0075" num="0066">Embodiments of the audio processor and methods of audio processing described may modify an audio signal such that it contains only positive (or only negative) values while retaining acceptable audio quality. The modified signal can then be sent to an amplifier that is designed to amplify only positive (or only negative) signal values, such as a class C amplifier, or an amplifier for a PWM signal that encodes only positive signal values or only negative signal values.</p><p id="p-0076" num="0067">Some embodiments may add a slowly varying offset, which lifts up the signal by a fraction before setting the negative values to zero. This may allow the signal energy to decrease by less than the 3 dB expected from only using the positive half of the signal.</p><p id="p-0077" num="0068">The modified signal can be used in a system with an amplifier that is designed to only amplify positive signal values which may be lower cost and/or more efficient. Embodiments included in an amplifier system may include a simpler amplifier stage which has only slightly lower performance in terms of perceptual audio quality and loudness than a traditional class AB or class D amplifier, and with better efficiency than a class A amplifier. Embodiments may be included in a haptic feedback system where a haptic actuator may also provide audio output.</p><p id="p-0078" num="0069">An audio processor and method of audio processing for an amplifier system is described. The audio processor may receive an audio signal and adapt the audio signal generating a time varying offset. The time varying offset may be combined with the audio signal resulting in a shifted the audio signal level. The processed audio signal may also be clipped to remove the negative samples values. The processed signal may be used to drive an amplifier designed to only accept positive (or negative) signals such as a class C amplifier.</p><p id="p-0079" num="0070">In some example embodiments the set of instructions/method steps described above are implemented as functional and software instructions embodied as a set of executable instructions which are effected on a computer or machine which is programmed with and controlled by said executable instructions. Such instructions are loaded for execution on a processor (such as one or more CPUs). The term processor includes microprocessors, microcontrollers, processor modules or subsystems (including one or more microprocessors or microcontrollers), or other control or computing devices. A processor can refer to a single component or to plural components.</p><p id="p-0080" num="0071">Example embodiments of the material discussed in this specification can be implemented in whole or in part through network, computer, or data based devices and/or services. These may include cloud, internet, intranet, mobile, desktop, processor, look-up table, microcontroller, consumer equipment, infrastructure, or other enabling devices and services. As may be used herein and in the claims, the following non-exclusive definitions are provided.</p><p id="p-0081" num="0072">Although the appended claims are directed to particular combinations of features, it should be understood that the scope of the disclosure of the present invention also includes any novel feature or any novel combination of features disclosed herein either explicitly or implicitly or any generalisation thereof, whether or not it relates to the same invention as presently claimed in any claim and whether or not it mitigates any or all of the same technical problems as does the present invention.</p><p id="p-0082" num="0073">Features which are described in the context of separate embodiments may also be provided in combination in a single embodiment. Conversely, various features which are, for brevity, described in the context of a single embodiment, may also be provided separately or in any suitable sub combination.</p><p id="p-0083" num="0074">For the sake of completeness it is also stated that the term &#x201c;comprising&#x201d; does not exclude other elements or steps, the term &#x201c;a&#x201d; or &#x201c;an&#x201d; does not exclude a plurality, a single processor or other unit may fulfil the functions of several means recited in the claims and reference signs in the claims shall not be construed as limiting the scope of the claims.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001 MATH-US-00001-2 MATH-US-00001-3 MATH-US-00001-4 MATH-US-00001-5" nb-file="US20230007395A1-20230105-M00001.NB"><img id="EMI-M00001" he="26.08mm" wi="76.20mm" file="US20230007395A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00002" nb-file="US20230007395A1-20230105-M00002.NB"><img id="EMI-M00002" he="5.25mm" wi="76.20mm" file="US20230007395A1-20230105-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00003" nb-file="US20230007395A1-20230105-M00003.NB"><img id="EMI-M00003" he="5.25mm" wi="76.20mm" file="US20230007395A1-20230105-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00004" nb-file="US20230007395A1-20230105-M00004.NB"><img id="EMI-M00004" he="6.01mm" wi="76.20mm" file="US20230007395A1-20230105-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. An audio processor for an amplifier system, the audio processor comprising:<claim-text>an audio processor input configured to receive an audio signal;</claim-text><claim-text>an audio processor output configured to be coupled to an amplifier; wherein the audio processor is configured to process the audio signal by:</claim-text><claim-text>determining a time-varying offset from the audio signal;</claim-text><claim-text>either (i) combining the time-varying offset with the audio signal resulting in an offset audio signal, and clipping the offset audio signal, or (ii) clipping the audio signal with a clip level being determined from the time-varying offset value, and combining the time-varying offset with the clipped audio signal;</claim-text><claim-text>outputting the processed audio signal on the audio processor output.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The audio processor of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:<claim-text>an offset estimator having an offset estimator input coupled to the audio processor input and an offset estimator output;</claim-text><claim-text>a series arrangement of a combiner and a clipper between the audio processor input and the audio processor output;</claim-text><claim-text>and wherein</claim-text><claim-text>the offset estimator is configured to generate the time-varying offset;</claim-text><claim-text>the combiner is configured to add the time-varying offset to or subtract the time-varying offset from one of the audio signal and the offset audio signal; and</claim-text><claim-text>the clipper is configured to clip one of the audio signal and the offset audio signal by modifying at least one of the respective audio signal values above a first clip level value and the respective audio signal values below a second clip level value.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The audio processor of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein a first combiner input is coupled to the audio processor input, a second combiner input is coupled to the offset estimator output, a combiner output is coupled to a first clipper input, the audio processor output is coupled to a clipper output; and a second clipper input is configured to receive the clip level.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The audio processor of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein a first clipper input is coupled to the audio processor input, a second clipper input is coupled to the offset estimator output, and a clipper output coupled to a first combiner input, a second combiner input is coupled to the offset estimator output, and the audio processor output is coupled to the combiner output wherein one of the first clip level and the second clip level is determined from the offset estimator output.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The audio processor of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the clipper comprises at least one of a rectifying linear activation unit and a logistic function module.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The audio processor of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the offset estimator comprises a peak detector and is configured to determine the time-varying offset value from one of detected negative peak values and detected positive peak values of the audio signal.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The audio processor of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the peak detector comprises a smoothing filter, and the absolute value of the detected peak value increases at a first rate and decreases at a second rate, and wherein the first rate is less than the second rate.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The audio processor of <claim-ref idref="CLM-00002">claim 2</claim-ref> further comprising: an attenuator arranged between the audio processor input and the combiner.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The audio processor of <claim-ref idref="CLM-00002">claim 2</claim-ref> further comprising: a delay element arranged to delay the audio signal received at the first combiner input relative to the audio signal received at the offset estimator input.</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. An audio amplifier system comprising the audio processor of <claim-ref idref="CLM-00001">claim 1</claim-ref> and a series arrangement of a digital to analog converter, DAC, and an amplifier circuit, wherein the audio processor output is coupled to the DAC input and wherein the amplifier circuit is configured as one of a class C amplifier and a class D amplifier.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The audio amplifier system of <claim-ref idref="CLM-00010">claim 10</claim-ref> wherein the amplifier circuit comprises a single-transistor amplifier circuit.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. A method of audio processing for an amplifier system, the method comprising:<claim-text>providing an audio signal;</claim-text><claim-text>generating a time-varying offset value determined from the audio signal;</claim-text><claim-text>providing a processed audio signal by either:</claim-text><claim-text>(i) combining the time-varying offset with the audio signal resulting in an offset audio signal, and clipping the offset audio signal; or</claim-text><claim-text>(ii) clipping the audio signal with a clip level being determined from the time-varying offset value, and combining the time-varying offset with the clipped audio signal;</claim-text><claim-text>outputting the processed audio signal.</claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein clipping the audio signal or offset audio signal further comprises modifying at least one of the respective audio signal values above a first clip level value and the respective audio signal values below a second clip level value.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein clipping the audio signal or offset audio signal further comprises applying one of a rectifying linear activation function and a logistic function.</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein generating a time-varying offset comprises detecting a negative peak value or positive peak value of the audio signal.</claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein detecting a negative peak value or positive peak value comprises applying a smoothing filter, and wherein the absolute value of the detected peak value increases at a first rate and decreases at a second rate, and wherein the first rate is less than the second rate.</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref> further comprising attenuating the audio signal.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref> further comprising: delaying the audio signal before combining the time-varying offset with the audio signal or the clipped audio signal</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. A non-transitory computer readable media comprising a computer program comprising computer executable instructions which, when executed by a computer, causes the computer to perform the steps of audio processing for an amplifier system by:<claim-text>providing an audio signal;</claim-text><claim-text>generating a time-varying offset value determined from the audio signal;</claim-text><claim-text>providing a processed audio signal by either:</claim-text><claim-text>(i) combining the time-varying offset with the audio signal resulting in an offset audio signal, and clipping the offset audio signal; or</claim-text><claim-text>(ii) clipping the audio signal with a clip level being determined from the time-varying offset value, and combining the time-varying offset with the clipped audio signal;</claim-text><claim-text>outputting the processed audio signal.</claim-text></claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The non-transitory computer readable media of <claim-ref idref="CLM-00019">claim 19</claim-ref> wherein the computer executable instructions when executed by a computer, causes the computer to further perform the steps of:<claim-text>generating a time-varying offset by detecting a negative peak value or positive peak value of the audio signal;</claim-text><claim-text>wherein the absolute value of the detected peak value increases at a first rate and decreases at a second rate, and wherein the first rate is less than the second rate.</claim-text></claim-text></claim></claims></us-patent-application>