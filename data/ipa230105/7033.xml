<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007034A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007034</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17851145</doc-number><date>20220628</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>JP</country><doc-number>2021-109150</doc-number><date>20210630</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>9</main-group><subgroup>40</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>1425</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>145</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">ATTACK ANALYZER, ATTACK ANALYSIS METHOD AND ATTACK ANALYSIS PROGRAM</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>DENSO CORPORATION</orgname><address><city>Kariya-city</city><country>JP</country></address></addressbook><residence><country>JP</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>MURAKAMI</last-name><first-name>Ryosuke</first-name><address><city>Kariya-city</city><country>JP</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>IMOTO</last-name><first-name>Reiichiro</first-name><address><city>Kariya-city</city><country>JP</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>EGAWA</last-name><first-name>Masumi</first-name><address><city>Kariya-city</city><country>JP</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">An attack analyzer includes: a security log acquisition unit acquiring a security log including an abnormality detection signal generated by a security sensor mounted on an electronic control device constituting part of an electronic control system and indicating that the security sensor has detected an abnormality; an alive signal acquisition unit acquiring an alive signal; a prediction table storage unit storing a prediction table showing a correspondence relationship between a predicted attack route in the electronic control system and a predicted abnormality detection signal predicted to be generated by the security sensor; an attack route estimation unit estimating, using the prediction table, the attack route of an attack received by the electronic control system from the abnormality detection signal and the alive signal included in the security log; and an attack information output unit outputting attack information indicating the attack route.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="129.88mm" wi="158.75mm" file="US20230007034A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="214.63mm" wi="151.81mm" file="US20230007034A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="214.29mm" wi="142.58mm" orientation="landscape" file="US20230007034A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="201.00mm" wi="150.20mm" orientation="landscape" file="US20230007034A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="216.75mm" wi="139.70mm" orientation="landscape" file="US20230007034A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="233.76mm" wi="139.70mm" orientation="landscape" file="US20230007034A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="233.76mm" wi="139.70mm" orientation="landscape" file="US20230007034A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="233.51mm" wi="139.70mm" orientation="landscape" file="US20230007034A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="168.66mm" wi="109.98mm" file="US20230007034A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATION</heading><p id="p-0002" num="0001">The present application is based on and claims the benefit of priority of Japanese Patent Application No. 2021-109150, filed on Jun. 30, 2021, the disclosure of which is incorporated herein by reference.</p><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">The present disclosure generally relates to a device that analyzes an attack on an electronic control system mounted on a movable body such as an automobile, including an attack analyzer, an attack analysis method, and an attack analysis program.</p><heading id="h-0003" level="1">BACKGROUND INFORMATION</heading><p id="p-0004" num="0003">In recent years, technologies for driving support and automated driving control, including V2X such as vehicle-to-vehicle communication and road-to-vehicle communication, have been attracting attention. As a result, a vehicle has a communication function, and so-called connectivity of the vehicle has been promoted. As a result, vehicles are more likely to be subject to cyber attacks such as unauthorized access. Therefore, it is necessary to analyze cyber attacks on vehicles and formulate countermeasures.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0005" num="0004">It is an object of the present disclosure to realize an attack analyzer or the like that estimates an attack route with higher accuracy when a cyber attack on an electronic control system is received/observed.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0006" num="0005">Objects, features, and advantages of the present disclosure will become more apparent from the following detailed description made with reference to the accompanying drawings, in which:</p><p id="p-0007" num="0006"><figref idref="DRAWINGS">FIGS. <b>1</b>A and <b>1</b>B</figref> are respectively an explanatory diagram illustrating an arrangement of an attack analyzer according to a first embodiment;</p><p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a block diagram illustrating a configuration example of an electronic control system of the first embodiment;</p><p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a block diagram showing a configuration example of the attack analyzer according to the first embodiment;</p><p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is an explanatory diagram illustrating a prediction table stored in a prediction table storage unit of the attack analyzer of the first embodiment;</p><p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is an explanatory diagram illustrating a reliability calculation method of a reliability calculation unit according to an example embodiment 1 of the first embodiment;</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is another explanatory diagram illustrating the reliability calculation method of the reliability calculation unit according to an example embodiment 2 of the first embodiment;</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is an explanatory diagram illustrating a reliability calculation method of the reliability calculation unit according to an example embodiment 3 of the first embodiment; and</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a flowchart showing an operation of the attack analyzer according to the first embodiment.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION</heading><p id="p-0015" num="0014">Embodiments of the present disclosure will be described below with reference to the drawings.</p><p id="p-0016" num="0015">The present disclosure means the disclosure described in the section of claims or means for solving the problem (i.e., Summary section), and is not limited to the following embodiments. Further, at least the words and phrases in quotation marks mean the words and phrases described in the section of claims or means for solving the problem, and are not limited to the following embodiments.</p><p id="p-0017" num="0016">The configurations and methods described in the dependent claims of the claims section are arbitrary (i.e., non-essential) configurations and methods in the disclosure described in the independent terms of the claims. The configurations and methods of the embodiments corresponding to the configurations and methods described in the dependent claims, and the configurations and methods described only in the embodiments that are not described in the claims are arbitrary configurations and methods in the present disclosure. The configuration and method described in the embodiment when the description of the claims is wider than the description of the embodiment is also an arbitrary configuration and method in the present disclosure in the sense that it is an example of the configuration and method of the present disclosure. In either case, the description in the independent claim(s) provides an essential configuration and method of the present disclosure.</p><p id="p-0018" num="0017">Any effects described in the embodiments are effects obtained by a configuration of an embodiment as an example of the present disclosure, and are not necessarily effects of the present disclosure.</p><p id="p-0019" num="0018">When there are multiple embodiments, a configuration disclosed in each embodiment is not limited to each embodiment, but can be combined across embodiments. For example, a configuration disclosed in one embodiment may be combined with other embodiments. Configurations disclosed in multiple embodiments may be collected and combined.</p><p id="p-0020" num="0019">A difficulty described above is not a publicly known matter but is originally found by an applicant of the present application, and is a fact that confirms/proves non-obviousness of the present application together with a configuration and a method described in the present application.</p><heading id="h-0007" level="1">1. First Embodiment</heading><p id="p-0021" num="0020">(1) Arrangement of an Attack Analyzer <b>100</b> and an Electronic Control System S</p><p id="p-0022" num="0021"><figref idref="DRAWINGS">FIGS. <b>1</b>A and <b>1</b>B</figref> are respectively a diagram illustrating an arrangement of the attack analyzer <b>100</b> of the present embodiment. The attack analyzer <b>100</b> detects a cyber attack on the electronic control system S, and estimates an attack route of the cyber attack received by the electronic control system S. The attack analyzer <b>100</b> may take any arrangement/configuration in which necessary information is obtainable from the electronic control system S. Hereinafter, a cyber attack may be abbreviated as an attack. In addition, an attack may be described as abnormality based on a viewpoint of the electronic control system S affected under the attack.</p><p id="p-0023" num="0022">For example, as shown in <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, the electronic control system S and the attack analyzer <b>100</b> are &#x201c;mounted&#x201d; on a vehicle which is a &#x201c;moving body,&#x201d; and as shown in <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>, electronic devices are used. It is assumed that the control system S is &#x201c;mounted&#x201d; on a vehicle that is a &#x201c;moving body,&#x201d; and the attack analysis device <b>100</b> is realized by a server device installed outside the vehicle.</p><p id="p-0024" num="0023">The &#x201c;movable body&#x201d; refers to an object which is movable, and a travel speed thereof is arbitrary. Naturally, the above also includes a case where the movable object is stopped. Examples of the movable body include, but are not limited to, automobiles, motorcycles, bicycles, pedestrians, ships, aircrafts, and objects mounted thereon. Further, &#x201c;mounted&#x201d; includes not only a case where it is directly fixed to the movable body but also the case where it is not fixed to the movable body but moves together with the movable body. For example, the above may be a case where a person riding on the movable body carries the object, or a case where the object is mounted in a load placed on the movable body.</p><p id="p-0025" num="0024">In the case of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, the attack analyzer <b>100</b> and the electronic control system S are connected by an in-vehicle network such as CAN (Controller Area Network) or LIN (Local Interconnect Network). Alternatively, any communication method such as Ethernet (registered trademark), Wi-Fi (registered trademark), Bluetooth (registered trademark), or the like can be used for connection. As another example, the function of the attack analyzer <b>100</b> can be incorporated in at least one of the electronic control devices constituting the electronic control system S.</p><p id="p-0026" num="0025">In the case of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, the attack analyzer <b>100</b> can analyze the cyber attack without delay when the electronic control system S is attacked, and can promptly respond to the cyber attack.</p><p id="p-0027" num="0026">In the case of <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>, the attack analyzer <b>100</b> and the electronic control system S are connected by using a communication means consisting of wireless communication methods such as, for example, IEEE802.11 (Wi-Fi (registered trademark)), IEEE802.16 (WiMAX (registered trademark)), W-CDMA (Connect Wideband Code Division Multiple Access), HSPA (High Speed Packet Access), LTE (Long Term Evolution), LTE-A (Long Term Evolution Advanced), 4G, 5G and the like. Alternatively, Dedicated Short Range Communication (DSRC) can also be used. When a vehicle is parked in a parking lot or housed in a repair shop, a wired communication method can also be used instead of the wireless communication method. For example, a LAN (Local Area Network), the Internet, or a fixed telephone line can be used.</p><p id="p-0028" num="0027">In the case of <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>, when the electronic control system S mounted on a vehicle is attacked, the server device receives, from the vehicle, a security log generated by a security sensor mounted on an electronic control device constituting the electronic control system S, via a wireless communication network. Therefore, as compared with the case where the attack analyzer <b>100</b> is mounted on the vehicle, it takes time to analyze the attack and to feed back the analysis result to the vehicle, but it is possible to reduce the processing load on the vehicle. Moreover, since the abundant resources of the server device can be used, it is possible to execute a large amount of complicated arithmetic operations.</p><p id="p-0029" num="0028">As another arrangement, the following example can be considered. The electronic control system S may be mounted not on the vehicle but on a stationary body. Further, the electronic control system S and the attack analyzer <b>100</b> may be mounted on different vehicles and communicate directly or indirectly via a base station or the like.</p><p id="p-0030" num="0029">(2) Configuration of an Electronic Control System S</p><p id="p-0031" num="0030">(a) Overall Configuration</p><p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a diagram illustrating a configuration example of the electronic control system S. The electronic control system S includes TCU <b>11</b>, IVI <b>12</b>, CGW <b>13</b>, ECU <b>14</b>, ECU <b>15</b>, ECU <b>16</b>, and ECU <b>17</b>.</p><p id="p-0033" num="0032">The TCU <b>11</b> (Telematics Control Unit) is an electronic control unit (ECU) having a communication function, and transmits/receives information by performing communication via an external information accumulation server or the Internet. The TCU <b>11</b> is called as an entry point because it can be an entrance for an attack from the outside by communicating with the outside of the electronic control system S.</p><p id="p-0034" num="0033">The IVI <b>12</b> (In-Vehicle Infotainment system) is an ECU that has a function of providing information and entertainment, and also has a communication function similar to that of the TCU <b>11</b>, and the IVI <b>12</b> sends and receives information by communicating via an external information accumulation server or the Internet. Since the IVI <b>12</b> also communicates with the outside of the electronic control system S, it can be an entrance for an attack from the outside, so the IVI <b>12</b> is also called an entry point.</p><p id="p-0035" num="0034">The CGW <b>13</b> (Central GateWay) is an ECU having, as its main function, a gateway (GW) function. For example, the information received by the TCU <b>11</b> or IVI <b>12</b> is transferred to the ECUs <b>14</b> to <b>17</b> connected via an in-vehicle network such as CAN or LIN or a communication network such as Ethernet (ETH). Further, the information transmitted from the ECUs <b>14</b> to <b>17</b> is transferred to the TCU <b>11</b> and the IVI <b>12</b>. The CGW <b>13</b> can also be equipped with a function other than the gateway function. Further, the attack analyzer <b>100</b> described later can be mounted as a function of the CGW <b>13</b>.</p><p id="p-0036" num="0035">ECUs <b>14</b> to <b>17</b> are ECUs connected to the CGW <b>13</b> via a network. In <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the ECU <b>14</b> and the ECU <b>15</b> are connected via Ethernet. The ECU <b>16</b> and the ECU <b>17</b> are connected via a CAN, which is an in-vehicle network. The ECUs <b>14</b> to <b>17</b> may be any ECUs that realize each function of the vehicle, which include electronic control devices for the drive system that control the engine, steering wheel, brake, etc., electronic control devices for the vehicle body that control the meters, power windows, etc., electronic control devices for information systems such as a navigation device, or electronic control devices for safety control system that perform controls to prevent collision with an obstacle or a pedestrian, for example.</p><p id="p-0037" num="0036">In the following description, when not paying attention to the unique features of the above-mentioned TCU <b>11</b>, IVI <b>12</b>, CGW <b>13</b>, ECU <b>14</b>, ECU <b>15</b>, ECU <b>16</b>, and ECU <b>17</b>, each of them may be simply referred to as an ECU.</p><p id="p-0038" num="0037">(b) Multi-Layer Defense and Layers</p><p id="p-0039" num="0038">In many electronic control systems S, multi-layer defense is adopted in order to enhance the security against attacks. According to multi-layer defense, security functions are provided hierarchically and in multiple layers as countermeasures against attacks, so that even if one countermeasure (that is, the first layer) is breached in the event of an attack, the next countermeasure (that is, the second layer) can still provide defense against attacks, the defense power of the electronic control system can be enhanced. Therefore, in the electronic control system S that employs multi-layer defense, there are a plurality of layers having different security levels. Therefore, the electronic control system S is divided into a plurality of layers according to the security level, and each ECU is classified into one of those layers.</p><p id="p-0040" num="0039">The electronic control system S shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref> has three layers of defense. In this example, TCU <b>11</b> and IVI <b>12</b> belong to the first layer, CGW <b>13</b> belongs to the second layer, and ECUs <b>14</b> to <b>17</b> belong to the third layer. The TCU <b>11</b> and IVI <b>12</b> are ECUs having a communication function with the outside, and these ECUs are equipped with a security function for monitoring data entering the inside of the vehicle from the outside of the vehicle. The area monitored by the ECU having such a security function is the first layer. The CGW <b>13</b> is, for example, an ECU having a gateway function equipped with a security function for monitoring data communicated between a network to the ECU connected to the outside of the vehicle and a network to an ECU that controls the vehicle. The CGW <b>13</b> takes security measures different from those of the TCU <b>11</b> and IVI <b>12</b>, and the area monitored by the CGW <b>13</b> has a security level different from that of the first layer, which is the area protected by the TCU <b>11</b> and the IVI <b>12</b>. Therefore, the area monitored by CGW <b>13</b> is set as the second layer. It can be said that the ECUs <b>14</b> to <b>17</b> are in an area in which only the data that has passed the security function of the CGW <b>13</b> is communicated and has a security level different from that of the second layer. Therefore, the area to which the ECUs <b>14</b> to <b>17</b> belong is set as the third layer.</p><p id="p-0041" num="0040">Although the electronic control system S in <figref idref="DRAWINGS">FIG. <b>2</b></figref> has three layers of defense, four or more layers of defense may be provided. For example, the ECU connected via a sub-gateway ECU may be considered as the fourth layer.</p><p id="p-0042" num="0041">Further, although the hierarchy described in the present embodiment is a physical hierarchy starting from the entry point, a functional hierarchy may be used instead of all or part of the physical hierarchy. For example, there may be a case in which a master-slave relationship is set between ECUs.</p><p id="p-0043" num="0042">(c) Security Sensor</p><p id="p-0044" num="0043">Each ECU constituting the electronic control system S is equipped with one or more security sensors that monitor the inside of the ECU and the network to which the ECU is connected. When the security sensor detects an abnormality that has occurred inside the ECU or in the network, the security sensor generates and outputs a security log. The security log contains an abnormality detection signal indicating that the security sensor has detected an abnormality.</p><p id="p-0045" num="0044">Examples of the security sensor include firewalls, proxies, CAN-IDS, CAN filters, TLS, MAC verification, file access monitoring, secure boot, secure repro(gram), CFI, sandbox, authentication and the like.</p><p id="p-0046" num="0045">In addition to the abnormality detection signal, the security log contains abnormal position information indicating a position where the abnormality detected by the security sensor has occurred, identification information for identifying the electronic control system S, and identification information for identifying the ECU equipped with the security sensor, identification information of the security sensor that detected the abnormality, time when the abnormality was detected, number of times the abnormality was detected, order in which the abnormality was detected, information on data content and IP address (source and destination) received before the abnormality was detected, etc. may be included.</p><p id="p-0047" num="0046">(d) Alive Signal</p><p id="p-0048" num="0047">Each ECU has a security sensor generates an alive signal, and transmits the alive signal to a network to which the ECU is connected. The alive signal may also be called as keep-alive information or heartbeat information.</p><p id="p-0049" num="0048">The alive signal is a predetermined signal generated at and having a predetermined cycle, which is then transmitted to the network, and with which the security sensor is determined as to whether it is operating, and/or whether it is normally operating. For example, if the alive signal is not transmitted at all, it is determinable that the security sensor is not operating. Further, if the alive signal is transmitted at a cycle other than the predetermined cycle, or is irregularly transmitted, it is determinable that the security sensor is operating but the operation is not normal. When the alive signal is not the predetermined signal, it is also determinable that the security sensor is operating but the operation is not normal.</p><p id="p-0050" num="0049">Contents of the alive signal are the predetermined signal in the present embodiment, e.g., a known series of numbers. However, the contents of the alive signal may also be security sensor specific information, security sensor setting information and the other information relevant to the security sensor. For example, when the security sensor setting information is used as the contents of the alive signal, an abnormality pattern, a white list, a black list, a transmission cycle, a version information, proof of authentication and the like of the relevant security sensor may be provided as the alive signal.</p><p id="p-0051" num="0050">A transmission timing of the alive signal is set to a predetermined cycle in the present embodiment. Instead, or in addition, the transmission timing of the alive signal may also be an update timing of the setting information of the security sensor, a timing at which a request from other process is received, or a detection timing of a predetermined security event.</p><p id="p-0052" num="0051">In the present embodiment, the subject of transmitting the alive signal is a security sensor that is subject to determination of &#x201c;life or death&#x201d; (operating/not operating) based on the alive signal. However, the alive signal may be transmitted from another process or ECU that monitors the security sensor, as a monitoring result of operation of the security sensor.</p><p id="p-0053" num="0052">(3) Configuration of an Attack Analyzer <b>100</b></p><p id="p-0054" num="0053">The attack analyzer <b>100</b> of the present embodiment will be described with reference to <figref idref="DRAWINGS">FIG. <b>3</b></figref>. The attack analyzer <b>100</b> is a device that detects and analyzes an attack on the electronic control system S described above. The attack analyzer <b>100</b> includes a security log acquisition unit <b>101</b>, an alive signal acquisition unit <b>102</b>, a prediction table storage unit <b>103</b>, an attack route estimation unit <b>104</b>, and an attack information output unit <b>105</b>. Further, the attack route estimation unit <b>104</b> includes a predicted attack route candidate selection unit <b>106</b> and a reliability calculation unit <b>107</b>.</p><p id="p-0055" num="0054">When the attack analyzer <b>100</b> is provided in a vehicle, it may be provided by connecting to the electronic control system S via an in-vehicle network. Alternatively, the attack analyzer <b>100</b> may be provided inside the electronic control system S. For example, the attack analyzer <b>100</b> may be provided as a function of CGW <b>13</b> or TCU <b>11</b>.</p><p id="p-0056" num="0055">The attack analyzer <b>100</b> may be composed of a general-purpose CPU (Central Processing Unit), a volatile memory such as RAM, a ROM, a flash memory, a non-volatile memory such as a hard disk, various interfaces, and an internal bus connecting them. Software is executed on the hardware, and thus a function of each functional block illustrated in <figref idref="DRAWINGS">FIG. <b>3</b></figref> can be realized. Of course, the attack analyzer <b>100</b> may also be realized by dedicated hardware such as LSI.</p><p id="p-0057" num="0056">In the present embodiment, the attack analyzer <b>100</b> assumes the form of an electronic control unit (hereinafter abbreviated as ECU) as a semi-finished product, but the attack analyzer <b>100</b> is not limited to such device. For example, the form of parts is a semiconductor circuit or semiconductor module, the form of a semi-finished product is an electronic control device, an electronic control unit, a system board, and the form of a finished product is a server, a workstation, or a personal computer (PC), a tablet, a smartphone, a mobile phone, a navigation system. Note that the attack analyzer <b>100</b> may be composed of a plurality of ECUs in addition to a single ECU.</p><p id="p-0058" num="0057">The security log acquisition unit <b>101</b> acquires a security log including an abnormality detection signal generated by a &#x201c;security sensor&#x201d; mounted on the ECU constituting the electronic control system S and indicating that the security sensor has detected an abnormality. For example, in the case of the arrangement shown in <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, the security log output to the in-vehicle network by the security sensor mounted on the TCU <b>11</b>, CGW <b>13</b>, ECU <b>14</b> to <b>17</b>, etc. of the electronic control system S is connected to the in-vehicle network is acquired by receiving it by the security log acquisition unit <b>101</b>. In the case of the arrangement shown in <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>, the security sensor mounted on the TCU <b>11</b>, CGW <b>13</b>, ECU <b>14</b>-<b>17</b>, etc. of the electronic control system S outputs the security log to the in-vehicle network, and the security log transmitted from the TCU <b>11</b> using wireless communication is received by the security log acquisition unit <b>101</b> connected to a network such as the Internet.</p><p id="p-0059" num="0058">Here, the &#x201c;security sensor&#x201d; refers to a function of monitoring an electronic control unit or a network constituting an electronic control system and outputting a security log when a security event occurs, and the means for realizing the sensor does not matter.</p><p id="p-0060" num="0059">The alive signal acquisition unit <b>102</b> acquires &#x201c;alive signal&#x201d; of a security sensor mounted on an ECU constituting the electronic control system S. For example, in the case of the arrangement shown in <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, the alive signal output to the in-vehicle network by the security sensor mounted on the TCU <b>11</b>, CGW <b>13</b>, ECU <b>14</b> to <b>17</b>, etc. of the electronic control system S is acquired by receiving it by the alive signal acquisition unit <b>102</b> connected to the in-vehicle network. In the case of the arrangement shown in <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>, the security sensor mounted on the TCU <b>11</b>, CGW <b>13</b>, ECU <b>14</b>-<b>17</b>, etc. of the electronic control system S outputs the alive signal to the in-vehicle network, and the alive signal transmitted from the TCU <b>11</b> using wireless communication is acquired by receiving it by the alive signal acquisition unit <b>102</b> connected to a network such as the Internet.</p><p id="p-0061" num="0060">Here, the &#x201c;alive signal&#x201d; is a signal directly or indirectly indicating whether the security sensor is operating or not and/or whether the security sensor is normally operating or not.</p><p id="p-0062" num="0061">Note that the security log acquisition unit <b>101</b> and the alive signal acquisition unit <b>102</b> may be realized as one acquisition unit.</p><p id="p-0063" num="0062">The prediction table storage unit <b>103</b> stores a prediction table showing a correspondence between a predicted attack route identified by a predicted attack start point and a predicted attack target in the electronic control system S, and a predicted abnormality detection signal predicted to be generated by the security sensor. The prediction table may sometimes be called as a pattern matching table or a matching table.</p><p id="p-0064" num="0063"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a diagram showing an example of a prediction table. The prediction table of <figref idref="DRAWINGS">FIG. <b>4</b></figref> is a table that associates which security sensor mounted on each ECU detects an abnormality when there is an attack on the predicted attack target from the predicted attack start point. In <figref idref="DRAWINGS">FIG. <b>4</b></figref>, &#x2018;1&#x2019; represents a state in which an abnormality is detected, and &#x2018;0&#x2019; represents a state in which an abnormality is not detected. That is, the predicted attack start point and the predicted attack target correspond to the &#x201c;predicted attack route,&#x201d; and 0 or 1 of each security sensor corresponds to the &#x201c;predicted abnormality detection signal&#x201d;.</p><p id="p-0065" num="0064">In the present embodiment, the predicted attack route is defined by the predicted attack start point and the predicted attack target. However, information on the relevant ECU existing en route from the predicted attack start point to the predicted attack target may be included therein.</p><p id="p-0066" num="0065">In the present embodiment, the patterns of the predicted abnormality detection signals of the security sensors of the TCU <b>11</b>, CGW <b>13</b>, and the ECU <b>14</b> are used, but the patterns of the predicted abnormality detection signals of the security sensors mounted on the other ECUs may also be used.</p><p id="p-0067" num="0066">Returning to <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the attack route estimation unit <b>104</b> estimates the attack route of the attack received by the electronic control system S from the abnormality detection signal (included in the security log) using the prediction table. Other embodiments will also consider the &#x201c;alive&#x201d; signal that indicates whether the sensor is in a &#x201c;normal state&#x201d; or &#x201c;alive state&#x201d; capable of detecting an abnormality and sending an abnormality signal, or whether the sensor is in an &#x201c;abnormal state&#x201d; or &#x201c;dead state&#x201d;.</p><p id="p-0068" num="0067">Preferably, the attack route estimation unit <b>104</b> has a predicted attack route candidate selection unit <b>106</b>. More preferably, the attack route estimation unit <b>104</b> has a reliability calculation unit <b>107</b>.</p><p id="p-0069" num="0068">The predicted attack route candidate selection unit <b>106</b> selects a predicted attack route candidate from among the predicted attack routes by comparing the abnormality detection signal and the predicted abnormality detection signal using the prediction table. The reliability calculation unit <b>107</b> uses the alive signal to obtain &#x201c;reliability&#x201d; indicating how certain a predicted attack route candidate is.</p><p id="p-0070" num="0069">Here, the &#x201c;reliability&#x201d; may be any indicator as long as it indicates a degree of certainty, and may include not only a numerical value but also a standardized value or a symbol or a set indicative thereof. The &#x201c;reliability&#x201d; may also be designated as &#x201c;predictability,&#x201d; &#x201c;accuracy of prediction&#x201d; or the like.</p><p id="p-0071" num="0070">The attack information output unit <b>105</b> outputs attack information indicating an estimated attack route estimated by the attack route estimation unit <b>104</b>. Preferably, the attack information output unit <b>105</b> outputs the attack information, estimating, as an attack route, the predicted attack route candidate selected by the predicted attack route candidate selection unit <b>106</b>. More preferably, the attack information output unit <b>105</b> outputs the attack information, estimating, as an attack route, the predicted attack route candidate selected by the predicted attack route candidate selection unit <b>106</b> and the reliability obtained by the reliability calculation unit <b>107</b>.</p><p id="p-0072" num="0071">Hereinafter, as example embodiments, a specific estimation method of the attack route estimation unit <b>104</b> and the contents of the attack information output by the attack information output unit <b>105</b> will be described with reference to <figref idref="DRAWINGS">FIGS. <b>5</b> to <b>7</b></figref>. <figref idref="DRAWINGS">FIGS. <b>5</b> to <b>7</b></figref> are diagrams respectively illustrating a method of selecting a predicted attack route candidate and a method of calculating reliability using the prediction table of <figref idref="DRAWINGS">FIG. <b>4</b></figref>.</p><heading id="h-0008" level="1">(a) Example Embodiment 1</heading><p id="p-0073" num="0072">The example embodiment 1 is an example of correcting the reliability obtained from the prediction table by using the alive signal. Hereinafter, the process will be described with reference to <figref idref="DRAWINGS">FIG. <b>5</b></figref>.</p><p id="p-0074" num="0073">It is assumed that a security sensor F of the CGW <b>13</b> outputs an abnormality detection signal, and the security log acquisition unit <b>101</b> receives the abnormality detection signal. Further, it is assumed that a security sensor A of the TCU <b>11</b> outputs an alive signal indicating that the operation of the security sensor A itself is abnormal, and the alive signal acquisition unit <b>102</b> receives the alive signal.</p><p id="p-0075" num="0074">The predicted attack route candidate selection unit <b>106</b> selects, from the prediction table, an event in which the security sensor F detects a predicted abnormality detection signal by comparing the abnormality detection signal with the predicted abnormality detection signal. In an example of <figref idref="DRAWINGS">FIG. <b>5</b></figref>, since events in which the security sensor F detects the predicted abnormality detection signal are an event E<b>1</b> and an event E<b>3</b>, the event E<b>1</b> and the event E<b>3</b> are selected as the predicted attack route candidates.</p><p id="p-0076" num="0075">The reliability calculation unit <b>107</b> obtains the reliability of the predicted attack route candidate selected by the predicted attack route candidate selection unit <b>106</b>. For example, the reliability is calculated by, for example, using (i) a ratio of the abnormality detection signal and the predicted abnormality detection signal of each of the predicted attack route candidates, (ii) weighting based on the importance of the sensor, and other predetermined operations.</p><p id="p-0077" num="0076">In the event E<b>1</b>, the reliability is set to 0.5 by a predetermined calculation based on the fact that the abnormality detection signal comes only from the security sensor F, while the predicted abnormality detection signal comes from the security sensors E, F, and G.</p><p id="p-0078" num="0077">In event E<b>3</b>, the reliability is set to 0.4 by a predetermined calculation based on the fact that the abnormality detection signal comes only from the security sensor F, while the predicted abnormality detection signal comes from the security sensors A, D, F, and G.</p><p id="p-0079" num="0078">Further, since the alive signal indicates that &#x201c;the operation of the security sensor A itself is abnormal,&#x201d; the reliability calculation unit <b>107</b> performs processing to increase the reliability of the predicted attack route candidate including, in the route, the TCU <b>11</b> that has the security sensor A (corresponding to the &#x201c;abnormal security sensor&#x201d;).</p><p id="p-0080" num="0079">In the example of <figref idref="DRAWINGS">FIG. <b>5</b></figref>, since it is the event E<b>3</b> that the TCU <b>11</b> is &#x201c;reliably&#x201d; included in a route between the predicted attack start point and the predicted attack target, a predetermined value, a in the present embodiment, is added to the reliability of the event E<b>3</b> for setting a new reliability of the event E<b>3</b>. The value a may be a constant or a variable that changes depending on the conditions. It should be noted that the reliability of the event E<b>1</b> will not be corrected, since the event E<b>1</b> may have an IVI<b>12</b> as an entry point, suggesting that the TCU <b>11</b> is not necessarily included in the route.</p><p id="p-0081" num="0080">Here, &#x201c;the operation of the security sensor itself is abnormal&#x201d; means that the security sensor is not operating or the operation of the security sensor is not normal. In other words, the security sensor itself is &#x201c;in an abnormal state&#x201d;. For simplicity, in other words, the security sensor is &#x201c;dead&#x201d;. This abnormal state may be outputting a zero voltage, or refusing to reply to requests for information, or another situation indicating that the security sensor cannot output an abnormality signal indicating that an abnormality is detected or determined.</p><p id="p-0082" num="0081">The attack information output unit <b>105</b> outputs attack information using event E<b>1</b> and event E<b>3</b>, which are the predicted attack route candidates, as the attack routes. At such timing, as the attack route, the reliability (0.5) of the event E<b>1</b> and the reliability (0.4+&#x3b1;) of the situation E<b>3</b> may be included in the output.</p><p id="p-0083" num="0082">Note that, in the description of this example embodiment, an example where the alive signal of the security sensor A is received is described. However, even when the alive signal is not received, it is assumed that the security sensor A is not operating and the same processing is performed. That is, &#x201c;a situation where the alive signal indicates that the operation of the security sensor itself is abnormal&#x201d; is a concept including &#x201c;a situation where the operation of the security sensor itself is indicated abnormal by an absence of the alive signal (i.e., not receiving the alive signal)&#x201d;. The same applies to an example embodiment 2 described later.</p><p id="p-0084" num="0083">Further, in the description of the present embodiment, the reliability is firstly obtained without using the alive signal, and then the reliability is corrected by using the alive signal. However, the reliability calculation may be performed by not using such a two-step calculation. The same applies to an example embodiment 3 described later.</p><p id="p-0085" num="0084">According to the present example embodiment, since the reliability is obtained by using the alive signal in addition to the conventional abnormality detection signal, the estimation accuracy of the attack route estimation unit <b>104</b> can be improved. Furthermore, since the security sensor employs a reliability calculation method that takes into account the possibility that the operation has become abnormal due to an attack, the accuracy of attack route estimation can be improved.</p><heading id="h-0009" level="1">(b) Example Embodiment 2</heading><p id="p-0086" num="0085">In the example embodiment 2, the alive signal is used to limit or narrow or sift a part of the prediction table to be used to obtain the reliability. Hereinafter, the process will be described with reference to <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0087" num="0086">The abnormality detection signal and the alive signal to be received are the same as those in the first embodiment. That is, it is assumed that the security sensor F of the CGW <b>13</b> outputs an abnormality detection signal, and the security log acquisition unit <b>101</b> receives this abnormality detection signal.</p><p id="p-0088" num="0087">Further, it is assumed that the security sensor A of the TCU <b>11</b> outputs an alive signal indicating that the operation of the security sensor A itself is abnormal, and the alive signal acquisition unit <b>102</b> receives the alive signal.</p><p id="p-0089" num="0088">The operation of the predicted attack route candidate selection unit <b>106</b> is the same as that of the example embodiment 1. That is, the predicted attack route candidate selection unit <b>106</b> selects, from the prediction table, an event in which the security sensor F detects a predicted abnormality detection signal, by comparing the abnormality detection signal with the predicted abnormality detection signal.</p><p id="p-0090" num="0089">In an example of <figref idref="DRAWINGS">FIG. <b>6</b></figref>, since the events in which the security sensor F detects the predicted abnormality detection signal are the event E<b>1</b> and the event E<b>3</b>, the event E<b>1</b> and the event E<b>3</b> are selected as the predicted attack route candidates.</p><p id="p-0091" num="0090">The reliability calculation unit <b>107</b> obtains the reliability of the predicted attack route candidate selected by the predicted attack route candidate selection unit <b>106</b>. However, if the alive signal indicates that &#x201c;the operation of the security sensor A itself is abnormal,&#x201d; the predicted abnormality detection signal corresponding to the security sensor A (corresponding to the &#x201c;abnormal security sensor&#x201d;) is not used to calculate the reliability.</p><p id="p-0092" num="0091">In the example embodiment 2 as well, the reliability is calculated using the same calculation as in the example embodiment 1. In the event E<b>1</b>, the reliability is set to 0.5 by a predetermined calculation based on the fact that the abnormality detection signal comes only from the security sensor F, while the predicted abnormality detection signal comes from the security sensors E, F, and G. On the other hand, in the event E<b>3</b>, the abnormality detection signal comes only from the security sensor F, while the predicted abnormality detection signal comes from the security sensors A, D, F, and G. However, since the alive signal indicates that the operation of the security sensor A itself is abnormal, the predicted abnormality detection signal of the security sensor A is not used for calculating the reliability. As a result, the reliability is set to 0.5.</p><p id="p-0093" num="0092">The attack information output unit <b>105</b> outputs attack information using event E<b>1</b> and event E<b>3</b>, which are predicted attack route candidates, as attack routes. This time, as the attack route, the reliability (0.5) of the event E<b>1</b> and the reliability (0.5) of the event E<b>3</b> may be included in the output.</p><p id="p-0094" num="0093">According to this example embodiment, since the reliability is obtained by using the alive signal in addition to the conventional abnormality detection signal, the estimation accuracy of the attack route estimation unit <b>104</b> can be improved. Further, since the security sensor employs a reliability calculation method that takes into account the possibility that the operation has become abnormal due to the attack, the accuracy of attack route estimation can be improved.</p><heading id="h-0010" level="1">(c) Example Embodiment 3</heading><p id="p-0095" num="0094">The example embodiment 3 is different from the example embodiments 1 and 2, and is an example showing that the operation of the security sensor is normal. Hereinafter, the process will be described with reference to <figref idref="DRAWINGS">FIG. <b>7</b></figref>.</p><p id="p-0096" num="0095">The abnormality detection signal to be received is the same as that in the example embodiment 1. Namely, it is assumed that the security sensor F of the CGW <b>13</b> outputs an abnormality detection signal, and the security log acquisition unit <b>101</b> receives the abnormality detection signal. Then, in this example embodiment 3, it is assumed that a security sensor J of the ECU <b>14</b> outputs an alive signal indicating that the operation of the security sensor J itself is normal, and the alive signal acquisition unit <b>102</b> receives the alive signal.</p><p id="p-0097" num="0096">The operation of the predicted attack route candidate selection unit <b>106</b> is the same as that of the first embodiment. That is, the predicted attack route candidate selection unit <b>106</b> selects, from the prediction table, an event in which the security sensor F detects a predicted abnormality detection signal, by comparing the abnormality detection signal with the predicted abnormality detection signal. In an example of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, since the events in which the security sensor F detects the predicted abnormality detection signal are the event E<b>1</b> and the event E<b>3</b>, the event E<b>1</b> and the event E<b>3</b> are selected as the predicted attack route candidates.</p><p id="p-0098" num="0097">The method of obtaining the reliability in the reliability calculation unit <b>107</b> is the same as that in the example embodiment 1. That is, the reliability of the event E<b>1</b> is 0.5, and the reliability of event E<b>3</b> is 0.4.</p><p id="p-0099" num="0098">Further, since the alive signal indicates that &#x201c;the operation of the security sensor J itself is normal,&#x201d; the reliability calculation unit <b>107</b> performs processing to raise the reliability of the predicted attack route candidate that does not include the ECU <b>14</b> having the security sensor J (corresponding to the &#x201c;normal security sensor&#x201d;) in the route.</p><p id="p-0100" num="0099">In an example of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, since it is the event E<b>1</b> and the event E<b>3</b> that the ECU <b>14</b> is not included in the route between the predicted attack start point and the predicted attack target, a predetermined value, i.e., a in this example embodiment 3, is added to the reliability of event E<b>1</b> and event E<b>3</b>, which serves as a new reliability. The value a may be a constant or a variable that changes depending on the conditions.</p><p id="p-0101" num="0100">Here, &#x201c;the operation of the security sensor itself is normal&#x201d; means that the security sensor is operating and the security sensor is operating normally.</p><p id="p-0102" num="0101">The attack information output unit <b>105</b> outputs attack information using the event E<b>1</b> and the event E<b>3</b>, which are predicted attack route candidates, as the attack routes. This time, the reliability of the event E<b>1</b> (0.5+&#x3b1;) and the reliability of the event E<b>3</b> (0.4+&#x3b1;) may be included in the output as the attack route.</p><p id="p-0103" num="0102">According to the example embodiment 3, since the reliability is obtained by using the alive signal in addition to the conventional abnormality detection signal, the estimation accuracy of the attack route estimation unit <b>104</b> can be improved. Further, since the reliability calculation method that takes into account that the operation of the security sensor is normal is adopted, the accuracy of attack route estimation can be improved.</p><heading id="h-0011" level="1">(d) Other Example Embodiments</heading><p id="p-0104" num="0103">In the example embodiment 1, whether or not the reliability correction is necessary is determined based on whether or not an ECU includes a security sensor whose operation is abnormal is included in the predicted attack route. Such a determination scheme is the same as the one that determines whether or not the reliability correction is necessary based on whether or not a security sensor whose operation is abnormal is included in the predicted attack route.</p><p id="p-0105" num="0104">Further, in the example embodiment 1, the necessity of correcting the reliability may be determined depending on whether or not a layer to which an ECU having a security sensor whose operation is abnormal belongs is included in the predicted attack route.</p><p id="p-0106" num="0105">The same applies to the example embodiment 3.</p><p id="p-0107" num="0106">In the example embodiments 1 to 3, all of the predicted attack route candidates selected by the predicted attack route candidate selection unit <b>106</b> are output from the attack information output unit <b>105</b> as attack routes, but only a part of the predicted attack route candidates may be output as attack routes. For example, the predicted attack route candidates having the top three reliabilities may be output as attack routes.</p><p id="p-0108" num="0107">In the example embodiments 1 to 3, only the event having the predicted attack route in the prediction table is picked up, but in addition, an erroneous response of the security sensor itself may be additionally picked up as an event. In the examples of <figref idref="DRAWINGS">FIGS. <b>4</b> to <b>7</b></figref>, an event E<b>5</b> is the one indicating an erroneous response of the security sensor itself.</p><p id="p-0109" num="0108">(4) Operation of an Attack Analyzer <b>100</b></p><p id="p-0110" num="0109">The operation of the attack analyzer <b>100</b> will be described with reference to <figref idref="DRAWINGS">FIG. <b>8</b></figref>. <figref idref="DRAWINGS">FIG. <b>8</b></figref> not only shows an attack analysis method performed by the attack analyzer <b>100</b>, but also shows a processing procedure of an attack analysis program that can be executed by the attack analyzer <b>100</b>. An execution order of processes are not limited to the one shown in <figref idref="DRAWINGS">FIG. <b>8</b></figref>. That is, the order may be changed as long as there are no restrictions such as a relationship in which a result of a preceding step is used in a certain step.</p><p id="p-0111" num="0110">The attack analyzer <b>100</b> includes a prediction table storage unit <b>103</b> for storing a prediction table showing a correspondence between (i) the predicted attach route identified by the predicted attack start point and the predicted attack target in the electronic control system S and (ii) the predicted abnormality detection signal predicted to be generated by the security sensor.</p><p id="p-0112" num="0111">In S<b>101</b>, a security log is acquired, which (i) is generated by a security sensor mounted on an electronic control device constituting the electronic control system S and (ii) includes an abnormality detection signal indicating that the security sensor has detected an abnormality.</p><p id="p-0113" num="0112">In S<b>102</b>, an alive signal of a security sensor is acquired.</p><p id="p-0114" num="0113">In S<b>103</b>, a prediction table is read from the prediction table storage unit <b>103</b>, and an attack route of an attack received by the electronic control system S is estimated from the abnormality detection signal included in the security log acquired in S<b>101</b> and the alive signal acquired in S<b>102</b>.</p><p id="p-0115" num="0114">Then, in S<b>104</b>, the attack information indicating the attack route estimated in S<b>103</b> is output.</p><p id="p-0116" num="0115">(5) Summary</p><p id="p-0117" num="0116">As described above, according to the attack analysis device <b>100</b> of the present disclosure, when the electronic control system S is subjected to a cyber attack, the reliability of the estimated attack route is obtained by using the alive signal of the security sensor mounted on the electronic control device constituting the electronic control system S.</p><p id="p-0118" num="0117">Since the alive signal is a signal that allows objective evaluation of the life or death (e.g., operation) of the function of the security sensor and the normality/abnormality of the operation of the security sensor, by using the alive for the evaluation of the reliability of the attack route, the attack route can be estimated more accurately than the method of using the conventional abnormality detection signal only.</p><p id="p-0119" num="0118">The alive signal can also be used to estimate a damage caused by the attack. For example, it is possible to estimate a situation in which the security sensor is invalidated by an attack or a situation in which the ECU is operated/hijacked by an attacker due to an attack.</p><heading id="h-0012" level="1">2. Other Embodiments</heading><p id="p-0120" num="0119">In the first embodiment, the reliability of the attack route is obtained by using the alive signal and the contents of the alive signal. However, the setting information of the security sensor exemplified as the contents of the alive signal can also be output to the in-vehicle network as a signal different from the alive signal. When such security sensor setting information is used, the alive signal does not necessarily have to be used to obtain the reliability of the attack route. Examples of security sensor setting information include security sensor abnormality patterns, whitelists, blacklists, transmission cycles, security sensor version information, certificates, and the like.</p><p id="p-0121" num="0120">When the setting information of the security sensor is used instead of the alive signal, the present disclosure can be grasped as having the following aspect.</p><p id="p-0122" num="0121">An attack analyzer of the present disclosure includes:</p><p id="p-0123" num="0122">a security log acquisition unit acquiring a security log including an abnormality detection signal generated by a security sensor and indicating that the security sensor has detected an abnormality, the security sensor mounted on an electronic control device constituting an electronic control system;</p><p id="p-0124" num="0123">an alive signal acquisition unit that acquires setting information of the security sensor;</p><p id="p-0125" num="0124">a prediction table storage unit storing a prediction table showing a correspondence relationship between a predicted attack route in the electronic control system and a predicted abnormality detection signal predicted to be generated by the security sensor;</p><p id="p-0126" num="0125">an attack route estimation unit estimating, using the prediction table, the attack route of an attack received by the electronic control system from the abnormality detection signal and the setting information included in the security log; and</p><p id="p-0127" num="0126">an attack information output unit outputting attack information indicating the attack route.</p><heading id="h-0013" level="1">3. Conclusion</heading><p id="p-0128" num="0127">The features of the attack analyzer and the like in each of the embodiments of the present disclosure have been described above.</p><p id="p-0129" num="0128">Since the terms used in the embodiments are examples, the terms may be replaced with terms that are synonymous or that include synonymous functions.</p><p id="p-0130" num="0129">The block diagram used for the description of the embodiment is obtained by classifying and arranging, as respective blocks, functions of various kinds which may be implemented by arbitrarily combining hardware and software. Further, since the block diagram illustrates functions, the block diagram can be understood as disclosure of a method and a program that implements the method.</p><p id="p-0131" num="0130">Function blocks that can be understood as processes, flows, and methods described in the respective embodiments may be changed in order (e.g., re-arranged) as long as there is no restrictions such as a relationship in which results of preceding other steps are used in one step.</p><p id="p-0132" num="0131">The terms such as first, second, to N-th (where N is an integer) used in each of the embodiments and in claims are used to distinguish two or more configurations and methods of the same kind and are not intended to limit the order or superiority/priority.</p><p id="p-0133" num="0132">Each of the embodiments is provided based on an assumption of providing a vehicle attack analyzer for analyzing an attack on an electronic control system mounted on a vehicle, but the present disclosure encompasses, unless otherwise limited within the scope of the claims, other dedicated or general-purpose devices.</p><p id="p-0134" num="0133">Further, as an example form of the attack analyzer of the present disclosure, the following can be mentioned. Examples of a form of a component include a semiconductor device, an electronic circuit, a module, and a microcomputer. Examples of a form of a semi-finished product include an electronic control device (i.e., electronic control unit or ECU) and a system board. Examples of a form of a finished product include a cellular phone, a smartphone, a tablet computer, a personal computer (PC), a workstation, and a server. The example forms may further include a device having a communication function and the like, such as for example, a video camera, a still camera, and a car navigation system, for example.</p><p id="p-0135" num="0134">In addition, necessary functions such as an antenna and a communication interface may be added to the attack analyzer.</p><p id="p-0136" num="0135">It is assumed that the attack analyzer of the present disclosure is used for the purpose of providing various services, especially by being used on the server side. For providing such services, the attack analyzer of the present disclosure is used, the method of the present disclosure is used, and/or the program of the present disclosure is executed.</p><p id="p-0137" num="0136">Further, the present disclosure is implemented not only by dedicated hardware having a configuration and a function described in relation to each of the embodiments, but by a combination of (i) a program for implementing the present disclosure, which is recorded on such a recording medium as memory, a hard disk and the like, and (ii) general-purpose hardware including dedicated or general-purpose CPU, memory, or the like, capable of executing the program.</p><p id="p-0138" num="0137">A program stored in a non-transitory, tangible storage medium (for example, an external storage device (a hard disk, a USB memory, a CD/BD, or the like) of dedicated or general-purpose hardware, or stored in an internal storage device (a RAM, a ROM, or the like)) may be provided to dedicated or general-purpose hardware via a recording medium, or from a server via a communication line without using the recording medium. In such manner, it is possible to always provide a latest, up-to-date function by updating the program.</p><p id="p-0139" num="0138">In summary, an attack analyzer includes:</p><p id="p-0140" num="0139">a security log acquisition unit acquiring a security log (i) including an abnormality detection signal generated by a security sensor and (ii) indicating that the security sensor has detected an abnormality, the security sensor associated with an electronic control device constituting part of an electronic control system;</p><p id="p-0141" num="0140">a failure information acquisition unit acquiring failure information indicating that a failure occurred in the electronic control device;</p><p id="p-0142" num="0141">a prediction table storage unit storing a prediction table showing a correspondence relationship between (i) a predicted attack route associated with the electronic control system and (ii) a predicted abnormality detection signal predicted to be generated by the security sensor;</p><p id="p-0143" num="0142">an attack route estimation unit estimating, using the prediction table, the attack route of an attack received by the electronic control system based at least partly on the security log including the abnormality detection signal and the failure information; and</p><p id="p-0144" num="0143">an attack information output unit outputting attack information indicating the attack route.</p><heading id="h-0014" level="1">INDUSTRIAL APPLICABILITY</heading><p id="p-0145" num="0144">The attack analyzer of the present disclosure is mainly intended for or targeting a device that analyzes a cyber attack received by an electronic control system mounted on an automobile, but may also be intended for or targeting a device that analyzes an attack on a normal system that is not mounted on an automobile.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. An attack analyzer comprising:<claim-text>a security log acquisition unit acquiring a security log (i) including an abnormality detection signal generated by a security sensor and (ii) indicating that the security sensor has detected an abnormality, the security sensor associated with an electronic control device constituting part of an electronic control system;</claim-text><claim-text>a failure information acquisition unit acquiring failure information indicating that a failure occurred in the electronic control device;</claim-text><claim-text>a prediction table storage unit storing a prediction table showing a correspondence relationship between (i) a predicted attack route associated with the electronic control system and (ii) a predicted abnormality detection signal predicted to be generated by the security sensor;</claim-text><claim-text>an attack route estimation unit estimating, using the prediction table, the attack route of an attack received by the electronic control system based at least partly on the security log including the abnormality detection signal and the failure information; and</claim-text><claim-text>an attack information output unit outputting attack information indicating the attack route.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The attack analyzer of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the attack route estimation unit includes a predicted attack route candidate selection unit selecting a predicted attack route candidate from among the predicted attack routes by comparing the abnormality detection signal and the predicted abnormality detection signal using the prediction table, and</claim-text><claim-text>the attack information output unit outputs the attack information, which is the predicted attack route candidate, as the attack route.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The attack analyzer of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein<claim-text>the attack route estimation unit further includes a reliability calculation unit calculating a reliability of the predicted attack route candidate using the alive signal, and</claim-text><claim-text>the attack information output unit outputs the attack information, which is the predicted attack route candidate and the reliability, as the attack route.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The attack analyzer of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein<claim-text>when the alive signal indicates that the operation of the security sensor itself is abnormal, the reliability calculation unit raises the reliability of the predicted attack route candidate including the abnormal security sensor in the attack route.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The attack analyzer of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein<claim-text>when the alive signal indicates that the operation of the security sensor itself is abnormal, the reliability calculation unit refrains from using the predicted abnormality detection signal corresponding to the abnormal security sensor for the calculation of the reliability.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The attack analyzer of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein<claim-text>when the alive signal indicates that the operation of the security sensor itself is normal, the reliability calculation unit raises the reliability of the predicted attack route candidate that does not include the normal security sensor in the attack route.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The attack analyzer of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the alive signal is a signal transmitted in a predetermined cycle by the security sensor.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The attack analyzer of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the predicted attack route is identified by a predicted attack start point and a predicted attack target.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The attack analyzer of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the electronic control system and the attack analyzer are mounted on a movable body.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The attack analyzer of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the electronic control system is mounted on a movable body, and</claim-text><claim-text>the attack analyzer is a server device disposed outside of the movable body.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. An attack analyze method performed by an attack analyzer including a prediction table storage unit storing a prediction table showing a correspondence relationship between a predicted attack route in an electronic control system and a predicted abnormality detection signal predicted to be generated by a security sensor, the attack analyze method comprising steps of:<claim-text>acquiring a security log (i) including an abnormality detection signal generated by the security sensor and (ii) indicating that the security sensor has detected an abnormality, the security sensor mounted on an electronic control device constituting the electronic control system;</claim-text><claim-text>acquiring an alive signal of the security sensor;</claim-text><claim-text>estimating an attack route of an attack received by the electronic control system from the abnormality detection signal and the alive signal included in the security log by reading the prediction table; and</claim-text><claim-text>outputting attack information indicating the attack route.</claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. A tangible, non-transitory storage medium storing instructions to control a computer to serve as an attack analyzer including a prediction table storage unit storing a prediction table showing a correspondence relationship between a predicted attack route in an electronic control system and a predicted abnormality detection signal predicted to be generated by a security sensor, the instructions to be executed by the computer comprising steps of:<claim-text>acquiring a security log including (i) an abnormality detection signal generated by the security sensor and (ii) indicating that the security sensor has detected an abnormality, the security sensor mounted on an electronic control device constituting part of the electronic control system;</claim-text><claim-text>acquiring an alive signal of the security sensor;</claim-text><claim-text>estimating an attack route of an attack received by the electronic control system from the abnormality detection signal and the alive signal included in the security log by reading the prediction table; and</claim-text><claim-text>outputting attack information indicating the attack route.</claim-text></claim-text></claim></claims></us-patent-application>