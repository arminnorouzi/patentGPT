<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230005711A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230005711</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17778758</doc-number><date>20201104</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>JP</country><doc-number>2019-210594</doc-number><date>20191121</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>01</class><subclass>J</subclass><main-group>37</main-group><subgroup>304</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>01</class><subclass>J</subclass><main-group>37</main-group><subgroup>12</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>01</class><subclass>J</subclass><main-group>37</main-group><subgroup>317</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>01</class><subclass>J</subclass><main-group>37</main-group><subgroup>14</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>03</class><subclass>F</subclass><main-group>7</main-group><subgroup>20</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>01</class><subclass>J</subclass><main-group>37</main-group><subgroup>304</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>01</class><subclass>J</subclass><main-group>37</main-group><subgroup>12</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>01</class><subclass>J</subclass><main-group>37</main-group><subgroup>3177</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>01</class><subclass>J</subclass><main-group>37</main-group><subgroup>14</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>03</class><subclass>F</subclass><main-group>7</main-group><subgroup>70383</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>03</class><subclass>F</subclass><main-group>7</main-group><subgroup>7005</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>03</class><subclass>F</subclass><main-group>7</main-group><subgroup>7055</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>01</class><subclass>J</subclass><main-group>37</main-group><subgroup>045</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">MULTI CHARGED PARTICLE BEAM ADJUSTMENT METHOD, MULTI CHARGED PARTICLE BEAM IRRADIATION METHOD, AND MULTI CHARGED PARTICLE BEAM IRRADIATION APPARATUS</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>NuFlare Technology, Inc.</orgname><address><city>Yokohama-shi</city><country>JP</country></address></addressbook><residence><country>JP</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>NANAO</last-name><first-name>Tsubasa</first-name><address><city>Yokohama-shi</city><country>JP</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>MORITA</last-name><first-name>Hirofumi</first-name><address><city>Yokohama-shi</city><country>JP</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>TOUYA</last-name><first-name>Takana</first-name><address><city>Yokohama-shi</city><country>JP</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>NuFlare Technology, Inc.</orgname><role>03</role><address><city>Yokohama-shi</city><country>JP</country></address></addressbook></assignee></assignees><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/JP2020/041173</doc-number><date>20201104</date></document-id><us-371c12-date><date>20220520</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">The present invention quickly calculates values of optimal excitation parameters which are set in lenses in multiple stages. A multi charged particle beam adjustment method includes forming a multi charged particle beam, calculating, for each of lenses in two or more stages disposed corresponding to object lenses in two or more stages, a first rate of change and a second rate of change in response to change in at least an excitation parameter, the first rate of change being a rate of change in a demagnification level of a beam image of the multi charged particle beam, the second rate of change being a rate of change in a rotation level of the beam image, and calculating a first amount of correction to the excitation parameter of each of the lenses based on an amount of correction to the demagnification level and the rotation level of the beam image, the first rate of change, and the second rate of change.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="152.23mm" wi="149.86mm" file="US20230005711A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="154.86mm" wi="151.89mm" file="US20230005711A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="164.59mm" wi="124.21mm" file="US20230005711A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="179.66mm" wi="154.77mm" file="US20230005711A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="90.00mm" wi="107.10mm" file="US20230005711A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">TECHNICAL FIELD</heading><p id="p-0002" num="0001">The present invention relates to a multi charged particle beam adjustment method, a multi charged particle beam irradiation method, and a multi charged particle beam irradiation apparatus.</p><heading id="h-0002" level="1">BACKGROUND</heading><p id="p-0003" num="0002">As LSI circuits are increasing in density, the line width of circuits of semiconductor devices is becoming finer. To form a desired circuit pattern onto a semiconductor device, a method of demagnifying and transferring, by using a demagnification-projection exposure apparatus, onto a wafer a highly precise original image pattern formed on a quartz is employed. The highly precise original image pattern is written by using an electron beam writing apparatus, in which a technology commonly known as electron beam lithography is used.</p><p id="p-0004" num="0003">A writing apparatus using a multi-beam is being developed as an electron beam writing apparatus to replace an existing single beam writing apparatus which deflects a single beam, and irradiates a desired portion on a substrate with the beam. Many beams can be radiated using a multi-beam, as compared with when writing is performed with a single electron beam, thus the throughput can be significantly improved. In a multi beam writing apparatus, for example, an electron beam discharged from an electron gun passes through an aperture member having multiple openings to form a multi-beam, and blanking control is performed on each of the multi-beam by a blanking plate. The beam not blocked is demagnified by an optical system, and radiated to a substrate placed on a movable stage.</p><p id="p-0005" num="0004">In an electron beam writing apparatus, the beam of each shot is focused on a substrate by object lenses, and focus correction (dynamic focusing) is dynamically performed using, for example, electrostatic lenses to cope with the unevenness on the substrate surface during writing. However, when dynamic focusing is performed, rotation and magnification change of a beam image occur on the substrate, thus the writing positional accuracy is degraded. Thus, it is required that the rotation and magnification change of a beam image due to the dynamic focusing be reduced as much as possible.</p><p id="p-0006" num="0005">In order to reduce the rotation and magnification change of a beam image due to dynamic focusing, it has been proposed that electrostatic lenses in multiple stages be provided, and a voltage to be applied to each electrostatic lens be determined by a simulation or an experiment (see, for example, PTL 6). However, a tolerance and an analysis error occur between a simulation and an actual machine. In addition, a specific technique to determine the voltage to be applied to the electrostatic lens by an experiment has not been disclosed.</p><heading id="h-0003" level="1">CITATION LIST</heading><heading id="h-0004" level="1">Patent Literature</heading><p id="p-0007" num="0000"><ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0006">PTL 1: Japanese Unexamined Patent Application Publication No. 2003-332206</li>    <li id="ul0001-0002" num="0007">PTL 2: Japanese Unexamined Patent Application Publication No. 2003-297732</li>    <li id="ul0001-0003" num="0008">PTL 3: Japanese Unexamined Patent Application Publication No. 2003-203836</li>    <li id="ul0001-0004" num="0009">PTL 4: Japanese Unexamined Patent Application Publication No. 2014-127568</li>    <li id="ul0001-0005" num="0010">PTL 5: Japanese Unexamined Patent Application Publication No. 2018-198235</li>    <li id="ul0001-0006" num="0011">PTL 6: Japanese Unexamined Patent Application Publication No. 2013-197289</li></ul></p><heading id="h-0005" level="1">SUMMARY OF INVENTION</heading><p id="p-0008" num="0012">It is an object of the present invention to provide a multi charged particle beam adjustment method, a multi charged particle beam irradiation method, and a multi charged particle beam irradiation apparatus which are capable of quickly calculating the values of optimal excitation parameters which are set in lenses in multiple stages to reduce the rotation and magnification change of a beam image due to dynamic focusing.</p><p id="p-0009" num="0013">According to one aspect of the present invention, a multi charged particle beam adjustment method includes forming a multi charged particle beam, calculating, for each of lenses in two or more stages disposed corresponding to object lenses in two or more stages, a first rate of change and a second rate of change in response to change in at least an excitation parameter, the first rate of change being a rate of change in a demagnification level of a beam image of the multi charged particle beam, the second rate of change being a rate of change in a rotation level of the beam image, and calculating a first amount of correction to the excitation parameter of each of the lenses based on an amount of correction to the demagnification level and the rotation level of the beam image, the first rate of change, and the second rate of change.</p><p id="p-0010" num="0014">According to one aspect of the present invention, a multi charged particle beam irradiation method includes forming a multi charged particle beam, calculating, for each of lenses in two or more stages disposed corresponding to object lenses in two or more stages, a first rate of change and a second rate of change in response to change in at least an excitation parameter, the first rate of change being a rate of change in a demagnification level of a beam image of the multi charged particle beam, the second rate of change being a rate of change in a rotation level of the beam image, calculating a first amount of correction to the excitation parameter of each of the lenses based on an amount of correction to the demagnification level and the rotation level of the beam image, the first rate of change, and the second rate of change, and setting the excitation parameter with the first amount of correction added to the lenses, and irradiating a substrate with the multi charged particle beam.</p><p id="p-0011" num="0015">According to one aspect of the present invention, a multi charged particle beam irradiation apparatus includes a plurality of blankers performing blanking deflection on respective parts of a multi charged particle beam, a limiting aperture member blocking beams which are deflected by the plurality of blankers to assume a beam off state, object lenses in two or more stages, that focus the multi charged particle beam which has passed the limiting aperture member to a substrate, lenses in two or more stages disposed corresponding to the object lenses, and a controller calculating a first amount of correction to an excitation parameter of each of the lenses based on a first rate of change, a second rate of change, and an amount of correction in response to change in the excitation parameter for each of the lenses, and setting the excitation parameter with the first amount of correction added to the lenses, the first rate of change being a rate of change in a demagnification level of a beam image of the multi charged particle beam, the second rate of change being a rate of change in a rotation level of the beam image, the amount of correction being made to the demagnification level and the rotation level of the beam image.</p><heading id="h-0006" level="1">Advantageous Effects of Invention</heading><p id="p-0012" num="0016">According to the present invention, it is possible to quickly calculate the values of optimal excitation parameters which are set in lenses in multiple stages to reduce the rotation and magnification change of a beam image due to dynamic focusing.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0007" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p-0013" num="0017"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a schematic diagram of a multi charged particle beam writing apparatus according to an embodiment of the present invention.</p><p id="p-0014" num="0018"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a schematic view of an aperture member.</p><p id="p-0015" num="0019"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a view showing an example of a beam shape.</p><p id="p-0016" num="0020"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a view showing an example of a focus position.</p><p id="p-0017" num="0021"><figref idref="DRAWINGS">FIG. <b>5</b><i>a </i></figref>is a graph showing a change in demagnification term of a beam image with respect to voltage, <figref idref="DRAWINGS">FIG. <b>5</b><i>b </i></figref>is a graph showing a change in rotational term of a beam image with respect to voltage, and <figref idref="DRAWINGS">FIG. <b>5</b><i>c </i></figref>is a graph showing a change in focus position with respect to voltage.</p><p id="p-0018" num="0022"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a graph showing a change in a demagnification term of a beam image with respect to Z height.</p><p id="p-0019" num="0023"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a view showing rotation of a substrate with respect to a stage movement direction.</p><p id="p-0020" num="0024"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a view showing an example of a beam shape.</p><p id="p-0021" num="0025"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a view showing an example of a focus position.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0008" level="1">DESCRIPTION OF EMBODIMENTS</heading><p id="p-0022" num="0026">Hereinafter, an embodiment of the present invention will be described with reference to the drawings.</p><p id="p-0023" num="0027"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a schematic diagram of a multi charged particle beam writing apparatus according to an embodiment of the present invention. In the present embodiment, as an example of a charged particle beam, a configuration using an electron beam will be described. However, the charged particle beam is not limited to an electron beam, and another charged particle beam, such as an ion beam may be used.</p><p id="p-0024" num="0028">The writing apparatus includes: a writer W that writes a desired pattern by irradiating a substrate <b>24</b> as a writing target with an electron beam; and a controller C that controls the operation of the writer W.</p><p id="p-0025" num="0029">The writer W has an electron beam column <b>2</b> and a writing chamber <b>20</b>. In the electron beam column <b>2</b>, an electron gun <b>4</b>, an illuminating lens <b>6</b>, an aperture member <b>8</b>, a blanking plate <b>10</b>, a demagnifying lens <b>12</b>, a limiting aperture member <b>14</b>, objective lenses in three stages <b>16</b>, <b>17</b>, <b>18</b>, and electrostatic lenses in three stages <b>66</b>, <b>67</b>, <b>68</b> are disposed. The electrostatic lens <b>66</b> is disposed in the magnetic field of the object lens <b>16</b> comprised of an electromagnetic lens. The electrostatic lens <b>67</b> is disposed in the magnetic field of the object lens <b>17</b> comprised of an electromagnetic lens. The electrostatic lens <b>68</b> is disposed in the magnetic field of the object lens <b>18</b> comprised of an electromagnetic lens.</p><p id="p-0026" num="0030">An XY stage <b>22</b> is disposed in the writing chamber <b>20</b>. The substrate <b>24</b> as a writing target is placed on the XY stage <b>22</b>. The substrate <b>24</b> as a writing target is, for example, a mask blank or a semiconductor substrate (silicon wafer).</p><p id="p-0027" num="0031">In addition, an inspection aperture <b>40</b> and a current detector <b>50</b> are disposed on the XY stage <b>22</b> at a position different from the position where the substrate <b>24</b> is placed. The inspection aperture <b>40</b> is preferably installed at the position with the same height as the substrate <b>24</b>.</p><p id="p-0028" num="0032">In the inspection aperture <b>40</b>, an opening is formed which allows only one electron beam among a multi-beam to pass through. The electron beam, which has passed through the opening of the inspection aperture <b>40</b>, enters the current detector <b>50</b>, and a beam current is detected. For example, an SSD (semiconductor detector (solid-state detector)) may be used as the current detector <b>50</b>. Results of the detection by the current detector <b>50</b> are notified to a control calculation unit <b>32</b>.</p><p id="p-0029" num="0033">An electron beam <b>30</b> discharged from the electron gun <b>4</b> (discharge unit) illuminates the entire aperture member <b>8</b> substantially perpendicularly by the illuminating lens <b>6</b>. <figref idref="DRAWINGS">FIG. <b>2</b></figref> is a conceptual diagram showing the configuration of the aperture member <b>8</b>. In the aperture member <b>8</b>, openings <b>80</b> with m vertical (y direction) rows&#xd7;n horizontal (x direction) rows (m, n&#x2265;2) are formed in a matrix shape with a predetermined arrangement pitch. For example, the openings <b>80</b> with 512 rows&#xd7;512 rows are formed. The openings <b>80</b> are formed of rectangles in the same dimensional shape. The openings <b>80</b> may be circles with the same diameter.</p><p id="p-0030" num="0034">The electron beam <b>30</b> illuminates a region including all the openings <b>80</b> of the aperture member <b>8</b>. Respective portions of the electron beam <b>30</b> pass through these multiple openings <b>80</b>, thereby forming multi-beam <b>30</b><i>a </i>to <b>30</b><i>e </i>as shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>.</p><p id="p-0031" num="0035">In the blanking plate <b>10</b>, through holes are formed corresponding to the arrangement positions of the openings <b>80</b> of the aperture member <b>8</b>, and a blanker formed of two electrodes as a pair is disposed at each through hole. The multi-beam <b>30</b><i>a </i>to <b>30</b><i>e</i>, which pass through the through holes, are each independently deflected by a voltage applied to a blanker. Blanking control is performed on each beam by the deflection. In this manner, blanking deflection is performed by the blanking plate <b>10</b> on all beams in the multi-beam which have passed through the multiple openings <b>80</b> of the aperture member <b>8</b>.</p><p id="p-0032" num="0036">The multi-beam <b>30</b><i>a </i>to <b>30</b><i>e </i>which have passed through the blanking plate <b>10</b> are demagnified in beam size and arrangement pitch by the demagnifying lens <b>12</b>, and travel to a central opening formed in the limiting aperture member <b>14</b>. Here, an electron beam deflected by a blanker of the blanking plate <b>10</b> is deviated from its trajectory, displaced in position from the central opening of the limiting aperture member <b>14</b>, and is blocked by the limiting aperture member <b>14</b>. On the other hand, an electron beam not deflected by a blanker of the blanking plate <b>10</b> passes through the central opening of the limiting aperture member <b>14</b>.</p><p id="p-0033" num="0037">In this manner, the limiting aperture member <b>14</b> blocks the beams which are deflected so as to be in a beam-OFF state by blankers of the blanking plate <b>10</b>. The beam which has passed through the limiting aperture member <b>14</b> in a period from beam-ON to beam-OFF forms the electron beam for one shot.</p><p id="p-0034" num="0038">The multi-beam <b>30</b><i>a </i>to <b>30</b><i>e </i>which have passed through the limiting aperture member <b>14</b> are focused by the objective lenses in three stages <b>16</b>, <b>17</b>, <b>18</b> to form a pattern image with a desired demagnification ratio on the substrate <b>24</b>. The electron beams (the whole multi-beam) which have passed through the limiting aperture member <b>14</b> are collectively deflected in the same direction and radiated to the substrate <b>24</b> by at least one of the electrostatic lenses <b>66</b>, <b>67</b>, <b>68</b> which also has a function of a deflector. When the XY stage <b>105</b> is continuously moved, beam deflection is performed so that the irradiation position of the beam follows the movement of the XY stage <b>22</b>. In addition, as the XY stage <b>22</b> is moved, the writing position is changed accordingly, and the height of the surface of the substrate <b>24</b> irradiated with the multi-beam is changed. Thus, a displacement of the focal point of the multi-beam is dynamically corrected (dynamic focusing) by the electrostatic lenses <b>66</b>, <b>67</b>, <b>68</b> during writing.</p><p id="p-0035" num="0039">Ideally, the multi-beam radiated at one time are arranged with a pitch which is the product of the arrangement pitch of the multiple openings <b>80</b> of the aperture member <b>8</b> and the above-mentioned desired demagnification ratio. The writing apparatus performs a writing operation by a raster scan method by which a shot beam is sequentially radiated, and when a desired pattern is written, a necessary beam is controlled at a beam-ON according to the pattern by the blanking control.</p><p id="p-0036" num="0040">The controller C has a control calculation unit <b>32</b>, a control circuit <b>34</b> and amplifiers <b>36</b>, <b>37</b>, <b>38</b>. The control calculation unit <b>32</b> performs data conversion processing in multiple stages on writing data, generates shot data specific to the apparatus, and outputs the shot data to the control circuit <b>34</b>. In the shot data, an irradiation amount and irradiation position coordinates of each shot are defined. The control circuit <b>34</b> calculates an irradiation time by dividing the irradiation amount of each shot by a current density. When a corresponding shot is performed, a deflection voltage is applied to a corresponding blanker of the blanking plate <b>10</b> so that beam-ON is assumed for the calculated irradiation time.</p><p id="p-0037" num="0041">The amplifier <b>36</b> converts a digital signal output from the control circuit <b>34</b> into an analog signal, and applies a voltage to the electrostatic lens <b>66</b>. The amplifier <b>37</b> converts a digital signal output from the control circuit <b>34</b> into an analog signal, and applies a voltage to the electrostatic lens <b>67</b>. The amplifier <b>38</b> converts a digital signal output from the control circuit <b>34</b> into an analog signal, and applies a voltage to the electrostatic lens <b>68</b>.</p><p id="p-0038" num="0042">Next, a method of calculating voltages will be described, the voltages to be applied to the electrostatic lenses <b>66</b>, <b>67</b>, <b>68</b> in order to reduce the rotation and demagnification (magnification change) of a beam image due to dynamic focusing.</p><p id="p-0039" num="0043">First, the voltages applied to the electrostatic lenses <b>67</b>, <b>68</b> are fixed, and the beam shape (the shape of the whole multi-beam image) and the focus position are measured while the voltage applied to the electrostatic lens <b>66</b> is changed.</p><p id="p-0040" num="0044">For the measurement of the beam shape, the inspection aperture <b>40</b> and the current detector <b>50</b> are used. For example, the blanking plate <b>10</b> is divided into multiple areas, and the inspection aperture <b>40</b> is scanned by the beams in each of the areas.</p><p id="p-0041" num="0045">Each beam corresponding to one area (measurement area) among the multiple areas is set ON, and beams corresponding to other areas are set OFF. The XY stage <b>22</b> is moved, and the inspection aperture <b>40</b> is placed right below the beams in the measurement area. The multiple beams set ON in the measurement area are deflected to scan the inspection aperture <b>40</b>, the electron beam to pass through the inspection aperture <b>40</b> is successively switched, and a beam current is detected by the current detector <b>50</b>.</p><p id="p-0042" num="0046">The control calculation unit <b>32</b> converts the beam current detected by the current detector <b>50</b> into brightness, creates a beam image based on the beam deflection amount, and performs image analysis. The control calculation unit <b>32</b> detects the position of each beam using the position of the XY stage <b>22</b>. The control calculation unit <b>32</b> then calculates the central coordinates of a beam array corresponding to the measurement area from the position of each beam.</p><p id="p-0043" num="0047">Such scan of the inspection aperture <b>40</b>, image analysis, and calculation of the central coordinates of the beam array are performed on all the divided areas of the blanking plate <b>10</b>. The beam shape is determined using the central coordinates of the beam array in each area.</p><p id="p-0044" num="0048">The beam shape is measured for each of the cases where the voltage applied to the electrostatic lens <b>66</b> is set to V&#x2212;&#x394;V, V, and V+&#x394;V. For example, the result of measurement of the beam shape as shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref> is obtained. Fitting by the linear equations stated below is performed on each of three beam shapes: the beam shape when the voltage applied to the electrostatic lens <b>66</b> is set to V&#x2212;&#x394;V, the beam shape when the voltage applied to the electrostatic lens <b>66</b> is set to V, and the beam shape when the voltage applied to the electrostatic lens <b>66</b> is set to V+&#x394;V.</p><p id="p-0045" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>X=A</i><sub>0</sub><i>+A</i><sub>1</sub><i>x+A</i><sub>2</sub><i>y </i><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0046" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>Y=B</i><sub>0</sub><i>+B</i><sub>1</sub><i>x+B</i><sub>2</sub><i>y</i>&#x2003;&#x2003;(Equation 1)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0047" num="0049">It is considered that (A<sub>1</sub>+B<sub>2</sub>)/2 is the demagnification term showing the demagnification level of a beam image, and (B<sub>1</sub>&#x2212;A<sub>2</sub>)/2 is the rotational term showing the rotation level of a beam image. The demagnification term and the rotational term are determined for each of the applied voltages V&#x2212;&#x394;V, V, V+&#x394;V. With demagnification term as the vertical axis and voltage applied to the electrostatic lens as the horizontal axis, an approximate straight line for plotted points is like #<b>1</b> of <figref idref="DRAWINGS">FIG. <b>5</b><i>a</i></figref>. With rotational term as the vertical axis and voltage applied to the electrostatic lens as the horizontal axis, an approximate straight line for plotted points is like #<b>1</b> of <figref idref="DRAWINGS">FIG. <b>5</b></figref><i>b. </i></p><p id="p-0048" num="0050">In addition, the focus position is measured as shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref> for each of the cases where the voltage applied to the electrostatic lens <b>66</b> is set to V&#x2212;&#x394;V, V, and V+&#x394;V. For the measurement of the focus position, with a fixed height of the inspection aperture <b>40</b> and variable excitation current values (lens values) of the object lenses <b>16</b> to <b>18</b>, the inspection aperture <b>40</b> is scanned, and beam images with multiple lens values are created. The variance in brightness of the beam images is calculated. The closer the lens value to an optimal value, the higher the contrast of the beam image, and the greater the variance in brightness. Thus, the lens value corresponding to the beam image with the greatest variance in brightness is determined as the optimal lens value. The optimal lens value of each of the object lenses <b>16</b> to <b>18</b> is newly calculated for each of the cases where the voltage applied to the electrostatic lens <b>66</b> is set to V&#x2212;&#x394;V, V, and V+&#x394;V. The focus position is set to the amount of change in focus corresponding to the amount of change in the optimal lens value.</p><p id="p-0049" num="0051">With focus position as the vertical axis and voltage applied to the electrostatic lens as the horizontal axis, an approximate straight line for plotted points is like #<b>1</b> of <figref idref="DRAWINGS">FIG. <b>5</b></figref><i>c. </i></p><p id="p-0050" num="0052">Next, when the voltages applied to the electrostatic lenses <b>66</b>, <b>68</b> are fixed, and the voltage applied to the electrostatic lens <b>67</b> is set to V&#x2212;&#x394;V, V, V+&#x394;V, similarly, the beam shape is measured, the demagnification term and the rotational term are calculated, and the focus position is measured. An approximate straight line for the demagnification term, the rotational term, and the focus position is like #<b>2</b> of <figref idref="DRAWINGS">FIG. <b>5</b><i>a</i></figref>, <figref idref="DRAWINGS">FIG. <b>5</b><i>b</i></figref>, <figref idref="DRAWINGS">FIG. <b>5</b></figref><i>c. </i></p><p id="p-0051" num="0053">Next, when the voltages applied to the electrostatic lenses <b>66</b>, <b>67</b> are fixed, and the voltage applied to the electrostatic lens <b>68</b> is set to V&#x2212;&#x394;V, V, V+&#x394;V, similarly, the beam shape is measured, the demagnification term and the rotational term are calculated, and the focus position is measured. An approximate straight line for the demagnification term, the rotational term, the focus position is like #<b>3</b> of <figref idref="DRAWINGS">FIG. <b>5</b><i>a</i></figref>, <figref idref="DRAWINGS">FIG. <b>5</b><i>b</i></figref>, <figref idref="DRAWINGS">FIG. <b>5</b></figref><i>c. </i></p><p id="p-0052" num="0054">The slope of each approximate straight line of <figref idref="DRAWINGS">FIG. <b>5</b><i>a</i></figref>, <figref idref="DRAWINGS">FIG. <b>5</b><i>b</i></figref>, <figref idref="DRAWINGS">FIG. <b>5</b><i>c </i></figref>is calculated. Let a<sub>1</sub>, a<sub>2</sub>, a<sub>3 </sub>be the slopes of the lines #<b>1</b>, #<b>2</b>, #<b>3</b> of <figref idref="DRAWINGS">FIG. <b>5</b><i>a</i></figref>, respectively. a<sub>1</sub>, a<sub>2</sub>, a<sub>3 </sub>are the rates of change in the demagnification term per unit voltage of the electrostatic lenses. Let b<sub>1</sub>, b<sub>2</sub>, b<sub>3 </sub>be the slopes of the lines #<b>1</b>, #<b>2</b>, #<b>3</b> of <figref idref="DRAWINGS">FIG. <b>5</b><i>b</i></figref>, respectively. b<sub>1</sub>, b<sub>2</sub>, b<sub>3 </sub>are the rates of change in the rotational term per unit voltage of the electrostatic lenses. Let c<sub>1</sub>, c<sub>2</sub>, c<sub>3 </sub>be the slopes of the lines #<b>1</b>, #<b>2</b>, #<b>3</b> of <figref idref="DRAWINGS">FIG. <b>5</b><i>c</i></figref>, respectively. c<sub>1</sub>, c<sub>2</sub>, c<sub>3 </sub>are the rates of change in the focus position per unit voltage of the electrostatic lenses.</p><p id="p-0053" num="0055">When the demagnification, the rotation, and the focus position are corrected by the electrostatic lenses in three stages <b>66</b>, <b>67</b>, <b>68</b>, the above-mentioned coefficients (slopes) a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub>, b<sub>1</sub>, b<sub>2</sub>, b<sub>3</sub>, c<sub>1</sub>, c<sub>2</sub>, c<sub>3 </sub>are used.</p><p id="p-0054" num="0056">For example, the beam shape and the focus position are measured at the time of application of an arbitrary voltage to the electrostatic lenses <b>66</b>, <b>67</b>, <b>68</b>, and the demagnification term and the rotational term are calculated from the beam shape. For each of the demagnification term, the rotational term and the focus position, the difference from an ideal value (target value) is determined. The difference provides the amount of correction to the demagnification term, the rotational term and the focus position. Let &#x3b1; be the amount of correction to the demagnification term, &#x3b2; be the amount of correction to the rotational term, &#x3b3; be the amount of correction to the focus position, then the amount (voltage) r<sub>1 </sub>of correction to the voltage applied to the electrostatic lens <b>66</b>, the amount (voltage) r<sub>2 </sub>of correction to the voltage applied to the electrostatic lens <b>67</b>, and the amount (voltage) r<sub>3 </sub>of correction to the voltage applied to the electrostatic lens <b>68</b> can be calculated by solving the simultaneous equations below.</p><p id="p-0055" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>a</i><sub>1</sub><i>r</i><sub>1</sub><i>+a</i><sub>2</sub><i>r</i><sub>2</sub><i>+a</i><sub>3</sub><i>r</i><sub>3</sub>=&#x3b1;<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0056" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>b</i><sub>1</sub><i>r</i><sub>1</sub><i>+b</i><sub>2</sub><i>r</i><sub>2</sub><i>+b</i><sub>3</sub><i>r</i><sub>3</sub>=&#x3b2;<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0057" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>1</sub><i>r</i><sub>1</sub><i>+c</i><sub>2</sub><i>r</i><sub>2</sub><i>+c</i><sub>3</sub><i>r</i><sub>3</sub>=&#x3b3;&#x2003;&#x2003;(Equation 2)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0058" num="0057">The demagnification term, the rotational term, and the focus position can be shifted by &#x3b1;, &#x3b2;, &#x3b3;, respectively by adding r<sub>1 </sub>to the voltage applied to the electrostatic lens <b>66</b>, r<sub>2 </sub>to the voltage applied to the electrostatic lens <b>67</b>, and r<sub>3 </sub>to the voltage applied to the electrostatic lens <b>68</b>.</p><p id="p-0059" num="0058">In this manner, according to the present embodiment, it is possible to quickly calculate optimal voltages to be applied to the electrostatic lenses in multiple stages to reduce the demagnification and the rotation of a beam image due to dynamic focusing.</p><p id="p-0060" num="0059">Z stage (not shown) as the seat is provided on the XY stage <b>22</b>, and the substrate <b>24</b> is placed on the Z stage by bottom surface three-point support. The substrate <b>24</b> on the Z stage has a varied surface height (Z height) due to irregularities on the surface caused by bending. Such variation in the Z height of the substrate <b>24</b> causes demagnification and rotation of a beam image, and displacement of the focus position. Hereinafter, a method of correcting the demagnification and the rotation of a beam image and the displacement of the focus position due to the Z height will be described. Note that as a substitute for the Z stage, multiple inspection apertures and current detectors set at different heights may be used.</p><p id="p-0061" num="0060">First, the coefficients a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub>, b<sub>1</sub>, b<sub>2</sub>, b<sub>3</sub>, c<sub>1</sub>, c<sub>2</sub>, c<sub>3 </sub>described in the embodiment are calculated.</p><p id="p-0062" num="0061">Next, the Z stage is driven to vary the height of the substrate <b>24</b> from the original position by &#x394;Z, and a voltage in proportion to &#x394;Z is added to each voltage applied to the electrostatic lenses <b>66</b>, <b>67</b>, <b>68</b>. When the proportionality coefficients are s<sub>1</sub>, s<sub>2</sub>, s<sub>3</sub>, the voltage s<sub>1</sub>&#x394;Z is added to the voltage applied to the electrostatic lens <b>66</b>, the voltage s<sub>2</sub>&#x394;Z is added to the voltage applied to the electrostatic lens <b>67</b>, and the voltage s<sub>3</sub>&#x394;Z is added to the voltage applied to the electrostatic lens <b>68</b>. s<sub>1</sub>, s<sub>2</sub>, s<sub>3 </sub>may be set to any value as long as the product of the value and &#x394;Z gives a voltage practically applicable to the electrostatic lenses <b>66</b>, <b>67</b>, <b>68</b>.</p><p id="p-0063" num="0062">In this state, in the same manner as in the embodiment, the beam shape is measured, the demagnification term and the rotational term are calculated, and the focus position is measured.</p><p id="p-0064" num="0063">Next, the Z stage is driven to vary the height of the substrate <b>24</b> from the original position by &#x2212;&#x394;Z, and a voltage in proportion to &#x2212;&#x394;Z is added to each voltage applied to the electrostatic lenses <b>66</b>, <b>67</b>, <b>68</b>. Specifically, the voltage &#x2212;s<sub>1</sub>&#x394;Z is added to the voltage applied to the electrostatic lens <b>66</b>, the voltage &#x2212;s<sub>2</sub>&#x394;Z is added to the voltage applied to the electrostatic lens <b>67</b>, and the voltage &#x2212;s<sub>3</sub>&#x394;Z is added to the voltage applied to the electrostatic lens <b>68</b>.</p><p id="p-0065" num="0064">In this state, in the same manner as in the embodiment, the beam shape is measured, the demagnification term and the rotational term are calculated, and the focus position is measured.</p><p id="p-0066" num="0065">With Z as the horizontal axis and demagnification term as the vertical axis, the straight line passing through the points obtained by plotting the demagnification term when the Z height is varied by &#x394;Z, and the demagnification term when the Z height is varied by &#x2212;&#x394;Z is like the one in <figref idref="DRAWINGS">FIG. <b>6</b></figref>. The slope (the slope of the demagnification term with respect to Z) &#x3b1;&#x2032; of the straight line is determined. Similarly, the slope &#x3b2;&#x2032; of the rotational term with respect to Z, and the slope &#x3b3;&#x2032; of displacement of the focus position when Z is set are determined. Let a<sub>4 </sub>be the rate of change in the demagnification term, let b<sub>4 </sub>be the rate of change in the rotational term, and let c<sub>4 </sub>be the rate of change in the displacement of the focus position observed on the inspection aperture, the changes being caused by driving the Z stage without varying the voltage of the electrostatic lenses, then the following simultaneous equations hold.</p><p id="p-0067" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>a</i><sub>1</sub><i>s</i><sub>1</sub><i>z+a</i><sub>2</sub><i>s</i><sub>2</sub><i>z+a</i><sub>3</sub><i>s</i><sub>3</sub><i>z+a</i><sub>4</sub><i>z=&#x3b1;&#x2032;z </i><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0068" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>b</i><sub>1</sub><i>s</i><sub>1</sub><i>z+b</i><sub>2</sub><i>s</i><sub>2</sub><i>z+b</i><sub>3</sub><i>s</i><sub>3</sub><i>z+b</i><sub>4</sub><i>z=&#x3b2;&#x2032;z </i><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0069" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>1</sub><i>s</i><sub>1</sub><i>z+c</i><sub>2</sub><i>s</i><sub>2</sub><i>z+c</i><sub>3</sub><i>s</i><sub>3</sub><i>z+c</i><sub>4</sub><i>z=&#x3b3;&#x2032;z</i>&#x2003;&#x2003;(Equation 3)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0070" num="0066">Dividing the entire simultaneous equations by Z gives the following.</p><p id="p-0071" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>a</i><sub>1</sub><i>s</i><sub>1</sub><i>+a</i><sub>2</sub><i>s</i><sub>2</sub><i>+a</i><sub>3</sub><i>s</i><sub>3</sub><i>+a</i><sub>4</sub>=&#x3b1;&#x2032;<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0072" num="0000"><i>b</i><sub>1</sub><i>s</i><sub>1</sub><i>+b</i><sub>2</sub><i>s</i><sub>2</sub><i>+b</i><sub>3</sub><i>s</i><sub>3</sub><i>+b</i><sub>4</sub>=&#x3b2;&#x2032;</p><p id="p-0073" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>1</sub><i>s</i><sub>1</sub><i>+c</i><sub>2</sub><i>s</i><sub>2</sub><i>+c</i><sub>3</sub><i>s</i><sub>3</sub><i>+c</i><sub>4</sub>=&#x3b3;&#x2032;&#x2003;&#x2003;(Equation 4)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0074" num="0067">Focus correctable ratios S<sub>1</sub>, S<sub>2</sub>, S<sub>3 </sub>causing no demagnification and rotation are given when the right side of Mathematical Equation 4 is 0, thus the following equations should be solved.</p><p id="p-0075" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>a</i><sub>1</sub><i>S</i><sub>1</sub><i>+a</i><sub>2</sub><i>S</i><sub>2</sub><i>+a</i><sub>3</sub><i>S</i><sub>3</sub><i>+a</i><sub>4</sub>=0<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0076" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>b</i><sub>1</sub><i>S</i><sub>1</sub><i>+b</i><sub>2</sub><i>S</i><sub>2</sub><i>+b</i><sub>3</sub><i>S</i><sub>3</sub><i>+b</i><sub>4</sub>=0<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0077" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>1</sub><i>S</i><sub>1</sub><i>+c</i><sub>2</sub><i>S</i><sub>2</sub><i>+c</i><sub>3</sub><i>S</i><sub>3</sub><i>+c</i><sub>4</sub>=0&#x2003;&#x2003;(Equation 5)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0078" num="0068">Mathematical Equation 4 is subtracted from Mathematical Equation 5, and let s<sub>1</sub>&#x2032;=S<sub>1</sub>&#x2212;S<sub>1</sub>, s<sub>2</sub>&#x2032;=S<sub>2</sub>&#x2212;S<sub>2</sub>, S<sub>3</sub>&#x2032;=S<sub>3</sub>&#x2212;S<sub>3</sub>, then the following equations are obtained.</p><p id="p-0079" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>a</i><sub>1</sub><i>s</i><sub>1</sub><i>&#x2032;+a</i><sub>2</sub><i>s</i><sub>2</sub><i>&#x2032;+a</i><sub>3</sub><i>s</i><sub>3</sub>&#x2033;=&#x2212;&#x3b1;&#x2032;<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0080" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>b</i><sub>1</sub><i>s</i><sub>1</sub><i>&#x2032;+b</i><sub>2</sub><i>s</i><sub>2</sub><i>&#x2032;+b</i><sub>3</sub><i>s</i><sub>3</sub>&#x2032;=&#x3b2;&#x2032;<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0081" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>1</sub><i>s</i><sub>1</sub><i>&#x2032;+c</i><sub>2</sub><i>s</i><sub>2</sub><i>&#x2032;+c</i><sub>3</sub><i>s</i><sub>3</sub>&#x2032;=&#x3b3;&#x2032;&#x2003;&#x2003;(Equation 6)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0082" num="0069">Solving Mathematical Equation 6 determines s<sub>1</sub>&#x2032;, s<sub>2</sub>&#x2032;, s<sub>3</sub>&#x2032;. Since s<sub>1</sub>, s<sub>2</sub>, s<sub>3 </sub>are known, S<sub>1</sub>, S<sub>2</sub>, S<sub>3 </sub>calculated by S<sub>1</sub>=s<sub>1</sub>+s<sub>1</sub>&#x2032;, S<sub>2</sub>=S<sub>2</sub>+s<sub>2</sub>&#x2032;, S<sub>3</sub>=S<sub>3</sub>+s<sub>3</sub>&#x2032; give focus adjustable cooperative ratios to reduce the demagnification and the rotation of a beam image.</p><p id="p-0083" num="0070">The demagnification and the rotation of a beam image and displacement of the focus position due to irregularities on the surface of the substrate <b>24</b> can be corrected by adding S<sub>1</sub>z to the voltage applied to the electrostatic lens <b>66</b>, S<sub>2</sub>z to the voltage applied to the electrostatic lens <b>67</b>, and S<sub>3</sub>z to the voltage applied to the electrostatic lens <b>68</b>. For example, the distribution of the surface height of the substrate <b>24</b> is measured in advance, and during a writing process in which the substrate <b>24</b> is irradiated with a multi-beam, correction can be made in real time (actual time) by adding a voltage according to the height of a beam irradiation position to each voltage applied to the electrostatic lenses <b>66</b>, <b>67</b>, <b>68</b> using the proportionality coefficients S<sub>1</sub>, S<sub>2</sub>, S<sub>3</sub>.</p><p id="p-0084" num="0071">The posture of the XY stage <b>22</b> on which the substrate <b>24</b> is placed may not be aligned with the stage movement direction. In this case, as shown in <figref idref="DRAWINGS">FIG. <b>7</b></figref>, the substrate <b>24</b> is also in a rotational posture, thus it is preferable to rotate the irradiation area BR of the multi-beam according to the rotation of the substrate <b>24</b>. Specifically, the beam image is rotated without causing demagnification of the beam image and displacement of the focus position.</p><p id="p-0085" num="0072">First, the coefficients a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub>, b<sub>1</sub>, b<sub>2</sub>, b<sub>3</sub>, c<sub>1</sub>, c<sub>2</sub>, c<sub>3 </sub>described in the embodiment are calculated.</p><p id="p-0086" num="0073">Next, the amount &#x3b8; of rotation of the XY stage <b>22</b> is measured using a laser length measurement system (not illustrated). For example, a laser is reflected on a mirror installed in the XY stage <b>22</b>, the positions of two points on the XY stage <b>22</b> are measured, and the amount &#x3b8; (yaw angle) of rotation is obtained from the difference between the positions of the two points.</p><p id="p-0087" num="0074">Subsequently, the coefficients t<sub>1</sub>, t<sub>2</sub>, t<sub>3 </sub>which satisfy the following simultaneous equations are determined.</p><p id="p-0088" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>a</i><sub>1</sub><i>t</i><sub>1</sub><i>&#x3b8;+a</i><sub>2</sub><i>t</i><sub>2</sub><i>&#x3b8;+a</i><sub>3</sub><i>t</i><sub>3</sub>&#x3b8;=0<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0089" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>b</i><sub>1</sub><i>t</i><sub>1</sub><i>&#x3b8;&#xb1;b</i><sub>2</sub><i>t</i><sub>2</sub><i>&#x3b8;+b</i><sub>3</sub><i>t</i><sub>3</sub>&#x3b8;=0<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0090" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>c</i><sub>1</sub><i>t</i><sub>1</sub><i>&#x3b8;+C</i><sub>2</sub><i>t</i><sub>2</sub><i>&#x3b8;+c</i><sub>3</sub><i>t</i><sub>3</sub>&#x3b8;=0&#x2003;&#x2003;(Equation 7)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0091" num="0075">The beam image can be rotated &#x3b8;, and aligned with the posture of the substrate <b>24</b> while reducing the variation in demagnification of the beam image and the displacement of the focus position by adding t<sub>1</sub>&#x3b8; to the voltage applied to the electrostatic lens <b>66</b>, t<sub>2</sub>&#x3b8; to the voltage applied to the electrostatic lens <b>67</b>, and t<sub>3</sub>&#x3b8; to the voltage applied to the electrostatic lens <b>68</b>.</p><p id="p-0092" num="0076">The ultimate voltages V<sub>1</sub>, V<sub>2</sub>, V<sub>3 </sub>to be applied to the electrostatic lenses <b>66</b>, <b>67</b>, <b>68</b> can be calculated as follows by adding the voltages r<sub>1</sub>, r<sub>2</sub>, r<sub>3 </sub>calculated from Mathematical Equation 2, the voltages S<sub>1</sub>z, S<sub>2</sub>z, S<sub>3</sub>z calculated from Mathematical Equation 6, and the voltages t<sub>1</sub>&#x3b8;, t<sub>2</sub>&#x3b8;, t<sub>3</sub>&#x3b8; calculated from Mathematical Equation 7 to offset voltages O<sub>1</sub>, O<sub>2</sub>, O<sub>3 </sub>currently set in the electrostatic lenses <b>66</b>, <b>67</b>, <b>68</b>.</p><p id="p-0093" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>1</sub><i>=O</i><sub>1</sub><i>+r</i><sub>1</sub><i>+S</i><sub>1</sub><i>z+t</i><sub>1</sub>&#x3b8;<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0094" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>2</sub><i>=O</i><sub>2</sub><i>+r</i><sub>2</sub><i>+S</i><sub>2</sub><i>z+t</i><sub>2</sub>&#x3b8;<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0095" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>3</sub><i>=O</i><sub>3</sub><i>+r</i><sub>3</sub><i>+S</i><sub>3</sub><i>z+t</i><sub>3</sub>&#x3b8;&#x2003;&#x2003;(Equation 8)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0096" num="0077">Before a writing process, the coefficients a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub>, b<sub>1</sub>, b<sub>2</sub>, b<sub>3</sub>, c<sub>1</sub>, c<sub>2</sub>, c<sub>3</sub>, S<sub>1</sub>, S<sub>2</sub>, S<sub>3</sub>, t<sub>1</sub>, t<sub>2</sub>, t<sub>3 </sub>are determined. During a writing process, a voltage correction amount is calculated according to the height of the substrate surface and the amount of rotation of the stage, and the voltage correction amount is added to each voltage applied to the electrostatic lenses <b>66</b>, <b>67</b>, <b>68</b>.</p><p id="p-0097" num="0078">In the embodiment, demagnification of a beam image, rotation of a beam image, and focus position are three items which are correction targets, and the object lenses and the electrostatic lenses use a three-stage configuration. However, a two or more stage configuration is applicable, and the object lenses and the electrostatic lenses may have a four or more stages according to the number of correction targets. For example, when the focus variation is small, the object lenses and the electrostatic lenses use a two-stage configuration. In addition, when demagnification of a beam image is handled separately for the x direction and the y direction, four items of correction targets are provided, thus the object lenses and the electrostatic lenses are provided in four stages.</p><p id="p-0098" num="0079">In the embodiment, an example has been described in which the coefficients a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub>, b<sub>1</sub>, b<sub>2</sub>, b<sub>3</sub>, c<sub>1</sub>, c<sub>2</sub>, c<sub>3</sub>, S<sub>1</sub>, S<sub>2</sub>, S<sub>3</sub>, t<sub>1</sub>, t<sub>2</sub>, t<sub>3 </sub>are determined by solving simultaneous equations; however, the coefficients may be calculated using a map (table).</p><p id="p-0099" num="0080">In the embodiment, an example has been described in which electrostatic lenses in three stages <b>66</b> to <b>68</b> corresponding to object lenses in three stages <b>16</b> to <b>18</b> are provided; however, magnetic field lenses may be provided instead of the electrostatic lenses. In short, first to third magnetic field lenses corresponding to the object lenses <b>16</b> to <b>18</b> may be provided. When an electrostatic lens is used, an excitation parameter as a control target is an applied voltage, and when a magnetic field lens is used, an excitation parameter as a control target is an excitation current.</p><p id="p-0100" num="0081">A magnetic field lens (magnetic field correction lens) generates a micro rotational symmetric magnetic field to slightly move an image forming position. For example, the magnetic field lens is a circular coil or a solenoid coil with a central axis of a beam path, and the coil may be surrounded by a magnetic material, such as ferrite, or the coil may not be surrounded by a magnetic material.</p><p id="p-0101" num="0082">The amplifiers <b>36</b> to <b>38</b> convert a digital signal output from the control circuit <b>34</b> into an analog signal, and controls the excitation currents for the first to third magnetic field lenses.</p><p id="p-0102" num="0083">The excitation currents for the first to third magnetic field lenses to reduce the demagnification and the rotation of a beam image due to dynamic focusing are calculated. The excitation currents for the second and third magnetic field lenses are fixed, and the beam shape is measured for each of the cases where the excitation current for the first magnetic field lens is set to I&#x2212;&#x394;I, I, and I+&#x394;I. For example, the result of measurement of the beam shape as shown in <figref idref="DRAWINGS">FIG. <b>8</b></figref> is obtained. Fitting by Mathematical Equation 1 is performed on three beam shapes to determine the demagnification term (A<sub>1</sub>+B<sub>2</sub>)/2, the rotational term (B<sub>1</sub>&#x2212;A<sub>2</sub>)/2.</p><p id="p-0103" num="0084">As shown in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the focus position is measured for each of the cases where the excitation current for the first magnetic field lens is set to I&#x2212;&#x394;I, I, and I+&#x394;I. The slope of an approximate straight line for the demagnification term, the rotational term, and the focus position for the excitation current is calculated.</p><p id="p-0104" num="0085">Next, when the excitation currents for the first and third magnetic field lenses are fixed, and the excitation current for the second magnetic field lens is set to I&#x2212;&#x394;I, I, and I+&#x394;I, similarly, the beam shape is measured, the demagnification term and the rotational term are calculated, the focus position is measured, and an approximate straight line is calculated.</p><p id="p-0105" num="0086">Subsequently, when the excitation currents for the first and second magnetic field lenses are fixed, and the excitation current for the third magnetic field lens is set to I&#x2212;&#x394;I, I, and I+&#x394;I, similarly, the beam shape is measured, the demagnification term and the rotational term are calculated, the focus position is measured, and an approximate straight line is calculated.</p><p id="p-0106" num="0087">Subsequently, calculation in the same manner as in the case of electrostatic lens enables quick calculation of the excitation currents for electromagnetic lenses in multiple stages to reduce the demagnification and the rotation of a beam image due to dynamic focusing.</p><p id="p-0107" num="0088">A magnetic field lens is inferior to an electrostatic lens in terms of quick responsiveness. However, it is sufficient that correction in response to change in the substrate surface height follow slow change due to mechanical movement of the substrate on the stage, thus a magnetic field lens may be used.</p><p id="p-0108" num="0089">Although a multi beam writing apparatus has been described in the embodiment, the invention is applicable to other multi beam irradiation apparatuses, such as a multi beam inspection apparatus.</p><p id="p-0109" num="0090">The present invention is described above in detail with reference to particular aspects, but it should be clear to the skilled person in the art that various modifications are possible without departing from the intention and scope of the present invention.</p><p id="p-0110" num="0091">The present application is based upon Japanese Patent Application No. 2019-210594, filed on Nov. 21, 2019, the entire contents of which are incorporated herein by reference.</p><heading id="h-0009" level="1">REFERENCE SIGNS LIST</heading><p id="p-0111" num="0000"><ul id="ul0002" list-style="none">    <li id="ul0002-0001" num="0000">    <ul id="ul0003" list-style="none">        <li id="ul0003-0001" num="0092"><b>2</b> ELECTRON BEAM COLUMN</li>        <li id="ul0003-0002" num="0093"><b>4</b> ELECTRON GUN</li>        <li id="ul0003-0003" num="0094"><b>6</b> ILLUMINATING LENS</li>        <li id="ul0003-0004" num="0095"><b>8</b> APERTURE MEMBER</li>        <li id="ul0003-0005" num="0096"><b>10</b> BLANKING PLATE</li>        <li id="ul0003-0006" num="0097"><b>12</b> DEMAGNIFYING LENS</li>        <li id="ul0003-0007" num="0098"><b>14</b> LIMITING APERTURE MEMBER</li>        <li id="ul0003-0008" num="0099"><b>16</b> to <b>18</b> OBJECT LENS</li>        <li id="ul0003-0009" num="0100"><b>20</b> WRITING CHAMBER</li>        <li id="ul0003-0010" num="0101"><b>22</b> XY STAGE</li>        <li id="ul0003-0011" num="0102"><b>24</b> SUBSTRATE</li>        <li id="ul0003-0012" num="0103"><b>40</b> INSPECTION APERTURE</li>        <li id="ul0003-0013" num="0104"><b>50</b> CURRENT DETECTOR</li>        <li id="ul0003-0014" num="0105"><b>66</b> to <b>68</b> ELECTROSTATIC LENS</li>    </ul>    </li></ul></p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A multi charged particle beam adjustment method comprising:<claim-text>forming a multi charged particle beam;</claim-text><claim-text>calculating, for each of lenses in two or more stages disposed corresponding to object lenses in two or more stages, a first rate of change and a second rate of change in response to change in at least an excitation parameter, the first rate of change being a rate of change in a demagnification level of a beam image of the multi charged particle beam, the second rate of change being a rate of change in a rotation level of the beam image; and</claim-text><claim-text>calculating a first amount of correction to the excitation parameter of each of the lenses based on an amount of correction to the demagnification level and the rotation level of the beam image, the first rate of change, and the second rate of change.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The multi charged particle beam adjustment method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising calculating a third rate of change in response to change in the excitation parameter for each of the lenses, the third rate of change being a rate of change in focus position,<claim-text>wherein in a step of calculating the first amount of correction, the third rate of change is further used.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The multi charged particle beam adjustment method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising:<claim-text>calculating a fourth rate of change, a fifth rate of change, and a sixth rate of change in response to change in a surface height of a substrate irradiated with the multi charged particle beam, the fourth rate of change being a rate of change in the demagnification level of the beam image, the fifth rate of change being a rate of change in the rotation level of the beam image, the sixth rate of change being a rate of change in the focus position; and</claim-text><claim-text>calculating a second amount of correction to the excitation parameter of each of the lenses in real time as the substrate is irradiated with the multi charged particle beam, based on the surface height of the substrate at an irradiation position of the multi charged particle beam, the first rate of change, the second rate of change, the third rate of change, the fourth rate of change, the fifth rate of change and the sixth rate of change.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The multi charged particle beam adjustment method according to <claim-ref idref="CLM-00003">claim 3</claim-ref>,<claim-text>wherein the fourth rate of change, the fifth rate of change, the sixth rate of change are each a rate of change when the excitation parameter in response to change in the surface height of the substrate is set in the lenses.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The multi charged particle beam adjustment method according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, further comprising:<claim-text>measuring a yaw rotation amount of a stage on which the substrate irradiated with the multi charged particle beam is placed; and</claim-text><claim-text>calculating a third amount of correction to the excitation parameter of each of the lenses based on the rotation amount, the first rate of change, the second rate of change and the third rate of change.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The multi charged particle beam adjustment method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>,<claim-text>wherein the lenses disposed corresponding to the object lenses are electrostatic lenses, and the excitation parameter is an applied voltage.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The multi charged particle beam adjustment method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>,<claim-text>wherein the lenses disposed corresponding to the object lenses are magnetic field lenses, and the excitation parameter is an excitation current.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. A multi charged particle beam irradiation method comprising:<claim-text>forming a multi charged particle beam;</claim-text><claim-text>calculating, for each of lenses in two or more stages disposed corresponding to object lenses in two or more stages, a first rate of change and a second rate of change in response to change in at least an excitation parameter, the first rate of change being a rate of change in a demagnification level of a beam image of the multi charged particle beam, the second rate of change being a rate of change in a rotation level of the beam image;</claim-text><claim-text>calculating a first amount of correction to the excitation parameter of each of the lenses based on an amount of correction to the demagnification level and the rotation level of the beam image, the first rate of change, and the second rate of change; and</claim-text><claim-text>setting the excitation parameter with the first amount of correction added to the lenses, and irradiating a substrate with the multi charged particle beam.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. A multi charged particle beam irradiation apparatus comprising:<claim-text>a plurality of blankers performing blanking deflection on respective parts of a multi charged particle beam;</claim-text><claim-text>a limiting aperture member blocking beams which are deflected by the plurality of blankers to assume a beam off state;</claim-text><claim-text>object lenses in two or more stages, that focus the multi charged particle beam which has passed the limiting aperture member to a substrate;</claim-text><claim-text>lenses in two or more stages disposed corresponding to the object lenses; and</claim-text><claim-text>a controller calculating a first amount of correction to an excitation parameter of each of the lenses based on a first rate of change, a second rate of change, and an amount of correction in response to change in the excitation parameter for each of the lenses, and setting the excitation parameter with the first amount of correction added to the lenses, the first rate of change being a rate of change in a demagnification level of a beam image of the multi charged particle beam, the second rate of change being a rate of change in a rotation level of the beam image, the amount of correction being made to the demagnification level and the rotation level of the beam image.</claim-text></claim-text></claim></claims></us-patent-application>