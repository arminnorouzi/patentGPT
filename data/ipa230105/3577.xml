<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230003578A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230003578</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17781711</doc-number><date>20201202</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>01</class><subclass>J</subclass><main-group>3</main-group><subgroup>28</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>01</class><subclass>S</subclass><main-group>17</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>5</main-group><subgroup>232</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>01</class><subclass>J</subclass><main-group>3</main-group><subgroup>28</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>01</class><subclass>S</subclass><main-group>17</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20180801</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>5</main-group><subgroup>232945</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">COLOR MEASUREMENT</invention-title><us-related-documents><us-provisional-application><document-id><country>US</country><doc-number>62943038</doc-number><date>20191203</date></document-id></us-provisional-application></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>ams Sensors Germany GmbH</orgname><address><city>Jena</city><country>DE</country></address></addressbook><residence><country>DE</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>SIESS</last-name><first-name>Gunter</first-name><address><city>Kraftsdorf</city><country>DE</country></address></addressbook></inventor></inventors></us-parties><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/EP2020/084302</doc-number><date>20201202</date></document-id><us-371c12-date><date>20220602</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A method of measuring the color of a surface may include a device positioned above the surface. The device may include an optical sensor and a display screen. The optical sensor measures visible light level reflected from the surface in a plurality of spectral channels. A plurality of patterns are sequentially displayed on the display screen. The optical sensor is used to measure light reflected by the surface during display of each pattern. A value is determined for the distance from the optical sensor to the illuminated region for a first local maximum of intensity of the measured light reflected by the surface. A location in a color space corresponding to a color of the surface or a reflectance spectrum of the surface is determined based on the visible light level in each spectral channel for the value of the distance corresponding to the first local maximum.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="148.93mm" wi="98.21mm" file="US20230003578A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="220.47mm" wi="128.69mm" file="US20230003578A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="181.10mm" wi="100.25mm" file="US20230003578A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="155.36mm" wi="164.68mm" file="US20230003578A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="224.03mm" wi="132.50mm" file="US20230003578A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="207.94mm" wi="139.87mm" file="US20230003578A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="254.42mm" wi="103.55mm" file="US20230003578A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="144.02mm" wi="142.07mm" file="US20230003578A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading><p id="p-0002" num="0001">The present application is a national stage entry according to 35 U.S.C. &#xa7; 371 of PCT application No.: PCT/EP2020/084302 filed on Dec. 2, 2020, which claims priority to U.S. Provisional Patent Application No. 62/943,038 filed on Dec. 3, 2019; both of which are incorporated herein by reference in their entirety and for all purposes.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">This specification relates to methods and systems for measuring the color of a surface.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">In general, the color of a surface is measured by measuring the light reflected from the surface over a number of bands, and transforming these measurements into a &#x201c;color space&#x201d;. A color space is a model which assigns colors to a framework for ease of reference. Color spaces may assign specific names and numbers to each color (e.g. the Pantone&#x2122; collection), or they may plot colors in a (usually 3-dimensional) phase space, such as the RGB space commonly used for computer displays, or the CIE color space.</p><p id="p-0005" num="0004">Standards for color measurement define that the measurement should be taken in one of two geometries&#x2014;0&#xb0;/45&#xb0;, as shown in <figref idref="DRAWINGS">FIG. <b>1</b>A</figref> or 45&#xb0;/0&#xb0;, as shown in <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>. In each case, a light source <b>101</b> illuminates a point <b>102</b> on a surface <b>103</b>, and the reflection from the point <b>102</b> is received by a detector <b>104</b>. The first number indicates the angle between a first line perpendicular to the surface and passing through the point <b>102</b>, and a second line connecting the light source <b>101</b> and the point <b>102</b> (relative to a direction perpendicular to the surface). The second number indicates the angle between the first line and a third line connecting the point <b>102</b> to the detector <b>104</b>. In practical examples, the source <b>101</b> may not be a point source, the &#x201c;point&#x201d; <b>102</b> may be more spread out, and the detector <b>104</b> may also detect light reflected from a region around the point <b>102</b>.</p><p id="p-0006" num="0005">This measurement geometry is chosen to maximize the diffuse reflection of light from the light source to the detector, and to ensure that there are no contributions to the signal from specular reflection.</p><p id="p-0007" num="0006">For the measurement of reflectance, a symmetrical geometry is used, such that the specular reflection of the light source from the surface is picked up by the detector. In addition, the ratio of intensity of the diffuse and specular reflection is important, so that the reflectance can be determined accurately. Where &#x201c;reflectance&#x201d; is used herein, it specifically means &#x201c;specular reflectance&#x201d;. The &#x201c;reflectance&#x201d; of a surface as used herein is the radiant flux received from the target divided by the radiant flux applied to the target.</p><p id="p-0008" num="0007">Reflectance may also be defined in terms of radiance, and the transformation between these definitions is well known.</p><p id="p-0009" num="0008">Known color and reflectance measurement devices generally have one or more fixed light sources and one or more fixed detectors, and some means of ensuring that the light sources and detectors are at the correct distance from a surface. This requires contact with the surface, which may not always be possible&#x2014;but without such contact it is difficult to ensure that the proper measurement geometry is maintained.</p><p id="p-0010" num="0009">It is therefore an aim of the present disclosure to provide colour and/or reflectance measurement methods and devices that address one or more of the problems above or at least provides a useful alternative.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0011" num="0010">This specification relates to methods and devices for measuring the color of a surface, and also to measurements of reflectance.</p><p id="p-0012" num="0011">According to a first aspect, there is provided a method of measuring the color of a surface. A device is positioned above the surface. The device comprises an optical sensor and a display screen. The optical sensor measures visible light level in a plurality of spectral channels, each channel having different spectral sensitivity characteristics. The device is positioned such that the sensor measures light reflected from the surface. A plurality of patterns are sequentially displayed on the display screen, each pattern comprising an illuminated region at a different respective distance from the optical sensor. The optical sensor is used to measure light reflected by the surface during display of each pattern. A value is determined for the distance from the optical sensor to the illuminated region for a first local maximum of intensity of the measured light reflected by the surface, the first local maximum being a maximum of the diffuse reflection of the pattern. A location in a color space corresponding to a color of the surface or a reflectance spectrum of the surface is determined based on the visible light level in each spectral channel for the value of the distance corresponding to the first local maximum.</p><p id="p-0013" num="0012">According to a second aspect, there is provided a method of measuring the color of a surface. A device is positioned above the surface. The device comprises an optical sensor and a display screen. The optical sensor measures visible light level. The device is positioned such that the sensor measures light reflected from the surface. A plurality of patterns is sequentially displayed on the display screen, each pattern comprising an illuminated region at a different respective distance from the optical sensor, wherein the plurality of patterns comprises at least two groups of patterns, the illuminated region of each group of patterns being displayed in a different color. The optical sensor is used to measure light reflected by the surface during display of each pattern. A value is determined for the distance from the optical sensor to the illuminated region for a first local maximum of intensity of the measured light reflected by the surface, the first local maximum being a maximum of the diffuse reflection of the pattern. A location in a color space corresponding to a color of the surface or a reflectance spectrum of the surface is determined based on the visible light level for each group of patterns for the value of the distance corresponding to the local maximum.</p><p id="p-0014" num="0013">According to a third aspect, there is provided a system including a device and a controller. The device comprises an optical sensor and a display screen. The optical sensor measures visible light level in a plurality of spectral channels, each channel having different spectral sensitivity characteristics. The controller is configured to:<ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0000">    <ul id="ul0002" list-style="none">        <li id="ul0002-0001" num="0014">cause the display screen to sequentially display a plurality of patterns, each pattern comprising an illuminated region at a different respective distance from the sensor;</li>        <li id="ul0002-0002" num="0015">receive measurements from the optical sensor of light reflected by a surface during display of each pattern;</li>        <li id="ul0002-0003" num="0016">determine a value of the distance from the optical sensor to the illuminated region for a first local maximum of intensity of the measured light reflected by the surface, the first local maximum being a maximum of the diffuse reflection of the pattern;</li>        <li id="ul0002-0004" num="0017">determine a location in a color space corresponding to a color of the surface or a reflectance spectrum of the surface based on the visible light level in each spectral channel for the value of the distance corresponding to the first local maximum.</li>    </ul>    </li></ul></p><p id="p-0015" num="0018">According to a fourth aspect, there is provided a computer program product. The computer program product is for use in a device comprising an optical sensor and a display screen wherein the optical sensor measures visible light level in a plurality of spectral channels, each channel having different spectral sensitivity characteristics. The computer program product comprises:<ul id="ul0003" list-style="none">    <li id="ul0003-0001" num="0000">    <ul id="ul0004" list-style="none">        <li id="ul0004-0001" num="0019">code for sequentially displaying a plurality of patterns on the display screen, each pattern comprising an illuminated region at a different respective distance from the sensor;</li>        <li id="ul0004-0002" num="0020">code for measuring, using the optical sensor, light reflected by a surface during display of each pattern;</li>        <li id="ul0004-0003" num="0021">code for determining the value of the distance from the optical sensor to the illuminated region for a first local maximum of intensity of the measured light reflected by the surface, the first local maximum being a maximum of the diffuse reflection of the pattern;</li>    </ul>    </li></ul></p><p id="p-0016" num="0022">code for determining a location in a color space corresponding to a color of the surface or a reflectance spectrum of the surface based on the visible light level in each spectral channel for the value of the distance corresponding to the first local maximum.</p><p id="p-0017" num="0023">According to a fifth aspect, there is provided a system including a device and a controller. The device comprises an optical sensor and a display screen. The controller is configured to:<ul id="ul0005" list-style="none">    <li id="ul0005-0001" num="0000">    <ul id="ul0006" list-style="none">        <li id="ul0006-0001" num="0024">cause the display screen to sequentially display a plurality of patterns, each pattern comprising an illuminated region at a different respective distance from the sensor, wherein the plurality of patterns comprises at least two groups of patterns, the illuminated region of each group of patterns being displayed in a different color;</li>        <li id="ul0006-0002" num="0025">receive measurements from the optical sensor of light reflected by a surface during display of each pattern;</li>        <li id="ul0006-0003" num="0026">determine a value of the distance from the optical sensor to the illuminated region for a first local maximum of intensity of the measured light reflected by the surface, the first local maximum being a maximum of the diffuse reflection of the pattern;</li>        <li id="ul0006-0004" num="0027">determine a location in a color space corresponding to a color of the surface or a reflectance spectrum of the surface based on the visible light level for each group of patterns for the value of the distance corresponding to the first local maximum.</li>    </ul>    </li></ul></p><p id="p-0018" num="0028">According to a sixth aspect, there is provided a computer program product. The computer program product is for use in a device comprising an optical sensor and a display. The computer program product comprises:<ul id="ul0007" list-style="none">    <li id="ul0007-0001" num="0000">    <ul id="ul0008" list-style="none">        <li id="ul0008-0001" num="0029">code for sequentially displaying a plurality of patterns on the display screen, each pattern comprising an illuminated region at a different respective distance from the sensor, wherein the plurality of patterns comprises at least two groups of patterns, the illuminated region of each group of patterns being displayed in a different color;</li>        <li id="ul0008-0002" num="0030">code for measuring, using the optical sensor, light reflected by a surface during display of each pattern;</li>        <li id="ul0008-0003" num="0031">code for determining the value of the distance from the optical sensor to the illuminated region for a first local maximum of intensity of the measured light reflected by the surface, the first local maximum being a maximum of the diffuse reflection of the pattern;</li>        <li id="ul0008-0004" num="0032">code for determining a location in a color space corresponding to a color of the surface or a reflectance spectrum of the surface based on the visible light level for each group of patterns for the value of the distance corresponding to the first local maximum.</li>    </ul>    </li></ul></p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0019" num="0033">Some examples will now be described by way of example only and with reference to the accompanying drawings, in which:</p><p id="p-0020" num="0034"><figref idref="DRAWINGS">FIGS. <b>1</b>A and <b>1</b>B</figref> illustrate measurement geometries for colour measurement;</p><p id="p-0021" num="0035"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows a device for measuring color and/or reflectance in accordance with the present disclosure;</p><p id="p-0022" num="0036"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates the use of the device of <figref idref="DRAWINGS">FIG. <b>2</b></figref>;</p><p id="p-0023" num="0037"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flowchart of a method for measuring diffuse and/or specular reflection;</p><p id="p-0024" num="0038"><figref idref="DRAWINGS">FIGS. <b>5</b>A to <b>5</b>E</figref> show example patterns displayed on the device of <figref idref="DRAWINGS">FIG. <b>2</b></figref>;</p><p id="p-0025" num="0039"><figref idref="DRAWINGS">FIGS. <b>6</b>A to <b>6</b>E</figref> are charts showing the light reflected during display of each pattern of <figref idref="DRAWINGS">FIGS. <b>5</b>A to <b>5</b>E</figref>;</p><p id="p-0026" num="0040"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a graph of measurements of light reflected from a surface;</p><p id="p-0027" num="0041"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a graph showing the emission characteristics of various display screens;</p><p id="p-0028" num="0042"><figref idref="DRAWINGS">FIGS. <b>9</b>A and <b>9</b>B</figref> show devices displaying alternative patterns;</p><p id="p-0029" num="0043"><figref idref="DRAWINGS">FIG. <b>10</b></figref> shows a system comprising an alternative device and an external controller.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><p id="p-0030" num="0044">In the figures like elements are indicated by like reference numerals.</p><heading id="h-0006" level="1">DETAILED DESCRIPTION</heading><p id="p-0031" num="0045">There is provided a method of colour and reflectance measurement using a device having a display screen and a detector. The measurement is obtained by showing patterns on the display screen at a plurality of distances from the detector, and then using those measurements to find the peaks in diffuse reflection (for colour measurement) and specular reflection (for reflectance measurement).</p><p id="p-0032" num="0046">Some examples are given in the accompanying figures.</p><p id="p-0033" num="0047"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows a device <b>200</b> having a display screen <b>201</b>, an optical sensor <b>202</b>, and a controller <b>203</b>. <figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates the device <b>200</b> held parallel to a surface <b>300</b>.</p><p id="p-0034" num="0048">As shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the sensor <b>202</b> has a field of view <b>310</b> which includes a &#x201c;target spot&#x201d; <b>301</b> on the surface <b>300</b>. The target spot is defined so as to provide the required sensor angle when the device is held parallel to the surface. Its exact position will depend on the distance of the device from the surface, and the position of the device (i.e. it is a spot identified for convenience of description, rather than a point on the surface with special physical properties). The display screen <b>201</b> is positioned such that it illuminates the surface <b>300</b>, including the target spot <b>301</b>.</p><p id="p-0035" num="0049">The display screen <b>201</b> can be of any type that emits light&#x2014;e.g. an OLED screen or a backlit e-paper screen.</p><p id="p-0036" num="0050">In general terms, the controller is configured to cause the display screen to display a plurality of patterns <b>320</b>, one after the other (i.e. sequentially), where each pattern has an illuminated region at a different respective distance from the optical sensor (hereafter the &#x201c;pattern distance&#x201d;). The controller receives measurements from the optical sensor during display of each pattern (in particular, measurements of light reflected from the target spot <b>301</b> and the surrounding area), and uses these measurements to determine optical properties of the surface <b>300</b>. The optical properties measured can include the diffuse reflection characteristics of the surface, the color of the surface, and/or the specular reflection characteristics of the surface.</p><p id="p-0037" num="0051">To explain the underlying principles, a method will first be described, with reference to <figref idref="DRAWINGS">FIG. <b>4</b></figref>, for the measurement of diffuse and/or specular reflection characteristics generally (i.e. without considering the impact of color or wavelength specific properties).</p><p id="p-0038" num="0052">In step <b>401</b>, the device <b>200</b> is positioned relative to the surface <b>300</b>, such that the display screen is substantially parallel to the surface, and the sensor measures light reflected from the surface.</p><p id="p-0039" num="0053">In step <b>402</b>, a plurality of patterns are sequentially displayed on the display screen, as illustrated in <figref idref="DRAWINGS">FIG. <b>5</b>A to <b>5</b>E</figref>. Each of the patterns comprises an illuminated circle at a specified &#x201c;pattern distance&#x201d; from the sensor, with the rest of the screen being black (i.e. providing minimal illumination). During the display of each pattern, the sensor <b>201</b> measures the light reflected from the surface.</p><p id="p-0040" num="0054">Example reflectance signals during display of each pattern are shown in <figref idref="DRAWINGS">FIGS. <b>6</b>A to <b>6</b>E</figref>. In each figure, the sensor angle <b>601</b><i>a</i>-<i>e </i>and the illumination angle <b>602</b><i>a</i>-<i>e </i>are shown as dotted lines, and the intensity of the reflection <b>603</b><i>a</i>-<i>e </i>is shown as a solid line. The value of the measured intensity is the intersection of the sensor angle <b>601</b><i>a</i>-<i>e </i>and the reflection intensity <b>603</b><i>a</i>-<i>e. </i></p><p id="p-0041" num="0055">Each of the measurements corresponds to a different measurement geometry, X&#xb0;/Y&#xb0;, where X is the illumination angle (the angle between a perpendicular to the surface at the target point, and a line connecting the target point to a representative point of the illuminated region of the display, e.g. a geometric midpoint of the pattern, and Y is the sensor angle e.g. the angle between a perpendicular to the surface and the target point, and a line connecting the target point to the sensor. Y may be fixed for a particular configuration of the device. X may be different for each of the displayed patterns.</p><p id="p-0042" num="0056">In general the device (controller) does not have access to the value of X i.e. of the illumination angle from the pattern to the target point. However the controller <b>203</b> does have access to the location of the pattern on the display screen, e.g. because the controller is configured to control display of the pattern, and the measurements received by the detector, and may hence determine other properties of the system.</p><p id="p-0043" num="0057">In step <b>403</b>, the controller <b>203</b> determines the pattern distance corresponding to a maximum of the diffuse reflection of the pattern by the surface and/or a maximum of the specular reflection of the pattern by the surface. This is described in more detail below, with reference to <figref idref="DRAWINGS">FIG. <b>7</b></figref>.</p><p id="p-0044" num="0058"><figref idref="DRAWINGS">FIG. <b>7</b></figref> shows an example set of measurements for a sensor angle Y of 45 degrees, and a distance between the surface <b>300</b> and the display <b>201</b> of 40 mm The dots represent the individual sensor measurements (in arbitrary units). As can be seen in the figure, there are two local maxima among the measured points&#x2014;at 40 mm (<b>701</b>) and 80 mm (<b>702</b>). The maximum <b>701</b> can be seen to form part of a smooth curve with most of the other points, and is closer to the sensor than the maximum <b>702</b>&#x2014;as such, this maximum can be identified as the maximum associated with the diffuse reflection. The maximum <b>702</b> stands out from the other points (indicating that it is on a narrow peak), and is further from the sensor&#x2014;as such, this maximum can be identified as the maximum associated with the specular reflection.</p><p id="p-0045" num="0059">If a more precise measurement is desired, rather than the actual measurement which happened to come close to the pattern distances for which each reflection is maximised, then the exact maximum of the diffuse reflection can be determined by fitting a curve to the measured points (ignoring any outliers due to the specular reflection). In implementations this curve is approximately sinusoidal. The pattern distance for which the diffuse reflection is maximised corresponds to a Y&#xb0;/<b>0</b>&#xb0; geometry&#x2014;i.e. a geometry in which the pattern is directly above the target point.</p><p id="p-0046" num="0060">The exact maximum of the specular reflection is harder to determine by curve fitting (as there are likely to be few points close to the specular peak). However, the distance between the sensor and the pattern for the specular reflection is generally about twice the distance between the sensor and the pattern for the diffuse reflection (as specular reflection corresponds to a Y&#xb0;/-Y&#xb0; geometry), which allows the height of the peak to be estimated based on the known points.</p><p id="p-0047" num="0061">If further accuracy or confirmation is required, then further patterns may be displayed with pattern distances at and close to the calculated values for the diffuse and specular maxima.</p><p id="p-0048" num="0062">Knowledge of the emitted intensity from the display screen, the sensitivity of the sensor, and the maxima determined above allows the reflectance of the surface to be characterised: The positions of the maxima (plus the sensor angle) may be used to determine the distance between the display screen and the surface. This distance may then be used, in combination with the emitted intensity and the measured intensity, to determine the reflectance of the surface for specular reflection and for diffuse reflection, i.e. by comparing the intensity of light received at the sensor to the intensity that would have been received if the surface was a perfect reflector (which is a function of the intensity of the display and the distance travelled by the light).</p><p id="p-0049" num="0063">While the above has considered effectively monochromatic measurement of reflection, similar methods can be used for color measurement. Color measurement is achieved by measuring diffuse reflection for a set of different colors and then mapping the results onto a color space. The set of measured colors may be defined, for example by a color e.g. wavelength of the emitted (illuminating) light, which may be varied; and/or by the spectral channels to which the optical sensor is sensitive.</p><p id="p-0050" num="0064">The wavelength of emitted light may be varied by displaying the patterns on the display screen in at least two colors. Also or instead the optical sensor may be sensitive in at least 2, 3, 4 or more spectral channels, where each channel has a different sensitivity vs wavelength function. The results of the measurements can be transformed to produce a color measurement in a standard color space, or to produce an approximate color spectrum, by standard techniques as known in the art.</p><p id="p-0051" num="0065">The transformation may be performed by a matrix operation, i.e. multiplying a vector representation of the measurements with a matrix representation of the transformation between the measurements and a color space, to obtain a vector representation of the color in that color space. The transformation matrix coefficients will relate to the spectrum of the illumination (i.e. the light emitted by the display screen) and the spectral sensitivity of the sensor. For a color space having w components, and a multi-spectral sensor having n channels, the transformation matrix will be an w&#xd7;n matrix. Typical color spaces have three components, e.g. the XYZ color space, so where such a color space is used with an RGB sensor, the transformation matrix would be a 3&#xd7;3 matrix. If a spectral reconstruction is desired, this may be treated as a color space having a large number of components (e.g. 380 nm, 381 nm, etc, up to 780 nm), and the procedure is equivalent.</p><p id="p-0052" num="0066">This transformation may use a preconfigured calibration in the controller, and/or suitable calculations may be performed by the controlled to determine the transformation. Such a calibration may be obtained theoretically, or by measuring surfaces with known color properties and determining the calibration experimentally; the calibration data may then be stored for use by the controller. The color space may be e.g. a CIE color space such as the CIE XYZ color space, or a color space based on the RGB model.</p><p id="p-0053" num="0067">The intensity is measured for each pattern color, sensor channel, or combination of pattern colour and sensor channel, at a pattern distance corresponding to the maximum of diffuse reflection. This may be the maximum actually measured point, or may be an interpolation of the measured points to obtain the &#x201c;true&#x201d; maximum of diffuse reflection. he set of measured intensities at maximum diffuse reflection are then transformed to give a color measurement, e.g. in a standard color space, or an estimate of the reflectance spectrum of the surface.</p><p id="p-0054" num="0068">The sensor may be e.g. any of: a three channel sensor (e.g. a sensor which provides direct output in a three-channel color space, such as an RGB or XYZ sensor); a camera chip, such as a CCD (to measure the correct region of the surface, the measurement may use only a subset of the pixels of the camera chip); a multi-spectral sensor; and a photodetector array, wherein the photodetectors in the array are configured to measure light in each of a plurality of spectral channels.</p><p id="p-0055" num="0069">The display may be e.g. any of: an OLED display; a backlit liquid crystal display; and any other light emitting display e.g. which can display arbitrary patterns.</p><p id="p-0056" num="0070">The transformation from the sensor measurements to the color may be based in part on a calibration based on the wavelength-dependent sensitivity of the sensor and/or the wavelength dependent intensity of light emitted by the display (i.e. the spectral characteristics of &#x201c;white&#x201d; as emitted by the display). Example wavelength dependent intensities for &#x201c;white&#x201d; on common display screens are shown in <figref idref="DRAWINGS">FIG. <b>8</b></figref>.</p><p id="p-0057" num="0071">An additional backlight compensation step may be performed. This may comprise taking measurements from the sensor when the device is in position but no pattern is displayed on the display screen (e.g. the screen is black), and subtracting these measurements from all other measurements made by the sensor.</p><p id="p-0058" num="0072">The sensor angle may be 45 degrees (i.e. to give a measurement geometry which matches the generally used standards for color measurement), but other geometries may be used (e.g. to allow the method to be performed with a broader range of hardware).</p><p id="p-0059" num="0073">The device may be provided as an integral unit (e.g. having the display and the sensor on the same unit, such as a smartphone with a front facing camera), or the sensor may be provided as a module to be attached to a second module comprising the display.</p><p id="p-0060" num="0074">There are various possibilities for the pattern which is used to illuminate the target. The simplest is a circle as shown in <figref idref="DRAWINGS">FIGS. <b>5</b>A to <b>5</b>E</figref>, with the circles being of a consistent size, and located on a single line extending through the sensor, in this case, the midline of the display. The radius of the circles, or in general, the size of the illuminated area in each pattern, is a balance between the illumination of the surface, and how closely the illumination is to the ideal &#x201c;point source&#x201d;-like behaviour. Larger patterns give greater illumination; smaller patterns give results closer to a point source.</p><p id="p-0061" num="0075">The use of illumination areas within the patterns with shapes other than circles can provide a better balance between these factors. <figref idref="DRAWINGS">FIGS. <b>9</b>A and <b>9</b>B</figref> show other options for the pattern; each shows all of the patterns at once, for convenience, although these are in practice displayed sequentially (as in <figref idref="DRAWINGS">FIGS. <b>5</b>A</figref> to E). For example, if each pattern is a line <b>901</b> perpendicular to the line extending through the sensor, e.g. horizontal lines on the display, as shown in <figref idref="DRAWINGS">FIG. <b>9</b>A</figref>, then the total area of the pattern is larger for a given span of illumination angles of the pattern. The span of illumination angles is the difference between the illumination angle for the part of the pattern closest to the sensor, and the illumination angle for the part of the pattern furthest from the sensor. Further improvement in that regard can be obtained by defining the pattern to be an arc <b>902</b> centred on the sensor (as shown in <figref idref="DRAWINGS">FIG. <b>9</b>B</figref>), but in this case the pattern area is different depending on the pattern distance.</p><p id="p-0062" num="0076">Additionally, by comparing the measurements received from patterns either side of a straight line passing through the sensor, the tilt of the device may be determined. If the device is parallel to the surface, then the measurements made by the sensor should be the same for a first pattern which is located at a first pattern distance from the sensor, and is located on the left side of a straight line passing through the sensor, and for a second pattern which is located at the same pattern distance but on the right side of the straight line passing through the sensor&#x2014;where the straight line passing through the sensor passes directly over the target point. If the measurement is greater for the first pattern than for the second pattern, then this indicates that the left side of the device is closer to the surface than the right side, and vice versa. To obtain increased accuracy for this tilt measurement it may be performed at the pattern distance corresponding to the maximum specular reflection (as this will show the greatest change in measured intensity due to tilt), but this is not required.</p><p id="p-0063" num="0077">While the controller has been described above as being integral with the device, this need not be the case. <figref idref="DRAWINGS">FIG. <b>10</b></figref> shows an alternative arrangement where the device <b>1000</b> comprises a display screen <b>1001</b> and a sensor <b>1002</b>. A separate controller <b>1003</b> is connected to the device via a wired or wireless data connection <b>1004</b>. For example, the device may be a peripheral which is connected to a computer which acts as the controller, As a further alternative (not illustrated), the role of the controller may be shared between a first controller on the device, and a second, external controller. For example, the second controller may be a cloud server which performs the determination of the color from the sensor measurements, with the control of the display being handled by a first controller on the device.</p><p id="p-0064" num="0078">In general, a system comprises a device (<b>200</b>, <b>1000</b>) having a display screen (<b>201</b>, <b>1001</b>) and a sensor (<b>202</b>, <b>1002</b>), and also comprises a controller which may be a part of the device (<b>203</b>), external to the device (<b>1003</b>), or distributed between the device and other entities (not shown in figures).</p><p id="p-0065" num="0079">The examples of the above disclosure can be employed in many different applications including paint or dye matching, color reproduction in computer generated imagery, or characterising materials, for example, in the paint industry, and other industries.</p><heading id="h-0007" level="1">LIST OF REFERENCE NUMERALS</heading><p id="p-0066" num="0080"><b>101</b> light source</p><p id="p-0067" num="0081"><b>102</b> point on surface <b>103</b></p><p id="p-0068" num="0082"><b>103</b> surface</p><p id="p-0069" num="0083"><b>104</b> detector</p><p id="p-0070" num="0084"><b>200</b> device</p><p id="p-0071" num="0085"><b>201</b> display screen</p><p id="p-0072" num="0086"><b>202</b> optical sensor</p><p id="p-0073" num="0087"><b>203</b> controller</p><p id="p-0074" num="0088"><b>300</b> surface</p><p id="p-0075" num="0089"><b>301</b> target spot on surface</p><p id="p-0076" num="0090"><b>310</b> field of view of sensor <b>202</b></p><p id="p-0077" num="0091"><b>320</b> patterns on display <b>201</b></p><p id="p-0078" num="0092"><b>401</b> first method step</p><p id="p-0079" num="0093"><b>402</b> second method step</p><p id="p-0080" num="0094"><b>403</b> third method step</p><p id="p-0081" num="0095">In <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the reference numerals are followed by a letter from a to e, with each letter denoting the respective element in <figref idref="DRAWINGS">FIGS. <b>6</b>A to <b>6</b>E</figref> respectively.</p><p id="p-0082" num="0096"><b>601</b><i>a</i>-<i>e </i>sensor angle</p><p id="p-0083" num="0097"><b>602</b><i>a</i>-<i>e </i>illumination angle</p><p id="p-0084" num="0098"><b>603</b><i>a</i>-<i>e </i>intensity of reflection</p><p id="p-0085" num="0099"><b>701</b> peak measurement corresponding to diffuse reflection</p><p id="p-0086" num="0100"><b>702</b> peak measurement corresponding to specular reflection</p><p id="p-0087" num="0101"><b>901</b> pattern comprising line across display screen</p><p id="p-0088" num="0102"><b>902</b> pattern comprising arc on display screen, centered on sensor</p><p id="p-0089" num="0103"><b>1000</b> alternative device</p><p id="p-0090" num="0104"><b>1001</b> display screen</p><p id="p-0091" num="0105"><b>1002</b> optical sensor</p><p id="p-0092" num="0106"><b>1003</b> controller external to device <b>1000</b></p><p id="p-0093" num="0107"><b>1004</b> connection between controller <b>1003</b> and device <b>1000</b></p><p id="p-0094" num="0108">The skilled person will understand that in the preceding description and appended claims, positional terms such as &#x2018;above&#x2019;, &#x2018;along&#x2019;, &#x2018;side&#x2019;, etc. are made with reference to conceptual illustrations, such as those shown in the appended drawings. These terms are used for ease of reference but are not intended to be of limiting nature. These terms are therefore to be understood as referring to an object when in an orientation as shown in the accompanying drawings.</p><p id="p-0095" num="0109">Also, while &#x201c;intensity&#x201d; has generally been used as a measure of brightness of light, it will be appreciated that similar quantities (e.g. power, radiance, etc) may be used instead, as would be apparent to the person skilled in the art.</p><p id="p-0096" num="0110">Although the disclosure has been described in terms of examples as set forth above, it should be understood that these are illustrative only and that the claims are not limited to those examples. Those skilled in the art will be able to make modifications and alternatives in view of the disclosure which are contemplated as falling within the scope of the appended claims. Each feature disclosed or illustrated in the present specification may be incorporated in any practical realisation of the concepts therein, whether alone or in any appropriate combination with any other feature disclosed or illustrated herein.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A method of measuring the color of a surface, the method comprising:<claim-text>positioning a device above the surface, the device comprising an optical sensor and a display screen, wherein the optical sensor measures visible light level in a plurality of spectral channels, each channel having different spectral sensitivity characteristics, the device being positioned such that the sensor measures light reflected from the surface;</claim-text><claim-text>sequentially displaying a plurality of patterns on the display screen, each pattern comprising an illuminated region at a different respective distance from the optical sensor;</claim-text><claim-text>measuring, using the optical sensor, light reflected by the surface during display of each pattern;</claim-text><claim-text>determining a value of the distance from the optical sensor to the illuminated region for a first local maximum of intensity of the measured light reflected by the surface, the first local maximum being a maximum of the diffuse reflection of the pattern;</claim-text><claim-text>determining a location in a color space corresponding to a color of the surface or a reflectance spectrum of the surface based on the visible light level in each spectral channel for the value of the distance corresponding to the first local maximum.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the value of the distance corresponding to the first local maximum is determined for one of:<claim-text>measurements from a single channel of the plurality of spectral channels; and</claim-text><claim-text>an average of measurements from each channel of the plurality of spectral channels.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the illuminated region of each pattern is white.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. A method according to preceding <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the plurality of patterns comprises at least two groups of patterns, and wherein the illuminated region of each group of patterns is displayed in a different color.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. A method of measuring the color of a surface, the method comprising:<claim-text>positioning a device above the surface, the device comprising an optical sensor and a display screen, wherein the optical sensor measures visible light level, the device being positioned such that the sensor measures light reflected from the surface;</claim-text><claim-text>sequentially displaying a plurality of patterns on the display screen, each pattern comprising an illuminated region at a different respective distance from the optical sensor, wherein the plurality of patterns comprises at least two groups of patterns, the illuminated region of each group of patterns being displayed in a different color;</claim-text><claim-text>measuring, using the optical sensor, light reflected by the surface during display of each pattern;</claim-text><claim-text>determining a value of the distance from the optical sensor to the illuminated region for a first local maximum of intensity of the measured light reflected by the surface, the first local maximum being a maximum of the diffuse reflection of the pattern;</claim-text><claim-text>determining a location in a color space corresponding to a color of the surface or a reflectance spectrum of the surface based on the visible light level for each group of patterns for the value of the distance corresponding to the local maximum.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. A method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the first local maximum is a local maximum point of an curve of intensity against the value of the distance, such that the curve fits the measurements, and wherein the location in color space is determined by interpolating the measurements to obtain further measurements at the first local maximum.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. A method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, further comprising obtaining a background measurement by measuring, using the optical sensor, light reflected by the surface when no pattern is displayed, and subtracting the background measurement for each other measurement of the sensor.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. A method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the optical sensor is configured to measure light reflected at an angle of 45 degrees from the surface.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. A method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the sensor is configured to measure visible light level in a plurality of spectral channels, and comprises any one or more of:<claim-text>a photodetector array, the photodetector array comprising photodetectors being sensitive to each of the spectral channels;</claim-text><claim-text>a multi-spectral optical sensor;</claim-text><claim-text>a three channel color sensor;</claim-text><claim-text>a camera comprising a CCD or CMOS; and</claim-text><claim-text>a camera comprising a CCD or CMOS, wherein only a subset of pixels of the CCD or CMOS are used to obtain the measurement.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. A method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the illuminated region of each pattern is a disc against a black background.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the illuminated region of each pattern is a straight line across the display screen, against a black background.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the illuminated region of each pattern is an arc centered on the sensor, against a black background.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising determining a reflectance of the surface based on a second local maximum of the reflected light, wherein the second local maximum corresponds to a value of the distance which is greater than the value of the distance of the first local maximum.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. A method according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, and comprising determining a distance between the device and the surface based on the value of the distance corresponding to the first local maximum, and determining the reflectance of the surface based on the distance between the device and the surface and the measurements made by the sensor at the pattern distance corresponding to the second local maximum.</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the plurality of patterns consists of:<claim-text>a first set of patterns, wherein each pattern in the first set is a translation of the other patterns in the first set along a straight line from the sensor;</claim-text><claim-text>a second set of patterns, wherein the second set of patterns are located either side of the straight line from the sensor;</claim-text><claim-text>using measurements of reflected light of the second set of patterns to determine a tilt of the device relative to the surface.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. A system comprising:<claim-text>a device comprising:<claim-text>an optical sensor configured to measure visible light level in a plurality of spectral channels, each channel having different spectral sensitivity characteristics; and</claim-text><claim-text>a display screen; and</claim-text></claim-text><claim-text>a controller configured to:<claim-text>command the display screen to sequentially display a plurality of patterns, each pattern comprising an illuminated region at a different respective distance from the sensor;</claim-text><claim-text>receive measurements from the optical sensor of light reflected by a surface during display of each pattern;</claim-text><claim-text>determine a value of the distance from the optical sensor to the illuminated region for a first local maximum of intensity of the measured light reflected by the surface, the first local maximum being a maximum of the diffuse reflection of the pattern; and</claim-text><claim-text>determine a location in a color space corresponding to a color of the surface or a reflectance spectrum of the surface based on the visible light level in each spectral channel for the value of the distance corresponding to the first local maximum.</claim-text></claim-text></claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. (canceled)</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. (canceled)</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. (canceled)</claim-text></claim></claims></us-patent-application>