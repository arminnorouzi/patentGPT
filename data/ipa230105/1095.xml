<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230001096A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230001096</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17943027</doc-number><date>20220912</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="regional"><country>EP</country><doc-number>17306626.7</doc-number><date>20171123</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>A</section><class>61</class><subclass>M</subclass><main-group>5</main-group><subgroup>315</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>A</section><class>61</class><subclass>M</subclass><main-group>5</main-group><subgroup>32</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>M</subclass><main-group>5</main-group><subgroup>31551</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>M</subclass><main-group>5</main-group><subgroup>3202</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>M</subclass><main-group>2005</main-group><subgroup>3126</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">Medicament Injection Device</invention-title><us-related-documents><division><relation><parent-doc><document-id><country>US</country><doc-number>16766144</doc-number><date>20200521</date></document-id><parent-status>PENDING</parent-status><parent-pct-document><document-id><country>WO</country><doc-number>PCT/EP2018/082438</doc-number><date>20181123</date></document-id></parent-pct-document></parent-doc><child-doc><document-id><country>US</country><doc-number>17943027</doc-number></document-id></child-doc></relation></division></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>SANOFI</orgname><address><city>Paris</city><country>FR</country></address></addressbook><residence><country>FR</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Schabbach</last-name><first-name>Michael</first-name><address><city>Frankfurt am Main</city><country>DE</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Morris</last-name><first-name>Anthony Paul</first-name><address><city>Warwick</city><country>GB</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Smith</last-name><first-name>Ronald Antony</first-name><address><city>Warwick</city><country>GB</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>Molyneux</last-name><first-name>Brian Charles</first-name><address><city>Warwick</city><country>GB</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>Draper</last-name><first-name>Paul Richard</first-name><address><city>Warwick</city><country>GB</country></address></addressbook></inventor><inventor sequence="05" designation="us-only"><addressbook><last-name>Mason</last-name><first-name>Craig Ashley</first-name><address><city>Warwick</city><country>GB</country></address></addressbook></inventor><inventor sequence="06" designation="us-only"><addressbook><last-name>Gazeley</last-name><first-name>Oliver Charles</first-name><address><city>Warwick</city><country>GB</country></address></addressbook></inventor><inventor sequence="07" designation="us-only"><addressbook><last-name>Clark</last-name><first-name>Daniel Edward</first-name><address><city>Warwick</city><country>GB</country></address></addressbook></inventor><inventor sequence="08" designation="us-only"><addressbook><last-name>Plumptre</last-name><first-name>David Aubrey</first-name><address><city>Warwick</city><country>GB</country></address></addressbook></inventor><inventor sequence="09" designation="us-only"><addressbook><last-name>O'Hare</last-name><first-name>Aidan Michael</first-name><address><city>Warwick</city><country>GB</country></address></addressbook></inventor><inventor sequence="10" designation="us-only"><addressbook><last-name>Thomas</last-name><first-name>Richard James</first-name><address><city>Warwick</city><country>GB</country></address></addressbook></inventor><inventor sequence="11" designation="us-only"><addressbook><last-name>Kramer</last-name><first-name>Felix</first-name><address><city>Wil</city><country>CH</country></address></addressbook></inventor><inventor sequence="12" designation="us-only"><addressbook><last-name>Wyss</last-name><first-name>Beat</first-name><address><city>Wil</city><country>CH</country></address></addressbook></inventor><inventor sequence="13" designation="us-only"><addressbook><last-name>M&#xfc;ller</last-name><first-name>Philipp</first-name><address><city>Wil</city><country>CH</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">The present disclosure relates to medicament injection devices. An injection device includes: a movable dosage programming component comprising a rotary encoder system having a predefined angular periodicity, a sensor arrangement including a first optical sensor configured to detect movement of the movable dosage programming component relative to the sensor arrangement during dosing of a medicament, wherein the first optical sensor is configured to operate in a strobe-sampling mode at a first frequency, a second optical sensor configured to detect movement of the rotary encoder system relative to the second optical sensor wherein the second optical sensor is configured to operate in a strobe-sampling mode at a second frequency lower than the first frequency, and a processor arrangement configured to, based on the detected movement, determine a medicament dosage administered by the injection device.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="101.01mm" wi="83.90mm" file="US20230001096A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="145.12mm" wi="126.92mm" file="US20230001096A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="171.11mm" wi="135.64mm" file="US20230001096A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="151.72mm" wi="118.45mm" file="US20230001096A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="204.05mm" wi="93.13mm" file="US20230001096A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="128.10mm" wi="125.14mm" file="US20230001096A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="188.21mm" wi="126.15mm" file="US20230001096A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="204.89mm" wi="140.46mm" file="US20230001096A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="194.73mm" wi="119.80mm" file="US20230001096A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="162.81mm" wi="153.25mm" file="US20230001096A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="198.63mm" wi="112.61mm" file="US20230001096A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="196.00mm" wi="128.95mm" orientation="landscape" file="US20230001096A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="185.42mm" wi="123.02mm" file="US20230001096A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00013" num="00013"><img id="EMI-D00013" he="246.04mm" wi="157.90mm" file="US20230001096A1-20230105-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00014" num="00014"><img id="EMI-D00014" he="209.47mm" wi="146.98mm" file="US20230001096A1-20230105-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00015" num="00015"><img id="EMI-D00015" he="176.87mm" wi="150.96mm" file="US20230001096A1-20230105-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00016" num="00016"><img id="EMI-D00016" he="172.13mm" wi="146.73mm" file="US20230001096A1-20230105-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00017" num="00017"><img id="EMI-D00017" he="208.20mm" wi="136.06mm" file="US20230001096A1-20230105-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00018" num="00018"><img id="EMI-D00018" he="192.87mm" wi="131.32mm" file="US20230001096A1-20230105-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00019" num="00019"><img id="EMI-D00019" he="152.57mm" wi="152.32mm" file="US20230001096A1-20230105-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00020" num="00020"><img id="EMI-D00020" he="200.32mm" wi="128.10mm" orientation="landscape" file="US20230001096A1-20230105-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00021" num="00021"><img id="EMI-D00021" he="218.44mm" wi="144.19mm" orientation="landscape" file="US20230001096A1-20230105-D00021.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00022" num="00022"><img id="EMI-D00022" he="215.98mm" wi="135.21mm" orientation="landscape" file="US20230001096A1-20230105-D00022.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00023" num="00023"><img id="EMI-D00023" he="233.00mm" wi="116.33mm" orientation="landscape" file="US20230001096A1-20230105-D00023.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00024" num="00024"><img id="EMI-D00024" he="230.38mm" wi="119.55mm" orientation="landscape" file="US20230001096A1-20230105-D00024.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00025" num="00025"><img id="EMI-D00025" he="179.83mm" wi="137.24mm" orientation="landscape" file="US20230001096A1-20230105-D00025.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00026" num="00026"><img id="EMI-D00026" he="238.84mm" wi="114.30mm" orientation="landscape" file="US20230001096A1-20230105-D00026.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00027" num="00027"><img id="EMI-D00027" he="216.15mm" wi="128.78mm" orientation="landscape" file="US20230001096A1-20230105-D00027.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATIONS</heading><p id="p-0002" num="0001">The present application is a divisional of U.S. patent application Ser. No. 16/766,144, filed on May 21, 2020, which is the national stage entry of International Patent Application No. PCT/EP2018/082438, filed on Nov. 23, 2018, and claims priority to Application No. EP 17306626.7, filed on Nov. 23, 2017, the disclosures of which are incorporated herein by reference.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">The present disclosure is generally to medicament injection devices.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">A variety of diseases exists that require regular treatment by injection of a medicament. Such injection can be performed by using injection devices, which are applied either by medical personnel or by patients themselves. As an example, type-1 and type-2 diabetes can be treated by patients themselves by injection of insulin doses, for example once or several times per day. For instance, a pre-filled disposable insulin pen can be used as an injection device. Alternatively, a re-usable pen may be used. A re-usable pen allows replacement of an empty medicament cartridge by a new one. Either pen may come with a set of one-way needles that are replaced before each use. The insulin dose to be injected can then for instance be manually selected at the insulin pen by turning a dosage knob and observing the actual dose from a dose window or display of the insulin pen. The dose is then injected by inserting the needle into a suited skin portion and pressing an injection button of the insulin pen. To be able to monitor insulin injection, for instance to prevent false handling of the insulin pen or to keep track of the doses already applied, it is desirable to measure information related to a condition and/or use of the injection device, such as for instance information on the injected insulin dose.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0005" num="0004">According to a first aspect, this disclosure describes an injection device comprising: a movable dosage programming component comprising a rotary encoder system having a predefined angular periodicity; a sensor arrangement comprising a first optical sensor configured to detect movement of the movable dosage programming component relative to the sensor arrangement during dosing of a medicament, wherein the first optical sensor is configured to operate in a strobe-sampling mode at a first frequency, and a second optical sensor configured to detect movement of the rotary encoder system relative to the second optical sensor, wherein the second optical sensor is configured to operate in a strobe-sampling mode at a second frequency lower than the first frequency; and a processor arrangement configured to, based on said detected movement, determine a medicament dosage administered by the injection device.</p><p id="p-0006" num="0005">The rotary encoder system may be configured to be rotatable with respect to the first optical sensor during a dialing mode of operation of the injection device.</p><p id="p-0007" num="0006">The rotary encoder system may comprise an encoder ring comprising a plurality of substantially light reflective flags arranged circumferentially around the encoder ring in accordance with the predefined periodicity.</p><p id="p-0008" num="0007">The encoder ring may comprise a plurality of substantially light absorbent flags arranged to alternate with the plurality of substantially light reflective flags in accordance with the predefined periodicity.</p><p id="p-0009" num="0008">Lateral edges of the plurality of substantially light reflective flags may be inwardly inclined.</p><p id="p-0010" num="0009">The second optical sensor may be configured to operate in a strobe-sampling mode at a second frequency lower than the first frequency.</p><p id="p-0011" num="0010">The first and second optical sensors may have an angular offset equal to half the predefined angular periodicity, with the first and second optical sensors configured to operate in a synchronous mode of operation.</p><p id="p-0012" num="0011">The first and second optical sensors may have an angular offset that differs from half the predefined angular periodicity, with the first and second optical sensors configured to operate in a staggered mode of operation with an offset time between sampling by the first and second optical sensors.</p><p id="p-0013" num="0012">The angular offset may be less than half the predefined angular periodicity.</p><p id="p-0014" num="0013">The offset time may be varied based on a relative rotational speed of rotary encoder system with respect to the first and second optical sensors.</p><p id="p-0015" num="0014">The offset time may be decreased in response to an increase in relative rotational speed.</p><p id="p-0016" num="0015">The injection device may further comprise an injection button and an electrical switch connected to the sensor arrangement, the electrical switch arranged to supply power to the sensor arrangement in response to actuation of the injection button.</p><p id="p-0017" num="0016">The injection device may further comprise a cartridge containing a medicament.</p><p id="p-0018" num="0017">According to a second aspect, this disclosure describes a module configured to be used with or applied to an injection device comprising a movable dosage programming component with a rotary encoder system, particularly an injection device as described herein, the module comprising: a sensor arrangement comprising at least one optical sensor being configured to detect movement of the movable dosage programming component of the injection device relative to the sensor arrangement during dosing of a medicament and a collimating optics being arranged between the at least one optical sensor and the movable dosage programming component; and a processor arrangement configured to, based on said detected movement, determine a medicament dosage administered by the injection device.</p><p id="p-0019" num="0018">The collimating optics may comprise one or more of the following: one or more discrete collimating lenses; one or more light pipes.</p><p id="p-0020" num="0019">A discrete collimating lens may be arranged between each optical sensor and each light pipe and/or between each light pipe and the movable dosage programming component.</p><p id="p-0021" num="0020">A single discrete collimating lens may be provided for each sensor and configured to cover the transmitter and/or receiver portion of the sensor.</p><p id="p-0022" num="0021">The single discrete lens may be a lens array covering the sensor, particularly a micro-moulded lens array.</p><p id="p-0023" num="0022">The one or more light pipes may have the shape of a frustum, particularly with a circular or an elliptic base,</p><p id="p-0024" num="0023">According to a third aspect, this disclosure describes a method for processing signals generated by a sensor arrangement of an injection device as described above and disclosed herein or a module as described above and disclosed herein, which comprises a sensor arrangement with two optical sensors arranged with a 180&#xb0; shift such that the signal of the first sensor of the two sensors and the signal of the second sensor of the two sensors are in anti-phase, the method comprising the steps of setting a high threshold and a low threshold for the signal of the first sensor and for the signal of the second sensor, respectively, and counting a unit of a dose selected with the movable dosage programming component if the signal of the second sensor passes the high threshold and thereafter passes the low threshold, and thereafter the signal of the first sensor passes the low threshold and thereafter passes the high threshold.</p><p id="p-0025" num="0024">The step of setting a high threshold and a low threshold for the signal of the first sensor and for the signal of the second sensor, respectively, may comprise a calibration step performed during manufacturing of the module for setting the high and low thresholds, wherein the calibration step comprises passing a set of calibration geometry beneath each sensor at controlled distances for calibration, and setting the high and low thresholds such that the high threshold is always below the largest level of the respective sensor signal observed during calibration and the low threshold is always below the smallest signal level observed during calibration.</p><p id="p-0026" num="0025">The step of setting a high threshold and a low threshold for the signal of the first sensor and for the signal of the second sensor, respectively, may comprise the steps of setting a sampling frequency for sampling the signals of both sensors to a level higher than a sampling frequency used for normal operation and sampling the signals during delivery of a dose with an injection device comprising the module, determining the magnitudes of at least two consecutive peak-throughs of the signal of each sensor, and setting the high threshold and the low threshold for each signal to a percentage of the the determined magnitudes of at least two consecutive peak-throughs if the determined magnitudes of at least two consecutive peak-throughs are within a predetermined tolerance signal range.</p><p id="p-0027" num="0026">According to a fourth aspect, this disclosure describes a method for processing signals generated by a sensor arrangement of an injection device as described above and disclosed herein or a module as described above and disclosed herein, which comprises a sensor arrangement with two optical sensors arranged with a 180&#xb0; shift such that the signal of the first sensor of the two sensors and the signal of the second sensor of the two sensors are in anti-phase, the method comprising the steps of determining of a first crossover point when the level of the signal of the second sensor becomes greater than the level of the signal of the first sensor, determining of a second crossover point when the level of the signal of the first sensor becomes greater than the level of the signal of the second sensor, and counting a unit of a dose selected upon determining the first crossover point after having determined the second crossover point.</p><p id="p-0028" num="0027">The determining of a crossover point when the level of the signal of the one sensor becomes greater than the level of the signal of the other sensor may comprise determining that the difference of the levels of the signals of both sensors exceeds a predetermined threshold.</p><p id="p-0029" num="0028">The method may further comprise a calibration step performed during manufacturing of the module for matching the signals of both sensors in terms of mean signal and signal amplitude, wherein for calibration a set of calibration geometry is passed beneath each sensor at controlled distance and scaling factors for mean and amplitude are applied to the second sensor to match the mean and amplitude of its signal to the mean and amplitude of the signal of the first sensor. Alternatively, the method may further comprise a calibration step performed after selecting a dose, wherein for calibration a dataset for the signals of both sensors is stored and scaling factors are retrospectively calculated from the stored dataset in order to obtain a common mean and amplitude between the signals of both sensors.</p><p id="p-0030" num="0029">According to a fifth aspect, this disclosure describes a method for processing signals generated by a sensor arrangement of an injection device as described above and disclosed herein or a module as described above and disclosed herein, which comprises a sensor arrangement with two optical sensors arranged with a 180&#xb0; shift such that the signal of the first sensor of the two sensors and the signal of the second sensor of the two sensors are in anti-phase, the method comprising the steps of determining peaks of the signals of the first sensor and the second sensor during selection of a dose, and counting a unit of a dose selected when a peak of the signal of the first sensor has been detected after a peak of the signal of the second sensor has been detected.</p><p id="p-0031" num="0030">According to a sixth aspect, this disclosure describes an injection device comprising: a rotary encoder system having a predefined angular periodicity and an encoder ring comprising a plurality of light reflectors arranged circumferentially around the encoder ring in accordance with the predefined periodicity, wherein each light reflector is designed for total internal reflection of an incident light beam; a sensor arrangement comprising a light emitter arranged to emit a light beam directed to a light reflector of the encoder ring and two light receivers arranged to receive a light beam reflected by the light reflector of the encoder ring, wherein the sensor arrangement is configured to detect movement of the movable dosage programming component relative to the sensor arrangement during dosing of a medicament; and a processor arrangement configured to, based on said detected movement, determine a medicament dosage administered by the injection device.</p><p id="p-0032" num="0031">Each light reflector may comprise two reflecting surfaces arranged perpendicular to each other such that an incident light beam is reflected from one reflecting surface to the other reflective surface and reflected from the other reflective surface to the light receivers.</p><p id="p-0033" num="0032">The light reflectors may be made from a transparent material and the two reflecting surfaces of each light reflector are high-polished in order to reflect light incident on the light reflector.</p><p id="p-0034" num="0033">Either the rotary encoder system or the sensor arrangement may be configured to be rotated during dosing of a medicament.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE FIGURES</heading><p id="p-0035" num="0034">So that the general concepts set out in the foregoing sections can be more fully understood, embodiments thereof will be described with reference to the accompanying drawings, in which:</p><p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows an injection device according to a first embodiment;</p><p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows a proximal end of an injection device according to a second embodiment;</p><p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. <b>3</b>A</figref> shows a proximal end of the injection device of <figref idref="DRAWINGS">FIG. <b>2</b></figref> after actuation of an injection button;</p><p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. <b>3</b>B</figref> is a cross-sectional view of the injection device of <figref idref="DRAWINGS">FIG. <b>2</b></figref> after actuation of the injection button;</p><p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a zoomed-in cross-sectional view of the injection device of <figref idref="DRAWINGS">FIG. <b>2</b></figref>;</p><p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is an elevated side view of a first type of encoder system;</p><p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a plan view of the encoder system shown in <figref idref="DRAWINGS">FIG. <b>5</b></figref>;</p><p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a schematic block diagram of a device controller;</p><p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. <b>8</b>A</figref> is a cross-sectional view of the proximal end of a device before actuation of an injection button;</p><p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. <b>8</b>B</figref> is a cross-sectional view of the proximal end of a device during partial actuation of an injection button;</p><p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. <b>8</b>C</figref> is a cross-sectional view of the proximal end of a device during full actuation of an injection button;</p><p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is an elevated side view of a second type of encoder system;</p><p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a plan view of the encoder system shown in <figref idref="DRAWINGS">FIG. <b>9</b></figref>;</p><p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. <b>11</b></figref> illustrates a Gray code output;</p><p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. <b>12</b></figref> is a partial plan view of an encoder system;</p><p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. <b>13</b></figref> is a partial plan view of an encoder system;</p><p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. <b>14</b></figref> is an elevated side view of a third type of encoder system;</p><p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. <b>15</b>A</figref> is a partial plan view of an encoder system;</p><p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. <b>15</b>B</figref> is a partial plan view of an encoder system;</p><p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. <b>16</b></figref> is an elevated side view of a fourth type of encoder system;</p><p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. <b>17</b></figref> is an elevated side view of a fifth type of encoder system;</p><p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. <b>18</b>A</figref> is a plan view of a sixth type of encoder system;</p><p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. <b>18</b>B</figref> is a plan view of a seventh type of encoder system;</p><p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. <b>19</b>A</figref> is a screenshot showing scope traces obtained from various embodiments;</p><p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. <b>19</b>B</figref> is a close-up view of the screenshot of <figref idref="DRAWINGS">FIG. <b>19</b>A</figref>;</p><p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. <b>20</b>A</figref> shows a first method for varying the strobe of an LED of the sensors;</p><p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. <b>20</b>B</figref> shows a second method for varying the strobe of an LED of the sensors;</p><p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. <b>20</b>C</figref> shows a third method for varying the strobe of an LED of the sensors;</p><p id="p-0064" num="0063"><figref idref="DRAWINGS">FIG. <b>21</b></figref> is an elevated side view of an eight type of encoder system;</p><p id="p-0065" num="0064"><figref idref="DRAWINGS">FIG. <b>22</b></figref> is a plan view of the encoder system shown in <figref idref="DRAWINGS">FIG. <b>19</b></figref>;</p><p id="p-0066" num="0065"><figref idref="DRAWINGS">FIG. <b>23</b></figref> is a schematic for demonstrating the light guidance with a light pipe of a sensor arrangement used in the eight type encoder system of <figref idref="DRAWINGS">FIGS. <b>20</b> and <b>21</b></figref>;</p><p id="p-0067" num="0066"><figref idref="DRAWINGS">FIG. <b>24</b></figref> is a schematic for demonstrating the light guidance with a light pipe and collimating lenses of a sensor arrangement used in the eight type encoder system of <figref idref="DRAWINGS">FIGS. <b>20</b> and <b>21</b></figref>;</p><p id="p-0068" num="0067"><figref idref="DRAWINGS">FIG. <b>25</b></figref> is an elevated side view of an electronic module sub assembly comprising a separate injection moulded component with a light guidance;</p><p id="p-0069" num="0068"><figref idref="DRAWINGS">FIG. <b>26</b></figref> is an elevated side view of the separate injection moulded component comprising collimating lenses of the light guidance;</p><p id="p-0070" num="0069"><figref idref="DRAWINGS">FIG. <b>27</b></figref> is an elevated side view of another electronic module sub assembly comprising an integrally injection moulded collimating lenses assembly of a light guidance with a tool side-action to form distal surfaces of the collimating lenses;</p><p id="p-0071" num="0070"><figref idref="DRAWINGS">FIG. <b>28</b></figref> is a side view of the electronic module sub assembly of <figref idref="DRAWINGS">FIG. <b>27</b></figref> showing the formed distal surfaces of the collimating lenses;</p><p id="p-0072" num="0071"><figref idref="DRAWINGS">FIG. <b>29</b></figref> shows four schematics of four alternative collimating lens assemblies for implementing a light guidance for the eight type of encoder system;</p><p id="p-0073" num="0072"><figref idref="DRAWINGS">FIG. <b>30</b></figref> shows the course of signal voltages generated by two optical sensors of a sensor arrangement during movement of a movable dosage programming component relative to the sensor arrangement according to an embodiment;</p><p id="p-0074" num="0073"><figref idref="DRAWINGS">FIG. <b>31</b></figref> shows the course of signal voltages generated by two optical sensors of a sensor arrangement during movement of a movable dosage programming component relative to the sensor arrangement and the setting of a &#x201c;high&#x201d; and &#x201c;low&#x201d; static threshold voltage for the signal voltages of each optical sensor of a sensor arrangement according to an embodiment of a first algorithm;</p><p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. <b>32</b></figref> shows the course of signal voltages generated by two optical sensors of a sensor arrangement during movement of a movable dosage programming component relative to the sensor arrangement and the setting of a &#x201c;high&#x201d; and &#x201c;low&#x201d; dynamic threshold voltage for the signal voltages of each optical sensor of a sensor arrangement according to an embodiment of a second algorithm;</p><p id="p-0076" num="0075"><figref idref="DRAWINGS">FIG. <b>33</b></figref> shows the course of signal voltages generated by two optical sensors of a sensor arrangement that are typically not matched in terms of mean voltage and voltage amplitude;</p><p id="p-0077" num="0076"><figref idref="DRAWINGS">FIG. <b>34</b></figref> shows the course of signal voltages generated by two optical sensors of a sensor arrangement during movement of a movable dosage programming component relative to the sensor arrangement and the detecting of a crossover point of the signal voltages of each optical sensor of a sensor arrangement according to an embodiment of a third algorithm;</p><p id="p-0078" num="0077"><figref idref="DRAWINGS">FIG. <b>35</b></figref> shows the course of signal voltages generated by two optical sensors of a sensor arrangement during movement of a movable dosage programming component relative to the sensor arrangement and the detecting of a low power peak of the signal voltages of each optical sensor of a sensor arrangement according to an embodiment of a fifth algorithm;</p><p id="p-0079" num="0078"><figref idref="DRAWINGS">FIG. <b>36</b></figref> shows a partial cross-sectional side view of a proximal end of an injection device according to a third embodiment; and</p><p id="p-0080" num="0079"><figref idref="DRAWINGS">FIG. <b>37</b></figref> shows the course of signal voltages generated by two optical sensors of a sensor arrangement during movement of a movable dosage programming component relative to the sensor arrangement according to the third embodiment of the injection device.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION</heading><p id="p-0081" num="0080">In the following, embodiments will be described with reference to an insulin injection device. The present disclosure is however not limited to such application and may equally well be deployed with injection devices that eject other medicaments.</p><p id="p-0082" num="0081">Embodiments are provided in relation to injection devices, in particular to variable dose injection devices, which record and/or track data on doses delivered thereby. These data may include the size of the selected dose, the time and date of administration, the duration of the administration and the like. Features described herein include the arrangement of sensing elements, power management techniques (to facilitate small batteries) and a trigger switch arrangement to enable efficient power usage.</p><p id="p-0083" num="0082">Certain embodiments in this document are illustrated with respect to Sanofi's AllSTAR&#xae; injection device where an injection button and grip are combined. The mechanical construction of the AllSTAR&#xae; injection device is described in detail in the international patent application WO2014/033195A1, which is incorporated herein by reference. Other injection devices with the same kinematical behaviour of the dial extension and trigger button during dose setting and dose expelling operational mode are known as, for example, the Kwikpen&#xae; device marketed by Eli Lilly and the Novopen&#xae; device marketed by Novo Nordisk. An application of the general principles to these devices therefore appears straightforward and further explanations will be omitted. However, the general principles of the present disclosure are not limited to that kinematical behaviour. Certain other embodiments may be conceived for application to Sanofi's SoloSTAR&#xae; injection device where there are separate injection button and grip components.</p><p id="p-0084" num="0083">In the following discussion, the terms &#x201c;distal&#x201d;, &#x201c;distally&#x201d; and &#x201c;distal end&#x201d; refer to the end of an injection device towards which a needle is provided. The terms &#x201c;proximal&#x201d;, &#x201c;proximally&#x201d; and &#x201c;proximal end&#x201d; refer to the opposite end of the injection device towards which an injection button or dosage knob is provided.</p><p id="p-0085" num="0084"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is an exploded view of a medicament delivery device. In this example, the medicament delivery device is an injection device <b>1</b>, such as Sanofi's AllSTAR&#xae; injection pen. The injection device <b>1</b> of <figref idref="DRAWINGS">FIG. <b>1</b></figref> is a pre-filled, disposable injection pen that comprises a housing <b>10</b> and contains an insulin container <b>14</b>, to which a needle <b>15</b> can be affixed. The needle is protected by an inner needle cap <b>16</b> and either an outer needle cap <b>17</b> other cap <b>18</b>. An insulin dose to be ejected from injection device <b>1</b> can be programmed, or &#x2018;dialled in&#x2019; by turning a dosage knob <b>12</b>, and a currently programmed dose is then displayed via dosage window <b>13</b>, for instance in multiples of units. For example, where the injection device <b>1</b> is configured to administer human insulin, the dosage may be displayed in so-called International Units (IU), wherein one IU is the biological equivalent of about 45.5 micrograms of pure crystalline insulin (1/22 mg). Other units may be employed in injection devices for delivering analogue insulin or other medicaments. It should be noted that the selected dose may equally well be displayed differently than as shown in the dosage window <b>13</b> in <figref idref="DRAWINGS">FIG. <b>1</b></figref>.</p><p id="p-0086" num="0085">The dosage window <b>13</b> may be in the form of an aperture in the housing <b>10</b>, which permits a user to view a limited portion of a dial sleeve <b>70</b> that is configured to move when the dosage knob <b>12</b> is turned, to provide a visual indication of a currently programmed dose. The dosage knob <b>12</b> is rotated on a helical path with respect to the housing <b>10</b> when turned during programming.</p><p id="p-0087" num="0086">In this example, the dosage knob <b>12</b> includes one or more formations <b>71</b><i>a, </i><b>71</b><i>b, </i><b>71</b><i>c </i>to facilitate attachment of a data collection device.</p><p id="p-0088" num="0087">The injection device <b>1</b> may be configured so that turning the dosage knob <b>12</b> causes a mechanical click sound to provide acoustical feedback to a user. The dial sleeve <b>70</b> mechanically interacts with a piston in insulin container <b>14</b>. In this embodiment, the dosage knob <b>12</b> also acts as an injection button. When needle <b>15</b> is stuck into a skin portion of a patient, and then dosage knob <b>12</b> is pushed in an axial direction, the insulin dose displayed in display window <b>13</b> will be ejected from injection device <b>1</b>. When the needle <b>15</b> of injection device <b>1</b> remains for a certain time in the skin portion after the dosage knob <b>12</b> is pushed, a high percentage of the dose is actually injected into the patient's body. Ejection of the insulin dose may also cause a mechanical click sound, which is however different from the sounds produced when rotating the dosage knob <b>12</b> during dialing of the dose.</p><p id="p-0089" num="0088">In this embodiment, during delivery of the insulin dose, the dosage knob <b>12</b> is returned to its initial position in an axial movement, without rotation, while the dial sleeve <b>70</b> is rotated to return to its initial position, e.g. to display a dose of zero units.</p><p id="p-0090" num="0089">Injection device <b>1</b> may be used for several injection processes until either the insulin container <b>14</b> is empty or the expiration date of the medicament in the injection device <b>1</b> (e.g. 28 days after the first use) is reached.</p><p id="p-0091" num="0090">Furthermore, before using injection device <b>1</b> for the first time, it may be necessary to perform a so-called &#x201c;prime shot&#x201d; to remove air from insulin container <b>14</b> and needle <b>15</b>, for instance by selecting two units of insulin and pressing dosage knob <b>12</b> while holding injection device <b>1</b> with the needle <b>15</b> upwards. For simplicity of presentation, in the following, it will be assumed that the ejected amounts substantially correspond to the injected doses, so that, for instance the amount of medicament ejected from the injection device <b>1</b> is equal to the dose received by the user. Nevertheless, differences (e.g. losses) between the ejected amounts and the injected doses may need to be taken into account.</p><p id="p-0092" num="0091">As explained above, the dosage knob <b>12</b> also functions as an injection button so that the same component is used for dialling and dispensing.</p><p id="p-0093" num="0092"><figref idref="DRAWINGS">FIGS. <b>2</b>, <b>3</b>A and <b>3</b>B</figref> show the proximal end of a device <b>2</b> according to a second embodiment. The device <b>2</b> comprises a grip <b>205</b> and injection button <b>210</b>. Unlike the device <b>1</b> shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the injection button <b>210</b> is separate from the grip <b>205</b> which is used to dial the dosage. The dial sleeve <b>70</b> and injection button <b>210</b> are located partially inside the grip <b>205</b>. The grip <b>205</b> and dial sleeve <b>70</b> may be considered functionally as elements of the same component. Indeed, the grip <b>205</b> and dial sleeve <b>70</b> may only be separate components for assembly reasons. Aside from the differences described herein, the device <b>2</b> shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref> operates in substantially the same way as the device <b>1</b> shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>.</p><p id="p-0094" num="0093">Similarly to the device <b>1</b>, the dial sleeve <b>70</b>, grip <b>205</b> and injection button <b>210</b> extend helically from the device <b>2</b>. During a dose-dialling mode of operation (as shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref>) there is no relative rotation between the injection button <b>210</b> and the dial sleeve <b>70</b>. The dose is dialled by rotating the grip <b>205</b> (thereby also rotating the dial sleeve <b>70</b> and injection button <b>210</b>) with respect to the rest of the device <b>2</b>.</p><p id="p-0095" num="0094">To initiate dispensing of a medicament, the injection button <b>210</b> is pressed axially, as shown in <figref idref="DRAWINGS">FIGS. <b>3</b>A and <b>3</b>B</figref>. This action changes the mode of the device <b>2</b> to a dispensing mode. In dispensing mode the dial sleeve <b>70</b> and grip component <b>205</b> retract along a helical path into the rest of the device <b>2</b>, whereas the injection button <b>210</b> does not rotate and only retracts with axial motion. Thereby, in dispensing mode, there is a disengagement of the injection button <b>210</b> leading to relative rotation of the injection button <b>210</b> with respect to the dial sleeve <b>70</b>. This disengagement of the injection button <b>210</b> with respect to the dial sleeve <b>70</b> is caused by a clutch arrangement described in more detail in relation to <figref idref="DRAWINGS">FIGS. <b>8</b>A-C</figref>.</p><p id="p-0096" num="0095"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a close-up cross sectional view of the proximal end of the device <b>2</b> shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref> after the injection button <b>210</b> has been pressed. As shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>, the injection button <b>210</b> is configured as two separate sub-components, namely a distal or lower button part <b>210</b><i>a </i>and a proximal or upper button part <b>210</b><i>b. </i>The injection button <b>210</b> may be configured in this way to aid the assembly process. The distal button part <b>210</b><i>a </i>and proximal button part <b>210</b><i>b </i>may be fixed together and act functionally as a single component, i.e. the injection button <b>210</b>.</p><p id="p-0097" num="0096">A sensor arrangement <b>215</b> comprising one or more optical sensors is mounted in the injection button <b>210</b> which is configured to sense the relative rotational position of the dial sleeve <b>70</b> relative to the injection button <b>210</b>. This relative rotation can be equated to the size of the dose dispensed and used for the purpose of generating and storing or displaying dose history information. The sensor arrangement <b>215</b> may comprise a primary (optical) sensor <b>215</b><i>a </i>and a secondary (optical) sensor <b>215</b><i>b. </i>In <figref idref="DRAWINGS">FIG. <b>4</b></figref>, only the secondary sensor <b>215</b><i>b </i>is shown.</p><p id="p-0098" num="0097"><figref idref="DRAWINGS">FIGS. <b>5</b> and <b>6</b></figref> show an encoder system <b>500</b> according to certain embodiments. The encoder system is configured for use with the device <b>2</b> described above. As shown in <figref idref="DRAWINGS">FIG. <b>5</b></figref> and <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the primary sensor <b>215</b><i>a </i>and secondary sensor <b>215</b><i>b </i>are configured to target specially adapted regions at the proximal end of the dial sleeve <b>70</b>. In this embodiment, the primary sensor <b>215</b><i>a </i>and secondary sensor <b>215</b><i>b </i>are infrared (IR) reflective sensors. Therefore, the specially adapted proximal regions of the dial sleeve <b>70</b> are divided into a reflective area <b>70</b><i>a </i>and a non-reflective (or absorbent) area <b>70</b><i>b. </i>The part of the dial sleeve <b>70</b> comprising the reflective area <b>70</b><i>a </i>and a non-reflective (or absorbent) area <b>70</b><i>b </i>may be termed an encoder ring.</p><p id="p-0099" num="0098">To keep production costs to a minimum, it may be favourable to form these areas <b>70</b><i>a, </i><b>70</b><i>b </i>from injection moulded polymer. In the case of polymer materials, the absorbency and reflectivity could be controlled with additives, for example carbon black for absorbency and titanium oxide for reflectivity. Alternative implementations are possible whereby the absorbent regions are moulded polymer material and the reflective regions are made from metal (either an additional metal component, or selective metallisation of segments of the polymer dial sleeve <b>70</b>).</p><p id="p-0100" num="0099">Having two sensors facilitates a power management technique described below. The primary sensor <b>215</b><i>a </i>is arranged to target a series of alternating reflective regions <b>70</b><i>a </i>and non-reflective regions <b>70</b><i>b </i>at a frequency commensurate with the resolution required for the dose history requirements applicable to a particular drug or dosing regimen, for example, 1 IU. The secondary sensor <b>215</b><i>b </i>is arranged to target a series of alternating reflective regions <b>70</b><i>a </i>and non-reflective regions <b>70</b><i>b </i>at a reduced frequency compared to the primary sensor <b>215</b><i>a. </i>It should be understood that the encoder system <b>500</b> could function with only a primary sensor <b>215</b><i>a </i>to measure the dispensed dose. The secondary sensor <b>215</b><i>b </i>facilitates the power management technique described below.</p><p id="p-0101" num="0100">The two sets of encoded regions <b>70</b><i>a, </i><b>70</b><i>b </i>are shown in <figref idref="DRAWINGS">FIGS. <b>5</b> and <b>6</b></figref> concentrically with one external and the other internal. However, any suitable arrangement of the two encoded regions <b>70</b><i>a, </i><b>70</b><i>b </i>is possible. Whilst the regions <b>70</b><i>a, </i><b>70</b><i>b </i>are shown as castellated regions, it should be borne in mind that other shapes and configurations are possible.</p><p id="p-0102" num="0101">The devices <b>1</b>, <b>2</b> also include a controller <b>700</b>, as shown schematically in <figref idref="DRAWINGS">FIG. <b>7</b></figref>. The controller <b>700</b> comprises a processor arrangement <b>23</b> including one or more processors, such as a microprocessor, a Digital Signal Processor (DSP), Application Specific Integrated Circuit (ASIC), Field Programmable Gate Array (FPGA) or the like, together with memory units <b>24</b>, <b>25</b>, including program memory <b>24</b> and main memory <b>25</b>, which can store software for execution by the processor arrangement <b>23</b>.</p><p id="p-0103" num="0102">The controller <b>700</b> controls a sensor arrangement <b>215</b>, comprising one or more sensors <b>215</b><i>a, </i><b>215</b><i>b, </i>is provided.</p><p id="p-0104" num="0103">An output <b>27</b> is provided, which may be a wireless communications interface for communicating with another device via a wireless network such as Wi-Fi or Bluetooth&#xae;, or an interface for a wired communications link, such as a socket for receiving a Universal Series Bus (USB), mini-USB or micro-USB connector. For example, data may be output to a data collection device attached to the device <b>1</b>, <b>2</b>.</p><p id="p-0105" num="0104">A power switch <b>28</b> is also provided, together with a battery <b>29</b>.</p><p id="p-0106" num="0105">Power Management</p><p id="p-0107" num="0106">It is advantageous to be able to minimise the power usage of the encoder system <b>500</b> so that the size of a battery <b>29</b> needed to be packaged into the device <b>1</b>, <b>2</b> can be minimised. The sensors <b>215</b><i>a, </i><b>215</b><i>b </i>used in this embodiment require a certain amount of power to operate. This embodiment is arranged such that the sensors <b>215</b><i>a, </i><b>215</b><i>b </i>can be switched on and off intermittently at a controlled frequency (i.e. in a strobe-sampling mode). There is inherently a limit to the maximum rotational speed that can be counted by a sampled encoder system before aliasing occurs. Aliasing is the phenomenon where the sampling rate is less than the rate at which sensed regions pass the sensor which means that a miscount could occur when a region change is missed. The secondary sensor <b>215</b><i>b </i>with a reduced frequency compared to the primary frequency <b>215</b><i>a </i>can tolerate a higher rotational speed before it too becomes aliased. Whilst the secondary sensor <b>215</b><i>b </i>is not able to resolve the dose dispensed to the same resolution as the primary sensor <b>215</b><i>a, </i>the output of the secondary sensor <b>215</b><i>b </i>remains reliable at higher speeds. Therefore both sensors <b>215</b><i>a, </i><b>215</b><i>b </i>are used in combination to be able to accurately determine dose delivered up to a first threshold rotational (dispensing) speed. The sensors <b>215</b><i>a, </i><b>215</b><i>b </i>can then be used to determine an approximate dose delivered up to a second (higher) threshold dosing speed. At speeds above the second threshold speed the sensors <b>215</b><i>a, </i><b>215</b><i>b </i>will not be able to accurately or approximately determine the dose delivered, therefore the second threshold is set above a speed which is not physically possible in the injection device <b>1</b>, <b>2</b>.</p><p id="p-0108" num="0107">The first speed threshold is determined by the sampling rate of primary sensor <b>215</b><i>a </i>and the frequency of encoder region transitions, which is fixed at the resolution required by the intended drug or dosing regimen (for example one transition per 1 IU). The second speed threshold is determined by the sampling rate of the secondary sensor <b>215</b><i>b </i>and the frequency of encoder region transitions. The first threshold is set such that the largest range of dispensing speeds can be covered by the system for accurate reporting of dose dispensed.</p><p id="p-0109" num="0108">The example embodiment shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref> has primary sensor <b>215</b><i>a </i>targeting region transitions at 1 transition per 1 IU of dose delivered and the secondary sensor <b>215</b><i>b </i>targeting region transitions at 1 transition per 6 IU of dose delivered. Other options are possible which include 1 transition per 2 IU, 1 transition per 4 IU, 1 transition per 8 IU and 1 transition per IU units. These options are each possible because there are 24 separate regions <b>70</b><i>a, </i><b>70</b><i>b </i>per revolution in the encoder system <b>500</b> shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>. In general, if the number of separate regions <b>70</b><i>a, </i><b>70</b><i>b </i>per revolution were n units then there would be options at one region transition per m units where m was any integer factor of n greater than 1 and less than n.</p><p id="p-0110" num="0109">The slower the sampling frequency of both sensors <b>215</b><i>a, </i><b>215</b><i>b, </i>the lower the power consumption required and therefore the smaller the required size of the battery <b>29</b>. It is therefore optimal to minimise, by design, the sampling frequency as far as is practical.</p><p id="p-0111" num="0110">Trigger Switch Arrangement</p><p id="p-0112" num="0111">In order to further limit the battery capacity requirement, it is advantageous to be able to have the device <b>2</b> in a low power state when the sensors <b>215</b><i>a, </i><b>215</b><i>b </i>are not required to be energised. This is achieved with a switch activated by the displacement of the injection button <b>210</b>.</p><p id="p-0113" num="0112">As shown in <figref idref="DRAWINGS">FIG. <b>8</b>A</figref>, a switch <b>800</b> is mounted in the injection button <b>210</b>. In the configuration shown in <figref idref="DRAWINGS">FIG. <b>8</b>A</figref>, an arm of the switch <b>800</b> is deflected by the dial sleeve <b>70</b> so that the switch <b>800</b> is in an open state. In this configuration a clutch between a clutch component and the dial sleeve <b>70</b> is engaged with the device <b>2</b> in its dialling mode. As the injection button <b>210</b> is pressed the injection button <b>210</b> is displaced axially with respect to the dial sleeve <b>70</b>, therefore the switch <b>800</b> is displaced axially relative to the dial sleeve <b>70</b>. This displacement causes a part on the dial sleeve <b>70</b> to ride down a cam surface on the switch <b>800</b>, allowing the switch arm to deflect towards its free state. This deflection in the switch arm has the effect of changing the electrical state of the switch <b>800</b> (for example to electrically closed). The design is arranged such that the electrical change of state of the switch <b>800</b> happens before the state change in the clutch between the clutch component and dial sleeve <b>70</b>. <figref idref="DRAWINGS">FIG. <b>8</b>B</figref> shows the transition point of the clutch and shows that the switch <b>800</b> has already changed state. <figref idref="DRAWINGS">FIG. <b>8</b>C</figref> shows the state of the device <b>2</b> with the injection button <b>210</b> fully pressed. In this condition, the clutch is fully separated allowing the clutch component and dial sleeve <b>70</b> to rotate relative to each other in the dispense mode.</p><p id="p-0114" num="0113">This sequence operates in reverse when the injection button <b>210</b> is released.</p><p id="p-0115" num="0114">The change in electrical state that occurs when the injection button <b>210</b> is pressed thereby allowing the device <b>2</b> to be powered down into a low energy consumption state when the injection button <b>210</b> is not pressed. Relative rotation between the injection button <b>210</b> and dial sleeve <b>70</b> is not possible, therefore the encoder system <b>500</b> is not required in this state.</p><p id="p-0116" num="0115">It is possible for the mechanical configuration between the dial sleeve <b>70</b> and the switch <b>800</b> to operate in the opposite sense such that the arm of the switch <b>800</b> is deflected during dispensing rather than during dialling.</p><p id="p-0117" num="0116">The following embodiments relate to an alternative sensing technique to determine the number of medicament units that have been dispensed from the device <b>1</b>, <b>2</b>.</p><p id="p-0118" num="0117">As with the embodiments described above, two sensors <b>215</b> are mounted in the injection button <b>210</b> and are configured to sense the relative rotational position of the dial sleeve <b>70</b> relative to the injection button <b>210</b> during the dispensing of a dose. This relative rotation can be equated to the size of the dose dispensed and used for the purpose of generating and storing or displaying dose history information.</p><p id="p-0119" num="0118">As shown in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, the two sensors <b>215</b> from this embodiment are configured to target specially adapted regions <b>70</b><i>a, </i><b>70</b><i>b </i>of the dial sleeve <b>70</b>. In this embodiment IR reflective sensors are used, therefore the regions of the dial sleeve <b>70</b> are divided into reflective and absorbent segments <b>70</b><i>a, </i><b>70</b><i>b. </i>The segments <b>70</b><i>a, </i><b>70</b><i>b </i>may also be referred to herein as flags.</p><p id="p-0120" num="0119">Unlike the encoder system <b>500</b> described above in relation to <figref idref="DRAWINGS">FIGS. <b>5</b> and <b>6</b></figref>, the encoder system <b>900</b> shown in <figref idref="DRAWINGS">FIGS. <b>9</b> and <b>10</b></figref> has both IR sensors <b>215</b> target the same type of region <b>70</b><i>a, </i><b>70</b><i>b. </i>In other words, the sensors <b>215</b> are arranged so that they both face reflective regions <b>70</b><i>a </i>or both face absorbent regions <b>70</b><i>b </i>at the same time. During the dispensing of a dose, the dial sleeve <b>70</b> rotates anti-clockwise 15&#xb0; relative to the injection button <b>210</b> for every medicament unit that has been dispensed. The alternate flag elements are in 30&#xb0; (or two unit) sections. The sensors <b>215</b> are arranged to be out of phase with each other, such that the angle between them equates to an odd number of units (e.g. 15&#xb0;, 45&#xb0;, 75&#xb0;, etc.), as shown in <figref idref="DRAWINGS">FIG. <b>10</b></figref>.</p><p id="p-0121" num="0120">The encoder system <b>900</b> shown in <figref idref="DRAWINGS">FIG. <b>10</b></figref> has <b>12</b> units per revolution, i.e. <b>12</b> alternating regions <b>70</b><i>a, </i><b>70</b><i>b. </i>In general, embodiments work with any multiple of <b>4</b> units per revolution. The angle, &#x3b1;, between sensors <b>215</b> can be expressed by Equation 1, where both m and n are any integers and there are 4 m units dispensed per revolution.</p><p id="p-0122" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mi>&#x3b1;</mi>     <mo>=</mo>     <mrow>      <mrow>       <mo>(</mo>       <mrow>        <mrow>         <mn>2</mn>         <mo>&#x2062;</mo>         <mi>n</mi>        </mrow>        <mo>-</mo>        <mn>1</mn>       </mrow>       <mo>)</mo>      </mrow>      <mo>&#x2062;</mo>      <mfrac>       <mn>360</mn>       <mrow>        <mn>4</mn>        <mo>&#x2062;</mo>        <mi>m</mi>       </mrow>      </mfrac>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mi>Angle</mi>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mi>between</mi>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mi>sensors</mi>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mn>1</mn>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0123" num="0121"><figref idref="DRAWINGS">FIG. <b>11</b></figref> shows how the outputs for a Sensor A and Sensor B change as the dial sleeve <b>70</b> rotates anti-clockwise during dispensing of a medicament.</p><p id="p-0124" num="0122">In combination, the two sensors A, B produce a 2-bit Gray code output (11, 01, 00, 10). The 2-bit code sequence repeats every four units dispensed. This coded output facilitates the detection of positive (anticlockwise) and negative (clockwise) rotations. For example, when the sensors read &#x2018;11&#x2019; a change to &#x2018;01&#x2019; would be a positive rotation and the change to &#x2018;10&#x2019; would be a negative rotation. This directionally sensitive system has advantages over a purely incremental system, in the ability to accurately determine true dispensed dose volume in the cases where negative rotations can occur. For example, in mechanisms that over rotate at the end of dose stop before &#x2018;backing-off&#x2019; when the user releases the injection button <b>210</b>. Referring to <figref idref="DRAWINGS">FIG. <b>12</b></figref>, the IR sensors <b>215</b> emit IR light from an LED. The IR reflective regions <b>70</b><i>a </i>of the encoder system <b>900</b> reflect the light and the sensors detect the reflected light. The sensors <b>215</b> then convert the detected light to an electrical output. The strength of the IR light that is detected by the sensor <b>215</b> after reflecting off the encoder ring is proportional to the proximity of the sensor to the encoder ring. Therefore it is desirable for the sensor <b>215</b> to be as radially close to the encoder ring as possible without contacting the encoder ring, which would add frictional losses to the dispense mechanism.</p><p id="p-0125" num="0123">Referring to <figref idref="DRAWINGS">FIG. <b>13</b></figref>, the IR absorbent regions <b>70</b><i>b </i>of the dial sleeve <b>70</b> do not completely absorb all the IR light emitted from the sensor <b>215</b>. Testing shows that when the sensor <b>215</b> is aligned with the absorbent regions <b>70</b><i>b </i>of the dial sleeve <b>70</b> the sensors <b>215</b> have some electrical output due to the low level of IR light reflected by the dial sleeve <b>70</b>. Therefore, the dial sleeve flags have been designed to maximise the distance between the sensor <b>215</b> and any reflective parts of the encoder ring. This ensures a high contrast ratio and signal sharpness.</p><p id="p-0126" num="0124">As a dose is dispensed, the software of the device <b>1</b>, <b>2</b> monitors the electrical output of the sensors <b>215</b>. The software detects changes between high and low outputs to determine when the relative rotation between the dial sleeve <b>70</b> and injection button <b>210</b> has reached an additional 15&#xb0; (i.e. an additional one unit has been dispensed). Therefore it is beneficial to the function of the device for the contrast ratio between the high and low outputs to be as large as possible.</p><p id="p-0127" num="0125">According to various embodiments, the design of the dial sleeve <b>70</b> and encoder ring flags <b>70</b><i>a, </i><b>70</b><i>b </i>has been developed to increase the contrast ratio. The design shown in <figref idref="DRAWINGS">FIG. <b>14</b></figref> has the absorbent dial sleeve flags <b>70</b><i>b </i>removed to leave gaps <b>140</b> between adjacent encoder ring flags <b>70</b><i>a. </i>This maximises the distance between the sensor <b>215</b> and any material which could reflect any of the IR light emitted from the sensor.</p><p id="p-0128" num="0126">This design increases the contrast ratio between the low and high sensor electrical outputs. However, as <figref idref="DRAWINGS">FIG. <b>15</b>A</figref> shows, the IR light emitted by the sensor <b>215</b> is not a beam, such that as the dial sleeve <b>70</b> rotates between a reflective encoder ring flag <b>70</b><i>a </i>and a gap <b>140</b>, there is overlap where the sensor <b>215</b> detects some of the light emitted by the sensor <b>215</b>. During this period, the sensor output gradually decreases from high to low, rather than an immediate step change between high and low. This gradual decrease is more difficult for the software to determine as a 15&#xb0; rotation (i.e. one medicament unit dispensed), than an immediate step change.</p><p id="p-0129" num="0127">This phenomenon occurs with various embodiments of the encoder flags (as shown in <figref idref="DRAWINGS">FIG. <b>9</b></figref> and <figref idref="DRAWINGS">FIG. <b>14</b></figref>). However, as shown in <figref idref="DRAWINGS">FIG. <b>15</b>B</figref>, in accordance with certain embodiments, the rotation of the dial sleeve <b>70</b> that is required before the sensor output completely switches to a low output is increased due to the visibility of the sides of the reflective encoder ring flags <b>70</b><i>a. </i></p><p id="p-0130" num="0128">Therefore, it is advantageous to reduce the thickness at the edges of the IR reflective flags <b>70</b><i>a </i>on the encoder ring. <figref idref="DRAWINGS">FIG. <b>16</b></figref> and <figref idref="DRAWINGS">FIG. <b>17</b></figref> show two possible embodiments to reduce the thickness at the lateral edges of the IR reflective flags <b>70</b><i>a </i>on the encoder ring so that the reflective surfaces are inclined inwardly for preventing or reducing scattered reflection, thereby enhancing contrast transition and signal sharpness.</p><p id="p-0131" num="0129"><figref idref="DRAWINGS">FIG. <b>16</b></figref> shows an embodiment where the moulded polymer encoder ring has been replaced with a formed metal ring <b>160</b>.</p><p id="p-0132" num="0130"><figref idref="DRAWINGS">FIG. <b>17</b></figref> shows an embodiment where the moulded polymer encoder ring has been replaced by sections of the dial sleeve <b>70</b> that have been printed, painted or coated with IR reflective material.</p><p id="p-0133" num="0131"><figref idref="DRAWINGS">FIGS. <b>18</b>A and <b>18</b>B</figref> illustrate two alternative modes of operation in accordance with various embodiments. Referring to <figref idref="DRAWINGS">FIG. <b>18</b>A</figref>, Sensor I and Sensor II are provided having an angular offset (&#x3b4;) is half of the periodicity (&#x3d5;) of the encoded regions of the encoder ring. In this embodiment, the sensors are operated to sample synchronously, i.e. at the same times (t<sub>1</sub>, t<sub>2</sub>, t<sub>3</sub>, . . . ).</p><p id="p-0134" num="0132"><figref idref="DRAWINGS">FIG. <b>18</b>A</figref> illustrates an embodiment where the angular offset (&#x3b4;) differs from half of the feature periodicity (&#x3d5;/2) and the sensors are operated in a staggered mode with an offset in time (&#x394;t) between samplings. This may be used to achieve more balanced overall system LED power consumption than available in synchronous operation.</p><p id="p-0135" num="0133">In the configuration shown in <figref idref="DRAWINGS">FIG. <b>18</b>B</figref>, the amount of the angular offset (&#x3b4;) may be decreased below half of the feature periodicity (&#x3d5;) in order to compensate for the relative angular travel during the offset in time (&#x394;t) between the sampling operations of the different sensors.</p><p id="p-0136" num="0134">The offset in time (&#x394;t) may be adjusted according to an estimated value for the relative rotational speed (&#x3c9;) of the encoder ring which may be calculated from the sensor measurements. In particular, the offset time (&#x394;t) may be decreased when an increase in rotational speed (&#x3c9;) is determined.</p><p id="p-0137" num="0135"><figref idref="DRAWINGS">FIG. <b>19</b>A</figref> shows scope traces obtained by embodiments of the disclosure. The lower trace is the LED driving signal and the upper trace is the output from the current mirror before the Schmitt trigger.</p><p id="p-0138" num="0136"><figref idref="DRAWINGS">FIG. <b>19</b>B</figref> is a zoomed-in view of the scope traces shown in <figref idref="DRAWINGS">FIG. <b>19</b>A</figref>. Results show that it is possible to sample at 256 ps with a nearly 12-to-1 duty cycle (meaning the average current is &#xbd;<sup>th </sup>of the 4 mA LED drive, thereby saving power and cell capacity. This is equivalent to a sample rate of over 3900 Hz and with one unit per segment and a minimum of two samples per segment a detection speed in excess of 1950 units per second is achieved without violating the Nyquist criterion. As such, no anti-aliasing detector is required.</p><p id="p-0139" num="0137"><figref idref="DRAWINGS">FIGS. <b>20</b>A</figref>, B and C shows an embodiment of a method for varying the strobe of an LED of the sensors with the currently detected angular velocity. The highest trace in <figref idref="DRAWINGS">FIGS. <b>20</b>A</figref>, B and C represent the LED strobe, the lowest trace the acceleration of the sensors. The middle traces represent the signals generated by the sensors.</p><p id="p-0140" num="0138">The strobe frequency of the LED may be kept at a low value as long as there is no change at the optical sensors and it can be assumed that the drive is at a standstill (angular velocity is zero).</p><p id="p-0141" num="0139">With the first change of state at a sensor (the angular velocity is increased), the scanning frequency may be increased in order to detect the beginning rotation with sufficient accuracy. Furthermore, the frequency can be increased with increasing angular velocity in the manner of a tracking system, as shown in the lowest trace. In particular, this tracking can be set up in such a way that a loss in the resolution of the light barrier is sufficiently counteracted. Furthermore, the resolution at a detected angular velocity can particularly be set so high that even with the maximum acceleration of the drive to be considered, a sufficiently fast readjustment of the scanning frequency is possible.</p><p id="p-0142" num="0140">Due to the acceleration, the signals of the sensors are not quite 90&#xb0; symmetrical (as shown by the two middle traces in <figref idref="DRAWINGS">FIGS. <b>20</b>A</figref>, B and C). As soon as the sensor rotates at a constant angular speed, the signals are exactly 90&#xb0; offset.</p><p id="p-0143" num="0141">In <figref idref="DRAWINGS">FIGS. <b>20</b>A</figref>, B and C, it can be seen how with increasing angular velocity the illumination created by the LED strobe receives an ever higher scanning frequency in order to adjust the density, or duty factor, of the strobing along the time for always providing sufficient resolution in view of the actual motion state of the rotor.</p><p id="p-0144" num="0142">The four timelines provided in each of <figref idref="DRAWINGS">FIGS. <b>20</b>A</figref>, B and C may help illustrating some exemplary embodiments for a method of an adaptive adjustment of the strobe frequency in accordance to the detected momentary angular velocity for achieving a trading-of between power saving and reliability in detection.</p><p id="p-0145" num="0143">Here, for the sake of simplification it shall be assumed that the encoder illumination strobe is synchronous in the meaning of assuming both detectors being powered to produce light flashes of essentially the same length at essentially the same points in time. These strobe flashes are illustrated by the white gaps in the uppermost timeline denoted &#x201c;LED Strobe&#x201d;. The black regions in between can be understood as the time intervals without any illumination on either sensor. Apparently, the mean power required for the sensor illumination corresponds to the number of strobes per time unit because of the constant strobe duration. In the exemplary situation of the exemplary strobe timeline in <figref idref="DRAWINGS">FIG. <b>20</b>A</figref>, the increase in time density of the strobes from left to right therefore translates into a proportional increase in illumination power consumption. This increase, however, allows the sensors to correctly determine the operational state and velocity of the encoder rotor during phases of acceleration as will be explained subsequently.</p><p id="p-0146" num="0144">In order to facilitate the understanding of the rotational kinematics of the mechanism coupled to the encoder rotor, the momentary angular velocity of the encoder rotor is provided in the lowermost timeline in each of <figref idref="DRAWINGS">FIGS. <b>20</b>A</figref>, B and C, denoted by &#x201c;Angular Velocity&#x201d;. Again, for the sake of simplification in all three situations an acceleration model with piecewise linear behaviour has been chosen. In particular, it shall be assumed that the mechanism undergoes, after a short initial time at rest, a linear increase in angular speed, in the way of a constant acceleration and, after a more elongated time interval denoted &#x201c;Acceleration&#x201d;, reaches a maximum rotational speed for the final time in consideration. This can be understood as a first order approximation to the dynamics of the mechanism under the assumption of a constant force being applied by the user for actuation. Due to the linear response of the conversion mechanism, a constant force will translate into a constant torque that can serve for acting against frictional effects in the baseline and for accelerating the mechanism. Additionally, as another simplification, it is assumed that the rotational speed will not increase beyond a maximum value whereat the overall frictional loss equals to the input torque. This is to reflect the fluid friction characteristic of the liquid expelling which, in a first approximation, monotonically increases with the flow rate of expelling. In the simplified model, the equilibrium is approached on a linear ramp as shown in the lowermost graph even though a more realistic modelling might rely on an asymptotic approaching to the maximum rotational speed. This, however, would not introduce a qualitative difference in view of the adaptive strobe sensor operation which shall be explained here.</p><p id="p-0147" num="0145">Even though strobing based sensor operation has may yield some advantages in view of power consumption it suffers some systematic limitation when it comes to higher rotational speed or higher angular velocity. This can be understood more easily when looking at the second and third timelines where the continuous sensor intensity pattern in front of the respective optical sensor is illustrated. Here, &#x201c;continuous intensity pattern&#x201d; shall be understood as the intensity pattern the respective optical detector would detect under a fully continuous illumination without any gaps or interruptions over time. The effective detector reading, however, results from applying an &#x201c;AND&#x201d; operation to the value in the &#x201c;LED Strobe&#x201d; timeline and the respective &#x201c;continuous intensity pattern&#x201d; of the respective sensor. In a direct clue it can be derived, that in a situation wherein the strobes pulses match with either the darker or lighter areas in the &#x201c;continuous intensity pattern&#x201d; for a respective sensor in fixed phase relation, no change in the sensor reading will be observed and the signals might erroneously be interpreted by the processor towards a stationary angular position of the rotor. This may be considered as a worst case scenario wherein no valid information can be derived from the sensor signals at all in view of the rotational state. Apparently, there are other scenarios wherein only some information is lost in view of rotational transitions in one or another sensor. This can be imagined similar to a Moire effect produced by the overlay of the strobe pulses and the moving brightness patterns.</p><p id="p-0148" num="0146">Keeping this in mind, the timelines in <figref idref="DRAWINGS">FIGS. <b>20</b>A</figref>, B and C may provide an example on how a generally more adequate scheme of increasing the strobe density along the time in response to a change in the rotational state of the rotor can help avoiding or at least reducing wrong sensor readings. A closer look to the &#x201c;AND&#x201d; between the first timeline and the second respective third timeline on the other hand indicates that a limited anticipatory increase in strobe density over time may already sufficiently address the issue when the mechanisms rotational acceleration can be assumed remaining below a known threshold value and/or when the maximum in angular velocity of the rotor can be assumed to remain below a known threshold value. As explained before these assumptions are fulfilled in a typical injection pen use case scenario wherein the accelerating torque is derived by mechanical conversion of the linear force a user applies to an actuation member, e.g. the dial extension.</p><p id="p-0149" num="0147">In view of this, a rather simple and easy to implement scheme for the adaption of the strobe density over time can be seen in a digital switching between a first, lower density value and a second, higher density value. Variants thereof are illustrated in <figref idref="DRAWINGS">FIGS. <b>20</b>B</figref>/C. Both are designed for switching from the first value to the second value would be performed upon detection of the earliest transition from the stationary to the non-stationary situation and for switching back upon detection of a stationary state for a pre-determined amount of time. Clearly, the determination of whether a stationary state or a non-stationary state is reached has to be made on the basis of the sensor readings and some care has to be applied to avoid artefacts as explained before.</p><p id="p-0150" num="0148">Specific variants on this general switching approach are illustrated in <figref idref="DRAWINGS">FIGS. <b>20</b>B and <b>20</b>C</figref>, respective. In particular, <figref idref="DRAWINGS">FIG. <b>20</b>B</figref> provides an exemplary timeline for a &#x201c;LED Strobe&#x201d; density which is, directly after a transition in any of the sensors has been read, switched to the higher value and is maintained on this value until a pre-determined short time interval has lapsed without a further detection of a transition on the sensor readings. Apparently, this control scheme may result in toggling between the lower and higher value in phases of low angular speed of the rotor. <figref idref="DRAWINGS">FIG. <b>20</b>C</figref>, in contrast, shows a &#x201c;LED Strobe&#x201d; that switches to the higher density value after the angular velocity value derived from the sensor readings exceeds a predetermined threshold value. This scheme would be completed by switching back to the lower value when the same threshold value or an even lower one is undershot by the calculated speed.</p><p id="p-0151" num="0149">The appropriate selection of the specific values for the lower density and the higher density of the &#x201c;LED Strobe&#x201d; may find a starting point in the following considerations. Assuming the rotor to be in a stationary state, the first value has to be chosen to provide for sufficient density in order to capture the first transition in the &#x201c;continuous intensity pattern&#x201d; at either sensor and to allow switching of the strobe density to the higher value before the next transition passes in front of either sensor. Here, the critical value can be seen in the maximum in acceleration of the mechanism. Accommodation for higher acceleration requires more density in strobes at the stationary state and therefore needs an increase in the first, lower value. The critical condition for the second, higher value can be seen in the maximum speed. As explained before, the strobe density must be sufficiently not to produce any kind of artefacts. This very simple digital upwards/downwards switching may already provide significant increase in power efficiency for certain use cases wherein, after activation of the sensor operation, the delay in time before the mechanism transitions from a stationary state into a non-stationary state is not predictable and/or the time while the mechanism remains in the stationary state is significantly longer than the time while the mechanism is in the non-stationary state. Unpredictability, for example, may result from user behaviour. If, as a more specific example, the overall operation of the sensors is triggered in the way of a wake-up upon detection of a dose setting event or a cap removal event the delay in time until a subsequent expelling operation is started may depend on the time the respective user needs to place the needle and to start the expelling operation.</p><p id="p-0152" num="0150">Other approaches for determining the increase or decrease in strobe density over time in order to accommodate for a change in the rotational state and/or velocity of the mechanism can be figured out on different levels of elaboration.</p><p id="p-0153" num="0151">Additionally, in a situation with a staggered sampling mode wherein the strobing on the respective sensor has a shift in phase as, for example, explained with reference to <figref idref="DRAWINGS">FIG. <b>18</b>B</figref>, an adaption of the shift in phase between the two sensors may be included. Insofar, the target might be seen in maintaining the phase shift in the &#x201c;AND&#x201d; reading as mentioned above between the angularly offset sensors on a constant value, e.g. 90&#xb0;, independent of the momentary angular speed. The 90&#xb0; situation would result in an overall detector behaviour identical to the one with exactly 90&#xb0; offset sensors and synchronous sampling but apart of the need for powering all light sources at the same time.</p><p id="p-0154" num="0152">Further variants to the outlined embodiment may include approaches for limiting the need of powering the LED strobing to only one of the two or more sensor. Apparently, at any point in the timeline of <figref idref="DRAWINGS">FIGS. <b>20</b>A</figref>, B and C, from the two available sensor readings it can be determined whether the next transition will appear at either &#x201c;Sensor I&#x201d; or &#x201c;Sensor II&#x201d; because of the fixed spatial relationship of the sensors. In particular, for all points on the timeline with identical sensor readings, namely &#x201c;dark&#x201d;/&#x201c;dark&#x201d; and &#x201c;bright&#x201d;/&#x201c;bright&#x201d;, the subsequent transition will appear in the timeline of &#x201c;Sensor II&#x201d;. The same is correct for all points in time where &#x201c;dark&#x201d; would be read on the timeline of &#x201c;Sensor I&#x201d; while &#x201c;bright&#x201d; would be read on the timeline of &#x201c;Sensor II&#x201d;. Only for time points where &#x201c;bright&#x201d; would be read from &#x201c;Sensor I&#x201d; whereas &#x201c;dark&#x201d; would be read from &#x201c;Sensor II&#x201d; the next transition can be predicted to appear in the timeline of &#x201c;Sensor I&#x201d;. By applying this scheme, the power consumption for the strobe of the sensors could be further reduced at least in the stationary state of the mechanism.</p><p id="p-0155" num="0153">An encoder system according to further embodiments will now be described with reference to <figref idref="DRAWINGS">FIGS. <b>21</b> to <b>29</b></figref>. This encoder system may be used to record doses that are delivered from the injection device. The concept of this encoder system is based on a light guidance used to convey the status of an indicator flag to a reflective sensor, which is located physically remote to the flag. The embodiments shown in <figref idref="DRAWINGS">FIGS. <b>20</b> to <b>28</b></figref> are illustrated with an optical add-on module for an injection device, where the indicator flag is formed by a relative rotation of a number or the dial sleeve and the injection button, the latter of which houses an optical sensor. Such an add-on module may be configured to be added to a suitably configured pen injection device for the purpose of recording doses that are dialed and delivered from the device. This functionality may be of value to a wide variety of device users as a memory aid or to support detailed logging of dose history. The module may be configured to be connectable to a mobile device such as a smartphone or a tablet PC, or similar, to enable the dose history to be downloaded from the module on a periodic basis. However, the concept of the encoder system is also applicable to any device with the indicator flag and sensor separation, for example the injection device <b>1</b> of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, wherein the module may be implemented in the dosage knob <b>12</b>.</p><p id="p-0156" num="0154">According to the encoder system concept, a collimating optics is arranged between the active face of at least one optical sensor, which may be a IR reflective sensor, and a movable dosage programming component. The collimating optics may comprise one or more discrete collimating lenses and one or more light pipes. The lens geometry may be selected to parallelize (&#x201c;collimate&#x201d;) divergent radiation emitted by the at least one optical sensor prior to transmission through the light pipe between the at least one sensor and the target, namely the indicator flag.</p><p id="p-0157" num="0155"><figref idref="DRAWINGS">FIG. <b>21</b></figref> shows essential parts of an embodiment of a module <b>1000</b> implementing this encoder concept: an indicator flag <b>1008</b> may be formed by relative rotation of a number sleeve <b>1006</b> around a rotation axis <b>1010</b>, wherein the indicator flag <b>1008</b> is implemented in the shown embodiment by radially projecting teeth, formed in the top of for example the number sleeve or the dial sleeve <b>70</b> of the injection device <b>1</b>; an optical sensor <b>215</b><i>c </i>and collimating optics comprising two collimating lenses <b>1004</b><i>a, </i><b>1004</b><i>b </i>and a light guidance in the form of a light pipe <b>1002</b> for conveying the status of the indicator flag <b>1008</b> to the sensor <b>215</b><i>c </i>which is located remote from the flag. The collimating optics <b>1002</b>, <b>1004</b><i>a, </i><b>1004</b><i>b </i>and the optical sensor <b>215</b><i>c </i>may be positioned relative to surrounding components within the injection device and particularly associated to an add-on module. As can be seen, the collimating optics comprising the lenses <b>1004</b><i>a, </i><b>1004</b> and the light pipe <b>1002</b> are arranged between the active side, i.e. the IR emitting and receiving side of the optical sensor <b>215</b><i>c </i>and the indicator flag <b>1008</b> formed by the number sleeve <b>1006</b>.</p><p id="p-0158" num="0156"><figref idref="DRAWINGS">FIG. <b>22</b></figref> shows a chassis <b>1012</b> housing two optical sensors <b>215</b><i>c </i>(represented by their locations in the chassis <b>1012</b> shown by the rectangles with bold lines) and their respective collimating lenses <b>1004</b><i>a, </i><b>1004</b><i>b </i>according to an embodiment of a module <b>1000</b>. The collimating lenses <b>1004</b><i>a, </i><b>1004</b><i>b, </i>here implemented by discrete lenses, are envisaged to be held relative to the optical sensors <b>2015</b><i>c </i>and proximal face of the light pipes by means of a cradle or other locating geometry existing as a feature within the chassis <b>1012</b>.</p><p id="p-0159" num="0157"><figref idref="DRAWINGS">FIG. <b>23</b></figref> shows the light pipe <b>1002</b> and the guidance of radiation (represented by the dotted arrows) within the light pipe <b>1002</b>. The sensor <b>215</b><i>c </i>is arranged in front of the distal end of the light pipe <b>1002</b>, and the target surface, i.e. the indicator flag <b>1008</b>, in front of the pipe's proximal end. The diameter of the light pipe reduces from the distal to the proximal end so that the light pipe <b>1002</b> has the shape of a frustum. Particularly, the light pipe <b>1002</b> may have a circular or an elliptic cross section. The light pipe <b>1002</b> helps to better guide radiation emitted by the sensor <b>215</b><i>c </i>to the remote target face or indicator flag <b>1008</b>, respectively, and radiation reflected from the indicator flag <b>1008</b> back to the receiving part of the sensor <b>215</b><i>c. </i>Thus, the signal received by the sensor viewing a reflective surface (the number sleeve) via the light pipe may be improved, which results in a better signal quality due to the improvement in response of the optical sensor as a result of a greater incident flux on the receiver of the optical sensor, which is particularly during normal operation as it may increase the voltage output of the optical sensor and a higher voltage output may be more easily detectable.</p><p id="p-0160" num="0158"><figref idref="DRAWINGS">FIG. <b>24</b></figref> shows in picture (b) the effect of discrete collimating lenses <b>1004</b><i>a </i>and <b>1004</b><i>b </i>arranged between the distal end of the light pipe <b>1002</b> and the sensor <b>215</b><i>c. </i>Divergent radiation emitted by an active part of the sensor <b>215</b><i>c </i>is collimated with the collimating lens <b>1004</b><i>a </i>before transmission through the light pipe <b>1002</b> to the indicator flag <b>1008</b> representing the target surface. The radiation reflected by the indicator flag <b>1008</b> back into the light pipe <b>1002</b> is guided to the collimator lens <b>1004</b><i>b </i>which collimates the received radiation before it is received by the receiving part of the sensor <b>215</b><i>c. </i>The collimating lens <b>1004</b><i>a </i>particularly serves to collimate the radiation of a divergent light source such as in LED (Light Emitting Diode) of the sensor <b>215</b><i>c, </i>as shown in the left picture (a) of <figref idref="DRAWINGS">FIG. <b>24</b></figref>. It is envisaged that the collimating lenses <b>1004</b><i>a, </i><b>1004</b><i>b </i>may be made of an optically transparent material, such as glass or polycarbonate, particularly with a good infrared transmissivity in the wavelength range of the optical sensor <b>215</b><i>c. </i>To minimize any impact to an increased length of the module comprising the collimating optics and the sensor, it is anticipated that the collimating lenses of the collimating optics should take the form of lenses featuring aspheric, or non-constant-curvature surfaces, which permit a collimating effect to be achieved in a smaller form factor optic, as exemplarily shown by the lens in picture (a) of <figref idref="DRAWINGS">FIG. <b>24</b></figref>. Particularly, the detection of a binary state of a number sleeve target during a &#x201c;mode shift&#x201d;, i.e. when the dose or injection button of an injection device is being depressed from its relaxed state into its OU position, can be improved with the collimating lenses. In this case, differentiation between a binary &#x2018;0&#x2019; and &#x2018;1&#x2019; as detected by the optical sensor can be readily obtained for a large, for example &#x2dc;0.5 millimeters, separation between the distal ends of the light pipes and the number sleeve, with components undergoing relative rotation. Incorporation of the collimating lenses may reduce the divergent effect of the aforementioned gap, facilitating disambiguation between a &#x2018;0&#x2019; and a &#x2018;1&#x2019; as reported by the optical sensor. Another advantage of the use of the collimating lenses is the possible reduction of &#x201c;cross-talk&#x201d; (light leakage) between neighbored sensor where the outputs from such sensors are sharing the same optically contiguous light pipe chassis.</p><p id="p-0161" num="0159">All of the above points relate, fundamentally, to more robust encoding mechanical system where an optical (reflective) sensor form the active element in an optical encoder. If the motion of the number sleeve relative to the dose button is more efficiently captured, reduced emitter power of an optical sensor and the use of algorithms requiring fewer microcontroller operations can be utilized, reducing energy consumption and extending battery life. The encoder system described above and in the following with reference to <figref idref="DRAWINGS">FIGS. <b>20</b> to <b>28</b></figref> is equally applicable to inclusion in a disposable or a re-usable injection device, or any device containing an optical encoder arrangement with a similar light pipe architecture.</p><p id="p-0162" num="0160">The collimating optics may be implemented as individual, discreet components distinct from an injection moulded light pipe chassis. <figref idref="DRAWINGS">FIG. <b>25</b></figref> shows a further embodiment of a chassis <b>1012</b> comprising a separate injection moulded component <b>1014</b> fixed in the chassis <b>1012</b>, which is provided as holder for all elements of the collimating optics, namely the collimating lenses <b>1004</b><i>a, </i><b>1004</b><i>b, </i>and the light pipes <b>1002</b>. The component <b>1014</b> with the attached collimating lenses <b>1004</b><i>a, </i><b>1004</b><i>b </i>and separated from the chassis <b>1012</b> is shown in <figref idref="DRAWINGS">FIG. <b>26</b></figref>.</p><p id="p-0163" num="0161">Alternatively, the collimating lenses geometry can also be formed directly by part of a tool <b>1016</b> provided for creating the light pipe chasses <b>1012</b>, as shown with the embodiment of <figref idref="DRAWINGS">FIG. <b>27</b></figref>. In this case, the lower portion of the lens geometry may be limited to hemispheres owing to the tool action, while the proximal surfaces can be formed as full (a)spheres. <figref idref="DRAWINGS">FIG. <b>28</b></figref> shows the integral injection moulded chassis <b>1012</b> comprising also light pipes <b>1002</b>.</p><p id="p-0164" num="0162">The embodiments described above use two discrete collimating lenses <b>1004</b><i>a, </i><b>1004</b><i>b </i>covering, individually, the transmitting and the receiving portions of the optical sensor, particularly, the optical infrared reflective sensor. However, also other embodiments are possible, as will be described with reference to <figref idref="DRAWINGS">FIG. <b>29</b></figref> in the following: for example, picture (a) shows an embodiment with a PCB (Printed Circuit Board) mounted, micro-moulded lens array <b>1004</b><i>a </i>covering the sensor <b>215</b><i>c; </i>another example is shown in picture (b), where a single collimating lens <b>1004</b><i>a </i>is provided, which covers both the transmitting and receiving portions of the optical sensor <b>215</b><i>c; </i>further embodiments with a single collimating lens are shown in pictures (c) and (d): the embodiment of picture (c) uses a single collimating lens <b>1004</b><i>b </i>covering the receiving portion of the optical sensor <b>215</b><i>c, </i>and the embodiment of picture (d) uses a single collimating lens <b>1004</b><i>a </i>placed at the distal end of the light pipe <b>1002</b>.</p><p id="p-0165" num="0163">Next, embodiments of algorithms for processing the signals, particularly signal voltages, generated by the optical sensors of sensor arrangements as described above with regard to the injection device and the module are described. The algorithms are implemented as computer programs for execution by one or more processors, for example of the processor arrangement <b>23</b> comprised by the controller <b>700</b> as shown in <figref idref="DRAWINGS">FIG. <b>7</b></figref>.</p><p id="p-0166" num="0164">The algorithms are implemented for processing the signals delivered by the one or more optical sensors <b>215</b><i>a, </i><b>215</b><i>b, </i><b>215</b><i>c, </i>namely for decoding the selected for delivery by or delivered by an injection device. The algorithms are particularly applicable to the module described above with reference to <figref idref="DRAWINGS">FIGS. <b>20</b> to <b>28</b></figref> but is also applicable to the injection device described above with reference to <figref idref="DRAWINGS">FIGS. <b>1</b> to <b>19</b>B</figref>. The algorithms are preferably applicable to devices with an indicator flag and sensor separation with light pipes such as the module as described above.</p><p id="p-0167" num="0165">The relative rotation between the dose button and the number sleeve may be encoded optically using an incremental encoder, for example a quadrature encoder, with two or more optical sensors, particularly reflective IR sensors, looking axially at castellations or radially projecting teeth, formed on the top surface of the number sleeve. The encoder system may be implemented as an add-on module as described above with reference to <figref idref="DRAWINGS">FIGS. <b>20</b> to <b>28</b></figref>, which means that the position of the castellations or teeth being detected may vary relative to the positions of the optical sensors from device to device. Additionally, while the dose button is being depressed and released, the axial position of the optical sensors may also vary relative to the castellations.</p><p id="p-0168" num="0166">The algorithms described in the following may be implemented in an injection device or an add-on module particularly for the purpose of recording doses that are delivered from the injection device. This functionality may be of value to a wide variety of injection device users as a memory aid or to support detailed logging of dose history. It is envisaged that the electronics implementing the algorithms may be configured to be connectable to a mobile device such as a smartphone, or similar, to enable the dose history to be downloaded from the electronics on a periodic basis.</p><p id="p-0169" num="0167">The algorithms are configured for detecting the relative rotation of castellations or teeth on a number sleeve relative to a non-rotating component such as the dose button. The presence or otherwise of a castellation or tooth feature provides a binary code, which may be used to count the number of units dispensed from the injection device. The voltage output of the optical sensors may be typically approximated to a sinusoid. The algorithms are able to detect the presence or otherwise of a castellation or tooth feature across all devices, which may have any combination of geometrical tolerances on the physical features.</p><p id="p-0170" num="0168">Additionally, as the dose button moves axially towards or away from the castellation or tooth features at the beginning and end of dose ejection, the change in the signal generated by the optical sensor should not be incorrectly interpreted as a rotation of the castellation or tooth features. Therefore, the algorithms may accommodate significant amplitude modulation of the signal generated by the optical sensor.</p><p id="p-0171" num="0169"><figref idref="DRAWINGS">FIG. <b>30</b></figref> shows the typical course of the signal voltages generated by two optical sensors, which may have a different gain profile to each other. The signal voltages are amplitude modulated. The different gain profiles may lead to significantly different signal voltages being generated by the two optical sensors and sent to a processor for processing the signal voltages. The different gain profiles may be for example due to tolerances associated with electronic components.</p><p id="p-0172" num="0170">All of the algorithms pertain to a system with two optical sensors being arranged with a 180&#xb0; phase shift so that the signal voltages generated by both sensors are anti-phase.</p><p id="p-0173" num="0171">A first embodiment of an algorithm applies static thresholding: the algorithm sets a high threshold and a low threshold for the signal voltage of the first sensor and for the signal voltage of the second sensor, respectively; a unit of a dose selected with a movable dosage programming component is then counted if the signal voltage of the second sensor passes the high threshold and thereafter passes the low threshold, followed by the signal voltage of the first sensor passing the low threshold and thereafter passing the high threshold. During manufacture, a set of calibration geometry may be passed beneath each sensor at controlled distances to define the high and low thresholds. The thresholds are set for life such that the high threshold is always below the largest signal voltage observed during calibration (typically at minimum distance of substrate to sensor) and the low threshold is always below the smallest signal voltage observed during calibration (typically at maximum distance of substrate to sensor). The set thresholds for signal voltage of the first sensor and of the second sensor are shown in <figref idref="DRAWINGS">FIG. <b>31</b></figref>, which represents the course of the signal voltages of the first and second sensor. The unit counting is represented by the arrows.</p><p id="p-0174" num="0172">A second embodiment of an algorithm applies dynamic thresholding: also this algorithm sets a high threshold and a low threshold for the signal voltage of the first sensor and for the signal voltage of the second sensor, respectively; a unit of a dose selected with a movable dosage programming component is then counted if the signal voltage of the second sensor passes the high threshold and thereafter passes the low threshold, followed by the signal voltage of the first sensor passing the low threshold and thereafter passing the high threshold. The thresholds may with this algorithm determined during the first few units delivered from each dose. As a dose is delivered, a sampling frequency for sampling the signal voltages of both sensors is set to a level higher than a sampling frequency used for normal operation and the signal voltages are sampled with the higher sampling frequency during delivery of a dose. Then, the magnitudes of at least two consecutive peak-throughs of the signal voltages of each sensor are determined with a peak-detection algorithm. If the determined magnitudes of at least two consecutive peak-throughs are within a predetermined tolerance signal range, for example a factory-set voltage tolerance, the high threshold and the low threshold for each signal voltage are then defined based upon a percentage of the measured peak and through signal voltage values or the determined magnitudes of at least two consecutive peak-throughs. This dynamic thresholding is undertaken for both sensors. Once the thresholds have been set, the sampling rate or frequency is reduced to a lower level typically used for normal operation, as peak detection is no longer required. This reduces power consumption of the algorithm. <figref idref="DRAWINGS">FIG. <b>32</b></figref> demonstrates the dynamic thresholding by means of the course of the signal voltages of the first and second sensor.</p><p id="p-0175" num="0173">A third embodiment of an algorithm does not rely on the setting of thresholds to detect low-high transitions, but rather counts a unit at the point when the voltage from the second sensor becomes greater than the voltage from the first sensor by a defined amount, i.e. the crossover point between the two sensor voltage signals. A unit is counted after the signals of the two optical sensors cross over in one direction, and subsequent units cannot be counted until the signals have crossed over at least once in the opposite direction. This effectively creates a flip-flop latch system. The signals may not deem to have &#x201c;crossed over&#x201d; until the difference between the signals, particularly the voltage difference between them exceeds a threshold value, which may be set during manufacture. For application of this algorithm, the signals from the two sensors should be matched in terms of mean voltage and mean amplitude. Since the signals from the two sensors are typically not matched in terms of mean voltage and voltage amplitude, as shown by the course of the two sensor signals in <figref idref="DRAWINGS">FIG. <b>33</b></figref>, they should be matched by scaling. As such, during manufacture, a set of calibration geometry is passed beneath each sensor at controlled distance and scaling factors for mean and amplitude are applied to the second sensor to match the mean and amplitude of its signal to the mean and amplitude of the signal of the first sensor. Once, the signals are scaled, the flip-flop dose counting algorithm can be used to count doses, as illustrated in <figref idref="DRAWINGS">FIG. <b>34</b></figref>.</p><p id="p-0176" num="0174">A fourth embodiment of an algorithm is essentially identical to the third embodiment except that the scaling factors defined to give a common mean and amplitude for the two sensor signals may be calculated after each dose, removing the requirement to &#x201c;factory set&#x201d; these parameters during manufacture. In order to achieve this, the whole dataset for the signals of both sensors is stored, for example buffered in a memory, and the scaling factors are retrospectively calculated from the stored dataset in order to obtain a common mean and amplitude between the signals of both sensors. Once the scaling factors have been applied, this algorithm is deployed as before such that a unit is counted after the signals cross over in one direction, and subsequent units cannot be counted until the signals have crossed over at least once in the opposite direction.</p><p id="p-0177" num="0175">A fifth embodiment of an algorithm does not rely on the setting of thresholds to detect low-high transitions, or the scaling of signals to match mean and amplitude, but rather uses a low power peak-detect method. A high sampling rate is not required, as the exact voltage value of the peak is not required, just the detection that a peak has occurred, i.e. a point of inflection on the voltage signal of a sensor. A flip-flop latch system may be employed as in other algorithms described herein in that a unit is counted when a peak is registered on the signal from the first sensor of two sensors, but subsequent units cannot be counted until at least one peak has been observed on the signal of the second sensor. This is illustrated in <figref idref="DRAWINGS">FIG. <b>35</b></figref>. This algorithm does not require scaling or factory setting of thresholds, which makes it robust to coping with tolerance variations and amplitude variations in use. It is also expected to be low power due to low computational complexity and the potential for a low power sampling rate than alternative algorithms.</p><p id="p-0178" num="0176">The above described algorithms may permit low sampling frequencies and minimum computational complexity, while accommodating device-to-device tolerance variations, and in-use signal amplitude variations driven by a variable axial position of the sensor relative to a rotating number sleeve, particularly teeth or castellations of the sleeve.</p><p id="p-0179" num="0177">A yet further embodiment of an injection device comprising a rotary encoder system <b>1100</b> having a predefined angular periodicity and an encoder ring or wheel <b>1102</b> is shown in <figref idref="DRAWINGS">FIG. <b>36</b></figref>. This embodiment can be used as counter for rotations, particularly for dose selection with an injection pen. The encoder ring <b>1102</b> may be arranged within an injection button <b>1104</b> of an injection device.</p><p id="p-0180" num="0178">The encoder ring <b>1102</b> comprises a plurality of light reflectors arranged circumferentially around the encoder ring <b>1102</b> with a predefined periodicity. The light reflectors are arranged on the axial face side of the encoder ring so that light directed towards the light reflectors in an axial direction of the rotary encoder system <b>1100</b> may be received and reflected. Each light reflector comprises two reflecting surfaces <b>1106</b> arranged perpendicular to each other. Thus, incident light <b>1108</b> may be reflected from one reflecting surface to the other reflecting surface and from the other reflecting surface back to the source of the incident light by means of a total internal reflection (TIR) as shown in the right picture of <figref idref="DRAWINGS">FIG. <b>36</b></figref>.</p><p id="p-0181" num="0179">At least the part of the encoder ring <b>1102</b> may be made of a transparent material, and the reflecting surfaces <b>1106</b> may be high-polished in order to reflect an amount of incident light back, which may generate a signal amplitude suitable for further processing.</p><p id="p-0182" num="0180">A LED <b>1112</b> may be used as light source and two photodiodes <b>1114</b> for detecting the reflected light. The LED <b>1112</b> and the photodiodes <b>1114</b> may be arranged on a PCB <b>1116</b> of an electronic module for the injection device, which may also comprise electronic for controlling the light emission by the LED <b>1112</b> and process the output signals of the photodiodes <b>1114</b> in order to detect a rotation of either the PCB <b>1116</b> or the encoder ring <b>1102</b>.</p><p id="p-0183" num="0181">A housing <b>1118</b> may be provided for the PCB <b>1116</b>, for example when the electronics is comprised by an add-on device for an injection pen. In order to allow a passing of light through the housing <b>1118</b> it may comprise an integrated lens <b>1120</b> for passing through the light emitted by the LED <b>1112</b> and lenses <b>1122</b> arranged before the photodiodes <b>1114</b> for letting reflected light pass through to the photodiodes <b>1114</b>. The lens <b>1120</b> may be adapted to focus the light beams emitted by the LED <b>1112</b> on the reflecting surfaces <b>1106</b> of the light reflectors, and the lenses <b>1122</b> may be adapted to focus the light reflected back from the surfaces <b>1106</b> on light sensitive areas of the photodiodes <b>1114</b>.</p><p id="p-0184" num="0182">The button <b>1104</b> may comprise a window <b>1124</b> being made from a light transparent material and apertures <b>1126</b> for light emitted by the LED <b>1112</b> and reflected back from the surface <b>1106</b> to the photodiodes <b>1114</b>. The light emitting and returning path is split by the TIR of the reflecting surfaces <b>1106</b> on the apertures <b>1126</b>, which are placed side by side.</p><p id="p-0185" num="0183">Simulations of the above described encoder concept have shown a good optical system performance with a relatively high peak irradiance, as shown in <figref idref="DRAWINGS">FIG. <b>37</b></figref>, which represents the power of two typical output signals of the photodiodes <b>1114</b>. Also, the simulations have shown a relatively high signal-to-noise ratio, and, thus, showing a robust behaviour.</p><p id="p-0186" num="0184">While the embodiments above have been described in relation to collecting data from an insulin injector pen, it is noted that embodiments of the disclosure may be used for other purposes, such as monitoring of injections of other medicaments.</p><p id="p-0187" num="0185">The terms &#x201c;drug&#x201d; or &#x201c;medicament&#x201d; are used synonymously herein and describe a pharmaceutical formulation containing one or more active pharmaceutical ingredients or pharmaceutically acceptable salts or solvates thereof, and optionally a pharmaceutically acceptable carrier. An active pharmaceutical ingredient (&#x201c;API&#x201d;), in the broadest terms, is a chemical structure that has a biological effect on humans or animals. In pharmacology, a drug or medicament is used in the treatment, cure, prevention, or diagnosis of disease or used to otherwise enhance physical or mental well-being. A drug or medicament may be used for a limited duration, or on a regular basis for chronic disorders.</p><p id="p-0188" num="0186">As described below, a drug or medicament can include at least one API, or combinations thereof, in various types of formulations, for the treatment of one or more diseases. Examples of API may include small molecules having a molecular weight of 500 Da or less; polypeptides, peptides and proteins (e.g., hormones, growth factors, antibodies, antibody fragments, and enzymes); carbohydrates and polysaccharides; and nucleic acids, double or single stranded DNA (including naked and cDNA), RNA, antisense nucleic acids such as antisense DNA and RNA, small interfering RNA (siRNA), ribozymes, genes, and oligonucleotides. Nucleic acids may be incorporated into molecular delivery systems such as vectors, plasmids, or liposomes. Mixtures of one or more drugs are also contemplated.</p><p id="p-0189" num="0187">The drug or medicament may be contained in a primary package or &#x201c;drug container&#x201d; adapted for use with a drug delivery device. The drug container may be, e.g., a cartridge, syringe, reservoir, or other solid or flexible vessel configured to provide a suitable chamber for storage (e.g., short- or long-term storage) of one or more drugs. For example, in some instances, the chamber may be designed to store a drug for at least one day (e.g., 1 to at least 30 days). In some instances, the chamber may be designed to store a drug for about 1 month to about 2 years. Storage may occur at room temperature (e.g., about 20&#xb0; C.), or refrigerated temperatures (e.g., from about &#x2212;4&#xb0; C. to about 4&#xb0; C.). In some instances, the drug container may be or may include a dual-chamber cartridge configured to store two or more components of the pharmaceutical formulation to-be-administered (e.g., an API and a diluent, or two different drugs) separately, one in each chamber. In such instances, the two chambers of the dual-chamber cartridge may be configured to allow mixing between the two or more components prior to and/or during dispensing into the human or animal body. For example, the two chambers may be configured such that they are in fluid communication with each other (e.g., by way of a conduit between the two chambers) and allow mixing of the two components when desired by a user prior to dispensing. Alternatively or in addition, the two chambers may be configured to allow mixing as the components are being dispensed into the human or animal body.</p><p id="p-0190" num="0188">The drugs or medicaments contained in the drug delivery devices as described herein can be used for the treatment and/or prophylaxis of many different types of medical disorders. Examples of disorders include, e.g., diabetes mellitus or complications associated with diabetes mellitus such as diabetic retinopathy, thromboembolism disorders such as deep vein or pulmonary thromboembolism. Further examples of disorders are acute coronary syndrome (ACS), angina, myocardial infarction, cancer, macular degeneration, inflammation, hay fever, atherosclerosis and/or rheumatoid arthritis. Examples of APIs and drugs are those as described in handbooks such as Rote Liste 2014, for example, without limitation, main groups 12 (anti-diabetic drugs) or 86 (oncology drugs), and Merck Index, 15th edition.</p><p id="p-0191" num="0189">Examples of APIs for the treatment and/or prophylaxis of type 1 or type 2 diabetes mellitus or complications associated with type 1 or type 2 diabetes mellitus include an insulin, e.g., human insulin, or a human insulin analogue or derivative, a glucagon-like peptide (GLP-1), GLP-1 analogues or GLP-1 receptor agonists, or an analogue or derivative thereof, a dipeptidyl peptidase-4 (DPP4) inhibitor, or a pharmaceutically acceptable salt or solvate thereof, or any mixture thereof. As used herein, the terms &#x201c;analogue&#x201d; and &#x201c;derivative&#x201d; refers to a polypeptide which has a molecular structure which formally can be derived from the structure of a naturally occurring peptide, for example that of human insulin, by deleting and/or exchanging at least one amino acid residue occurring in the naturally occurring peptide and/or by adding at least one amino acid residue. The added and/or exchanged amino acid residue can either be codable amino acid residues or other naturally occurring residues or purely synthetic amino acid residues. Insulin analogues are also referred to as &#x201c;insulin receptor ligands&#x201d;. In particular, the term &#x201c;derivative&#x201d; refers to a polypeptide which has a molecular structure which formally can be derived from the structure of a naturally occurring peptide, for example that of human insulin, in which one or more organic substituent (e.g. a fatty acid) is bound to one or more of the amino acids. Optionally, one or more amino acids occurring in the naturally occurring peptide may have been deleted and/or replaced by other amino acids, including non-codeable amino acids, or amino acids, including non-codeable, have been added to the naturally occurring peptide.</p><p id="p-0192" num="0190">Examples of insulin analogues are Gly(A21), Arg(B31), Arg(B32) human insulin (insulin glargine); Lys(B3), Glu(B29) human insulin (insulin glulisine); Lys(B28), Pro(B29) human insulin (insulin lispro); Asp(B28) human insulin (insulin aspart); human insulin, wherein proline in position B28 is replaced by Asp, Lys, Leu, Val or Ala and wherein in position B29 Lys may be replaced by Pro; Ala(B26) human insulin; Des(B28-B30) human insulin; Des(B27) human insulin and Des(B30) human insulin.</p><p id="p-0193" num="0191">Examples of insulin derivatives are, for example, B29-N-myristoyl-des(B30) human insulin, Lys(B29) (N-tetradecanoyl)-des(B30) human insulin (insulin detemir, Levemir&#xae;); B29-N-pal-mitoyl-des(B30) human insulin; B29-N-myristoyl human insulin; B29-N-palmitoyl human insulin; B28-N-myristoyl LysB28ProB29 human insulin; B28-N-palmitoyl-LysB28ProB29 human insulin; B30-N-myristoyl-ThrB29LysB30 human insulin; B30-N-palmitoyl-ThrB29LysB30 human insulin; B29-N-(N-palmitoyl-gamma-glutamyl)-des(B30) human insulin, B29-N-omega-carboxypentade-canoyl-gamma-L-glutamyl-des(B30) human insulin (insulin degludec, Tresiba&#xae;); B29-N-(N-lithocholyl-gamma-glutamyl)-des(B30) human insulin; B29-N-(w-carboxyheptadecanoyl)-des(B30) human insulin and B29-N-(w-carboxyheptadecanoyl) human insulin.</p><p id="p-0194" num="0192">Examples of GLP-1, GLP-1 analogues and GLP-1 receptor agonists are, for example, Lixisenatide (Lyxumia&#xae;), Exenatide (Exendin-4, Byetta&#xae;, Bydureon&#xae;, a 39 amino acid peptide which is produced by the salivary glands of the Gila monster), Liraglutide (Victoza&#xae;), Semaglutide, Taspoglutide, Albiglutide (Syncria&#xae;), Dulaglutide (Trulicity&#xae;), rExendin-4, CJC-1134-PC, PB-1023, TTP-054, Langlenatide/HM-11260C, CM-3, GLP-1 Eligen, ORMD-0901, NN-9924, NN-9926, NN-9927, Nodexen, Viador-GLP-1, CVX-096, ZYOG-1, ZYD-1, GSK-2374697, DA-3091, MAR-701, MAR709, ZP-2929, ZP-3022, TT-401, BHM-034. MOD-6030, CAM-2036, DA-15864, ARI-2651, ARI-2255, Exenatide-XTEN and Glucagon-Xten.</p><p id="p-0195" num="0193">An examples of an oligonucleotide is, for example: mipomersen sodium (Kynamro&#xae;), a cholesterol-reducing antisense therapeutic for the treatment of familial hypercholesterolemia. Examples of DPP4 inhibitors are Vildagliptin, Sitagliptin, Denagliptin, Saxagliptin, Berberine. Examples of hormones include hypophysis hormones or hypothalamus hormones or regulatory active peptides and their antagonists, such as Gonadotropine (Follitropin, Lutropin, Choriongonadotropin, Menotropin), Somatropine (Somatropin), Desmopressin, Terlipressin, Gonadorelin, Triptorelin, Leuprorelin, Buserelin, Nafarelin, and Goserelin.</p><p id="p-0196" num="0194">Examples of polysaccharides include a glucosaminoglycane, a hyaluronic acid, a heparin, a low molecular weight heparin or an ultra-low molecular weight heparin or a derivative thereof, or a sulphated polysaccharide, e.g. a poly-sulphated form of the above-mentioned polysaccharides, and/or a pharmaceutically acceptable salt thereof. An example of a pharmaceutically acceptable salt of a poly-sulphated low molecular weight heparin is enoxaparin sodium. An example of a hyaluronic acid derivative is Hylan G-F 20 (Synvisc&#xae;), a sodium hyaluronate.</p><p id="p-0197" num="0195">The term &#x201c;antibody&#x201d;, as used herein, refers to an immunoglobulin molecule or an antigen-binding portion thereof. Examples of antigen-binding portions of immunoglobulin molecules include F(ab) and F(ab&#x2032;)2 fragments, which retain the ability to bind antigen. The antibody can be polyclonal, monoclonal, recombinant, chimeric, de-immunized or humanized, fully human, non-human, (e.g., murine), or single chain antibody. In some embodiments, the antibody has effector function and can fix complement. In some embodiments, the antibody has reduced or no ability to bind an Fc receptor. For example, the antibody can be an isotype or subtype, an antibody fragment or mutant, which does not support binding to an Fc receptor, e.g., it has a mutagenized or deleted Fc receptor binding region. The term antibody also includes an antigen-binding molecule based on tetravalent bispecific tandem immunoglobulins (TBTI) and/or a dual variable region antibody-like binding protein having cross-over binding region orientation (CODV).</p><p id="p-0198" num="0196">The terms &#x201c;fragment&#x201d; or &#x201c;antibody fragment&#x201d; refer to a polypeptide derived from an antibody polypeptide molecule (e.g., an antibody heavy and/or light chain polypeptide) that does not comprise a full-length antibody polypeptide, but that still comprises at least a portion of a full-length antibody polypeptide that is capable of binding to an antigen. Antibody fragments can comprise a cleaved portion of a full length antibody polypeptide, although the term is not limited to such cleaved fragments. Antibody fragments that are useful in the present disclosure include, for example, Fab fragments, F(ab&#x2032;)2 fragments, scFv (single-chain Fv) fragments, linear antibodies, monospecific or multispecific antibody fragments such as bispecific, trispecific, tetraspecific and multispecific antibodies (e.g., diabodies, triabodies, tetrabodies), monovalent or multivalent antibody fragments such as bivalent, trivalent, tetravalent and multivalent antibodies, minibodies, chelating recombinant antibodies, tribodies or bibodies, intrabodies, nanobodies, small modular immunopharmaceuticals (SMIP), binding-domain immunoglobulin fusion proteins, camelized antibodies, and VHH containing antibodies. Additional examples of antigen-binding antibody fragments are known in the art.</p><p id="p-0199" num="0197">The terms &#x201c;Complementarity-determining region&#x201d; or &#x201c;CDR&#x201d; refer to short polypeptide sequences within the variable region of both heavy and light chain polypeptides that are primarily responsible for mediating specific antigen recognition. The term &#x201c;framework region&#x201d; refers to amino acid sequences within the variable region of both heavy and light chain polypeptides that are not CDR sequences, and are primarily responsible for maintaining correct positioning of the CDR sequences to permit antigen binding. Although the framework regions themselves typically do not directly participate in antigen binding, as is known in the art, certain residues within the framework regions of certain antibodies can directly participate in antigen binding or can affect the ability of one or more amino acids in CDRs to interact with antigen. Examples of antibodies are anti PCSK-9 mAb (e.g., Alirocumab), anti IL-6 mAb (e.g., Sarilumab), and anti IL-4 mAb (e.g., Dupilumab).</p><p id="p-0200" num="0198">Pharmaceutically acceptable salts of any API described herein are also contemplated for use in a drug or medicament in a drug delivery device. Pharmaceutically acceptable salts are for example acid addition salts and basic salts.</p><p id="p-0201" num="0199">Those of skill in the art will understand that modifications (additions and/or removals) of various components of the APIs, formulations, apparatuses, methods, systems and embodiments described herein may be made without departing from the full scope and spirit of the present disclosure, which encompass such modifications and any and all equivalents thereof.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001" nb-file="US20230001096A1-20230105-M00001.NB"><img id="EMI-M00001" he="5.67mm" wi="76.20mm" file="US20230001096A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A module configured to be used with or applied to an injection device, the module comprising a sensor arrangement comprising:<claim-text>a first optical sensor configured to detect a movement of a movable dosage programming component comprising a rotary encoder system having a predefined angular periodicity relative to the sensor arrangement during dosing of a medicament, wherein the first optical sensor is configured to operate in a strobe-sampling mode along a first time series of strobe pulses, and</claim-text><claim-text>a second optical sensor configured to detect a rotary encoder system movement of the rotary encoder system relative to the second optical sensor, wherein the second optical sensor is configured to operate in a strobe-sampling mode along a second time series of strobe pulses, the first time series and second time series having a pulse density per time unit or a relative pulse phase varying according to a kinematical state of a dose programming component; and<claim-text>a processor arrangement configured to, based on the movement of the movable dosage programming component or the rotary encoder system movement, determine a medicament dosage administered by the injection device.</claim-text></claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The module of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the movable dosage programming component is part of the module.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The module of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the rotary encoder system is configured to be rotatable with respect to the first optical sensor during a dialing mode of operation of the injection device.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The module of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the rotary encoder system comprises an encoder ring comprising a plurality of substantially light reflective flags arranged circumferentially around the encoder ring in accordance with the predefined angular periodicity.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The module of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the encoder ring comprises a plurality of substantially light absorbent flags arranged to alternate with the plurality of substantially light reflective flags in accordance with the predefined angular periodicity.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The module of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein lateral edges of the plurality of substantially light reflective flags are inwardly inclined.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The module of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the second optical sensor is configured to operate in a strobe-sampling mode at a second frequency lower than a first frequency.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The module of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the first and second optical sensors have an angular offset equal to half the predefined angular periodicity, and wherein the first and second optical sensors are configured to operate in a synchronous mode of operation.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The module of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the first and second optical sensors have an angular offset that differs from half the predefined angular periodicity, and wherein the first and second optical sensors are configured to operate in a staggered mode of operation with an off-set time between sampling by the first and second optical sensors.</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The module of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the angular offset is less than half the predefined angular periodicity.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The module of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the offset time is varied based on a relative rotational speed of the rotary encoder system with respect to the first and second optical sensors.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The module of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the offset time is decreased in response to an increase in the relative rotational speed.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The module of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising an injection button and an electrical switch connected to the sensor arrangement, the electrical switch arranged to supply power to the sensor arrangement in response to actuation of the injection button.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. A module configured to be used with or applied to an injection device comprising a movable dosage programming component with a rotary encoder system, the module comprising:<claim-text>a sensor arrangement comprising at least one optical sensor being configured to detect movement of the movable dosage programming component of the injection device relative to the sensor arrangement during dosing of a medicament and a collimating optics being arranged between the at least one optical sensor and the movable dosage programming component; and</claim-text><claim-text>a processor arrangement configured to, based on the movement of the movable dosage programming component, determine a medicament dosage administered by the injection device.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The module of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the collimating optics comprises one or more of:<claim-text>one or more discrete collimating lenses; and</claim-text><claim-text>one or more light pipes.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The module of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein a discrete collimating lens is arranged between each optical sensor and each light pipe, between each light pipe and the movable dosage programming component, or between each optical sensor and each light pipe and between each light pipe and the movable dosage programming component</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The module of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein a single discrete collimating lens is provided for each sensor and is configured to cover a transmitter portion of the sensor, a receiver portion of the sensor, or a transmitter and a receiver portion of the sensor, and wherein the single discrete collimating lens is a lens array covering the sensor.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. A method for processing signals generated by a sensor arrangement of a module configured to be used with or applied to an injection device, wherein the sensor arrangement comprises two optical sensors arranged at 180&#xb0; wherein a first signal of a first sensor of the two sensors and a second signal of a second sensor of the two sensors are in anti-phase, the method comprising the steps of:<claim-text>setting a high threshold and a low threshold for the first signal of the first sensor and for the second signal of the second sensor, respectively; and</claim-text><claim-text>counting a unit of a dose selected with a movable dosage programming component of the injection device or the module when the second signal of the second sensor passes the high threshold and thereafter passes the low threshold, and thereafter the first signal of the first sensor passes the low threshold and thereafter passes the high threshold.</claim-text></claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, the step of setting a high threshold and a low threshold for the first signal of the first sensor and for the second signal of the second sensor, respectively, comprises a calibration step performed during manufacturing of the module for setting the high and low thresholds, wherein the calibration step comprises:<claim-text>passing a set of calibration geometry beneath each sensor at controlled distances for calibration, and</claim-text><claim-text>setting the high and low thresholds such that the high threshold is always below a largest signal level of a respective sensor signal observed during calibration and the low threshold is always below a smallest signal level observed during calibration.</claim-text></claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, the step of setting a high threshold and a low threshold for the first signal of the first sensor and for the second signal of the second sensor, respectively, comprises the steps of:<claim-text>setting a sampling frequency for sampling signals of both sensors to a level higher than a sampling frequency used for normal operation and sampling the signals during delivery of a dose with an injection device comprising the module,</claim-text><claim-text>determining magnitudes of at least two consecutive peak-throughs of a respective signal of each sensor, and</claim-text><claim-text>setting the high threshold and the low threshold for each signal to a percentage of the magnitudes of at least two consecutive peak-throughs if the magnitudes of at least two consecutive peak-throughs are within a predetermined tolerance signal range.</claim-text></claim-text></claim></claims></us-patent-application>