<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007710A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007710</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17832976</doc-number><date>20220606</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>76</main-group><subgroup>14</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>106</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>06</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>041</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20180201</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>76</main-group><subgroup>14</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>106</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>06</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>041</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>88</main-group><subgroup>04</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">SECURITY MECHANISM FOR CONNECTION ESTABLISHMENT OVER MULTI-HOP SIDELINKS</invention-title><us-related-documents><us-provisional-application><document-id><country>US</country><doc-number>63217820</doc-number><date>20210702</date></document-id></us-provisional-application></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>MEDIATEK SINGAPORE PTE. LTD.</orgname><address><city>Singapore</city><country>SG</country></address></addressbook><residence><country>SG</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>TENNY</last-name><first-name>Nathan Edward</first-name><address><city>San Jose</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>LIN</last-name><first-name>Yuan-Chieh</first-name><address><city>Hsinchu</city><country>TW</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>CHENG</last-name><first-name>Ming-Yuan</first-name><address><city>Hsinchu</city><country>TW</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>MEDIATEK SINGAPORE PTE. LTD.</orgname><role>03</role><address><city>Singapore</city><country>SG</country></address></addressbook></assignee></assignees></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A method of a relay user equipment (UE) can include receiving, at the relay UE, from a first neighbor UE, a communication request message for establishing a connection between an initiating UE and a target UE, the communication request message including first security-establishment-related information originating from the initiating UE for establishing a security association between the initiating UE and the target UE; modifying the communication request message to add second security-establishment-related information for establishing a security association between the relay UE and a second neighbor UE; and transmitting to the second neighbor UE the modified communication request message that includes the first security-establishment-related information originating from the initiating UE for establishing the security association between the initiating UE and the target UE, and the second security-establishment-related information added by the relay UE for establishing the security association between the relay UE and the second neighbor UE.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="115.32mm" wi="158.75mm" file="US20230007710A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="213.19mm" wi="172.13mm" orientation="landscape" file="US20230007710A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="228.35mm" wi="164.25mm" orientation="landscape" file="US20230007710A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="190.08mm" wi="163.75mm" orientation="landscape" file="US20230007710A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="179.92mm" wi="161.37mm" orientation="landscape" file="US20230007710A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="186.10mm" wi="116.33mm" orientation="landscape" file="US20230007710A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="213.19mm" wi="170.52mm" orientation="landscape" file="US20230007710A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="234.61mm" wi="183.22mm" file="US20230007710A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="234.95mm" wi="183.22mm" file="US20230007710A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="72.73mm" wi="157.65mm" file="US20230007710A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="239.10mm" wi="182.20mm" file="US20230007710A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="121.16mm" wi="167.13mm" orientation="landscape" file="US20230007710A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="179.75mm" wi="170.86mm" orientation="landscape" file="US20230007710A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00013" num="00013"><img id="EMI-D00013" he="157.82mm" wi="104.22mm" orientation="landscape" file="US20230007710A1-20230105-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">INCORPORATION BY REFERENCE</heading><p id="p-0002" num="0001">This present application claims the benefit of U.S. Provisional Application No. 63/217,820, &#x201c;Discovery and Connection Establishment with Security in a Wireless Mesh Network&#x201d; filed on Jul. 2, 2021, which is incorporated herein by reference in its entirety.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">The present disclosure relates to wireless communications and specifically relates to multi-hop sidelink communications.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">The background description provided herein is for the purpose of generally presenting the context of the disclosure. Work of the presently named inventors, to the extent the work is described in this background section, as well as aspects of the description that may not otherwise qualify as prior art at the time of filing, are neither expressly nor impliedly admitted as prior art against the present disclosure.</p><p id="p-0005" num="0004">The 3rd Generation Partnership Project (3GPP) has developed sidelink techniques to support direct communications among wireless devices without traversing a mobile network. For example, a group of wireless devices may form a mesh network. Intermediary devices can relay messages between two remote peer devices using the sidelink techniques. As a result, cars, robots and even consumer gadgets could create their own ad hoc networks without using the radio access network as an intermediary.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0006" num="0005">Aspects of the disclosure provide a method of a relay user equipment (UE). The method can include receiving, at the relay UE, from a first neighbor UE, a communication request message for establishing a connection between an initiating UE and a target UE, the communication request message including first security-establishment-related information originating from the initiating UE for establishing a security association between the initiating UE and the target UE; modifying the communication request message to add second security-establishment-related information for establishing a security association between the relay UE and a second neighbor UE; and transmitting to the second neighbor UE the modified communication request message that includes the first security-establishment-related information originating from the initiating UE for establishing the security association between the initiating UE and the target UE, and the second security-establishment-related information added by the relay UE for establishing the security association between the relay UE and the second neighbor UE.</p><p id="p-0007" num="0006">In an embodiment, the first neighbor UE is the initiating UE, and the method further can further include performing an authentication based on the first security-establishment-related information originating from the initiating UE to determine a root key for communications between the first neighbor UE and the relay UE, and initiating a security mode control process based on the first security-establishment-related information originating from the initiating UE to establish a security association between the first neighbor UE and the relay UE.</p><p id="p-0008" num="0007">In an embodiment, the communication request message includes third security-establishment-related information originating from the first neighbor UE for establishing a security association between the first neighbor UE and the relay UE. The modifying can include replacing the third security-establishment-related information originating from the first neighbor UE with the second security-establishment-related information for establishing the security association between the relay UE and the second neighbor UE. In an example, the method can further include performing an authentication based on the third security-establishment-related information originating from the first neighbor UE to determine a root key for communications between the first neighbor UE and the relay UE, and initiating a security mode control process based on the third security-establishment-related information originating from the first neighbor UE to establish a security association between the first neighbor UE and the relay UE.</p><p id="p-0009" num="0008">In an embodiment, the method can further include, in response to receiving a request of a security mode control process from the second neighbor UE, initiating a security mode control process to establish a security association between the first neighbor UE and the relay UE based on one of the first security-establishment-related information originating from the initiating UE, and the third security-establishment-related information originating from the first neighbor UE and included in the communication request message.</p><p id="p-0010" num="0009">In some embodiments, the first security-establishment-related information originating from the initiating UE includes first user information of the initiating UE, a first nonce generated at the initiating UE, and a first signature covering the first user information of the initiating UE and the first nonce generated at the initiating UE, and the second security-establishment-related information added by the relay UE includes second user information of the relay UE, a second nonce generated at the relay UE, and a second signature covering the second user information of the relay UE and the second nonce generated at the relay UE.</p><p id="p-0011" num="0010">In an embodiment, the communication request message includes third security-establishment-related information originating from the first neighbor UE for establishing a security association between the first neighbor UE and the relay UE. The third security-establishment-related information originating from the first neighbor UE includes third user information of the first neighbor UE, a third nonce generated at the first neighbor UE, and a third signature covering the third user information of the first neighbor UE and the third nonce generated at the first neighbor UE. The modifying can include replacing the third nonce and the third signature covering the third user information of the first neighbor UE and the third nonce with the second nonce and the second signature covering the second user information of the relay UE and the second nonce.</p><p id="p-0012" num="0011">In an embodiment, the method can further include authenticating the first neighbor UE based on one of the first signature covering the first user information of the initiating UE and the first nonce generated at the initiating UE, and a third signature covering a third user of the first neighbor UE and a third nonce generated at the first neighbor UE.</p><p id="p-0013" num="0012">In an embodiment, the method can further include transmitting to the first neighbor UE a security mode command message that includes a root key for communications between the first neighbor UE and the relay UE, a fourth nonce generated at the relay UE for a connection between the first neighbor UE and the relay UE, and a fourth signature covering the fourth nonce generated at the relay UE for the connection between the first neighbor UE and the relay UE.</p><p id="p-0014" num="0013">In an example, the method can further include deriving a session key for the connection between the first neighbor UE and the relay UE based on the root key for communications between the first neighbor UE and the relay UE, the fourth nonce generated at the relay UE for the connection between the first neighbor UE and the relay UE, and one of the first nonce generated at the initiating UE and a third nonce generated at the first neighbor UE.</p><p id="p-0015" num="0014">In an embodiment, the method can further include receiving from the second neighbor UE a security mode command message that includes a root key for communications between the second neighbor UE and the relay UE, a fifth nonce generated at the second neighbor UE for a connection between the second neighbor UE and the relay UE, and a fifth signature covering the fifth nonce generated at the second neighbor UE for the connection between the second neighbor UE and the relay UE; and authenticating the second neighbor UE based on the fifth signature covering the fifth nonce generated at the second neighbor UE for the connection between the second neighbor UE and the relay UE. In an example, the method further include deriving a session key for the connection between the second neighbor UE and the relay UE based on the root key for communications between the second neighbor UE and the relay UE, the fifth nonce generated at the second neighbor UE for the connection between the second neighbor UE and the relay UE, and the second nonce generated at the relay UE.</p><p id="p-0016" num="0015">In an embodiment, the second neighbor UE is the target UE.</p><p id="p-0017" num="0016">Aspects of the disclosure can further provide a method of a target UE. The method can include receiving, at the target UE from a relay UE, a communication request message for establishing a connection between an initiating UE and the target UE via the relay UE, the communication request message including first security-establishment-related information initiated from the initiating UE for establishing a security association between the initiating UE and the target UE, and second security-establishment-related information originating from the relay UE for establishing a security association between the relay UE and the target UE; establishing a secure connection between the relay UE and the target UE based on the second security-establishment-related information originating from the relay UE; performing an authentication based on the first security-establishment-related information originating from the initiating UE to determine a root key for communications between the initiating UE and the target UE: and initiating a security mode control process with the initiating UE based on the first security-establishment-related information originating from the initiating UE to establish a security association between the initiating UE and the target UE, wherein a security mode control command message for the initiating UE is transmitted to the relay UE over the secure connection between the relay UE and the target UE.</p><p id="p-0018" num="0017">In an embodiment, the first security-establishment-related information originating from the initiating UE includes a first user information of the initiating UE, a first nonce generated at the initiating UE, and a first signature covering the first user information of the initiating UE and the first nonce generated at the initiating UE, and the second security-establishment-related information originating from the relay UE includes second user information of the relay UE, a second nonce generated at the relay UE, and a second signature covering the second user information of the relay UE and the second nonce generated at the relay UE.</p><p id="p-0019" num="0018">In an example, the establishing includes authenticating the relay UE based on the second signature covering the second user information of the relay UE and the second nonce generated at the relay UE: determining a root key for communications between the relay UE and the target UE; determining a session key for the secure connection between the relay UE and the target UE based on the second nonce generated at the relay UE, a third nonce generated at the target UE, and the root key: and transmitting to the relay UE a security mode control command message that includes the third nonce generated at the target UE, a third signature covering the third nonce generated at the target UE, and the root key that is encrypted.</p><p id="p-0020" num="0019">In an example, the performing the authentication includes authenticating the initiating UE based on the first signature covering the first user information of the initiating UE and the first nonce generated at the initiating UE; and determining a root key for communications between the initiating UE and the target UE.</p><p id="p-0021" num="0020">In an example, the security mode control command message for the initiating UE includes a fourth nonce generated at the target UE, a fourth signature covering the fourth nonce generated at the target UE, and the root key that is encrypted.</p><p id="p-0022" num="0021">In an example, the method further include determining a session key for a connection between the initiating UE and the target UE based on the first nonce generated at the initiating UE, the fourth nonce generated at the target UE, and the root key for communications between the initiating UE and the target UE.</p><p id="p-0023" num="0022">Aspects of the disclosure can further provide a relay UE comprising circuitry. The circuitry can be configured to receive, at the relay UE, from a first neighbor UE, a communication request message for establishing a connection between an initiating UE and a target UE, the communication request message including first security-establishment-related information originating from the initiating UE for establishing a security association between the initiating UE and the target UE; modify the communication request message to add second security-establishment-related information for establishing a security association between the relay UE and a second neighbor UE; and transmit to the second neighbor UE the modified communication request message that includes the first security-establishment-related information originating from the initiating UE for establishing the security association between the initiating UE and the target UE, and the second security-establishment-related information added by the relay UE for establishing the security association between the relay UE and the second neighbor UE.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0024" num="0023">Various embodiments of this disclosure that are proposed as examples will be described in detail with reference to the following figures, wherein like numerals reference like elements, and wherein:</p><p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows an example of a peer-to-peer process <b>100</b> for connection setup and security establishment without network involvement. <b>10025</b>J <figref idref="DRAWINGS">FIG. <b>2</b></figref> shows an example of a security establishment process <b>200</b> between UE_<b>1</b> <b>201</b> (UE <b>201</b>) and UE_<b>2</b> <b>202</b> (UE <b>202</b>) over an NR sidelink crossing a PC5 reference point.</p><p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. <b>3</b></figref> shows another example of a security establishment process <b>300</b> between UE_<b>1</b> <b>301</b> (UE <b>301</b>) and UE_<b>2</b> <b>302</b> (UE <b>302</b>) over an LTE sidelink PC5 reference point.</p><p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. <b>4</b></figref> shows an example of control-plane protocol stacks <b>400</b> for direct communications between two peer UEs, UE <b>401</b> and UE <b>402</b>.</p><p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. <b>5</b>A</figref> shows an example where UE_<b>1</b> <b>501</b> and UE_<b>2</b> <b>503</b> communicate via a relay UE, UE_R <b>502</b>.</p><p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. <b>5</b>B</figref> shows an example where a connection goes from UE_<b>1</b> <b>511</b> to UE_R<b>1</b> <b>512</b> to UE_R<b>2</b> <b>513</b> to UE_<b>2</b> <b>514</b>.</p><p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. <b>6</b></figref> shows an example of a connection setup process <b>600</b> between two peer UEs <b>601</b> and <b>603</b> communicating via a relay UE <b>602</b> according to embodiments of the disclosure.</p><p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. <b>7</b></figref> shows a message flow <b>700</b> for connection setup and security establishment in a setting with two relay UEs according to some embodiments of the disclosure.</p><p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. <b>8</b></figref> shows a message flow <b>800</b> that is a variation of the message flow <b>700</b> of <figref idref="DRAWINGS">FIG. <b>7</b></figref> according to an embodiment of the disclosure.</p><p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. <b>9</b></figref> shows the processes of forming the signatures during the connection setup and security establishment process <b>800</b> according to an embodiment of the disclosure.</p><p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. <b>10</b></figref> shows a message flow <b>1000</b> that is a variation of the message flow <b>700</b> of <figref idref="DRAWINGS">FIG. <b>7</b></figref> according to an embodiment of the disclosure.</p><p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. <b>11</b></figref> shows an example of a security establishment process <b>1100</b> according to an embodiment of the disclosure.</p><p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. <b>12</b></figref> shows another example of a security establishment process <b>1200</b> according to an embodiment of the disclosure.</p><p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. <b>13</b></figref> shows an exemplary apparatus <b>1300</b> according to embodiments of the disclosure.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION OF EMBODIMENTS</heading><p id="p-0038" num="0037">This disclosure describes methods of establishing a secured connection between two remote UEs, traversing one or more intervening relay UEs. The methods may be applied to a UE-to-UE relay environment, or more generally to a mesh network environment in which multiple UEs relay information dynamically for one another.</p><p id="p-0039" num="0038">In a peer-to-peer communication environment, a pair of communicating devices can establish a security relationship in order to communicate safely with encryption and integrity protection. This setting is different from network-based cellular communication, where the network controls the establishment of security and can distribute the security configuration (for example, key information) to any number of mobile devices. This network-based process generally depends on the existence of a shared secret between the mobile device and the subscriber's home network. In the peer-to-peer setting, it may not be known in advance what pairs of devices need to communicate; it is desirable that security can be established without depending on an a priori shared secret between the two communicating devices.</p><p id="p-0040" num="0039">For example, in 3GPP specifications for peer-to-peer communication, an &#x201c;identity-based&#x201d; key generation scheme is used, allowing the concerned UEs to develop a shared key for securing the connection between them without depending on a previously shared secret. A public-key security scheme is used, in which a first peer device (UE_<b>1</b>) computes the public key of a second peer device (UE_<b>2</b>) based on the identity of UE_<b>2</b> and a common public key associated with a key server. In other examples, authentication schemes other than the identity-based key generation scheme can be employed. The present disclosure is not limited to any specific authentication or encryption mechanisms.</p><p id="p-0041" num="0040">In a UE-to-UE relaying or mesh network environment, where two UEs (UE_<b>1</b> and UE_<b>2</b>) communicate via at least one intermediary &#x201c;relay&#x201d; UE (UE_R), there is a need to establish end-to-end security between UE_<b>1</b> and UE_<b>2</b>, such that their communication is secure against monitoring or tampering at UE_R as well as from external third parties. This disclosure is directed to methods of establishing security when a UE-to-UE connection is established with one or more intermediary relay UEs.</p><p id="p-0042" num="0041">In order to establish a secure relayed connection between two remote UEs UE_<b>1</b> and UE_<b>2</b>, traversing a relay UE UE_R<b>1</b>, key generation information can be provided for the direct connections (between UE_<b>1</b> and UE_R<b>1</b>, and between UE_R<b>1</b> and UE_<b>2</b>) and the indirect connection (between UE_<b>1</b> and UE_<b>2</b>). Furthermore, each &#x201c;hop&#x201d; in the sequence of UEs can allow mutual authentication of the participating UEs, while also preserving the needed information for end-to-end authentication between UE_<b>1</b> and UE_<b>2</b>. This disclosure describes methods of signalling at connection establishment that allow the involved UEs to generate the needed keys and perform the needed authentications.</p><p id="p-0043" num="0042">The establishment of a secure connection in the LTE or NR sidelink depends on the ability of a pair of UEs UE_<b>1</b> and UE_<b>2</b> to authenticate one another and establish a security association without any real-time involvement from the network. This restriction is because UE_<b>1</b> and UE_<b>2</b> may establish a connection with one another while out of network coverage. Of course, depending on the configuration, UEs may opt to adopt any suitable authentication and security establishment methods that do not rely on the network even when the UEs are within the network coverage.</p><p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows an example of a peer-to-peer process <b>100</b> for connection setup and security establishment without network involvement. At S<b>111</b>, UE_<b>1</b> <b>101</b> initiates the connection with a Direct Communication Request message, which may be received by multiple peer UEs: UE_<b>2</b><i>a </i><b>102</b>, UE_<b>2</b><i>b </i><b>103</b>, and UE_<b>2</b><i>c </i><b>104</b>. A peer UE with an interest in communicating with UE_<b>1</b> responds by triggering security procedures, followed by a Direct Communication Accept message that finishes the procedure to establish a connection.</p><p id="p-0045" num="0044">For example, at S<b>112</b>, UE_<b>2</b><i>a </i><b>102</b> chooses to respond to the Direct Communication Request message and may initiate a Direct Authentication (Auth) and Key Establishment procedure to generate a root key for communications between UE_<b>1</b> <b>101</b> and UE_<b>2</b><i>a </i><b>102</b>. At S<b>113</b>, UE_<b>2</b><i>a </i><b>102</b> runs a Direct Security Mode Command (or control) procedure with UE_<b>1</b> <b>101</b> to establish a security association between UE_<b>1</b> <b>101</b> and UE_<b>2</b><i>a </i><b>102</b>. At S<b>114</b>, UE_<b>2</b><i>a </i><b>102</b> sends a Direct Communication Accept message when the security association is established successfully. At S<b>115</b>, UE_<b>2</b><i>b </i><b>103</b> chooses not to respond UE_<b>1</b> <b>101</b>. From S<b>116</b> to S<b>118</b>, UE_<b>2</b><i>c </i><b>104</b> responds to UE_<b>1</b> <b>101</b> using the same sequence of procedures and messages as UE_<b>2</b><i>a </i><b>102</b>.</p><p id="p-0046" num="0045">In the process <b>100</b>, when each responder decides to activate security comprising signalling integrity protection and/or signalling confidentiality protection, each responder establishes a different security context with UE_<b>1</b> <b>101</b> that is not known to the other UEs. For example, the security context used between UE_<b>1</b> <b>101</b> and UE_<b>2</b><i>a </i><b>102</b> is not known to UE_<b>2</b><i>b </i><b>103</b> and UE_<b>2</b><i>c </i><b>104</b>. The Direct Communication Request can be sent unprotected and only contains enough security-establishment-related information for a secure connection to be established with the other UE. Other information UE_<b>1</b> <b>101</b> needs to send to the other UEs in order to establish the connection can be included in a Direct Security Mode Complete message (sent as part of the Direct Security Mode procedure) from UE_<b>1</b> <b>101</b>. The Direct Security Mode Complete message can be both confidentiality and integrity protected.</p><p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows an example of a security establishment process <b>200</b> between UE_<b>1</b> <b>201</b> (UE <b>201</b>) and UE_<b>2</b> <b>202</b> (UE <b>202</b>) over an NR sidelink crossing a PC5 reference point. The process <b>200</b> can be part of a connection setup process (such as the process <b>100</b> in the <figref idref="DRAWINGS">FIG. <b>1</b></figref> example) for establishing a secure connection between UE <b>201</b> and UE <b>202</b>.</p><p id="p-0048" num="0047">At S<b>211</b>, triggered by an event (such as an indication from an application, for example) at the UE <b>201</b>, UE <b>201</b> transmits a Direct Communication Request message (also referred to as a Direct Link Establishment Request message) to UE <b>202</b>. The message can include security-establishment-related information and possibly other parameters. For example, the security-establishment-related information can include:<ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0000">    <ul id="ul0002" list-style="none">        <li id="ul0002-0001" num="0048">the security capabilities of UE <b>201</b> indicating a list of algorithms that UE <b>201</b> supports for the security establishment of the connection;</li>        <li id="ul0002-0002" num="0049">the signalling security policy of UE <b>201</b> corresponding to the application or desired service;</li>        <li id="ul0002-0003" num="0050">a Nonce_<b>1</b>, for example, set to a 128-bit nonce value generated by UE <b>201</b> for the purpose of session key K<sub>NRP-sess</sub>, generation for the connection, where NRP stands for NR PC5 (in some embodiments, a different notation may be used; for example, the abbreviation NRP may be replaced by a D standing for Direct);</li>        <li id="ul0002-0004" num="0051">the most significant bits (MSB) (for example, 8 bits) of a K<sub>NRP-sess </sub>ID;</li>        <li id="ul0002-0005" num="0052">possibly other parameters.</li>    </ul>    </li></ul></p><p id="p-0049" num="0053">The security-establishment-related information can include a root key ID, K<sub>NRP </sub>ID, if UE <b>201</b> has an existing root key K<sub>NRP </sub>for the connection with UE <b>202</b>. The absence of the K<sub>NRP </sub>ID parameter can indicate the UE <b>201</b> does not have a K<sub>NRP </sub>for UE <b>202</b>. The security-establishment-related information can further include IDs (for example, UE's application layer ID) of the initiating UE <b>201</b> and the target UE <b>202</b>.</p><p id="p-0050" num="0054">The security-establishment-related information can further include a key establishment information (Key_Est_Info) container. In various examples, different long-term credentials and associated authentication methods can be employed to establish keys to protect a connection. Corresponding to a specific authentication method, the related parameters can be contained in Key_Est_Info containers and exchanged between two peer UEs. For example, Key_Est_Info containers can be transmitted in the steps of S<b>211</b>, S<b>212</b>, and S<b>213</b>. In some examples, identity-based authentication and encryption schemes are used. The signatures and root keys can be carried in respective Key_Est_Info containers.</p><p id="p-0051" num="0055">At S<b>212</b>, UE <b>202</b> can initiate a Direct Authentication (Auth) and Key Establishment procedure between UE <b>201</b> and UE <b>202</b>. During the Direct Authentication and Key Establishment procedure, UE <b>101</b> and UE <b>102</b> perform mutual authentication and derive a new root key (K<sub>NRP</sub>) shared between UE <b>101</b> and UE <b>102</b>. Depending on the specific authentication method employed, the Direct Authentication and Key Establishment procedure can be performed in different ways. For example, multiple rounds of interactions between UE <b>201</b> and UE <b>202</b> are possible for some authentication methods. In an example, when an identity-based authentication and encryption scheme is used, UE <b>202</b> can derive a root key at S<b>212</b> based on the security-establishment-related information transmitted in S<b>211</b>. Thus, there is no interaction between UE <b>201</b> and UE <b>202</b> at <b>212</b>.</p><p id="p-0052" num="0056">For example, UE <b>201</b> and UE <b>202</b> can each be configured with long term credentials. The credentials may include symmetric key(s) or public/private key pair depending on the particular use case and authentication method employed. A root key K<sub>NRP </sub>(for example, 256 bits long) can be derived based on the credentials during the step of S<b>212</b> using the respective authentication method. For different applications at UE <b>201</b>, different root keys may be derived.</p><p id="p-0053" num="0057">From S<b>213</b> to S<b>217</b>, a security mode control procedure can be performed between UE <b>201</b> and UE <b>202</b>. As a result of this security mode control procedure, selected algorithms and keys can be determined and derived and subsequently used to integrity protect and cipher signalling messages and/or user-plane data exchanged between UE <b>201</b> and UE <b>202</b>.</p><p id="p-0054" num="0058">At S<b>213</b>, UE <b>202</b> can generate a Nonce_<b>2</b> value, for example, with a length of 128 bits. UE <b>202</b> can derive a session key, K<sub>NRP-sess</sub>, from the root key K<sub>NRP</sub>, Nonce_<b>2</b> and Nonce_<b>1</b> (received from UE <b>201</b> at S<b>211</b>). Based on the session key, UE <b>202</b> can derive an encryption key (such as a NR PC5 Encryption Key (NRPEK)) and an integrity key (such as a NR PC5 Integrity Key (NRPIK)) based on selected encryption and integrity protection algorithms.</p><p id="p-0055" num="0059">UE <b>202</b> can create a Direct Security Mode Command message. UE <b>202</b> can transmit the message to UE <b>201</b> to initiate the security mode control procedure. The message can contain the MSB of the K<sub>NRP </sub>ID if K<sub>NRP </sub>is newly generated at UE <b>202</b>. Depending on the employed authentication method, the message can include a Key_Est_Info container for transmitting related information which UE <b>201</b> can use to generate K<sub>NRP</sub>. In an example, the Key_Est_Info container can be used to carry a signature of UE <b>202</b> and an encrypted root key. The message can further include: the chosen algorithms for confidentiality and integrity protection; the security capabilities and signalling security policy of UE <b>201</b>; the Nonce_<b>2</b>; and the LSB of K<sub>NRP-sess </sub>ID.</p><p id="p-0056" num="0060">In an example, the message exchanges in the process <b>200</b> can take place at a PC5 signalling (PC5-S) protocol layer in a control-plane NR sidelink protocol stack. An application layer above the PC5-S protocol layer can prepare the content for the messages exchanged at the PC5-S protocol layer. A lower layer, such as a Packet Data Convergence Protocol (PDCP) layer, can serve as a transport layer for transmitting the messages of the PC5-S protocol layer. Under such a configuration, at S<b>213</b>, UE <b>202</b> can provide to the lower layer with a new security context. The security context can include the K<sub>NRP-sess</sub>, the encryption key NRPEK, the integrity key NRPIK and the related confidentiality and integrity algorithms, for example. The UE <b>202</b> may indicate to the lower layer that the Direct Security Mode Command message can be integrity protected with the new security context and the signalling messages can be received using the new security context.</p><p id="p-0057" num="0061">At S<b>214</b>, UE <b>202</b> is ready to receive user plane data and signalling with the new security context for the connection between UE <b>201</b> and UE <b>202</b>.</p><p id="p-0058" num="0062">At S<b>215</b>, in response to receiving the Direct Security Mode Command message, UE <b>201</b> can derive K<sub>NRP-sess </sub>from K<sub>NRP</sub>, Nonce_<b>1</b> and Nonce <b>2</b> received from UE <b>202</b>. The K<sub>NRP </sub>can be derived locally or received from UE <b>202</b>, depending on the specific authentication method employed. UE <b>201</b> can provide a new security context to the lower layer and indicate to the lower layer that signalling and user data can be protected using the new security context. At the current stage, UE <b>201</b> is ready to send and receive user plane data and signalling with the new security context.</p><p id="p-0059" num="0063">At S<b>216</b>, UE <b>201</b> can transmit a Direct Security Mode Complete message to inform UE <b>202</b> of the completion of the security mode control process. At S<b>217</b>, UE <b>202</b> is ready to send user-plane data and signalling with the new security context. In case an old security context exists, UE <b>202</b> may delete the old security context. For example, UE <b>202</b> can send an integrity protected and confidentiality protected Direct Communication Accept message to UE <b>201</b> with the new security context. The process <b>200</b> can terminate thereafter.</p><p id="p-0060" num="0064"><figref idref="DRAWINGS">FIG. <b>3</b></figref> shows another example of a security establishment process <b>300</b> between UE_<b>1</b> <b>301</b> (UE <b>301</b>) and UE_<b>2</b> <b>302</b> (UE <b>302</b>) over an LTE sidelink PC5 reference point. The process <b>300</b> can be part of a connection setup process (such as the process <b>100</b> in the <figref idref="DRAWINGS">FIG. <b>1</b></figref> example) for establishing a secure connection between UE <b>301</b> and UE <b>302</b>. The process <b>300</b> can have a similar structure as the process <b>200</b>. For example, similar steps are included in both the process <b>300</b> and <b>200</b>. However, the respective messages of the two processes may contain different parameters. For example, some parameters can be related with an identity-based authentication and encryption scheme.</p><p id="p-0061" num="0065">At S<b>311</b>, UE <b>301</b> transmits a Direct Communication Request message. The message can include security-establishment-related information and possibly other parameters. For example, the security-establishment-related information can include a UE_<b>1</b> ID, a Nonce_<b>1</b>, and a signature. The signature can be generated based on the UE_<b>1</b> ID and the Nonce_<b>1</b> and thus can cover the UE_<b>1</b> ID and the Nonce_<b>1</b>. In other examples, user information (also referred to as user ID related information, user ID information, or user related information) of UE <b>301</b> can be carried in the message instead of the UE_<b>1</b> ID. A UE ID can be determined based on the user information and subsequently used, for example, for obtaining a long term key. For example, the user information can provide or be used to derive a UE ID (an UE identity or identifier). Such a UE ID can be used in an identity-based authentication and encryption mechanism to determine a public key. A set of credentials associated with such a UE ID (for example as defined in RFC 6507 or RFC 6508), can be configured to the respective UE. In some examples, the user information is carried in a User Info information element (IE) in the Direct Communication Request message. In some examples, such a UE ID may be encoded in any format that is compatible with the guidelines provided in RFC 6509. For example, such a UE ID may be a concatenation of a fixed part (in the form of an international mobile subscriber identity (IMSI), a SIP UR<b>1</b> (a Uniform Resource Identifier (UR<b>1</b>) scheme for the Session Initiation Protocol (SIP) multimedia communications protocol), a TEL UR<b>1</b> (resources identified by telephone numbers), other user@domain types of UR<b>1</b>, etc.) and a varying part (in the form of a timestamp).</p><p id="p-0062" num="0066">At S<b>312</b>, a Direct Authentication and Key establishment process can be carried out between UE <b>301</b> and UE <b>301</b>. The Direct Authentication and Key establishment process may be different depending on the authentication scheme employed in different examples. As a result of the Direct Authentication and Key establishment process, UE <b>301</b> and UE <b>302</b> have authenticated each other, and a root key K<sub>D </sub>for the direct communications between UE <b>301</b> and UE <b>302</b> can be obtained.</p><p id="p-0063" num="0067">At S<b>313</b>, UE <b>302</b> transmits a direct Security Mode Command message to UE <b>301</b>. The message can include security-establishment-related information and possibly other parameters. The security-establishment-related information can include a UE_<b>2</b> ID, a Nonce_<b>2</b>, a signature covering the UE_<b>2</b> ID and the Nonce_<b>2</b>, and the root key K<sub>D </sub>in an encrypted form. Similarly, in some examples, user related information of UE <b>302</b> can be carried in the message instead of the UE_<b>2</b> <b>1</b>D.</p><p id="p-0064" num="0068">At S<b>314</b>, UE <b>301</b> can transmit a Direct Security Mode Complete message to inform UE <b>302</b> that a security association has been established at UE <b>301</b>. The process <b>300</b> can terminate thereafter.</p><p id="p-0065" num="0069">During the process <b>300</b>, in some embodiments, the establishment of security can depend on a public-key mechanism known as identity-based encryption. Each UE is presumed to be pre-configured with a &#x201c;master&#x201d; public key belonging to a key management server (KMS), and aware of an algorithm for generating the public key for any peer UE based on the master public key and the identity (ID) of the peer UE. In the process <b>300</b> for establishing a connection, the Direct Communication Request message includes the identity of UE_<b>1</b> and a first signature. The first signature can be derived from a private key of UE_<b>1</b>. Upon receiving the message, UE_<b>2</b> uses the master public key and the identity of UE_<b>1</b> to derive the public key of UE_<b>1</b>, allowing it to confirm the authenticity of the first signature. After this step, UE_<b>2</b> has confirmed the identity of UE_<b>1</b>. Subsequently, UE_<b>2</b> transmits a Direct Security Mode Command, which includes the identity of UE_<b>2</b> and a second signature. The second signature is derived from a private key of UE_<b>2</b>. Upon receiving the message, UE_<b>1</b> uses the master public key and the identity of UE_<b>2</b> to derive the public key of UE_<b>2</b>, allowing it to confirm the authenticity of the second signature. After this step, UE_<b>1</b> has confirmed the identity of UE_<b>2</b>. In some embodiments, the public-key mechanism used for these procedures is the &#x201c;Elliptic Curve-based Certificateless Signatures for Identity-based Encryption&#x201d; (ECCSI) mechanism defined in IETF RFC 6507. In principle, any public-key mechanism can be used, so long as it provides a means to generate individual public keys from the master public key.</p><p id="p-0066" num="0070">At substantially the same time as the authentication procedure, UE_<b>1</b> and UE_<b>2</b> can exchange information to generate a shared root key K<sub>D</sub>, known only to UE_<b>1</b> and UE_<b>2</b>. A session key K<sub>D-sess </sub>may subsequently be derived from K<sub>D</sub>. To facilitate the generation of K<sub>D-sess</sub>, the Direct Communication Request message in S<b>311</b> contains a nonce (i.e., an arbitrary number generated by UE_<b>1</b> for one-time use) labelled as Nonce_<b>1</b>, which is used as an input for key derivation. Nonce_<b>1</b> is not a secret and may be exchanged in the clear between the two UEs. (The generation of K<sub>D </sub>may use any of a variety of key generation algorithms, based on information exchanged between UE_<b>1</b> and UE_<b>2</b>; the details of the key generation algorithm are outside the scope of this disclosure. Additional steps of the key generation may occur as part of S<b>312</b>.) Upon receiving Nonce_<b>1</b> in the Direct Communication Request message (S<b>311</b>), and after determining K<sub>D</sub>, UE_<b>2</b> generates a second nonce, labelled as Nonce_<b>2</b>, and derives K<sub>D-sess </sub>from K<sub>D </sub>using Nonce_<b>1</b> and Nonce_<b>2</b> as inputs. UE_<b>2</b> then sends Nonce_<b>2</b> to UE_<b>1</b> in the Direct Security Mode Command message (S<b>313</b>), along with explicitly signalling the value of K<sub>D </sub>in encrypted form. In some embodiments, the method used to encrypt K<sub>D </sub>for this message is Sakai-Kasahara Key Encryption (SAKKE), as defined in IETF RFC 6508. In principle other mechanisms may be used. UE_<b>1</b> also derives K<sub>D-sess </sub>from K<sub>D </sub>using Nonce_<b>1</b> and Nonce_<b>2</b> as inputs. Accordingly, UE_<b>1</b> and UE_<b>2</b> have a shared session key known only to them. After this step, K<sub>D-sess </sub>can be used to secure communications between UE_<b>1</b> and UE_<b>2</b> using any agreed-upon security algorithms.</p><p id="p-0067" num="0071">Note that, for the generation of K<sub>D-sess </sub>to proceed correctly, Nonce_<b>1</b> and Nonce_<b>2</b> must be reliably and accurately exchanged between UE_<b>1</b> and UE_<b>2</b>. To achieve this, the signatures applied to the Direct Communication Request and Direct Security Mode Command messages can also cover the nonces, as well as the corresponding UE identities. The generation of the signature from these inputs, and confirmation of the signature by the recipient can depend on the specific authentication method employed.</p><p id="p-0068" num="0072">In some embodiments, the security-establishment-related information at S<b>311</b> can further include other parameters, such as UE_<b>1</b> security capabilities; most significant bits of the K<sub>D-sess </sub>ID; optionally, a K<sub>D </sub>ID if the UE_<b>1</b> has an existing K<sub>D</sub>; necessary information to establish a K<sub>D </sub>from a relevant long term key(s) held on the UE; and information of a long term ID needed by the UE_<b>2</b> in order to retrieve the right long term Key.</p><p id="p-0069" num="0073">In some embodiments, the security-establishment-related information at S<b>313</b> can further include other parameters, such as most significant bits of K<sub>D </sub>ID if a fresh K<sub>D </sub>is generated; Nonce_<b>2</b> to allow a session key to be calculated; parameters of chosen algorithms to indicate which security algorithms the UEs will use to protect the data; and the least significant bits of K<sub>D-sess </sub>ID which can be used by UE <b>301</b> to locally identify a security context.</p><p id="p-0070" num="0074"><figref idref="DRAWINGS">FIG. <b>4</b></figref> shows an example of control-plane protocol stacks <b>400</b> for direct communications between two peer UEs, UE <b>401</b> and UE <b>402</b>. As shown, UE <b>401</b> and <b>402</b> communicate through a PC5 reference point. Each protocol stack of UE <b>401</b> or UE <b>402</b> can include a physical (PHY) layer, a medium access control (MAC) layer, a radio link control (RLC) layer, a packet data convergence protocol (PDCP) layer, a PC5 signalling protocol layer, and an application layer.</p><p id="p-0071" num="0075">During a connection setup and security establishment process, the messages (such as a Direct Communication Request message, a Direct Security Mode Command message, a Direct Security Mode Complete message, a Direct Communication Accept, and the like) can be exchanged at the PC5 signalling protocol layers at UE <b>401</b> and UE <b>402</b>. The PC5 signalling protocol layers can receive content from the upper application layers to form the messages. In some embodiments, other signalling protocol layers may be used to exchange messages with similar functionality. Security contexts for a connection between UE <b>401</b> and UE <b>402</b> can be provided from the application layers to the PDCP layers.</p><p id="p-0072" num="0076">The foregoing description covers the establishment of peer-to-peer security in the LTE and NR sidelink environments. The introduction of relaying in 3GPP Rel-17 creates a scenario in which UE_<b>1</b> and UE_<b>2</b> do not communicate directly, but rather via a third &#x201c;relay&#x201d; UE, UE_R. In this scenario, UE_<b>1</b> and UE_<b>2</b> may be referred to as remote UEs. Traffic from UE_<b>1</b> may be delivered by the relay UE_R to UE_<b>2</b>, and vice versa. The relay UE_R may not have access to the traffic in the clear. It may be necessary to have end-to-end security between UE_<b>1</b> and UE_<b>2</b>.</p><p id="p-0073" num="0077"><figref idref="DRAWINGS">FIG. <b>5</b>A</figref> shows an example where UE_<b>1</b> <b>501</b> and UE_<b>2</b> <b>503</b> communicate via a relay UE, UE_R <b>502</b>. For a connection between two remote UEs UE_<b>1</b> <b>501</b> and UE_<b>2</b> <b>503</b> via a relay UE UE_R <b>502</b> to be secured, security can be established on three links: between UE_<b>1</b> <b>501</b> and UE_R <b>502</b>, between UE_R <b>502</b> and UE_<b>2</b> <b>503</b>, and between UE_<b>1</b> <b>501</b> and UE_<b>2</b> <b>503</b>. The first two &#x201c;direct&#x201d; links can rely on sidelink procedures for security establishment, but some extra effort is required to establish security for the third &#x201c;indirect&#x201d; link between UE_<b>1</b> <b>501</b> and UE_<b>2</b> <b>503</b>.</p><p id="p-0074" num="0078">To determine a session key for use between UE_<b>1</b> <b>501</b> and UE_<b>2</b> <b>503</b>, the UE that initiates the connection (e.g., UE_<b>1</b> <b>501</b>) can provide its own ID and a nonce value. The UE that terminates the connection (e.g., UE_<b>2</b> <b>503</b>) can confirm the legitimacy of the initiating message (e.g., a Direct Communication Request message) based on the source's ID and the public key of the source, and generate a session key based on a generated root key, the source's ID, and the nonce. However, the initiating message is not sent directly from UE_<b>1</b> <b>501</b> to UE_<b>2</b> <b>503</b>, but instead routed through UE_R <b>502</b>. In a connection establishment scheme disclosed herein, the initiating message serves both to establish the connection between UE_<b>1</b> <b>501</b> and UE_R <b>502</b> and to establish the connection between UE_<b>1</b> <b>501</b> and UE_<b>2</b> <b>503</b>. UE_R <b>502</b> receives the initiating message from UE_<b>1</b> <b>501</b> and triggers its own procedure to establish security with UE_<b>1</b> <b>501</b>, while also forwarding the initiating message to UE_<b>2</b> <b>503</b>.</p><p id="p-0075" num="0079">The contents of the initiating message allow both UE_R <b>502</b> and UE_<b>2</b> <b>503</b> to verify that the message comes legitimately from UE_<b>1</b> <b>501</b> and has not been tampered with. The initiating message may, for example, be signed with a private key of UE_<b>1</b> <b>501</b> and can be confirmed using a public key of UE_<b>1</b> <b>501</b>. Such a public key can be calculated by UE_R <b>502</b> or UE_<b>2</b> <b>503</b> based on information provided in the initiating message, e.g., an identity of UE_<b>1</b>, along with a previously known public key of a key server.</p><p id="p-0076" num="0080">Further, the inclusion of a nonce in the initiating message allows UE_R <b>502</b> to generate a session key for use with UE_<b>1</b> <b>501</b>, based on the nonce as well as other key establishment information. When the initiating message is forwarded from UE_R <b>502</b> to UE_<b>2</b> <b>503</b>, if the same nonce is provided, UE_<b>2</b> <b>503</b> will generate a session key using the same nonce as UE_R <b>502</b>. This may be acceptable if the other key establishment information is sufficient to guarantee key separation (e.g., a dependency on the identity of the receiver, causing UE_R <b>502</b> to generate different keys from UE_<b>2</b> <b>503</b>). On the other hand, it may be preferable to include a separate nonce for UE_<b>2</b> <b>503</b>, in which case the initiating message can be expanded to include two nonces: a first nonce for direct use (between UE_<b>1</b> <b>501</b> and UE_R <b>503</b>), and a second nonce for end-to-end use (between UE_<b>1</b> <b>501</b> and UE_<b>2</b> <b>503</b>).</p><p id="p-0077" num="0081">It is noted that in an environment of a mesh network or multi-hop relays, there may be more than one relay UEs between UE_<b>1</b> and UE_<b>2</b>. However, this does not result in a need for additional security associations. <figref idref="DRAWINGS">FIG. <b>5</b>B</figref> shows an example where a connection goes from UE_<b>1</b> <b>511</b> to UE_R<b>1</b> <b>512</b> to UE_R<b>2</b> <b>513</b> to UE_<b>2</b> <b>514</b>. There may be no requirement for a security association between UE_<b>1</b> <b>511</b> and UE_R<b>2</b> <b>513</b>, nor between UE_<b>2</b> <b>514</b> and UE_R<b>1</b> <b>512</b>. This is because there is no traffic between these pairs of endpoints. Security can be established on a hop-by-hop basis. In such a way, communications between each UE and its &#x201c;neighbors&#x201d; in the communication chain can be secured. Security can also be established on an end-to-end basis. As a result, communications between the two endpoint UEs <b>511</b> and <b>514</b> can be secured.</p><p id="p-0078" num="0082">On the other hand, in an environment with multiple relays, each relay can establish a security association with the next relay. In the <figref idref="DRAWINGS">FIG. <b>5</b>B</figref> example described above, UE_R<b>1</b> <b>512</b> and UE_R<b>2</b> <b>513</b> can communicate securely. (Although the relay UEs would not be expected to exchange user-plane traffic as part of the relaying connection, they can exchange signalling to manage the connection between them. This signalling can be secured according to normal security principles.) Thus, for example, when forwarding the initiating message (such as a Direct Communication Request) to UE_R<b>2</b> <b>513</b>, UE_R<b>1</b> <b>512</b> may need to replace the first &#x201c;direct&#x201d; nonce (which was provided by UE_<b>1</b> <b>511</b>) with a new value for use between UE_R<b>1</b> <b>512</b> and UE_R<b>2</b> <b>513</b>.</p><p id="p-0079" num="0083"><figref idref="DRAWINGS">FIG. <b>6</b></figref> shows an example of a connection setup process <b>600</b> between two peer UEs <b>601</b> and <b>603</b> communicating via a relay UE <b>602</b> according to embodiments of the disclosure. During the process <b>600</b>, secure connections can be established between UE <b>601</b> and UE <b>602</b>, between UE <b>601</b> and UE <b>603</b>, and between UE <b>601</b> and UE <b>603</b>. UE <b>601</b> can be referred to as an initiating UE, while UE <b>603</b> can be referred to a target UE. Each UE <b>601</b>-<b>603</b> can be a vehicle, a mobile phone, a portable computer, or the like. Each UE <b>601</b>-<b>603</b> is capable of communicating with one or more neighbor UEs via a direct interface, such as an NR-based sidelink or an LTE-based (Evolved Universal Terrestrial Radio Access (E-UTRA) based) sidelink.</p><p id="p-0080" num="0084">At S<b>610</b>, UE <b>601</b> can transmit a Direct Communication Request message to initiate the connection setup process <b>600</b>. In an example, UE <b>601</b> can know which UE is the target UE <b>603</b> (e.g., a layer <b>2</b> ID or an application ID of UE <b>603</b>) and send the Direct Communication Request message addressed to the target UE. For example, UE <b>603</b> may periodically broadcast an announcement message in the mesh network to declare the services UE <b>603</b> can provide. UE <b>601</b> may receive such an announcement message and accordingly want to request a service from UE <b>603</b>. For another example, UE <b>601</b> may send a query message asking for a specific service. UE <b>603</b> may reply to the query message with a confirmation that UE <b>603</b> can provide the requested service. The reply message can indicate an ID of UE <b>603</b>.</p><p id="p-0081" num="0085">In an example, UEs <b>601</b>-<b>603</b> can be part of a wireless mesh network. Each UE can maintain a routing table locally based on a routing protocol. Based on the routing table, UE <b>601</b> can select a neighbor UE to be the relay UE <b>602</b> in order to reach the target UE <b>603</b>. Alternatively or in addition, UE <b>601</b> may apply other criteria to select relay UE <b>602</b>, such as signal strength, geographical proximity, an indication from relay UE <b>602</b> that it can serve as a relay UE between UE <b>601</b> and UE <b>603</b>, and so on.</p><p id="p-0082" num="0086">In an example, UE <b>601</b> may not know the target UE in advance. UE <b>601</b> may include information in the Direct Communication Request message to indicate a desired service and broadcast the Direct Communication Request message. A neighbor UE of UE <b>601</b> (such as UE <b>602</b>) may receive the broadcast message and forward the message to one or more surrounding UEs. UE <b>603</b>, when receiving the Direct Communication Request message, can determine to reply to UE <b>601</b> to confirm that UE <b>603</b> would be the target UE. For example, UE <b>603</b> can determine that it can support the desired service, and UE <b>603</b> may indicate such support in a reply to UE <b>601</b>.</p><p id="p-0083" num="0087">In an embodiment, the Direct Communication Request message of S<b>610</b> can include two separate sets of security-establishment-related information: 1st security-establishment-related information and 2nd security-establishment-related information. The 1st security-establishment-related information is to be used for security establishment between the initiating UE <b>601</b> and the relay UE <b>602</b>. The 2nd security-establishment-related information is to be used for security establishment between the initiating UE <b>601</b> and the target UE <b>603</b>. The 1 st security-establishment-related information and 2nd security-establishment-related information can be similar to that in the <figref idref="DRAWINGS">FIG. <b>2</b></figref> and <figref idref="DRAWINGS">FIG. <b>3</b></figref> examples.</p><p id="p-0084" num="0088">At S<b>611</b>, UE <b>602</b> initiates an authentication and security establishment process in response to receiving the Direct Communication Request message of S<b>610</b>. The authentication and security establishment process can be based on the 2nd security-establishment-related information of S<b>610</b>. For example, the authentication and security establishment process can include an authentication and key establishment process to perform mutual authentication and derive a root key for UEs <b>601</b> and <b>602</b>. The authentication and security establishment process can further include a security mode control process to establish a security association for a session between UEs <b>601</b> and <b>602</b>. For example, the authentication and security establishment process can include steps similar to S<b>212</b>-S<b>216</b> in the <figref idref="DRAWINGS">FIG. <b>2</b></figref> example, or steps similar to S<b>312</b>-S<b>314</b> in the <figref idref="DRAWINGS">FIG. <b>3</b></figref> example.</p><p id="p-0085" num="0089">At S<b>612</b>, UE <b>602</b> can transmit a direct communication accept message to S<b>601</b> to complete the connection setup between UE <b>601</b> and UE <b>602</b>.</p><p id="p-0086" num="0090">At S<b>613</b>, UE <b>602</b> can transmit a Direct Communication Request message to UE <b>603</b>. The Direct Communication Request message of S<b>613</b> can include two separate sets of security-establishment-related information: 1st security-establishment-related information and 3rd security-establishment-related information. The 3rd security-establishment-related information is to be used for security establishment between UE <b>602</b> and UE <b>603</b>. The 3rd security-establishment-related information can be similar to that in the <figref idref="DRAWINGS">FIG. <b>2</b></figref> and <figref idref="DRAWINGS">FIG. <b>3</b></figref> examples.</p><p id="p-0087" num="0091">For example, after UE <b>602</b> has authenticated UE <b>601</b> based on the 2nd security-establishment-related information of S<b>610</b>, UE <b>602</b> can replace the 2nd security-establishment-related information of S<b>610</b> with the 3rd security-establishment-related information to form the Direct Communication Request message of S<b>613</b>. Although S<b>613</b> is shown to follow S<b>612</b> in the <figref idref="DRAWINGS">FIG. <b>6</b></figref> example, S<b>613</b> can be performed once UE <b>602</b> has completed the authentication with UE <b>601</b> in other examples.</p><p id="p-0088" num="0092">At S<b>614</b>, UE <b>603</b> initiates an authentication and security establishment process in response to receiving the Direct Communication Request message of S<b>613</b>. For example, based on the Direct Communication Request message of S<b>613</b>, UE <b>603</b> can determine that UE <b>603</b> is the target UE for the initiating UE <b>601</b>. Accordingly, UE <b>603</b> can end the forwarding of the 1st security-establishment-related information, and start to first establish a secure connection between UE <b>603</b> and UE <b>602</b> and then establish a secure connection between UE <b>603</b> and UE <b>601</b>.</p><p id="p-0089" num="0093">In some embodiments, this authentication and security establishment process of S<b>614</b> can be similar to the authentication and security establishment process of S<b>611</b> but based on the 3rd security-establishment-related information of S<b>613</b>.</p><p id="p-0090" num="0094">At S<b>615</b>, UE <b>603</b> can transmit a direct communication accept message to S<b>602</b> to complete the connection setup between UE <b>602</b> and UE <b>603</b>.</p><p id="p-0091" num="0095">At S<b>616</b>, UE <b>603</b> initiates an authentication and security establishment process between UE <b>603</b> and UE <b>601</b> based on the 1st security-establishment-related information.</p><p id="p-0092" num="0096">At S<b>617</b>, UE <b>603</b> can transmit a direct communication accept message to S<b>601</b> to complete the connection setup between UE <b>601</b> and UE <b>603</b>. The process <b>600</b> can terminate thereafter.</p><p id="p-0093" num="0097">In an embodiment, different from the <figref idref="DRAWINGS">FIG. <b>6</b></figref> example, the Direct Communication Request message transmitted at S<b>610</b> can only include the 1st security-establishment-related information. Accordingly, the authentication and security establishment process at S<b>611</b> can also be based on the 1 st security-establishment-related information (that is the same as that used in S<b>616</b>.</p><p id="p-0094" num="0098"><figref idref="DRAWINGS">FIG. <b>7</b></figref> shows a message flow <b>700</b> for connection setup and security establishment in a setting with two relay UEs according to some embodiments of the disclosure. In this flow <b>700</b>, a first remote UE UE_<b>1</b> <b>701</b> wishes to establish communication with a second remote UE UE_<b>2</b> <b>704</b>, and the communication is mediated by two relay UEs UE_R<b>1</b> <b>702</b> and UE_R<b>2</b> <b>703</b>. The connection setup signalling is shown using the terminology of the PC5 signalling (PC5-S) protocol from 5G systems, in which the connection setup is initiated by a Direct Communication Request (DCR) message and concluded by a Direct Communication Accept (DCA) message, and security is established with a Direct Security Mode Command (DSMC) message followed by a Direct Security Mode Complete (DSMComp) message.</p><p id="p-0095" num="0099">Steps <b>1</b> through <b>1</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref> establish a connection with secure communication between the first remote UE UE_<b>1</b> <b>701</b> and the first relay UE UE_R<b>1</b> <b>702</b>.</p><p id="p-0096" num="0100">In step <b>1</b> of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>1</b> <b>701</b> sends a first DCR message soliciting communication with UE_<b>2</b> <b>702</b>. The first DCR message may be sent after a discovery procedure has taken place, meaning that UE_<b>1</b> <b>701</b> already knows that it is communicating via relays with UE_<b>2</b> <b>702</b>. Alternatively, the first DCR message may be sent as a step in a discovery procedure, meaning that UE_<b>1</b> <b>701</b> solicits communication with UE_<b>2</b> <b>702</b> but does not yet know if UE_<b>2</b> <b>702</b> is accessible (directly or via one or more relays). The first DCR message contains at least a first nonce (E<b>2</b>E_Nonce_UE<b>1</b>) and a first signature of UE_<b>1</b> <b>701</b> (E<b>2</b>E_Sig_UE<b>1</b>), which will be used for end-to-end communication with UE_<b>2</b> <b>704</b>. The first DCR message may also contain a second nonce (Hop_Nonce_UE<b>1</b>) that will be used for hop-by-hop communication with UE_R<b>1</b> <b>702</b> in a subsequent step. The signature E<b>2</b>E_Sig_UE<b>1</b> may be generated by any of a variety of methods, such as by signing the message content with a private key of UE_<b>1</b> <b>701</b> according to a public-key cryptography scheme. The first DCR message may also include either a temporary or permanent identity of UE_<b>1</b> <b>701</b> (not shown in <figref idref="DRAWINGS">FIG. <b>7</b></figref>).</p><p id="p-0097" num="0101">If the second nonce Hop_Nonce_UE<b>1</b> is included in the first DCR message, the signature E<b>2</b>E_Sig_UE<b>1</b> may be generated over a portion of the first DCR message that excludes Hop_Nonce_UE<b>1</b>. (This is because Hop_Nonce_UE<b>1</b>, if included, will be replaced with a different value in subsequent steps.) Accordingly, E<b>2</b>E_Sig_UE<b>1</b> may not be usable to confirm that Hop_Nonce_UE<b>1</b> has not been tampered with in transmission, and it may be necessary for UE_<b>1</b> <b>701</b> to include in the first DCR message a second signature of UE_<b>1</b> <b>701</b> (Hop_Sig_UE<b>1</b>). The second signature of UE_<b>1</b> <b>701</b> may be computed over a portion of the message that includes Hop_Nonce_UE<b>1</b>.</p><p id="p-0098" num="0102">In step <b>1</b><i>a </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>1</b> <b>702</b> receives the first DCR message and uses a cryptographic operation to confirm the validity of Hop_Sig_UE<b>1</b>, if provided. (If Hop_Sig_UE<b>1</b> is not provided, UE_R<b>1</b> <b>702</b> may confirm the validity of E<b>2</b>E_Sig_UE<b>1</b> to verify the identity of the originating UE, although if E<b>2</b>E_Sig_UE<b>1</b> does not cover Hop_Nonce_UE<b>1</b>. This process will not confirm that Hop_Nonce_UE<b>1</b> has not been modified or corrupted.)</p><p id="p-0099" num="0103">A typical procedure for this confirmation step can be performed as follows. A sender (&#x201c;Alice&#x201d;) provides a recipient (&#x201c;Bob&#x201d;) with an ID of the sender (for instance, &#x201c;alice@example.com&#x201d;) in a message signed with a private key of the sender, and the recipient computes the sender's public key based on the ID and additional information such as a key server configuration. The computation of the sender's public key may rely on an identity-based mechanism, in which an identity of the sender and a public key of a key server are sufficient to derive a public key of the sender. Knowing the sender's public key allows the recipient to confirm that the signature on the message belongs to the sender, and thus that the message legitimately originates from the claimed source and has not been tampered with or corrupted in transmission. In the context of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, this means that in step <b>1</b><i>a</i>, UE_R<b>1</b> <b>702</b> can confirm by checking Hop_Sig_UE<b>1</b> or E<b>2</b>E_Sig_UE<b>1</b> that the first DCR message legitimately comes from UE_<b>1</b> <b>701</b>.</p><p id="p-0100" num="0104">Also in step <b>1</b><i>a </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>1</b> <b>701</b> may generate a root key K<sub>D</sub>(<b>1</b>,R<b>1</b>) to be used for secure communication between UE_<b>1</b> <b>701</b> and UE_R<b>1</b> <b>702</b>. The derivation of K<sub>D</sub>(<b>1</b>,R<b>1</b>) may depend at least in part on information from the first DCR message, and may use any of a variety of techniques for key generation. In some embodiments, the generation of K<sub>D</sub>(<b>1</b>,R<b>1</b>) may also depend on information not known to UE_<b>1</b> <b>701</b>, because K<sub>D</sub>(<b>1</b>,R<b>1</b>) will be provided to UE_<b>1</b> <b>701</b> in a subsequent step and does not need to be generated by UE_<b>1</b>.</p><p id="p-0101" num="0105">In step <b>1</b><i>b </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>1</b> <b>702</b> sends a first Direct Security Mode Command (DSMC) message to UE_<b>1</b> <b>701</b>. The first DSMC command may contain the root key K<sub>D</sub>(<b>1</b>,R<b>1</b>) in an encrypted format. Various techniques may be used to secure the distribution of K<sub>D</sub>(<b>1</b>,R<b>1</b>). The first DSMC command may contain a third nonce (Hop_Nonce_UER<b>1</b>) generated by UE_R<b>1</b> <b>702</b> and/or a first signature of UE_R<b>1</b> <b>702</b> (Hop_Sig<b>1</b>_UER<b>1</b>).</p><p id="p-0102" num="0106">In step <b>1</b><i>c </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>1</b> <b>701</b> and UE_R<b>1</b> <b>702</b> independently generate a first session key K<sub>D-sess </sub>(<b>1</b>,R<b>1</b>), which may be used to secure subsequent communication between UE_<b>1</b> <b>701</b> and UE_R<b>1</b> <b>702</b>. The first session key may be generated from one or more inputs including the root key K<sub>D</sub>(<b>1</b>,R<b>1</b>), the second nonce Hop_Nonce_UE<b>1</b>, or the third nonce Hop_Nonce<b>1</b>_UER<b>1</b>. The establishment of the first session key means that UE_<b>1</b> <b>701</b> and UE_R<b>1</b> <b>702</b> can communicate securely.</p><p id="p-0103" num="0107">In step <b>1</b><i>d </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>1</b> <b>701</b> sends a first Direct Security Mode Complete (DSMComp) message to UE_R<b>1</b> <b>702</b>. The first DSMComp message may be security-protected (ciphered and/or signed) using one or more keys derived from K<sub>D-sess </sub>(<b>1</b>,R<b>1</b>).</p><p id="p-0104" num="0108">In step <b>1</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>1</b> <b>702</b> sends a first Direct Communication Accept (DCA) message to UE_<b>1</b> <b>701</b>. The first DCA message may be security-protected (ciphered and/or signed) using one or more keys derived from K<sub>D-sess </sub>(<b>1</b>,R<b>1</b>).</p><p id="p-0105" num="0109">Steps <b>2</b> through <b>2</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref> establish a connection with secure communication between the first relay UE UE_R<b>1</b> and the second relay UE UE_R<b>2</b>. The steps are similar to steps <b>1</b> through <b>1</b><i>e</i>, but some of the parameters provided by UE_<b>1</b> in steps <b>1</b> through <b>1</b><i>e </i>are replaced with new parameters provided by UE_R<b>1</b> in steps <b>2</b> through <b>2</b><i>e. </i></p><p id="p-0106" num="0110">In step <b>2</b> of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>1</b> <b>702</b> delivers a second DCR message to UE_R<b>2</b> <b>703</b>. The second DCR message may be considered as a forwarded copy of the first DCR message, with some parameters modified as described herein. The second DCR message may contain the first nonce (E<b>2</b>E_Nonce_UE<b>1</b>) and the first signature of UE_<b>1</b> (E<b>2</b>E_Sig_UE<b>1</b>), which are also in the first DCR message. However, the second nonce (Hop_Nonce_UE<b>1</b>), if it was originally included, may be replaced with a fourth nonce (Hop_Nonce<b>2</b>_UER<b>1</b>), and the second signature of UE_<b>1</b> (Hop_Sig_UE<b>1</b>) may be replaced with a second signature of UE_R<b>1</b> <b>702</b> (Hop_Sig<b>2</b>_UER<b>1</b>). The second signature of UE_R<b>1</b> <b>702</b> may be computed over a portion of the message that includes Hop_Nonce<b>2</b>_UER<b>1</b>.</p><p id="p-0107" num="0111">In step <b>2</b><i>a </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>2</b> <b>703</b> checks Hop_Sig<b>2</b>_UER<b>1</b> to confirm the identity of UE_R<b>1</b> and the integrity of the second DCR message. Also in step <b>2</b><i>a </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>2</b> <b>703</b> generates a second root key K<sub>D</sub>(R<b>1</b>,R<b>2</b>) for communication between UE_R<b>1</b> <b>702</b> and UE_R<b>2</b> <b>703</b>. Similar to step <b>1</b><i>a </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, these procedures may use any of a variety of cryptographic techniques.</p><p id="p-0108" num="0112">In step <b>2</b><i>b </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>2</b> <b>703</b> sends a second DSMC message to UE_R<b>1</b> <b>702</b>. The second DSMC message may contain the second root key (in encrypted form), a fifth nonce Hop_Nonce<b>1</b>_UER<b>2</b>, and/or a first signature of UE_R<b>2</b> <b>703</b>. Hop_Sig<b>1</b>_UER<b>2</b>.</p><p id="p-0109" num="0113">In step <b>2</b><i>c </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>1</b> <b>702</b> and UE_R<b>2</b> <b>703</b> use the fourth and fifth nonces (Hop_Nonce<b>2</b>_UER<b>1</b> and Hop_Nonce<b>1</b>_UER<b>2</b>) to generate a second session key K<sub>D-sess </sub>(R<b>1</b>,R<b>2</b>).</p><p id="p-0110" num="0114">In step <b>2</b><i>d </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>1</b> <b>702</b> sends a second DSMComp message to UE_R<b>2</b> <b>703</b>. The second DSMComp message may be security-protected using one or more keys derived from K<sub>D-sess </sub>(R<b>1</b>,R<b>2</b>).</p><p id="p-0111" num="0115">In step <b>2</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>2</b> <b>703</b> sends a second DCA message to UE_R<b>1</b> <b>702</b>. The second DCA message may be security-protected using one or more keys derived from K<sub>D-sess </sub>(R<b>1</b>,R<b>2</b>).</p><p id="p-0112" num="0116">Steps <b>3</b> through <b>3</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref> establish a connection with secure communication between UE_R<b>2</b> <b>703</b> and UE_<b>2</b> <b>704</b>, using substantially the same procedures as the corresponding operations in steps <b>2</b> through <b>2</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>.</p><p id="p-0113" num="0117">In step <b>3</b> of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>2</b> <b>703</b> sends a third DCR message to UE_<b>2</b> <b>704</b>. The third DCR message may be considered as a forwarded copy of the first DCR message, with some parameters modified as described herein. The second nonce Hop_Nonce_UE<b>1</b> in the first DCR message may be replaced with a sixth nonce Hop_Nonce<b>2</b>_UER<b>2</b>, and the second signature of UE_<b>1</b> (Hop_Sig_UE<b>1</b>) may be replaced with a second signature of UE_R<b>2</b> (Hop_Sig<b>2</b>_UER<b>2</b>). The second signature of UE_R<b>2</b> <b>703</b> may be computed over a portion of the message that includes Hop_Nonce<b>2</b>_UER<b>2</b>.</p><p id="p-0114" num="0118">In step <b>3</b><i>a </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>2</b> <b>704</b> checks Hop_Sig<b>2</b>_UER<b>2</b> to confirm the identity of UE_R<b>2</b> <b>703</b> and the integrity of the third DCR message, and generates a third root key K<sub>D</sub>(R<b>2</b>,<b>2</b>) for communication between UE_R<b>2</b> <b>703</b> and UE_<b>2</b> <b>704</b>.</p><p id="p-0115" num="0119">In step <b>3</b><i>b </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>2</b> <b>704</b> sends a third DSMC message to UE_R<b>2</b> <b>703</b>, containing some or all of the third root key (in encrypted form), a seventh nonce Hop_Nonce_UE<b>2</b>, or a first signature of UE_<b>2</b> <b>704</b> (Hop_Sig_UE<b>2</b>).</p><p id="p-0116" num="0120">In step <b>3</b><i>c </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>2</b> <b>703</b> and UE_<b>2</b> <b>704</b> separately generate a third session key K<sub>D-sess </sub>(R<b>2</b>,<b>2</b>), using Hop_Nonce<b>2</b>_UER<b>2</b> and Hop_Nonce_UE<b>2</b>.</p><p id="p-0117" num="0121">In step <b>3</b><i>d </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_R<b>2</b> <b>703</b> sends a third DSMComp message to UE_<b>2</b> <b>704</b>.</p><p id="p-0118" num="0122">In step <b>3</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>2</b> <b>704</b> sends a third DCA message to UE_R<b>2</b> <b>703</b>.</p><p id="p-0119" num="0123">Steps <b>4</b><i>a </i>through <b>4</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref> establish a connection with secure communication between UE_<b>1</b> <b>701</b> and UE_<b>2</b> <b>704</b>. The procedures are similar to steps <b>2</b><i>a </i>through <b>2</b><i>e </i>or steps <b>3</b><i>a </i>through <b>3</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>. It is noted that no delivery of an additional DCR message is needed, because the DCR message was already delivered to UE_<b>2</b> <b>704</b> in step <b>3</b> above.</p><p id="p-0120" num="0124">In step <b>4</b><i>a </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>2</b> <b>704</b> checks E<b>2</b>E_Sig_UE<b>1</b> (the first signature of UE_<b>1</b>) to confirm the identity of UE_<b>1</b> <b>701</b> and the integrity of those portions of the third DCR message that are covered by E<b>2</b>E_Sig_UE<b>1</b>. It is noted that E<b>2</b>E_Sig_UE<b>1</b> is carried unchanged through the first, second, and third DCR messages, so any fields covered by E<b>2</b>E_Sig_UE<b>1</b> must also be carried unchanged through the first, second, and third DCR messages. As an example, E<b>2</b>E_Sig_UE<b>1</b> may cover fields of the third DCR message indicating an identity of UE_<b>1</b> and the first nonce E<b>2</b>E_Nonce_UE<b>1</b>. Also in step <b>4</b><i>a </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>2</b> <b>704</b> generates a fourth root key K<sub>D</sub>(<b>1</b>,<b>2</b>).</p><p id="p-0121" num="0125">In step <b>4</b><i>b </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>2</b> <b>704</b> sends a fourth DSMC message to UE_<b>1</b> <b>701</b>. Transport for the fourth DSMC message may be provided by the intervening relay UEs UE_R<b>2</b> <b>703</b> and UE_R<b>1</b> <b>702</b>. The fourth DSMC message may be transmitted on a signalling radio bearer that supports routing of messages by the relay UEs. The fourth DSMC message may contain the fourth root key (in encrypted form), an eighth nonce E<b>2</b>E_Nonce_UE<b>2</b>, and/or a second signature of UE_<b>2</b> <b>704</b> (E<b>2</b>E_Sig_UE<b>2</b>).</p><p id="p-0122" num="0126">In step <b>4</b><i>c </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>1</b> <b>701</b> and UE_<b>2</b> <b>704</b> separately generate a fourth session key K<sub>D-sess </sub>(<b>1</b>,<b>2</b>) for communication between UE_<b>1</b> <b>701</b> and UE_<b>2</b> <b>704</b>, using E<b>2</b>E_Nonce_UE<b>1</b> and E<b>2</b>E_Nonce_UE<b>2</b>. It is noted that although UE_R<b>1</b> <b>702</b> and UE_R<b>2</b> <b>703</b> participated in the transport of the fourth DSMC message from UE_<b>2</b> <b>704</b> to UE_<b>1</b> <b>701</b>, they do not have access to the value of K<sub>D</sub>(<b>1</b>,<b>2</b>), and therefore UE_R<b>1</b> <b>702</b> and UE_R<b>2</b> <b>703</b> cannot duplicate the derivation of K<sub>D</sub>(<b>1</b>,<b>2</b>). As a result, security between UE_<b>1</b> <b>701</b> and UE_<b>2</b> <b>704</b> is end-to-end, meaning that the intervening relay nodes do not have access to ciphered communications between UE_<b>1</b> <b>701</b> and UE_<b>2</b> <b>704</b>, nor the ability to modify integrity-protected communications between UE_<b>1</b> <b>701</b> and UE_<b>2</b> <b>704</b>.</p><p id="p-0123" num="0127">In step <b>4</b><i>d </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>1</b> <b>701</b> sends a fourth DSMComp message to UE_<b>2</b> <b>704</b>.</p><p id="p-0124" num="0128">In step <b>4</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, UE_<b>2</b> <b>704</b> sends a fourth DCA message to UE_<b>1</b> <b>701</b>.</p><p id="p-0125" num="0129">After all steps of <figref idref="DRAWINGS">FIG. <b>7</b></figref> are completed, secure communication is available between each pair of adjacent UEs (that is, between UE_<b>1</b> <b>701</b> and UE_R<b>1</b> <b>702</b>; between UE_R<b>1</b> <b>702</b> and UE_R<b>2</b> <b>703</b>; and between UE_R<b>2</b> <b>703</b> and UE_<b>2</b> <b>704</b>), as well as between the remote UEs UE_<b>1</b> <b>701</b> and UE_<b>2</b> <b>704</b>.</p><p id="p-0126" num="0130">In some embodiments, it may be possible to reduce the number of separate nonces produced by the participants in the connection establishment. <figref idref="DRAWINGS">FIG. <b>8</b></figref> shows message flow <b>800</b> that is a variation of the message flow of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, in which UE_<b>1</b> <b>701</b> provides only a single nonce that can be used in the generation of a session key for the direct connection to the first relay UE <b>702</b> (K<sub>D-sess </sub>(<b>1</b>,R<b>1</b>) in the figure) and also in the generation of a session key for the end-to-end connection to the peer remote UE <b>704</b> (K<sub>D-sess </sub>(<b>1</b>,<b>2</b>) in <figref idref="DRAWINGS">FIG. <b>8</b></figref>), while maintaining key separation.</p><p id="p-0127" num="0131">Most of the steps of <figref idref="DRAWINGS">FIG. <b>8</b></figref> are identical to those of <figref idref="DRAWINGS">FIG. <b>7</b></figref>. However, in step <b>1</b> of <figref idref="DRAWINGS">FIG. <b>8</b></figref>, UE_<b>1</b> <b>701</b> provides only a single nonce Nonce_UE<b>1</b> and a single signature Sig_UE<b>1</b> (covering at least the ID of UE_<b>1</b> <b>701</b> and Nonce_UE<b>1</b>). In step <b>1</b><i>a </i>of <figref idref="DRAWINGS">FIG. <b>8</b></figref>, UE_R<b>1</b> <b>702</b> checks the signature Sig_UE<b>1</b> to confirm the identity of UE_<b>1</b> <b>701</b> and the accuracy of the DCR message from step <b>1</b> of <figref idref="DRAWINGS">FIG. <b>8</b></figref>, and generates the root key K<sub>D</sub>(<b>1</b>,R<b>1</b>). In step <b>1</b><i>b </i>of <figref idref="DRAWINGS">FIG. <b>8</b></figref>, UE_R<b>1</b> <b>702</b> sends a DSMC message containing the generated K<sub>D</sub>(<b>1</b>,R<b>1</b>) (ciphered), a nonce Hop_Nonce<b>1</b>_UER<b>1</b>, and a signature Hop_Sig<b>1</b>_UER<b>1</b> that covers at least the ID of UE_R<b>1</b> and Hop_Nonce<b>1</b>_UER<b>1</b>. (The signature might reasonably be expected also to cover the ciphered key K<sub>D</sub>(<b>1</b>,R<b>1</b>), but in some embodiments this may not be necessary, e.g., if the mechanism used to protect the root key also provides a signature.) In step <b>1</b><i>c </i>of <figref idref="DRAWINGS">FIG. <b>8</b></figref>, UE_<b>1</b> <b>701</b> and UE_R<b>1</b> <b>702</b> use Nonce_UE<b>1</b> and Hop_Nonce<b>1</b>_UER<b>1</b> to generate a session key K<sub>D-sess </sub>(<b>1</b>,R<b>1</b>). It is noted that in a subsequent step, the same nonce Nonce_UE<b>1</b> will be used to generate a session key between UE_<b>1</b> <b>701</b> and UE_<b>2</b> <b>704</b>; however, key separation can be maintained, because step <b>1</b><i>c </i>of <figref idref="DRAWINGS">FIG. <b>8</b></figref> also depends on Hop_Nonce<b>1</b>_UER<b>1</b>, while the subsequent step to generate the end-to-end session key will depend on a different nonce provided by UE_<b>2</b> <b>704</b>.</p><p id="p-0128" num="0132">In step <b>2</b> of <figref idref="DRAWINGS">FIG. <b>8</b></figref>, UE_R<b>1</b> <b>702</b> forwards the DCR message with additional information, comprising at least an identity of UE_R<b>1</b> <b>702</b>, a nonce Hop_Nonce<b>2</b>_UER<b>1</b>, and a signature Hop_Sig<b>2</b>_UER<b>1</b>; the signature covers at least the identity of UE_R<b>1</b> <b>702</b> and Hop_Nonce<b>2</b>_UER<b>1</b>. Steps <b>2</b><i>a </i>through <b>2</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>8</b></figref> then proceed as in <figref idref="DRAWINGS">FIG. <b>7</b></figref>.</p><p id="p-0129" num="0133">In step <b>3</b> of <figref idref="DRAWINGS">FIG. <b>8</b></figref>, UE_R<b>2</b> <b>703</b> forwards the DCR message with additional information, comprising at least an identity of UE_R<b>2</b> <b>703</b>, a nonce Hop_Nonce<b>2</b>_UER<b>2</b>, and a signature Hop_Sig<b>2</b>_UER<b>2</b>; the signature covers at least the identity of UE_R<b>2</b> <b>702</b> and Hop_Nonce<b>2</b>_UER<b>2</b>. It is noted that the forwarded DCR messages of steps <b>2</b> and <b>3</b> contain all the original information of the DCR message from step <b>1</b>, along with additional security information provided by the intervening relay UEs; each forwarded DCR might be construed as containing a remote ID (the ID of UE_<b>1</b> <b>701</b>), a remote nonce (Nonce_UE<b>1</b>), a remote signature (Sig_UE<b>1</b>), a relay ID (the ID of the forwarding relay UE, either UE_R<b>1</b> <b>702</b> or UE_R<b>2</b> <b>703</b>), a relay nonce (Hop_Nonce<b>2</b>_UER<b>1</b> or Hop_Nonce<b>2</b>_UER<b>2</b>), and a relay signature (Hop_Sig<b>2</b>_UER<b>1</b> or Hop_Sig<b>2</b>_UER<b>2</b>). Steps <b>3</b><i>a </i>through <b>3</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>8</b></figref> then proceed as in <figref idref="DRAWINGS">FIG. <b>7</b></figref>.</p><p id="p-0130" num="0134">Steps <b>4</b><i>a </i>through <b>4</b><i>e </i>of <figref idref="DRAWINGS">FIG. <b>8</b></figref> proceed as in <figref idref="DRAWINGS">FIG. <b>7</b></figref>. The original remote nonce Nonce_UE<b>1</b> is used in step <b>4</b><i>c </i>to derive the end-to-end session key K<sub>D-sess </sub>(<b>1</b>,<b>2</b>); as noted above, the same nonce was used in step <b>1</b><i>c </i>for generation of K<sub>D-sess </sub>(<b>1</b>,R<b>1</b>), but in step <b>4</b><i>c</i>, the use of E<b>2</b>E_Nonce_UE<b>2</b> distinguishes the key derivation inputs from those used in step <b>1</b><i>c. </i></p><p id="p-0131" num="0135"><figref idref="DRAWINGS">FIG. <b>9</b></figref> shows the processes of forming the signatures during the connection setup and security establishment process <b>800</b>. The original DCR transmitted from the initiating UE <b>701</b> to the relay UE <b>702</b> can carry a remote signature. The remote signature can be formed at UE <b>701</b> based on the remote ID of UE <b>701</b> and the remote nonce generated at UE <b>701</b>. The forwarded DCR transmitted from the relay UE <b>702</b> to the relay UE <b>703</b> can carry two signatures: the remote signature formed at UE <b>701</b> and a relay signature. The relay signature can be formed at UE <b>702</b> based on the relay ID of UE <b>702</b> and the relay nonce generated at UE <b>702</b>. Similarly, the forwarded DCR transmitted from the relay UE <b>703</b> to the target UE <b>704</b> can carry two signatures: the remote signature formed at UE <b>701</b> and another relay signature. The relay signature can be formed at UE <b>703</b> based on the relay ID of UE <b>703</b> and the relay nonce generated at UE <b>703</b>.</p><p id="p-0132" num="0136">In the foregoing procedures, security is established at each hop as soon as the original DCR message is forwarded. This is efficient if the involved relay UEs are already aware of a route to UE_<b>2</b>. For instance, if UE_R<b>1</b> <b>702</b>, UE_R<b>2</b> <b>703</b>, and UE_<b>2</b> <b>704</b> are already involved in communication (e.g., as members of a mesh network) and UE_<b>1</b> <b>701</b> initiates communication in order to join the network. However, in some embodiments, it may be preferable to determine the route dynamically once the initial DCR is received, so that, e.g., UE_R<b>1</b> <b>702</b> does not establish hop-by-hop secure communication with UE_<b>1</b> <b>701</b> until UE_R<b>1</b> <b>702</b> knows that it has a route to UE_<b>2</b> <b>704</b>. A general flow <b>1000</b> for such a procedure is shown in <figref idref="DRAWINGS">FIG. <b>10</b></figref>.</p><p id="p-0133" num="0137">The actual steps of <figref idref="DRAWINGS">FIG. <b>10</b></figref> are identical to those of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, but in a different order. The numbering is preserved from <figref idref="DRAWINGS">FIG. <b>7</b></figref>, so that steps <b>1</b>-<b>1</b><i>e </i>establish communication between UE_<b>1</b> and UE_R<b>1</b>, steps <b>2</b>-<b>2</b><i>e </i>establish communication between UE_R<b>1</b> and UE_R<b>2</b>, and so on. However, in contrast to <figref idref="DRAWINGS">FIG. <b>7</b></figref>, each relay performs forwarding of the DCR message after or immediately after confirming the signature of its predecessor&#x2014;for example, step <b>2</b> (in which UE_R<b>1</b> <b>702</b> sends the DCR message to UE_R<b>2</b> <b>703</b>) takes place after step <b>1</b><i>a </i>(in which UE_R<b>1</b> <b>702</b> confirms the identity of UE_<b>1</b> <b>701</b>) rather than waiting until UE_R<b>1</b> <b>702</b> has exchanged security signalling and finished connection establishment with UE_<b>1</b> <b>701</b>. Only after the completion of step <b>2</b><i>e</i>, when UE_R<b>2</b> <b>703</b> has accepted communication with UE_R<b>1</b> <b>702</b>, does UE_R<b>1</b> <b>702</b> proceed to establish security and accept communication with UE_<b>1</b> <b>701</b> (steps <b>1</b><i>b</i>-<b>1</b><i>e</i>).</p><p id="p-0134" num="0138">It is noted that in <figref idref="DRAWINGS">FIG. <b>10</b></figref>, there is no explicit trigger for step <b>4</b><i>a </i>(the first step in the establishment of the end-to-end connection between UE_<b>1</b> <b>701</b> and UE_<b>2</b> <b>704</b>). In fact, UE_<b>2</b> <b>704</b> may trigger steps <b>4</b><i>a </i>and <b>4</b><i>b </i>at any time after step <b>3</b><i>e</i>, when UE_<b>2</b> <b>704</b> establishes communication with UE_R<b>2</b> <b>703</b>. This means that the DSMC message in step <b>4</b><i>b </i>may be transmitted before all intervening hop-by-hop connections have been established. For example, UE_R<b>2</b> <b>703</b> may receive the DSMC message of step <b>4</b><i>b </i>while it is still in the process of executing steps <b>2</b><i>b</i>-<b>2</b><i>e</i>. In such a case, UE_R<b>2</b> <b>703</b> may delay the forwarding of the DSMC message until step <b>2</b><i>e </i>has completed.</p><p id="p-0135" num="0139">The steps of <figref idref="DRAWINGS">FIG. <b>8</b></figref> may be reordered in the corresponding manner, so that each instance of the DCR message is forwarded before completing establishment of the preceding hop-by-hop connection.</p><p id="p-0136" num="0140">The procedure of <figref idref="DRAWINGS">FIG. <b>10</b></figref>, or the equivalent procedure derived from <figref idref="DRAWINGS">FIG. <b>8</b></figref>, may be viewed as integrating relay discovery and/or route determination into the connection establishment procedure. If such a procedure is used without prior determination of the network topology, it is beneficial to have a means to limit the forwarding of the initial DCR message. Otherwise, potential relay UEs that have no route to UE_<b>2</b> may forward copies of the DCR message among themselves more or less indefinitely, causing overhead in the network. One mechanism to limit such forwarding is to associate a maximum hop count with the original DCR sent by UE_<b>1</b> <b>701</b>. Each relay UE that receives the DCR may decrement the hop count, and forward the message to its peers only if the remaining hop count is greater than a threshold (e.g., greater than zero). This approach may have the salutary effect of bounding the latency of the path from UE_<b>1</b> <b>701</b> to UE_<b>2</b> <b>704</b> that is ultimately discovered; for example, if UE_<b>1</b> <b>701</b> wishes to establish communication with UE_<b>2</b> <b>704</b> for a service that requires low latency, it may send the initial DCR message with a correspondingly low maximum hop count, while for a latency-tolerant service, the maximum hop count may be larger. The exact method of selection of the hop count may be specified as a function of the quality of service (QoS) requirements of the desired service, or it may be left to UE_<b>1</b>'s implementation to determine an appropriate hop count.</p><p id="p-0137" num="0141"><figref idref="DRAWINGS">FIG. <b>11</b></figref> shows an example of a security establishment process <b>1100</b> according to an embodiment of the disclosure. The method can be performed at a relay UE for establishing a secure connection between an initiating UE and a target UE. The method can start from S<b>1101</b> and proceed to S<b>1110</b>.</p><p id="p-0138" num="0142">At S<b>1110</b>, a communication request message for establishing the connection between the initiating UE and the target UE can be received at the relay UE from a first neighbor UE of the relay UE. The communication request message can include first security-establishment-related information originating from the initiating UE. The first security-establishment-related information can be used for establishing a security association between the initiating UE and the target UE.</p><p id="p-0139" num="0143">At S<b>1120</b>, the communication request message can be modified to add second security-establishment-related information. The second security-establishment-related information can be used for establishing a security association between the relay UE and a second neighbor UE.</p><p id="p-0140" num="0144">At S<b>1130</b>, the modified communication request message can be transmitted to the second neighbor UE. The second security-establishment-related information can include (1) the first security-establishment-related information originating from the initiating UE for establishing the security association between the initiating UE and the target UE and (2) the second security-establishment-related information added by the relay UE for establishing the security association between the relay UE and the second neighbor UE. The process <b>1100</b> can proceed to S<b>1199</b> and terminates at S<b>1199</b>.</p><p id="p-0141" num="0145"><figref idref="DRAWINGS">FIG. <b>12</b></figref> shows another example of a security establishment process <b>1200</b> according to an embodiment of the disclosure. The method can be performed at a target UE for establishing a secure connection between an initiating UE and the target UE. The method can start from S<b>1201</b> and proceed to S<b>1210</b>.</p><p id="p-0142" num="0146">At S<b>1210</b>, a communication request message for establishing a connection between an initiating UE and the target UE via the relay UE can be received at the target UE from a relay UE. For example, the communication request message including (2) first security-establishment-related information initiated from the initiating UE for establishing a security association between the initiating UE and the target UE and (2) second security-establishment-related information originating from the relay UE for establishing a security association between the relay UE and target UE.</p><p id="p-0143" num="0147">At S<b>1220</b>, a secure connection can be established between the relay UE and the target UE based on the second security-establishment-related information originating from the relay UE.</p><p id="p-0144" num="0148">At S<b>1230</b>, an authentication with the initiating UE can be performed based on the first security-establishment-related information originating from the initiating UE to determine a root key for communications between the initiating UE and the target UE.</p><p id="p-0145" num="0149">At S<b>1240</b>, a security mode control process with the initiating UE based on the first security-establishment-related information originating from the initiating UE can be initiated to establish a security association between the initiating UE and the target UE. A security mode control command message for the initiating UE can be transmitted to the relay UE over the secure connection between the relay UE and the target UE. The process <b>1200</b> can proceed to S<b>1299</b> and terminate at S<b>1299</b>.</p><p id="p-0146" num="0150"><figref idref="DRAWINGS">FIG. <b>13</b></figref> shows an exemplary apparatus <b>1300</b> according to embodiments of the disclosure. The apparatus <b>1300</b> can be configured to perform various functions in accordance with one or more embodiments or examples described herein. Thus, the apparatus <b>1300</b> can provide the means for the implementation of mechanisms, techniques, processes, functions, components, and systems described herein. For example, the apparatus <b>1300</b> can be used to implement functions of UEs in various embodiments and examples described herein. The apparatus <b>1300</b> can include a general-purpose processor or specially designed circuits to implement various functions, components, or processes described herein in various embodiments. The apparatus <b>1300</b> can include processing circuitry <b>1310</b>, a memory <b>1320</b>, and a radio frequency (RF) module <b>1330</b>.</p><p id="p-0147" num="0151">In various examples, the processing circuitry <b>1310</b> can include circuitry configured to perform the functions and processes described herein in combination with software or without software. In various examples, the processing circuitry <b>1310</b> can be a digital signal processor (DSP), an application-specific integrated circuit (ASIC), programmable logic devices (PLDs), field-programmable gate arrays (FPGAs), digitally enhanced circuits, or comparable device or a combination thereof.</p><p id="p-0148" num="0152">In some other examples, the processing circuitry <b>1310</b> can be a central processing unit (CPU) configured to execute program instructions to perform various functions and processes described herein. Accordingly, the memory <b>1320</b> can be configured to store program instructions. The processing circuitry <b>1310</b>, when executing the program instructions, can perform the functions and processes. The memory <b>1320</b> can further store other programs or data, such as operating systems, application programs, and the like. The memory <b>1320</b> can include non-transitory storage media, such as a read-only memory (ROM), a random access memory (RAM), a flash memory, a solid-state memory, a hard disk drive, an optical disk drive, and the like.</p><p id="p-0149" num="0153">In an embodiment, the RF module <b>1330</b> receives a processed data signal from the processing circuitry <b>1310</b> and converts the data signal to beamforming wireless signals that are then transmitted via antenna arrays <b>1340</b>, or vice versa. The RF module <b>1330</b> can include a digital to analog converter (DAC), an analog to digital converter (ADC), a frequency up converter, a frequency down converter, filters and amplifiers for reception and transmission operations. The RF module <b>1330</b> can include multi-antenna circuitry for beamforming operations. For example, the multi-antenna circuitry can include an uplink spatial filter circuit, and a downlink spatial filter circuit for shifting analog signal phases or scaling analog signal amplitudes. The antenna arrays <b>1340</b> can include one or more antenna arrays.</p><p id="p-0150" num="0154">The apparatus <b>1300</b> can optionally include other components, such as input and output devices, additional or signal processing circuitry, and the like. Accordingly, the apparatus <b>1300</b> may be capable of performing other additional functions, such as executing application programs, and processing alternative communication protocols.</p><p id="p-0151" num="0155">The processes and functions described herein can be implemented as a computer program which, when executed by one or more processors, can cause the one or more processors to perform the respective processes and functions. The computer program may be stored or distributed on a suitable medium, such as an optical storage medium or a solid-state medium supplied together with, or as part of, other hardware. The computer program may also be distributed in other forms, such as via the Internet or other wired or wireless telecommunication systems. For example, the computer program can be obtained and loaded into an apparatus, including obtaining the computer program through physical medium or distributed system, including, for example, from a server connected to the Internet.</p><p id="p-0152" num="0156">The computer program may be accessible from a computer-readable medium providing program instructions for use by or in connection with a computer or any instruction execution system. The computer-readable medium may include any apparatus that stores, communicates, propagates, or transports the computer program for use by or in connection with an instruction execution system, apparatus, or device. The computer-readable medium can be magnetic, optical, electronic, electromagnetic, infrared, or semiconductor system (or apparatus or device) or a propagation medium. The computer-readable medium may include a computer-readable non-transitory storage medium such as a semiconductor or solid-state memory, magnetic tape, a removable computer diskette, a random access memory (RAM), a read-only memory (ROM), a magnetic disk and an optical disk, and the like. The computer-readable non-transitory storage medium can include all types of computer-readable medium, including magnetic storage medium, optical storage medium, flash medium, and solid-state storage medium.</p><p id="p-0153" num="0157">While aspects of the present disclosure have been described in conjunction with the specific embodiments thereof that are proposed as examples, alternatives, modifications, and variations to the examples may be made. Accordingly, embodiments as set forth herein are intended to be illustrative and not limiting. There are changes that may be made without departing from the scope of the claims set forth below.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A method of a relay user equipment (UE), comprising:<claim-text>receiving, at the relay UE, from a first neighbor UE, a communication request message for establishing a connection between an initiating UE and a target UE, the communication request message including first security-establishment-related information originating from the initiating UE for establishing a security association between the initiating UE and the target UE;</claim-text><claim-text>modifying the communication request message to add second security-establishment-related information for establishing a security association between the relay UE and a second neighbor UE; and</claim-text><claim-text>transmitting to the second neighbor UE the modified communication request message that includes<claim-text>the first security-establishment-related information originating from the initiating UE for establishing the security association between the initiating UE and the target UE, and</claim-text><claim-text>the second security-establishment-related information added by the relay UE for establishing the security association between the relay UE and the second neighbor UE.</claim-text></claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first neighbor UE is the initiating UE, and the method further comprises:<claim-text>performing an authentication based on the first security-establishment-related information originating from the initiating UE to determine a root key for communications between the first neighbor UE and the relay UE; and</claim-text><claim-text>initiating a security mode control process based on the first security-establishment-related information originating from the initiating UE to establish a security association between the first neighbor UE and the relay UE.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the communication request message includes third security-establishment-related information originating from the first neighbor UE for establishing a security association between the first neighbor UE and the relay UE, and<claim-text>the modifying comprises:<claim-text>replacing the third security-establishment-related information originating from the first neighbor UE with the second security-establishment-related information for establishing the security association between the relay UE and the second neighbor UE.</claim-text></claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref>, further comprising:<claim-text>performing an authentication based on the third security-establishment-related information originating from the first neighbor UE to determine a root key for communications between the first neighbor UE and the relay UE; and</claim-text><claim-text>initiating a security mode control process based on the third security-establishment-related information originating from the first neighbor UE to establish a security association between the first neighbor UE and the relay UE.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>in response to receiving a request of a security mode control process from the second neighbor UE, initiating a security mode control process to establish a security association between the first neighbor UE and the relay UE based on one of<claim-text>the first security-establishment-related information originating from the initiating UE, and</claim-text><claim-text>third security-establishment-related information originating from the first neighbor UE and included in the communication request message.</claim-text></claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first security-establishment-related information originating from the initiating UE includes first user information of the initiating UE, a first nonce generated at the initiating UE, and a first signature covering the first user information of the initiating UE and the first nonce generated at the initiating UE, and<claim-text>the second security-establishment-related information added by the relay UE includes second user information of the relay UE, a second nonce generated at the relay UE, and a second signature covering the second user information of the relay UE and the second nonce generated at the relay UE.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the communication request message includes third security-establishment-related information originating from the first neighbor UE for establishing a security association between the first neighbor UE and the relay UE,<claim-text>the third security-establishment-related information originating from the first neighbor UE includes third user information of the first neighbor UE, a third nonce generated at the first neighbor UE, and a third signature covering the third user information of the first neighbor UE and the third nonce generated at the first neighbor UE, and</claim-text><claim-text>the modifying comprises:<claim-text>replacing the third nonce and the third signature covering the third user information of the first neighbor UE and the third nonce with the second nonce and the second signature covering the second user information of the relay UE and the second nonce.</claim-text></claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, further comprising:<claim-text>authenticating the first neighbor UE based on one of<claim-text>the first signature covering the first user information of the initiating UE and the first nonce generated at the initiating UE, and</claim-text><claim-text>a third signature covering a third user of the first neighbor UE and a third nonce generated at the first neighbor UE.</claim-text></claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, further comprising:<claim-text>transmitting to the first neighbor UE a security mode command message that includes<claim-text>a root key for communications between the first neighbor UE and the relay UE,</claim-text><claim-text>a fourth nonce generated at the relay UE for a connection between the first neighbor UE and the relay UE, and</claim-text><claim-text>a fourth signature covering the fourth nonce generated at the relay UE for the connection between the first neighbor UE and the relay UE.</claim-text></claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref> further comprising:<claim-text>deriving a session key for the connection between the first neighbor UE and the relay UE based on<claim-text>the root key for communications between the first neighbor UE and the relay UE,</claim-text><claim-text>the fourth nonce generated at the relay UE for the connection between the first neighbor UE and the relay UE, and</claim-text><claim-text>one of the first nonce generated at the initiating UE and a third nonce generated at the first neighbor UE.</claim-text></claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, further comprising:<claim-text>receiving from the second neighbor UE a security mode command message that includes<claim-text>a root key for communications between the second neighbor UE and the relay UE,</claim-text><claim-text>a fifth nonce generated at the second neighbor UE for a connection between the second neighbor UE and the relay UE, and</claim-text><claim-text>a fifth signature covering the fifth nonce generated at the second neighbor UE for the connection between the second neighbor UE and the relay UE; and</claim-text></claim-text><claim-text>authenticating the second neighbor UE based on the fifth signature covering the fifth nonce generated at the second neighbor UE for the connection between the second neighbor UE and the relay UE.</claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref>, further comprising:<claim-text>deriving a session key for the connection between the second neighbor UE and the relay UE based on<claim-text>the root key for communications between the second neighbor UE and the relay UE,</claim-text><claim-text>the fifth nonce generated at the second neighbor UE for the connection between the second neighbor UE and the relay UE, and</claim-text><claim-text>the second nonce generated at the relay UE.</claim-text></claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the second neighbor UE is the target UE.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. A method of a target user equipment (UE), comprising:<claim-text>receiving, at the target UE from a relay UE, a communication request message for establishing a connection between an initiating UE and the target UE via the relay UE, the communication request message including<claim-text>first security-establishment-related information initiated from the initiating UE for establishing a security association between the initiating UE and the target UE, and</claim-text><claim-text>second security-establishment-related information originating from the relay UE for establishing a security association between the relay UE and target UE;</claim-text></claim-text><claim-text>establishing a secure connection between the relay UE and the target UE based on the second security-establishment-related information originating from the relay UE;</claim-text><claim-text>performing an authentication based on the first security-establishment-related information originating from the initiating UE to determine a root key for communications between the initiating UE and the target UE; and</claim-text><claim-text>initiating a security mode control process with the initiating UE based on the first security-establishment-related information originating from the initiating UE to establish a security association between the initiating UE and the target UE, wherein a security mode control command message for the initiating UE is transmitted to the relay UE over the secure connection between the relay UE and the target UE.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the first security-establishment-related information originating from the initiating UE includes a first user information of the initiating UE, a first nonce generated at the initiating UE, and a first signature covering the first user information of the initiating UE and the first nonce generated at the initiating UE, and<claim-text>the second security-establishment-related information originating from the relay UE includes second user information of the relay UE, a second nonce generated at the relay UE, and a second signature covering the second user information of the relay UE and the second nonce generated at the relay UE.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the establishing includes:<claim-text>authenticating the relay UE based on the second signature covering the second user information of the relay UE and the second nonce generated at the relay UE;</claim-text><claim-text>determining a root key for communications between the relay UE and the target UE;</claim-text><claim-text>determining a session key for the secure connection between the relay UE and the target UE based on the second nonce generated at the relay UE, a third nonce generated at the target UE, and the root key; and</claim-text><claim-text>transmitting to the relay UE a security mode control command message that includes the third nonce generated at the target UE, a third signature covering the third nonce generated at the target UE, and the root key that is encrypted.</claim-text></claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the performing the authentication includes:<claim-text>authenticating the initiating UE based on the first signature covering the first user information of the initiating UE and the first nonce generated at the initiating UE; and</claim-text><claim-text>determining a root key for communications between the initiating UE and the target UE.</claim-text></claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the security mode control command message for the initiating UE includes:<claim-text>a fourth nonce generated at the target UE, a fourth signature covering the fourth nonce generated at the target UE, and the root key that is encrypted.</claim-text></claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, further comprising:<claim-text>determining a session key for a connection between the initiating UE and the target UE based on the first nonce generated at the initiating UE, the fourth nonce generated at the target UE, and the root key for communications between the initiating UE and the target UE.</claim-text></claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. A relay user equipment (UE), comprising circuitry configured to:<claim-text>receive, at the relay UE, from a first neighbor UE, a communication request message for establishing a connection between an initiating UE and a target UE, the communication request message including first security-establishment-related information originating from the initiating UE for establishing a security association between the initiating UE and the target UE;</claim-text><claim-text>modify the communication request message to add second security-establishment-related information for establishing a security association between the relay UE and a second neighbor UE; and</claim-text><claim-text>transmit to the second neighbor UE the modified communication request message that includes<claim-text>the first security-establishment-related information originating from the initiating UE for establishing the security association between the initiating UE and the target UE, and</claim-text><claim-text>the second security-establishment-related information added by the relay UE for establishing the security association between the relay UE and the second neighbor UE.</claim-text></claim-text></claim-text></claim></claims></us-patent-application>