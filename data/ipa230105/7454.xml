<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007455A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007455</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17837742</doc-number><date>20220610</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>4</main-group><subgroup>40</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>40</main-group><subgroup>22</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>76</main-group><subgroup>10</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>106</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20180201</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>4</main-group><subgroup>40</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>40</main-group><subgroup>22</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20180201</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>76</main-group><subgroup>10</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>106</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">METHOD AND APPARATUS FOR RECEIVING PC5 SIGNALING (PC5-S) MESSAGES IN A WIRELESS COMMUNICATION SYSTEM</invention-title><us-related-documents><us-provisional-application><document-id><country>US</country><doc-number>63217503</doc-number><date>20210701</date></document-id></us-provisional-application></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>ASUSTek Computer Inc.</orgname><address><city>Taipei City 112</city><country>TW</country></address></addressbook><residence><country>TW</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Kuo</last-name><first-name>Richard Lee-Chee</first-name><address><city>Taipei City</city><country>TW</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A method and device are disclosed for PC5 Signaling (PC5-S) message reception from the perspective of a UE-to-UE relay. The UE-to-UE relay receives a first PC5-S message on a first sidelink Signal Radio Bearer (SRB) from a first UE, wherein the first PC5-S message is used to establish a first sidelink security between the UE-to-UE relay and the first UE, to update link identifier(s) associated with a first link between the first UE and the UE-to-UE relay, or to modify the first link between the first UE and the UE-to-UE relay. The UE-to-UE relay also delivers the first PC5-S message to an upper layer of the UE-to-UE relay.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="80.35mm" wi="117.09mm" file="US20230007455A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="114.55mm" wi="119.13mm" file="US20230007455A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="206.16mm" wi="142.66mm" orientation="landscape" file="US20230007455A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="183.64mm" wi="105.41mm" file="US20230007455A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="172.13mm" wi="102.28mm" file="US20230007455A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="211.41mm" wi="129.96mm" orientation="landscape" file="US20230007455A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="181.69mm" wi="159.94mm" file="US20230007455A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="141.14mm" wi="161.12mm" file="US20230007455A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="212.51mm" wi="152.48mm" file="US20230007455A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="102.95mm" wi="135.89mm" file="US20230007455A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="93.73mm" wi="142.58mm" file="US20230007455A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="125.65mm" wi="132.84mm" file="US20230007455A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="203.79mm" wi="58.50mm" orientation="landscape" file="US20230007455A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00013" num="00013"><img id="EMI-D00013" he="137.75mm" wi="90.68mm" orientation="landscape" file="US20230007455A1-20230105-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00014" num="00014"><img id="EMI-D00014" he="215.82mm" wi="138.94mm" orientation="landscape" file="US20230007455A1-20230105-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00015" num="00015"><img id="EMI-D00015" he="183.30mm" wi="154.86mm" orientation="landscape" file="US20230007455A1-20230105-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00016" num="00016"><img id="EMI-D00016" he="187.71mm" wi="130.39mm" orientation="landscape" file="US20230007455A1-20230105-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00017" num="00017"><img id="EMI-D00017" he="168.57mm" wi="144.61mm" orientation="landscape" file="US20230007455A1-20230105-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00018" num="00018"><img id="EMI-D00018" he="189.65mm" wi="129.88mm" orientation="landscape" file="US20230007455A1-20230105-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00019" num="00019"><img id="EMI-D00019" he="185.25mm" wi="128.69mm" orientation="landscape" file="US20230007455A1-20230105-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00020" num="00020"><img id="EMI-D00020" he="170.52mm" wi="74.59mm" orientation="landscape" file="US20230007455A1-20230105-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00021" num="00021"><img id="EMI-D00021" he="199.90mm" wi="171.03mm" file="US20230007455A1-20230105-D00021.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading><p id="p-0002" num="0001">The present Application claims the benefit of U.S. Provisional Patent Application Ser. No. 63/217,503 filed on Jul. 1, 2021, the entire disclosure of which is incorporated herein in its entirety by reference.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">FIELD</heading><p id="p-0003" num="0002">This disclosure generally relates to wireless communication networks, and more particularly, to a method and apparatus for receiving PC5-S messages in a wireless communication system.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">With the rapid rise in demand for communication of large amounts of data to and from mobile communication devices, traditional mobile voice communication networks are evolving into networks that communicate with Internet Protocol (IP) data packets. Such IP data packet communication can provide users of mobile communication devices with voice over IP, multimedia, multicast and on-demand communication services.</p><p id="p-0005" num="0004">An exemplary network structure is an Evolved Universal Terrestrial Radio Access Network (E-UTRAN). The E-UTRAN system can provide high data throughput in order to realize the above-noted voice over IP and multimedia services. A new radio technology for the next generation (e.g., 5G) is currently being discussed by the 3GPP standards organization. Accordingly, changes to the current body of 3GPP standard are currently being submitted and considered to evolve and finalize the 3GPP standard.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0006" num="0005">A method and device are disclosed for PC5 Signaling (PC5-S) message reception from the perspective of a UE-to-UE relay. In one embodiment, the UE-to-UE relay receives a first PC5-S message on a first sidelink Signal Radio Bearer (SRB) from a first UE, wherein the first PC5-S message is used to establish a first sidelink security between the UE-to-UE relay and the first UE, to update link identifier(s) associated with a first link between the first UE and the UE-to-UE relay, or to modify the first link between the first UE and the UE-to-UE relay. The UE-to-UE relay also delivers the first PC5-S message to an upper layer of the UE-to-UE relay. In addition, the UE-to-UE relay receives a second PC5-S message on a second sidelink SRB from the first UE, wherein the second PC5-S message is used to establish a second sidelink security between the first UE and a second UE, to update link identifier(s) associated with a second link between the first UE and the second UE, or to modify the second link between the first UE and the second UE. Furthermore, the UE-to-UE relay transmits or forwards the second PC5-S message to the second UE.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0007" num="0006"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows a diagram of a wireless communication system according to one exemplary embodiment.</p><p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a block diagram of a transmitter system (also known as access network) and a receiver system (also known as user equipment or UE) according to one exemplary embodiment.</p><p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a functional block diagram of a communication system according to one exemplary embodiment.</p><p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a functional block diagram of the program code of <figref idref="DRAWINGS">FIG. <b>3</b></figref> according to one exemplary embodiment.</p><p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>5</b>.<b>2</b></figref>.<b>1</b>.<b>4</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0.</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>1</b></figref>.<b>1</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>1</b></figref>.<b>2</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>3</b></figref>.<b>3</b>.<b>1</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0.</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>3</b></figref>.<b>3</b>.<b>2</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0.</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>3</b></figref>.<b>3</b>.<b>4</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0.</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>11</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>2</b></figref>.<b>2</b>.<b>1</b>-<b>1</b> of 3GPP TS 38.323 V16.0.0.</p><p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. <b>12</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>9</b></figref>.<b>1</b>.<b>2</b>-<b>1</b> of 3GPP TR 23.752 V0.4.0.</p><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>13</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>9</b></figref>.<b>1</b>.<b>2</b>-<b>2</b> of 3GPP TR 23.752 V0.4.0.</p><p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. <b>14</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>9</b></figref>.<b>2</b>-<b>1</b> of 3GPP TR 23.752 V0.4.0.</p><p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. <b>15</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>9</b></figref>.<b>2</b>.<b>2</b>-<b>1</b> of 3GPP TR 23.752 V0.4.0.</p><p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. <b>16</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>31</b></figref>.<b>2</b>-<b>1</b> of 3GPP TR 23.752 V0.4.0.</p><p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. <b>17</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>31</b></figref>.<b>3</b>-<b>1</b> of 3GPP TR 23.752 V0.4.0.</p><p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. <b>18</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>5</b>.<b>5</b></figref>.<b>1</b>-<b>1</b> of 3GPP TR 38.836 V1.0.0.</p><p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. <b>19</b></figref> is a reproduction of <figref idref="DRAWINGS">FIG. <b>5</b>.<b>5</b></figref>.<b>1</b>-<b>2</b> of 3GPP TR 38.836 V1.0.0.</p><p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. <b>20</b></figref> is a diagram according to one exemplary embodiment.</p><p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. <b>21</b></figref> is a flow chart according to one exemplary embodiment.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION</heading><p id="p-0028" num="0027">The exemplary wireless communication systems and devices described below employ a wireless communication system, supporting a broadcast service. Wireless communication systems are widely deployed to provide various types of communication such as voice, data, and so on. These systems may be based on code division multiple access (CDMA), time division multiple access (TDMA), orthogonal frequency division multiple access (OFDMA), 3GPP LTE (Long Term Evolution) wireless access, 3GPP LTE-A or LTE-Advanced (Long Term Evolution Advanced), 3GPP2 UMB (Ultra Mobile Broadband), WiMax, 3GPP NR (New Radio), or some other modulation techniques.</p><p id="p-0029" num="0028">In particular, the exemplary wireless communication systems and devices described below may be designed to support one or more standards such as the standard offered by a consortium named &#x201c;3rd Generation Partnership Project&#x201d; referred to herein as 3GPP, including: TS 23.287 V16.2.0, &#x201c;Architecture enhancements for 5G System (5GS) to support Vehicle-to-Everything (V2X) services (Release 16)&#x201d;; TS 38.323 V16.0.0, &#x201c;NR; Packet Data Convergence Protocol (PDCP) specification (Release 16)&#x201d;; TS 38.331 V16.0.0, &#x201c;NR; Radio Resource Control (RRC) protocol specification (Release 16)&#x201d;; TR 23.752 V0.4.0, &#x201c;Study on system enhancement for Proximity based services (ProSe) in the 5G System (5GS) (Release 17)&#x201d;; and TR 38.836 V1.0.0, &#x201c;Study on NR sidelink relay (Release 17)&#x201d;. The standards and documents listed above are hereby expressly incorporated by reference in their entirety.</p><p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows a multiple access wireless communication system according to one embodiment of the invention. An access network <b>100</b> (AN) includes multiple antenna groups, one including <b>104</b> and <b>106</b>, another including <b>108</b> and <b>110</b>, and an additional including <b>112</b> and <b>114</b>. In <figref idref="DRAWINGS">FIG. <b>1</b></figref>, only two antennas are shown for each antenna group, however, more or fewer antennas may be utilized for each antenna group. Access terminal <b>116</b> (AT) is in communication with antennas <b>112</b> and <b>114</b>, where antennas <b>112</b> and <b>114</b> transmit information to access terminal <b>116</b> over forward link <b>120</b> and receive information from access terminal <b>116</b> over reverse link <b>118</b>. Access terminal (AT) <b>122</b> is in communication with antennas <b>106</b> and <b>108</b>, where antennas <b>106</b> and <b>108</b> transmit information to access terminal (AT) <b>122</b> over forward link <b>126</b> and receive information from access terminal (AT) <b>122</b> over reverse link <b>124</b>. In a FDD system, communication links <b>118</b>, <b>120</b>, <b>124</b> and <b>126</b> may use different frequency for communication. For example, forward link <b>120</b> may use a different frequency then that used by reverse link <b>118</b>.</p><p id="p-0031" num="0030">Each group of antennas and/or the area in which they are designed to communicate is often referred to as a sector of the access network. In the embodiment, antenna groups each are designed to communicate to access terminals in a sector of the areas covered by access network <b>100</b>.</p><p id="p-0032" num="0031">In communication over forward links <b>120</b> and <b>126</b>, the transmitting antennas of access network <b>100</b> may utilize beamforming in order to improve the signal-to-noise ratio of forward links for the different access terminals <b>116</b> and <b>122</b>. Also, an access network using beamforming to transmit to access terminals scattered randomly through its coverage causes less interference to access terminals in neighboring cells than an access network transmitting through a single antenna to all its access terminals.</p><p id="p-0033" num="0032">An access network (AN) may be a fixed station or base station used for communicating with the terminals and may also be referred to as an access point, a Node B, a base station, an enhanced base station, an evolved Node B (eNB), a network node, a network, or some other terminology. An access terminal (AT) may also be called user equipment (UE), a wireless communication device, terminal, access terminal or some other terminology.</p><p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a simplified block diagram of an embodiment of a transmitter system <b>210</b> (also known as the access network) and a receiver system <b>250</b> (also known as access terminal (AT) or user equipment (UE)) in a MIMO system <b>200</b>. At the transmitter system <b>210</b>, traffic data for a number of data streams is provided from a data source <b>212</b> to a transmit (TX) data processor <b>214</b>.</p><p id="p-0035" num="0034">In one embodiment, each data stream is transmitted over a respective transmit antenna. TX data processor <b>214</b> formats, codes, and interleaves the traffic data for each data stream based on a particular coding scheme selected for that data stream to provide coded data.</p><p id="p-0036" num="0035">The coded data for each data stream may be multiplexed with pilot data using OFDM techniques. The pilot data is typically a known data pattern that is processed in a known manner and may be used at the receiver system to estimate the channel response. The multiplexed pilot and coded data for each data stream is then modulated (i.e., symbol mapped) based on a particular modulation scheme (e.g., BPSK, QPSK, M-PSK, or M-QAM) selected for that data stream to provide modulation symbols. The data rate, coding, and modulation for each data stream may be determined by instructions performed by processor <b>230</b>.</p><p id="p-0037" num="0036">The modulation symbols for all data streams are then provided to a TX MIMO processor <b>220</b>, which may further process the modulation symbols (e.g., for OFDM). TX MIMO processor <b>220</b> then provides N<sub>T </sub>modulation symbol streams to N<sub>T </sub>transmitters (TMTR) <b>222</b><i>a </i>through <b>222</b><i>t</i>. In certain embodiments, TX MIMO processor <b>220</b> applies beamforming weights to the symbols of the data streams and to the antenna from which the symbol is being transmitted.</p><p id="p-0038" num="0037">Each transmitter <b>222</b> receives and processes a respective symbol stream to provide one or more analog signals, and further conditions (e.g., amplifies, filters, and upconverts) the analog signals to provide a modulated signal suitable for transmission over the MIMO channel. N<sub>T </sub>modulated signals from transmitters <b>222</b><i>a </i>through <b>222</b><i>t </i>are then transmitted from N<sub>T </sub>antennas <b>224</b><i>a </i>through <b>224</b><i>t</i>, respectively.</p><p id="p-0039" num="0038">At receiver system <b>250</b>, the transmitted modulated signals are received by N<sub>R </sub>antennas <b>252</b><i>a </i>through <b>252</b><i>r </i>and the received signal from each antenna <b>252</b> is provided to a respective receiver (RCVR) <b>254</b><i>a </i>through <b>254</b><i>r</i>. Each receiver <b>254</b> conditions (e.g., filters, amplifies, and downconverts) a respective received signal, digitizes the conditioned signal to provide samples, and further processes the samples to provide a corresponding &#x201c;received&#x201d; symbol stream.</p><p id="p-0040" num="0039">An RX data processor <b>260</b> then receives and processes the N<sub>R </sub>received symbol streams from N<sub>R </sub>receivers <b>254</b> based on a particular receiver processing technique to provide N<sub>T </sub>&#x201c;detected&#x201d; symbol streams. The RX data processor <b>260</b> then demodulates, deinterleaves, and decodes each detected symbol stream to recover the traffic data for the data stream. The processing by RX data processor <b>260</b> is complementary to that performed by TX MIMO processor <b>220</b> and TX data processor <b>214</b> at transmitter system <b>210</b>.</p><p id="p-0041" num="0040">A processor <b>270</b> periodically determines which pre-coding matrix to use (discussed below). Processor <b>270</b> formulates a reverse link message comprising a matrix index portion and a rank value portion.</p><p id="p-0042" num="0041">The reverse link message may comprise various types of information regarding the communication link and/or the received data stream. The reverse link message is then processed by a TX data processor <b>238</b>, which also receives traffic data for a number of data streams from a data source <b>236</b>, modulated by a modulator <b>280</b>, conditioned by transmitters <b>254</b><i>a </i>through <b>254</b><i>r</i>, and transmitted back to transmitter system <b>210</b>.</p><p id="p-0043" num="0042">At transmitter system <b>210</b>, the modulated signals from receiver system <b>250</b> are received by antennas <b>224</b>, conditioned by receivers <b>222</b>, demodulated by a demodulator <b>240</b>, and processed by a RX data processor <b>242</b> to extract the reserve link message transmitted by the receiver system <b>250</b>. Processor <b>230</b> then determines which pre-coding matrix to use for determining the beamforming weights then processes the extracted message.</p><p id="p-0044" num="0043">Turning to <figref idref="DRAWINGS">FIG. <b>3</b></figref>, this figure shows an alternative simplified functional block diagram of a communication device according to one embodiment of the invention. As shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the communication device <b>300</b> in a wireless communication system can be utilized for realizing the UEs (or ATs) <b>116</b> and <b>122</b> in <figref idref="DRAWINGS">FIG. <b>1</b></figref> or the base station (or AN) <b>100</b> in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, and the wireless communications system is preferably the NR system. The communication device <b>300</b> may include an input device <b>302</b>, an output device <b>304</b>, a control circuit <b>306</b>, a central processing unit (CPU) <b>308</b>, a memory <b>310</b>, a program code <b>312</b>, and a transceiver <b>314</b>. The control circuit <b>306</b> executes the program code <b>312</b> in the memory <b>310</b> through the CPU <b>308</b>, thereby controlling an operation of the communications device <b>300</b>. The communications device <b>300</b> can receive signals input by a user through the input device <b>302</b>, such as a keyboard or keypad, and can output images and sounds through the output device <b>304</b>, such as a monitor or speakers. The transceiver <b>314</b> is used to receive and transmit wireless signals, delivering received signals to the control circuit <b>306</b>, and outputting signals generated by the control circuit <b>306</b> wirelessly. The communication device <b>300</b> in a wireless communication system can also be utilized for realizing the AN <b>100</b> in <figref idref="DRAWINGS">FIG. <b>1</b></figref>.</p><p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a simplified block diagram of the program code <b>312</b> shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref> in accordance with one embodiment of the invention. In this embodiment, the program code <b>312</b> includes an application layer <b>400</b>, a Layer 3 portion <b>402</b>, and a Layer 2 portion <b>404</b>, and is coupled to a Layer 1 portion <b>406</b>. The Layer 3 portion <b>402</b> generally performs radio resource control. The Layer 2 portion <b>404</b> generally performs link control. The Layer 1 portion <b>406</b> generally performs physical connections.</p><p id="p-0046" num="0045">3GPP TS 23.287 specifies procedures related to unicast mode Vehicle-to-Everything (V2X) communication over PC5 reference point as follows:</p><heading id="h-0007" level="2">5.1.2 Authorization and Provisioning for V2X Communications Over PC5 Reference Point</heading><heading id="h-0008" level="2">5.1.2.1 Policy/Parameter Provisioning</heading><p id="p-0047" num="0046">The following sets of information for V2X communications over PC5 reference point is provisioned to the UE:<ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0000">    <ul id="ul0002" list-style="none">        <li id="ul0002-0001" num="0047">1) Authorization policy:        <ul id="ul0003" list-style="none">            <li id="ul0003-0001" num="0048">When the UE is &#x201c;served by E-UTRA&#x201d; or &#x201c;served by NR&#x201d;:            <ul id="ul0004" list-style="none">                <li id="ul0004-0001" num="0049">PLMNs in which the UE is authorized to perform V2X communications over PC5 reference point when &#x201c;served by E-UTRA&#x201d; or &#x201c;served by NR&#x201d;.</li>                <li id="ul0004-0002" num="0050">For each above PLMN:                <ul id="ul0005" list-style="none">                    <li id="ul0005-0001" num="0051">RAT(s) over which the UE is authorized to perform V2X communications over PC5 reference point.</li>                </ul>                </li>            </ul>            </li>            <li id="ul0003-0002" num="0052">When the UE is &#x201c;not served by E-UTRA&#x201d; and &#x201c;not served by NR&#x201d;:            <ul id="ul0006" list-style="none">                <li id="ul0006-0001" num="0053">Indicates whether the UE is authorized to perform V2X communications over PC5 reference point when &#x201c;not served by E-UTRA&#x201d; and &#x201c;not served by NR&#x201d;.</li>                <li id="ul0006-0002" num="0054">RAT(s) over which the UE is authorized to perform V2X communications over PC5 reference point.</li>            </ul>            </li>        </ul>        </li>        <li id="ul0002-0002" num="0055">NOTE 1: In this specification, {When the UE is &#x201c;served by E-UTRA&#x201d; or &#x201c;served by NR&#x201d;} and {When the UE is &#x201c;not served by E-UTRA&#x201d; and &#x201c;not served by NR&#x201d;} are relevant to V2X communications over PC5 reference point.</li>        <li id="ul0002-0003" num="0056">2) Radio parameters when the UE is &#x201c;not served by E-UTRA&#x201d; and &#x201c;not served by NR&#x201d;:        <ul id="ul0007" list-style="none">            <li id="ul0007-0001" num="0057">Includes the radio parameters per PC5 RAT (i.e. LTE PC5, NR PC5) with Geographical Area(s) and an indication of whether they are &#x201c;operator managed&#x201d; or &#x201c;non-operator managed&#x201d;. These radio parameters (e.g., frequency bands) are defined in TS 36.331 [14] and TS 38.331 [15]. The UE uses the radio parameters to perform V2X communications over PC5 reference point when &#x201c;not served by E-UTRA&#x201d; and &#x201c;not served by NR&#x201d; only if the UE can reliably locate itself in the corresponding Geographical Area. Otherwise, the UE is not authorized to transmit.</li>        </ul>        </li>        <li id="ul0002-0004" num="0058">NOTE 2: Whether a frequency band is &#x201c;operator managed&#x201d; or &#x201c;non-operator managed&#x201d; in a given Geographical Area is defined by local regulations.</li>        <li id="ul0002-0005" num="0059">3) Policy/parameters per RAT for PC5 Tx Profile selection:        <ul id="ul0008" list-style="none">            <li id="ul0008-0001" num="0060">The mapping of V2X service types (e.g. PSIDs or ITS-AIDS) to Tx Profiles (see TS 36.300 [9] and TS 38.300 [11] for further information).</li>        </ul>        </li>        <li id="ul0002-0006" num="0061">4) Policy/parameters related to privacy:        <ul id="ul0009" list-style="none">            <li id="ul0009-0001" num="0062">The list of V2X service types, e.g. PSIDs or ITS-AIDS of the V2X applications, with Geographical Area(s) that require privacy support.</li>            <li id="ul0009-0002" num="0063">A privacy timer value indicating the duration after which the UE shall change each source Layer-2 ID self-assigned by the UE when privacy is required.</li>        </ul>        </li>        <li id="ul0002-0007" num="0064">5) Policy/parameters when LTE PC5 is selected:        <ul id="ul0010" list-style="none">            <li id="ul0010-0001" num="0065">Same as specified in TS 23.285 [8] clause 4.4.1.1.2 item 3) Policy/parameters except for the mapping of V2X service types to Tx Profiles and the list of V2X services with Geographical Area(s) that require privacy support.</li>        </ul>        </li>        <li id="ul0002-0008" num="0066">6) Policy/parameters when NR PC5 is selected:        <ul id="ul0011" list-style="none">            <li id="ul0011-0001" num="0067">The mapping of V2X service types (e.g. PSIDs or ITS-AIDS) to V2X frequencies with Geographical Area(s).</li>            <li id="ul0011-0002" num="0068">The mapping of Destination Layer-2 ID(s) and the V2X service types, e.g. PSIDs or ITS-AIDs of the V2X application for broadcast.</li>            <li id="ul0011-0003" num="0069">The mapping of Destination Layer-2 ID(s) and the V2X service types, e.g. PSIDs or ITS-AIDs of the V2X application for groupcast.</li>            <li id="ul0011-0004" num="0070">The mapping of default Destination Layer-2 ID(s) for initial signalling to establish unicast connection and the V2X service types, e.g. PSIDs or ITS-AIDS of the V2X application.</li>        </ul>        </li>        <li id="ul0002-0009" num="0071">NOTE 3: The same default Destination Layer-2 ID for unicast initial signalling can be mapped to more than one V2X service types. In the case where different V2X services are mapped to distinct default Destination Layer-2 IDs, when the UE intends to establish a single unicast link that can be used for more than one V2X service types, the UE can select any of the default Destination Layer-2 IDs to use for the initial signalling.        <ul id="ul0012" list-style="none">            <li id="ul0012-0001" num="0072">PC5 QoS mapping configuration:            <ul id="ul0013" list-style="none">                <li id="ul0013-0001" num="0073">Input from V2X application layer:                <ul id="ul0014" list-style="none">                    <li id="ul0014-0001" num="0074">V2X service type (e.g. PSID or ITS-AID).</li>                    <li id="ul0014-0002" num="0075">(Optional) V2X Application Requirements for the V2X service type, e.g. priority requirement, reliability requirement, delay requirement, range requirement.</li>                </ul>                </li>            </ul>            </li>        </ul>        </li>        <li id="ul0002-0010" num="0076">NOTE 4: Details of V2X Application Requirements for the V2X service type is up to implementation and out of scope of this specification.        <ul id="ul0015" list-style="none">            <li id="ul0015-0001" num="0077">Output:            <ul id="ul0016" list-style="none">                <li id="ul0016-0001" num="0078">PC5 QoS parameters defined in clause 5.4.2 (i.e. PQI and conditionally other parameters such as MFBR/GFBR, etc.).</li>            </ul>            </li>            <li id="ul0015-0002" num="0079">AS layer configurations (see TS 38.331 [15]), e.g. the mapping of PC5 QoS profile(s) to radio bearer(s), when the UE is &#x201c;not served by E-UTRA&#x201d; and &#x201c;not served by NR&#x201d;.            <ul id="ul0017" list-style="none">                <li id="ul0017-0001" num="0080">The PC5 QoS profile contains PC5 QoS parameters described in clause 5.4.2, and value for the QoS characteristics regarding Priority Level, Averaging Window, Maximum Data Burst Volume if default value is not used as defined in Table 5.4.4-1.</li>            </ul>            </li>        </ul>        </li>        <li id="ul0002-0011" num="0081">7) Validity timer indicating the expiration time of the V2X Policy/Parameter.<br/>The above parameter sets from bullet 2) to 6) may be configured in the UE through the V1 reference point by the V2X Application Server.</li>    </ul>    </li></ul></p><heading id="h-0009" level="2"><b>5</b>.<b>2</b>.<b>1</b>.<b>4</b> Unicast Mode Communication Over PC5 Reference Point</heading><p id="p-0048" num="0082">Unicast mode of communication is only supported over NR based PC5 reference point. <figref idref="DRAWINGS">FIG. <b>5</b>.<b>2</b></figref>.<b>1</b>.<b>4</b>-<b>1</b> illustrates an example of PC5 unicast links.</p><heading id="h-0010" level="1">FIG. <b>5</b>.<b>2</b>.<b>1</b>.<b>4</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0, Entitled &#x201c;Example of PC5 Unicast Links&#x201d;, is Reproduced as FIG. <b>5</b></heading><p id="p-0049" num="0083">The following principles apply when the V2X communication is carried over PC5 unicast link:<ul id="ul0018" list-style="none">    <li id="ul0018-0001" num="0000">    <ul id="ul0019" list-style="none">        <li id="ul0019-0001" num="0084">A PC5 unicast link between two UEs allows V2X communication between one or more pairs of peer V2X services in these UEs. All V2X services in the UE using the same PC5 unicast link use the same Application Layer ID.</li>        <li id="ul0019-0002" num="0085">NOTE 1: An Application Layer ID can change in time as described in clauses 5.6.1.1 and 6.3.3.2, due to privacy. This does not cause a re-establishment of a PC5 unicast link. The UE triggers a Link Identifier Update procedure as specified in clause 6.3.3.2.</li>        <li id="ul0019-0003" num="0086">One PC5 unicast link supports one or more V2X service types (e.g. PSIDs or ITS-AIDS) if these V2X service types are at least associated with the pair of peer Application Layer IDs for this PC5 unicast link. For example, as illustrated in <figref idref="DRAWINGS">FIG. <b>5</b>.<b>2</b></figref>.<b>1</b>.<b>4</b>-<b>1</b>, UE A and UE B have two PC5 unicast links, one between peer Application Layer ID 1/UE A and Application Layer ID 2/UE B and one between peer Application Layer ID 3/UE A and Application Layer ID 4/UE B.</li>        <li id="ul0019-0004" num="0087">NOTE 2: A source UE is not required to know whether different target Application Layer IDs over different PC5 unicast links belong to the same target UE.</li>        <li id="ul0019-0005" num="0088">A PC5 unicast link supports V2X communication using a single network layer protocol e.g. IP or non-IP.</li>        <li id="ul0019-0006" num="0089">A PC5 unicast link supports per-flow QoS model as specified in clause 5.4.1.<br/>When the Application layer in the UE initiates data transfer for a V2X service type which requires unicast mode of communication over PC5 reference point:</li>        <li id="ul0019-0007" num="0090">the UE shall reuse an existing PC5 unicast link if the pair of peer Application Layer IDs and the network layer protocol of this PC5 unicast link are identical to those required by the application layer in the UE for this V2X service, and modify the existing PC5 unicast link to add this V2X service type as specified in clause 6.3.3.4; otherwise</li>        <li id="ul0019-0008" num="0091">the UE shall trigger the establishment of a new PC5 unicast link as specified in clause 6.3.3.1.<br/>After successful PC5 unicast link establishment, UE A and UE B use the same pair of Layer-2 IDs for subsequent PC5-S signalling message exchange and V2X service data transmission as specified in clause 5.6.1.4. The V2X layer of the transmitting UE indicates to the AS layer whether a transmission is for a PC5-S signalling message (i.e. Direct Communication Request/Accept, Link Identifier Update Request/Response/Ack, Disconnect Request/Response, Link Modification Request/Accept) or V2X service data.<br/>For every PC5 unicast link, a UE self-assigns a distinct PC5 Link Identifier that uniquely identifies the PC5 unicast link in the UE for the lifetime of the PC5 unicast link. Each PC5 unicast link is associated with a Unicast Link Profile which includes:</li>        <li id="ul0019-0009" num="0092">V2X service type(s) (e.g. PSID(s) or ITS-AID(s)); and</li>        <li id="ul0019-0010" num="0093">Application Layer ID and Layer-2 ID of UE A; and</li>        <li id="ul0019-0011" num="0094">Application Layer ID and Layer-2 ID of UE B; and</li>        <li id="ul0019-0012" num="0095">network layer protocol used on the PC5 unicast link; and</li>        <li id="ul0019-0013" num="0096">for each V2X service type, a set of PC5 QoS Flow Identifier(s) (PFI(s)). Each PFI is associated with QoS parameters (i.e. PQI).<br/>For privacy reason, the Application Layer IDs and Layer-2 IDs may change as described in clauses 5.6.1.1 and 6.3.3.2 during the lifetime of the PC5 unicast link and, if so, shall be updated in the Unicast Link Profile accordingly. The UE uses PC5 Link Identifier to indicate the PC5 unicast link to V2X Application layer, therefore V2X Application layer identifies the corresponding PC5 unicast link even if there are more than one unicast link associated with one V2X service type (e.g. the UE establishes multiple unicast links with multiple UEs for a same V2X service type).<br/>The Unicast Link Profile shall be updated accordingly after a Layer-2 link modification for an established PC5 unicast link as specified in clause 6.3.3.4 or Layer-2 link identifier update as specified in clause 6.3.3.2.<br/>V2X Service Info and QoS Info are carried in PC5-S signalling messages and exchanged between two UEs as specified in clause 6.3.3. Based on the exchanged information, PFI is used to identify V2X service. When the receiving UE receives V2X service data over the established PC5 unicast link, the receiving UE determines the appropriate V2X service based on the PFI to forward the received V2X service data to the upper layer.<br/>Upon receiving an indication from the AS layer that the PC5-RRC connection was released due to RLF, the V2X layer in the UE locally releases the PC5 unicast link associated with this PC5-RRC connection. The AS layer uses PC5 Link Identifier to indicate the PC5 unicast link whose PC5-RRC connection was released.<br/>When the PC5 unicast link has been released as specified in clause 6.3.3.3, the V2X layer of each UE for the PC5 unicast link informs the AS layer that the PC5 unicast link has been released. The V2X layer uses PC5 Link Identifier to indicate the released unicast link.</li>    </ul>    </li></ul></p><heading id="h-0011" level="2"><b>5</b>.<b>6</b>.<b>1</b>.<b>4</b> Identifiers for Unicast Mode V2X Communication Over PC5 Reference Point</heading><p id="p-0050" num="0097">For unicast mode of V2X communication over PC5 reference point, the destination Layer-2 ID used depends on the communication peer. The Layer-2 ID of the communication peer, identified by the Application Layer ID, may be discovered during the establishment of the PC5 unicast link, or known to the UE via prior V2X communications, e.g. existing or prior unicast link to the same Application Layer ID, or obtained from application layer service announcements. The initial signalling for the establishment of the PC5 unicast link may use the known Layer-2 ID of the communication peer, or a default destination Layer-2 ID associated with the V2X service type (e.g. PSID/ITS-AID) configured for PC5 unicast link establishment, as specified in clause 5.1.2.1. During the PC5 unicast link establishment procedure, Layer-2 IDs are exchanged, and should be used for future communication between the two UEs, as specified in clause 6.3.3.1.<br/>The Application Layer ID is associated with one or more V2X applications within the UE. If UE has more than one Application Layer IDs, each Application Layer ID of the same UE may be seen as different UE's Application Layer ID from the peer UE's perspective.<br/>The UE maintains a mapping between the Application Layer IDs and the source Layer-2 IDs used for the PC5 unicast links, as the V2X application layer does not use the Layer-2 IDs. This allows the change of source Layer-2 ID without interrupting the V2X applications.<br/>When Application Layer IDs change, the source Layer-2 ID(s) of the PC5 unicast link(s) shall be changed if the link(s) was used for V2X communication with the changed Application Layer IDs. Based on privacy configuration as specified in clause 5.1.2.1, the update of the new identifiers of a source UE to the peer UE for the established unicast link may cause the peer UE to change its Layer-2 ID and optionally IP address/prefix if IP communication is used as defined in clause 6.3.3.2.<br/>A UE may establish multiple PC5 unicast links with a peer UE and use the same or different source Layer-2 IDs for these PC5 unicast links.</p><heading id="h-0012" level="2"><b>6</b>.<b>1</b> Control and User Plane Stacks</heading><heading id="h-0013" level="2"><b>6</b>.<b>1</b>.<b>1</b> User Plane for NR PC5 Reference Point Supporting V2X Services</heading><p id="p-0051" num="0098"><figref idref="DRAWINGS">FIG. <b>6</b>.<b>1</b></figref>.<b>1</b>-<b>1</b> depicts a user plane for NR PC5 reference point, i.e. PC5 User Plane Protocol stack.</p><heading id="h-0014" level="1">FIG. <b>6</b>.<b>1</b>.<b>1</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0, Entitled &#x201c;User Plane for NR PC5 Reference Point&#x201d;, is Reproduced as FIG. <b>6</b></heading><p id="p-0052" num="0099">IP and Non-IP PDCP SDU types are supported for the V2X communication over PC5 reference point.<br/>For IP PDCP SDU type, only IPv6 is supported. The IP address allocation and configuration are as defined in clause 5.6.1.1.<br/>The Non-IP PDCP SDU contains a Non-IP Type header, which indicates the V2X message family used by the application layer, e.g. IEEE 1609 family's WSMP [18], ISO defined FNTP [19].<ul id="ul0020" list-style="none">    <li id="ul0020-0001" num="0000">    <ul id="ul0021" list-style="none">        <li id="ul0021-0001" num="0100">NOTE: The Non-IP Type header and allowed values are defined in TS 24.587 [24].<br/>The packets from V2X application layer are handled by the V2X layer before transmitting them to the AS layer, e.g. V2X layer maps the IP/Non IP packets to PC5 QoS Flow and marks the corresponding PFI.<br/><b>6</b>.<b>1</b>.<b>2</b> Control plane for NR PC5 reference point supporting V2X services</li>        <li id="ul0021-0002" num="0101">Editor's note: Whether PC5-S messages are carried in PC5 RRC signalling depends on RAN decision.<br/><figref idref="DRAWINGS">FIG. <b>6</b>.<b>1</b></figref>.<b>2</b>-<b>1</b> depicts a control plane for NR PC5 reference point, i.e. PC5 Signalling Protocol stack.</li>    </ul>    </li></ul></p><heading id="h-0015" level="1">FIG. <b>6</b>.<b>1</b>.<b>2</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0, Entitled &#x201c;Control Plane for NR PC5 Reference Point&#x201d;, is Reproduced as FIG. <b>7</b></heading><heading id="h-0016" level="2"><b>6</b>.<b>3</b>.<b>3</b> Unicast Mode V2X Communication Over PC5 Reference Point</heading><heading id="h-0017" level="2"><b>6</b>.<b>3</b>.<b>3</b>.<b>1</b> Layer-2 Link Establishment Over PC5 Reference Point</heading><p id="p-0053" num="0102">To perform unicast mode of V2X communication over PC5 reference point, the UE is configured with the related information as described in clause 5.1.2.1.<br/><figref idref="DRAWINGS">FIG. <b>6</b>.<b>3</b></figref>.<b>3</b>.<b>1</b>-<b>1</b> shows the layer-2 link establishment procedure for unicast mode of V2X communication over PC5 reference point.</p><heading id="h-0018" level="1">FIG. <b>6</b>.<b>3</b>.<b>3</b>.<b>1</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0, Entitled &#x201c;Layer-2 Link Establishment Procedure&#x201d;, is Reproduced as FIG. <b>8</b></heading><p id="p-0054" num="0103">1. The UE(s) determine the destination Layer-2 ID for signalling reception for PC5 unicast link establishment as specified in clause 5.6.1.4. The destination Layer-2 ID is configured with the UE(s) as specified in clause 5.1.2.1.</p><p id="p-0055" num="0104">2. The V2X application layer in UE-1 provides application information for PC5 unicast communication. The application information includes the V2X service type(s) (e.g. PSID(s) or ITS-AID(s)) of the V2X application and the initiating UE's Application Layer ID. The target UE's Application Layer ID may be included in the application information.</p><p id="p-0056" num="0105">The V2X application layer in UE-1 may provide V2X Application Requirements for this unicast communication. UE-1 determines the PC5 QoS parameters and PFI as specified in clause 5.4.1.4.</p><p id="p-0057" num="0106">If UE-1 decides to reuse the existing PC5 unicast link as specified in clause 5.2.1.4, the UE triggers Layer-2 link modification procedure as specified in clause 6.3.3.4.</p><p id="p-0058" num="0107">3. UE-1 sends a Direct Communication Request message to initiate the unicast layer-2 link establishment procedure. The Direct Communication Request message includes:<ul id="ul0022" list-style="none">    <li id="ul0022-0001" num="0000">    <ul id="ul0023" list-style="none">        <li id="ul0023-0001" num="0108">Source User Info: the initiating UE's Application Layer ID (i.e. UE-Vs Application Layer ID).</li>        <li id="ul0023-0002" num="0109">If the V2X application layer provided the target UE's Application Layer ID in step 2, the following information is included:        <ul id="ul0024" list-style="none">            <li id="ul0024-0001" num="0110">Target User Info: the target UE's Application Layer ID (i.e. UE-2's Application Layer ID).</li>        </ul>        </li>        <li id="ul0023-0003" num="0111">V2X Service Info: the information about V2X Service(s) requesting Layer-2 link establishment (e.g. PSID(s) or ITS-AID(s)).</li>        <li id="ul0023-0004" num="0112">Security Information: the information for the establishment of security.</li>    </ul>    </li></ul></p><p id="p-0059" num="0113">NOTE 1: The Security Information and the necessary protection of the Source User Info and Target User Info are defined by SA WG3.<ul id="ul0025" list-style="none">    <li id="ul0025-0001" num="0000">    <ul id="ul0026" list-style="none">        <li id="ul0026-0001" num="0114">The source Layer-2 ID and destination Layer-2 ID used to send the Direct Communication Request message are determined as specified in clauses 5.6.1.1 and 5.6.1.4. The destination Layer-2 ID may be broadcast or unicast Layer-2 ID. When unicast Layer-2 ID is used, the Target User Info shall be included in the Direct Communication Request message.</li>        <li id="ul0026-0002" num="0115">UE-1 sends the Direct Communication Request message via PC5 broadcast or unicast using the source Layer-2 ID and the destination Layer-2 ID.</li>    </ul>    </li></ul></p><p id="p-0060" num="0116">4. Security with UE-1 is established as below:<ul id="ul0027" list-style="none">    <li id="ul0027-0001" num="0000">    <ul id="ul0028" list-style="none">        <li id="ul0028-0001" num="0117">4a. If the Target User Info is included in the Direct Communication Request message, the target UE, i.e. UE-2, responds by establishing the security with UE-1.</li>        <li id="ul0028-0002" num="0118">4b. If the Target User Info is not included in the Direct Communication Request message, the UEs that are interested in using the announced V2X Service(s) over a PC5 unicast link with UE-1 responds by establishing the security with UE-1.</li>    </ul>    </li></ul></p><p id="p-0061" num="0119">NOTE 2: The signalling for the Security Procedure is defined by SA WG3.<ul id="ul0029" list-style="none">    <li id="ul0029-0001" num="0000">    <ul id="ul0030" list-style="none">        <li id="ul0030-0001" num="0120">When the security protection is enabled, UE-1 sends the following information to the target UE:        <ul id="ul0031" list-style="none">            <li id="ul0031-0001" num="0121">If IP communication is used:            <ul id="ul0032" list-style="none">                <li id="ul0032-0001" num="0122">IP Address Configuration: For IP communication, IP address configuration is required for this link and indicates one of the following values:                <ul id="ul0033" list-style="none">                    <li id="ul0033-0001" num="0123">&#x201c;IPv6 Router&#x201d; if IPv6 address allocation mechanism is supported by the initiating UE, i.e., acting as an IPv6 Router; or</li>                    <li id="ul0033-0002" num="0124">&#x201c;IPv6 address allocation not supported&#x201d; if IPv6 address allocation mechanism is not supported by the initiating UE.</li>                </ul>                </li>                <li id="ul0032-0002" num="0125">Link Local IPv6 Address: a link-local IPv6 address formed locally based on RFC 4862 [21] if UE-1 does not support the IPv6 IP address allocation mechanism, i.e. the IP Address Configuration indicates &#x201c;IPv6 address allocation not supported&#x201d;.</li>            </ul>            </li>            <li id="ul0031-0002" num="0126">QoS Info: the information about PC5 QoS Flow(s). For each PC5 QoS Flow, the PFI and the corresponding PC5 QoS parameters (i.e. PQI and conditionally other parameters such as MFBR/GFBR, etc.).</li>        </ul>        </li>        <li id="ul0030-0002" num="0127">The source Layer-2 ID used for the security establishment procedure is determined as specified in clauses 5.6.1.1 and 5.6.1.4. The destination Layer-2 ID is set to the source Layer-2 ID of the received Direct Communication Request message.</li>        <li id="ul0030-0003" num="0128">Upon receiving the security establishment procedure messages, UE-1 obtains the peer UE's Layer-2 ID for future communication, for signalling and data traffic for this unicast link.</li>    </ul>    </li></ul></p><p id="p-0062" num="0129">5. A Direct Communication Accept message is sent to UE-1 by the target UE(s) that has successfully established security with UE-1:<ul id="ul0034" list-style="none">    <li id="ul0034-0001" num="0000">    <ul id="ul0035" list-style="none">        <li id="ul0035-0001" num="0130">5a. (UE oriented Layer-2 link establishment) If the Target User Info is included in the Direct Communication Request message, the target UE, i.e. UE-2 responds with a Direct Communication Accept message if the Application Layer ID for UE-2 matches.</li>        <li id="ul0035-0002" num="0131">5b. (V2X Service oriented Layer-2 link establishment) If the Target User Info is not included in the Direct Communication Request message, the UEs that are interested in using the announced V2X Service(s) respond to the request by sending a Direct Communication Accept message (UE-2 and UE-4 in <figref idref="DRAWINGS">FIG. <b>6</b>.<b>3</b></figref>.<b>3</b>.<b>1</b>-<b>1</b>).</li>        <li id="ul0035-0003" num="0132">The Direct Communication Accept message includes:        <ul id="ul0036" list-style="none">            <li id="ul0036-0001" num="0133">Source User Info: Application Layer ID of the UE sending the Direct Communication Accept message.</li>            <li id="ul0036-0002" num="0134">QoS Info: the information about PC5 QoS Flow(s). For each PC5 QoS Flow, the PFI and the corresponding PC5 QoS parameters requested by UE-1 (i.e. PQI and conditionally other parameters such as MFBR/GFBR, etc).</li>            <li id="ul0036-0003" num="0135">If IP communication is used:            <ul id="ul0037" list-style="none">                <li id="ul0037-0001" num="0136">IP Address Configuration: For IP communication, IP address configuration is required for this link and indicates one of the following values:</li>                <li id="ul0037-0002" num="0137">&#x201c;IPv6 Router&#x201d; if IPv6 address allocation mechanism is supported by the target UE, i.e., acting as an IPv6 Router; or</li>            </ul>            </li>            <li id="ul0036-0004" num="0138">&#x201c;IPv6 address allocation not supported&#x201d; if IPv6 address allocation mechanism is not supported by the target UE.</li>        </ul>        </li>        <li id="ul0035-0004" num="0139">Link Local IPv6 Address: a link-local IPv6 address formed locally based on RFC 4862 [21] if the target UE does not support the IPv6 IP address allocation mechanism, i.e. the IP Address Configuration indicates &#x201c;IPv6 address allocation not supported&#x201d;, and UE-1 included a link-local IPv6 address in the Direct Communication Request message. The target UE shall include a non-conflicting link-local IPv6 address.</li>        <li id="ul0035-0005" num="0140">If both UEs (i.e. the initiating UE and the target UE) selected to use link-local IPv6 address, they shall disable the duplicate address detection defined in RFC 4862 [21].</li>    </ul>    </li></ul></p><p id="p-0063" num="0141">NOTE 3: When either the initiating UE or the target UE indicates the support of IPv6 router, corresponding address configuration procedure would be carried out after the establishment of the layer 2 link, and the link-local IPv6 addresses are ignored.<ul id="ul0038" list-style="none">    <li id="ul0038-0001" num="0000">    <ul id="ul0039" list-style="none">        <li id="ul0039-0001" num="0142">The V2X layer of the UE that established PC5 unicast link passes the PC5 Link Identifier assigned for the unicast link and the PC5 unicast link related information down to the AS layer. The PC5 unicast link related information includes Layer-2 ID information (i.e. source Layer-2 ID and destination Layer-2 ID). This enables the AS layer to maintain the PC5 Link Identifier together with the PC5 unicast link related information.</li>    </ul>    </li></ul></p><p id="p-0064" num="0143">6. V2X service data is transmitted over the established unicast link as below:<ul id="ul0040" list-style="none">    <li id="ul0040-0001" num="0000">    <ul id="ul0041" list-style="none">        <li id="ul0041-0001" num="0144">The PC5 Link Identifier, and PFI are provided to the AS layer, together with the V2X service data.</li>        <li id="ul0041-0002" num="0145">Optionally in addition, the Layer-2 ID information (i.e. source Layer-2 ID and destination Layer-2 ID) is provided to the AS layer.</li>    </ul>    </li></ul></p><p id="p-0065" num="0146">NOTE 4: It is up to UE implementation to provide the Layer-2 ID information to the AS layer.<ul id="ul0042" list-style="none">    <li id="ul0042-0001" num="0000">    <ul id="ul0043" list-style="none">        <li id="ul0043-0001" num="0147">UE-1 sends the V2X service data using the source Layer-2 ID (i.e. UE-1's Layer-2 ID for this unicast link) and the destination Layer-2 ID (i.e. the peer UE's Layer-2 ID for this unicast link).</li>    </ul>    </li></ul></p><p id="p-0066" num="0148">NOTE 5: PC5 unicast link is bi-directional, therefore the peer UE of UE-1 can send the V2X service data to UE-1 over the unicast link with UE-1.</p><heading id="h-0019" level="2"><b>6</b>.<b>3</b>.<b>3</b>.<b>2</b> Link Identifier Update for a Unicast Link</heading><p id="p-0067" num="0149"><figref idref="DRAWINGS">FIG. <b>6</b>.<b>3</b></figref>.<b>3</b>.<b>2</b>-<b>1</b> shows the link identifier update procedure for a unicast link. Due to the privacy requirements, identifiers used for unicast mode of V2X communication over PC5 reference point (e.g. Application Layer ID, Source Layer-2 ID and IP address/prefix) shall be changed over time as specified in clauses 5.6.1.1 and 5.6.1.4. This procedure is used to update and exchange new identifiers between the source and the peer UEs for a unicast link before using the new identifiers, to prevent service interruptions.<br/>If a UE has multiple unicast links using the same Application Layer IDs or Layer-2 IDs, the UE needs to perform the link identifier update procedure over each of the unicast link.</p><heading id="h-0020" level="1">FIG. <b>6</b>.<b>3</b>.<b>3</b>.<b>2</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0, Entitled &#x201c;Link Identifier Update Procedure&#x201d;, is Reproduced as FIG. <b>9</b></heading><p id="p-0068" num="0150">0. UE-1 and UE-2 have a unicast link established as described in clause 6.3.3.1.</p><p id="p-0069" num="0151">1. UE-1 decides to change its identifier(s), e.g. due to the Application Layer ID change or upon expiry of a timer. UE-1 generates its new Layer-2 ID and sends a Link Identifier Update Request message to UE-2 using the old identifiers.<ul id="ul0044" list-style="none">    <li id="ul0044-0001" num="0000">    <ul id="ul0045" list-style="none">        <li id="ul0045-0001" num="0152">The Link Identifier Update Request message includes the new identifier(s) to use (including the new Layer-2 ID, Security Information, optionally the new Application Layer ID and optionally new IP address/prefix if IP communication is used). The new identifier(s) should be cyphered to protect privacy. After sending the Link Identifier Update request, UE-1 keeps sending data traffic to UE-2 with the old identifiers until UE-1 sends the Link Identifier Update Ack to UE-2.</li>    </ul>    </li></ul></p><p id="p-0070" num="0153">NOTE 1: The timer is running on per Source Layer-2 ID.</p><p id="p-0071" num="0154">NOTE 2: When one of the two UEs acts as IPv6 router as described in clause 5.2.1.5 and IP address/prefix also need to be changed, corresponding address configuration procedure would be carried out after the Link Identifier update procedure.</p><p id="p-0072" num="0155">2. Upon reception of the Link Identifier Update Request message, based on privacy configuration as specified in clause 5.1.2.1, UE-2 may also decide to change its identifier(s). If UE-2 decides to change its identifier(s), UE-2 responds with a Link Identifier Update Response message which includes the new identifier(s) to use (including the new Layer-2 ID, Security Information, optionally the new Application Layer ID, and optionally a new IP address/prefix if IP communication is used). The new identifier(s) should be cyphered to protect privacy. The Link Identifier Update Response message is sent using the old identifiers. UE-2 continues to receive traffic with the old Layer-2 ID from UE-1 until UE-2 receives traffic with the new Layer-2 ID from UE-1.After sending the Link Identifier Update response, UE-2 keeps sending data traffic to UE-1 with the old identifier until UE-2 receives the Link Identifier Update Ack message from UE-1.</p><p id="p-0073" num="0156">3. Upon reception of the Link Identifier Update Response message, UE-1 responds with a Link Identifier Update Ack message which includes the new identifier(s) from UE-2, as received on the Link Identifier Update Response message. The Link Identifier Update Ack message is sent using the old identifiers. UE-1 continues to receive traffic with the old Layer-2 ID from UE-2 until UE-1 receives traffic with the new Layer-2 ID from UE-2.</p><p id="p-0074" num="0157">4. The V2X layer of UE-1 passes the PC5 Link Identifier for the unicast link and the updated Layer-2 IDs (i.e. new Layer-2 ID for UE-1 for the source and new Layer-2 ID of UE-2 for the destination) down to the AS layer. This enables the AS layer to update the provided Layer-2 IDs for the unicast link.<ul id="ul0046" list-style="none">    <li id="ul0046-0001" num="0000">    <ul id="ul0047" list-style="none">        <li id="ul0047-0001" num="0158">UE-1 starts using its new identifiers and UE-2's new identifiers for this unicast link.</li>    </ul>    </li></ul></p><p id="p-0075" num="0159">5. The V2X layer of UE-2 passes the PC5 Link Identifier for the unicast link and the updated Layer-2 IDs (i.e. new Layer-2 ID of UE-2 for the source and new Layer-2 ID for UE-1 for the destination) down to the AS layer. This enables the AS layer to update the provided Layer-2 IDs for the unicast link.<ul id="ul0048" list-style="none">    <li id="ul0048-0001" num="0000">    <ul id="ul0049" list-style="none">        <li id="ul0049-0001" num="0160">UE-2 starts using its new identifiers and UE-1's new identifiers for this unicast link.</li>    </ul>    </li></ul></p><p id="p-0076" num="0161">NOTE 3: The Security Information in the above messages also needs to be updated at the same time as the Layer-2 IDs. This is defined in TS 33.536 [26].</p><heading id="h-0021" level="2"><b>6</b>.<b>3</b>.<b>3</b>.<b>4</b> Layer-2 Link Modification for a Unicast Link</heading><p id="p-0077" num="0162"><figref idref="DRAWINGS">FIG. <b>6</b>.<b>3</b></figref>.<b>3</b>.<b>4</b>-<b>1</b> shows the layer-2 link modification procedure for a unicast link. This procedure is used to:<ul id="ul0050" list-style="none">    <li id="ul0050-0001" num="0000">    <ul id="ul0051" list-style="none">        <li id="ul0051-0001" num="0163">add new V2X service(s) to the existing PC5 unicast link.</li>        <li id="ul0051-0002" num="0164">remove V2X service(s) from the existing PC5 unicast link.</li>        <li id="ul0051-0003" num="0165">add new PC5 QoS Flow(s) in the existing PC5 unicast link.</li>        <li id="ul0051-0004" num="0166">modify existing PC5 QoS Flow(s) in the existing PC5 unicast link.</li>        <li id="ul0051-0005" num="0167">remove existing PC5 QoS Flow(s) in the existing PC5 unicast link.</li>    </ul>    </li></ul></p><heading id="h-0022" level="1">FIG. <b>6</b>.<b>3</b>.<b>3</b>.<b>4</b>-<b>1</b> of 3GPP TS 23.287 V16.2.0, Entitled &#x201c;Layer-2 Link Modification Procedure&#x201d;, is Reproduced as FIG. <b>10</b></heading><p id="p-0078" num="0168">0. UE-1 and UE-2 have a unicast link established as described in clause 6.3.3.1.</p><p id="p-0079" num="0169">1. The V2X application layer in UE-1 provides application information for PC5 unicast communication. The application information includes the V2X service type(s) (e.g. PSID(s) or ITS-AID(s)) of the V2X application(s) and the initiating UE's Application Layer ID. The target UE's Application Layer ID may be included in the application information. If UE-1 decides to reuse the existing PC5 unicast link as specified in clause 5.2.1.4, so decides to modify the unicast link established with UE-2, UE-1 sends a Link Modification Request to UE-2.<ul id="ul0052" list-style="none">    <li id="ul0052-0001" num="0000">    <ul id="ul0053" list-style="none">        <li id="ul0053-0001" num="0170">The Link Modification Request message includes:        <ul id="ul0054" list-style="none">            <li id="ul0054-0001" num="0171">a) To add new V2X service(s) to the existing PC5 unicast link:            <ul id="ul0055" list-style="none">                <li id="ul0055-0001" num="0172">V2X Service Info: the information about V2X Service(s) to be added (e.g. PSID(s) or ITS-AID(s)).</li>                <li id="ul0055-0002" num="0173">QoS Info: the information about PC5 QoS Flow(s) for each V2X Service to be added. For each PC5 QoS Flow, the PFI and the corresponding PC5 QoS parameters (i.e. PQI and conditionally other parameters such as MFBR/GFBR, etc).</li>            </ul>            </li>            <li id="ul0054-0002" num="0174">b) To remove a V2X service(s) from the the existing PC5 unicast link:            <ul id="ul0056" list-style="none">                <li id="ul0056-0001" num="0175">V2X Service Info: the information about V2X Service(s) to be removed (e.g. PSID(s) or ITS-AID(s)).</li>            </ul>            </li>            <li id="ul0054-0003" num="0176">c) To add new PC5 QoS Flow(s) in the existing PC5 unicast link:            <ul id="ul0057" list-style="none">                <li id="ul0057-0001" num="0177">V2X Service Info: the information about V2X Service(s) that needs to add new QoS Flows (e.g. PSID(s) or ITS-AID(s)).</li>                <li id="ul0057-0002" num="0178">QoS Info: the information about PC5 QoS Flow(s) to be modified. For each PC5 QoS Flow, the PFI and the corresponding PC5 QoS parameters (i.e. PQI and conditionally other parameters such as MFBR/GFBR, etc).</li>            </ul>            </li>            <li id="ul0054-0004" num="0179">d) To modify PC5 QoS Flow(s) in the existing PC5 unicast link:            <ul id="ul0058" list-style="none">                <li id="ul0058-0001" num="0180">QoS Info: the information about PC5 QoS Flow(s) to be modified. For each PC5 QoS Flow, the PFI and the corresponding PC5 QoS parameters (i.e. PQI and conditionally other parameters such as MFBR/GFBR, etc.).</li>            </ul>            </li>            <li id="ul0054-0005" num="0181">e) To remove PC5 QoS Flow(s) in the existing PC5 unicast link:            <ul id="ul0059" list-style="none">                <li id="ul0059-0001" num="0182">PFIs.</li>            </ul>            </li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0080" num="0183">2. UE-2 responds with a Link Modification Accept message.<ul id="ul0060" list-style="none">    <li id="ul0060-0001" num="0000">    <ul id="ul0061" list-style="none">        <li id="ul0061-0001" num="0184">The Link Modification Accept message includes:        <ul id="ul0062" list-style="none">            <li id="ul0062-0001" num="0185">For case a), case c) and case d) described in step 1:            <ul id="ul0063" list-style="none">                <li id="ul0063-0001" num="0186">QoS Info: the information about PC5 QoS Flow(s). For each PC5 QoS Flow, the PFI and the corresponding PC5 QoS parameters (i.e. PQI and conditionally other parameters such as MFBR/GFBR, etc).</li>            </ul>            </li>        </ul>        </li>        <li id="ul0061-0002" num="0187">The V2X layer of each UE provides information about the unicast link modification to the AS layer. This enables the AS layer to update the context related to the modified unicast link.</li>    </ul>    </li></ul></p><p id="p-0081" num="0188">3GPP TS 38.323 specifies ciphering/deciphering function and Packet Data Convergence Protocol (PDCP) Data Protocol Data Unit (PDU) format for Signaling Radio Bearers (SRBs) as follows:</p><heading id="h-0023" level="2">5.8 Ciphering and Deciphering</heading><p id="p-0082" num="0189">The ciphering function includes both ciphering and deciphering and is performed in PDCP, if configured. The data unit that is ciphered is the MAC-I (see clause 6.3.4) and the data part of the PDCP Data PDU (see clause 6.3.3) except the SDAP header and the SDAP Control PDU if included in the PDCP SDU. The ciphering is not applicable to PDCP Control PDUs.<br/>For downlink and uplink, the ciphering algorithm and key to be used by the PDCP entity are configured by upper layers TS 38.331 [3] and the ciphering method shall be applied as specified in TS 33.501 [6].<br/>The ciphering function is activated/suspended/resumed by upper layers TS 38.331 [3]. When security is activated and not suspended, the ciphering function shall be applied to all PDCP Data PDUs indicated by upper layers TS 38.331 [3] for the downlink, the uplink, and the sidelink, respectively.<br/>For DAPS bearers, the PDCP entity shall perform the ciphering or deciphering for the PDCP SDU using the ciphering algorithm and key either configured for the source cell or configured for the target cell, based on to/from which cell the PDCP SDU is transmitted/received.<br/>For downlink and uplink ciphering and deciphering, the parameters that are required by PDCP for ciphering are defined in TS 33.501 [6] and are input to the ciphering algorithm. The required inputs to the ciphering function include the COUNT value, and DIRECTION (direction of the transmission: set as specified in TS 33.501 [6]). The parameters required by PDCP which are provided by upper layers TS 38.331 [3] are listed below:<ul id="ul0064" list-style="none">    <li id="ul0064-0001" num="0000">    <ul id="ul0065" list-style="none">        <li id="ul0065-0001" num="0190">BEARER (defined as the radio bearer identifier in TS 33.501 [6]. It will use the value RB identity-1 as in TS 38.331 [3]);</li>        <li id="ul0065-0002" num="0191">KEY (the ciphering keys for the control plane and for the user plane are K<sub>RRCenc </sub>and K<sub>UPenc</sub>, respectively).<br/>For NR sidelink communication, the ciphering function as specified in TS 33.501 [6] is applied with KEY (PEK), COUNT, BEARER and DIRECTION (which value shall be set is specified in TS 33.536 [14]) as input.</li>    </ul>    </li></ul></p><heading id="h-0024" level="2"><b>6</b>.<b>2</b>.<b>2</b>.<b>1</b> Data PDU for SRBs</heading><p id="p-0083" num="0192"><figref idref="DRAWINGS">FIG. <b>6</b>.<b>2</b></figref>.<b>2</b>.<b>1</b>-<b>1</b> shows the format of the PDCP Data PDU with 12 bits PDCP SN. This format is applicable for SRBs.</p><heading id="h-0025" level="1">FIG. <b>6</b>.<b>2</b>.<b>2</b>.<b>1</b>-<b>1</b> of 3GPP TS 38.323 V16.0.0, Entitled &#x201c;PDCP Data PDU Format for SRBs&#x201d;, is Reproduced as FIG. <b>11</b></heading><p id="p-0084" num="0193">3GPP TS 38.331 specifies multiple sidelink SRBs are established for transmitting PC5-RRC signalling (or messages) and PC5-S messages as follows:</p><heading id="h-0026" level="2"><b>5</b>.<b>8</b> Sidelink</heading><heading id="h-0027" level="2"><b>5</b>.<b>8</b>.<b>1</b> General</heading><p id="p-0085" num="0194">NR sidelink communication consists of unicast, groupcast and broadcast. The PC5-RRC connection is a logical connection between a pair of a Source Layer-2 ID and a Destination Layer-2 ID in the AS. The PC5-RRC signalling, as specified in sub-clause 5.8.9, can be initiated after its corresponding PC5 unicast link establishment (TS 23.287 [55]). The PC5-RRC connection and the corresponding sidelink SRBs and sidelink DRBs are released when the PC5 unicast link is released as indicated by upper layers.<br/>For each PC5-RRC connection of unicast, one sidelink SRB is used to transmit the PC5-S messages before the PC5-S security has been established. One sidelink SRB is used to transmit the PC5-S messages to establish the PC5-S security. One sidelink SRB is used to transmit the PC5-S messages after the PC5-S security has been established, which is protected. One sidelink SRB is used to transmit the PC5-RRC signalling, which is protected and only sent after the PC5-S security has been established.</p><p id="p-0086" num="0195">3GPP TR 23.752 introduces the issue on support of UE-to-UE Relay and related solutions for a new release (i.e. Release 17) as follows:</p><heading id="h-0028" level="2"><b>5</b>.<b>4</b> Key Issue #4: Support of UE-to-UE Relay</heading><heading id="h-0029" level="2"><b>5</b>.<b>4</b>.<b>1</b> General Description</heading><p id="p-0087" num="0196">This key issue intends to support for UE-to-UE Relay, including support for in coverage and out of coverage operation.<br/>At least the following aspects need to be considered in potential solutions:<ul id="ul0066" list-style="none">    <li id="ul0066-0001" num="0000">    <ul id="ul0067" list-style="none">        <li id="ul0067-0001" num="0197">How to (re)-select a UE-to-UE Relay UE in proximity?</li>        <li id="ul0067-0002" num="0198">Whether and how for the network can control the UE-to-UE Relay operation, at least including how to:        <ul id="ul0068" list-style="none">            <li id="ul0068-0001" num="0199">Authorize the UE-to-UE Relay, e.g. authorize a UE as UE-to-UE Relay?</li>            <li id="ul0068-0002" num="0200">Provide the visibility of source/target UE and the UE-to-UE Relay to the network for the purpose of, e.g. charging?</li>        </ul>        </li>        <li id="ul0067-0003" num="0201">How to establish the connection between the source UE and the target UEs via UE-to-UE Relay?</li>        <li id="ul0067-0004" num="0202">How to provide end-to-end QoS framework to satisfy the QoS requirements (such as data rate, reliability, latency)?</li>        <li id="ul0067-0005" num="0203">How to enhance the system architecture to provide the security protection for relayed connection?</li>        <li id="ul0067-0006" num="0204">How to provide a mechanism for path changing in case of e.g. UE-to-UE Relay changes?</li>    </ul>    </li></ul></p><p id="p-0088" num="0205">NOTE 1: For the involvement of NG-RAN, coordination with RAN WGs is needed.</p><p id="p-0089" num="0206">NOTE 2: For security aspects, coordination with SA3 is needed.</p><p id="p-0090" num="0000"><b>6</b>.<b>9</b> Solution #9: Connection establishment via UE-to-UE Layer-2 Relay</p><heading id="h-0030" level="2"><b>6</b>.<b>9</b>.<b>1</b> Description</heading><heading id="h-0031" level="2"><b>6</b>.<b>9</b>.<b>1</b>.<b>1</b> General</heading><p id="p-0091" num="0207">Using the solution described in this clause, a UE-to-UE Relay enables the discovery of a source UE by a target UE. A UE-to-UE Relay is authorized to relay messages between two UEs over the PC5 interface via authorization and provisioning, as defined in clause 6.Y Solution for Key Issue #4: UE-to-UE Relay Authorization and Provisioning.<br/>The source UE announces its supported applications or discovers a target UE using a known discovery mechanism, e.g. using user-oriented or service-oriented methods as defined in TS 23.287 [5].<br/>The UE-to-UE Relay listens for ProSe applications advertisements (e.g. Direct Discovery or Direct Communication Request messages) from surrounding UEs and if a broadcasted application matches one of the applications from its provisioned relay policy/parameters, the UE-to-UE Relay advertises it as a relayed application by adding a relay indication to the message.<br/>A target UE discovers a source UE via a UE-to-UE Relay. The target UE receives a broadcast Direct Communication Request message with a relay indication.<br/>A secured &#x201c;extended&#x201d; PC5 link is set up between the source UE and the target UE via the UE-to-UE Relay. The source/target UEs do not know their respective peer UE's L2 IDs. Source/Target UEs send messages to the UE-to-UE Relay and receive messages through the UE-to-UE Relay. However, the security association and the PC5 unicast link are established directly between the source UE and target UE. The UE-to-UE Relay forwards the messages in opaque mode, without the ability to read, modify their content or replay them. The source/target UEs detect that the link establishment is going through a UE-to-UE Relay upon detecting a relay indication included in the received messages.<br/>The UE-to-UE Relay assigns itself two Relay-L2 IDs when a unicast link is established between two peer UEs via the UE-to-UE Relay. The first Relay-L2 ID is used when forwarding a message to the target UE. The second Relay-L2 ID is used when forwarding a message to the source UE. The UE-to-UE Relay maintains a mapping table containing the mapping of peer UEs L2 IDs and the corresponding Relay-L2 IDs that have been self-assigned. When receiving a message, the UE-to-UE Relay uses its mappings table to find the source and destination IDs to be used to forward the message to the target UE. The UE-to-UE Relay uses the Relay-L2 ID specified in the destination field to find the related UE and uses the UE's L2 ID specified in the source field to find the related Relay-L2 ID. It then updates the source and destination fields of the received message with its corresponding UE's L2 ID and Relay-L2 ID before forwarding the message.<ul id="ul0069" list-style="none">    <li id="ul0069-0001" num="0000">    <ul id="ul0070" list-style="none">        <li id="ul0070-0001" num="0208">NOTE: Additional security-related parameters and procedures may be needed for the protection of relay related messages. Their definitions need to be coordinated with SA WG3.<br/>Link management (i.e. keepalive, link modification, link identifier update and link release) is supported over direct unicast links and needs to be supported over extended PC5 links as well.<br/>Since the security association of extended PC5 links is between the peer UEs, all messages sent over the extended PC5 link, including link management (i.e. PC5-S) messages, may only be processed by those two UEs.<br/>Having the PC5 link management messages processed by the peer UE is not a problem for most of the management functionality. For the keepalive functionality, both UEs may send/receive keepalive messages and validate that the extended link is still alive. For the link modification, that is used to add or remove QoS flows or services or modify QoS flows, it needs to be applied to the extended link and handled by the two peer UEs. For the link release, the peer UEs may exchange the release messages and then inform the UE-to-UE Relay (i.e. using the management link as defined in clause 6.9.2.2) to allow it to clean-up its mapping table.<br/>As for the link identifier update procedure, the peer UEs cannot update their Layer-2 IDs transparently to the UE-to-UE Relay. The reason is that the UEs do not know their peer's Layer-2 ID since they are addressing their outgoing messages to the UE-to-UE Relay Layer-2 ID. The UE-to-UE Relay uses the Layer-2 IDs of the peer UEs for relaying purposes, thus the UE-to-UE Relay must be informed of the updated Layer-2 ID from both peer UEs. Additionally, the UE-to-UE Relay must change its Layer-2 IDs, associated to the extended link, whenever the peer UEs change their Layer-2 IDs since the UE-to-UE Relay L2 IDs used for this unicast link are visible in the header thus may be used to link the UEs old Layer-2 IDs with their new Layer-2 IDs. In summary, when the initiating UE changes its identifiers (e.g. Layer-2 ID and security info), the UE-to-UE Relay needs to update its Layer-2 ID used on the unicast link with the initiating UE and since the security info (established between the two peers UEs) is also updated, the identifiers used over the unicast link between the UE-to-UE Relay and the target UE also need to be updated.<br/>To update identifiers used for unicast communication via a UE-to-UE Relay, i.e. for an extended unicast link, a &#x201c;management&#x201d; unicast link is established between each UE and the UE-to-UE Relay. This management link is secured (i.e. integrity and confidentiality protected) between the UE and the UE-to-UE Relay. It is used to manage extended links associated to the same UE-to-UE Relay as the management link. If multiple UE-to-UE Relays are used to reach peer UEs then multiple managements links may be created by a UE, e.g. one toward each UE-to-UE Relay.<br/>Existing Link Identifier Update messages sent to the UE-to-UE Relay are modified to include additional information needed by the UE-to-UE Relay to identify the extended unicast link to which these messages apply. The additional information includes: 1) &#x201c;extended link&#x201d; indication, 2) UE's current Layer-2 ID used on extended link, 3) UE's new Layer-2 ID for extended link, 4) UE-to-UE Relay's Layer-2 ID used on extended link.<br/>A management link may be released once the link identifier update procedure is completed, or it may be kept. If it is kept then it is treated like any other PC5 unicast link, i.e. its Layer-2 IDs need to be updated periodically, keepalive may be exchanged, etc.</li>    </ul>    </li></ul></p><heading id="h-0032" level="2"><b>6</b>.<b>9</b>.<b>1</b>.<b>2</b> Control and User Plane Protocol Stacks</heading><p id="p-0092" num="0209"><figref idref="DRAWINGS">FIG. <b>6</b>.<b>9</b></figref>.<b>1</b>.<b>2</b>-<b>1</b> illustrates control plane protocol stacks using a UE-to-UE Layer-2 Relay. UE-to-UE Layer-2 Relay uses self-generated own Layer-2 IDs inserted as source Layer-2 ID in the already formed L2 frames relayed between UE1 and UE2. L2 frames are forwarded based on mapped UE1 Layer-2 ID, UE2 Layer-2 ID. The signalling messages are transparently transferred between UE1 and UE2 over UE-to-UE Layer-2 Relay without any modification other than the source and destination Layer-2 IDs. The security is established end to end between UE1 and UE2 as shown by the PDCP layer terminating in UE1 and UE2.</p><heading id="h-0033" level="1">FIG. <b>6</b>.<b>9</b>.<b>1</b>.<b>2</b>-<b>1</b> of 3GPP TR 23.752 V0.4.0, Entitled &#x201c;Control Plane Protocol Stacks for PC5 Using a UE-to-UE Layer-2 Relay&#x201d;, is Reproduced as FIG. <b>12</b></heading><p id="p-0093" num="0210"><figref idref="DRAWINGS">FIG. <b>6</b>.<b>9</b></figref>.<b>1</b>.<b>2</b>-<b>2</b> illustrates user plane protocol stacks using a UE-to-UE Layer-2 Relay. As for the control plane, the security is established end to end between UE1 and UE2. Therefore, user data is never exposed at the relay node since the relay function does not process/apply any security on relayed IP packets.</p><heading id="h-0034" level="1">FIG. <b>6</b>.<b>9</b>.<b>1</b>.<b>2</b>-<b>2</b> of 3GPP TR 23.752 V0.4.0, Entitled &#x201c;User Plane Protocol Stacks Using a UE-to-UE Layer-2 Relay&#x201d;, is Reproduced as FIG. <b>13</b></heading><p id="p-0094" num="0211">The SDAP and PDCP protocols above are as specified in TS 38.300 [11].<ul id="ul0071" list-style="none">    <li id="ul0071-0001" num="0000">    <ul id="ul0072" list-style="none">        <li id="ul0072-0001" num="0212">Editor's note: The proposed protocol stacks are to be confirmed with RAN WG2.</li>    </ul>    </li></ul></p><heading id="h-0035" level="2"><b>6</b>.<b>9</b>.<b>2</b> Procedures</heading><heading id="h-0036" level="2"><b>6</b>.<b>9</b>.<b>2</b>.<b>1</b> Connection Establishment</heading><p id="p-0095" num="0213">The two methods defined in TS 23.287 [5], i.e. service-oriented and user-oriented are supported using the procedure described in this clause.<br/><figref idref="DRAWINGS">FIG. <b>6</b>.<b>9</b></figref>.<b>2</b>-<b>1</b> shows the peer discovery and unicast link establishment over PC5 reference point via a UE-to-UE Relay.</p><heading id="h-0037" level="1">FIG. <b>6</b>.<b>9</b>.<b>2</b>-<b>1</b> of 3GPP TR 23.752 V0.4.0, Entitled &#x201c;Connection Establishment Procedure Via a UE-to-UE Relay&#x201d;, is Reproduced as FIG. <b>14</b></heading><p id="p-0096" num="0214">0. UE-to-UE Relay registers with the network and specifies its UE-to-UE Relay capabilities. UE-to-UE Relay is provisioned from the network with relay policy parameters and with a unique Relay identifier (RID).</p><p id="p-0097" num="0215">1. The target UEs (i.e. UE2, UE3 and UE4) determine the destination Layer-2 ID for signalling reception for PC5 unicast link establishment as specified in TS 23.287 [5] clause 5.6.1.4. The destination Layer-2 ID is configured with the target UEs as specified in TS 23.287 [5] clause 5.1.2.1.<ul id="ul0073" list-style="none">    <li id="ul0073-0001" num="0000">    <ul id="ul0074" list-style="none">        <li id="ul0074-0001" num="0216">On the source UE (i.e. UE1), the application layer provides information to the ProSe layer for PC5 unicast communication (e.g. broadcast Layer-2 ID, ProSe Application ID, UE's Application Layer ID, target UE's Application Layer ID, relay applicable indication), as specified in TS 23.287 [5] clause 6.3.3.1.</li>    </ul>    </li></ul></p><p id="p-0098" num="0217">3. ProSe layer triggers the peer UE discovery mechanism by sending a broadcast Direct Communication Request message. The message is sent using the source Layer-2 ID and broadcast Layer-2 ID as destination, and includes other parameters related to the application offered, as specified in TS 23.287 [5] clause 6.3.3.1. Optionally, ProSe Application Code obtained from 5G DDNMF via the solution for KI #1 is also included in the message.<ul id="ul0075" list-style="none">    <li id="ul0075-0001" num="0000">    <ul id="ul0076" list-style="none">        <li id="ul0076-0001" num="0218">The UE-to-UE Relay receives the broadcast Direct Communication Request message and verifies if it's configured to relay this application, i.e. it compares the announce ProSe Application ID with its provisioned relay policy/parameters and, if it matches, the UE-to-UE Relay assigns itself a Relay-Layer-2 ID (e.g. R-L2 ID-a) for UE1 (i.e. related to UE1's L2 ID).<br/>These 2 IDs (UE1's Layer-2 ID and Relay-Layer-2 ID-a) are saved in a local mapping table. The UE-to-UE Relay overrides the source field of the message with its R-L2 ID-a and adds its unique relay identifier (RID) as a relay indication. This relay indication is added by the UE-to-UE Relay only on broadcast messages since these messages are sent in clear text (i.e. without any encryption or integrity protection) thus may be modified. The UE-to-UE Relay proceeds in forwarding the broadcast Direct Communication Request message received from the source UE.</li>    </ul>    </li></ul></p><p id="p-0099" num="0219">4. Target UE3 is interested in the announced application or it can match the ProSe Application Code contained in the request message thus, it triggers the authentication and security establishment with UE1, via the UE-to-UE Relay. UE3 keeps track of the Relay's identifiers, i.e. R-L2 ID-a and RID. UE3 sends the RID in a security protected message during the authentication and security establishment to inform UE1 that the communication is traversing the UE-to-UE Relay identified by RID.</p><p id="p-0100" num="0000">UE-to-UE Relay receives the message from UE3 and uses the R-L2 ID-a specified in the destination field to find the related UE (i.e. UE1 in this case) in its mapping table.<br/>UE-to-UE Relay assigns itself a new Layer-2 ID (e.g. R-L2 ID-b) for UE3 and stores the mapping between UE3's L2 ID and R-L2 ID-b.<br/>UE-to-UE Relay sets the source field of the message to R-L2 ID-b and sets the destination field to UE1's Layer-2 ID (i.e. L2 ID1) retrieved from the mapping entry. UE-to-UE Relay sends the message to UE1.<br/>UE1 receives the authentication message and keeps track of R-L2 ID-b and RID. R-L2 ID-b is used as the destination on subsequent messages destined to UE3 and sent via the UE-to-UE Relay. Authentication and security establishment messages are exchanged between UE1 and UE3 via the UE-to-UE Relay. UE-to-UE Relay changes the source/destination Layer-2 IDs based on the information saved in its local mapping table.</p><p id="p-0101" num="0220">Editor's note: The Details of the authentication and security procedure will be investigated by SA WG3 group.</p><p id="p-0102" num="0221">5. Once the security is established, UE3 completes the unicast link establishment by sending a Direct Communication Accept message.</p><p id="p-0103" num="0222">6. UE-to-UE Relay receives the message and sets the source field of the message to the R-L2 ID-b as found in the mapping entry and sets the destination field to the UE1's L2 ID also from the mapping entry. UE-to-UE Relay sends the modified message to UE1.</p><p id="p-0104" num="0223">7. An &#x201c;extended&#x201d; unicast link is established between UE1 and UE3, via the UE-to-UE Relay. The extended link is secured end to end, i.e. a security association has been created between UE1 and UE3. Confidentiality and/or integrity/replay protected messages (i.e. data or PC5-S) may be exchanged between UE1 and UE3. The UE-to-UE Relay is not involved in the security association thus it cannot read nor modify the secured portion of the message (which excludes the source and destination fields).</p><p id="p-0105" num="0000">In addition, the UE-to-UE Layer-2 Relay operation is also supported with the following principles:<ul id="ul0077" list-style="none">    <li id="ul0077-0001" num="0000">    <ul id="ul0078" list-style="none">        <li id="ul0078-0001" num="0224">UE-to-UE Relay selection.        <ul id="ul0079" list-style="none">            <li id="ul0079-0001" num="0225">It may be the situation where multiple UE-to-UE relays can be used to achieve the indirect communication between the target UE and source UE. The selection of the UE-to-UE Relay may be based on local configured rules on the UE, or based on other UE-to-UE Relay selection solutions, e.g. &#x201c;UE-to-UE Relay Selection Without Relay Discovery&#x201d; described in clause 6.8.</li>        </ul>        </li>        <li id="ul0078-0002" num="0226">QoS handling.        <ul id="ul0080" list-style="none">            <li id="ul0080-0001" num="0227">During the process of the connection establishment between the Source UE1 and the Target UE3, the Source UE1 negotiates the PC5 QoS parameters with the UE-to-UE Relay UE and Target UE3 for fulfilling E2E QoS requirements. After that, PC5 QoS parameters for PC5 link between the Source UE and UE-to-UE Relay UE and PC5 link between the UE-to-UE Relay UE and Target UE are determined. AS layer configurations for PC5 QoS parameters in each PC5 link can be achieved according to legacy mechanisms in R16 V2X.</li>            <li id="ul0080-0002" num="0228">QoS flow concept in particular can be reused between the Source UE and the Target UE, where the UE-to-UE Relay UE performs the necessary adaptation between two PC5 interfaces, i.e. PC5 for the Source UE and UE-to-UE Relay UE and PC5 for the UE-to-UE Relay UE and Target UE.</li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0106" num="0229">Editor's note: The details of the adaptation between two PC5 interfaces are confirmed by RAN WG2.<ul id="ul0081" list-style="none">    <li id="ul0081-0001" num="0000">    <ul id="ul0082" list-style="none">        <li id="ul0082-0001" num="0230">Charging support.        <ul id="ul0083" list-style="none">            <li id="ul0083-0001" num="0231">The charging for Source UE and Target UE can be based on charging usage information configuration and UE reporting usage information. Solution for charging usage information configuration can reuse the PCF based solution, i.e., Solution #14. Solution for UE reporting usage information can reuse SMF based or AMF based solution, i.e., Solution #13 or Solution #15.</li>        </ul>        </li>    </ul>    </li></ul></p><heading id="h-0038" level="2"><b>6</b>.<b>9</b>.<b>2</b>.<b>2</b> Connection Management</heading><p id="p-0107" num="0232"><b>6</b>.<b>9</b>.<b>2</b>.<b>2</b> Link Identifier Update Via a Management Link with the UE-to-UE Relay<br/><figref idref="DRAWINGS">FIG. <b>6</b>.<b>9</b></figref>.<b>2</b>.<b>2</b>-<b>1</b> shows the link identifier update procedure when an extended PC5 link is used. The procedure uses a management link established between UE1 and the UE-to-UE Relay serving this extended link and another management link established between UE2 and the same UE-to-UE Relay.</p><heading id="h-0039" level="1">FIG. <b>6</b>.<b>9</b>.<b>2</b>.<b>2</b>-<b>1</b> of 3GPP TR 23.752 V0.4.0, Entitled &#x201c;Link Identifier Update Procedure Via a Management Link with a UE-to-UE Relay&#x201d;, is Reproduced as FIG. <b>15</b></heading><p id="p-0108" num="0233">0) An &#x201c;extended&#x201d; unicast link is established between two peer UEs via a UE-to-UE Relay, i.e. as described in clause 6.9.2.1 with end-to-end security enabled.</p><p id="p-0109" num="0234">1) UE1 receives a trigger (e.g. privacy timer expiry or Application Layer ID change) to update its identifiers (i.e. Layer-2 ID, security information, Application Layer ID or IP address/prefix) associated to the extended link with UE2. UE1 establishes a secured unicast link with the UE-to-UE Relay for link management purposes, if such a link is not already established.</p><p id="p-0110" num="0235">2) UE1 updates its identifiers (i.e. Layer-2 ID, security information and optionally Application Layer ID and IP address/prefix) and sends a Link Identifier Update Request message to the UE-to-UE Relay via the management link. The message includes UE1's new Layer-2 ID and an indication (e.g. &#x201c;extended link&#x201d; indication) which specifies that the message is related to an extended link, i.e. it does not apply to the management link per se. The message also includes the UE-to-UE Relay's Layer-2 ID and UE1's Layer-2 ID used to identify the extended link.<ul id="ul0084" list-style="none">    <li id="ul0084-0001" num="0000">    <ul id="ul0085" list-style="none">        <li id="ul0085-0001" num="0236">a. Other identifiers (i.e. security info, Application Layer ID and IP address/prefix) are not included since they are not used by the UE-to-UE Relay and should not be exposed to the UE-to-UE Relay.</li>    </ul>    </li></ul></p><p id="p-0111" num="0237">3) UE-to-UE Relay saves UE1's new Layer-2 ID in its mapping table, while preserving the current one, and updates its own Layer-2 ID to replace the current UE-to-UE Relay L2 ID used on the extended link and known by UE2. It replies with Link Identifier Update Response message including its new UE-to-UE Relay Layer-2 ID and the &#x201c;extended link&#x201d; indication.</p><p id="p-0112" num="0238">4) UE1 sends a Link Identifier Update Request message to UE2 including the new UE-to-UE Relay L2 ID received at step 3, UE1's updated security information and optionally new Application Layer ID and IP address/prefix.<ul id="ul0086" list-style="none">    <li id="ul0086-0001" num="0000">    <ul id="ul0087" list-style="none">        <li id="ul0087-0001" num="0239">a. The Link Identifier Update Request message is used as usual, except for the new L2 ID parameter that carries the new UE-to-UE Relay L2 ID to be used by UE2.</li>    </ul>    </li></ul></p><p id="p-0113" num="0240">5) UE2 keeps track of the received parameters and establishes a secured unicast link with the UE-to-UE Relay for extended unicast link management, if no such management link already exists.</p><p id="p-0114" num="0241">6) As for UE1 in step 2, UE2 updates its identifiers associated to the extended link with UE1 and sends a Link Identifier Update Request message to UE-to-UE Relay via the management link. The Link Identifier Update Request message includes the &#x201c;extended link&#x201d; indication, the current UE-to-UE Relay's Layer-2 ID and UE2's Layer-2 ID (to identify the extended link) as well as UE2's new Layer-2 ID associated to the extended link.</p><p id="p-0115" num="0242">7) UE-to-UE Relay saves UE2's new Layer-2 ID in its mapping table, while preserving the current one, and updates its own Layer-2 ID to replace the current UE-to-UE Relay L2 ID used on the extended link and known by UE1. It replies with Link Identifier Update Response message including its new UE-to-UE Relay Layer-2 ID and the &#x201c;extended link&#x201d; indication.</p><p id="p-0116" num="0243">8) UE2 sends a Link Identifier Update Response message to UE1 including the new UE-to-UE Relay L2 ID received at step 7, UE2's updated security information and optionally new Application Layer ID and IP address/prefix. UE2 also includes the parameters received on the Link Identifier Update Request message at step 4.</p><p id="p-0117" num="0244">9) UE1 keeps track of the received updated parameters from UE2 and sends a Link Identifier Update Ack message to UE2, including the parameters received on the Link Identifier Update Response message at step 8.</p><p id="p-0118" num="0245">10) UE1 sends a Link Identifier Update Ack message to the UE-to-UE Relay, including the new UE-to-UE Relay Layer-2 ID received at step 3 and the &#x201c;extended link&#x201d; indication.<ul id="ul0088" list-style="none">    <li id="ul0088-0001" num="0000">    <ul id="ul0089" list-style="none">        <li id="ul0089-0001" num="0246">UE2 sends a Link Identifier Update Ack message to the UE-to-UE Relay, including the new UE-to-UE Relay Layer-2 ID received at step 7 and the &#x201c;extended link&#x201d; indication. All UEs (i.e. UE1, UE2 and UE-to-UE Relay) start using the new Layer-2 IDs, new security information and optionally new Application Layer ID and new IP address/prefix.</li>    </ul>    </li></ul></p><heading id="h-0040" level="2"><b>6</b>.<b>9</b>.<b>3</b> Impacts on Services, Entities and Interfaces</heading><p id="p-0119" num="0247">The solution has impacts in the following entities:</p><heading id="h-0041" level="2">UE:</heading><p id="p-0120" num="0000"><ul id="ul0090" list-style="none">    <li id="ul0090-0001" num="0000">    <ul id="ul0091" list-style="none">        <li id="ul0091-0001" num="0248">Needs to support procedures for ProSe 5G UE-to-UE Relay and communications via a ProSe 5G UE-to-UE Relay.</li>        <li id="ul0091-0002" num="0249">Needs to support procedures for extended communication management, via communication with a ProSe 5G UE-to-UE Relay.</li>    </ul>    </li></ul></p><heading id="h-0042" level="2"><b>6</b>.<b>31</b> Solution #31: QoS Control for UE-to-UE Relay</heading><heading id="h-0043" level="2"><b>6</b>.<b>31</b>.<b>1</b> Description</heading><p id="p-0121" num="0250">This is a solution for Key Issue #4, UE-to-UE Relay. This solution is applicable for both Layer 2 UE-to-UE Relay and Layer 3 UE-to-UE Relay.<br/>When a source UE wants to establish unicast communication with a target UE, the source UE will decide the E2E QoS parameters between source UE and target UE based on the application layer requirements. The E2E QoS parameters, especially the PDB, needs to be split between the two PC5 interface. The PER of the two PC5 interfaces also needs to be set properly to achieve the PER target in the E2E QoS parameters.<br/>Relay will split the E2E QoS parameters into two parts: one part is the QoS parameters between source UE and Relay (we call it &#x201c;Source side PC5 QoS parameters&#x201d;), the other part is the QoS parameters between Relay and the target UE (we call it &#x201c;Target side PC5 QoS parameters&#x201d;). When standardized PQI is used, the Source side PC5 QoS parameters and the Target side PC5 QoS parameters include PQI and other optional QoS parameters, e.g. GFBR. When non-standardized PQI is used, the whole set of PC5 QoS characteristics is also included.<br/>Relay ensures the PDB and PER associated with the PQI in the Source side PC5 QoS parameters and the PDB and PER associated with the PQI in the Target side PC5 QoS parameters supports the E2E PDB requirements between Remote UE and target UE. Relay also ensures other QoS parameters/QoS characteristics in the Source side PC5 QoS parameters and Target side PC5 QoS parameters are compatible, e.g. have the same value. The Relay decision may be based on the local policy or the low layer measurement.<br/>Optionally, it's possible that the source UE is pre-configured with authorized service(s) and the related Source side PC5 QoS parameters, the UE-to-UE Relay is pre-configured with authorized service(s) and the related Target side PC5 QoS parameters. These can be provided by PCF during provisioning procedure. The authorized service can be identified by Relay Service Code etc. With the preconfigured QoS parameters, the source UE provides the Source side PC5 QoS parameters to the UE-to-UE Relay by the procedure defined in TS 23.287 [5] clause 6.3.3.1 or 6.3.3.4, then the UE-to-UE Relay identifies the authorized service and establishes the corresponding PC5 QoS Flows with the Target UE using the preconfigured Target side PC5 QoS parameters.<br/>E2E QoS parameters splitting is common for both Layer 2 UE-to-UE Relay and Layer 3 UE-to-UE Relay. The difference lies in the QoS flow. In the Layer 3 UE-to-UE Relay case, two QoS flows are setup, one QoS flow between Source UE and UE-to-UE Relay UE, and another QoS flow between Source UE and UE-to-UE Relay UE. In the Layer 2 UE-to-UE Relay case, the end-to-end QoS flow is setup between the Source UE and the Target UE.</p><heading id="h-0044" level="2"><b>6</b>.<b>31</b>.<b>2</b> Procedures for Layer 3 UE-to-UE Relay</heading><heading id="h-0045" level="1">FIG. <b>6</b>.<b>31</b>.<b>2</b>-<b>1</b> of 3GPP TR 23.752 V0.4.0, Entitled &#x201c;QoS Control for Layer 3 UE-to-UE Relay&#x201d;, is Reproduced as FIG. <b>16</b></heading><p id="p-0122" num="0251">1. Source UE wants to establish unicast communication with target UE, it decides the E2E QoS parameters between source UE and target UE based on the application layer requirements. The Source UE sets up a PC5 QoS Flow with PFI=PFI_s. Then Source UE provides the PFI_s, E2E QoS parameters, source and target user info to UE-to-UE Relay. The process is similar to the unicast L2 link establishment or modification procedure as defined in TS 23.287 [5] clause 6.3.3.</p><p id="p-0123" num="0252">2. Relay splits the E2E QoS parameters into two parts: one part is for the PC5 interface between source UE and Relay, the other part is for the PC5 interface between Relay and the target UE. Relay will setup a PC5 QoS Flow with PFI=PFI_t using the target side PC5 QoS parameters between Relay and the target UE.</p><p id="p-0124" num="0253">3. Relay provides the PFI_t, target side PC5 QoS parameters, source and target user info to target UE. The process is similar to the unicast L2 link establishment or modification procedure as defined in TS 23.287 [5] clause 6.3.3.</p><p id="p-0125" num="0254">4. Relay receives the Layer-2 link establishment/modification accept from target UE.</p><p id="p-0126" num="0255">5. Relay provides the Layer-2 link establishment/modification accept to the source UE with the PFI_s and the source side PC5 QoS parameters.</p><p id="p-0127" num="0000">The data transfer on Layer 3 UE-to-UE Relay is according to traffic filter on both hops.</p><heading id="h-0046" level="2"><b>6</b>.<b>31</b>.<b>3</b> Procedures for Layer 2 UE-to-UE Relay</heading><heading id="h-0047" level="1">FIG. <b>6</b>.<b>31</b>.<b>3</b>-<b>1</b> of 3GPP TR 23.752 V0.4.0, Entitled &#x201c;QoS Control for Layer 2 UE-to-UE Relay&#x201d;, is Reproduced as FIG. <b>17</b></heading><p id="p-0128" num="0256">0. When the Source UE wants to communication with the target UE, it uses the extended unicast link defined in Solution #9, and the Source UE decides the E2E QoS parameters between Source UE and Target UE based on the application layer requirements. The Source UE sets up a PC5 QoS Flow with PFI, similar to the V2X mechanism defined in clause 6.3.3.1 of TS 23.287 [5], the Source UE negotiates the information about PC5 QoS Flow, which includes the PFI, the corresponding E2E PC5 QoS parameters and the associated application info, with the Target UE in step 0a and step 0b. In this step, E2E PC5-S messages are used for E2E QoS negotiation, and the UE-to-UE Relay just transfers the E2E PC5-S messages using the RAN specified L2 relay method.</p><p id="p-0129" num="0257">NOTE: The PC5-S messages used in step 0 are the E2E PC5-S messages transferred between the Source UE and the Target UE and the PC5-S messages used in step 1 to step 5 are the per-hop PC5-S messages transferred between the Source UE or the Target UE and the UE-to-UE Relay.</p><p id="p-0130" num="0258">1. After the E2E QoS parameter negotiation in step 0a and step 0b, the Source UE provides the PFI, E2E QoS parameters, source and target user info to UE-to-UE Relay. The process is similar to the unicast L2 link establishment or modification procedure as defined in TS 23.287 [5] clause 6.3.3.</p><p id="p-0131" num="0259">2. Relay splits the E2E QoS parameters into two parts: one part is for the PC5 interface between source UE and Relay (source side PC5 QoS parameters), the other part is for the PC5 interface between Relay and the target UE (target side PC5 QoS parameters).</p><p id="p-0132" num="0260">3. Relay provides the PFI received from source UE, target side PC5 QoS parameters, source and target user info to target UE. The process is similar to the unicast L2 link establishment or modification procedure as defined in TS 23.287 [5] clause 6.3.3.</p><p id="p-0133" num="0261">4. Relay receives the Layer-2 link establishment/modification accept from target UE.</p><p id="p-0134" num="0262">5. Relay provides the Layer-2 link establishment/modification accept to the source UE with the PFI and the source side PC5 QoS parameters.</p><p id="p-0135" num="0000">After the PC5 QoS parameters splitting for two PC5 links, the AS layer configurations for PC5 QoS parameters in each of the PC5 links can be achieved according to legacy mechanisms in Rel-16 V2X (TS 23.287 [5]). For the QoS enforcement, the UE-to-UE Relay UE performs the necessary adaptation in the AS layers of the two PC5 interfaces, and it transfers the received data based on the adaptation in the AS layer.</p><p id="p-0136" num="0263">Editor's note: How to ensure the PC5 QoS over the two PC5 links by the Adaptation Layer, and the functionalities of the Adaptation Layer will be confirmed by RAN WG2.</p><p id="p-0137" num="0000">If the Source UE or Target UE wants to add, remove or modify a QoS flow on the extended unicast link, the link modification procedure defined in clause 6.3.3.4 of TS 23.287 [5] can be used, where the Link Modification Request message is the E2E PC5-S message.</p><heading id="h-0048" level="2"><b>6</b>.<b>31</b>.<b>4</b> Impacts on Services, Entities and Interfaces</heading><p id="p-0138" num="0000"><ul id="ul0092" list-style="none">    <li id="ul0092-0001" num="0000">    <ul id="ul0093" list-style="none">        <li id="ul0093-0001" num="0264">UE-to-UE Relay supports the E2E QoS parameters splitting between the two PC5 interfaces.</li>    </ul>    </li></ul></p><p id="p-0139" num="0265">3GPP TR 38.836 specifies Architecture and Protocol Stack for Layer-2 UE-to-UE relay as follows:</p><heading id="h-0049" level="2"><b>5</b>.<b>5</b> Layer-2 Relay</heading><heading id="h-0050" level="2"><b>5</b>.<b>5</b>.<b>1</b> Architecture and Protocol Stack</heading><p id="p-0140" num="0266">For L2 UE-to-UE Relay architecture, the protocol stacks are similar to L2 UE-to-Network Relay other than the fact that the termination points are two Remote UEs. The protocol stacks for the user plane and control plane of L2 UE-to-UE Relay architecture are described in <figref idref="DRAWINGS">FIG. <b>5</b>.<b>5</b></figref>.<b>1</b>-<b>1</b> and <figref idref="DRAWINGS">FIG. <b>5</b>.<b>5</b></figref>.<b>1</b>-<b>2</b>.<br/>An adaptation layer is supported over the second PC5 link (i.e. the PC5 link between Relay UE and Destination UE) for L2 UE-to-UE Relay. For L2 UE-to-UE Relay, the adaptation layer is put over RLC sublayer for both CP and UP over the second PC5 link. The sidelink SDAP/PDCP and RRC are terminated between two Remote UEs, while RLC, MAC and PHY are terminated in each PC5 link.</p><heading id="h-0051" level="1">FIG. <b>5</b>.<b>5</b>.<b>1</b>-<b>1</b> of 3GPP TR 38.836 V1.0.0, Entitled &#x201c;User Plane Protocol Stack for L2 UE-to-UE Relay&#x201d;, is Reproduced as FIG. <b>18</b></heading><heading id="h-0052" level="1">FIG. <b>5</b>.<b>5</b>.<b>1</b>-<b>2</b> of 3GPP TR 38.836 V1.0.0, Entitled &#x201c;Control Plane Protocol Stack for L2 UE-to-UE Relay&#x201d;, is Reproduced as FIG. <b>19</b></heading><p id="p-0141" num="0267">For the first hop of L2 UE-to-UE Relay,<ul id="ul0094" list-style="none">    <li id="ul0094-0001" num="0000">    <ul id="ul0095" list-style="none">        <li id="ul0095-0001" num="0268">The N:1 mapping is supported by first hop PC5 adaptation layer between Remote UE SL Radio Bearers and first hop PC5 RLC channels for relaying.</li>        <li id="ul0095-0002" num="0269">The adaptation layer over first PC5 hop between Source Remote UE and Relay UE supports to identify traffic destined to different Destination Remote UEs.<br/>For the second hop of L2 UE-to-UE Relay,</li>        <li id="ul0095-0003" num="0270">The second hop PC5 adaptation layer can be used to support bearer mapping between the ingress RLC channels over first PC5 hop and egress RLC channels over second PC5 hop at Relay UE.</li>        <li id="ul0095-0004" num="0271">PC5 Adaptation layer supports the N:1 bearer mapping between multiple ingress PC5 RLC channels over first PC5 hop and one egress PC5 RLC channel over second PC5 hop and supports the Remote UE identification function.<br/>For L2 UE-to-UE relay,</li>        <li id="ul0095-0005" num="0272">The identity information of Remote UE end-to-end Radio Bearer is included in the adaptation layer in first and second PC5 hop.</li>        <li id="ul0095-0006" num="0273">In addition, the identity information of Source Remote UE and/or the identity information of Destination Remote UE are candidate information to be included in the adaptation layer, which are to be decided in WI phase.</li>    </ul>    </li></ul></p><p id="p-0142" num="0274">Key issue #4 in 3GPP TR 23.752-040 describes support of UE-to-UE Relay in the following release (i.e. Release 17), which means a relay may be used to support data communication between two UEs in case these two UEs cannot communicate with each other directly. It is supposed that a UE-to-UE Relay needs to establish one PC5 unicast link with each of a Source UE and a Target UE such that the integrated (or extended) PC5 unicast link between the Source UE and the Target UE can support the concerned ProSe service as illustrated in <figref idref="DRAWINGS">FIG. <b>20</b></figref>.</p><p id="p-0143" num="0275">3GPP TS 23.287 specifies a Link Identifier Update procedure for updating identifiers used for unicast mode of V2X communication over PC5 reference point, which may include an Application Layer ID, a Layer-2 ID, an IP address/prefix, and/or security information. The security information may be used for protecting communication between the first UE and the second UE. When receiving a Link Identifier Update Request message from a UE, the peer UE may change its identifiers and include them in a Link Identifier Update Response message sent to the UE.</p><p id="p-0144" num="0276"><figref idref="DRAWINGS">FIG. <b>15</b></figref> (which is a reproduction of <figref idref="DRAWINGS">FIG. <b>6</b>.<b>9</b></figref>.<b>2</b>.<b>2</b>-<b>1</b> of 3GPP TR 23.752 V0.4.0) illustrates procedures for Link Identifier Update in the scenario of a UE-to-UE relaying. Basically, the Link Identifier Update procedure is performed after the sidelink security has been established between two concerned UEs. Since the Layer-2 ID of the Source UE is used for communications on the PC5 unicast link between the Source UE and the UE-to-UE Relay and the Layer-2 ID of the Target UE is used for communications on the PC5 unicast link between the Target UE and the UE-to-UE Relay while other identities (e.g. an Application Layer ID and an IP address/prefix) are used for communications between the Source UE and the Target UE and should not be exposed to the UE-to-UE Relay, Solution #9 in 3GPP TR 23.752 proposes two types of Link Identifier Update procedure in <figref idref="DRAWINGS">FIG. <b>15</b></figref>. One type of Link Identifier Update procedure is used for updating Layer-2 ID(s) between the Source UE and the UE-to-UE Relay as well as for updating Layer-2 ID(s) between the Target UE and the UE-to-UE Relay. The other type of Link Identifier Update procedure is used for updating other identities (e.g. an Application Layer ID and/or an IP address/prefix) between the Source UE and the Target UE. An indication (e.g. &#x201c;extended link&#x201d; indication) is inlcuded in the Link Identifier Update Request message for the UE-to-UE Relay to identify the related procedure (or to distinguish one procedure from the other procedure).</p><p id="p-0145" num="0277">Since the Application Layer ID and/or the IP address/prefix of the Source UE (or the Target UE) should not be exposed to the UE-to-UE Relay, one way to realize this is to cipher, with an end-to-end security context, the content of the Link Identifier Update Request message used to carry the Application Layer ID and/or the IP address/prefix. The end-to-end security context refers to a security key and a security algorithm known between the Source UE and the Target UE (i.e. unknown to the UE-to-UE Relay). According to 3GPP standards (as discussed in 3GPP TS 38.323), the ciphering function is performed in the PDCP layer and the data part in a PDCP Data PDU shall be ciphered. Because the PC5-S message delivered from the upper layer (i.e. PC5 Signaling Protocol) forms the data part in a PDCP Data PDU, the whole PC5-S message will be ciphered. Therefore, the UE-to-UE Relay would not be able to read the indication included in the Link Identifier Update Request message to identify the related procedure and thus the solution proposed in 3GPP TR 23.752 is not feasible. Another solutions should be considered for the UE-to-UE Relay (or the relay UE) to distinguish whether a PC5-S message is destined for the UE-to-UE Relay or for the Target UE.</p><p id="p-0146" num="0278">Since there may be an end-to-end security between the Source UE and the Target UE as well as a local security between each of these two UEs and the UE-to-UE Relay, there is also a need for the UE-to-UE Relay to distinguish whether a PC5-S message used to establish the concerned security is destined for the UE-to-UE Relay or for the peer UE. The related solutions may also be applicable to other PC5-S messages which may be transmitted after the sidelink security has been established between two concerned UEs (e.g. the Link Modification Request message) due to the same consideration.</p><p id="p-0147" num="0279">As shown in <figref idref="DRAWINGS">FIG. <b>5</b>.<b>5</b></figref>.<b>1</b>-<b>2</b> of 3GPP TR 38.836 V1.0.0 (which is reproduced as <figref idref="DRAWINGS">FIG. <b>19</b></figref>), an adaptation layer may be added between the PC5-RLC layer and the PC5-PDCP layer in each UE and a Layer-2 UE-to-UE relay. One potential solution is for a Source UE to include information in the header of an adaptation layer PDU used to carry a PC5-S message. When receiving this PDU, the UE-to-UE Relay can know whether the PC5-S message in this PDU is destined for itself (i.e. the UE-to-UE relay) or for the Target UE according to the information. In case the Source UE may communicate with multiple Target UEs via the UE-to-UE Relay, the information may indicate the destination of the PC5-S message, where the destination may be the UE-to-UE Relay or one of the Target UEs.</p><p id="p-0148" num="0280">For example, the information could be an identity information and a specific value of the identity information may be used to identify the UE-to-UE Relay. The identity information is a field in the header. In one embodiment, the specific value may be a value with all bits of the identity information (or the field) set to &#x201c;0&#x201d; or &#x201c;1&#x201d;, e.g. &#x201c;000&#x201d; or &#x201c;111&#x201d; in case 3 bits are used to define the identity information. The rest values may then be used to identify other Target UEs. The values used to identify other Target UEs may be assigned by the Source UE and then delivered to the UE-to-UE Relay. It is also possible that these values are assigned by the UE-to-UE Relay and then delivered to the Source UE.</p><p id="p-0149" num="0281">The UE-to-UE Relay may then deliver the received PC5-S message (or the corresponding SDU) to its upper layer (i.e. PDCP) if the information indicates the PC5-S message is for the UE-to-UE Relay. Otherwise, the UE-to-UE Relay may forward the received PC5-S message (or the corresponding SDU) to the concerned Target UE.</p><p id="p-0150" num="0282">In case of a Layer-3 UE-to-UE Relay, the adaptation layer may be added between the PC5-PDCP layer and the PC5 Signaling Protocol layer in each UE and the Layer-3 UE-to-UE relay. Similarly, information may be included in the header of the adaptation layer PDU used to carry the PC5-S message to indicate the destination of the PC5-S message.</p><p id="p-0151" num="0283">In the above solution, the PC5-S messages destinated to the UE-to-UE Relay and the Target UE could be transmitted on the same sidelink SRB. In this situation, the PDCP entity of the sidelink SRB may need to handle two different sets of security parameters: one set for the local security and the other set for the end-to-end security. To avoid this complexity, another alternative solution could be that the PC5-S message destined for the UE-to-UE Relay and the PC5-S message destined for the Target UE could be transmitted on two different sidelink SRBs. By this way, the UE-to-UE Relay may then determine how to handle the received PC5-S message e.g. to deliver the received PC5-S message (or the corresponding SDU) to its upper layer (i.e. a PC5 Signaling Protocol) or to forward the received PC5-S message (or the corresponding SDU) to the Target UE, according to which sidelink SRB the PC5-S message is received on. Each sidelink SRB may be assocaited with a logical channel identity (LCID), which may be included in a MAC header of a MAC PDU used to carry the PC5-S message. In this situation, the PC5-S messages transmitted on these two sidelink SRBs would be ciphered with different sets of security parameters. One set could be used for PC5-S messages exchanged between the Source UE and the UE-to-UE Relay (i.e. the local security), and the other set could be used for PC5-S messages exchanged between the Source UE and the Target UE (i.e. the end-to-end security). In the above example, the PC5-S messages could be transmitted after the sidelink security has been established between two concerned UEs. The same solution may also be applicable to the PC5-S messages which are transmitted to establish the sidelink security. The PC5-S message used to establish the sidelink security may be a DIRECT LINK SECURITY MODE COMMAND message or a DIRECT LINK SECURITY MODE COMPLETE message. For example, one UE could transmit a DIRECT LINK SECURITY MODE COMMAND message to the other UE to initiate the sidelink security establishment procedure and then receives a DIRECT LINK SECURITY MODE COMPLETE message from the other UE to complete the sidelink security establishment procedure.</p><p id="p-0152" num="0284">In one embodiment, the sidelink SRB used for transmitting PC5-S messages to the Target UE could be configured (or assocaited) with an adaptation layer, while the sidelink SRB used for transmitting PC5-S messages to the UE-to-UE Relay is configured (or assocaited) with no adaptation layer.</p><p id="p-0153" num="0285">It may be also feasible for the Source UE to transmit the PC5-S messages destined for the UE-to-UE Relay on a sidelink SRB, while the PC5-S messages destined for the Target UE are trasnmitted on a sidelink DRB. Preferably, the sidelink DRB used for transmitting PC5-S messages to the Target UE is configured (or assocaited) with an adaptation layer, while the sidelink SRB used for transmitting PC5-S messages to the UE-to-UE Relay is configured (or assocaited) with no adaptation layer.</p><p id="p-0154" num="0286">Basically, a PC5-S message could be delivered from the upper layer to the adaptation layer in an adaptation layer SDU. In other words, the PC5-S message could be carried in the SDU, and the adaptation layer could generate an adaptation layer PDU corresponding to the adaptation layer SDU by adding a header for transmission. In other words, an adaptation layer PDU may comprise an adaptation layer SDU and a header. The header may include information identifying the Target UE. The header may also include information identifying the end-to-end Radio Bearer i.e. the DRB used to transmit the PC5-S messages to the Target UE. In case an SRB is used for transmitting the PC5-S messages to the Target UE, the LCID associated with the SRB may be used to identify the end-to-end Radio Bearer (i.e. the SRB).</p><p id="p-0155" num="0287">The above solutions may be applied to both Layer-2 and Layer-3 UE-to-UE Relays.</p><p id="p-0156" num="0288"><figref idref="DRAWINGS">FIG. <b>21</b></figref> is a flow chart <b>2100</b> illustrating a method for PC5-S message reception from the perspective of a UE-to-UE relay. In step <b>2105</b>, the UE-to-UE relay receives a first PC5-S message on a first sidelink Signal Radio Bearer (SRB) from a first UE, wherein the first PC5-S message is used to establish a first sidelink security between the UE-to-UE relay and the first UE, to update link identifier(s) associated with a first link between the first UE and the UE-to-UE relay, or to modify the first link between the first UE and the UE-to-UE relay. In step <b>2110</b>, the UE-to-UE relay delivers the first PC5-S message to an upper layer of the UE-to-UE relay. In step <b>2115</b>, the UE-to-UE relay receives a second PC5-S message on a second sidelink SRB from the first UE, wherein the second PC5-S message is used to establish a second sidelink security between the first UE and a second UE, to update link identifier(s) associated with a second link between the first UE and the second UE, or to modify the second link between the first UE and the second UE. In step <b>2120</b>, the UE-to-UE relay transmits or forwards the second PC5-S message to the second UE.</p><p id="p-0157" num="0289">In one embodiment, the second sidelink SRB could be configured with an adaptation layer. The adaptation layer could be located between a PC5 Radio Link Control (PC5-RLC) layer and a PC5 Packet Data Convergence Protocol (PC5-PDCP) layer in the first UE and the UE-to-UE relay if the UE-to-UE relay is a Layer-2 UE-to-UE relay. The first sidelink SRB could be configured with no adaptation layer.</p><p id="p-0158" num="0290">In one embodiment, the second PC5-S message could be included in an adaptation layer Protocol Data Unit (PDU). The adaptation layer PDU could include a header, and the header could include information identifying the second UE.</p><p id="p-0159" num="0291">In one embodiment, the first PC5-S message or the second PC5-S message used to establish the first or second sidelink security could be a Direct Link Security Mode Command message or a Direct Link Security Mode Complete message. The first PC5-S message or the second PC5-S message used to update the link identifier(s) associated with the first link or the second link could be a Link Identifier Update Request message, a Link Identifier Update Response message, or a Link Identifier Update Acknowledgement (ACK) message. The first PC5-S message or the second PC5-S message used modify the first link or the second link could be a Link Modification Request message or a Link Modification Accept message.</p><p id="p-0160" num="0292">In one embodiment, the upper layer of the UE-to-UE relay could be a PC5 Signaling protocol layer.</p><p id="p-0161" num="0293">Referring back to <figref idref="DRAWINGS">FIGS. <b>3</b> and <b>4</b></figref>, in one exemplary embodiment of a method for a UE-to-UE relay, the UE-to-UE relay <b>300</b> includes a program code <b>312</b> stored in the memory <b>310</b>. The CPU <b>308</b> could execute program code <b>312</b> to enable the UE-to-UE relay (i) to receive a first PC5-S message on a first sidelink SRB from a first UE, wherein the first PC5-S message is used to establish a first sidelink security between the UE-to-UE relay and the first UE, to update link identifier(s) associated with a first link between the first UE and the UE-to-UE relay, or to modify the first link between the first UE and the UE-to-UE relay, (ii) to deliver the first PC5-S message to an upper layer of the UE-to-UE relay, (iii) to receive a second PC5-S message on a second sidelink SRB from the first UE, wherein the second PC5-S message is used to establish a second sidelink security between the first UE and a second UE, to update link identifier(s) associated with a second link between the first UE and the second UE, or to modify the second link between the first UE and the second UE, and (iv) to transmit or forward the second PC5-S message to the second UE. Furthermore, the CPU <b>308</b> can execute the program code <b>312</b> to perform all of the above-described actions and steps or others described herein.</p><p id="p-0162" num="0294">Various aspects of the disclosure have been described above. It should be apparent that the teachings herein could be embodied in a wide variety of forms and that any specific structure, function, or both being disclosed herein is merely representative. Based on the teachings herein one skilled in the art should appreciate that an aspect disclosed herein could be implemented independently of any other aspects and that two or more of these aspects could be combined in various ways. For example, an apparatus could be implemented or a method could be practiced using any number of the aspects set forth herein. In addition, such an apparatus could be implemented or such a method could be practiced using other structure, functionality, or structure and functionality in addition to or other than one or more of the aspects set forth herein. As an example of some of the above concepts, in some aspects concurrent channels could be established based on pulse repetition frequencies. In some aspects concurrent channels could be established based on pulse position or offsets. In some aspects concurrent channels could be established based on time hopping sequences. In some aspects concurrent channels could be established based on pulse repetition frequencies, pulse positions or offsets, and time hopping sequences.</p><p id="p-0163" num="0295">Those of skill in the art would understand that information and signals may be represented using any of a variety of different technologies and techniques. For example, data, instructions, commands, information, signals, bits, symbols, and chips that may be referenced throughout the above description may be represented by voltages, currents, electromagnetic waves, magnetic fields or particles, optical fields or particles, or any combination thereof.</p><p id="p-0164" num="0296">Those of skill would further appreciate that the various illustrative logical blocks, modules, processors, means, circuits, and algorithm steps described in connection with the aspects disclosed herein may be implemented as electronic hardware (e.g., a digital implementation, an analog implementation, or a combination of the two, which may be designed using source coding or some other technique), various forms of program or design code incorporating instructions (which may be referred to herein, for convenience, as &#x201c;software&#x201d; or a &#x201c;software module&#x201d;), or combinations of both. To clearly illustrate this interchangeability of hardware and software, various illustrative components, blocks, modules, circuits, and steps have been described above generally in terms of their functionality. Whether such functionality is implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system. Skilled artisans may implement the described functionality in varying ways for each particular application, but such implementation decisions should not be interpreted as causing a departure from the scope of the present disclosure.</p><p id="p-0165" num="0297">In addition, the various illustrative logical blocks, modules, and circuits described in connection with the aspects disclosed herein may be implemented within or performed by an integrated circuit (&#x201c;IC&#x201d;), an access terminal, or an access point. The IC may comprise a general purpose processor, a digital signal processor (DSP), an application specific integrated circuit (ASIC), a field programmable gate array (FPGA) or other programmable logic device, discrete gate or transistor logic, discrete hardware components, electrical components, optical components, mechanical components, or any combination thereof designed to perform the functions described herein, and may execute codes or instructions that reside within the IC, outside of the IC, or both. A general purpose processor may be a microprocessor, but in the alternative, the processor may be any conventional processor, controller, microcontroller, or state machine. A processor may also be implemented as a combination of computing devices, e.g., a combination of a DSP and a microprocessor, a plurality of microprocessors, one or more microprocessors in conjunction with a DSP core, or any other such configuration.</p><p id="p-0166" num="0298">It is understood that any specific order or hierarchy of steps in any disclosed process is an example of a sample approach. Based upon design preferences, it is understood that the specific order or hierarchy of steps in the processes may be rearranged while remaining within the scope of the present disclosure. The accompanying method claims present elements of the various steps in a sample order, and are not meant to be limited to the specific order or hierarchy presented.</p><p id="p-0167" num="0299">The steps of a method or algorithm described in connection with the aspects disclosed herein may be embodied directly in hardware, in a software module executed by a processor, or in a combination of the two. A software module (e.g., including executable instructions and related data) and other data may reside in a data memory such as RAM memory, flash memory, ROM memory, EPROM memory, EEPROM memory, registers, a hard disk, a removable disk, a CD-ROM, or any other form of computer-readable storage medium known in the art. A sample storage medium may be coupled to a machine such as, for example, a computer/processor (which may be referred to herein, for convenience, as a &#x201c;processor&#x201d;) such the processor can read information (e.g., code) from and write information to the storage medium. A sample storage medium may be integral to the processor. The processor and the storage medium may reside in an ASIC. The ASIC may reside in user equipment. In the alternative, the processor and the storage medium may reside as discrete components in user equipment. Moreover, in some aspects any suitable computer-program product may comprise a computer-readable medium comprising codes relating to one or more of the aspects of the disclosure. In some aspects a computer program product may comprise packaging materials.</p><p id="p-0168" num="0300">While the invention has been described in connection with various aspects, it will be understood that the invention is capable of further modifications. This application is intended to cover any variations, uses or adaptation of the invention following, in general, the principles of the invention, and including such departures from the present disclosure as come within the known and customary practice within the art to which the invention pertains.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A method for PC5 Signaling (PC5-S) message reception, comprising:<claim-text>a User-Equipment-to-User-Equipment (UE-to-UE) relay receives a first PC5-S message on a first sidelink Signal Radio Bearer (SRB) from a first UE, wherein the first PC5-S message is used to establish a first sidelink security between the UE-to-UE relay and the first UE, to update link identifier(s) associated with a first link between the first UE and the UE-to-UE relay, or to modify the first link between the first UE and the UE-to-UE relay;</claim-text><claim-text>the UE-to-UE relay delivers the first PC5-S message to an upper layer of the UE-to-UE relay;</claim-text><claim-text>the UE-to-UE relay receives a second PC5-S message on a second sidelink SRB from the first UE, wherein the second PC5-S message is used to establish a second sidelink security between the first UE and a second UE, to update link identifier(s) associated with a second link between the first UE and the second UE, or to modify the second link between the first UE and the second UE; and</claim-text><claim-text>the UE-to-UE relay transmits or forwards the second PC5-S message to the second UE.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the second sidelink SRB is configured with an adaptation layer.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the adaptation layer is located between a PC5 Radio Link Control (PC5-RLC) layer and a PC5 Packet Data Convergence Protocol (PC5-PDCP) layer in the first UE and the UE-to-UE relay if the UE-to-UE relay is a Layer-2 UE-to-UE relay.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first sidelink SRB is configured with no adaptation layer.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the second PC5-S message is included in an adaptation layer Protocol Data Unit (PDU).</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the adaptation layer PDU includes a header, and the header includes information identifying the second UE.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first PC5-S message or the second PC5-S message used to establish the first or second sidelink security is a Direct Link Security Mode Command message or a Direct Link Security Mode Complete message.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first PC5-S message or the second PC5-S message used to update the link identifier(s) associated with the first link or the second link is a Link Identifier Update Request message, a Link Identifier Update Response message, or a Link Identifier Update Acknowledgement (ACK) message.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first PC5-S message or the second PC5-S message used modify the first link or the second link is a Link Modification Request message or a Link Modification Accept message.</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the upper layer of the UE-to-UE relay is a PC5 Signaling protocol layer.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. A User-Equipment-to-User-Equipment (UE-to-UE) relay for PC5 Signaling (PC5-S) message reception, comprising:<claim-text>a control circuit;</claim-text><claim-text>a processor installed in the control circuit; and</claim-text><claim-text>a memory installed in the control circuit and operatively coupled to the processor;</claim-text><claim-text>wherein the processor is configured to execute a program code stored in the memory to:<claim-text>receive a first PC5-S message on a first sidelink Signal Radio Bearer (SRB) from a first UE, wherein the first PC5-S message is used to establish a first sidelink security between the UE-to-UE relay and the first UE, to update link identifier(s) associated with a first link between the first UE and the UE-to-UE relay, or to modify the first link between the first UE and the UE-to-UE relay;</claim-text><claim-text>deliver the first PC5-S message to an upper layer of the UE-to-UE relay;</claim-text><claim-text>receive a second PC5-S message on a second sidelink SRB from the first UE, wherein the second PC5-S message is used to establish a second sidelink security between the first UE and a second UE, to update link identifier(s) associated with a second link between the first UE and the second UE, or to modify the second link between the first UE and the second UE; and</claim-text><claim-text>transmit or forward the second PC5-S message to the second UE.</claim-text></claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The UE-to-UE relay of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the second sidelink SRB is configured with an adaptation layer.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The UE-to-UE relay of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the adaptation layer is located between a PC5 Radio Link Control (PC5-RLC) layer and a PC5 Packet Data Convergence Protocol (PC5-PDCP) layer in the first UE and the UE-to-UE relay if the UE-to-UE relay is a Layer-2 UE-to-UE relay.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The UE-to-UE relay of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the first sidelink SRB is configured with no adaptation layer.</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The UE-to-UE relay of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the second PC5-S message is included in an adaptation layer Protocol Data Unit (PDU).</claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The UE-to-UE relay of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the adaptation layer PDU includes a header, and the header includes information identifying the second UE.</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The UE-to-UE relay of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the first PC5-S message or the second PC5-S message used to establish the first or second sidelink security is a Direct Link Security Mode Command message or a Direct Link Security Mode Complete message.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The UE-to-UE relay of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the first PC5-S message or the second PC5-S message used to update the link identifier(s) associated with the first link or the second link is a Link Identifier Update Request message, a Link Identifier Update Response message, or a Link Identifier Update Acknowledgement (ACK) message.</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The UE-to-UE relay of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the first PC5-S message or the second PC5-S message used modify the first link or the second link is a Link Modification Request message or a Link Modification Accept message.</claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The UE-to-UE relay of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the upper layer of the UE-to-UE relay is a PC5 Signaling protocol layer.</claim-text></claim></claims></us-patent-application>