<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230004638A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230004638</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17363631</doc-number><date>20210630</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>F</subclass><main-group>21</main-group><subgroup>53</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>F</subclass><main-group>21</main-group><subgroup>57</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>12</main-group><subgroup>58</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>21</main-group><subgroup>53</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>21</main-group><subgroup>57</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>51</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">REDIRECTION OF ATTACHMENTS BASED ON RISK AND CONTEXT</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Citrix Systems, Inc.</orgname><address><city>Ft. Lauderdale</city><state>FL</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Singh</last-name><first-name>Manbinder Pal</first-name><address><city>Coral Springs</city><state>FL</state><country>US</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>Citrix Systems, Inc.</orgname><role>02</role><address><city>Ft. Lauderdale</city><state>FL</state><country>US</country></address></addressbook></assignee></assignees></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A computer system is provided. The computer system includes a memory and at least one processor coupled to the memory and configured to evaluate a risk associated with an email attachment based on application of security policies to properties of the attachment and to the context associated with receipt of the email. The at least one processor is further configured to detect an attempt by a user to open the email attachment. The at least one processor is further configured to prevent the opening of the attachment based on the evaluated risk. The at least one processor is further configured to redirect the attachment to a secure browser, hosted on a remote server, based on the evaluated risk.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="187.54mm" wi="158.75mm" file="US20230004638A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="185.25mm" wi="158.83mm" file="US20230004638A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="231.39mm" wi="169.42mm" file="US20230004638A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="235.88mm" wi="173.06mm" file="US20230004638A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="223.69mm" wi="141.48mm" file="US20230004638A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="216.92mm" wi="140.72mm" file="US20230004638A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="219.79mm" wi="146.56mm" file="US20230004638A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="197.95mm" wi="144.95mm" file="US20230004638A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="223.35mm" wi="166.45mm" file="US20230004638A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">BACKGROUND</heading><p id="p-0002" num="0001">Cyber security is an issue of great importance, as attacks on computer systems and the users of those systems continue to increase. One of the most prevalent, and often most successful, forms of attack involve the delivery of an email attachment that contains a virus or other malicious code. The attachment, when opened, can disable a computer, steal confidential information, perform unauthorized actions, or subject the user to ransomware demands. Such malicious emails can appear to be legitimate and are often successful at fooling the user into opening the attachment.</p><heading id="h-0002" level="1">SUMMARY</heading><p id="p-0003" num="0002">In at least one example, a computer system is provided. The computer system includes a memory; and at least one processor coupled to the memory and configured to: evaluate a risk associated with an attachment of an email based on application of security policies to properties of the attachment and to context associated with receipt of the email; detect an attempt to open the attachment; prevent opening of the attachment based on the evaluated risk; and redirect the attachment to a secure browser based on the evaluated risk.</p><p id="p-0004" num="0003">At least some examples of the computer system can include one or more of the following features. The properties of the attachment include one or more of an address of a sender of the attachment, a domain name associated with the sender, and a type of file associated with the attachment. The at least one processor is further configured to check employment status of the sender of the email, wherein the properties of the attachment further include the employment status. The context includes one or more of a type of network over which the computer system receives the email, a version status of an application to be used to open the attachment, and a risk score associated with a sender of the email. The type of network includes one or more of a public network, a private network, a wired network, a Wi-Fi network, and a cellular network. The at least one processor is further configured to employ an event handler callback to detect a mouse click or keyboard entry focused on the attachment to detect the attempt to open the attachment. The computer system further comprises a remote server, wherein the secure browser is hosted on the remote server and configured to open the attachment in an anonymous session.</p><p id="p-0005" num="0004">In at least one example, a method for redirection of an email attachment is provided. The method includes evaluating, by a computer system, a risk associated with an attachment of the email based on application of security policies to properties of the attachment and to context associated with receipt of the email; detect, by the computer system, an attempt to open the attachment; preventing, by the computer system, opening of the attachment based on the evaluated risk; and redirecting, by the computer system, the attachment to a secure browser based on the evaluated risk.</p><p id="p-0006" num="0005">At least some examples of the method can include one or more of the following features. Evaluating the risk comprises evaluating the risk associated with the email attachment based on application of the security policies to properties of the attachment including one or more of an address of a sender of the attachment, a domain name associated with the sender, and a type of file associated with the attachment. The act of checking employment status of the sender of the email, wherein the properties of the attachment further include the employment status. Evaluating the risk comprises evaluating the risk associated with the email attachment based on application of the security policies to context associated with receipt of the email including one or more of a type of network over which the computer system receives the email, a version status of an application to be used to open the attachment, and a risk score associated with a sender of the email. Evaluating the risk comprises evaluating the risk associated with the email attachment based on application of the security policies to context associated with receipt of the email including a type of network over which the computer system receives the email, wherein the type of network includes one or more of a public network, a private network, a wired network, a Wi-Fi network, and a cellular network. The act of employing an event handler callback to detect a mouse click or keyboard entry focused on the attachment to detect the attempt to open the attachment.</p><p id="p-0007" num="0006">In at least one example, a non-transitory computer readable medium storing executable sequences of instructions to provide redirection of an email attachment. The sequences of instructions include instructions to: evaluate a risk associated with an attachment of the email based on application of security policies to properties of the attachment and to context associated with receipt of the email; detect an attempt to open the attachment; prevent opening of the attachment based on the evaluated risk; and redirect the attachment to a secure browser based on the evaluated risk.</p><p id="p-0008" num="0007">At least some examples of the non-transitory computer readable medium can include one or more of the following features. The properties of the attachment include one or more of an address of a sender of the attachment, a domain name associated with the sender, and a type of file associated with the attachment. Instructions to check employment status of the sender of the email, wherein the properties of the attachment further include the employment status. The context includes one or more of a type of network over which the computer system receives the email, a version status of an application to be used to open the attachment, and a risk score associated with a sender of the email. The type of network includes one or more of a public network, a private network, a wired network, a Wi-Fi network, and a cellular network. Instructions to employ an event handler callback to detect a mouse click or keyboard entry focused on the attachment to detect the attempt to open the attachment. The secure browser is hosted on a remote server and configured to open the attachment in an anonymous session.</p><p id="p-0009" num="0008">Still other aspects, examples and advantages of these aspects and examples, are discussed in detail below. Moreover, it is to be understood that both the foregoing information and the following detailed description are merely illustrative examples of various aspects and features and are intended to provide an overview or framework for understanding the nature and character of the claimed aspects and examples. Any example or feature disclosed herein can be combined with any other example or feature. References to different examples are not necessarily mutually exclusive and are intended to indicate that a particular feature, structure, or characteristic described in connection with the example can be included in at least one example. Thus, terms like &#x201c;other&#x201d; and &#x201c;another&#x201d; when referring to the examples described herein are not intended to communicate any sort of exclusivity or grouping of features but rather are included to promote readability.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0010" num="0009">Various aspects of at least one example are discussed below with reference to the accompanying figures, which are not intended to be drawn to scale. The figures are included to provide an illustration and a further understanding of the various aspects and are incorporated in and constitute a part of this specification but are not intended as a definition of the limits of any particular example. The drawings, together with the remainder of the specification, serve to explain principles and operations of the described and claimed aspects. In the figures, each identical or nearly identical component that is illustrated in various figures is represented by a like numeral. For purposes of clarity, not every component may be labeled in every figure.</p><p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a top-level block diagram of an implementation of a system for attachment redirection, in accordance with an example of the present disclosure.</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates an email client user interface, in accordance with an example of the present disclosure.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a sequence diagram of an attachment redirection process, in accordance with an example of the present disclosure.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIGS. <b>4</b>A-<b>4</b>C</figref> are a flow diagram of a process for attachment redirection, in accordance with an example of the present disclosure.</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a flow diagram of another process for attachment redirection, in accordance with an example of the present disclosure.</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a block diagram of a computing platform configured to perform a process for attachment redirection, in accordance with an example of the present disclosure.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0004" level="1">DETAILED DESCRIPTION</heading><p id="p-0017" num="0016">As noted previously, cyber security is a growing concern as attacks on computer systems and the users of those systems increase. One frequent method for delivering those attacks is through email attachments which contain malicious code and/or data. The attachment, when opened, can disable a computer, steal confidential information, perform unauthorized actions, or subject the user to ransomware demands. These emails can appear to be legitimate and are often successful at fooling the user into opening the attachment.</p><p id="p-0018" num="0017">To address these and other problems, and as summarized above, various examples described herein are directed to systems and methods for redirecting high risk attachments to a remote secure browser server to prevent cyber-attacks, without requiring action on the part of the user (e.g., recipient of the email).</p><p id="p-0019" num="0018">In some examples, the disclosed techniques provide protection against cyber-attacks by redirecting attachments from a client device to a remote secure browser server based on an evaluation of the risk and context associated with the attachment. The risk evaluation includes application of security policies to properties of the attachment and to the context in which the attachment is received by the client. If the attachment is deemed to be high risk, it can be opened by the remote secure browser in a relatively safe manner, otherwise it can be opened locally by an application on the client.</p><p id="p-0020" num="0019">In some examples, the attachment risk may be evaluated, at least in part, by a risk score associated with the sender of the email. For example, in a corporate setting, some employees may be assigned a risk score by human resources (or some other corporate arm) based on information that is known about the employee. In some examples, an employee who is scheduled to sever their relationship with the company within a given time period (e.g., the next N days, where N is a selectable threshold) may be assigned a higher risk than other employees. In some examples, an employee may be assigned a risk score by analytics based on the employee's activity or behavior that is deemed risky such as downloading/printing a large number of sensitive files, etc.</p><p id="p-0021" num="0020">In some examples, the address and/or domain of the sender of the email may be a factor in the risk evaluation. Certain addresses/domain names may be known to harbor bad actors. On the other hand, if the domain name of the sender matches the domain name of the recipient, that may be considered to lower the risk, in some cases.</p><p id="p-0022" num="0021">In some examples, the type of file in the attachment (e.g., Word document, PDF, spreadsheet, image file, audio file, etc.) may be a factor in the risk evaluation. Additionally, the version of software that will be used to open the attachment file on the client device may be a contributing factor in the risk evaluation, as older or out of date versions may not have the latest security patches/updates.</p><p id="p-0023" num="0022">In some examples, the context of the email may be evaluated as an additional factor to estimate risk. For example, an email received over a free or public Wi-FI network may be considered less secure (e.g., subject to attack by a man-in-the-middle scheme) compared to an email received over a private/corporate network. Many other examples are possible and any suitable risk factors and contexts may be considered in light of the present disclosure.</p><p id="p-0024" num="0023">In some examples, Information Technology (IT) security policies are provided to specify which factors are considered important and how they should be evaluated. These policies may be updated over time, as threats and strategies evolve.</p><p id="p-0025" num="0024">These systems and methods overcome a security problem in which even the most security-conscious user can be fooled into opening a malicious email attachment. For example, a user may be distracted by other workplace demands and inadvertently click on a malicious attachment. The disclosed techniques will intercept the mouse click, evaluate the context and risk score associated with the attachment, and open it in a safe manner, either locally or remotely, based on the risk evaluation.</p><p id="p-0026" num="0025">As will be understood in view of this disclosure, the systems and methods for providing risk-based attachment redirection provided herein have advantages over existing methods which rely on user vigilance to carefully inspect each email and attachment, which is subject to lapse. For instance, the systems and methods described herein provide automated protection and do not rely on user action. Other existing methods open the attachment in a secure sandbox local to the client device, but that approach may require virtualization support and/or enablement in the Basic Input/Output System (BIOS), which is not always possible. Additionally, that approach still poses a risk since it involves local execution, and any bugs or vulnerabilities may compromise the client device.</p><p id="p-0027" num="0026">Examples of the methods and systems discussed herein are not limited in application to the details of construction and the arrangement of components set forth in the following description or illustrated in the accompanying drawings. The methods and systems are capable of implementation in other examples and of being practiced or of being carried out in various ways. Examples of specific implementations are provided herein for illustrative purposes only and are not intended to be limiting. In particular, acts, components, elements, and features discussed in connection with any one or more examples are not intended to be excluded from a similar role in any other examples.</p><heading id="h-0005" level="2">Attachment Redirection System</heading><p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a top-level block diagram of an implementation of a system <b>100</b> for attachment redirection, in accordance with an example of the present disclosure. As shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the system comprises a client <b>110</b>, a workspace server <b>150</b>, a secure browser server <b>160</b>, and an email server <b>170</b>. The client <b>110</b> (e.g., a device such as a laptop, mobile device, workstation, etc.) is configured to execute a workspace application <b>120</b> and an email client application <b>130</b>. In some examples, the email client application may include a secure browser add-in <b>140</b>.</p><p id="p-0029" num="0028">The operation of system <b>100</b> will be explained in greater detail below, but at a high-level, the system is configured to evaluate risks associated with email attachments and to redirect attachments, which are deemed to be at higher risk, to a secure browser server where they can be opened in a relative safe manner. In some examples, the workspace server <b>150</b> is configured to provide secure access to virtual applications, information, and content that is to be delivered to a user of the client device <b>110</b> through the workspace application <b>120</b> that executes on the client device. Additionally, the email client <b>130</b> is configured to retrieve emails (including attachments) from the email server <b>170</b>. The secure browser add-in <b>140</b> to the email client <b>130</b>, working in combination with the workspace application <b>120</b> and the workspace server <b>150</b>, functions to evaluate the risks associated with an attachment, block attempts by the user to open the attachment if the risk exceeds a threshold for unacceptability, and redirect the attachment to a secure browser for opening, as will be explained below. In some examples, the secure browser server may be a security hardened Linux server. In some examples, the secure browser may be a virtual desktop agent executing on the secure browser server or on another machine.</p><p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates an email client user interface <b>200</b>, in accordance with an example of the present disclosure. The user interface, in this example, is shown to include a variety of email controls <b>210</b> (e.g., tabs and buttons), a secure browser add-in <b>220</b>, a display of the currently open email <b>240</b>, and a presentation of attachments <b>230</b> associated with the email.</p><p id="p-0031" num="0030">The attachments may be opened by clicking on the attachment box or by other suitable means such as, for example, moving the User Interface (UI) focus to the attachment box with the tab key and then pressing the enter key. In some examples, the workspace application <b>120</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, is configured to employ UI automation to detect when the user attempts to open an attachment. UI automation is an application programming interface, provided by the operating system of the client device, which allows one application to access, identify, and manipulate the UI elements of another application. In this case, UI automation allows the workspace application <b>120</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, to control the attachments presented by the email client <b>130</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, and intercept requests by the user to open those attachments. The workspace application <b>120</b> can then evaluate risks associated with the attachments and determine whether to open the attachments locally (e.g., on the client device <b>110</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>) or remotely (e.g., on the secure browser server <b>160</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>), as will be explained below.</p><heading id="h-0006" level="2">Attachment Redirection Process</heading><p id="p-0032" num="0031">As described above, some examples of the system <b>100</b> of <figref idref="DRAWINGS">FIG. <b>1</b></figref> are configured to perform a process for attachment redirection to a secure browser server. The processes may be executed on a processor of any suitable type (e.g., processor <b>610</b> of <figref idref="DRAWINGS">FIG. <b>6</b></figref>).</p><p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates a sequence diagram <b>300</b> of an attachment redirection process, in accordance with an example of the present disclosure. The sequence diagram illustrates interactions between entities (client device <b>110</b>, workspace server <b>150</b>, secure browser server <b>160</b>, and email server <b>170</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>) in the horizontal direction, over time in the vertical direction.</p><p id="p-0034" num="0033">At operation <b>305</b>, the workspace server <b>150</b> provides IT security policies (regarding opening of email attachments) to the workspace application <b>120</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, running on the client <b>110</b>. At operation <b>310</b>, the user accesses and opens email from the email server <b>170</b> through the email client <b>130</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>.</p><p id="p-0035" num="0034">At operation <b>315</b>, a risk evaluation is performed on the attachment. The risk evaluation is based on an application of the provided security policies to properties of the attachment and to the context associated with receipt of the email, as will be described in greater detail below.</p><p id="p-0036" num="0035">At operation <b>320</b>, UI automation techniques are set up, which provide hooks to event handlers that allow for detection of user attempts to open the attachment. At operation <b>325</b>, the user attempts to open the attachment, for example by clicking on it or typing the enter key while the attachment is in focus.</p><p id="p-0037" num="0036">At operation <b>330</b>, in response to the detected attempt to open the attachment, the client <b>110</b> sends a request to the workspace server <b>150</b> to create a secure browser session. The workspace server then forwards that request to the secure browser server <b>160</b>.</p><p id="p-0038" num="0037">At operation <b>335</b>, the client <b>110</b> sends an attachment ID, an email ID, an Application Programming Interface (API)/service endpoint Uniform Resource Locator (URL), and a token to the workspace server. In some examples, the API/URL provides a path into the email server <b>170</b>, through which the email attachment can be fetched. In some examples, the token serves to authenticate (to the email server <b>170</b>) the request for access to the attachment, providing a security mechanism to prevent access by unauthorized parties.</p><p id="p-0039" num="0038">At operation <b>340</b>, the secure browser server provides connection data to the workspace server. The workspace server then forwards that connection data to the client.</p><p id="p-0040" num="0039">At to operation <b>345</b>, the client communicates to the secure browser server, using the provided connection data, to launch a secure browser session.</p><p id="p-0041" num="0040">At operation <b>350</b>, the secure browser server <b>160</b> requests the attachment from the email server <b>170</b> (for example, by providing the token), and at operation <b>355</b>, the email server provides the attachment to the secure browser server.</p><p id="p-0042" num="0041">At operation <b>360</b>, the secure browser server opens the attachment in a secure anonymous session.</p><p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a more detailed flow diagram of a process <b>400</b> for attachment redirection, executed by system <b>100</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, or the sub-components thereof, in accordance with an example of the present disclosure. <figref idref="DRAWINGS">FIG. <b>4</b></figref> is continued over three pages&#x2014;<figref idref="DRAWINGS">FIG. <b>4</b>A</figref>, <figref idref="DRAWINGS">FIG. <b>4</b>B</figref>, and <figref idref="DRAWINGS">FIG. <b>4</b>C</figref>.</p><p id="p-0044" num="0043">The process <b>400</b> starts at operation <b>410</b>, with the user logging into the workspace application <b>120</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, which in turn connects to the workspace server <b>150</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>.</p><p id="p-0045" num="0044">Next, at operation <b>415</b>, the workspace application retrieves IT security policies from the workspace server <b>150</b>. The security policies include risk and context factors directed to attachment opening decisions. In some examples, risk factors include attachment file type details (e.g., text file, Word document, PDF, spreadsheet, image, audio, etc.). For example, a plain text file (&#x201c;.txt&#x201d; format) may be considered lower risk than a PDF file. As such an IT admin may set policies based on file extension of the attachment.</p><p id="p-0046" num="0045">In some examples, risk factors include an address of the sender of the attachment and/or a domain name associated with the address of the sender, both of which can be ascertained after the email is accessed. The security policy may be set as a threshold value for comparison to a risk score associated with the sender of the email (e.g., provided by an analytics service).</p><p id="p-0047" num="0046">In some examples, context includes the type of network over which the computer system receives the email (e.g., public network versus private/corporate network, Wi-Fi versus cellular, etc.). In some examples, the context includes the version of the application that is employed to open the attachment (e.g., whether it is up to date and has the latest security patches/updates).</p><p id="p-0048" num="0047">At operation <b>420</b>, the user accesses and opens email from the email server <b>170</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, through the email client <b>130</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>.</p><p id="p-0049" num="0048">At operation <b>425</b>, risk factors and context associated with the email and attachment are identified.</p><p id="p-0050" num="0049">At operation <b>430</b>, the security policies are applied by the workspace application to determine if attachment redirection to the remote secure browser is required. In some examples, if the email address domain of the sender differs from the corporate address domain of the recipient, then the policies may require (or suggest) attachment redirection for secure opening. In some examples, if the email address domain of the sender is the same as the corporate address domain of the recipient, the identity of the sender may be checked with human resources to determine the risk level for the attachment. For example, if the employee is leaving the company within N days, or the employee's work record indicates some problem, then there may be a higher risk. In some examples, an analytics service may be employed to analyze the attachment to estimate a risk score and the security policy may provide a risk score threshold for comparison to decide that the attachment should be redirected for secure opening. In some examples, an analytics service may be employed to provide a risk score associated with the sender of the email.</p><p id="p-0051" num="0050">In some examples, the security policies may specify that email delivered over a public or free Wi-Fi network is high risk and needs to be redirected. In some examples, the security policies may specify minimum acceptable version levels for applications that would be used to open the attachment.</p><p id="p-0052" num="0051">If a decision is made to open the attachment locally (e.g., on the client), based on application of the policies to the identified risk factors and context, then the process may terminate at this point.</p><p id="p-0053" num="0052">Otherwise, at operation <b>440</b>, UI automation is employed to identify the attachment in the opened email and link event handlers to the workspace application so that attempts by the user to open the attachment are intercepted. For example, the attachment ID, index, location, coordinates, and dimensions are noted to later identify when a mouse click operation is performed within the location of the attachment. This information may be refreshed and updated as the window is updated, moved, and/or resized. In some examples, UI focus events are also setup to alert when the attachment receives focus, for example through use of the tab key which can move focus throughout the window. A mouse event handler callback is setup to notify the workspace application when the user clicks on the attachment and a keyboard event handler callback is setup to notify when the user presses enter on the attachment. Event handlers for other means of opening may also be employed (e.g., voice commands, etc.). These notifications allow the workspace application to intercept the attachment opening request and prevent the opening.</p><p id="p-0054" num="0053">At operation <b>445</b>, the user attempts to open the attachment, for example using a mouse click, keyboard entry, or other suitable means.</p><p id="p-0055" num="0054">At operation <b>450</b>, if it was previously determined that attachment redirection is not required (e.g., based on the risk evaluation) then the workspace application (or the event handlers) allows the attachment to be opened locally on the client device.</p><p id="p-0056" num="0055">Otherwise, at operation <b>455</b>, the attachment is identified and information about the attachment (e.g., the attachment ID) is sent to the workspace server.</p><p id="p-0057" num="0056">At operation <b>460</b>, execution of the secure browser add-in <b>140</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, is triggered. In some examples, the secure browser web add-in is pre-installed in the email account (e.g., by IT administration) so that the process does not rely on user installation of the add-in.</p><p id="p-0058" num="0057">At operation <b>465</b>, the secure browser add-in <b>140</b> retrieves attachment details from the email server <b>170</b> and sends those details to the workspace server <b>150</b>. In some examples, attachment details include a security token and URL. At operation <b>470</b>, the workspace server <b>150</b> forwards the attachment details, along with the attachment name or ID and an email ID, to the secure browser server <b>160</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>.</p><p id="p-0059" num="0058">At operation <b>475</b>, the secure browser server <b>160</b> sends secure browser connection and launch information to the workspace server <b>150</b>. At operation <b>480</b>, the workspace server <b>150</b> forwards the connection and launch information to the client workspace application <b>120</b>.</p><p id="p-0060" num="0059">At operation <b>485</b>, the workspace application <b>120</b> establishes a connection between the client and the secure browser server using the provided connection information and requests that the secure browser be launched.</p><p id="p-0061" num="0060">At operation <b>490</b>, the secure browser server <b>160</b> creates an anonymous session and retrieves the attachment (and associated metadata including format) from the email server using the attachment details (e.g., token, URL, attachment ID, and email ID).</p><p id="p-0062" num="0061">At operation <b>495</b>, the attachment is opened in the secure anonymous session. After completion with the attachment, all information associated with the anonymous session is erased so that any malicious code or data that might have been present in the attachment will not persist.</p><p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a flow diagram of another process <b>500</b> for attachment redirection, executed by client <b>110</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, or the sub-components thereof, in accordance with an example of the present disclosure.</p><p id="p-0064" num="0063">The process <b>500</b> starts at operation <b>510</b>, by evaluating the risk associated with an email attachment based on an application of security policies to properties of the attachment and to the context associated with the receipt of the email. In some examples, properties of the attachment may include one or more of an address of the sender of the attachment, a domain name associated with the address of the sender, and a file type associated with the attachment (e.g., Word document, PDF, etc.). In some examples, the context includes the type of network over which the computer system receives the email (e.g., public Wi-Fi versus private network, etc.). In some examples, the context includes the version of the application that is employed to open the attachment (e.g., whether it is up to date and has latest security updates). In some examples, the context includes a risk score associated with the sender of the email.</p><p id="p-0065" num="0064">Next, at operation <b>520</b>, an attempt to open the attachment is detected, for example using UI automation.</p><p id="p-0066" num="0065">At operation <b>530</b>, if the evaluated risk exceeds a threshold level, opening of the attachment is prevented and instead, at operation <b>540</b>, the attachment is redirected to a secure browser for opening.</p><p id="p-0067" num="0066">In some examples, the secure browser is hosted on a remote server and configured to open the attachment in a secure anonymous session.</p><p id="p-0068" num="0067">The processes disclosed herein each depict one particular sequence of acts in a particular example. Some acts are optional and, as such, can be omitted in accord with one or more examples. Additionally, the order of acts can be altered, or other acts can be added, without departing from the scope of the apparatus and methods discussed herein.</p><heading id="h-0007" level="2">Computing Platform for Attachment Redirection</heading><p id="p-0069" num="0068"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a block diagram of a computing platform <b>600</b> configured to perform a process for attachment redirection, in accordance with an example of the present disclosure. In some cases, the platform <b>600</b> is the client device <b>110</b>, of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, which may be a workstation, server, laptop, mobile device, or smartphone, etc.</p><p id="p-0070" num="0069">The computing platform or device <b>600</b> includes one or more processors <b>610</b>, volatile memory <b>620</b> (e.g., random access memory (RAM)), non-volatile memory <b>630</b>, one or more network or communication interfaces <b>640</b>, user interface (UI) <b>660</b>, display element (e.g., screen) <b>670</b>, and a communications bus <b>650</b>. The computing platform <b>600</b> may also be referred to as a computer or a computer system.</p><p id="p-0071" num="0070">The non-volatile (non-transitory) memory <b>630</b> can include: one or more hard disk drives (HDDs) or other magnetic or optical storage media; one or more solid state drives (SSDs), such as a flash drive or other solid-state storage media; one or more hybrid magnetic and solid-state drives; and/or one or more virtual storage volumes, such as a cloud storage, or a combination of such physical storage volumes and virtual storage volumes or arrays thereof.</p><p id="p-0072" num="0071">The user interface <b>660</b> can include one or more input/output (I/O) devices (e.g., a mouse, a keyboard, a microphone, one or more speakers, one or more biometric scanners, one or more environmental sensors, and one or more accelerometers, etc.).</p><p id="p-0073" num="0072">The display element <b>670</b>, can provide a graphical user interface (GUI) and in some cases, may be a touchscreen or any other suitable display device.</p><p id="p-0074" num="0073">The non-volatile memory <b>630</b> stores an operating system <b>632</b>, one or more applications <b>634</b>, and data <b>636</b>. The applications may include an email client <b>130</b> (including secure browser add-in <b>140</b>) and workspace application <b>120</b>, all of <figref idref="DRAWINGS">FIG. <b>1</b></figref>, such that, for example, computer instructions of the operating system <b>632</b> and applications <b>634</b> are executed by processor(s) <b>610</b> out of the volatile memory <b>620</b>. In some examples, the volatile memory <b>620</b> can include one or more types of RAM and/or a cache memory that can offer a faster response time than a main memory. Data can be entered through the user interface <b>660</b>. Various elements of the computer <b>600</b> can communicate via the communications bus <b>650</b>.</p><p id="p-0075" num="0074">The illustrated computing platform <b>600</b> is shown merely as an example client device or server and can be implemented by any computing or processing environment with any type of machine or set of machines that can have suitable hardware and/or software capable of operating as described herein.</p><p id="p-0076" num="0075">The processor(s) <b>610</b> can be implemented by one or more programmable processors to execute one or more executable instructions, such as a computer program, to perform the functions of the system. As used herein, the term &#x201c;processor&#x201d; describes circuitry that performs a function, an operation, or a sequence of operations. The function, operation, or sequence of operations can be hard coded into the circuitry or soft coded by way of instructions held in a memory device and executed by the circuitry. A processor can perform the function, operation, or sequence of operations using digital values and/or using analog signals.</p><p id="p-0077" num="0076">In some examples, the processor can be embodied in one or more application specific integrated circuits (ASICs), microprocessors, digital signal processors (DSPs), graphics processing units (GPUs), microcontrollers, field programmable gate arrays (FPGAs), programmable logic arrays (PLAs), multicore processors, or general-purpose computers with associated memory.</p><p id="p-0078" num="0077">The processor <b>610</b> can be analog, digital, or mixed. In some examples, the processor <b>610</b> can be one or more physical processors, or one or more virtual (e.g., remotely located or cloud) processors. A processor including multiple processor cores and/or multiple processors can provide functionality for parallel, simultaneous execution of instructions or for parallel, simultaneous execution of one instruction on more than one piece of data.</p><p id="p-0079" num="0078">The network interfaces <b>640</b> can include one or more interfaces to enable the computing platform <b>600</b> to access a computer network <b>680</b> such as a Local Area Network (LAN), a Wide Area Network (WAN), a Personal Area Network (PAN), or the Internet through a variety of wired and/or wireless connections, including cellular connections. In some examples, the network <b>680</b> may allow for communication with other computing platforms <b>690</b>, to enable distributed computing.</p><p id="p-0080" num="0079">In described examples, the computing platform <b>600</b> can execute an application on behalf of a user of a client device. For example, the computing platform <b>600</b> can execute one or more virtual machines managed by a hypervisor. Each virtual machine can provide an execution session within which applications execute on behalf of a user or a client device, such as a hosted desktop session. The computing platform <b>600</b> can also execute a terminal services session to provide a hosted desktop environment. The computing platform <b>600</b> can provide access to a remote computing environment including one or more applications, one or more desktop applications, and one or more desktop sessions in which one or more applications can execute.</p><p id="p-0081" num="0080">Having thus described several aspects of at least one example, it is to be appreciated that various alterations, modifications, and improvements will readily occur to those skilled in the art. For instance, examples disclosed herein can also be used in other contexts. Such alterations, modifications, and improvements are intended to be part of this disclosure and are intended to be within the scope of the examples discussed herein. Accordingly, the foregoing description and drawings are by way of example only.</p><p id="p-0082" num="0081">Also, the phraseology and terminology used herein is for the purpose of description and should not be regarded as limiting. Any references to examples, components, elements or acts of the systems and methods herein referred to in the singular can also embrace examples including a plurality, and any references in plural to any example, component, element or act herein can also embrace examples including only a singularity. References in the singular or plural form are not intended to limit the presently disclosed systems or methods, their components, acts, or elements. The use herein of &#x201c;including,&#x201d; &#x201c;comprising,&#x201d; &#x201c;having,&#x201d; &#x201c;containing,&#x201d; &#x201c;involving,&#x201d; and variations thereof is meant to encompass the items listed thereafter and equivalents thereof as well as additional items. References to &#x201c;or&#x201d; can be construed as inclusive so that any terms described using &#x201c;or&#x201d; can indicate any of a single, more than one, and all of the described terms. In addition, in the event of inconsistent usages of terms between this document and documents incorporated herein by reference, the term usage in the incorporated references is supplementary to that of this document; for irreconcilable inconsistencies, the term usage in this document controls.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A computer system comprising:<claim-text>a memory; and</claim-text><claim-text>at least one processor coupled to the memory and configured to:<claim-text>evaluate a risk associated with an attachment of an email based on application of security policies to properties of the attachment and to context associated with receipt of the email;</claim-text><claim-text>detect an attempt to open the attachment;</claim-text><claim-text>prevent opening of the attachment based on the evaluated risk; and</claim-text><claim-text>redirect the attachment to a secure browser based on the evaluated risk.</claim-text></claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The computer system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the properties of the attachment include one or more of an address of a sender of the attachment, a domain name associated with the sender, and a type of file associated with the attachment.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The computer system of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the at least one processor is further configured to check employment status of the sender of the email, wherein the properties of the attachment further include the employment status.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The computer system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the context includes one or more of a type of network over which the computer system receives the email, a version status of an application to be used to open the attachment, and a risk score associated with a sender of the email.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The computer system of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the type of network includes one or more of a public network, a private network, a wired network, a Wi-Fi network, and a cellular network.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The computer system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the at least one processor is further configured to employ an event handler callback to detect a mouse click or keyboard entry focused on the attachment to detect the attempt to open the attachment.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The computer system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a remote server, wherein the secure browser is hosted on the remote server and configured to open the attachment in an anonymous session.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. A method for redirection of an email attachment comprising:<claim-text>evaluating, by a computer system, a risk associated with an attachment of the email based on application of security policies to properties of the attachment and to context associated with receipt of the email;</claim-text><claim-text>detect, by the computer system, an attempt to open the attachment;</claim-text><claim-text>preventing, by the computer system, opening of the attachment based on the evaluated risk; and</claim-text><claim-text>redirecting, by the computer system, the attachment to a secure browser based on the evaluated risk.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein evaluating the risk comprises evaluating the risk associated with the email attachment based on application of the security policies to properties of the attachment including one or more of an address of a sender of the attachment, a domain name associated with the sender, and a type of file associated with the attachment.</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising checking employment status of the sender of the email, wherein the properties of the attachment further include the employment status.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein evaluating the risk comprises evaluating the risk associated with the email attachment based on application of the security policies to context associated with receipt of the email including one or more of a type of network over which the computer system receives the email, a version status of an application to be used to open the attachment, and a risk score associated with a sender of the email.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein evaluating the risk comprises evaluating the risk associated with the email attachment based on application of the security policies to context associated with receipt of the email including a type of network over which the computer system receives the email, wherein the type of network includes one or more of a public network, a private network, a wired network, a Wi-Fi network, and a cellular network.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, further comprising employing an event handler callback to detect a mouse click or keyboard entry focused on the attachment to detect the attempt to open the attachment.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. A non-transitory computer readable medium storing executable sequences of instructions to provide redirection of an email attachment, the sequences of instructions comprising instructions to:<claim-text>evaluate a risk associated with an attachment of the email based on application of security policies to properties of the attachment and to context associated with receipt of the email;</claim-text><claim-text>detect an attempt to open the attachment;</claim-text><claim-text>prevent opening of the attachment based on the evaluated risk; and</claim-text><claim-text>redirect the attachment to a secure browser based on the evaluated risk.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The computer readable medium of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the properties of the attachment include one or more of an address of a sender of the attachment, a domain name associated with the sender, and a type of file associated with the attachment.</claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The computer readable medium of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the sequences of instructions further include instructions to check employment status of the sender of the email, wherein the properties of the attachment further include the employment status.</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The computer readable medium of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the context includes one or more of a type of network over which the computer system receives the email, a version status of an application to be used to open the attachment, and a risk score associated with a sender of the email.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The computer readable medium of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the type of network includes one or more of a public network, a private network, a wired network, a Wi-Fi network, and a cellular network.</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The computer readable medium of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the sequences of instructions further include instructions to employ an event handler callback to detect a mouse click or keyboard entry focused on the attachment to detect the attempt to open the attachment.</claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The computer readable medium of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the secure browser is hosted on a remote server and configured to open the attachment in an anonymous session.</claim-text></claim></claims></us-patent-application>