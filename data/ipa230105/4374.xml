<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230004375A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230004375</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17756407</doc-number><date>20201111</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>JP</country><doc-number>2019-214586</doc-number><date>20191127</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>F</subclass><main-group>8</main-group><subgroup>65</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>07</class><subclass>C</subclass><main-group>5</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>8</main-group><subgroup>65</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>07</class><subclass>C</subclass><main-group>5</main-group><subgroup>008</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">VEHICLE-MOUNTED UPDATE DEVICE, PROGRAM, AND PROGRAM UPDATE METHOD</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>AutoNetworks Technologies, Ltd.</orgname><address><city>Yokkaichi-shi, Mie</city><country>JP</country></address></addressbook><residence><country>JP</country></residence></us-applicant><us-applicant sequence="01" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Sumitomo Wiring Systems, Ltd.</orgname><address><city>Yokkaichi-shi, Mie</city><country>JP</country></address></addressbook><residence><country>JP</country></residence></us-applicant><us-applicant sequence="02" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Sumitomo Electric Industries, Ltd.</orgname><address><city>Osaka-shi, Osaka</city><country>JP</country></address></addressbook><residence><country>JP</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Adachi</last-name><first-name>Naoki</first-name><address><city>Yokkaichi-shi, Mie</city><country>JP</country></address></addressbook></inventor></inventors></us-parties><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/JP2020/042084</doc-number><date>20201111</date></document-id><us-371c12-date><date>20220524</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">Provided is a vehicle-mounted update device for acquiring an update program transmitted from an external server located outside a vehicle, and performing processing for updating a program of a vehicle-mounted ECU mounted in the vehicle, the vehicle-mounted update device including a control unit for controlling transmission of the update program, and a plurality of communication units to which the vehicle-mounted ECU is connected, and when acquiring the update program, the control unit acquires information regarding a communication unit to which a vehicle-mounted ECU to be updated is connected from the external server, and outputs the update program from the communication unit to which the vehicle-mounted ECU to be updated is connected, based on the acquired information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="110.07mm" wi="158.75mm" file="US20230004375A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="225.72mm" wi="138.77mm" orientation="landscape" file="US20230004375A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="221.40mm" wi="150.79mm" orientation="landscape" file="US20230004375A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="225.21mm" wi="170.77mm" file="US20230004375A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="191.52mm" wi="162.98mm" file="US20230004375A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="214.21mm" wi="170.60mm" file="US20230004375A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading><p id="p-0002" num="0001">This application is the U.S. national stage of PCT/JP2020/042084 filed on Nov. 11, 2020, which claims priority of Japanese Patent Application No. JP 2019-214586 filed on Nov. 27, 2019, the contents of which are incorporated herein.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">The present disclosure relates to a vehicle-mounted update device, a program, and a program update method.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">ECUs (Electronic Control Units) for controlling vehicle-mounted devices, including, for example, a drive control system for engine control and the like, and a body system for air conditioner control and the like are mounted in a vehicle. Each ECU includes a computational processing unit such as an MPU, a rewritable nonvolatile storage unit such as a RAM, and a communication unit for communicating with other ECUs, and controls the vehicle-mounted devices by loading and executing a control program stored in the storage unit. Furthermore, vehicles are equipped with a communication device that has wireless communication functionality, and can communicate with a program providing device connected to a network outside the vehicle via the communication device, download (receive) a control program of the ECU from the program providing device, and update the control program of the ECU (e.g., see JP 2017-97851A).</p><p id="p-0005" num="0004">In the communication device (relay device) in JP 2017-97851A, when transmitting a downloaded control program to an ECU to be updated, since there is no consideration of suppressing an increase in the traffic (bus load) of a communication line such as a bus to which other ECUs are connected, there is a problem in that processing relating to the update cannot be efficiently performed.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0006" num="0005">An object of the present disclosure is to provide a vehicle-mounted update device and the like with which, when performing processing for updating a control program of a vehicle-mounted ECU, an increase in the traffic of the communication line to which other vehicle-mounted ECUs are connected can be suppressed.</p><p id="p-0007" num="0006">A vehicle-mounted update device according to an aspect of the present disclosure is a vehicle-mounted update device for acquiring an update program transmitted from an external server located outside a vehicle, and performing processing for updating a program of a vehicle-mounted ECU mounted in the vehicle, the vehicle-mounted update device including a control unit configured to control transmission of the update program, and a plurality of communication units to which the vehicle-mounted ECU is connected, and the control unit, when acquiring the update program, acquires information regarding a communication unit to which a vehicle-mounted ECU to be updated is connected from the external server, and outputs the update program from the communication unit to which the vehicle-mounted ECU to be updated is connected, based on the acquired information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected.</p><heading id="h-0005" level="1">Advantageous Effects of Present Disclosure</heading><p id="p-0008" num="0007">According to an aspect of the present disclosure, a vehicle-mounted update device and the like can be provided with which, when performing processing for updating a control program of a vehicle-mounted ECU, an increase in the traffic of the communication line to which other vehicle-mounted ECUs are connected is suppressed.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0006" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a schematic diagram illustrating a configuration of a vehicle-mounted update system including a vehicle-mounted update device according to a first embodiment.</p><p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a block diagram illustrating a physical configuration of the vehicle-mounted update device.</p><p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is an illustrative diagram showing an exemplary aspect of identification information of communication units (communication unit identification table).</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flowchart illustrating processing performed by a control unit of the vehicle-mounted update device.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a flowchart illustrating processing performed by a control unit of a vehicle-mounted update device according to a second embodiment.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a flowchart illustrating processing performed by a control unit of a vehicle-mounted update device according to a third embodiment.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0007" level="1">DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS</heading><p id="p-0015" num="0014">First, embodiments of the present disclosure will be listed and described. At least some of the embodiments described below may be combined as appropriate.</p><heading id="h-0008" level="2">First Aspect</heading><p id="p-0016" num="0015">A vehicle-mounted update device according to a first aspect of the present disclosure is a vehicle-mounted update device for acquiring an update program transmitted from an external server located outside a vehicle, and performing processing for updating a program of a vehicle-mounted ECU mounted in the vehicle, the vehicle-mounted update device including a control unit configured to control transmission of the update program, and a plurality of communication units to which the vehicle-mounted ECU is connected, and the control unit, when acquiring the update program, acquires information regarding a communication unit to which a vehicle-mounted ECU to be updated is connected from the external server, and outputs the update program from the communication unit to which the vehicle-mounted ECU to be updated is connected, based on the acquired information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected.</p><p id="p-0017" num="0016">With the first aspect, when acquiring the update program from the external server, the vehicle-mounted update device also acquires, from the external server, the information regarding the communication unit to which the vehicle-mounted ECU to be updated serving as the output destination (transmission destination) of the update program is connected. The vehicle-mounted update device outputs the update program from the communication unit to which the vehicle-mounted ECU to be updated is connected, which eliminates the need to output the update program from communication units other than the communication unit to which the vehicle-mounted ECU to be updated is connected. Accordingly, an increase in the traffic (bus load) of the communication line connected to the communication unit can be suppressed, and the update program can be efficiently output (transmitted) to the vehicle-mounted ECU to be updated.</p><heading id="h-0009" level="2">Second Aspect</heading><p id="p-0018" num="0017">A configuration is also possible in which, in the vehicle-mounted update device according to a second aspect of the present disclosure, if the communication unit corresponding to the information regarding the communication unit to which the vehicle-mounted ECU to be update is connected that is acquired from the external server cannot be specified out of the plurality of communication units, the control unit outputs, to the external server, information including a fact that the communication unit to which the vehicle-mounted ECU to be updated is connected cannot be specified.</p><p id="p-0019" num="0018">With the second aspect, when it is not possible to specify the communication unit corresponding to the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected that is acquired from the external server, the vehicle-mounted update device outputs the information including the fact that the communication unit cannot be specified to the external server. Accordingly, when outputting, to the external server, the information indicating the failure to transmit the update program corresponding to the communication unit to which the vehicle-mounted ECU to be updated is connected that is acquired from the external server, the vehicle-mounted update device can also output the cause of the failure included in this information.</p><heading id="h-0010" level="2">Third Aspect</heading><p id="p-0020" num="0019">A configuration is also possible in which, in the vehicle-mounted update device according to a third aspect of the present disclosure, if the control unit cannot receive a response, from the vehicle-mounted ECU to be updated, to output of the update program, the control unit outputs, to the external server, information including a fact that the response from the vehicle-mounted ECU to be updated cannot be received.</p><p id="p-0021" num="0020">With the third aspect, the vehicle-mounted update device tries to receive the response to the output of the update program from the vehicle-mounted ECU to be updated, and in the case of failing to receive the response, the vehicle-mounted update device outputs, to the external server, information including the fact that the response cannot be received from the vehicle-mounted ECU to be updated. Accordingly, when outputting, to the external server, the information indicating the failure to transmit the update program corresponding to the communication unit to which the vehicle-mounted ECU to be updated is connected that is acquired from the external server, the vehicle-mounted update device can also output the cause of the failure included in this information.</p><heading id="h-0011" level="2">Fourth Aspect</heading><p id="p-0022" num="0021">A configuration is also possible in which, in the vehicle-mounted update device according to a fourth aspect of the present disclosure, the communication unit includes a CAN transceiver compatible with a CAN protocol, and the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected includes information specifying the CAN transceiver.</p><p id="p-0023" num="0022">With the fourth aspect, the communication unit of the vehicle-mounted update device includes the CAN transceiver. In other words, the vehicle-mounted update device functions as a CAN gateway. The information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected that is acquired from the external server, includes information specifying the CAN transceiver, and thus the CAN transceiver to which the vehicle-mounted ECU to be updated is connected can be efficiently specified and the update program can be output from the specified CAN transceiver to the vehicle-mounted ECU to be updated.</p><heading id="h-0012" level="2">Fifth Aspect</heading><p id="p-0024" num="0023">A configuration is also possible in which, in the vehicle-mounted update device according to a fifth aspect of the present disclosure, the communication unit references identification information of the communication units stored in a predetermined storage area, and specifies a communication unit corresponding to the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected that is acquired from the external server.</p><p id="p-0025" num="0024">With the fifth aspect, the vehicle-mounted update device references the identification information of the communication unit stored in a predetermined storage area, and specifies the communication unit corresponding to the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected that is acquired from the external server, and thus is able to efficiently specify the corresponding communication unit as well as determining the presence/absence of the communication unit.</p><heading id="h-0013" level="2">Sixth Aspect</heading><p id="p-0026" num="0025">A program according to a sixth aspect of the present disclosure is a program for causing a computer to execute processing for acquiring an update program and information regarding a communication unit to which a vehicle-mounted ECU to be updated is connected, the update program and the information being transmitted from an external server located outside a vehicle, and outputting the update program from the communication unit to which the vehicle-mounted ECU to be updated is connected, based on the acquired information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected.</p><p id="p-0027" num="0026">With the sixth aspect, it is possible to cause a computer to function as the vehicle-mounted update device.</p><heading id="h-0014" level="2">Seventh Aspect</heading><p id="p-0028" num="0027">A program update method according to a seventh aspect of the present disclosure is a program update method for causing a computer to execute processing for acquiring an update program and information regarding a communication unit to which a vehicle-mounted ECU to be updated is connected, the update program and the information being transmitted from the external server located outside a vehicle, and outputting the update program from the communication unit to which the vehicle-mounted ECU to be updated is connected, based on the acquired information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected.</p><p id="p-0029" num="0028">With the seventh aspect, it is possible to provide the program update method according to which, when performing processing for updating the control program of the vehicle-mounted ECU, an increase in the traffic of the communication line to which other vehicle-mounted ECUs are connected is suppressed.</p><p id="p-0030" num="0029">The following specifically describes the present disclosure based on drawings that illustrate embodiments thereof. A vehicle-mounted update device <b>2</b> according to the embodiments of the present disclosure will be described below with reference to the drawings. Note that the present disclosure is not limited to the examples, but is indicated by the claims, and is intended to include all modifications within the meaning and scope equivalent to the scope of the claims.</p><heading id="h-0015" level="1">First Embodiment</heading><p id="p-0031" num="0030">The following describes an embodiment based on the drawings. <figref idref="DRAWINGS">FIG. <b>1</b></figref> is a schematic diagram showing a configuration of a vehicle-mounted update system according to a first embodiment. <figref idref="DRAWINGS">FIG. <b>2</b></figref> is a block diagram showing a configuration of a vehicle-mounted update device <b>2</b> and the like. The vehicle-mounted update system S includes an out-of-vehicle communication device <b>1</b> and the vehicle-mounted update device <b>2</b>, which are mounted in a vehicle C, and transmits a program or data acquired from a program providing device S<b>1</b> that is connected to the vehicle-mounted update system S via an out-of-vehicle network N, to vehicle-mounted ECUs <b>3</b> (Electronic Control Units/vehicle-mounted control devices) mounted in the vehicle C.</p><p id="p-0032" num="0031">The program providing device S<b>1</b> is a computer such as a server connected to the out-of-vehicle network N which is the Internet, a public network or the like, includes a storage unit S<b>11</b> constituted by a RAM (Random Access Memory), a ROM (Read Only Memory), a hard disk, or the like, and corresponds to an external server located outside the vehicle. A program or data created by the manufacturer or the like of the vehicle-mounted ECUs <b>3</b> for controlling the vehicle-mounted ECUs <b>3</b> is stored in the storage unit S<b>11</b> of the program providing device S<b>1</b>. The program or data is transmitted to the vehicle C as an update program, as described later, and used to update the program or data of the vehicle-mounted ECUs <b>3</b> mounted in the vehicle C. Further, information for specifying an in-vehicle communication unit <b>23</b> of the vehicle-mounted update device <b>2</b> to which a vehicle-mounted ECU <b>3</b> to be updated by the update program is connected, or the communication line <b>41</b> connected to the in-vehicle communication unit <b>23</b>, is stored in the storage unit S<b>11</b>. The program providing device S<b>1</b> (external server) configured as above is also referred to as an OTA (Over The Air) server. The vehicle-mounted ECUs <b>3</b> mounted in the vehicle acquire the update program transmitted from the program providing device S<b>1</b> by wireless communication, and apply the update program as the program to be executed, and thus the ECUs can update (re-program) the program to be executed by the ECUs.</p><p id="p-0033" num="0032">In the following description, the program is assumed to include an external file in which program code including control syntaxes and the like for performing processing by the vehicle-mounted ECUs <b>3</b> and data that is referenced when executing the program code are described. At the time of transmitting the update program, the external file in which the program code and the data are described is transmitted from the program providing device S<b>1</b> as an encoded archive file, for example.</p><p id="p-0034" num="0033">An out-of-vehicle communication device <b>1</b>, the vehicle-mounted update device <b>2</b>, a display device <b>5</b>, and the plurality of vehicle-mounted ECUs <b>3</b> for controlling various vehicle-mounted devices are mounted in the vehicle C. The out-of-vehicle communication device <b>1</b> and the vehicle-mounted update device <b>2</b> are communicably connected to each other by a harness such as a serial cable. The vehicle-mounted update device <b>2</b> and the vehicle-mounted ECUs <b>3</b> are communicably connected to each other via an in-vehicle LAN <b>4</b> compatible with a communication protocol such as CAN (Control Area Network/registered trademark) or Ethernet (registered trademark).</p><p id="p-0035" num="0034">The out-of-vehicle communication device <b>1</b> includes an out-of-vehicle communicating unit (not shown) and an input/output I/F (interface) (not shown) for communicating with the vehicle-mounted update device <b>2</b>. The out-of-vehicle communication unit is a communication device for performing wireless communication using a mobile communication protocol such as 3G, LTE, 4G, or Wi-Fi, and transmits and receives data to and from the program providing device S<b>1</b> via an antenna <b>11</b> connected to the out-of-vehicle communication unit. The communication between the out-of-vehicle communication device <b>1</b> and the program providing device S<b>1</b> is performed via an external network such as a public network or the Internet.</p><p id="p-0036" num="0035">An input/output I/F of the out-of-vehicle communication device <b>1</b> is a communication interface for performing serial communication with the vehicle-mounted update device <b>2</b>, for example. The out-of-vehicle communication device <b>1</b> and the vehicle-mounted update device <b>2</b> communicate with each other via a harness such as a serial cable connected to an input/output I/F <b>12</b>. In the present embodiment, the out-of-vehicle communication device <b>1</b> is a device separate from the vehicle-mounted update device <b>2</b>, and these devices are communicably connected to each other via the input/output I/F <b>12</b> and the like, but there is no limitation to this. The out-of-vehicle communication device <b>1</b> may be built in the vehicle-mounted update device <b>2</b> as a constituent part of the vehicle-mounted update device <b>2</b>.</p><p id="p-0037" num="0036">The vehicle-mounted update device <b>2</b> includes a control unit <b>20</b>, a storage unit <b>21</b>, and an in-vehicle communication unit <b>23</b>. The vehicle-mounted update device <b>2</b> is configured to acquire, from the out-of-vehicle communication device <b>1</b>, the update program received by the out-of-vehicle communication device <b>1</b> from the program providing device S<b>1</b> by wireless communication, and transmit the update program to a predetermined vehicle-mounted ECU <b>3</b> (vehicle-mounted ECU <b>3</b> to be updated) via the in-vehicle LAN <b>4</b>. The vehicle-mounted update device <b>2</b> is a gateway (relay device) that generally controls buses (segments) in a plurality of systems such as vehicle-mounted ECUs <b>3</b> of a control system, vehicle-mounted ECUs <b>3</b> of a safety system, and vehicle-mounted ECUs <b>3</b> of a body system, and that relays communication between the vehicle-mounted ECUs <b>3</b> between these buses (segments). In other words, the vehicle-mounted update device <b>2</b> functions as a CAN gateway in relaying according to the CAN protocol, and functions as a layer <b>2</b> switch or a layer <b>3</b> switch in relaying according to the TCP/IP protocol. Alternatively, the vehicle-mounted update device <b>2</b> may be configured as a functional unit of a body ECU that performs overall control of the vehicle C.</p><p id="p-0038" num="0037">The control unit <b>20</b> is constituted by a CPU (Central Processing Unit), an MPU (Micro Processing Unit), or the like, and is configured to perform various kinds of control processing, computational processing, and the like by reading out and executing a control program and data stored in advance in the storage unit <b>21</b>.</p><p id="p-0039" num="0038">The storage unit <b>21</b> is constituted by a volatile memory device such as a RAM (Random Access Memory) or a nonvolatile memory device such as a ROM (Read Only Memory), an EEPROM (Electrically Erasable Programmable ROM), or a flash memory, and a control program and data to be referenced at the time of processing are stored therein in advance. The control program stored in the storage unit <b>21</b> may also be a control program read out from a recording medium <b>211</b> that can be read by the vehicle-mounted update device <b>2</b>, and stored in the storage unit <b>21</b>. Also, the control program may also be a control program downloaded from an external computer (not shown) connected to a communication network (not shown), and stored in the storage unit <b>21</b>. Further, identification information (communication unit identification table) for identifying and specifying a plurality of Ethernet communication units <b>231</b> and CAN communication units <b>232</b> included in the in-vehicle communication units <b>23</b>, which will be described later, is stored in the storage unit <b>21</b>. The update program acquired from the program providing device S<b>1</b> and information regarding progress of transmission of the update program to the vehicle-mounted ECU <b>3</b> are stored in the storage unit <b>21</b>.</p><p id="p-0040" num="0039">Relay path information (routing table) used for performing relay processing for communication between the vehicle-mounted ECUs <b>3</b>, or communication between the vehicle-mounted ECUs <b>3</b> and the external server <b>100</b> is stored in the storage unit <b>21</b>. The format of the relay path information is determined based on a communication protocol. When the communication protocol is CAN, CAN relay path information includes a message identifier (CAN-ID) included in a CAN message, and a relay destination (an I/O port number of a CAN communication unit <b>232</b>) associated with the CAN-ID. When the communication protocol is TCP/IP, TCP/IP relay path information includes a transmission destination address (a MAC address or an IP address) included in an IP packet, and a relay destination (a physical port number of an Ethernet communication unit <b>231</b>) associated with the transmission destination address.</p><p id="p-0041" num="0040">Similarly to the input/output I/F of the out-of-vehicle communication device <b>1</b>, an input/output I/F <b>22</b> is a communication interface for performing serial communication, for example. The vehicle-mounted update device <b>2</b> is communicably connected, via the input/output I/F <b>22</b>, to the out-of-vehicle communication device <b>1</b>, the display device <b>5</b> (HMI device), and the IG switch <b>6</b> for starting and stopping the vehicle C.</p><p id="p-0042" num="0041">The in-vehicle communication unit <b>23</b> is, for example, an input/output interface (CAN communication unit <b>232</b>, Ethernet communication unit <b>231</b>) using a communication protocol of a CAN (Control Area Network), CAN-FD (CAN with Flexible Data Rate), or Ethernet (registered trademark), and function as communication units for communication between the vehicle-mounted update device <b>2</b> and the vehicle-mounted ECUs <b>3</b>. The in-vehicle communication unit <b>23</b> include the CAN communication units <b>232</b> and the Ethernet communication units <b>231</b>.</p><p id="p-0043" num="0042">The CAN communication unit <b>232</b> is a CAN transceiver or a CAN-FD transceiver that is compatible with the CAN or CAN-FD communication protocol, and supports CAN messages transmitted on a CAN bus <b>412</b>. The CAN communication unit <b>232</b> receives a waveform resulting from a potential difference between differential voltages on the CAN bus <b>412</b>, which is formed by two wires respectively disposed on the high side and the low side, and decodes the received waveform into a signal represented by a bit string of 1s and 0s. Alternatively, the CAN communication unit <b>232</b> may include the CAN transceiver and a CAN controller, or include the CAN-FD transceiver and a CAN-FD controller.</p><p id="p-0044" num="0043">The Ethernet communication unit <b>231</b> is an Ethernet PHY unit that supports TCP/IP packets transmitted with an Ethernet cable <b>411</b> such as 100BASE-T1 or 1000BASE-T1.</p><p id="p-0045" num="0044">A plurality of the in-vehicle communication units <b>23</b> (Ethernet communication units <b>231</b>, CAN communication units <b>232</b>) are provided, and each of the communication lines <b>41</b> (Ethernet cable <b>411</b>, CAN bus <b>412</b>), or in other words, each of the buses constituting the vehicle-mounted network <b>4</b> is connected to each of the in-vehicle communication units <b>23</b>. By providing a plurality of the in-vehicle communication units <b>23</b> in this manner, the vehicle-mounted network <b>4</b> may be divided into a plurality of buses (segments), and the vehicle-mounted ECUs <b>3</b> may be respectively connected to the segments according to the function of the vehicle-mounted ECUs <b>3</b>. The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> mutually communicates with the vehicle-mounted ECUs <b>3</b> or other vehicle-mounted devices such as a relay device connected to the in-vehicle network <b>4</b> via the in-vehicle communication unit <b>23</b>.</p><p id="p-0046" num="0045">Similarly to the vehicle-mounted update device <b>2</b>, the vehicle-mounted ECU <b>3</b> includes a control unit (not shown), a storage unit (not shown), and an in-vehicle communication unit (not shown). The storage unit is constituted by a volatile memory device such as a RAM (Random Access Memory) or a nonvolatile memory device such as a ROM (Read Only Memory), an EEPROM (Electrically Erasable Programmable ROM), or a flash memory, and a program or data of the vehicle-mounted ECU <b>3</b> is stored therein. The program or data is to be updated by the update program transmitted from the program providing device and relayed by the vehicle-mounted update device <b>2</b>. Similarly to the vehicle-mounted update device <b>2</b>, the in-vehicle communication units of the vehicle-mounted ECUs <b>3</b> include Ethernet communication units or CAN communication units, and the vehicle-mounted ECUs <b>3</b> communicate with the vehicle-mounted update device <b>2</b> via the in-vehicle communication units.</p><p id="p-0047" num="0046">The display device <b>5</b> is an HMI (Human Machine Interface) device such as a display of a car navigation system, for example. The display device <b>5</b> is communicably connected to an input/output I/F <b>22</b> of the vehicle-mounted update device <b>2</b> via a harness such as a serial cable. The display device <b>5</b> displays data or information that is output from the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> via the input/output I/F <b>22</b>.</p><p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a diagram illustrating an aspect of identification information of the in-vehicle communication units <b>23</b> (in-vehicle communication unit <b>23</b> identification table). Identification information for identifying the plurality of in-vehicle communication units <b>23</b> included in the vehicle-mounted update device <b>2</b> is stored in the storage unit <b>21</b> of the vehicle-mounted update device <b>2</b>. The identification information is stored in table format as the in-vehicle communication unit <b>23</b> identification table, for example, and the in-vehicle communication unit <b>23</b> identification table includes communication unit number, protocol, and bus name as the management items.</p><p id="p-0049" num="0048">&#x201c;Communication unit number&#x201d; is the number (identification number) for identifying each in-vehicle communication unit <b>23</b>. If the in-vehicle communication unit <b>23</b> is the CAN communication unit <b>232</b> (CAN transceiver), for example, the communication unit number indicates the I/O port number, and if the in-vehicle communication unit <b>23</b> is the Ethernet communication unit <b>231</b> (Ethernet PHY unit), the communication unit number indicates the physical port number. Numbers for identifying the in-vehicle communication units <b>23</b> are stored in the field for communication unit numbers (communication unit number field). The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> can specify the type of the in-vehicle communication unit <b>23</b> (the Ethernet communication unit <b>231</b> or the CAN communication unit <b>232</b>) by referencing the communication unit number stored in the communication unit number field.</p><p id="p-0050" num="0049">Information regarding the type of communication protocols (CAN, Ethernet) used by the in-vehicle communication units <b>23</b> having the communication unit numbers stored in the communication unit number field is stored in the field for protocols (protocol field). The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> can grasp the type of communication protocol used by the specified in-vehicle communication unit <b>23</b> by referencing the communication unit number stored in the communication unit number field.</p><p id="p-0051" num="0050">Information regarding the name and type of the buses (segments) connected to the in-vehicle communication units <b>23</b> of the communication unit numbers stored in the communication unit number field is stored in the field for bus names (bus name field). The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> can acquire information regarding the name or type of the bus (segment) connected to the specified in-vehicle communication unit <b>23</b> by referencing the communication unit number stored in the communication unit number field.</p><p id="p-0052" num="0051">Since the identification information of the in-vehicle communication unit <b>23</b> is stored in table format as the in-vehicle communication unit <b>23</b> identification table, the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> can search for the communication unit number of the in-vehicle communication unit <b>23</b> corresponding to the value of &#x201c;bus name&#x201d;, based on the value of &#x201c;bus name&#x201d;.</p><p id="p-0053" num="0052">The identification information of the in-vehicle communication unit <b>23</b> (in-vehicle communication unit <b>23</b> identification table) is stored in the storage unit <b>21</b> of the vehicle-mounted update device <b>2</b>, but there is no limitation to this. The identification information (in-vehicle communication units <b>23</b> identification table) of the in-vehicle communication units <b>23</b> may also be stored in a predetermined storage area, which is accessible by the vehicle-mounted update device <b>2</b>, such as a storage unit of one of the vehicle-mounted ECUs mounted in the vehicle C, or the storage unit of a cloud server provided outside of the vehicle C such as the program providing device S<b>1</b>.</p><p id="p-0054" num="0053">The vehicle-mounted update device <b>2</b> communicates with the program providing device S<b>1</b> via the out-of-vehicle communication device <b>1</b>, and when acquiring the update program from the program providing device S<b>1</b>, also acquires information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected. The vehicle-mounted update device <b>2</b> specifies one of the in-vehicle communication units <b>23</b> in the own device based on information regarding the in-vehicle communication unit <b>23</b> acquired from the program providing device S<b>1</b>, for example, by referencing the in-vehicle communication unit <b>23</b> identification table stored in the storage unit <b>21</b>.</p><p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flowchart illustrating processing performed by the control unit <b>20</b> of the vehicle-mounted update device <b>2</b>. The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> steadily performs the following processing in the state where the vehicle C has been started (the IG switch <b>6</b> is ON) or stopped (where IG switch <b>6</b> is OFF).</p><p id="p-0056" num="0055">The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> determines whether there is information regarding the update program (S<b>101</b>). The control unit <b>20</b> communicates with the program providing device S<b>1</b> via the out-of-vehicle communication device <b>1</b>, inquires whether there is information regarding the update program, and determines whether there is information regarding the update program such as campaign information. Determination of whether there is information regarding the update program may also be performed not only by pull-type communication through an inquiry from the vehicle-mounted update device <b>2</b> to the program providing device S<b>1</b>, but also based on push-type communication through a message or the like transmitted from the program providing device S<b>1</b> to the vehicle-mounted update device <b>2</b>.</p><p id="p-0057" num="0056">If there is no information regarding the update program (S<b>101</b>: NO), the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> performs loop processing in order to execute the processing of S<b>101</b> again. By performing the loop processing, the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> periodically performs an inquiry about whether there is information regarding the update program to the program providing device S<b>1</b>.</p><p id="p-0058" num="0057">If there is information regarding the update program (S<b>101</b>: YES), the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> acquires the update program and information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected (S<b>102</b>). When acquiring the update program from the program providing device S<b>1</b>, the control unit <b>20</b> acquires information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected, together with the update program. The control unit <b>20</b> may also acquire the information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected, separately from the update program. Alternatively, if the information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected is provided as archived data included in the update program, the control unit <b>20</b> acquires and develops the archived update program (archived data) and acquires the information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected. The control unit <b>20</b> saves the acquired update program in the storage unit <b>21</b>.</p><p id="p-0059" num="0058">The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> specifies the in-vehicle communication unit <b>23</b> for outputting the update program (S<b>103</b>). The control unit <b>20</b> specifies the in-vehicle communication unit <b>23</b> included in the own device based on the acquired information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected. For example, if the information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected that is acquired from the program providing device S<b>1</b> includes the communication unit number that uniquely specifies the in-vehicle communication unit <b>23</b>, the control unit <b>20</b> specifies the in-vehicle communication unit <b>23</b> in the own device based on that communication unit number. The control unit <b>20</b> may also specify the in-vehicle communication unit <b>23</b> corresponding to the acquired information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected, by referencing the identification information of the in-vehicle communication units <b>23</b> (communication unit identification table) stored in the storage unit <b>21</b>. For example, if the information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected that is acquired from the program providing device S<b>1</b> includes the items regarding the name or type (bus name) of the bus connected to that in-vehicle communication unit <b>23</b>, the control unit <b>20</b> may also reference the communication unit identification table, conduct reverse lookup search for the communication unit number from the bus name, and derive the communication unit number of the in-vehicle communication unit <b>23</b>.</p><p id="p-0060" num="0059">The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> outputs (transmits) the update program from the specified in-vehicle communication unit <b>23</b> (S<b>104</b>). The control unit <b>20</b> transmits the update program from the specified in-vehicle communication unit <b>23</b> to the vehicle-mounted ECU <b>3</b> to be updated by outputting the update program that is acquired from the program providing device S<b>1</b> and temporarily saved in the storage unit <b>21</b>. The control unit <b>20</b> outputs the update program only from the specified in-vehicle communication unit <b>23</b>, thus making it possible to suppress an increase in the traffic (bus load) of the communication lines <b>41</b> (buses) connected to the in-vehicle communication units <b>23</b> other than the specified in-vehicle communication unit <b>23</b>.</p><p id="p-0061" num="0060">The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> transmits information regarding the result of outputting the update program to the program providing device S<b>1</b> (S<b>105</b>). The control unit <b>20</b> transmits (outputs), to the program providing device S<b>1</b>, for example, information indicating the date and time when the update program is transmitted to the vehicle-mounted ECU <b>3</b> to be updated, the result of response received from the vehicle-mounted ECU <b>3</b> to be updated as the result of transmission, or the fact indicating that the update processing has been normally performed, as information regarding the result of outputting the update program, via the out-of-vehicle communication device <b>1</b>. The control unit <b>20</b> may also output, to the display device <b>5</b>, the information regarding the result of outputting the update program. Due to the control unit <b>20</b> outputting the information regarding the result of outputting the update program to the program providing device S<b>1</b> or the display device <b>5</b>, the information can be notified to the administrator of the program providing device S<b>1</b> or the operator of the vehicle C.</p><p id="p-0062" num="0061">According to the present embodiment, the vehicle-mounted update device <b>2</b> outputs the update program from the in-vehicle communication unit <b>23</b> (the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected) based on the information regarding the in-vehicle communication unit <b>23</b> acquired from the program providing device S<b>1</b>. Accordingly, it is possible to eliminate the need to output the update program from the in-vehicle communication units <b>23</b> other than the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected. Also, an increase in the traffic (bus load) of the communication lines <b>41</b> connected to the in-vehicle communication unit <b>23</b> can be suppressed, and the update program can be efficiently output (transmitted) to the vehicle-mounted ECU <b>3</b> to be updated. Further, since the information for specifying the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected is the information transmitted from the program providing device S<b>1</b> together with the update program, the vehicle-mounted update device <b>2</b> can acquire the information for which the association between the update program and the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected is ensured.</p><heading id="h-0016" level="1">Second Embodiment</heading><p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a flowchart illustrating processing performed by a control unit <b>20</b> of a vehicle-mounted update device <b>2</b> according to a second embodiment. The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> steadily performs the following processing in the state where the vehicle C has been started (the IG switch <b>6</b> is ON) or stopped (the IG switch <b>6</b> is OFF).</p><p id="p-0064" num="0063">The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> determines whether there is information regarding the update program (S<b>201</b>). If there is no information regarding the update program (S<b>201</b>: NO), the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> performs loop processing in order to execute processing of S<b>201</b> again. If there is the information regarding the update program (S<b>201</b>: YES), the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> acquires the update program and information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected (S<b>202</b>). The control unit <b>20</b> performs the processing of S<b>201</b> and S<b>202</b> similarly to the processing of S<b>101</b> and S<b>102</b> of the first embodiment.</p><p id="p-0065" num="0064">The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> determines whether the in-vehicle communication unit <b>23</b> for outputting the update program has been specified (S<b>203</b>). The control unit <b>20</b> compares the information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected that is acquired from the program providing device S<b>1</b> with the identification information of the in-vehicle communication units <b>23</b> (communication unit identification table) stored in the storage unit <b>21</b>, for example. The control unit <b>20</b> determines whether the in-vehicle communication unit <b>23</b> that is included in the information acquired from the program providing device S<b>1</b> exists in the own device, that is, whether the in-vehicle communication unit <b>23</b> corresponds to any of the in-vehicle communication units <b>23</b> provided in the own device, based on the comparison result.</p><p id="p-0066" num="0065">If the in-vehicle communication unit <b>23</b> that is included in the information acquired from the program providing device S<b>1</b> exists in the own device, the control unit <b>20</b> specifies the in-vehicle communication unit <b>23</b> for outputting the update program similarly to the processing of S<b>103</b> of the first embodiment, and determines that the in-vehicle communication unit <b>23</b> can be specified.</p><p id="p-0067" num="0066">If the in-vehicle communication unit <b>23</b> included in the information acquired from the program providing device S<b>1</b> does not exist in the own device, the control unit <b>20</b> determines that the in-vehicle communication unit <b>23</b> for outputting the update program cannot be specified. The case where the in-vehicle communication unit <b>23</b> cannot be specified is as follows. For example, the in-vehicle communication unit <b>23</b> included in the information acquired from the program providing device S<b>1</b> indicates the communication unit number (I/O port number) of &#x201c;007&#x201d; of the CAN communication unit <b>232</b>. However, in this case, the CAN communication unit <b>232</b> whose communication unit number is &#x201c;007&#x201d; is not included in the information stored in the communication unit identification table, and the vehicle-mounted update device <b>2</b> is not provided with the CAN communication unit <b>232</b> whose communication unit number is &#x201c;007&#x201d;.</p><p id="p-0068" num="0067">If the in-vehicle communication unit <b>23</b> for outputting the update program cannot be specified (S<b>203</b>:NO), the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> outputs (transmits), to the program providing device S<b>1</b>, information including the fact that the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected cannot be specified (S<b>2031</b>). If the in-vehicle communication unit <b>23</b> for outputting the update program cannot be specified, that is, if the in-vehicle communication unit <b>23</b> included in the information acquired from the program providing device S<b>1</b> does not exist in the own device, the control unit <b>20</b> outputs (transmits), to the program providing device S<b>1</b>, the information including the fact that the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected cannot be specified. Further, the control unit <b>20</b> may also output (transmit) the information to the display unit. When outputting (transmitting) the information to the program providing device S<b>1</b>, the control unit <b>20</b> may also output (transmit), to the program providing device S<b>1</b>, the fact that the in-vehicle communication unit <b>23</b> included in the information transmitted from the program providing device S<b>1</b> does not exist in the own device. Alternatively, when outputting (transmitting) the information to the program providing device S<b>1</b>, the control unit <b>20</b> may also output (transmit) the information regarding the communication unit identification table to the program providing device S<b>1</b>.</p><p id="p-0069" num="0068">If the in-vehicle communication unit <b>23</b> for outputting the update program can be specified (S<b>203</b>: YES), the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> outputs (transmits) the update program from the specified in-vehicle communication unit <b>23</b> (S<b>204</b>). The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> transmits, to the program providing device S<b>1</b>, the information regarding the result of outputting the update program (S<b>205</b>). The control unit <b>20</b> performs the processing of S<b>204</b> and S<b>205</b> similarly to the processing of S<b>104</b> and S<b>105</b> of the first embodiment.</p><p id="p-0070" num="0069">According to the present embodiment, if the communication unit corresponding to the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected that is acquired from the program providing device S<b>1</b> cannot be specified, the vehicle-mounted update device <b>2</b> outputs, to the program providing device S<b>1</b>, information indicating the fact that the corresponding communication unit cannot be specified, including the cause which is that the corresponding communication unit does not exist in the own device. Accordingly, the fact that the application (activation) of the update program to the vehicle-mounted ECU <b>3</b> failed, including the cause of the failure of transmission of the update program, can be output (transmitted) to the program providing device S<b>1</b>.</p><heading id="h-0017" level="1">Third Embodiment</heading><p id="p-0071" num="0070"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a flowchart illustrating processing performed by a control unit <b>20</b> of a vehicle-mounted update device <b>2</b> according to a third embodiment. The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> steadily performs the following processing in the state where the vehicle C has been started (the IG switch <b>6</b> is ON) or stopped (the IG switch <b>6</b> is OFF).</p><p id="p-0072" num="0071">The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> determines whether there is information regarding the update program (S<b>301</b>). If there is no information regarding the update program (S<b>301</b>: NO), the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> performs loop processing in order to execute processing of S<b>301</b> again. If there is information regarding the update program (S<b>301</b>: YES), the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> acquires the update program and information regarding the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected (S<b>302</b>). The control unit <b>20</b> performs the processing of S<b>301</b> and S<b>302</b> similarly to the processing of S<b>101</b> and S<b>102</b> of the first embodiment.</p><p id="p-0073" num="0072">The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> determines whether the in-vehicle communication unit <b>23</b> for outputting the update program can be specified (S<b>303</b>). If the in-vehicle communication unit <b>23</b> for outputting the update program cannot be specified (S<b>303</b>:NO), the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> outputs (transmits), to the program providing device S<b>1</b>, information including the fact that the in-vehicle communication unit <b>23</b> to which the vehicle-mounted ECU <b>3</b> to be updated is connected cannot be specified (S<b>3031</b>). If the in-vehicle communication unit <b>23</b> for outputting the update program can be specified (S<b>303</b>: YES), the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> outputs (transmits) the update program from the specified in-vehicle communication unit <b>23</b> (S<b>304</b>). The control unit <b>20</b> performs the processing of S<b>303</b>, S<b>3031</b>, and S<b>304</b> similarly to the processing of S<b>203</b>, S<b>2031</b>, and S<b>204</b> of the second embodiment.</p><p id="p-0074" num="0073">The control unit <b>20</b> of the vehicle-mounted update device <b>2</b> determines whether the response to the output of the update program can be received from the vehicle-mounted ECU <b>3</b> to be updated (S<b>305</b>). After outputting (transmitting) the update program from the specified in-vehicle communication unit <b>23</b>, the control unit <b>20</b> tries to receive the response from the vehicle-mounted ECU <b>3</b> (the vehicle-mounted ECU <b>3</b> to be updated) that is the transmission destination of the update program. In other words, the control unit <b>20</b> waits for the response from the vehicle-mounted ECU <b>3</b> to be updated.</p><p id="p-0075" num="0074">If the response from the vehicle-mounted ECU <b>3</b> to be updated can be received (acquired), the control unit <b>20</b> determines that the response to the output of the update program can be received. If the response from the vehicle-mounted ECU <b>3</b> to be updated cannot be received (acquired), the control unit <b>20</b> determines that the response to the output of the update program cannot be received in a predetermined period that is determined in advance by the communication protocol, for example.</p><p id="p-0076" num="0075">If the response from the vehicle-mounted ECU <b>3</b> to be updated cannot be received (S<b>305</b>: NO), the control unit <b>20</b> of the vehicle-mounted update device <b>2</b> outputs (transmits), to the program providing device S<b>1</b>, information including the fact that the response from the vehicle-mounted ECU <b>3</b> to be updated cannot be received (S<b>3051</b>). If the response from the vehicle-mounted ECU <b>3</b> to be updated cannot be received, the control unit <b>20</b> outputs (transmits), to the program providing device S<b>1</b>, information indicating the fact that the vehicle-mounted ECU <b>3</b> to be updated is not connected to the communication line <b>41</b> (bus) that is connected to the in-vehicle communication unit <b>23</b> included in the information transmitted from the program providing device S<b>1</b>, for example. Further, the control unit <b>20</b> may also output (transmit) the information to the display unit.</p><p id="p-0077" num="0076">If the response from the vehicle-mounted ECU <b>3</b> to be updated can be received (S<b>305</b>: YES), the control unit <b>20</b> transmits, to the program providing device S<b>1</b>, information regarding the output result of the update program (S<b>306</b>). The control unit <b>20</b> performs the processing of S<b>306</b> similarly to the processing of S<b>105</b> of the first embodiment.</p><p id="p-0078" num="0077">According to the present embodiment, if the response to the output of the update program cannot be received from the vehicle-mounted ECU <b>3</b> to be updated, the vehicle-mounted update device <b>2</b> outputs, to the program providing device S<b>1</b>, the information including the fact that the vehicle-mounted ECU <b>3</b> to be updated is not connected to the communication line <b>41</b> (bus) that is connected to the in-vehicle communication unit <b>23</b> included in the information transmitted from the program providing device S<b>1</b>, for example. Accordingly, the fact that the application (activation) of the update program to the vehicle-mounted ECU <b>3</b> failed, including the cause of the failure in transmission of the update program, can be output (transmitted) to the program providing device S<b>1</b>.</p><p id="p-0079" num="0078">The embodiments in the present disclosure are examples in all aspects, and should be construed as non-limiting. The scope of the present disclosure is not limited to the above meanings, but is indicated by the claims, and is intended to include all modifications within the meaning and scope equivalent to the scope of the claims.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A vehicle-mounted update device for acquiring an update program transmitted from an external server located outside a vehicle, and performing processing for updating a program of a vehicle-mounted ECU mounted in the vehicle, the vehicle-mounted update device comprising:<claim-text>a control unit configured to control transmission of the update program; and</claim-text><claim-text>a plurality of communication units to which the vehicle-mounted ECU is connected,</claim-text><claim-text>wherein the control unit<claim-text>when acquiring the update program, acquires information regarding a communication unit to which a vehicle-mounted ECU to be updated is connected from the external server, and</claim-text><claim-text>outputs the update program from the communication unit to which the vehicle-mounted ECU to be updated is connected, based on the acquired information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected.</claim-text></claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The vehicle-mounted update device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein, if the communication unit corresponding to the information regarding the communication unit to which the vehicle-mounted ECU to be update is connected that is acquired from the external server cannot be specified out of the plurality of communication units, the control unit outputs, to the external server, information including a fact that the communication unit to which the vehicle-mounted ECU to be updated is connected cannot be specified.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The vehicle-mounted update device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein, if the control unit cannot receive a response, from the vehicle-mounted ECU to be updated, to output of the update program, the control unit outputs, to the external server, information including a fact that the response from the vehicle-mounted ECU to be updated cannot be received.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The vehicle-mounted update device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the communication unit includes a CAN transceiver compatible with a CAN protocol, and<claim-text>the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected includes information specifying the CAN transceiver.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The vehicle-mounted update device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the communication unit references identification information of the communication units stored in a predetermined storage area, and specifies a communication unit corresponding to the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected that is acquired from the external server.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. A program for causing a computer to execute processing for:<claim-text>acquiring an update program and information regarding a communication unit to which a vehicle-mounted ECU to be updated is connected, the update program and the information being transmitted from an external server located outside a vehicle; and</claim-text><claim-text>outputting the update program from the communication unit to which the vehicle-mounted ECU to be updated is connected, based on the acquired information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. A program update method for causing a computer to execute processing for:<claim-text>acquiring an update program and information regarding a communication unit to which a vehicle-mounted ECU to be updated is connected, the update program and the information being transmitted from the external server located outside a vehicle; and</claim-text><claim-text>outputting the update program from the communication unit to which the vehicle-mounted ECU to be updated is connected, based on the acquired information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The vehicle-mounted update device according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein, if the control unit cannot receive a response, from the vehicle-mounted ECU to be updated, to output of the update program, the control unit outputs, to the external server, information including a fact that the response from the vehicle-mounted ECU to be updated cannot be received.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The vehicle-mounted update device according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the communication unit includes a CAN transceiver compatible with a CAN protocol, and<claim-text>the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected includes information specifying the CAN transceiver.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The vehicle-mounted update device according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the communication unit includes a CAN transceiver compatible with a CAN protocol, and<claim-text>the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected includes information specifying the CAN transceiver.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The vehicle-mounted update device according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the communication unit references identification information of the communication units stored in a predetermined storage area, and specifies a communication unit corresponding to the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected that is acquired from the external server.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The vehicle-mounted update device according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the communication unit references identification information of the communication units stored in a predetermined storage area, and specifies a communication unit corresponding to the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected that is acquired from the external server.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The vehicle-mounted update device according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the communication unit references identification information of the communication units stored in a predetermined storage area, and specifies a communication unit corresponding to the information regarding the communication unit to which the vehicle-mounted ECU to be updated is connected that is acquired from the external server.</claim-text></claim></claims></us-patent-application>