<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007473A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007473</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17409202</doc-number><date>20210823</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>IN</country><doc-number>202141029404</doc-number><date>20210630</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>04</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>03</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>04</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>03</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">5G N1/N2 INTERFACE MONITORING SYSTEM</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>NetScout Systems, Inc.</orgname><address><city>Westford</city><state>MA</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Muthuchamy</last-name><first-name>Subappriya</first-name><address><city>Fremont</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Prasad</last-name><first-name>Sandeep</first-name><address><city>Pleasanton</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Liubinskas</last-name><first-name>Tauras</first-name><address><city>Lexington</city><state>KY</state><country>US</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>Saraswati</last-name><first-name>Abhishek</first-name><address><city>Santa Clara</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>Pinelli</last-name><first-name>Alessandro</first-name><address><city>Pune</city><country>IT</country></address></addressbook></inventor><inventor sequence="05" designation="us-only"><addressbook><last-name>Aherrao</last-name><first-name>Pritish Vijay</first-name><address><city>Maharashtra</city><country>IN</country></address></addressbook></inventor><inventor sequence="06" designation="us-only"><addressbook><last-name>Resta</last-name><first-name>Loreto Di</first-name><address><city>Modena</city><country>IT</country></address></addressbook></inventor><inventor sequence="07" designation="us-only"><addressbook><last-name>Bass</last-name><first-name>Brandon</first-name><address><city>Flower Mound</city><state>TX</state><country>US</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>NetScout Systems, Inc.</orgname><role>02</role><address><city>Westford</city><state>MA</state><country>US</country></address></addressbook></assignee></assignees></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">An illustrative embodiment disclosed herein is a non-transitory computer readable medium. The medium includes instructions for providing a mobile user monitoring solution that, when executed by a processor, cause the processor to identify a user database record associated with a user equipment (UE) using a mobile identity (ID), associate a Next Generation application protocol (NGAP) session with the user database record using an NGAP ID, capture a ciphered message associated with the NGAP session, decipher the ciphered message associated with the NGAP session, extract, from the deciphered message, session details associated with the UE, and store the session details in a session detail record.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="114.30mm" wi="158.75mm" file="US20230007473A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="222.42mm" wi="160.78mm" orientation="landscape" file="US20230007473A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="204.30mm" wi="166.29mm" orientation="landscape" file="US20230007473A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="202.10mm" wi="144.36mm" orientation="landscape" file="US20230007473A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="227.58mm" wi="144.78mm" orientation="landscape" file="US20230007473A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="228.09mm" wi="151.13mm" orientation="landscape" file="US20230007473A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="227.58mm" wi="162.73mm" orientation="landscape" file="US20230007473A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="220.81mm" wi="160.78mm" orientation="landscape" file="US20230007473A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="220.22mm" wi="159.43mm" orientation="landscape" file="US20230007473A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="220.81mm" wi="162.56mm" orientation="landscape" file="US20230007473A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="220.22mm" wi="159.60mm" orientation="landscape" file="US20230007473A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="215.22mm" wi="160.02mm" orientation="landscape" file="US20230007473A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="228.01mm" wi="160.87mm" orientation="landscape" file="US20230007473A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00013" num="00013"><img id="EMI-D00013" he="227.08mm" wi="161.29mm" orientation="landscape" file="US20230007473A1-20230105-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00014" num="00014"><img id="EMI-D00014" he="219.79mm" wi="156.80mm" orientation="landscape" file="US20230007473A1-20230105-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00015" num="00015"><img id="EMI-D00015" he="219.63mm" wi="151.55mm" orientation="landscape" file="US20230007473A1-20230105-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00016" num="00016"><img id="EMI-D00016" he="237.74mm" wi="166.37mm" orientation="landscape" file="US20230007473A1-20230105-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00017" num="00017"><img id="EMI-D00017" he="219.54mm" wi="158.67mm" orientation="landscape" file="US20230007473A1-20230105-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading><p id="p-0002" num="0001">This application is related to and claims priority under 35 U.S. &#xa7; 119(b) the Indian Patent Application No. 202141029404, filed Jun. 30, 2021, titled &#x201c;5G N1/N2 INTERFACE MONITORING SYSTEM,&#x201d; the entire contents of which are incorporated herein by reference for all purposes.</p><heading id="h-0002" level="1">BACKGROUND</heading><p id="p-0003" num="0002">The 5G Core aggregates data traffic from end devices. The 5G Core also authenticates subscribers and devices, applies personalized policies and manages the mobility of the devices before routing the traffic to operator services or the Internet. The 5G Core and its predecessor, the Evolved Core Packet (EPC), are different in that the 5G Core is decomposed into a number of Service-Based Architecture (SBA) elements and is designed from the ground-up for complete control and user plane separation. Rather than physical network elements, the 5G Core comprises software-based network functions.</p><heading id="h-0003" level="1">SUMMARY</heading><p id="p-0004" num="0003">Aspects of the present disclosure relate generally to a 5G network, and more particularly to a system, apparatus, and method for monitoring N1 and N2 interfaces.</p><p id="p-0005" num="0004">An illustrative embodiment disclosed herein is a non-transitory computer readable medium. The medium includes instructions for providing a mobile user monitoring solution that, when executed by a processor, cause the processor to identify a user database record associated with a user equipment (UE) using a mobile identity (ID), associate a Next Generation application protocol (NGAP) session with the user database record using an NGAP ID, capture a ciphered message associated with the NGAP session, decipher the ciphered message associated with the NGAP session, extract, from the deciphered message, session details associated with the UE, and store the session details in a session detail record.</p><p id="p-0006" num="0005">In some aspects, the user database record includes a permanent ID, the mobile ID includes one of a temporary mobile subscriber identity (TMSI), a shorten(S)-TMSI, a 5G-S-TMSI, a globally unique temporary ID (GUTI), or a 5G-GUTI, the permanent ID includes a subscription permanent identity (SUPI), and the SUPI contains one of an international mobile subscriber identity (IMSI) or a network access identifier (NAI).</p><p id="p-0007" num="0006">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to identify the user database record by capturing a first message transmitted over one of an N1 interface and an N2 interface, extracting the mobile ID from the first message, and identifying the user database record using the mobile ID.</p><p id="p-0008" num="0007">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to decipher the ciphered message associated with the NGAP session by retrieving, from the user database record, a cipher key using the mobile ID, and deciphering, using the cipher key, the ciphered message associated with the NGAP session.</p><p id="p-0009" num="0008">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to associate the NGAP session with the user database record by capturing a first message transmitted over one of an N1 interface or an N2 interface, extracting, from the first message, one of the NGAP ID, an expected response (XRES), or an authentication token (AUTN), and associating the NGAP session with the user database record using the one of the NGAP ID, the XRES, or the AUTN.</p><p id="p-0010" num="0009">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to associate the NGAP session with the user database record by capturing a second message transmitted over an N12 interface, extracting, from the second message, one of the XRES or the AUTN, a permanent ID, and a cipher key, storing the one of the XRES or the AUTN and the permanent ID in an XRES record, storing the permanent ID and the cipher key in the user database record; extracting, from the first message, the one of the XRES or the AUTN, retrieving the permanent ID from the XRES record using the one of the XRES or the AUTN, and retrieving the cipher key from the user database record using the permanent ID.</p><p id="p-0011" num="0010">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to capture a first message transmitted over an N2 interface; extract, from the first message, the NGAP ID and a second mobile ID, retrieve the mobile ID from an NGAP record using the NGAP ID, retrieve the user database record using the mobile ID, and update the mobile ID with the second mobile ID.</p><p id="p-0012" num="0011">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to capture a first message transmitted over one of an N1 interface or an N2 interface, extract, from the first message, the NGAP ID, wherein the NGAP ID is stored in an NGAP record, capture a second message transmitted over the one of the N1 interface or the N2 interface, extract, from the second message, a second NGAP ID, store the second NGAP ID in a second NGAP record, retrieve, from the NGAP record, using the NGAP ID, the mobile ID and a permanent ID, and store the mobile ID and the permanent ID in the second NGAP record.</p><p id="p-0013" num="0012">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to capture a first message transmitted over an N1 interface or an N2 interface, extract, from the first message, a first container ID and the NGAP ID, retrieve an NGAP record using the NGAP ID, store the first container ID, the mobile ID, and a permanent ID in a container record, capture a second message transmitted over the one of the N1 interface or the N2 interface, extract, from the second message, a second container ID and a second NGAP ID, store the second NGAP ID in a second NGAP record, retrieve, from the container record, using the second container ID, the mobile ID and the permanent ID, and store the mobile ID and the permanent ID in the second NGAP record. In some embodiments, the second container ID matches the first container ID.</p><p id="p-0014" num="0013">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to capture a first message transmitted over an N14 interface, extract, from the first message, a first container ID, a permanent ID, and a cipher key, store the permanent ID and the cipher key in the user database record, store the first container ID and the permanent ID in a container record, capture a second message transmitted over one of an N1 interface or an N2 interface, extract, from the second message, a second container ID and the NGAP ID, store the NGAP ID in the NGAP record, retrieve, from the container record, using the second container ID, the permanent ID, retrieve, from the user database record, using the permanent ID, the cipher key, and store the permanent ID and the cipher key in the NGAP record. In some embodiments, wherein the second container ID matches the first container ID.</p><p id="p-0015" num="0014">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to capture a first message transmitted over one of an N1 interface or an N2 interface, extract, from the first message, the mobile ID, capture a pair of messages transmitted over an N14 interface, extract, from the pair of messages, a second mobile ID matching the mobile ID, a permanent ID, and a cipher key, retrieve the user database record using the permanent ID, update, in the user database record, a previous mobile ID and a previous cipher key with the mobile ID and the cipher key, respectively and retrieve the updated user database record using the mobile ID.</p><p id="p-0016" num="0015">In some aspects, the medium includes instructions that, when executed by a processor, further cause the processor to capture a first message transmitted over one of an N1 interface and an N2 interface, extract, from the first message, a first 5G mobile ID, capture a second message transmitted over an N26 interface, extract, from the second message, a 4G mobile ID, a permanent ID, and a cipher key, convert the 4G mobile ID to a second 5G mobile ID matching the first 5G mobile ID, retrieve the user database record using the permanent ID, update, in the user database record, the 4G mobile ID and a previous cipher key with the second 5G mobile ID and the cipher key, respectively, and retrieve the updated user database record using the first 5G mobile ID.</p><p id="p-0017" num="0016">In some aspects, the session details include two or more of location information, a handset type, local network information, service quality information, or other user statistics.</p><p id="p-0018" num="0017">Another illustrative embodiment disclosed herein is an apparatus. In some aspects, the apparatus includes a processor and a memory. In some embodiments, the memory includes programmed instructions that, when executed by the processor, cause the apparatus to identify a user database record associated with a user equipment (UE) using a mobile identity (ID), associate a Next Generation application protocol (NGAP) session with the user database record using an NGAP ID, capture a ciphered message associated with the NGAP session, decipher the ciphered message associated with the NGAP session, extract, from the deciphered message, session details associated with the UE, and store the session details in a session detail record.</p><p id="p-0019" num="0018">In some aspects, the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to identify the user database record by: capturing a first message transmitted over one of an N1 interface and an N2 interface, extracting the mobile ID from the first message, and identifying the user database record using the mobile ID.</p><p id="p-0020" num="0019">In some aspects, the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to associate the NGAP session with the user database record by: capturing a first message transmitted over one of an N1 interface or an N2 interface, extracting, from the first message, one of the NGAP ID, an expected response (XRES), or an authentication token (AUTN), and associating the NGAP session with the user database record using the one of the NGAP ID, the XRES, or the AUTN.</p><p id="p-0021" num="0020">An illustrative embodiment disclosed herein is a method. In some aspects, the method includes identifying a user database record associated with a user equipment (UE) using a mobile identity (ID), associating a Next Generation application protocol (NGAP) session with the user database record using an NGAP ID, capturing a ciphered message associated with the NGAP session, deciphering the ciphered message associated with the NGAP session, extracting, from the deciphered message, session details associated with the UE, and storing the session details in a session detail record.</p><p id="p-0022" num="0021">In some aspects, identifying the user database record further comprises capturing a first message transmitted over one of an N1 interface and an N2 interface, extracting the mobile ID from the first message, and identifying the user database record using the mobile ID.</p><p id="p-0023" num="0022">In some aspects, associating the NGAP session with the user database record further comprises capturing a first message transmitted over one of an N1 interface or an N2 interface, extracting, from the first message, one of the NGAP ID, an expected response (XRES), or an authentication token (AUTN), and associating the NGAP session with the user database record using the one of the NGAP ID, the XRES, or the AUTN.</p><p id="p-0024" num="0023">Further details of aspects, objects, and advantages of the disclosure are described below in the detailed description, drawings, and claims. Both the foregoing general description and the following detailed description are exemplary and explanatory and are not intended to be limiting as to the scope of the disclosure. Particular embodiments may include all, some, or none of the components, elements, features, functions, operations, or steps of the embodiments disclosed above. The subject matter which can be claimed comprises not only the combinations of features as set out in the attached claims but also any other combination of features in the claims, wherein each feature mentioned in the claims can be combined with any other feature or combination of other features in the claims. Furthermore, any of the embodiments and features described or depicted herein can be claimed in a separate claim and/or in any combination with any embodiment or feature described or depicted herein or with any of the features of the attached claims.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a block diagram of an environment for monitoring a 5G network, in accordance with some embodiments.</p><p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> is a block diagram of the network monitoring device, in accordance with some embodiments.</p><p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. <b>2</b>B</figref> is a block diagram of the correlation data structure, in accordance with some embodiments.</p><p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a flow chart of an example method for associating a user database record to a Next Generation Application Protocol (NGAP) session, in accordance with some embodiments.</p><p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a flow chart of an example method for tracking a mobile ID change, in accordance with some embodiments.</p><p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a flow chart of an example method for tracking a user during an Xn handover, in accordance with some embodiments.</p><p id="p-0031" num="0030"><figref idref="DRAWINGS">FIGS. <b>6</b>A-<b>6</b>B</figref> are a flow chart of an example method for tracking a user during an N2 handover without an AMF change, in accordance with some embodiments.</p><p id="p-0032" num="0031"><figref idref="DRAWINGS">FIGS. <b>7</b>A-<b>7</b>B</figref> are a flow chart of an example method for tracking a user during an N2 handover with an AMF change, in accordance with some embodiments.</p><p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a flow chart of an example method for tracking a user during an idle N2 handover, in accordance with some embodiments.</p><p id="p-0034" num="0033"><figref idref="DRAWINGS">FIGS. <b>9</b>A-<b>9</b>B</figref> are a flow chart of an example method for tracking a user during a 4G-5G handover, in accordance with some embodiments.</p><p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a flow chart of an example method for using a security parameter transmitted over the N12 interface to associate a user database record to an NGAP session, in accordance with some embodiments.</p><p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. <b>11</b></figref> is a flow chart of an example method for storing user equipment session details, in accordance with some embodiments.</p><p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. <b>12</b></figref> is a flow chart of an example method for monitoring the 5G network, in accordance with some embodiments.</p><p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. <b>13</b></figref> is a flow chart of an example method for monitoring the 5G network, in accordance with some embodiments.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><p id="p-0039" num="0038">The foregoing and other features of the present disclosure will become apparent from the following description and appended claims, taken in conjunction with the accompanying drawings. Understanding that these drawings depict only several embodiments in accordance with the disclosure and are, therefore, not to be considered limiting of its scope, the disclosure will be described with additional specificity and detail through use of the accompanying drawings.</p><heading id="h-0005" level="1">DETAILED DESCRIPTION</heading><p id="p-0040" num="0039">In the following detailed description, reference is made to the accompanying drawings, which form a part hereof. In the drawings, similar symbols typically identify similar components, unless context dictates otherwise. The illustrative embodiments described in the detailed description, drawings, and claims are not meant to be limiting. Other embodiments may be utilized, and other changes may be made, without departing from the spirit or scope of the subject matter presented here. It will be readily understood that the aspects of the present disclosure, as generally described herein, and illustrated in the figures, can be arranged, substituted, combined, and designed in a wide variety of different configurations, all of which are explicitly contemplated and make part of this disclosure.</p><p id="p-0041" num="0040">Monitoring an N1/N2 interface may include obtaining cipher keys for deciphering the user's messages as well as establishing mappings between user identities and a session in which the user transmits messages. There are various technical challenges to obtaining the mappings and obtaining the cipher keys when monitoring the N1 interface (a 5G interface between the user and a core network, which is also known as the non-access stratum (NAS)) and the N2 interface (a 5G interface between a radio access network and the core network). In some embodiments, the temporary and concealed user identities are used across the N1/N2 interface (e.g., when going from idle state to active state), and the permanent identity is to be resolved when using other interfaces in the network. In addition, when users move to a different cell site, there are different types of handovers that are to be handled to track the user. Moreover, cipher keys are passed through other interfaces (e.g., N12, N14, and N26).</p><p id="p-0042" num="0041">Disclosed herein is a system, apparatus, and method that can address the technical challenges by monitoring multiple interfaces and mapping various identities and keys to enable users to be tracked and NAS messages to be deciphered, even during handovers. For instance, in some embodiments, the disclosed system, apparatus, and method store parameters of a Next Generation application protocol (NGAP) session in an NGAP record and associate the NGAP record with a user database record that tracks the various IDs of the user and the security context. In some embodiments, when a handover results in a second NGAP session, the disclosed system, apparatus, and method store parameters of the second NGAP session in a second NGAP record that is associated with the user database record. In some embodiments, the disclosed system, apparatus, and method capture messages associated with the NGAP session. In some embodiments, the disclosed system, apparatus, and method decipher any of the captured messages that are ciphered using one or more cipher keys retrieved from the user database record. In some embodiments, the disclosed system, apparatus, and method store user equipment session details associated with the user, such as a handset type and location information, in a session detail record that is mapped to the user database record.</p><p id="p-0043" num="0042">In some embodiments, the disclosure herein provides a comprehensive solution to decrypt the NAS layer in the protocol stack of the Next Generation mobile technology (5G). In some embodiments, the disclosure herein provides a centralized database for tracking any of the identities and cipher keys in real-time (or substantially real-time). In some embodiments, by decrypting the NAS layer in real-time, and by providing a centralized database in read-access memory (RAM), the disclosure herein effectively monitors N1/N2 interface in real-time.</p><p id="p-0044" num="0043">Referring now to <figref idref="DRAWINGS">FIG. <b>1</b></figref>, a block diagram of an environment <b>100</b> for monitoring a 5G network is depicted, in accordance with some embodiments. The environment <b>100</b> includes a network monitoring device (e.g., a probe) <b>102</b> coupled to a 5G (New Radio) network <b>104</b>. The network monitoring device <b>102</b> captures traffic (e.g., messages, packets) transmitted on various interfaces of the 5G network <b>104</b>, deciphers traffic, extracts user data from the traffic, self-correlates user data, and correlates user data to subsequent traffic transmitted by the user over various interfaces.</p><p id="p-0045" num="0044">The 5G network <b>104</b> includes user equipment (UE) <b>106</b> such as a mobile device, a phone, a smart phone, an Internet of Things (IoT) device, a vehicular communications device, a computer, a laptop, a tablet, a smart watch, or any 3GPP device associated with a user. The 5G network <b>104</b> includes a radio access network (RAN) <b>108</b> that is in communication with the UE <b>106</b> via a Uu (air, wireless, etc.) interface <b>110</b>. The RAN <b>108</b> covers a geographical area which is divided into cell areas, with each cell area being served by a base station (e.g., a cell tower, a Next Generation nodeB (gNB), etc.).</p><p id="p-0046" num="0045">The 5G network <b>104</b> includes a core network (CN, e.g., a 5G core network) <b>112</b>, which provides access to one or more DNs such as the DN <b>114</b>. The CN <b>112</b> includes a service-based architecture (SBA) in which messaging/signaling between network functions (NFs) are exposed via (e.g., happen on top of) hypertext transfer protocol (HTTP)/2 (e.g., HTTP or HTTP2) representational state transfer (REST)-ful application program interface (API). Each of the components of the CN <b>112</b>, and other components of the 5G network <b>104</b>, can produce and/or consume NF services over the HTTP/2 transport. In some embodiments, container orchestrators (e.g., Docker Containers, Kubernetes) and microservices are employed in implementing the NFs. The CN <b>112</b> includes a user plane function (UPF) <b>126</b> that forwards messages from the RAN <b>108</b> to one or more data networks (DN) such as the DN <b>114</b> (e.g., the Internet, a Local Area Data Network, an Internet Protocol Multimedia Subsystem (IMS) network, etc.).</p><p id="p-0047" num="0046">The CN <b>112</b> includes the access and mobility management function (AMF) <b>114</b>, which manages access and of the UE <b>106</b>. The AMF <b>116</b> is responsible for coordinating authentication and registering users to the network. The AMF <b>116</b> also manages mobility of the UE <b>106</b> when the UE <b>106</b> roams from one gNB to another for session continuity. The AMF <b>116</b> is in communication with the UE <b>106</b> via an N1 interface <b>118</b>. The AMF <b>116</b> is in communication with the RAN <b>108</b> via an N2 interface <b>120</b>. <figref idref="DRAWINGS">FIG. <b>1</b></figref> shows the interfaces as logical interfaces. In particular, the N1 interface <b>106</b> is part of the non-access stratum (NAS) which is a highest functional layer in a protocol stack between the CN <b>112</b> and the UE <b>106</b>. In some embodiments, a message sent over the N1 interface are referred to as a NAS protocol data unit (PDU). Although most of the logical interfaces are same as their physical counterparts, messages transmitted over the N1 interface are physically transmitted via the RAN <b>108</b>. In some embodiments, at least one of the UE <b>106</b>, the RAN <b>108</b>, or the AMF <b>116</b> encapsulates (e.g., appends, adds) the N1 messages with additional information elements (IEs).</p><p id="p-0048" num="0047">The CN <b>112</b> includes the authentication server function (AUSF) <b>122</b> in communication with the AMF <b>116</b> over an N12 interface <b>124</b>. The AUSF <b>122</b> is a part of the authentication procedure for authenticating the UE <b>106</b>. The AUSF <b>122</b> sends a challenge message to the UE <b>106</b>. The AUSF <b>122</b> verifies the authentication, for example, by comparing a response of the challenge message by the UE <b>106</b> to an expected response.</p><p id="p-0049" num="0048">The UE <b>106</b> registers and authenticates after the UE <b>106</b> transitions from an idle state. First, the UE <b>106</b> sends a registration (e.g., initial NAS, initial UE, registration request, initial setup) message to the AMF <b>116</b>. The registration message can include IEs including IEs needed to establish security in the initial message when the UE <b>106</b> has no NAS security context. The registration message is not ciphered.</p><p id="p-0050" num="0049">The registration message can include IEs for identifying the UE <b>106</b> or a user associated with the UE <b>106</b>. The registration message can include one or more user identities (IDs, e.g., identifiers). In some embodiments, the one or more user IDs can include at least one of one or more mobile IDs or one or more permanent IDs. In some embodiments, the one or more mobile IDs include one or more temporary IDs. In some embodiments, the one or more temporary IDs includes one or more of a temporary mobile subscriber identity (TMSI), a shorten(S)-TMSI, a 5G-S-TMSI, a globally unique temporary ID (GUTI), or a 5G-GUTI. In some embodiments, the one or more mobile IDs include one or more concealed identities such as a subscription concealed ID (SUCI). In some embodiments, the SUCI includes a concealed permanent ID (e.g., SUPI), while in other embodiments such as in a null-scheme, the SUCI includes a non-concealed (revealed) permanent ID. Other messages transmitted over the N1 interface or the N2 interface (e.g., de-registration request, service request, identity response, etc.) may include one or more mobile IDs. In some embodiments, the one or more permanent IDs includes a subscription permanent identity (SUPI), an international mobile subscriber identity (IMSI), an international mobile equipment identity (IMEI), an IMEI software version (IMEISV), or a network access identity (NAI). In some embodiments, the SUPI includes one or more of the IMSI, the IMEI, the IMEISV, or the NAI.</p><p id="p-0051" num="0050">In some embodiments, the RAN <b>108</b> allocates a RAN UE a Next Generation Application Protocol (NGAP) ID to be used for (e.g., associated with) an NGAP session between the UE <b>106</b> and the AMF <b>116</b>. In some embodiments, the RAN <b>108</b> encapsulates the registration message (e.g., the NAS PDU) with the RAN UE NGAP ID and forwards the encapsulated message to the AMF <b>116</b>. In some embodiments, the AMF <b>116</b> allocates an AMF UE NGAP ID to be used for the NGAP session. In some embodiments, in the registration message or a subsequent N1 message (e.g., a downlink NAS transport) from the AMF <b>116</b> to the UE <b>106</b>, the AMF <b>116</b> includes the AMF UE NGAP ID. In some embodiments, an NGAP ID refers to the RAN UE NGAP ID, the AMF UE NGAP ID, a pair of the RAN UE NGAP ID and the AMF UE NGAP ID, or one or more of the RAN UE NGAP ID or the AMF UE NGAP ID along with one or more of the gNB internet protocol (IP) or the AMF IP.</p><p id="p-0052" num="0051">In some embodiments, the CN <b>112</b> includes multiple AMFs. For instance, as shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the CN <b>112</b> includes another AMF <b>128</b>. The user can be re-allocated from the AMF <b>116</b> to the other AMF <b>128</b> or vice-versa. The AMF <b>116</b> can send information for identifying the user (e.g., a mobile ID or a permanent ID), information identifying the user's session (e.g., an NGAP ID) or information for deciphering the user's messages (e.g., cipher keys) to, or receive such information from, the other AMF <b>128</b>. The AMF <b>116</b> is in communication with the other AMF <b>128</b> via an N14 interface <b>130</b>.</p><p id="p-0053" num="0052">In some embodiments, the 5G network <b>104</b> is coupled to a 4G network. For instance, as shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the AMF <b>116</b> is coupled to a mobility management entity (MME) <b>132</b> that is part of a 4G network. Other than being the 4G counterpart, the MME <b>132</b> is similar to the AMF <b>116</b> except that it performs both of the session management and the authentication. The user can be re-allocated from the AMF <b>116</b> to the MME <b>132</b> or vice-versa. The AMF <b>116</b> can send information for identifying the user, information identifying the user's session, or information for deciphering the user's messages to, or receive such information from, the MME <b>132</b>. The AMF <b>116</b> is in communication with the MME <b>132</b> via an N26 interface <b>134</b>.</p><p id="p-0054" num="0053">In some embodiments, a handover can occur. One type of handover is an Xn handover, which a handover over the Xn interface between different gNBs. In some embodiments, the UE <b>106</b> retains a same AMF <b>116</b> during the Xn handover. In some embodiments, during the Xn handover, an NGAP ID associated with the UE <b>106</b>, or a portion therein, is updated or stored in a second NGAP record that tracks a new NGAP session due to the Xn handover. For example, a path switch request message includes the information elements (IEs) RAN UE NGAP ID and AMF UE NGAP ID and a path switch request acknowledge includes the IEs RAN UE NGAP ID and AMF UE NGAP ID. In some embodiments, the RAN UE NGAP in the path switch request acknowledge is different from the RAN UE NGAP in the path switch request and the AMF UE NGAP ID in the path switch request acknowledge is same as the AMF UE NGAP ID in the path switch request. In some embodiments, the opposite is true. In some embodiments, IDs and cipher keys of the UE <b>106</b> are stored in the second NGAP record.</p><p id="p-0055" num="0054">Another type of handover is an N2 handover, which is a handover from one gNB to another gNB over the N2 interface. In some embodiments, the UE <b>106</b> retains a same AMF <b>116</b> during the N2 handover, while in other embodiments, the UE <b>106</b> changes from the AMF <b>116</b> to the other AMF <b>128</b> (or vice versa). In some embodiments, during an N2 handover (or during timer-based events), an NGAP ID associated with the UE <b>106</b> is updated or stored in a second NGAP record.</p><p id="p-0056" num="0055">In some embodiments, during an N2 handover, a container ID is used to track NGAP IDs as a result of the N2 handover. For example, a first message (e.g., a handover required message) includes the container ID and a first NGAP ID of an NGAP session before the N2 handover, and a second message (e.g., a handover request message) in response to the first message includes the container ID and a second NGAP ID of an NGAP session after the N2 handover. Another type of handover is a 4G-5G handover. In some embodiments, during a 4G-5G handover, a 5G GUTI is transmitted along with a permanent ID on the N26 interface, wherein the 5G GUTI updates the previous 4G GUTI.</p><p id="p-0057" num="0056">In some embodiments, if the AMF <b>116</b> is not able to find the security context locally or from a last visited AMF (e.g., an AMF from another CN), or if the integrity check fails, then the AMF <b>116</b> initiates an authentication procedure with the UE <b>106</b>. During the authentication procedure, in some embodiments, the AUSF <b>122</b> sends authentication vectors (AVs) to the AMF <b>116</b>. The AVs may include an authentication token (AUTN), an expected response (XRES), and one or more cipher keys (e.g., CK, K<sub>amf</sub>, K<sub>seaf</sub>, K<sub>ausf</sub>) for deciphering ciphered messages. In some embodiments, the AUSF <b>122</b> sends permanent IDs such as a SUPI or an IMSI to the AMF <b>116</b>. The AUSF <b>122</b> sends a challenge message to the UE <b>106</b> via the AMF <b>116</b>. The UE <b>106</b> generates a response (RES) to the challenge message using a key derivation function (KDF) possessed by the UE <b>106</b>. The UE <b>106</b> sends the RES to the AUSF <b>122</b> via the AMF <b>116</b>. The AUSF <b>122</b> authenticates the UE <b>106</b> by comparing the RES to the XRES to determine if the RES and the XRES match. In some embodiments, the messages sent during the authentication procedure between the UE <b>106</b> and the AMF <b>116</b> (herein, the authentication messages or the N1 authentication messages) are not ciphered, while in other embodiments, the N1 authentication messages are ciphered. The N12 authentication messages are not ciphered.</p><p id="p-0058" num="0057">In some embodiments, if the authentication is successful (e.g., XRES and the RES match), the AMF <b>116</b> sends the NAS Security Mode Command message, which is not ciphered, to the UE <b>106</b>. In some embodiments, the UE <b>106</b> sends the NAS Security Mode Complete message to the AMF <b>116</b> in response to the NAS Security Mode Command message. The NAS Security Mode Complete is ciphered and integrity protected.</p><p id="p-0059" num="0058">The network monitoring device <b>102</b> is connected to the 5G network <b>104</b> using various links. For example, the network monitoring device <b>102</b> is coupled to the N1 interface <b>118</b> via link <b>136</b>, the N2 interface <b>120</b> via link <b>138</b>, the N12 interface <b>124</b> via link <b>140</b>, the N14 interface <b>130</b> via link <b>142</b>, and the N26 interface <b>134</b> via link <b>144</b>. In some embodiments, the network monitoring device <b>102</b> is coupled to other interfaces (e.g., the Uu interface <b>110</b>) via other links. Each of the links can be passive or active and include software, firmware, and/or hardware components, such as taps, probes, or port mirrors that can be positioned in-line along communication links between various components of the 5G network <b>104</b>. In the case of a physical site, each link can receive a copy of packets flowing over the respective interface from a tap in-line with an edge router located at the physical site, or from a switch port analyzer (&#x201c;SPAN&#x201d;) port on the edge router.</p><p id="p-0060" num="0059">Referring now to <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>, a block diagram of the network monitoring device <b>102</b> is depicted, in accordance with some embodiments. The network monitoring device <b>102</b> includes a processor <b>202</b>, a first storage medium <b>204</b>, a second storage medium <b>206</b>, and a network interface <b>208</b>. The network monitoring device <b>102</b> may include other components such as input devices (e.g., keyboard, mouse) and output devices (e.g., display, monitor).</p><p id="p-0061" num="0060">The processor <b>202</b> executes computer instructions stored in one or more of the first storage medium <b>204</b> or the second storage medium <b>206</b>. Although only a single processor is shown in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>, any number of processors is within the scope of the present disclosure. The processor <b>202</b> includes a cache <b>214</b>. In some embodiments, user data extracted from captured traffic data can be stored in the cache <b>214</b>.</p><p id="p-0062" num="0061">The processor <b>202</b> includes one or more threads. For example, as shown in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>, the processor includes a collector thread <b>210</b> and a recorder thread <b>212</b>. In some embodiments, the collector thread <b>210</b> performs at least one of collecting user/session details/data/metadata (e.g., location information, a handset type, local network information, or service quality information) extracted from messages (e.g., N1 or N2 messages) transmitted over various (e.g., N1 or N2) interfaces, storing the session details in the cache <b>214</b> or the first storage medium <b>204</b>, or aggregating statistics on the session details. In some embodiments, the recorder thread <b>212</b> stores, or copies, one or more of the messages or the session details to the second storage medium <b>206</b>. Advantageously, by processing various messages in parallel in separate (e.g., dedicated) threads, the monitoring device <b>102</b> can achieve lower latency and live-time, or substantially live-time, monitoring of the 5G network <b>104</b>. Although the processor <b>202</b> is shown as having one core and two threads, the processor <b>202</b> can have any number of cores and threads and remain within the scope of the present disclosure.</p><p id="p-0063" num="0062">The first storage medium <b>204</b> stores instructions (e.g., computer instructions, programmed instructions) for one or more of processing, extracting, correlating, generating, storing, or retrieving traffic data (e.g., messages, packets, headers, payloads, fields, information elements, parameters, keys, credentials, etc.) or metadata derived from the traffic data. The first storage medium <b>204</b> is implemented in one of various devices (e.g., Random-Access Memory (RAM), static RAM (SRAM), dynamic RAM (DRAM), Resistive RAM (ReRAM), magnetoresistive RAM (MRAM)) that has a faster read or write speed than the second storage medium <b>206</b>.</p><p id="p-0064" num="0063">In some embodiments, the first storage medium <b>204</b> includes instructions for data capture <b>216</b>, N1 correlation <b>218</b>, N2 correlation <b>220</b>, N12 correlation <b>222</b>, N14 correlation <b>224</b>, N26 correlation <b>226</b>, and N1 decryption <b>228</b>. In some embodiments, one or more of the instructions <b>216</b>-<b>228</b> can be combined. In some embodiments, the data capture <b>216</b> instructions include instructions to capture messages (e.g., control packets or data packets). In some embodiments, the data capture <b>216</b> instructions include instructions to extract user correlation/monitoring-related data (e.g., mobile IDs, permanent IDs, NGAP IDs, container IDs, security context (e.g., one or more cipher keys, a key set identifier, an uplink and downlink NAS count, etc.), time stamps, any parameters or state information related to mapping/correlating/linking users or NGAP sessions) from the captured messages. For example, the data capture <b>216</b> instructions include instructions to extract one or more of a permanent ID or security parameters such as XRES, AUTN, or security context from authentication messages transmitted over the N12 interface. In another example, the data capture <b>216</b> instructions include instructions to extract one or more of the session details associated with the user (e.g., handset type, etc.) from messages transmitted over one or more of the N1 interface or the N2 interface. The captured messages can also be captured on the N14 or N26 interface. The data capture <b>216</b> instructions can include instructions for software agents or virtual devices that remotely operate on, or control, each of the links (e.g., links <b>136</b>, <b>138</b>, <b>140</b>, <b>142</b>, and <b>144</b>) and/or any associated hardware.</p><p id="p-0065" num="0064">In some embodiments, the N1 correlation <b>218</b> instructions include instructions to correlate/map/link any user data extracted from messages captured over the N1 interface <b>118</b>. For example, the N1 correlation <b>218</b> instructions include instructions to correlate a mobile ID to an NGAP ID. In some embodiments, correlating includes storing the first parameter in a first field of a record associated with a user (e.g., an NGAP record or a user database record) and storing the second parameter in a second field of the record associated with the user. This may be referred to as generating a mapping from the first parameter to the second parameter. For example, The N1 correlation <b>218</b> instructions include instructions to store (e.g., populate) the NGAP ID extracted from an N1 message in a first field of an NGAP record and to store a mobile ID extracted from an N1 message in a second field of an NGAP record. In some embodiments, each mapping may be a key-value pair in which the first parameter (e.g., the NGAP ID) is a key and the second parameter (e.g., the mobile ID) is the value. In some embodiments, the first parameter is an input to a hash function which generates or fetches (e.g., retrieves, accesses) the second parameter or a location/address of the second parameter.</p><p id="p-0066" num="0065">The N1 correlation <b>218</b> instructions include instructions to store the mobile ID in a first field of a user database record and security context in a second field of a user database record. The N1 correlation <b>218</b> N1 correlation <b>218</b> instructions include instructions to use the NGAP ID extracted from an N1 message to retrieve the NGAP record that includes the matching NGAP ID and to retrieve the corresponding mobile ID. The N1 correlation <b>218</b> instructions include instructions to use the mobile ID extracted from an N1 message or retrieved from an NGAP record to retrieve a user database record that includes the matching mobile ID and to retrieve the corresponding permanent ID and/or security context. In some embodiments, the N1 correlation <b>218</b> instructions include instructions to update, or store in a new record, one or more of an NGAP ID, a mobile ID, permanent ID, or security context extracted from an N1 message (e.g., during an Xn handover, an N2 handover, a 4G-5G handover, or during a non-handover (e.g., upon expiration of a GUTI-related timer)).</p><p id="p-0067" num="0066">In some embodiments, the N1 correlation <b>218</b> instructions include instructions to store session details such as handset type in a session detail data structure, which may be stored in a storage medium separate from the storage medium where the correlation data structure <b>230</b> is stored. In some embodiments, a session detail record in the separate session detail data structure can be linked to a respective user database record in the correlation data structure <b>230</b>, for example, with an IMEI.</p><p id="p-0068" num="0067">In some embodiments, the N2 correlation <b>220</b> instructions are similar to the N1 instructions except that the instructions relate to any user data extracted from messages captured over the N2 interface <b>120</b>.</p><p id="p-0069" num="0068">In some embodiments, the N12 correlation <b>222</b> instructions include instructions to correlate XRES extracted from messages captured over the N12 interface <b>124</b>. In some embodiments, the N12 correlation <b>222</b> instructions include instructions to store an XRES in a first field of an XRES record and store a permanent ID in a second field of the XRES record. Similarly, in some embodiments, the N12 correlation <b>222</b> instructions include instructions to store a permanent ID in a first field of a user database record and store security context in a second field of the user database record.</p><p id="p-0070" num="0069">In some embodiments, the N14 correlation <b>224</b> instructions are similar to the N12 instructions except that the instructions relate to any user data extracted from messages captured over the N14 interface <b>130</b>. In some embodiments, the N26 correlation <b>226</b> instructions are similar to the N12 instructions except that the instructions relate to any user data extracted from messages captured over the N26 interface <b>134</b>.</p><p id="p-0071" num="0070">In some embodiments, the N1 decryption <b>228</b> instructions include instructions to decipher a ciphered N1 message (e.g., a ciphered N1 authentication message, a ciphered N1 security mode complete message, a subsequent N1 ciphered message) using a cipher key. In some embodiments, the N1 decryption <b>228</b> instructions include instructions to determine whether traffic data is ciphered. For example, security state information may be extracted from a message or a separate message that may indicate whether the message is ciphered. The N1 decryption <b>228</b> instructions may include instructions to decipher a message if the extracted security state information indicates that the message is ciphered.</p><p id="p-0072" num="0071">The first storage medium <b>204</b> includes the correlation data structure <b>230</b>, which stores the mappings in one or more data structures (e.g., databases, tables, files). For example, a first table stores NGAP records (e.g., mapping of NGAP ID-mobile ID pairs), a second table stores container records (e.g., mapping of container ID-mobile ID pairs), a third table stores XRES records (e.g., a mapping of XRES-permanent ID pairs), and a fourth table stores user database records (e.g., a mapping of temporary ID-permanent ID-security context tuples). More, less, or other mapping tables are within the scope of the present disclosure. Each table can include a number of records (e.g., rows, user database records). Each record may be associated with one UE (e.g., a first record is associated with the UE <b>106</b>). In some embodiments, each record has a first field (e.g., entry) populated by the first parameter (e.g., an IE) of the mapping, or a hash thereof, and each of the one or more second fields populated by the second parameter/IE (e.g., one of the second parameters, if there is more than one) of the mapping, or a hash thereof. In some embodiments, the table is a hash table (e.g., a key-value table) in which the record containing the one or more second fields (e.g., the values, values in a bucket, etc.) is determined, fetched, or located based on transforming the first parameter by a hashing function (e.g., modulus of a predetermined number). In some embodiments, each record in a table has three or more fields.</p><p id="p-0073" num="0072">The second storage medium <b>206</b> stores data or metadata that is the result of processing or correlating the traffic data. The second storage medium <b>206</b> is implemented in one of various devices (e.g., solid-state drive, hard disk drive, optical drive, etc.) that can store a greater amount of data than the first storage medium <b>204</b>. In some embodiments, the second storage medium <b>206</b> is distributed across multiple such devices. In some embodiments, the second storage medium <b>206</b> stores the instructions for the data capture <b>216</b>, the N12 correlation <b>222</b>, the N1 correlation <b>218</b>, and the N1 decryption <b>228</b>, or instances thereof. In some embodiments, the processor <b>202</b> can execute each of the instructions <b>216</b>, <b>218</b>, <b>220</b>, and <b>222</b> from the second storage medium <b>206</b>. In some embodiments, the second storage medium <b>206</b> stores copies of the correlation data structures <b>230</b>. In some embodiments, the second storage medium <b>206</b> includes the session detail data structure <b>232</b>. The session detail data structure <b>232</b> includes session details (e.g., location information, a handset type, local network information, or service quality information) extracted from the captured messages. In some embodiments, session details for each user are in a respective session detail record. In some embodiments, a user's session detail record persists even after the user has changed NGAP sessions (e.g., NGAP IDs). In some embodiments, the second storage medium <b>206</b> stores the captured messages, monitoring-related user parameters (e.g., a mobile ID, an NGAP ID) extracted from the captured messages, etc.</p><p id="p-0074" num="0073"><figref idref="DRAWINGS">FIG. <b>2</b>B</figref> illustrates records of one user that are in the correlation data structure <b>230</b> and the session detail data structure <b>232</b>, in accordance with some embodiments of the present disclosure. In some embodiments, the correlation data structure <b>230</b> includes an NGAP record <b>250</b>, a container record <b>255</b>, an XRES record <b>260</b>, a user database record <b>265</b>. In some embodiments, the NGAP record <b>250</b> includes an NGAP field <b>252</b> and the mobile ID field <b>254</b>, the container record <b>255</b> includes a container field <b>256</b> and a permanent ID field <b>258</b>, the XRES record <b>260</b> includes an XRES field <b>262</b> and a permanent ID field <b>258</b>, and the user database record <b>265</b> includes the mobile ID field <b>254</b>, the permanent ID field <b>258</b>, and a security context field <b>266</b>. In some embodiments, the session detail data structure <b>232</b> includes a session detail record <b>270</b>. In some embodiments, the session detail record <b>270</b> includes a permanent ID field <b>258</b> and a session details field <b>272</b>. In some embodiments, the session details field <b>272</b> includes multiple fields (e.g., at least one for handset type, at least one for local network information, at least one for location information, at least one for service quality information, etc.).</p><p id="p-0075" num="0074">Returning to <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>, the network interface <b>208</b> may include a NIC (network interface card) or other standard network interfaces to receive captured network traffic and communicate with other network interface devices. For example, the network interfaces <b>208</b> may include an N1 interface (e.g., the link <b>136</b>), an N2 interface (e.g., the link <b>138</b>), an N12 interface (e.g., the link <b>140</b>), an N14 interface (e.g., the link <b>142</b>), an N26 interface (e.g., the link <b>144</b>), an 802.11 interface, an Ethernet interface, or other wired or wireless network interfaces.</p><p id="p-0076" num="0075">Referring now to <figref idref="DRAWINGS">FIG. <b>3</b></figref>, a flow chart of an example method <b>300</b> for associating a user database record to a Next Generation application protocol (NGAP) session is depicted, in accordance with some embodiments. The method <b>300</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>300</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>300</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>300</b> may be performed in parallel.</p><p id="p-0077" num="0076">The processor <b>202</b> captures an initial setup message transmitted over one of an N1 interface or an N2 interface (at operation <b>302</b>). In some embodiments, the initial setup message is transmitted from the RAN <b>108</b> to the AMF <b>116</b>. In some embodiments, the initial setup message includes (a) an NGAP ID associated with an NGAP session of the UE <b>106</b> and (b) a NAS PDU. In some embodiments, the NAS PDU is transmitted from the UE to the AMF <b>116</b> via the RAN <b>108</b>, includes a mobile identity (ID) associated with the UE <b>106</b>, and is encapsulated by the NGAP ID at the RAN <b>108</b>. In some embodiments, the NAS PDU is in a payload portion of the initial setup message and the NGAP ID is in a header portion of the initial setup message. In some embodiments, the mobile ID is one of a SUCI, a 5G-GUTI, or a 5G-S-TSMI.</p><p id="p-0078" num="0077">The processor <b>202</b> extracts, from the initial setup message, the mobile ID and the NGAP ID (at operation <b>304</b>). The processor <b>202</b> stores (e.g., populates) the NGAP ID in a first field of an NGAP record (e.g., the NGAP record <b>250</b>) (at operation <b>306</b>). In some embodiments, the NGAP record is stored in the correlation data structure <b>230</b>. In some embodiments, the correlation data structure resides in the first storage medium <b>204</b>. The processor <b>202</b> stores the mobile ID in a second field of an NGAP record (at operation <b>308</b>). The processor <b>202</b> retrieves a user database record (e.g., the user database record <b>265</b>) using the NGAP record (at operation <b>310</b>). In some embodiments, the user record includes a mobile ID matching the mobile ID stored in the NGAP record. In some embodiments, the user database record is retrieved from one or more of a correlation data structure <b>230</b> or a first storage medium <b>204</b>. In some embodiments, operations <b>302</b>-<b>310</b> maps, or otherwise associates, the user database record to the NGAP session.</p><p id="p-0079" num="0078">Referring now to <figref idref="DRAWINGS">FIG. <b>4</b></figref>, a flow chart of an example method <b>400</b> for tracking a mobile ID change, for example, when the AMF <b>116</b> reallocates a GUTI, is depicted, in accordance with some embodiments. The method <b>400</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>400</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>400</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>400</b> may be performed in parallel. Operations of the method <b>400</b> can be combined with or interchanged with operations of the method <b>300</b>.</p><p id="p-0080" num="0079">In some embodiments, the processor <b>202</b> captures a message transmitted over one of the N1 interface or the N2 interface (at operation <b>402</b>). In some embodiments, the processor <b>202</b> extracts, from the message, an NGAP ID and a mobile ID (at operation <b>404</b>). In some embodiments, the mobile ID is a SUCI, a 5G-GUTI, or a 5G-S-TSMI. In some embodiments, the mobile ID is a new mobile ID allocated by the AMF, e.g., based on a timer elapsing.</p><p id="p-0081" num="0080">In some embodiments, the processor <b>202</b> determines whether an NGAP record (e.g., the NGAP record <b>250</b>) includes the NGAP ID (at operation <b>406</b>). In response to determining that the NGAP record includes the NGAP ID, in some embodiments, the processor <b>202</b> determines whether the mobile ID matches a second mobile ID in the NGAP record (at operation <b>408</b>). In response to determining that the mobile ID does not match the second mobile ID in the NGAP record, the processor <b>202</b> updates the second mobile ID with the mobile ID (at operation <b>410</b>). In some embodiments, the processor <b>202</b> updates (e.g., overwrites) the second mobile ID with the mobile ID in the NGAP record and in a user database record including the second mobile ID.</p><p id="p-0082" num="0081">In some embodiments, in response to determining that the NGAP record (e.g., any of the NGAP records) does not include the NGAP ID, the processor <b>202</b> stores the NGAP ID and the mobile ID in a new NGAP record and the processor <b>202</b> returns to operation <b>402</b>. In some embodiments, in response to determining that the mobile ID matches a second mobile ID in the NGAP record, or in response to updating the second mobile ID with the mobile ID, the processor <b>202</b> returns to operation <b>402</b>.</p><p id="p-0083" num="0082">Referring now to <figref idref="DRAWINGS">FIG. <b>5</b></figref>, a flow chart of an example method <b>500</b> for tracking a user during an Xn handover in which the AMF <b>116</b> is retained, is depicted, in accordance with some embodiments. The method <b>500</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>500</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>500</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>500</b> may be performed in parallel. Operations of the method <b>500</b> can be combined with or interchanged with operations of one or more of the method <b>300</b> or the method <b>400</b>.</p><p id="p-0084" num="0083">The processor <b>202</b> captures a first message transmitted over one of an N1 interface and an N2 interface (at operation <b>502</b>). In some embodiments, the first message is a path switch request transmitted in response to the UE <b>106</b> moving to another cell (and in communication with another gNB) while retaining the same AMF <b>116</b>. In some embodiments, the path switch request indicates a handover. The processor <b>202</b> extracts, from the first message a first NGAP ID (at operation <b>504</b>). In some embodiments, the first NGAP ID is stored in an NGAP record. In some embodiments, the first message includes a AMF UE NGAP ID and a first RAN UE NGAP ID. In some embodiments, the processor <b>202</b> uses HTTP/2 processing to extract one or more NGAP IDs from the N14 interface. The HTTP/2 processing may include socket processing, fragment processing, stream processing, header inflation processing, synthetic packet creation, and/or Javascript object notation (JSON) processing for user identity and keys.</p><p id="p-0085" num="0084">The processor <b>202</b> captures a second message transmitted over the one of the N1 interface and the N2 interface (at operation <b>506</b>). In some embodiments, the second message is a path switch request acknowledge transmitted in response to the path switch request. The processor <b>202</b> extracts, from the second message, a second NGAP ID (at operation <b>508</b>). In some embodiments, the second message includes the AMF UE NGAP ID and a second RAN UE NGAP ID. In some embodiments, the processor <b>202</b> determines that the second message is in response to the first message because the processor <b>202</b> determines that the AMF UE NGAP ID in the first message matches (e.g., is same as) the AMF UE NGAP ID in the second message. In some embodiments, the processor <b>202</b> matches two IDs (such as the AMF UE NGAP ID in the first message and the AMF UE NGAP ID in the second message) by comparing each alphanumeric character/value (and its position) in the first ID and the second ID and determines that each of the corresponding alphanumeric characters match in the first ID and the second ID.</p><p id="p-0086" num="0085">The processor <b>202</b> stores the second NGAP ID in a second NGAP record (e.g., another record in the same data structure as the NGAP record <b>250</b>) (at operation <b>510</b>). The processor <b>202</b> retrieves, from the NGAP record <b>250</b>, using the first NGAP ID, a mobile ID and a permanent ID (at operation <b>512</b>). In some embodiments, the processor <b>202</b> also retrieves cipher keys from the NGAP record <b>250</b>. In some embodiments, the processor <b>202</b> retrieves the NGAP record <b>250</b> using one of the AMF UE NGAP ID or the first RAN UE NGAP ID. The processor <b>202</b> stores the mobile ID and the permanent ID in the second NGAP record (at operation <b>514</b>). In some embodiments, the processor <b>202</b> stores the cipher keys in the second NGAP record. In some embodiments, after the method <b>500</b> is completed, there are at least two NGAP records associated with the UE <b>106</b> (e.g., one for each NGAP session).</p><p id="p-0087" num="0086">In some embodiments, the processor <b>202</b> stores the mobile ID, the permanent ID, and the cipher keys in a user database record <b>265</b>. In some embodiments, the processor <b>202</b> updates, in the user database record <b>265</b>, a previous mobile ID with the mobile ID. In some embodiments, the processor <b>202</b> updates, in the user database record <b>265</b>, previous cipher keys with the cipher keys.</p><p id="p-0088" num="0087">Referring now to <figref idref="DRAWINGS">FIGS. <b>6</b>A-<b>6</b>B</figref>, a flow chart of an example method <b>600</b> for tracking a user during an N2 handover in which the AMF <b>116</b> is retained, is depicted, in accordance with some embodiments. The method <b>600</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>600</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>600</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>600</b> may be performed in parallel. Operations of the method <b>600</b> can be combined with or interchanged with operations of one or more of the method <b>300</b>, the method <b>400</b>, or the method <b>500</b>.</p><p id="p-0089" num="0088">Referring now to <figref idref="DRAWINGS">FIG. <b>6</b>A</figref>, the processor <b>202</b> captures a first message transmitted over one of an N1 or an N2 interface (at operation <b>602</b>). In some embodiments, the first message is a handover required message transmitted in response to the UE <b>106</b> moving to another cell (and in communication with another gNB) while retaining the AMF <b>116</b>. The processor <b>202</b> extracts, from the first message, a first container ID and a first NGAP ID (at operation <b>604</b>). In some embodiments, the first message includes a source to target transparent container IE which includes the first container ID.</p><p id="p-0090" num="0089">The processor <b>202</b> retrieves an NGAP record <b>250</b> using the first NGAP ID (at operation <b>606</b>). In some embodiments, the processor <b>202</b> retrieves, from the NGAP record <b>250</b>, a mobile ID and a permanent ID (e.g., and a cipher key). The processor <b>202</b> stores the first container ID, the mobile ID, and the permanent ID (e.g., and the cipher key) in a container record <b>255</b> of a container data structure (at operation <b>608</b>).</p><p id="p-0091" num="0090">The processor <b>202</b> captures a second message transmitted over one of an N1 or an N2 interface (at operation <b>610</b>). In some embodiments, the second message is a handover request message transmitted in response to the handover required message. The processor <b>202</b> extracts, from the second message, a second container ID and a second NGAP ID (at operation <b>612</b>). In some embodiments, the second container ID matches the first container ID. In some embodiments, the processor <b>202</b> determines that the second container ID in the second message is the same as the first container ID in the first message. In some embodiments, the second NGAP ID is different from the first NGAP ID.</p><p id="p-0092" num="0091">Referring now to <figref idref="DRAWINGS">FIG. <b>6</b>B</figref>, the processor <b>202</b> stores the second NGAP ID in a second NGAP record (at operation <b>614</b>). The processor <b>202</b> retrieves, from the NGAP record <b>250</b>, using the first NGAP ID, the mobile ID and the permanent ID (e.g., and the cipher key) (at operation <b>616</b>). The processor <b>202</b> stores the mobile ID and the permanent ID (e.g., and the cipher key) in the second NGAP record (at operation <b>618</b>). In some embodiments, after the method <b>600</b> is completed, there are at least two NGAP records associated with the UE <b>106</b> (e.g., one for each NGAP session).</p><p id="p-0093" num="0092">In some embodiments, the processor <b>202</b> stores the mobile ID and the permanent ID (e.g., and the cipher keys) in a user database record <b>265</b>. In some embodiments, the processor <b>202</b> updates, in the user database record <b>265</b>, a previous mobile ID with the mobile ID. In some embodiments, the processor <b>202</b> updates, in the user database record <b>265</b>, previous cipher keys with the cipher keys.</p><p id="p-0094" num="0093">Referring now to <figref idref="DRAWINGS">FIGS. <b>7</b>A-<b>7</b>B</figref>, a flow chart of an example method <b>700</b> for tracking a user during an N2 handover in which the AMF <b>116</b> is changed, is depicted, in accordance with some embodiments. The method <b>700</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>700</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>700</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>700</b> may be performed in parallel. Operations of the method <b>700</b> can be combined with or interchanged with operations of one or more of the methods <b>300</b>-<b>600</b>.</p><p id="p-0095" num="0094">Referring now to <figref idref="DRAWINGS">FIG. <b>7</b>A</figref>, the processor <b>202</b> captures a first message transmitted over an N14 interface (at operation <b>702</b>). The processor <b>202</b> extracts, from the first message a first container ID, a permanent ID, and a cipher key (at operation <b>704</b>). In some embodiments, the first message includes a source to target transparent container IE which includes the first container ID. The processor <b>202</b> stores the permanent ID and the user key in a user database record <b>265</b> (at operation <b>706</b>). The processor <b>202</b> stores the container ID and the permanent ID in the container record <b>255</b> (at operation <b>708</b>).</p><p id="p-0096" num="0095">The processor <b>202</b> captures a second message transmitted over one of an N1 or an N2 interface (at operation <b>710</b>). In some embodiments, the second message is a handover request message. In some embodiments, the second message is transmitted in response to the first message. The processor <b>202</b> extracts, from the second message, a second container ID and an NGAP ID (at operation <b>712</b>). In some embodiments, the first container ID matches the second container ID. In some embodiments, the processor <b>202</b> determines that the second container ID in the second message is the same as the first container ID in the first message.</p><p id="p-0097" num="0096">Referring now to <figref idref="DRAWINGS">FIG. <b>7</b>B</figref>, the processor <b>202</b> stores the NGAP ID in the NGAP record <b>250</b> (at operation <b>714</b>). The processor <b>202</b> retrieves, from the container record <b>255</b>, using the container ID, the permanent ID (at operation <b>716</b>). The processor <b>202</b> retrieves, from the user database record <b>265</b>, using the first permanent ID, the cipher key (at operation <b>718</b>). The processor <b>202</b> stores the permanent ID and the cipher key in the NGAP record <b>250</b> (at operation <b>720</b>). In some embodiments, after the method <b>700</b> is completed, there are at least two NGAP records associated with the UE <b>106</b> (e.g., one for each NGAP session).</p><p id="p-0098" num="0097">Referring now to <figref idref="DRAWINGS">FIG. <b>8</b></figref>, a flow chart of an example method <b>800</b> for tracking a user during an idle N2 handover in which the AMF <b>116</b> is changed, is depicted, in accordance with some embodiments. The method <b>800</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>800</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>800</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>800</b> may be performed in parallel. Operations of the method <b>800</b> can be combined with or interchanged with operations of one or more of the methods <b>300</b>-<b>700</b>.</p><p id="p-0099" num="0098">The processor <b>202</b> captures a first message transmitted over one of an N1 interface or an N2 interface (at operation <b>802</b>). In some embodiments, the first message is a registration request to a new AMF (e.g., a first one of the AMF <b>116</b> or the other AMF <b>128</b>). The processor <b>202</b> extracts, from the first message, a first mobile ID (at operation <b>804</b>). In some embodiments, the first mobile ID is a 5G GUTI.</p><p id="p-0100" num="0099">The processor <b>202</b> captures a pair of messages is transmitted over one an N14 interface (at operation <b>806</b>). In some embodiments, the pair of messages is transmitted in response to receiving the first message. In some embodiments, a first message of the pair of messages is a UE context transfer message sent from the new AMF to an old AMF (e.g., the other one of the AMF <b>116</b> or the other AMF <b>128</b>). In some embodiments, a second message of the pair of messages is a message sent from the old AMF to the new AMF in response to the UE context transfer message. The processor <b>202</b> extracts, from the pair of messages, a second mobile ID, a permanent ID, and a cipher key (at operation <b>808</b>). In some embodiments, the processor <b>202</b> extracts the second mobile ID from the first message of the pair of messages. In some embodiments, the processor <b>202</b> extracts the permanent ID and the cipher key from the second message of the pair of messages. In some embodiments, the second mobile ID matches the first mobile ID. In some embodiments, the processor <b>202</b> determines that the second mobile ID in the pair of messages is the same as the first mobile in the first message (e.g., the UE context transfer message).</p><p id="p-0101" num="0100">The processor <b>202</b> retrieves the user database record <b>265</b> using the mobile ID (at operation <b>810</b>). The processor <b>202</b> updates a previous mobile ID and a previous cipher key with the second mobile ID and the cipher key, respectively (at operation <b>812</b>). In some embodiments, the second mobile ID matches the first mobile ID using the first mobile ID (at operation <b>814</b>).</p><p id="p-0102" num="0101">Referring now to <figref idref="DRAWINGS">FIGS. <b>9</b>A-<b>9</b>B</figref>, a flow chart of an example method <b>900</b> for a user during a 4G-5G handover is depicted, in accordance with some embodiments. The method <b>900</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>900</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>900</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>900</b> may be performed in parallel. Operations of the method <b>900</b> can be combined with or interchanged with operations of one or more of the methods <b>300</b>-<b>800</b>.</p><p id="p-0103" num="0102">Referring now to <figref idref="DRAWINGS">FIG. <b>9</b>A</figref>, the processor <b>202</b> captures a first message transmitted over one of an N1 interface or an N2 interface (at operation <b>902</b>). The processor <b>202</b> extracts, from the first message, a first 5G mobile ID (at operation <b>904</b>). In some embodiments, the 5G mobile ID includes a 5G GUTI. In some embodiments, the 5G mobile ID includes, maps to, or otherwise references, a 4G mobile ID. For example, the 5G GUTI includes a PLMN ID, an AMF ID, and a 5G TMSI which match or map to corresponding parts in the 4G GUTI. The corresponding parts may be in a different order in the 4G mobile ID. In some embodiments, the 5G mobile ID that references the 4G GUTI identifies a network or location of the MME <b>132</b>.</p><p id="p-0104" num="0103">The processor <b>202</b> captures a second message transmitted over the N26 interface (at operation <b>906</b>). The processor <b>202</b> extracts, from the second message, the 4G mobile ID, a permanent ID, and a cipher key (at operation <b>908</b>). In some embodiments, the processor <b>202</b> uses general packet radio service (GPRS) tunneling protocol (GTP) to extract the 4G mobile ID, and/or other information, from the first message (e.g., transmitted over the N26).</p><p id="p-0105" num="0104">The processor <b>202</b> converts the 4G mobile ID to a second mobile ID matching the first mobile ID (at operation <b>910</b>). In some embodiments, the processor <b>202</b> converts the 4G mobile ID by re-ordering the different parts of the 4G mobile ID so that the PLMN ID, the AMF ID, and the 5G TMSI are in a proper order for a 5G mobile ID. In some embodiments, the processor <b>202</b> converts the using a standardized algorithm that is accessible by the processor <b>202</b>. In some embodiments, the processor <b>202</b> determines that the second 5G mobile ID matches the first 5G mobile ID received in the first message. The processor <b>202</b> retrieves the user database record <b>265</b> using the permanent ID (at operation <b>912</b>).</p><p id="p-0106" num="0105">Referring now to <figref idref="DRAWINGS">FIG. <b>9</b>B</figref>, the processor <b>202</b> updates, in the user database record <b>265</b>, the 4G mobile ID and a previous cipher key with the second 5G mobile ID and the cipher key, respectively (at operation <b>914</b>). In some embodiments, the processor <b>202</b> updates the 4G mobile ID in other records with the 5G mobile ID. The processor <b>202</b> retrieves the updated user database record <b>265</b> using the first 5G mobile ID (at operation <b>916</b>). In some embodiments, the processor <b>202</b> receives a subsequent message transmitted over one of an N1 or N2 interface and extracts a third 5G mobile ID from the third message. In some embodiments, the processor <b>202</b> retrieves the updated user database record <b>265</b> using the third 5G mobile ID extracted from the subsequent message.</p><p id="p-0107" num="0106">Referring now to <figref idref="DRAWINGS">FIG. <b>10</b></figref>, a flow chart of an example method <b>1000</b> for using a security parameter to associate a user database record <b>265</b> to an NGAP session is depicted, in accordance with some embodiments. The method <b>1000</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>1000</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>1000</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>1000</b> may be performed in parallel. Operations of the method <b>1000</b> can be combined with or interchanged with operations of one or more of the methods <b>300</b>-<b>900</b>.</p><p id="p-0108" num="0107">The processor <b>202</b> captures an authentication message transmitted over the N12 interface (at operation <b>1002</b>). The processor <b>202</b> extracts, from the authentication message, an expected response (XRES), a permanent ID, and a security context (e.g., one or more cipher keys) (at operation <b>1004</b>). The processor <b>202</b> stores the XRES and the permanent ID in an XRES record <b>260</b> and the permanent ID and the security context in the user database record <b>265</b> (at operation <b>1006</b>). The processor <b>202</b> captures a second authentication message transmitted over the N1 interface (at operation <b>1008</b>). The processor <b>202</b> extracts, from the second authentication message, a second XRES (at operation <b>1010</b>). In some embodiments, the second XRES matches the XRES.</p><p id="p-0109" num="0108">The processor <b>202</b> retrieves the security context using the second XRES (at operation <b>1012</b>). In some embodiments, the processor <b>202</b> finds the XRES record <b>260</b> using the second XRES and the processor <b>202</b> retrieves a permanent ID from the XRES record <b>260</b>. In some embodiments, the processor finds the user database record <b>265</b> using the permanent ID and retrieves the security context from the user database record <b>265</b>. In some embodiments, the processor <b>202</b> deciphers a ciphered message for a user associated with the user database record <b>265</b> using the security context. Although the method <b>1000</b> was demonstrated using the XRES, other security parameters such as an authentication token (AUTN) can be used instead. While the method <b>1000</b> is performed using the XRES, the method <b>1000</b> can instead be performed using an authentication token (AUTN) or other security parameter and remain within the scope of the present disclosure.</p><p id="p-0110" num="0109">Referring now to <figref idref="DRAWINGS">FIG. <b>11</b></figref>, a flow chart of an example method <b>1100</b> for storing user equipment session details is depicted, in accordance with some embodiments. The method <b>1100</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>1100</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>1100</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>1100</b> may be performed in parallel. Operations of the method <b>1100</b> can be combined with or interchanged with operations of one or more of the methods <b>300</b>-<b>1000</b>.</p><p id="p-0111" num="0110">The processor <b>202</b> deciphers a ciphered message transmitted over an N1 interface (at operation <b>1102</b>). The processor <b>202</b> extracts, from the deciphered message, session details associated with the UE <b>106</b> (at operation <b>1104</b>). The session details include, in some embodiments, one or more of location information, a handset type, local network information, service quality, a key performance indicator (KPI) or KPI key, an IMEI (e.g., or other permanent ID such as IMSI), etc. The processor <b>202</b> stores the session details in session detail record (at operation <b>1106</b>), e.g., associated with the UE <b>106</b>. In some embodiments, the session detail record is stored in a session detail data structure <b>232</b> in a second storage medium <b>206</b>. In some embodiments, the session detail record is mapped to a user database record <b>265</b>. For example, the user database record can include the IMEI and the processor <b>202</b> can retrieve an IMEI from a user database record <b>265</b> and retrieve the corresponding session detail record using the IMEI.</p><p id="p-0112" num="0111">Referring now to <figref idref="DRAWINGS">FIG. <b>12</b></figref>, a flow chart of an example method <b>1200</b> for monitoring the 5G network <b>104</b> is depicted, in accordance with some embodiments. The method <b>1200</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>1200</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>1200</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>1200</b> may be performed in parallel. Operations of the method <b>1200</b> can be combined with or interchanged with operations of one or more of the methods <b>300</b>-<b>1100</b>.</p><p id="p-0113" num="0112">The processor <b>202</b> captures an initial setup message transmitted over one of an N1 interface or an N2 interface (at operation <b>1202</b>). The processor <b>202</b> extracts, from the initial setup message, a first mobile identity (ID) and a first Next Generation application protocol (NGAP) ID (at operation <b>1204</b>). In some embodiments, operations <b>1202</b> and <b>1204</b> are similar to operations <b>302</b> and <b>304</b>, respectively. The processor <b>202</b> determines whether the mobile ID reveals a permanent ID (at operation <b>1206</b>). In response to determining that the mobile ID does not reveal the permanent ID, the processor <b>202</b> determines whether the permanent ID is in a user database record (e.g., the user database record <b>265</b>), e.g., associated with the UE <b>106</b> (at operation <b>1208</b>). In response to determining that the permanent ID is not in the user database record, the processor <b>202</b> creates the user database record and stores the permanent ID and stores the permanent ID in the user database record (at operation <b>1210</b>).</p><p id="p-0114" num="0113">In response to determining that the mobile ID reveals the permanent ID, the processor <b>202</b> determines whether the mobile ID is in the user database record (at operation <b>1212</b>). In some embodiments, in a scheme referred to as a null-scheme, the mobile ID (e.g., a SUCI) reveals a permanent ID (e.g., a SUPI). In response to determining that the mobile ID is not in the user database record, the processor <b>202</b> creates the user database record and stores the mobile ID and stores the mobile ID in the user database record (at operation <b>1214</b>). In some embodiments, the processor <b>202</b> retrieves the user database record using one of the mobile ID or the permanent ID.</p><p id="p-0115" num="0114">In response to determining that the mobile ID is in the user database record, in response to determining that the permanent ID is in the user database record, or in response to storing the permanent ID or the mobile ID in the user database record, the processor <b>202</b> stores the NGAP ID in an NGAP record (at operation <b>1216</b>). In some embodiments, the processor <b>202</b> stores the mobile ID in the NGAP record so that the NGAP record maps to the user database record. In some embodiments, operation <b>1216</b> is similar to operation <b>306</b>. In some embodiments, operations <b>1202</b>-<b>1216</b> maps, or otherwise associates, the user database record to an NGAP session associated with the NGAP ID.</p><p id="p-0116" num="0115">In some embodiments, the processor <b>202</b> captures another message which is transmitted over an N1 interface. In some embodiments, the processor <b>202</b> extracts from the other message, user equipment session details, similarly to operation <b>1104</b>. In some embodiments, the processor <b>202</b> stores the session details in a session detail record (operation <b>1218</b>). In some embodiments, the operation <b>1218</b> is similar to the operation <b>1106</b>.</p><p id="p-0117" num="0116">Referring now to <figref idref="DRAWINGS">FIG. <b>13</b></figref>, a flow chart of an example method <b>1300</b> for monitoring the 5G network <b>104</b> is depicted, in accordance with some embodiments. The method <b>1300</b> can be performed by one or more systems, components, or modules depicted in <figref idref="DRAWINGS">FIG. <b>1</b> or <b>2</b></figref>, including, for example, a network monitoring device <b>102</b>, the processor <b>202</b>, etc. In some embodiments, instructions for performing the method <b>1300</b> are stored in the first storage medium <b>204</b>. Additional, fewer, or different operations may be performed in the method <b>1300</b> depending on the embodiment. Additionally, or alternatively, two or more of the blocks of the method <b>1300</b> may be performed in parallel. Operations of the method <b>1300</b> can be combined with or interchanged with operations of one or more of the methods <b>300</b>-<b>1200</b>.</p><p id="p-0118" num="0117">The processor <b>202</b> identifies a user database record associated with a user equipment (UE) using a mobile ID (at operation <b>1302</b>). In some embodiments, the processor <b>202</b> captures a first message transmitted over one of an N1 interface and an N2 interface. In some embodiments, the processor <b>202</b> extracts the mobile identity (ID) from the first message. In some embodiments, the first message is an initial setup/registration message. In some embodiments, the mobile ID includes one of a temporary mobile subscriber identity (TMSI), a shorten(S)-TMSI, a 5G-S-TMSI, a globally unique temporary ID (GUTI), or a 5G-GUTI. In some embodiments, the mobile ID is a 4G mobile ID and the processor <b>202</b> captures a second message transmitted over the N26 interface, extracts, from the second message, a 5G mobile ID, and updates the 4G mobile ID with the 5G mobile ID. In some embodiments, the processor <b>202</b> performs the method <b>900</b>.</p><p id="p-0119" num="0118">The processor <b>202</b> associates a Next Generation application protocol (NGAP) session with the user database record (at operation <b>1304</b>). In some embodiments, the processor <b>202</b> captures a third message transmitted over one of an N1 interface and an N2 interface. In some embodiments, the processor <b>202</b> extracts one of an NGAP ID or a security parameter (e.g. an expected response (XRES) or an authentication token (AUTN)) from the third message. In some embodiments, the third message is an initial setup/registration message (e.g., a same message as the first message) including the NGAP ID, while in other embodiments, the third message is an authentication message including the security parameter. In some embodiments, the processor <b>202</b> associates the NGAP session with the user database record using the one of the NGAP ID or the security parameter. In some embodiments, the processor <b>202</b> stores the NGAP ID in the NGAP record. In some embodiments, the processor <b>202</b> performs operations <b>302</b>-<b>308</b> and/or the method <b>1000</b>.</p><p id="p-0120" num="0119">In some embodiments, the processor <b>202</b> captures a fourth message transmitted over the N2 interface, extracts a second NGAP ID and a second mobile ID from the fourth message, retrieves the user database record using the NGAP ID, and updates the mobile ID with the second mobile ID. In some embodiments, the processor <b>202</b> performs operations <b>402</b> to <b>410</b>.</p><p id="p-0121" num="0120">In some embodiments, the processor <b>202</b> captures a fifth message and a sixth message transmitted over one or more of the N1 interface, the N2 interface, N14 interface, or N26 interface that indicates a handover. In some embodiments, the processor <b>202</b> extracts appropriate parameters, retrieves appropriate records, and updates appropriate parameters with some of the extracted parameters. In some embodiments, the processor <b>202</b> performs one of the methods <b>500</b>-<b>900</b>.</p><p id="p-0122" num="0121">The processor <b>202</b> captures a ciphered message associated with the NGAP session (at operation <b>1306</b>). The processor <b>202</b> deciphers the ciphered message associated with the NGAP session (at operation <b>1308</b>). The processor <b>202</b> extracts session details associated with the UE <b>106</b> from the deciphered message (at operation <b>1310</b>). The processor <b>202</b> stores the session details in a session detail record (at operation <b>1312</b>). In some embodiments, the user database record and the NGAP record are stored in a centralized database (e.g., the correlation data structure <b>230</b> in the first storage medium <b>204</b>) and the session detail record is stored in a distributed database (e.g., the second storage medium <b>206</b>). In some embodiments, the session details include metadata. In some embodiments, the session details include one or more (e.g., two or more) of location information, a handset type, local network information, service quality information, or a key performance indicator (KPI). In some embodiments, the processor <b>202</b> performs the method <b>1100</b>.</p><p id="p-0123" num="0122">It is to be understood that any examples used herein are simply for purposes of explanation and are not intended to be limiting in any way.</p><p id="p-0124" num="0123">The herein described subject matter sometimes illustrates different components contained within, or connected with, different other components. It is to be understood that such depicted architectures are merely exemplary, and that in fact many other architectures can be implemented which achieve the same functionality. In a conceptual sense, any arrangement of components to achieve the same functionality is effectively &#x201c;associated&#x201d; such that the desired functionality is achieved. Hence, any two components herein combined to achieve a particular functionality can be seen as &#x201c;associated with&#x201d; each other such that the desired functionality is achieved, irrespective of architectures or intermedial components. Likewise, any two components so associated can also be viewed as being &#x201c;operably connected,&#x201d; or &#x201c;operably coupled,&#x201d; to each other to achieve the desired functionality, and any two components capable of being so associated can also be viewed as being &#x201c;operably couplable,&#x201d; to each other to achieve the desired functionality. Specific examples of operably couplable include but are not limited to physically mateable and/or physically interacting components and/or wirelessly interactable and/or wirelessly interacting components and/or logically interacting and/or logically interactable components.</p><p id="p-0125" num="0124">With respect to the use of substantially any plural and/or singular terms herein, those having skill in the art can translate from the plural to the singular and/or from the singular to the plural as is appropriate to the context and/or application. The various singular/plural permutations may be expressly set forth herein for sake of clarity.</p><p id="p-0126" num="0125">It will be understood by those within the art that, in general, terms used herein, and especially in the appended claims (e.g., bodies of the appended claims) are generally intended as &#x201c;open&#x201d; terms (e.g., the term &#x201c;including&#x201d; should be interpreted as &#x201c;including but not limited to,&#x201d; the term &#x201c;having&#x201d; should be interpreted as &#x201c;having at least,&#x201d; the term &#x201c;includes&#x201d; should be interpreted as &#x201c;includes but is not limited to,&#x201d; etc.). It will be further understood by those within the art that if a specific number of an introduced claim recitation is intended, such an intent will be explicitly recited in the claim, and in the absence of such recitation no such intent is present. For example, as an aid to understanding, the following appended claims may contain usage of the introductory phrases &#x201c;at least one&#x201d; and &#x201c;one or more&#x201d; to introduce claim recitations. However, the use of such phrases should not be construed to imply that the introduction of a claim recitation by the indefinite articles &#x201c;a&#x201d; or &#x201c;an&#x201d; limits any particular claim containing such introduced claim recitation to disclosures containing only one such recitation, even when the same claim includes the introductory phrases &#x201c;one or more&#x201d; or &#x201c;at least one&#x201d; and indefinite articles such as &#x201c;a&#x201d; or &#x201c;an&#x201d; (e.g., &#x201c;a&#x201d; and/or &#x201c;an&#x201d; should typically be interpreted to mean &#x201c;at least one&#x201d; or &#x201c;one or more&#x201d;); the same holds true for the use of definite articles used to introduce claim recitations. In addition, even if a specific number of an introduced claim recitation is explicitly recited, those skilled in the art will recognize that such recitation should typically be interpreted to mean at least the recited number (e.g., the bare recitation of &#x201c;two recitations,&#x201d; without other modifiers, typically means at least two recitations, or two or more recitations). Furthermore, in those instances where a convention analogous to &#x201c;at least one of A, B, and C, etc.&#x201d; is used, in general such a construction is intended in the sense one having skill in the art would understand the convention (e.g., &#x201c;a system having at least one of A, B, and C&#x201d; would include but not be limited to systems that have A alone, B alone, C alone, A and B together, A and C together, B and C together, and/or A, B, and C together, etc.). In those instances where a convention analogous to &#x201c;at least one of A, B, or C, etc.&#x201d; is used, in general such a construction is intended in the sense one having skill in the art would understand the convention (e.g., &#x201c;a system having at least one of A, B, or C&#x201d; would include but not be limited to systems that have A alone, B alone, C alone, A and B together, A and C together, B and C together, and/or A, B, and C together, etc.). It will be further understood by those within the art that virtually any disjunctive word and/or phrase presenting two or more alternative terms, whether in the description, claims, or drawings, should be understood to contemplate the possibilities of including one of the terms, either of the terms, or both terms. For example, the phrase &#x201c;A or B&#x201d; will be understood to include the possibilities of &#x201c;A&#x201d; or &#x201c;B&#x201d; or &#x201c;A and B.&#x201d; Further, unless otherwise noted, the use of the words &#x201c;approximate,&#x201d; &#x201c;about,&#x201d; &#x201c;around,&#x201d; &#x201c;substantially,&#x201d; etc., mean plus or minus ten percent.</p><p id="p-0127" num="0126">The foregoing description of illustrative embodiments has been presented for purposes of illustration and of description. It is not intended to be exhaustive or limiting with respect to the precise form disclosed, and modifications and variations are possible in light of the above teachings or may be acquired from practice of the disclosed embodiments. It is intended that the scope of the disclosure be defined by the claims appended hereto and their equivalents.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A non-transitory computer readable medium comprising instructions for providing a mobile user monitoring solution that, when executed by a processor, cause the processor to:<claim-text>identify a user database record associated with a user equipment (UE) using a mobile identity (ID);</claim-text><claim-text>associate a Next Generation application protocol (NGAP) session with the user database record using an NGAP ID;</claim-text><claim-text>capture a ciphered message associated with the NGAP session;</claim-text><claim-text>decipher the ciphered message associated with the NGAP session;</claim-text><claim-text>extract, from the deciphered message, session details associated with the UE; and</claim-text><claim-text>store the session details in a session detail record.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the user database record includes a permanent ID, wherein the mobile ID includes one of a temporary mobile subscriber identity (TMSI), a shorten(S)-TMSI, a 5G-S-TMSI, a globally unique temporary ID (GUTI), or a 5G-GUTI, wherein the permanent ID includes a subscription permanent identity (SUPI), and wherein the SUPI contains one of an international mobile subscriber identity (IMSI) or a network access identifier (NAI).</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to identify the user database record by:<claim-text>capturing a first message transmitted over one of an N1 interface and an N2 interface;</claim-text><claim-text>extracting the mobile ID from the first message; and</claim-text><claim-text>identifying the user database record using the mobile ID.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The medium of <claim-ref idref="CLM-00003">claim 3</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to decipher the ciphered message associated with the NGAP session by:<claim-text>retrieving, from the user database record, a cipher key using the mobile ID; and</claim-text><claim-text>deciphering, using the cipher key, the ciphered message associated with the NGAP session.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to associate the NGAP session with the user database record by:<claim-text>capturing a first message transmitted over one of an N1 interface or an N2 interface;</claim-text><claim-text>extracting, from the first message, one of the NGAP ID, an expected response (XRES), or an authentication token (AUTN); and</claim-text><claim-text>associating the NGAP session with the user database record using the one of the NGAP ID, the XRES, or the AUTN.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The medium of <claim-ref idref="CLM-00005">claim 5</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to associate the NGAP session with the user database record by:<claim-text>capturing a second message transmitted over an N12 interface;</claim-text><claim-text>extracting, from the second message, one of the XRES or the AUTN, a permanent ID, and a cipher key;</claim-text><claim-text>storing the one of the XRES or the AUTN and the permanent ID in an XRES record;</claim-text><claim-text>storing the permanent ID and the cipher key in the user database record;</claim-text><claim-text>extracting, from the first message, the one of the XRES or the AUTN;</claim-text><claim-text>retrieving the permanent ID from the XRES record using the one of the XRES or the AUTN; and</claim-text><claim-text>retrieving the cipher key from the user database record using the permanent ID.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to:<claim-text>capture a first message transmitted over an N2 interface;</claim-text><claim-text>extract, from the first message, the NGAP ID and a second mobile ID;</claim-text><claim-text>retrieve the mobile ID from an NGAP record using the NGAP ID;</claim-text><claim-text>retrieve the user database record using the mobile ID; and</claim-text><claim-text>update the mobile ID with the second mobile ID.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to:<claim-text>capture a first message transmitted over one of an N1 interface or an N2 interface;</claim-text><claim-text>extract, from the first message, the NGAP ID, wherein the NGAP ID is stored in an NGAP record;</claim-text><claim-text>capture a second message transmitted over the one of the N1 interface or the N2 interface;</claim-text><claim-text>extract, from the second message, a second NGAP ID;</claim-text><claim-text>store the second NGAP ID in a second NGAP record;</claim-text><claim-text>retrieve, from the NGAP record, using the NGAP ID, the mobile ID and a permanent ID; and</claim-text><claim-text>store the mobile ID and the permanent ID in the second NGAP record.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to:<claim-text>capture a first message transmitted over an N1 interface or an N2 interface;</claim-text><claim-text>extract, from the first message, a first container ID and the NGAP ID;</claim-text><claim-text>retrieve an NGAP record using the NGAP ID;</claim-text><claim-text>store the first container ID, the mobile ID, and a permanent ID in a container record;</claim-text><claim-text>capture a second message transmitted over the one of the N1 interface or the N2 interface;</claim-text><claim-text>extract, from the second message, a second container ID and a second NGAP ID, wherein the second container ID matches the first container ID;</claim-text><claim-text>store the second NGAP ID in a second NGAP record;</claim-text><claim-text>retrieve, from the container record, using the second container ID, the mobile ID and the permanent ID; and</claim-text><claim-text>store the mobile ID and the permanent ID in the second NGAP record.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to:<claim-text>capture a first message transmitted over an N14 interface;</claim-text><claim-text>extract, from the first message, a first container ID, a permanent ID, and a cipher key;</claim-text><claim-text>store the permanent ID and the cipher key in the user database record;</claim-text><claim-text>store the first container ID and the permanent ID in a container record;</claim-text><claim-text>capture a second message transmitted over one of an N1 interface or an N2 interface;</claim-text><claim-text>extract, from the second message, a second container ID and the NGAP ID, wherein the second container ID matches the first container ID;</claim-text><claim-text>store the NGAP ID in the NGAP record;</claim-text><claim-text>retrieve, from the container record, using the second container ID, the permanent ID;</claim-text><claim-text>retrieve, from the user database record, using the permanent ID, the cipher key; and</claim-text><claim-text>store the permanent ID and the cipher key in the NGAP record.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to:<claim-text>capture a first message transmitted over one of an N1 interface or an N2 interface;</claim-text><claim-text>extract, from the first message, the mobile ID;</claim-text><claim-text>capture a pair of messages transmitted over an N14 interface;</claim-text><claim-text>extract, from the pair of messages, a second mobile ID matching the mobile ID, a permanent ID, and a cipher key;</claim-text><claim-text>retrieve the user database record using the permanent ID;</claim-text><claim-text>update, in the user database record, a previous mobile ID and a previous cipher key with the mobile ID and the cipher key, respectively; and</claim-text><claim-text>retrieve the updated user database record using the mobile ID.</claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising instructions that, when executed by a processor, further cause the processor to:<claim-text>capture a first message transmitted over one of an N1 interface and an N2 interface;</claim-text><claim-text>extract, from the first message, a first 5G mobile ID;</claim-text><claim-text>capture a second message transmitted over an N26 interface;</claim-text><claim-text>extract, from the second message, a 4G mobile ID, a permanent ID, and a cipher key;</claim-text><claim-text>convert the 4G mobile ID to a second 5G mobile ID matching the first 5G mobile ID;</claim-text><claim-text>retrieve the user database record using the permanent ID;</claim-text><claim-text>update, in the user database record, the 4G mobile ID and a previous cipher key with the second 5G mobile ID and the cipher key, respectively; and</claim-text><claim-text>retrieve the updated user database record using the first 5G mobile ID.</claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the session details include two or more of location information, a handset type, local network information, service quality information, or other user statistics.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. An apparatus comprising a processor and a memory, wherein the memory includes programmed instructions that, when executed by the processor, cause the apparatus to:<claim-text>identify a user database record associated with a user equipment (UE) using a mobile identity (ID);</claim-text><claim-text>associate a Next Generation application protocol (NGAP) session with the user database record using an NGAP ID;</claim-text><claim-text>capture a ciphered message associated with the NGAP session;</claim-text><claim-text>decipher the ciphered message associated with the NGAP session;</claim-text><claim-text>extract, from the deciphered message, session details associated with the UE; and</claim-text><claim-text>store the session details in a session detail record.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The apparatus of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the user database record includes a permanent ID, wherein the mobile ID includes one of a temporary mobile subscriber identity (TMSI), a shorten(S)-TMSI, a 5G-S-TMSI, a globally unique temporary ID (GUTI), or a 5G-GUTI, wherein the permanent ID includes a subscription permanent identity (SUPI), and wherein the SUPI contains one of an international mobile subscriber identity (IMSI) or a network access identifier (NAI).</claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The apparatus of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to identify the user database record by:<claim-text>capturing a first message transmitted over one of an N1 interface and an N2 interface;</claim-text><claim-text>extracting the mobile ID from the first message; and</claim-text><claim-text>identifying the user database record using the mobile ID.</claim-text></claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The apparatus of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the memory includes programmed instructions that, when executed by a processor, further cause the apparatus to associate the NGAP session with the user database record by:<claim-text>capturing a first message transmitted over one of an N1 interface or an N2 interface;</claim-text><claim-text>extracting, from the first message, one of the NGAP ID, an expected response (XRES), or an authentication token (AUTN); and</claim-text><claim-text>associating the NGAP session with the user database record using the one of the NGAP ID, the XRES, or the AUTN.</claim-text></claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. A method comprising:<claim-text>identifying a user database record associated with a user equipment (UE) using a mobile identity (ID);</claim-text><claim-text>associating a Next Generation application protocol (NGAP) session with the user database record using an NGAP ID;</claim-text><claim-text>capturing a ciphered message associated with the NGAP session;</claim-text><claim-text>deciphering the ciphered message associated with the NGAP session;</claim-text><claim-text>extracting, from the deciphered message, session details associated with the UE; and</claim-text><claim-text>storing the session details in a session detail record.</claim-text></claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein identifying the user database record further comprises:<claim-text>capturing a first message transmitted over one of an N1 interface and an N2 interface;</claim-text><claim-text>extracting the mobile ID from the first message; and</claim-text><claim-text>identifying the user database record using the mobile ID.</claim-text></claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein associating the NGAP session with the user database record further comprises:<claim-text>capturing a first message transmitted over one of an N1 interface or an N2 interface;</claim-text><claim-text>extracting, from the first message, one of the NGAP ID, an expected response (XRES), or an authentication token (AUTN); and</claim-text><claim-text>associating the NGAP session with the user database record using the one of the NGAP ID, the XRES, or the AUTN.</claim-text></claim-text></claim></claims></us-patent-application>