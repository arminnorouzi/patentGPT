<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007040A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007040</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17364673</doc-number><date>20210630</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>29</main-group><subgroup>06</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>1458</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>1425</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>1416</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>20</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">RECOMMENDATION OF GRANULAR TRAFFIC THRESHOLDS FROM MULTIPLE SENSOR APPLIANCES</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Fortinet, Inc.</orgname><address><city>Sunnyvale</city><state>CA</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Jain</last-name><first-name>Hemant Kumar</first-name><address><city>Milpitas</city><state>CA</state><country>US</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">Recommendations are made for granular traffic thresholds for a plurality of DDoS attack mitigation appliances that act as a set appliances. The set of appliances can be those commonly found in highly available networks, active-active or active-passive appliances, disaster recovery data centers, backup appliances, etc.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="128.27mm" wi="158.75mm" file="US20230007040A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="200.74mm" wi="172.80mm" orientation="landscape" file="US20230007040A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="249.17mm" wi="160.27mm" orientation="landscape" file="US20230007040A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="227.50mm" wi="177.12mm" orientation="landscape" file="US20230007040A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="244.01mm" wi="172.72mm" orientation="landscape" file="US20230007040A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="230.89mm" wi="182.96mm" orientation="landscape" file="US20230007040A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="228.26mm" wi="182.12mm" orientation="landscape" file="US20230007040A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">COPYRIGHT NOTICE</heading><p id="p-0002" num="0001">Contained herein is material that is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction of the patent disclosure by any person as it appears in the Patent and Trademark Office patent files or records, but otherwise reserves all rights to the copyright whatsoever. Copyright 2020, Fortinet, Inc.</p><heading id="h-0002" level="1">CROSS-REFERENCE TO RELATED PATENTS</heading><p id="p-0003" num="0002">This application may relate to the subject matter of U.S. Pat. No. 7,426,634 entitled, &#x201c;Method and apparatus for rate based denial of service attack detection and prevention&#x201d;, U.S. Pat. No. 7,602,731 entitled &#x201c;System and method for integrated header, state, rate and content anomaly prevention with policy enforcement&#x201d;, U.S. Pat. No. 7,626,940 entitled &#x201c;System and method for integrated header, state, rate and content anomaly prevention for domain name service&#x201d;, &#x201c;System and Method for Integrated Header, State, Rate and Content Anomaly Prevention for Session Initiation Protocol&#x201d;, U.S. Pat. No. 9,699,211 entitled &#x201c;Scalable Inline Behavioral DDoS Attack Mitigation&#x201d;, U.S. Pat. No. 9,729,584 entitled System and method for software defined behavioral DDoS attack mitigation&#x201d; all of which are hereby incorporated by reference in their entirety for all purposes.</p><heading id="h-0003" level="1">FIELD</heading><p id="p-0004" num="0003">The invention relates generally to computer hardware and computer networks and, more specifically, to prevention of distributed denial of service (DDoS) attacks on networks exposed to the Internet.</p><heading id="h-0004" level="1">DESCRIPTION OF THE BACKGROUND ART</heading><p id="p-0005" num="0004">It is common knowledge that networks exposed to the Internet by enterprises or service providers are becoming complex. Many architectural schemes such as load balancing, high availability and disaster recovery are incorporated to make the networks more robust and not prone to failure.</p><p id="p-0006" num="0005">A distributed denial of service (DDoS) attack mitigation equipment for Internet facing networks primarily work on behavioral anomalies on rates. For them to work, granular rate estimation on various traffic parameters is paramount as DDoS attacks appear primarily as change in the rate of traffic on one or more granular traffic parameters. The rates of traffic on granular parameters vary from network to network and therefore are relative statistics.</p><p id="p-0007" num="0006">If there is only one appliance that's facing the network traffic, both inbound and outbound, the process is relatively simpler.</p><p id="p-0008" num="0007">However, if there are multiple appliances that face the overall network traffic due to network architecture, a scheme is required to recommend the behavioral granular thresholds for correct identification of behavioral anomalies across the plurality of appliances.</p><heading id="h-0005" level="1">SUMMARY</heading><p id="p-0009" num="0008">The above-mentioned problem is addressed by a system consolidated automated recommendation of granular thresholds in a complex network of DDoS mitigation sensor appliances. In an exemplary active-active highly-available network setup traffic may distribute to two or more different mitigation appliances. And depending on network failures, traffic may distribute differently over time. In yet another exemplary highly available setup, traffic may switch to a secondary appliance when a primary appliance fails. In another exemplary situation, traffic may divert totally to a disaster recovery center appliance where earlier there was no traffic ever. A simple scheme of traffic behavior based on past traffic estimation does not work in these situations.</p><p id="p-0010" num="0009">In an implementation, a distributed denial of service (DDoS) threshold recommendation engine within a network receives a plurality of traffic rate parameters from a plurality of DDoS attack mitigation appliances. The DDoS threshold recommendation engine determines a type of a set of appliances for the plurality of traffic rate parameters received. Rates of individual types of traffic parameters from the plurality of traffic rate parameters are combined, multiplying by a rate multiplier to avoid false positives and determining a maximum combined expected packet rate. The plurality of DDoS attack mitigation appliances are then fed back the traffic thresholds.</p><p id="p-0011" num="0010">Other features of embodiments of the present disclosure will be apparent from accompanying drawings and from detailed description that follows.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0006" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates a single appliance facing the Internet and protecting a network for both the inbound and outbound traffic flows through the appliance, according to an embodiment.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates a few granular traffic parameters that would be used to recommend the thresholds, according to an embodiment.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates an exemplary technique for recommending thresholds based on granular traffic parameters in <figref idref="DRAWINGS">FIG. <b>2</b></figref>, according to an embodiment.</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates deployment of a pair of DDoS Mitigation appliances in an exemplary active-active high availability mode, according to an embodiment.</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates a few granular traffic parameters that would be used to recommend the combined thresholds on two appliances from <figref idref="DRAWINGS">FIG. <b>4</b></figref>, according to an embodiment.</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>6</b></figref> illustrates in accordance with an embodiment of the present invention a technique for recommending granular thresholds by combining data from two appliances in <figref idref="DRAWINGS">FIG. <b>4</b></figref>, according to an embodiment.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0007" level="1">DETAILED DESCRIPTION</heading><p id="p-0018" num="0017">A system and methods are described for recommending granular thresholds in complex network deployment of a plurality of DDoS attack mitigation appliances. According to one embodiment, in a load balanced network with active-active appliances, granular traffic rates of two appliances are combined to recommend the thresholds on two appliances. In yet another embodiment, the traffic of the two or more appliances may be such that one of the appliances has no traffic at all some time, as in case of disaster recovery center appliances and upon disaster suddenly gets all the traffic. In such a scenario, the recommended thresholds cannot use the behavior when traffic is zero&#x2014;but must use the combined traffic of a plurality of non-disaster-recovery appliances facing the total traffic during normal times. One of ordinary skill in the art will recognize many different possibilities, within the spirit of the present disclosure.</p><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates a deployment <b>100</b> of a DDoS attack mitigation appliance <b>102</b> facing the Internet <b>101</b> and protecting a network <b>103</b> consisting of a plurality of devices <b>104</b>. Both inbound and outbound traffic goes through the appliance <b>102</b>. Therefore, the traffic behavior can be easily predicted and estimated for setting behavioral thresholds.</p><p id="p-0020" num="0019">A method can implement the components of <figref idref="DRAWINGS">FIG. <b>1</b></figref> according to the following steps: receiving, by a distributed denial of service (DDoS) threshold recommendation engine within a network, a plurality of traffic rate parameters from a plurality of DDoS attack mitigation appliances; determining, by the DDoS threshold recommendation engine, a type of a set of appliances for the plurality of traffic rate parameters received; combining rates of individual types of traffic parameters from the plurality of traffic rate parameters, multiplying by a rate multiplier to avoid false positives and determining a maximum combined expected packet rate; and feeding back to the plurality of DDoS attack mitigation appliances the traffic thresholds</p><p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates a granular traffic behavior passing through the appliance in <figref idref="DRAWINGS">FIG. <b>1</b>, <b>100</b></figref>. 3 graphs over last 7 days illustrate maximum traffic observed for 3 granular parameters, viz. SYN packets, fragmented packets, and UDP packets in inbound direction via the appliance <b>102</b>. This traffic behavior can be used to estimate traffic thresholds for these granular parameters. These are exemplary parameters. One of ordinary skill in the art will appreciate a variety of other granular traffic behavior parameters such as HTTP Get Method rate, ICMP protocol rate, SIP Invite Rate, etc. exist in accordance with the aforementioned definition. These are maximum per second rates that can be observed via the mitigation appliance. In an exemplary situation, SYN packet rate over last 7 days, according to 201 never exceeded 876,982 packets per second any time. Similarly, Fragmented packets never arrived faster than 871 packets per second over the last 7 days. Similarly, UDP packet rate never exceeded 973,205 packets per second.</p><p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates an exemplary technique for recommending granular thresholds according to those skilled in the art. <b>301</b> shows a table. E.g. if maximum SYN rate observed is 876,982 packets per second (PPS), then from DDoS attack mitigation perspective, it would make sense to give some &#x2018;cushion&#x2019; to avoid false positives. In an exemplary situation, this cushion could be 300% of the traffic observed. Thus, the threshold could be recommended at 2,630,946 which is 3&#xd7; of the observed traffic rate for that parameter in the inbound direction. What this means is that until traffic exceeds 2,630,946 PPS for this granular traffic parameter, it is not considered an anomaly from DDoS perspective. Some traffic can have very low value during observation period but occasionally may reach reasonable value at another &#x2018;normal&#x2019; time which are not DDoS attacks. Therefore, a concept of Minimum Recommended Granular Threshold can be used. In this case, say, 5,000 PPS. Since our 300% of observed rate for SYN is higher than this minimum, we can suggest a granular threshold to 2,630,946 PPS.</p><p id="p-0023" num="0022">In case of Fragmented packets in the exemplary situation in table <b>301</b>, the Maximum Expected Rate is still 2,613 which is below Minimum Recommended Granular Threshold of 5,000. Thus, a recommendation of 5,000 PPS is appropriate for these packets.</p><p id="p-0024" num="0023">In a similar way, UDP packet threshold can be set to 2,811,615 according to this technique.</p><p id="p-0025" num="0024">Those skilled in the art will appreciate that use of maximum here is only an exemplary technique. Other schemes such as 95th percentile to avoid sudden bursts can be used too. Similarly using last 7 days is an example, other periods such as last 1 month or last 1 year or last 24 hours can be used depending on what data is available and what is important to the system administrator.</p><p id="p-0026" num="0025">An exemplary DDoS attack mitigation works on an integrated combination of a plurality of such traffic thresholds and violation of any one or more of such thresholds is considered an active traffic anomaly and is mitigated by limiting the rate of such anomalous packets selectively. Those skilled in the art are aware that the volume of traffic increase during an attack is manifold compared to baseline traffic. It is therefore not an issue of accuracy of these thresholds to exact per second value but about reasonable of these values. The attack rates are significantly higher compared to baseline rates. Those skilled in the art are aware that in an exemplary situation, the baseline traffic may be in 100 Mbps but the attack rates may be in 5 Gbps. In yet another deployment, the baseline may be around 5 Gbps and attack may be in 20 Gbps range.</p><p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates a typical deployment <b>400</b> of DDoS attack mitigation appliances <b>403</b> and <b>404</b> facing the Internet <b>401</b> and protecting a network <b>407</b> consisting of a plurality of devices <b>408</b>. In this exemplary active-active deployment, a router or a load balancer <b>402</b> at the ingress of this data center, sends traffic in a way to the two appliances <b>403</b> and <b>404</b> that not all traffic goes through one appliance. In a similar way, the outbound traffic from protected network <b>407</b> is via two routers <b>405</b> and <b>406</b>. Thus, if one of the protected devices <b>408</b> has its default router pointing to <b>405</b>, all its traffic outbound will be pass via <b>405</b> and thus via <b>403</b>. In a similar way, if a one of the protected devices <b>408</b> has its default router pointing to <b>406</b>, all its traffic outbound will pass via <b>406</b> and thus via <b>404</b>. Therefore, the traffic passing via <b>403</b> and <b>404</b> will depend on network conditions and policies set by the administrator. These conditions and policies may vary over time. Thus, balance of traffic over period of time may vary substantially while keeping the total traffic via the system around the same predicable baseline.</p><p id="p-0028" num="0027">A DDoS threshold recommendation engine <b>105</b> can provide network support to each of the DDoS attack mitigation appliances. In one implementation, residence on the protected network provides direct communication with network devices. In another implementation on the Internet, cloud-based support gathers experience from across many different protected networks. Rates are sent from <b>402</b>,<b>404</b> and thresholds are returned to <b>402</b>,<b>404</b>.</p><p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates a typical granular traffic behavior passing through the appliances <b>403</b> and <b>404</b> in <figref idref="DRAWINGS">FIG. <b>4</b>, <b>400</b></figref>. 3 graphs <b>501</b>, <b>502</b> and <b>503</b> illustrate maximum traffic observed for 3 granular parameters, viz. SYN packets, fragmented packets, and UDP packets in inbound direction via the appliance <b>403</b>.</p><p id="p-0030" num="0029">The other 3 graphs <b>504</b>, <b>505</b> and <b>506</b> illustrate maximum traffic observed for 3 granular parameters, viz. SYN packets, fragmented packets, and UDP packets in inbound direction via the appliance <b>404</b>.</p><p id="p-0031" num="0030">In this exemplary situation, SYN packet rate over last 7 days, according to 501 never exceeded 481,284 PPS any time. Similarly, Fragmented packets never arrived faster than 8,672 PPS over the last 7 days. Similarly, UDP packet rate never exceeded 919,523 PPS on appliance <b>403</b>.</p><p id="p-0032" num="0031">In this exemplary situation, SYN packet rate over last 7 days, according to 504 never exceeded 480,615 PPS any time. Similarly, Fragmented packets never arrived faster than 8,842 PPS over the last 7 days. Similarly, UDP packet rate never exceeded 8,982 PPS on appliance <b>404</b>.</p><p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. <b>6</b></figref> illustrates an exemplary technique for recommending granular thresholds according to an embodiment of this invention. <b>601</b> shows a table corresponding to graphs <b>501</b>, <b>502</b>, and <b>503</b>. <b>602</b> shows a table corresponding to graphs <b>504</b>, <b>505</b>, and <b>506</b>. And, <b>603</b> shows a table according to an embodiment of this invention, a technique to arrive at common threshold for plurality of the appliances based on table <b>601</b> and <b>602</b>.</p><p id="p-0034" num="0033">As explained in earlier section, we can derive the suggested Granular Threshold for appliance <b>403</b> as 1,443,852 for SYN Packets, 26,016 for fragmented packets, and 2,758,569 as depicted in Table <b>601</b>.</p><p id="p-0035" num="0034">In a similar way, as explained in earlier section, we can derive the suggested Granular Threshold for appliance <b>404</b> as 1,441,845 for SYN Packets, 26,526 for fragmented packets, and 26,946 as depicted in Table <b>602</b>.</p><p id="p-0036" num="0035">According to an embodiment of this invention, since the two appliances <b>403</b> and <b>404</b> share the total traffic under various scenarios such as load balancing, routing changes, disaster recovery, high availability, keeping their thresholds based on just their traffic behavior is not the most appropriate technique. According to an embodiment of this invention, the appliances will not exceed the cumulative traffic at any given moment under the above scenarios. Thus, if the traffic of two appliances with due cushion is summed up, the thresholds can be predicted based on that new value. Table <b>603</b> shows such a scheme according to an embodiment of this invention. In the exemplary situation, rates of SYN, fragmented packets, and UPD packets from <b>601</b> and <b>602</b> and the cumulative values are used as a baseline. The resultant thresholds are deployed on both the appliances. These new thresholds ensure that whether traffic moves from one to the other fully or partially or in a random way, both the appliances are generally ready to mitigate the rate anomalies based on the new thresholds.</p><p id="p-0037" num="0036">In yet another embodiment of the invention, the plurality of the appliances is not limited to two appliances but could be higher.</p><p id="p-0038" num="0037">In yet another embodiment of the invention, the thresholds are not limited to those mentioned above but could be those parameters that could be obtained from packets and sessions of the packets through packet classification and other techniques known to those in the art.</p><p id="p-0039" num="0038">In another embodiment of the invention, the direction of the anomalies is not limited to inbound packets, but could be outbound as well&#x2014;as those who are skilled in the art are aware that there are outbound attacks as well.</p><p id="p-0040" num="0039">Components described above are meant only to exemplify various possibilities. In no way should the aforementioned exemplary computer system limit the scope of the present disclosure.</p><p id="p-0041" num="0040">Embodiments of the present disclosure include various steps, which have been described above. A variety of these steps may be performed by hardware components or may be tangibly embodied on a computer-readable storage medium in the form of machine-executable instructions, which may be used to cause a general-purpose or special-purpose processor programmed with instructions to perform these steps. Alternatively, the steps may be performed by a combination of hardware, software, and/or firmware.</p><p id="p-0042" num="0041">Although embodiments of the present invention and their various advantages have been described in detail, it should be understood that the present invention is not limited to or defined by what is shown or discussed herein.</p><p id="p-0043" num="0042">Moreover, as one skilled in the art will appreciate, any digital computer systems can be configured or otherwise programmed to implement the methods and apparatuses disclosed herein, and to the extent that a particular digital computer system is configured to implement the methods and apparatuses of this invention, it is within the scope and spirit of the present invention. Once a digital computer system is programmed to perform particular functions pursuant to computer-executable instructions from program software that implements the present invention, it in effect becomes a special purpose computer particular to the present invention. The techniques necessary to achieve this are well known to those skilled in the art and thus are not further described herein.</p><p id="p-0044" num="0043">Computer executable instructions implementing the methods and techniques of the present invention can be distributed to users on a computer-readable medium and are often copied onto a hard disk or other storage medium. When such a program of instructions is to be executed, it is usually loaded into the random-access memory of the computer, thereby configuring the computer to act in accordance with the techniques disclosed herein. All these operations are well known to those skilled in the art and thus are not further described herein. The term &#x201c;computer-readable medium&#x201d; encompasses distribution media, intermediate storage media, execution memory of a computer, and any other medium or device capable of storing for later reading by a computer a computer program implementing the present invention.</p><p id="p-0045" num="0044">Accordingly, drawings, tables, and description disclosed herein illustrate technologies related to the invention, show examples of the invention, and provide examples of using the invention and are not to be construed as limiting the present invention. Known methods, techniques, or systems may be discussed without giving details, so to avoid obscuring the principles of the invention. As it will be appreciated by one of ordinary skill in the art, the present invention can be implemented, modified, or otherwise altered without departing from the principles and spirit of the present invention. Therefore, the scope of the present invention should be determined by the following claims and their legal equivalents.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A computer-implemented method in a distributed denial of service (DDoS) attack mitigation server, the method comprising:<claim-text>receiving, by a DDoS threshold recommendation engine within a network, a plurality of traffic rate parameters from a plurality of DDoS attack mitigation appliances;</claim-text><claim-text>determining, by the DDoS threshold recommendation engine, a type of a set of appliances for the plurality of traffic rate parameters received;</claim-text><claim-text>combining rates of individual types of traffic parameters from the plurality of traffic rate parameters, multiplying by a rate multiplier to avoid false positives and determining a maximum combined expected packet rate; and</claim-text><claim-text>feeding back to the plurality of DDoS attack mitigation appliances the traffic thresholds.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>determining if the set of appliances consists of a plurality of active-active appliances.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>determining if the set of appliances consists of a plurality of active-passive appliances.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>determining if the set of appliances consists of a plurality of appliances that are part of load balanced appliances facing the same network.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>determining if the set of appliances consists of a plurality of appliances that are part of the same highly available network facing the same cumulative traffic.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>determining if the set of appliances consists of a plurality of appliances that are part of a set, some of which may be used under disaster recovery and some that face the network traffic under normal circumstances.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>determining if the set of appliances consists of a plurality of appliances that are part of a set, some of which may be used as a backup if the primary appliances fail.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>combining the rates of individual granular traffic parameters from the whole set, multiplying by a rate multiplier to avoid false positives and determining a maximum combined expected packet rate.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:<claim-text>determining a final set of granular thresholds.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising:<claim-text>deploying this set of thresholds on all the appliances that belong to the set of mitigation appliances.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. A non-transitory computer-readable medium storing sourced code that, when executed by a processor, performs a method in a distributed denial of service (DDoS) attack mitigation server, the method comprising:<claim-text>receiving, by a DDoS threshold recommendation engine within a network, a plurality of traffic rate parameters from a plurality of DDoS attack mitigation appliances;</claim-text><claim-text>determining, by the DDoS threshold recommendation engine, a type of a set of appliances for the plurality of traffic rate parameters received;</claim-text><claim-text>combining rates of individual types of traffic parameters from the plurality of traffic rate parameters, multiplying by a rate multiplier to avoid false positives and determining a maximum combined expected packet rate; and</claim-text><claim-text>feeding back to the plurality of DDoS attack mitigation appliances the traffic thresholds.</claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. A distributed denial of service (DDoS) attack mitigation server, comprising:<claim-text>receiving, by a DDoS threshold recommendation engine within a network, a plurality of traffic rate parameters from a plurality of DDoS attack mitigation appliances;</claim-text><claim-text>determining, by the DDoS threshold recommendation engine, a type of a set of appliances for the plurality of traffic rate parameters received;</claim-text><claim-text>combining rates of individual types of traffic parameters from the plurality of traffic rate parameters, multiplying by a rate multiplier to avoid false positives and determining a maximum combined expected packet rate; and</claim-text><claim-text>feeding back to the plurality of DDoS attack mitigation appliances the traffic thresholds.</claim-text></claim-text></claim></claims></us-patent-application>