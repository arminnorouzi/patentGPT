<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007268A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007268</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17899834</doc-number><date>20220831</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>132</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>117</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>159</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>176</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>186</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>46</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>82</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>132</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>117</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>159</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>176</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>186</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>46</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>82</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">METHOD FOR CODING IMAGE ON BASIS OF DEBLOCKING FILTERING, AND APPARATUS THEREFOR</invention-title><us-related-documents><continuation><relation><parent-doc><document-id><country>US</country><doc-number>17572329</doc-number><date>20220110</date></document-id><parent-grant-document><document-id><country>US</country><doc-number>11470325</doc-number></document-id></parent-grant-document></parent-doc><child-doc><document-id><country>US</country><doc-number>17899834</doc-number></document-id></child-doc></relation></continuation><continuation><relation><parent-doc><document-id><country>US</country><doc-number>PCT/KR2020/008984</doc-number><date>20200709</date></document-id><parent-status>PENDING</parent-status></parent-doc><child-doc><document-id><country>US</country><doc-number>17572329</doc-number></document-id></child-doc></relation></continuation><us-provisional-application><document-id><country>US</country><doc-number>62871731</doc-number><date>20190709</date></document-id></us-provisional-application></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>LG ELECTRONICS INC.</orgname><address><city>Seoul</city><country>KR</country></address></addressbook><residence><country>KR</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>JANG</last-name><first-name>Hyeongmoon</first-name><address><city>Seoul</city><country>KR</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>LIM</last-name><first-name>Jaehyun</first-name><address><city>Seoul</city><country>KR</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>NAM</last-name><first-name>Junghak</first-name><address><city>Seoul</city><country>KR</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A method for decoding an image, according to the present document, comprises: receiving a bitstream including BDPCM information; deriving residual samples for a current block on the basis of the BDPCM information; deriving prediction samples for the current block on the basis of the BDPCM information; generating a reconstructed picture on the basis of the residual samples and the prediction samples; and performing deblocking filtering on the reconstructed picture, wherein when BDPCM is applied to the current block, the deblocking filtering is not performed.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="75.10mm" wi="95.59mm" file="US20230007268A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="132.59mm" wi="97.62mm" file="US20230007268A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="197.61mm" wi="136.31mm" orientation="landscape" file="US20230007268A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="192.79mm" wi="130.89mm" orientation="landscape" file="US20230007268A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="95.59mm" wi="118.36mm" file="US20230007268A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="153.50mm" wi="119.63mm" file="US20230007268A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="179.83mm" wi="127.34mm" file="US20230007268A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="148.67mm" wi="113.88mm" file="US20230007268A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="148.67mm" wi="115.65mm" file="US20230007268A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="173.99mm" wi="153.50mm" orientation="landscape" file="US20230007268A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">BACKGROUND OF THE DISCLOSURE</heading><heading id="h-0002" level="1">Field of the Disclosure</heading><p id="p-0002" num="0001">The present disclosure relates to a video coding technique and, more particularly, to a video coding method based on deblocking filtering in a video coding system and the apparatus for the same.</p><heading id="h-0003" level="1">Related Art</heading><p id="p-0003" num="0002">Nowadays, the demand for high-resolution and high-quality images/videos such as 4K, 8K or more ultra high definition (UHD) images/videos has been increasing in various fields. As the image/video data becomes higher resolution and higher quality, the transmitted information amount or bit amount increases as compared to the conventional image data. Therefore, when image data is transmitted using a medium such as a conventional wired/wireless broadband line or image/video data is stored using an existing storage medium, the transmission cost and the storage cost thereof are increased.</p><p id="p-0004" num="0003">Further, nowadays, the interest and demand for immersive media such as virtual reality (VR), artificial reality (AR) content or hologram, or the like is increasing, and broadcasting for images/videos having image features different from those of real images, such as a game image is increasing.</p><p id="p-0005" num="0004">Accordingly, there is a need for a highly efficient image/video compression technique for effectively compressing and transmitting or storing, and reproducing information of high resolution and high quality images/videos having various features as described above.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0006" num="0005">A technical aspect of the present disclosure is to provide a method and an apparatus for increasing image coding efficiency.</p><p id="p-0007" num="0006">The present disclosure also provides a method and apparatus for increasing efficiency of transform index coding in video coding based on deblocking filtering.</p><p id="p-0008" num="0007">The present disclosure also provides a method and apparatus for deblocking filtering for a video which is coded based on a BDPCM.</p><p id="p-0009" num="0008">The present disclosure also provides a video coding method and apparatus for a chroma component which is coded based on a BDPCM.</p><p id="p-0010" num="0009">In an aspect, a video decoding method performed by a decoding apparatus is provided. The method may include receiving a bitstream including BDPCM (block differential pulse coded modulation or Block-based Delta Pulse Code Modulation) information; deriving residual samples for a current block based on the BDPCM information; deriving prediction samples for the current block based on the BDPCM information; generating a reconstructed picture based on the residual sample and the prediction sample; performing deblocking filtering on the reconstructed picture, wherein, when a BDPCM is applied to the current block, the deblocking filtering may not be performed.</p><p id="p-0011" num="0010">The BDPCM information may include flag information that indicates whether the BDPCM is applied to the current block, and when the flag information is 1, a boundary strength (bS) for the deblocking filtering may be derived as zero.</p><p id="p-0012" num="0011">The current block may include a luma coding block or a chroma coding block.</p><p id="p-0013" num="0012">A tree type of the current block may be a single tree type, the current block may be the chroma coding block, and when the flag information is 1, the boundary strength may be derived as 1.</p><p id="p-0014" num="0013">The step of deriving the residual samples may include deriving a quantized transform coefficient for the current block based on the BDPCM; and deriving a transform coefficient by performing dequantization of the quantized transform coefficient.</p><p id="p-0015" num="0014">The quantized transform coefficient may be derived based on directional information for a direction in which the BDPCM is performed.</p><p id="p-0016" num="0015">An intra prediction sample for the current block may be derived based on a direction in which the BDPCM is performed.</p><p id="p-0017" num="0016">In another aspect, a video encoding method performed by an encoding apparatus is provided. The method may include deriving prediction samples for a current block based on a BDPCM (block differential pulse coded modulation or Block-based Delta Pulse Code Modulation); deriving residual samples for the current block based on the prediction samples; generating a reconstructed picture based on the residual sample and the prediction sample; performing deblocking filtering on the reconstructed picture; deriving quantized residual information for a current block based on the BDPCM; and encoding the quantized residual information and BDPCM information for the BDPCM, wherein, when the BDPCM is applied to the current block, the deblocking filtering may not be performed.</p><p id="p-0018" num="0017">According to still another embodiment of the present disclosure, there may be provided a digital storage medium that stores image data including encoded image information and a bitstream generated according to an image encoding method performed by an encoding apparatus.</p><p id="p-0019" num="0018">According to yet another embodiment of the present disclosure, there may be provided a digital storage medium that stores image data including encoded image information and a bitstream to cause a decoding apparatus to perform the image decoding method.</p><heading id="h-0005" level="1">Advantageous Effects</heading><p id="p-0020" num="0019">According to the present disclosure, it is possible to increase overall image/video compression efficiency.</p><p id="p-0021" num="0020">According to the present disclosure, the efficiency of deblocking filtering in video coding based on a BDPCM may be increased.</p><p id="p-0022" num="0021">According to the present disclosure, the efficiency of deblocking filtering of a chroma image based on a BDPCM may be increased.</p><p id="p-0023" num="0022">The effects that can be obtained through specific examples of the present disclosure are not limited to the effects listed above. For example, there may be various technical effects that a person having ordinary skill in the related art can understand or derive from the present disclosure. Accordingly, specific effects of the present disclosure are not limited to those explicitly described in the present disclosure and may include various effects that can be understood or derived from the technical features of the present disclosure.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0006" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. <b>1</b></figref> schematically illustrates an example of a video/image coding system to which the present disclosure is applicable.</p><p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a diagram schematically illustrating a configuration of a video/image encoding apparatus to which the present disclosure is applicable.</p><p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a diagram schematically illustrating a configuration of a video/image decoding apparatus to which the present disclosure is applicable.</p><p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a control flowchart for describing a deblocking filtering procedure according to an embodiment.</p><p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a diagram illustrating samples located at a boundary of a block.</p><p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a diagram illustrating a method for determining a bS according to an embodiment of the present disclosure.</p><p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a control flowchart for describing a video decoding method according to an embodiment of the present disclosure.</p><p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a control flowchart for describing a video encoding method according to an embodiment of the present disclosure.</p><p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. <b>9</b></figref> illustrates the structure of a content streaming system to which the present disclosure is applied.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0007" level="1">DESCRIPTION OF EXEMPLARY EMBODIMENTS</heading><p id="p-0033" num="0032">While the present disclosure may be susceptible to various modifications and include various embodiments, specific embodiments thereof have been shown in the drawings by way of example and will now be described in detail. However, this is not intended to limit the present disclosure to the specific embodiments disclosed herein. The terminology used herein is for the purpose of describing specific embodiments only, and is not intended to limit technical idea of the present disclosure. The singular forms may include the plural forms unless the context clearly indicates otherwise. The terms such as &#x201c;include&#x201d; and &#x201c;have&#x201d; are intended to indicate that features, numbers, steps, operations, elements, components, or combinations thereof used in the following description exist, and thus should not be understood as that the possibility of existence or addition of one or more different features, numbers, steps, operations, elements, components, or combinations thereof is excluded in advance.</p><p id="p-0034" num="0033">Meanwhile, each component on the drawings described herein is illustrated independently for convenience of description as to characteristic functions different from each other, and however, it is not meant that each component is realized by a separate hardware or software. For example, any two or more of these components may be combined to form a single component, and any single component may be divided into plural components. The embodiments in which components are combined and/or divided will belong to the scope of the patent right of the present disclosure as long as they do not depart from the essence of the present disclosure.</p><p id="p-0035" num="0034">Hereinafter, preferred embodiments of the present disclosure will be explained in more detail while referring to the attached drawings. In addition, the same reference signs are used for the same components on the drawings, and repeated descriptions for the same components will be omitted.</p><p id="p-0036" num="0035">This document relates to video/image coding. For example, the method/example disclosed in this document may relate to a VVC (Versatile Video Coding) standard (ITU-T Rec. H.266), a next-generation video/image coding standard after VVC, or other video coding related standards (e.g., HEVC (High Efficiency Video Coding) standard (ITU-T Rec. H.265), EVC (essential video coding) standard, AVS2 standard, etc.).</p><p id="p-0037" num="0036">In this document, a variety of embodiments relating to video/image coding may be provided, and, unless specified to the contrary, the embodiments may be combined to each other and be performed.</p><p id="p-0038" num="0037">In this document, a video may mean a set of a series of images over time. Generally a picture means a unit representing an image at a specific time zone, and a slice/tile is a unit constituting a part of the picture. The slice/tile may include one or more coding tree units (CTUs). One picture may be constituted by one or more slices/tiles. One picture may be constituted by one or more tile groups. One tile group may include one or more tiles.</p><p id="p-0039" num="0038">A pixel or a pel may mean a smallest unit constituting one picture (or image). Also, &#x2018;sample&#x2019; may be used as a term corresponding to a pixel. A sample may generally represent a pixel or a value of a pixel, and may represent only a pixel/pixel value of a luma component or only a pixel/pixel value of a chroma component. Alternatively, the sample may refer to a pixel value in the spatial domain, or when this pixel value is converted to the frequency domain, it may refer to a transform coefficient in the frequency domain.</p><p id="p-0040" num="0039">A unit may represent the basic unit of image processing. The unit may include at least one of a specific region and information related to the region. One unit may include one luma block and two chroma (e.g., cb, cr) blocks. The unit and a term such as a block, an area, or the like may be used in place of each other according to circumstances. In a general case, an M&#xd7;N block may include a set (or an array) of samples (or sample arrays) or transform coefficients consisting of M columns and N rows.</p><p id="p-0041" num="0040">In this document, the term &#x201c;/&#x201d; and &#x201c;,&#x201d; should be interpreted to indicate &#x201c;and/or.&#x201d; For instance, the expression &#x201c;A/B&#x201d; may mean &#x201c;A and/or B.&#x201d; Further, &#x201c;A, B&#x201d; may mean &#x201c;A and/or B.&#x201d; Further, &#x201c;A/B/C&#x201d; may mean &#x201c;at least one of A, B, and/or C.&#x201d; Also, &#x201c;A/B/C&#x201d; may mean &#x201c;at least one of A, B, and/or C.&#x201d;</p><p id="p-0042" num="0041">Further, in the document, the term &#x201c;or&#x201d; should be interpreted to indicate &#x201c;and/or.&#x201d; For instance, the expression &#x201c;A or B&#x201d; may include 1) only A, 2) only B, and/or 3) both A and B. In other words, the term &#x201c;or&#x201d; in this document should be interpreted to indicate &#x201c;additionally or alternatively.&#x201d;</p><p id="p-0043" num="0042">In the present disclosure, &#x201c;at least one of A and B&#x201d; may mean &#x201c;only A&#x201d;, &#x201c;only B&#x201d;, or &#x201c;both A and B&#x201d;. In addition, in the present disclosure, the expression &#x201c;at least one of A or B&#x201d; or &#x201c;at least one of A and/or B&#x201d; may be interpreted as &#x201c;at least one of A and B&#x201d;.</p><p id="p-0044" num="0043">In addition, in the present disclosure, &#x201c;at least one of A, B, and C&#x201d; may mean &#x201c;only A&#x201d;, &#x201c;only B&#x201d;, &#x201c;only C&#x201d;, or &#x201c;any combination of A, B, and C&#x201d;. In addition, &#x201c;at least one of A, B, or C&#x201d; or &#x201c;at least one of A, B, and/or C&#x201d; may mean &#x201c;at least one of A, B, and C&#x201d;.</p><p id="p-0045" num="0044">In addition, a parenthesis used in the present disclosure may mean &#x201c;for example&#x201d;. Specifically, when indicated as &#x201c;prediction (intra prediction)&#x201d;, it may mean that &#x201c;intra prediction&#x201d; is proposed as an example of &#x201c;prediction&#x201d;. In other words, the &#x201c;prediction&#x201d; of the present disclosure is not limited to &#x201c;intra prediction&#x201d;, and &#x201c;intra prediction&#x201d; may be proposed as an example of &#x201c;prediction&#x201d;. In addition, when indicated as &#x201c;prediction (i.e., intra prediction)&#x201d;, it may also mean that &#x201c;intra prediction&#x201d; is proposed as an example of &#x201c;prediction&#x201d;.</p><p id="p-0046" num="0045">Technical features individually described in one figure in the present disclosure may be individually implemented or may be simultaneously implemented.</p><p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. <b>1</b></figref> schematically illustrates an example of a video/image coding system to which the present disclosure is applicable.</p><p id="p-0048" num="0047">Referring to <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the video/image coding system may include a first device (source device) and a second device (receive device). The source device may deliver encoded video/image information or data in the form of a file or streaming to the receive device via a digital storage medium or network.</p><p id="p-0049" num="0048">The source device may include a video source, an encoding apparatus, and a transmitter. The receive device may include a receiver, a decoding apparatus, and a renderer. The encoding apparatus may be called a video/image encoding apparatus, and the decoding apparatus may be called a video/image decoding apparatus. The transmitter may be included in the encoding apparatus. The receiver may be included in the decoding apparatus. The renderer may include a display, and the display may be configured as a separate device or an external component.</p><p id="p-0050" num="0049">The video source may obtain a video/image through a process of capturing, synthesizing, or generating a video/image. The video source may include a video/image capture device and/or a video/image generating device. The video/image capture device may include, for example, one or more cameras, video/image archives including previously captured video/images, or the like. The video/image generating device may include, for example, a computer, a tablet and a smartphone, and may (electronically) generate a video/image. For example, a virtual video/image may be generated through a computer or the like. In this case, the video/image capturing process may be replaced by a process of generating related data.</p><p id="p-0051" num="0050">The encoding apparatus may encode an input video/image. The encoding apparatus may perform a series of procedures such as prediction, transform, and quantization for compression and coding efficiency. The encoded data (encoded video/image information) may be output in the form of a bitstream.</p><p id="p-0052" num="0051">The transmitter may transmit the encoded video/image information or data output in the form of a bitstream to the receiver of the receive device through a digital storage medium or a network in the form of a file or streaming. The digital storage medium may include various storage mediums such as USB, SD, CD, DVD, Blu-ray, HDD, SSD, and the like. The transmitter may include an element for generating a media file through a predetermined file format, and may include an element for transmission through a broadcast/communication network. The receiver may receive/extract the bitstream and transmit the received/extracted bitstream to the decoding apparatus.</p><p id="p-0053" num="0052">The decoding apparatus may decode a video/image by performing a series of procedures such as dequantization, inverse transform, prediction, and the like corresponding to the operation of the encoding apparatus.</p><p id="p-0054" num="0053">The renderer may render the decoded video/image. The rendered video/image may be displayed through the display.</p><p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a diagram schematically illustrating a configuration of a video/image encoding apparatus to which the present disclosure is applicable. Hereinafter, what is referred to as the video encoding apparatus may include an image encoding apparatus.</p><p id="p-0056" num="0055">Referring to <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the encoding apparatus <b>200</b> may include an image partitioner <b>210</b>, a predictor <b>220</b>, a residual processor <b>230</b>, an entropy encoder <b>240</b>, an adder <b>250</b>, a filter <b>260</b>, and a memory <b>270</b>. The predictor <b>220</b> may include an inter predictor <b>221</b> and an intra predictor <b>222</b>. The residual processor <b>230</b> may include a transformer <b>232</b>, a quantizer <b>233</b>, a dequantizer <b>234</b>, an inverse transformer <b>235</b>. The residual processor <b>230</b> may further include a subtractor <b>231</b>. The adder <b>250</b> may be called a reconstructor or reconstructed block generator. The image partitioner <b>210</b>, the predictor <b>220</b>, the residual processor <b>230</b>, the entropy encoder <b>240</b>, the adder <b>250</b>, and the filter <b>260</b>, which have been described above, may be constituted by one or more hardware components (e.g., encoder chipsets or processors) according to an embodiment. Further, the memory <b>270</b> may include a decoded picture buffer (DPB), and may be constituted by a digital storage medium. The hardware component may further include the memory <b>270</b> as an internal/external component.</p><p id="p-0057" num="0056">The image partitioner <b>210</b> may partition an input image (or a picture or a frame) input to the encoding apparatus <b>200</b> into one or more processing units. As one example, the processing unit may be called a coding unit (CU). In this case, starting with a coding tree unit (CTU) or the largest coding unit (LCU), the coding unit may be recursively partitioned according to the Quad-tree binary-tree ternary-tree (QTBTTT) structure. For example, one coding unit may be divided into a plurality of coding units of a deeper depth based on the quad-tree structure, the binary-tree structure, and/or the ternary structure. In this case, for example, the quad-tree structure may be applied first and the binary-tree structure and/or the ternary structure may be applied later. Alternatively, the binary-tree structure may be applied first. The coding procedure according to the present disclosure may be performed based on the final coding unit which is not further partitioned. In this case, the maximum coding unit may be used directly as a final coding unit based on coding efficiency according to the image characteristic. Alternatively, the coding unit may be recursively partitioned into coding units of a further deeper depth as needed, so that the coding unit of an optimal size may be used as a final coding unit. Here, the coding procedure may include procedures such as prediction, transform, and reconstruction, which will be described later. As another example, the processing unit may further include a prediction unit (PU) or a transform unit (TU). In this case, the prediction unit and the transform unit may be split or partitioned from the above-described final coding unit. The prediction unit may be a unit of sample prediction, and the transform unit may be a unit for deriving a transform coefficient and/or a unit for deriving a residual signal from a transform coefficient.</p><p id="p-0058" num="0057">The unit and a term such as a block, an area, or the like may be used in place of each other according to circumstances. In a general case, an M&#xd7;N block may represent a set of samples or transform coefficients consisting of M columns and N rows. The sample may generally represent a pixel or a value of a pixel, and may represent only a pixel/pixel value of a luma component, or only a pixel/pixel value of a chroma component. The sample may be used as a term corresponding to a pixel or a pel of one picture (or image).</p><p id="p-0059" num="0058">The subtractor <b>231</b> subtracts a prediction signal (predicted block, prediction sample array) output from the predictor <b>220</b> from an input image signal (original block, original sample array) to generate a residual signal (residual block, residual sample array), and the generated residual signal is transmitted to the transformer <b>232</b>. The predictor <b>220</b> may perform prediction on a processing target block (hereinafter, referred to as &#x2018;current block&#x2019;), and may generate a predicted block including prediction samples for the current block. The predictor <b>220</b> may determine whether intra prediction or inter prediction is applied on a current block or CU basis. As discussed later in the description of each prediction mode, the predictor may generate various information relating to prediction, such as prediction mode information, and transmit the generated information to the entropy encoder <b>240</b>. The information on the prediction may be encoded in the entropy encoder <b>240</b> and output in the form of a bitstream.</p><p id="p-0060" num="0059">The intra predictor <b>222</b> may predict the current block by referring to samples in the current picture. The referred samples may be located in the neighbor of or apart from the current block according to the prediction mode. In the intra prediction, prediction modes may include a plurality of non-directional modes and a plurality of directional modes. The non-directional modes may include, for example, a DC mode and a planar mode. The directional mode may include, for example, 33 directional prediction modes or 65 directional prediction modes according to the degree of detail of the prediction direction. However, this is merely an example, and more or less directional prediction modes may be used depending on a setting. The intra predictor <b>222</b> may determine the prediction mode applied to the current block by using the prediction mode applied to the neighboring block.</p><p id="p-0061" num="0060">The inter predictor <b>221</b> may derive a predicted block for the current block based on a reference block (reference sample array) specified by a motion vector on a reference picture. At this time, in order to reduce the amount of motion information transmitted in the inter prediction mode, the motion information may be predicted on a block, subblock, or sample basis based on correlation of motion information between the neighboring block and the current block. The motion information may include a motion vector and a reference picture index. The motion information may further include inter prediction direction (L0 prediction, L1 prediction, Bi prediction, etc.) information. In the case of inter prediction, the neighboring block may include a spatial neighboring block existing in the current picture and a temporal neighboring block existing in the reference picture. The reference picture including the reference block and the reference picture including the temporal neighboring block may be same to each other or different from each other. The temporal neighboring block may be called a collocated reference block, a collocated CU (colCU), and the like, and the reference picture including the temporal neighboring block may be called a collocated picture (colPic). For example, the inter predictor <b>221</b> may configure a motion information candidate list based on neighboring blocks and generate information indicating which candidate is used to derive a motion vector and/or a reference picture index of the current block. Inter prediction may be performed based on various prediction modes. For example, in the case of a skip mode and a merge mode, the inter predictor <b>221</b> may use motion information of the neighboring block as motion information of the current block. In the skip mode, unlike the merge mode, the residual signal may not be transmitted. In the case of the motion information prediction (motion vector prediction, MVP) mode, the motion vector of the neighboring block may be used as a motion vector predictor and the motion vector of the current block may be indicated by signaling a motion vector difference.</p><p id="p-0062" num="0061">The predictor <b>220</b> may generate a prediction signal based on various prediction methods. For example, the predictor may apply intra prediction or inter prediction for prediction on one block, and, as well, may apply intra prediction and inter prediction at the same time. This may be called combined inter and intra prediction (CIIP). Further, the predictor may be based on an intra block copy (IBC) prediction mode, or a palette mode in order to perform prediction on a block. The IBC prediction mode or palette mode may be used for content image/video coding of a game or the like, such as screen content coding (SCC). Although the IBC basically performs prediction in a current block, it can be performed similarly to inter prediction in that it derives a reference block in a current block. That is, the IBC may use at least one of inter prediction techniques described in the present disclosure.</p><p id="p-0063" num="0062">The prediction signal generated through the inter predictor <b>221</b> and/or the intra predictor <b>222</b> may be used to generate a reconstructed signal or to generate a residual signal. The transformer <b>232</b> may generate transform coefficients by applying a transform technique to the residual signal. For example, the transform technique may include at least one of a discrete cosine transform (DCT), a discrete sine transform (DST), a Karhunen-Lo&#xe8;ve transform (KLT), a graph-based transform (GBT), or a conditionally non-linear transform (CNT). Here, the GBT means transform obtained from a graph when relationship information between pixels is represented by the graph. The CNT refers to transform obtained based on a prediction signal generated using all previously reconstructed pixels. In addition, the transform process may be applied to square pixel blocks having the same size or may be applied to blocks having a variable size rather than the square one.</p><p id="p-0064" num="0063">The quantizer <b>233</b> may quantize the transform coefficients and transmit them to the entropy encoder <b>240</b>, and the entropy encoder <b>240</b> may encode the quantized signal (information on the quantized transform coefficients) and output the encoded signal in a bitstream. The information on the quantized transform coefficients may be referred to as residual information. The quantizer <b>233</b> may rearrange block type quantized transform coefficients into a one-dimensional vector form based on a coefficient scan order, and generate information on the quantized transform coefficients based on the quantized transform coefficients of the one-dimensional vector form. The entropy encoder <b>240</b> may perform various encoding methods such as, for example, exponential Golomb, context-adaptive variable length coding (CAVLC), context-adaptive binary arithmetic coding (CABAC), and the like. The entropy encoder <b>240</b> may encode information necessary for video/image reconstruction other than quantized transform coefficients (e.g. values of syntax elements, etc.) together or separately. Encoded information (e.g., encoded video/image information) may be transmitted or stored on a unit basis of a network abstraction layer (NAL) in the form of a bitstream. The video/image information may further include information on various parameter sets such as an adaptation parameter set (APS), a picture parameter set (PPS), a sequence parameter set (SPS), a video parameter set (VPS) or the like. Further, the video/image information may further include general constraint information. In the present disclosure, information and/or syntax elements which are transmitted/signaled to the decoding apparatus from the encoding apparatus may be included in video/image information. The video/image information may be encoded through the above-described encoding procedure and included in the bitstream. The bitstream may be transmitted through a network, or stored in a digital storage medium. Here, the network may include a broadcast network, a communication network and/or the like, and the digital storage medium may include various storage media such as USB, SD, CD, DVD, Blu-ray, HDD, SSD, and the like. A transmitter (not shown) which transmits a signal output from the entropy encoder <b>240</b> and/or a storage (not shown) which stores it may be configured as an internal/external element of the encoding apparatus <b>200</b>, or the transmitter may be included in the entropy encoder <b>240</b>.</p><p id="p-0065" num="0064">Quantized transform coefficients output from the quantizer <b>233</b> may be used to generate a prediction signal. For example, by applying dequantization and inverse transform to quantized transform coefficients through the dequantizer <b>234</b> and the inverse transformer <b>235</b>, the residual signal (residual block or residual samples) may be reconstructed. The adder <b>155</b> adds the reconstructed residual signal to a prediction signal output from the inter predictor <b>221</b> or the intra predictor <b>222</b>, so that a reconstructed signal (reconstructed picture, reconstructed block, reconstructed sample array) may be generated. When there is no residual for a processing target block as in a case where the skip mode is applied, the predicted block may be used as a reconstructed block. The adder <b>250</b> may be called a reconstructor or a reconstructed block generator. The generated reconstructed signal may be used for intra prediction of a next processing target block in the current block, and as described later, may be used for inter prediction of a next picture through filtering.</p><p id="p-0066" num="0065">Meanwhile, in the picture encoding and/or reconstructing process, luma mapping with chroma scaling (LMCS) may be applied.</p><p id="p-0067" num="0066">The filter <b>260</b> may improve subjective/objective video quality by applying the filtering to the reconstructed signal. For example, the filter <b>260</b> may generate a modified reconstructed picture by applying various filtering methods to the reconstructed picture, and may store the modified reconstructed picture in the memory <b>270</b>, specifically in the DPB of the memory <b>270</b>. The various filtering methods may include, for example, deblocking filtering, sample adaptive offset, an adaptive loop filter, a bilateral filter or the like. As discussed later in the description of each filtering method, the filter <b>260</b> may generate various information relating to filtering, and transmit the generated information to the entropy encoder <b>240</b>. The information on the filtering may be encoded in the entropy encoder <b>240</b> and output in the form of a bitstream.</p><p id="p-0068" num="0067">The modified reconstructed picture which has been transmitted to the memory <b>270</b> may be used as a reference picture in the inter predictor <b>221</b>. Through this, the encoding apparatus can avoid prediction mismatch in the encoding apparatus <b>100</b> and a decoding apparatus when the inter prediction is applied, and can also improve coding efficiency.</p><p id="p-0069" num="0068">The memory <b>270</b> DPB may store the modified reconstructed picture in order to use it as a reference picture in the inter predictor <b>221</b>. The memory <b>270</b> may store motion information of a block in the current picture, from which motion information has been derived (or encoded) and/or motion information of blocks in an already reconstructed picture. The stored motion information may be transmitted to the inter predictor <b>221</b> to be utilized as motion information of a neighboring block or motion information of a temporal neighboring block. The memory <b>270</b> may store reconstructed samples of reconstructed blocks in the current picture, and transmit them to the intra predictor <b>222</b>.</p><p id="p-0070" num="0069"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a diagram schematically illustrating a configuration of a video/image decoding apparatus to which the present disclosure is applicable.</p><p id="p-0071" num="0070">Referring to <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the video decoding apparatus <b>300</b> may include an entropy decoder <b>310</b>, a residual processor <b>320</b>, a predictor <b>330</b>, an adder <b>340</b>, a filter <b>350</b> and a memory <b>360</b>. The predictor <b>330</b> may include an inter predictor <b>331</b> and an intra predictor <b>332</b>. The residual processor <b>320</b> may include a dequantizer <b>321</b> and an inverse transformer <b>321</b>. The entropy decoder <b>310</b>, the residual processor <b>320</b>, the predictor <b>330</b>, the adder <b>340</b>, and the filter <b>350</b>, which have been described above, may be constituted by one or more hardware components (e.g., decoder chipsets or processors) according to an embodiment. Further, the memory <b>360</b> may include a decoded picture buffer (DPB), and may be constituted by a digital storage medium. The hardware component may further include the memory <b>360</b> as an internal/external component.</p><p id="p-0072" num="0071">When a bitstream including video/image information is input, the decoding apparatus <b>300</b> may reconstruct an image correspondingly to a process by which video/image information has been processed in the encoding apparatus of <figref idref="DRAWINGS">FIG. <b>2</b></figref>. For example, the decoding apparatus <b>300</b> may derive units/blocks based on information relating to block partition obtained from the bitstream. The decoding apparatus <b>300</b> may perform decoding by using a processing unit applied in the encoding apparatus. Therefore, the processing unit of decoding may be, for example, a coding unit, which may be partitioned along the quad-tree structure, the binary-tree structure, and/or the ternary-tree structure from a coding tree unit or a largest coding unit. One or more transform units may be derived from the coding unit. And, the reconstructed image signal decoded and output through the decoding apparatus <b>300</b> may be reproduced through a reproducer.</p><p id="p-0073" num="0072">The decoding apparatus <b>300</b> may receive a signal output from the encoding apparatus of <figref idref="DRAWINGS">FIG. <b>2</b></figref> in the form of a bitstream, and the received signal may be decoded through the entropy decoder <b>310</b>. For example, the entropy decoder <b>310</b> may parse the bitstream to derive information (e.g., video/image information) required for image reconstruction (or picture reconstruction). The video/image information may further include information on various parameter sets such as an adaptation parameter set (APS), a picture parameter set (PPS), a sequence parameter set (SPS), a video parameter set (VPS) or the like. Further, the video/image information may further include general constraint information. The decoding apparatus may decode a picture further based on information on the parameter set and/or the general constraint information. In the present disclosure, signaled/received information and/or syntax elements, which will be described later, may be decoded through the decoding procedure and be obtained from the bitstream. For example, the entropy decoder <b>310</b> may decode information in the bitstream based on a coding method such as exponential Golomb encoding, CAVLC, CABAC, or the like, and may output a value of a syntax element necessary for image reconstruction and quantized values of a transform coefficient regarding a residual. More specifically, a CABAC entropy decoding method may receive a bin corresponding to each syntax element in a bitstream, determine a context model using decoding target syntax element information and decoding information of neighboring and decoding target blocks, or information of symbol/bin decoded in a previous step, predict bin generation probability according to the determined context model and perform arithmetic decoding of the bin to generate a symbol corresponding to each syntax element value. Here, the CABAC entropy decoding method may update the context model using information of a symbol/bin decoded for a context model of the next symbol/bin after determination of the context model. Information on prediction among information decoded in the entropy decoder <b>310</b> may be provided to the predictor (inter predictor <b>332</b> and intra predictor <b>331</b>), and residual values, that is, quantized transform coefficients, on which entropy decoding has been performed in the entropy decoder <b>310</b>, and associated parameter information may be input to the residual processor <b>320</b>. The residual processor <b>320</b> may derive a residual signal (residual block, residual samples, residual sample array). Further, information on filtering among information decoded in the entropy decoder <b>310</b> may be provided to the filter <b>350</b>. Meanwhile, a receiver (not shown) which receives a signal output from the encoding apparatus may further constitute the decoding apparatus <b>300</b> as an internal/external element, and the receiver may be a component of the entropy decoder <b>310</b>. Meanwhile, the decoding apparatus according to the present disclosure may be called a video/image/picture coding apparatus, and the decoding apparatus may be classified into an information decoder (video/image/picture information decoder) and a sample decoder (video/image/picture sample decoder). The information decoder may include the entropy decoder <b>310</b>, and the sample decoder may include at least one of the dequantizer <b>321</b>, the inverse transformer <b>322</b>, the adder <b>340</b>, the filter <b>350</b>, the memory <b>360</b>, the inter predictor <b>332</b>, and the intra predictor <b>331</b>.</p><p id="p-0074" num="0073">The dequantizer <b>321</b> may output transform coefficients by dequantizing the quantized transform coefficients. The dequantizer <b>321</b> may rearrange the quantized transform coefficients in the form of a two-dimensional block. In this case, the rearrangement may perform rearrangement based on an order of coefficient scanning which has been performed in the encoding apparatus. The dequantizer <b>321</b> may perform dequantization on the quantized transform coefficients using quantization parameter (e.g., quantization step size information), and obtain transform coefficients.</p><p id="p-0075" num="0074">The dequantizer <b>322</b> obtains a residual signal (residual block, residual sample array) by inverse transforming transform coefficients.</p><p id="p-0076" num="0075">The predictor may perform prediction on the current block, and generate a predicted block including prediction samples for the current block. The predictor may determine whether intra prediction or inter prediction is applied to the current block based on the information on prediction output from the entropy decoder <b>310</b>, and specifically may determine an intra/inter prediction mode.</p><p id="p-0077" num="0076">The predictor may generate a prediction signal based on various prediction methods. For example, the predictor may apply intra prediction or inter prediction for prediction on one block, and, as well, may apply intra prediction and inter prediction at the same time. This may be called combined inter and intra prediction (CIIP). In addition, the predictor may perform intra block copy (IBC) for prediction on a block. The intra block copy may be used for content image/video coding of a game or the like, such as screen content coding (SCC). Although the IBC basically performs prediction in a current block, it can be performed similarly to inter prediction in that it derives a reference block in a current block. That is, the IBC may use at least one of inter prediction techniques described in the present disclosure.</p><p id="p-0078" num="0077">The intra predictor <b>331</b> may predict the current block by referring to the samples in the current picture. The referred samples may be located in the neighbor of or apart from the current block according to the prediction mode. In the intra prediction, prediction modes may include a plurality of non-directional modes and a plurality of directional modes. The intra predictor <b>331</b> may determine the prediction mode applied to the current block by using the prediction mode applied to the neighboring block.</p><p id="p-0079" num="0078">The inter predictor <b>332</b> may derive a predicted block for the current block based on a reference block (reference sample array) specified by a motion vector on a reference picture. At this time, in order to reduce the amount of motion information transmitted in the inter prediction mode, the motion information may be predicted on a block, subblock, or sample basis based on correlation of motion information between the neighboring block and the current block. The motion information may include a motion vector and a reference picture index. The motion information may further include inter prediction direction (L0 prediction, L1 prediction, Bi prediction, etc.) information. In the case of inter prediction, the neighboring block may include a spatial neighboring block existing in the current picture and a temporal neighboring block existing in the reference picture. For example, the inter predictor <b>332</b> may configure a motion information candidate list based on neighboring blocks, and derive a motion vector and/or a reference picture index of the current block based on received candidate selection information. Inter prediction may be performed based on various prediction modes, and the information on prediction may include information indicating a mode of inter prediction for the current block.</p><p id="p-0080" num="0079">The adder <b>340</b> may generate a reconstructed signal (reconstructed picture, reconstructed block, reconstructed sample array) by adding the obtained residual signal to the prediction signal (predicted block, prediction sample array) output from the predictor <b>330</b>. When there is no residual for a processing target block as in a case where the skip mode is applied, the predicted block may be used as a reconstructed block.</p><p id="p-0081" num="0080">The adder <b>340</b> may be called a reconstructor or a reconstructed block generator. The generated reconstructed signal may be used for intra prediction of a next processing target block in the current block, and as described later, may be output through filtering or be used for inter prediction of a next picture.</p><p id="p-0082" num="0081">Meanwhile, in the picture decoding process, luma mapping with chroma scaling (LMCS) may be applied.</p><p id="p-0083" num="0082">The filter <b>350</b> may improve subjective/objective video quality by applying the filtering to the reconstructed signal. For example, the filter <b>350</b> may generate a modified reconstructed picture by applying various filtering methods to the reconstructed picture, and may transmit the modified reconstructed picture in the memory <b>360</b>, specifically in the DPB of the memory <b>360</b>. The various filtering methods may include, for example, deblocking filtering, sample adaptive offset, an adaptive loop filter, a bilateral filter or the like.</p><p id="p-0084" num="0083">The (modified) reconstructed picture which has been stored in the DPB of the memory <b>360</b> may be used as a reference picture in the inter predictor <b>332</b>. The memory <b>360</b> may store motion information of a block in the current picture, from which motion information has been derived (or decoded) and/or motion information of blocks in an already reconstructed picture. The stored motion information may be transmitted to the inter predictor <b>260</b> to be utilized as motion information of a neighboring block or motion information of a temporal neighboring block. The memory <b>360</b> may store reconstructed samples of reconstructed blocks in the current picture, and transmit them to the intra predictor <b>331</b>.</p><p id="p-0085" num="0084">In this specification, the examples described in the predictor <b>330</b>, the dequantizer <b>321</b>, the inverse transformer <b>322</b>, and the filter <b>350</b> of the decoding apparatus <b>300</b> may be similarly or correspondingly applied to the predictor <b>220</b>, the dequantizer <b>234</b>, the inverse transformer <b>235</b>, and the filter <b>260</b> of the encoding apparatus <b>200</b>, respectively.</p><p id="p-0086" num="0085">As described above, prediction is performed in order to increase compression efficiency in performing video coding. Through this, a predicted block including prediction samples for a current block, which is a coding target block, may be generated. Here, the predicted block includes prediction samples in a space domain (or pixel domain). The predicted block may be identically derived in the encoding apparatus and the decoding apparatus, and the encoding apparatus may increase image coding efficiency by signaling to the decoding apparatus not original sample value of an original block itself but information on residual (residual information) between the original block and the predicted block. The decoding apparatus may derive a residual block including residual samples based on the residual information, generate a reconstructed block including reconstructed samples by adding the residual block to the predicted block, and generate a reconstructed picture including reconstructed blocks.</p><p id="p-0087" num="0086">The residual information may be generated through transform and quantization procedures. For example, the encoding apparatus may derive a residual block between the original block and the predicted block, derive transform coefficients by performing a transform procedure on residual samples (residual sample array) included in the residual block, and derive quantized transform coefficients by performing a quantization procedure on the transform coefficients, so that it may signal associated residual information to the decoding apparatus (through a bitstream). Here, the residual information may include value information, position information, a transform technique, transform kernel, a quantization parameter or the like of the quantized transform coefficients. The decoding apparatus may perform a quantization/dequantization procedure and derive the residual samples (or residual sample block), based on residual information. The decoding apparatus may generate a reconstructed block based on a predicted block and the residual block. The encoding apparatus may derive a residual block by dequantizing/inverse transforming quantized transform coefficients for reference for inter prediction of a next picture, and may generate a reconstructed picture based on this.</p><p id="p-0088" num="0087">Meanwhile, according to an embodiment, a block differential pulse coded modulation or Block-based Delta Pulse Code Modulation (BDPCM) technique may be used. The BDPCM may also be referred to as a quantized Residual block-based Delta Pulse Code Modulation (RDPCM).</p><p id="p-0089" num="0088">In the case of predicting a block by applying the BDPCM, reconstructed samples are utilized to predict a row or a column of a block in a line by line manner. In this case, a used reference pixel may be unfiltered samples. A BDPCM direction may represent whether a prediction of a vertical direction or horizontal direction is used. A prediction error may be quantized in a spatial domain, and a pixel may be reconstructed by adding a dequantized prediction error to a prediction. As an alternative of the BDPCM, a quantized residual domain BDPCM may be proposed, and a prediction direction or a signaling thereof may be the same as the BDPCM which has been applied to the spatial domain. In other words, quantized coefficients are stacked through a quantized residual domain BDPCM like in a Delta Pulse Code Modulation (DPCM), and then, a residual may be reconstructed through dequantization. Accordingly, the quantized residual domain BDPCM may be used in the meaning that the DPCM is applied in a residual coding end. Hereinafter, in the quantized residual domain used below, a residual derived based on a prediction is quantized without a transform, and the quantized residual domain means a domain for a quantized residual sample.</p><p id="p-0090" num="0089">For a block of size M (rows)&#xd7;N (columns), let r<sub>i,j</sub>, 0&#x2264;i&#x2264;M&#x2212;1, 0&#x2264;j&#x2264;N&#x2212;1 be a prediction residual after performing an intra prediction horizontally (copying left neighbor pixel value across the predicted block line by line) or vertically (copying top neighbor line to each line in the predicted block) using unfiltered samples from above or left block boundary samples. Further, let Q(r<sub>i,j</sub>), 0&#x2264;i&#x2264;M&#x2212;1, 0&#x2264;j&#x2264;N&#x2212;1 denote a quantized version of the residual r<sub>i,j</sub>. Here, the residual means a difference between an original block and a predicted block value.</p><p id="p-0091" num="0090">Thereafter, when the BDPCM is applied to the quantized residual sample, a modified M&#xd7;N array {tilde over (R)} with elements {tilde over (r)}<sub>i,j </sub>is derived.</p><p id="p-0092" num="0091">When a vertical BDPCM is signaled, {tilde over (r)}<sub>i,j </sub>is as represented in the Equation below.</p><p id="p-0093" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msub>      <mover>       <mi>r</mi>       <mo>~</mo>      </mover>      <mrow>       <mi>i</mi>       <mo>,</mo>       <mi>j</mi>      </mrow>     </msub>     <mo>=</mo>     <mrow>      <mo>{</mo>      <mrow>       <mtable>        <mtr>         <mtd>          <mrow>           <mrow>            <mi>Q</mi>            <mo>&#x2061;</mo>            <mo>(</mo>            <msub>             <mi>r</mi>             <mrow>              <mi>i</mi>              <mo>,</mo>              <mi>j</mi>             </mrow>            </msub>            <mo>)</mo>           </mrow>           <mo>,</mo>          </mrow>         </mtd>         <mtd>          <mrow>           <mrow>            <mi>i</mi>            <mo>=</mo>            <mn>0</mn>           </mrow>           <mo>,</mo>           <mrow>            <mn>0</mn>            <mo>&#x2264;</mo>            <mi>j</mi>            <mo>&#x2264;</mo>            <mrow>             <mo>(</mo>             <mrow>              <mi>N</mi>              <mo>-</mo>              <mn>1</mn>             </mrow>             <mo>)</mo>            </mrow>           </mrow>          </mrow>         </mtd>        </mtr>        <mtr>         <mtd>          <mrow>           <mrow>            <mrow>             <mi>Q</mi>             <mo>&#x2062;</mo>             <mrow>              <mo>(</mo>              <msub>               <mi>r</mi>               <mrow>                <mi>i</mi>                <mo>,</mo>                <mi>j</mi>               </mrow>              </msub>              <mo>)</mo>             </mrow>            </mrow>            <mo>-</mo>            <mrow>             <mi>Q</mi>             <mo>&#x2062;</mo>             <mrow>              <mo>(</mo>              <msub>               <mi>r</mi>               <mrow>                <mrow>                 <mo>(</mo>                 <mrow>                  <mi>i</mi>                  <mo>-</mo>                  <mn>1</mn>                 </mrow>                 <mo>)</mo>                </mrow>                <mo>,</mo>                <mi>j</mi>               </mrow>              </msub>              <mo>)</mo>             </mrow>            </mrow>           </mrow>           <mtext>&#x205f;</mtext>           <mo>,</mo>          </mrow>         </mtd>         <mtd>          <mrow>           <mrow>            <mn>1</mn>            <mo>&#x2264;</mo>            <mi>i</mi>            <mo>&#x2264;</mo>            <mrow>             <mo>(</mo>             <mrow>              <mi>M</mi>              <mo>-</mo>              <mn>1</mn>             </mrow>             <mo>)</mo>            </mrow>           </mrow>           <mo>,</mo>           <mtext>&#x205f;</mtext>           <mrow>            <mn>0</mn>            <mo>&#x2264;</mo>            <mi>j</mi>            <mo>&#x2264;</mo>            <mrow>             <mo>(</mo>             <mrow>              <mi>N</mi>              <mo>-</mo>              <mn>1</mn>             </mrow>             <mo>)</mo>            </mrow>           </mrow>          </mrow>         </mtd>        </mtr>       </mtable>       <mo>&#x2062;</mo>       <mtable>        <mtr>         <mtd>          <mtext>&#x205f;</mtext>         </mtd>        </mtr>        <mtr>         <mtd>          <mtext>&#x205f;</mtext>         </mtd>        </mtr>       </mtable>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>[</mo>     <mrow>      <mi>Equation</mi>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mn>1</mn>     </mrow>     <mo>]</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0094" num="0092">For a horizontal prediction, when a similar rule is applied, the residual quantized sample is as represented in the Equation below.</p><p id="p-0095" num="0000"><maths id="MATH-US-00002" num="00002"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msub>      <mover>       <mi>r</mi>       <mo>~</mo>      </mover>      <mrow>       <mi>i</mi>       <mo>,</mo>       <mi>j</mi>      </mrow>     </msub>     <mo>=</mo>     <mrow>      <mo>{</mo>      <mtable>       <mtr>        <mtd>         <mrow>          <mrow>           <mi>Q</mi>           <mo>&#x2062;</mo>           <mrow>            <mo>(</mo>            <msub>             <mi>r</mi>             <mrow>              <mi>i</mi>              <mo>,</mo>              <mi>j</mi>             </mrow>            </msub>            <mo>)</mo>           </mrow>          </mrow>          <mo>,</mo>         </mrow>        </mtd>        <mtd>         <mrow>          <mrow>           <mn>0</mn>           <mo>&#x2264;</mo>           <mi>i</mi>           <mo>&#x2264;</mo>           <mrow>            <mo>(</mo>            <mrow>             <mi>M</mi>             <mo>-</mo>             <mn>1</mn>            </mrow>            <mo>)</mo>           </mrow>          </mrow>          <mo>,</mo>         </mrow>        </mtd>        <mtd>         <mrow>          <mi>j</mi>          <mo>=</mo>          <mn>0</mn>         </mrow>        </mtd>       </mtr>       <mtr>        <mtd>         <mrow>          <mrow>           <mrow>            <mi>Q</mi>            <mo>&#x2062;</mo>            <mrow>             <mo>(</mo>             <msub>              <mi>r</mi>              <mrow>               <mi>i</mi>               <mo>,</mo>               <mi>j</mi>              </mrow>             </msub>             <mo>)</mo>            </mrow>           </mrow>           <mo>-</mo>           <mrow>            <mi>Q</mi>            <mo>&#x2062;</mo>            <mrow>             <mo>(</mo>             <msub>              <msub>               <mi>r</mi>               <mrow>                <mi>i</mi>                <mo>,</mo>               </mrow>              </msub>              <mrow>               <mo>(</mo>               <mrow>                <mi>j</mi>                <mo>-</mo>                <mn>1</mn>               </mrow>               <mo>)</mo>              </mrow>             </msub>             <mo>)</mo>            </mrow>           </mrow>          </mrow>          <mtext>&#x205f;</mtext>          <mo>,</mo>         </mrow>        </mtd>        <mtd>         <mrow>          <mrow>           <mn>0</mn>           <mo>&#x2264;</mo>           <mi>i</mi>           <mo>&#x2264;</mo>           <mrow>            <mo>(</mo>            <mrow>             <mi>M</mi>             <mo>-</mo>             <mn>1</mn>            </mrow>            <mo>)</mo>           </mrow>          </mrow>          <mo>,</mo>         </mrow>        </mtd>        <mtd>         <mrow>          <mn>1</mn>          <mo>&#x2264;</mo>          <mi>j</mi>          <mo>&#x2264;</mo>          <mrow>           <mo>(</mo>           <mrow>            <mi>N</mi>            <mo>-</mo>            <mn>1</mn>           </mrow>           <mo>)</mo>          </mrow>         </mrow>        </mtd>       </mtr>      </mtable>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>[</mo>     <mrow>      <mi>Equation</mi>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mn>2</mn>     </mrow>     <mo>]</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0096" num="0093">The residual quantized sample {tilde over (r)}<sub>i,j </sub>is transmitted to the decoding apparatus.</p><p id="p-0097" num="0094">In the decoding apparatus, the above calculations are reversed to produce Q(r<sub>i,j</sub>), <b>0</b>&#x2264;i&#x2264;M&#x2212;1, 0&#x2264;j&#x2264;N&#x2212;1.</p><p id="p-0098" num="0095">For a vertical prediction, the following equation may be applied.</p><p id="p-0099" num="0000"><maths id="MATH-US-00003" num="00003"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mrow>       <mi>Q</mi>       <mo>&#x2061;</mo>       <mo>(</mo>       <msub>        <mi>r</mi>        <mrow>         <mi>i</mi>         <mo>,</mo>         <mi>j</mi>        </mrow>       </msub>       <mo>)</mo>      </mrow>      <mo>=</mo>      <mrow>       <munderover>        <mo>&#x2211;</mo>        <mrow>         <mi>k</mi>         <mo>=</mo>         <mn>0</mn>        </mrow>        <mi>i</mi>       </munderover>       <msub>        <mover>         <mi>r</mi>         <mo>~</mo>        </mover>        <mrow>         <mi>k</mi>         <mo>,</mo>         <mi>j</mi>        </mrow>       </msub>      </mrow>     </mrow>     <mo>,</mo>     <mtext>&#x205f;</mtext>     <mrow>      <mn>0</mn>      <mo>&#x2264;</mo>      <mi>i</mi>      <mo>&#x2264;</mo>      <mrow>       <mo>(</mo>       <mrow>        <mi>M</mi>        <mo>-</mo>        <mn>1</mn>       </mrow>       <mo>)</mo>      </mrow>     </mrow>     <mo>,</mo>     <mtext>&#x205f;</mtext>     <mrow>      <mn>0</mn>      <mo>&#x2264;</mo>      <mi>j</mi>      <mo>&#x2264;</mo>      <mrow>       <mo>(</mo>       <mrow>        <mi>N</mi>        <mo>-</mo>        <mn>1</mn>       </mrow>       <mo>)</mo>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>[</mo>     <mrow>      <mi>Equation</mi>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mn>3</mn>     </mrow>     <mo>]</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0100" num="0096">In addition, for a horizontal prediction, the following equation may be applied.</p><p id="p-0101" num="0000"><maths id="MATH-US-00004" num="00004"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mrow>       <mo>(</mo>       <msub>        <mi>r</mi>        <mrow>         <mi>i</mi>         <mo>,</mo>         <mi>j</mi>        </mrow>       </msub>       <mo>)</mo>      </mrow>      <mo>=</mo>      <mrow>       <munderover>        <mo>&#x2211;</mo>        <mrow>         <mi>k</mi>         <mo>=</mo>         <mn>0</mn>        </mrow>        <mi>j</mi>       </munderover>       <msub>        <mover>         <mi>r</mi>         <mo>~</mo>        </mover>        <mrow>         <mi>i</mi>         <mo>,</mo>         <mi>k</mi>        </mrow>       </msub>      </mrow>     </mrow>     <mo>,</mo>     <mtext>&#x205f;</mtext>     <mrow>      <mn>0</mn>      <mo>&#x2264;</mo>      <mi>i</mi>      <mo>&#x2264;</mo>      <mrow>       <mo>(</mo>       <mrow>        <mi>M</mi>        <mo>-</mo>        <mn>1</mn>       </mrow>       <mo>)</mo>      </mrow>     </mrow>     <mo>,</mo>     <mtext>&#x205f;</mtext>     <mrow>      <mn>0</mn>      <mo>&#x2264;</mo>      <mi>j</mi>      <mo>&#x2264;</mo>      <mrow>       <mo>(</mo>       <mrow>        <mi>N</mi>        <mo>-</mo>        <mn>1</mn>       </mrow>       <mo>)</mo>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>[</mo>     <mrow>      <mi>Equation</mi>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mn>4</mn>     </mrow>     <mo>]</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0102" num="0097">The inverse quantized residual Q<sup>&#x2212;1</sup>(Q(r<sub>i,j</sub>)) is added to the intra block prediction value to produce the reconstructed sample value.</p><p id="p-0103" num="0098">The main benefit of this scheme is that the inverse BDPCM may be performed by simply adding the predictor instantaneously in parsing the coefficient or after parsing during coefficient parsing.</p><p id="p-0104" num="0099">As described above, the BDPCM may be applied to the quantized residual domain, and the quantized residual domain may include a quantized residual (or quantized residual coefficient). In this case, a transform skip may be applied to the residual. That is, for the residual sample, a transform may be skipped, but a quantization may be performed. Alternatively, the quantized residual domain may also include a quantized transform coefficient. A flag on whether the BDPCM is applicable may be signaled in a sequence level (SPS), and the flag may be signaled only when it is signaled that the transform skip mode is available in SPS.</p><p id="p-0105" num="0100">In applying the BDPCM, an intra prediction for the quantized residual domain may be performed for the entire block by the sample copy in a prediction direction (e.g., vertical prediction or horizontal prediction) similar to the intra prediction direction. The residual is quantized, and a delta value between the quantized residual and the predictor for a vertical or horizontal direction (i.e., quantized residual in the horizontal or vertical direction), that is, a differential value {tilde over (r)}<sub>i,j </sub>is coded.</p><p id="p-0106" num="0101">When a CU is coded in an intra prediction, the flag information indicating whether the BDPCM is applicable may be transmitted in a CU level. That is, the flag information indicates whether the conventional intra coding is applied or BDPCM is applied. When the BDPCM is applied, a BDPCM prediction direction flag indicating whether a prediction direction is a horizontal direction or vertical direction may be transmitted. Then, the block is predicted through the conventional horizontal or vertical intra prediction procedure using the unfiltered reference sample. The residual is quantized, and a difference value between each quantized residual and the predictor, for example, a quantized residual which is already quantized in a neighboring position in a horizontal or vertical direction along the BDPCM prediction direction is coded.</p><p id="p-0107" num="0102">In the case that the BDPCM is applicable, when a CU size is equal to or the same as MaxTsSize (maximum transform skip size) for a luma sample, and when a CU is coded in an intra prediction, the flag information may be transmitted in a CU level. Here, MaxTsSize means a maximum block size for which the transform skip mode is allowed.</p><p id="p-0108" num="0103">The syntax elements and the semantics therefor for the description above are represented in the following table as below.</p><p id="p-0109" num="0000"><tables id="TABLE-US-00001" num="00001"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="280pt" align="left"/><colspec colname="2" colwidth="35pt" align="left"/><thead><row><entry namest="1" nameend="2" rowsep="1">TABLE 1</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry/><entry>Descriptor</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>coding_unit( x0, y0, cbWidth, cbHeight, treeType ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;if( slice_type != I | | sps_ibc_enabled_flag ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if( treeType != DUAL_TREE_CHROMA &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;!( cbWidth = = 4 &#x26;&#x26; cbHeight = = 4 &#x26;&#x26; !sps_ibc_enabled_flag ) )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cu_skip_flag[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;if( cu_skip_flag[ x0 ][ y0 ] = = 0 &#x26;&#x26; slice_type != I</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x26;&#x26; !( cbWidth = = 4 &#x26;&#x26; cbHeight = = 4 ) )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;pred_mode_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;if( ( (slice_type = = I &#x26;&#x26; cu_skip_flag[ x0 ][ y0 ] = =0 ) | |</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;( slice_type = I &#x26;&#x26; ( CuPredMode[ x0 ][ y0 ] != MODE_INTRA | |</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;( cbWidth = = 4 &#x26;&#x26; cbHeight = = 4 &#x26;&#x26; cu_skip_flag[ x0 ][ y0 ] = = 0 ) ) ) ) &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;sps_ibc_enabled_flag &#x26;&#x26; ( cbWidth != 128 | | cbHeight != 128 ) )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;pred_mode_ibc_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;...</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;if( treeType = = SINGLE_TREE | | treeType = = DUAL_TREE_LUMA ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;if( cbWidth &#x3c;= 32 &#x26;&#x26; cbHeight &#x3c;= 32 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;intra_bdpcm_flag[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;if( intra_bdpcm_flag[ x0 ][ y0 ] )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;intra_bdpcm_dir_flag[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>...</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0110" num="0000"><tables id="TABLE-US-00002" num="00002"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="308pt" align="left"/><thead><row><entry namest="1" nameend="1" rowsep="1">TABLE 2</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>intra_bdpcm_flag[ x0 ][ y0 ] equal to 1 specifies that BDPCM is applied to the current luma coding</entry></row><row><entry>block at the location ( x0, y0 ), i.e. the transform is skipped, the intra luma prediction mode is</entry></row><row><entry>specified by intra_bdpcm_dir_flag[ x0 ][ y0 ]. intra_bdpcm_dir_flag[ x0 ][ y0 ] equal to 0 specifies that</entry></row><row><entry>BDPCM is not applied to the current luma coding block at the location ( x0, y0 ).</entry></row><row><entry>When intra_bdpcm_flag[ x0 ][ y0 ] is not present it is inferred to be equal to 0.</entry></row><row><entry>The variable BdpcmFlag[ x ][ y ] is set equal to intra_bdpcm_flag[ x0 ][ y0 ] for</entry></row><row><entry>x = x0..x0 + cbWidth &#x2212; 1 and y = y0..y0 + cbHeight &#x2212; 1.</entry></row><row><entry>intra_bdpcm_dir_flag[ x0 ][ y0 ] equal to 0 specifies that the BDPCM prediction direction is</entry></row><row><entry>horizontal. intra_bdpcm_dir_flag[ x0 ][ y0 ] equal to 1 specifies that the BDPCM prediction direction</entry></row><row><entry>is vertical.</entry></row><row><entry>The variable BdpcmDir[ x ][ y ] is set equal to intra_bdpcm_dir_flag[ x0 ][ y0 ] for</entry></row><row><entry>x = x0..x0 + cbWidth &#x2212; 1 and y = y0..y0 + cbHeight &#x2212; 1.</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0111" num="0104">The syntax element &#x201c;intra_bdpcm_flag&#x201d; in Table 1 represents whether the BDPCM is applied to a current luma coding block. When the &#x201c;intra_bdpcm_flag&#x201d; value is equal to 1, the transform for the coding block may be skipped, and the prediction mode for the coding block may be configured to a horizontal or vertical direction by &#x201c;intra_bdpcm_dir_flag&#x201d; that represents a prediction direction. When the &#x201c;intra_bdpcm_flag&#x201d; does not exist, the value is regarded as zero.</p><p id="p-0112" num="0105">In the case that the &#x201c;intra_bdpcm_dir_flag&#x201d; representing a prediction direction is zero, the case represents that a BDPCM prediction direction is a horizontal direction, and in the case that the &#x201c;intra_bdpcm_dir_flag&#x201d; value is 1, the case represents that a BDPCM prediction direction is a vertical direction.</p><p id="p-0113" num="0106">Meanwhile, as described above, an in-loop filtering procedure may be performed for a reconstructed picture. A modified reconstructed picture may be generated through the in-loop filtering procedure, and the modified reconstructed picture may be output as a decoded picture in the decoding apparatus. In addition, the modified reconstructed picture may be stored in the decoded picture buffer or the memory of the encoding apparatus/decoding apparatus and then, used as a reference picture in an inter prediction procedure in encoding/decoding a picture.</p><p id="p-0114" num="0107">The in-loop filtering procedure may include a deblocking filtering procedure, a sample adaptive offset (SAO) procedure, and/or an adaptive loop filter (ALF) procedure. In this case, one or a part of the deblocking filtering procedure, the sample adaptive offset (SAO) procedure, the adaptive loop filter (ALF) procedure, and a bi-lateral filter procedure may be sequentially applied, or all of them may be sequentially applied. For example, the deblocking filtering procedure may be applied to a reconstructed picture, and then, the SAO procedure may be performed. Alternatively, for example, after the deblocking filtering procedure is applied to a reconstructed picture, the ALF procedure may be performed. This may be performed in the encoding apparatus in the same manner.</p><p id="p-0115" num="0108">The deblocking filtering is a filtering scheme that removes a distortion occurred in a boundary between blocks in a reconstructed picture. According to the deblocking filtering procedure, a target boundary is derived in a reconstructed picture, a boundary strength (bS) for the target boundary is determined, and the deblocking filtering may be performed for the target boundary based on the bS. The bS may be determined based on prediction modes of two block modes adjacent to the target boundary, a motion vector difference, whether a reference picture is the same, the existence of non-zero valid coefficient, and the like.</p><p id="p-0116" num="0109">The SAO is a method for compensating an offset difference between a reconstructed picture and an original picture in a unit of sample and may be applied based on types such as a Band Offset, an Edge Offset, and the like. According to the SAO, samples may be classified into different categories depending on each SAO type, and an offset value may be added to each sample based on the category. The filtering information for the SAO may include information on whether the SAO is applied, SAO type information, SAO offset value information, and the like. The SAO may also be applied to a reconstructed picture after the deblocking filtering is applied.</p><p id="p-0117" num="0110">The adaptive loop filter (ALF) is a filtering scheme in a unit of sample based on filter coefficients according to a filter shape for a reconstructed picture. The encoding apparatus may determine whether the ALF is applied, an ALF shape, and/or an ALF filtering coefficient through a comparison between a reconstructed picture and an original picture and signal the result to the decoding apparatus. That is, the filtering information for the ALF may include information on whether the ALF is applied, ALF shape information, ALF filtering coefficient information, and the like. The ALF may also be applied to a reconstructed picture after the deblocking filtering is applied.</p><p id="p-0118" num="0111"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a control flowchart for describing a deblocking filtering procedure according to an embodiment.</p><p id="p-0119" num="0112">Deblocking filtering is applied to a reconstructed picture. Deblocking filtering is performed for each CU of the reconstructed picture in the same order of a decoding process. First, a vertical edge is filtered (horizontal filtering), and then, a horizontal edge is filtered (vertical filtering). Deblocking filtering may be applied to edges of all coding blocks or subblocks and edges of transform blocks of a picture. An output for deblocking filtering may be referred to as a modified reconstructed picture or a modified reconstructed sample/sample array.</p><p id="p-0120" num="0113">As shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>, the encoding apparatus and the decoding apparatus may derive a target boundary to be filtered in a reconstructed picture (step S<b>1400</b>).</p><p id="p-0121" num="0114">Thereafter, the encoding apparatus and the decoding apparatus may derive a boundary strength bS (step S<b>1410</b>).</p><p id="p-0122" num="0115">The bS may be determined based on two blocks that face the target boundary. For example, the bS may be determined based on the following table.</p><p id="p-0123" num="0000"><tables id="TABLE-US-00003" num="00003"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="315pt" align="left"/><thead><row><entry namest="1" nameend="3" rowsep="1">TABLE 3</entry></row><row><entry namest="1" nameend="3" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/><entry>- </entry><entry>The variable bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is derived as follows:</entry></row><row><entry/><entry>-</entry><entry>- If cIdx is equal to 0 and both samples p<sub>0 </sub>and q<sub>0 </sub>are in a coding block with</entry></row><row><entry/><entry/><entry>intra_bdpcm_flag equal to 1, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 0.</entry></row><row><entry/><entry>-</entry><entry>- Otherwise, if the sample p<sub>0 </sub>or q<sub>0 </sub>is in the coding block of a coding unit coded with intra</entry></row><row><entry/><entry/><entry>prediction mode, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 2.</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="329pt" align="left"/><tbody valign="top"><row><entry>- Otherwise, if the block edge is also a transform block edge and the sample p<sub>0 </sub>or q<sub>0 </sub>is in a coding</entry></row><row><entry>block with ciip_flag equal to 1, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 2.</entry></row><row><entry>- Otherwise, if the block edge is also a transform block edge and the sample p<sub>0 </sub>or q<sub>0 </sub>is in a transform</entry></row><row><entry>block which contains one or more non-zero transform coefficient levels, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 1.</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="315pt" align="left"/><tbody valign="top"><row><entry/><entry>-</entry><entry>- Otherwise, if the prediction mode of the coding subblock containing the sample p<sub>0 </sub>is</entry></row><row><entry/><entry/><entry>different from the prediction mode of the coding subblock containing the sample q<sub>0</sub>,</entry></row><row><entry/><entry/><entry>bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 1.</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="322pt" align="left"/><tbody valign="top"><row><entry/><entry>- Otherwise, if cIdx is equal to 0 and one or more of the following conditions are true, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is</entry></row><row><entry/><entry>set equal to 1:</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="315pt" align="left"/><tbody valign="top"><row><entry/><entry/><entry>- The coding subblock containing the sample p<sub>0 </sub>and the coding subblock containing the sample q<sub>0 </sub>are</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="322pt" align="left"/><tbody valign="top"><row><entry/><entry>both coded in IBC prediction mode, and the absolute difference between the horizontal or vertical</entry></row><row><entry/><entry>component of the motion vectors used in the prediction of the two coding subblocks is greater than or</entry></row><row><entry/><entry>equal to 4 in units of quarter luma samples.</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="315pt" align="left"/><tbody valign="top"><row><entry/><entry/><entry>- For the prediction of the coding subblock containing the sample p<sub>0 </sub>different reference pictures or a</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="322pt" align="left"/><tbody valign="top"><row><entry/><entry>different number of motion vectors are used than for the prediction of the coding subblock containing</entry></row><row><entry/><entry>the sample q<sub>0</sub>.</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="315pt" align="left"/><tbody valign="top"><row><entry/><entry/><entry>- One motion vector is used to predict the coding subblock containing the sample p<sub>0 </sub>and one motion</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="322pt" align="left"/><tbody valign="top"><row><entry/><entry>vector is used to predict the coding subblock containing the sample q<sub>0</sub>, and the absolute difference</entry></row><row><entry/><entry>between the horizontal or vertical component of the motion vectors used is greater than or equal to 4 in</entry></row><row><entry/><entry>units of quarter luma samples.</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="315pt" align="left"/><tbody valign="top"><row><entry/><entry/><entry>- Two motion vectors and two different reference pictures are used to predict the coding subblock</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="322pt" align="left"/><tbody valign="top"><row><entry/><entry>containing the sample p<sub>0</sub>, two motion vectors for the same two reference pictures are used to predict</entry></row><row><entry/><entry>the coding subblock containing the sample q<sub>0 </sub>and the absolute difference between the horizontal or</entry></row><row><entry/><entry>vertical component of the two motion vectors used in the prediction of the two coding subblocks for the</entry></row><row><entry/><entry>same reference picture is greater than or equal to 4 in units of quarter luma samples.</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="315pt" align="left"/><tbody valign="top"><row><entry/><entry/><entry>- Two motion vectors for the same reference picture are used to predict the coding subblock</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="322pt" align="left"/><tbody valign="top"><row><entry/><entry>containing the sample p<sub>0</sub>, two motion vectors for the same reference picture are used to predict the</entry></row><row><entry/><entry>coding subblock containing the sample q<sub>0 </sub>and both of the following conditions are true:</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="4"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="7pt" align="left"/><colspec colname="4" colwidth="308pt" align="left"/><tbody valign="top"><row><entry/><entry/><entry/><entry>- The absolute difference between the horizontal or vertical component of list 0 motion vectors used</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="322pt" align="left"/><tbody valign="top"><row><entry/><entry>in the prediction of the two coding subblocks is greater than or equal to 4 in quarter luma samples, or</entry></row><row><entry/><entry>the absolute difference between the horizontal or vertical component of the list 1 motion vectors used in</entry></row><row><entry/><entry>the prediction of the two coding subblocks is greater than or equal to 4 in units of quarter luma</entry></row><row><entry/><entry>samples.</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="4"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="7pt" align="left"/><colspec colname="4" colwidth="308pt" align="left"/><tbody valign="top"><row><entry/><entry/><entry/><entry>- The absolute difference between the horizontal or vertical component of list 0 motion vector used</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="322pt" align="left"/><tbody valign="top"><row><entry/><entry>in the prediction of the coding subblock containing the sample p<sub>0 </sub>and the list 1 motion vector used in</entry></row><row><entry/><entry>the prediction of the coding subblock containing the sample q<sub>0 </sub>is greater than or equal to 4 in units of</entry></row><row><entry/><entry>quarter luma samples, or the absolute difference between the horizontal or vertical component of the list</entry></row><row><entry/><entry>1 motion vector used in the prediction of the coding subblock containing the sample p<sub>0 </sub>and list 0</entry></row><row><entry/><entry>motion vector used in the prediction of the coding subblock containing the sample q<sub>0 </sub>is greater than or</entry></row><row><entry/><entry>equal to 4 in units of quarter luma samples.</entry></row><row><entry/><entry>- Otherwise, the variable bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 0.</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0124" num="0116">Here, p and q represent samples of two blocks that face the target boundary. For example, p<sub>0 </sub>may represent a sample of a left or top block that faces the target boundary, and q<sub>0 </sub>may represent a sample of a right or bottom block that faces the target boundary. In the case that an edge direction of the target boundary is vertical, p<sub>0 </sub>may represent a sample of a left block that faces the target boundary, and q<sub>0 </sub>may represent a sample of a right block that faces the target boundary. In the case that an edge direction of the target boundary is horizontal, p<sub>0 </sub>may represent a sample of a top block that faces the target boundary, and q<sub>0 </sub>may represent a sample of a bottom block that faces the target boundary.</p><p id="p-0125" num="0117">The encoding apparatus and the decoding apparatus may apply filtering based on the bS (step S<b>1420</b>).</p><p id="p-0126" num="0118">In the case that the bS value is zero, filtering is not applied to the target boundary. Filtering may be performed based on a filtering strength (strong or weak) and/or a filter length.</p><p id="p-0127" num="0119">Meanwhile, a filter strength according to a reconstructed average luma level may be derived as below. <figref idref="DRAWINGS">FIG. <b>5</b></figref> is a diagram illustrating samples located at a boundary of a block.</p><p id="p-0128" num="0120">In HEVC, a filter strength of deblocking filtering may be controlled by variables &#x3b2; and t<sub>C </sub>which are derived from an average quantization parameter qP<sub>L</sub>. In VVC, deblocking filtering may control a strength of deblocking filtering by adding an offset to qP<sub>L </sub>according to a luma level of a reconstructed average. The reconstructed luma level LL may be derived as represented in the following equation.</p><p id="p-0129" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>LL=((<i>p</i><sub>0,0</sub><i>+p</i><sub>0,3</sub><i>+q</i><sub>0,0</sub><i>+q</i><sub>0,3</sub>)&#x3e;&#x3e;2)/(1&#x3c;&#x3c;bitDepth)&#x2003;&#x2003;[Equation 5]<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0130" num="0121">Here, a position of sample values p<sub>i,k </sub>and q<sub>i,k </sub>in which i is 0 to 3, and k is 0 to 3 may be identified in <figref idref="DRAWINGS">FIG. <b>5</b></figref>.</p><p id="p-0131" num="0122">The variable qP<sub>L </sub>may be derived as represented in the following equation.</p><p id="p-0132" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>qP<sub>L</sub>=((Qp<sub>Q</sub>+Qp<sub>P</sub>+1)&#x3e;&#x3e;1)+qpOffset&#x2003;&#x2003;[Equation 6]<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0133" num="0123">Here, Q<sub>p</sub><sub><sup2>Q </sup2></sub>and Q<sub>p</sub><sub><sup2>P </sup2></sub>represent quantization parameters including samples q<sub>0,0 </sub>and p<sub>0,0</sub>, respectively, and the offset value qpOffset that depends on a transform procedure may be signaled in a sequence parameter set (SPS).</p><p id="p-0134" num="0124">Meanwhile, stronger filtering may be applied to a luma sample. In the case that a sample located at one side boundary belongs to a large block, a duplicated linear filter (stronger deblocking filter) may be applied. The sample that belongs to the large block may be defined as a sample that belongs to each boundary in the case that a width is equal to or greater than 32 for a vertical boundary or a height is equal to or greater than 32 for a horizontal boundary.</p><p id="p-0135" num="0125">Meanwhile, strong filtering for a chroma sample may be performed as represented in the following equation.</p><p id="p-0136" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i><sub>2</sub>&#x2032;=(3*<i>p</i><sub>3</sub>+2*<i>p</i><sub>2</sub><i>+p</i><sub>1</sub><i>+p</i><sub>0</sub><i>+q</i><sub>0</sub>+4)&#x3e;&#x3e;3<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0137" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i><sub>1</sub>&#x2032;=(2*<i>p</i><sub>3</sub><i>+p</i><sub>2</sub>+2*<i>p</i><sub>1</sub><i>+p</i><sub>0</sub><i>+q</i><sub>0</sub><i>+q</i><sub>1</sub>+4)&#x3e;&#x3e;3<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0138" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i><sub>0</sub>&#x2032;=(<i>p</i>3+<i>p</i>2+<i>p</i>1+2*<i>p</i>0+<i>q</i>0+<i>q</i>1+<i>q</i>2+4)&#x3e;&#x3e;3&#x2003;&#x2003;[Equation 7]<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0139" num="0126">Chroma filtering represented in Equation 7 is performed on an 8&#xd7;8 chroma sample grid. Strong filtering for a chroma sample may be performed in both sides of a block boundary. Here, chroma filtering may be selected in the case that both edges of the chroma sample are equal to or greater than 8 in a unit of chroma sample and performed in the case that a determination for the following three conditions is satisfied. First, a determination for a boundary strength (bS) and a large block, and the second and third determinations are a determination for filtering on/off and a determination for the strong filter, respectively, which are the same as the determinations for HEVC luma block, basically. An example of determining a boundary strength (bS) for a chroma block is as represented in the following table.</p><p id="p-0140" num="0000"><tables id="TABLE-US-00004" num="00004"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="4"><colspec colname="1" colwidth="126pt" align="left"/><colspec colname="2" colwidth="28pt" align="center"/><colspec colname="3" colwidth="35pt" align="center"/><colspec colname="4" colwidth="28pt" align="center"/><thead><row><entry namest="1" nameend="4" rowsep="1">TABLE 4</entry></row><row><entry namest="1" nameend="4" align="center" rowsep="1"/></row><row><entry/><entry>Y </entry><entry>U</entry><entry>V </entry></row><row><entry>Conditions</entry><entry>(luma)</entry><entry>(chroma)</entry><entry>(chroma)</entry></row><row><entry namest="1" nameend="4" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>At least one of the adjacent blocks is intra</entry><entry>2</entry><entry>2</entry><entry>2</entry></row><row><entry>At least one of the adjacent blocks has </entry><entry>1</entry><entry>1</entry><entry>1</entry></row><row><entry>non-zero transform coefficients</entry><entry/><entry/><entry/></row><row><entry>Absolute difference between the motion </entry><entry>1 </entry><entry>N/A</entry><entry>N/A</entry></row><row><entry>vectors that belong to the adjacent blocks </entry><entry/><entry/><entry/></row><row><entry>is greater than or equal to one integer luma </entry><entry/><entry/><entry/></row><row><entry>sample</entry><entry/><entry/><entry/></row><row><entry>Motion prediction in the adjacent blocks </entry><entry>1</entry><entry>N/A</entry><entry>N/A</entry></row><row><entry>refers to vectors is different</entry><entry/><entry/><entry/></row><row><entry>Otherwise</entry><entry>0 </entry><entry>0</entry><entry>0</entry></row><row><entry namest="1" nameend="4" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0141" num="0127">As represented in Table 4, deblocking for a chroma sample may be performing when the bS is equal to 2, or the bS is equal to 1 when a large block boundary is detected. The second and third conditions are basically the same as the strong filtering determination applied to an HEVC luma sample.</p><p id="p-0142" num="0128">In VVC, deblocking filter may be applied for a subblock boundary, and according to an example, deblocking filter may be performed on an 8&#xd7;8 grid. The deblocking filtering process may be applied to a CU boundary as well as the subblock boundary, which are aligned with an 8&#xd7;8 grid.</p><p id="p-0143" num="0129">The subblock boundary may include the prediction unit (PU) boundary introduced by a subblock-based temporal motion vector prediction (STMVP) and an affine mode, and the transform unit (TU) boundary introduced by a subblock transform (SBT) and an ISP (intra subpartitions) mode.</p><p id="p-0144" num="0130">For a subblock on an 8&#xd7;8 grid to which the SBT or the ISP are applied, the same procedure as the procedure applied in a TU deblocking filter of HEVC is applied. Deblocking filtering is applied to a TU boundary on an 8&#xd7;8 grid when there are non-zero coefficients in either one of subblock across an edge.</p><p id="p-0145" num="0131">For a subblock on an 8&#xd7;8 grid to which the STMVP and affine modes are applied, the same procedure as the procedure applied in a TU deblocking filter of HEVC is applied. Deblocking filtering is applied to a PU boundary on an 8&#xd7;8 grid with the consideration of the difference between motion vectors and reference pictures of a neighboring subblock.</p><p id="p-0146" num="0132">Hereinafter, among the in-loop filtering process for a block to which the BDPCM is applied, a deblocking filtering method may be proposed. In an example, in the process of encoding and decoding an image or a video, in the case that a luma block is coded in the BDPCM a single tree type, a boundary strength (bS) of a corresponding chroma block may be set as the same as the luma block. That is, in the case that a tree type is the single tree, in order to determine whether deblocking filtering is applied to a block coded in the BDPCM, when the bS is calculated, the bS for the chroma block may be determined as below.</p><p id="p-0147" num="0133"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a diagram illustrating a method for determining a bS according to an embodiment of the present disclosure.</p><p id="p-0148" num="0134">According to an example, in the case that two blocks are BDPCM coded based on an edge, a bS may be derived as zero. That is, for a chroma block, without regard to whether the BDPCM is applied, in the case that a corresponding luma block is BDPCM coded, the bS of the chroma block may be derived as zero in the single tree type.</p><p id="p-0149" num="0135">In <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the large block in the left side may represent a luma block, and the small blocks in the right side may represent chroma blocks according to components (Cb and Cr).</p><p id="p-0150" num="0136">As shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>, the bS in a block boundary may be determined according to a coding scheme of two neighboring luma blocks, and the bS of the chroma block may be set as the same as the bS of the luma block.</p><p id="p-0151" num="0137">The two neighboring luma blocks shown in the top side may be coded according to the BDPCM and the inter prediction, respectively, and in this case, the bS may be set to 1 or 0. In addition, the two neighboring luma blocks shown in the bottom side may be coded according to the BDPCM and the intra prediction, respectively, and in this case, the bS may also be set to 1 or 0. In both two cases, the bS of the chroma block may be set as the same as the bS of the luma block.</p><p id="p-0152" num="0138">In addition, in the case that both two neighboring luma blocks are coded in the BDPCM like the luma blocks shown in the middle, the bS for a boundary of the two blocks may be set to zero, and in this case, for the chroma block corresponding to the luma block, the bS for deblocking filtering may also be set to zero.</p><p id="p-0153" num="0139">Whether the luma block is coded in the BDPCM scheme may be signaled with flag information such as intra_bdpcm_flag represented in Table 1.</p><p id="p-0154" num="0140">As such, in the case that the bS is set to zero, deblocking filtering is not performed. That is, in the case that both two neighboring luma blocks are coded in the BDPCM scheme according to an embodiment, the bSs of the luma block and the chroma block are set to zero, and deblocking filtering is not performed.</p><p id="p-0155" num="0141">Such a bS determination method is as represented in the following table.</p><p id="p-0156" num="0000"><tables id="TABLE-US-00005" num="00005"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="280pt" align="center"/><thead><row><entry namest="1" nameend="1" rowsep="1">TABLE 5</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row><row><entry>1.1.1.1 Derivation process of boundary filtering strength</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="280pt" align="left"/><tbody valign="top"><row><entry>Inputs to this process are:</entry></row><row><entry>&#x2003;&#x2212; a picture sample array recPicture,</entry></row><row><entry>&#x2003;&#x2212; a location ( xCb, yCb ) specifying the top-left sample of the current coding block</entry></row><row><entry>&#x2003;&#x2003;relative to the top-left sample of the current picture.</entry></row><row><entry>&#x2003;&#x2212; a variable nCbW specifying the width of the current coding block,</entry></row><row><entry>&#x2003;&#x2212; a variable nCbH specifying the height of the current coding block,</entry></row><row><entry>&#x2003;&#x2212; a variable edgeType specifying whether a vertical (EDGE_VER) or a horizontal</entry></row><row><entry>&#x2003;&#x2003;(EDGE_HOR) edge is filtered,</entry></row><row><entry>&#x2003;&#x2212; a variable cIdx specifying the colour component of the current coding block,</entry></row><row><entry>&#x2003;&#x2212; a two-dimensional (nCbW)&#xd7;(nCbH) array edgeFlags.</entry></row><row><entry>Output of this process is a two-dimensional (nCbW)&#xd7;(nCbH) array bS specifying the boundary</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="231pt" align="left"/><colspec colname="2" colwidth="49pt" align="left"/><tbody valign="top"><row><entry>&#x2003;filtering strength.</entry><entry/></row><row><entry>The variables xD<sub>i</sub>, yD<sub>j</sub>, xN and yN are derived as follows:</entry><entry/></row><row><entry>&#x2003;&#x2212; If edgeType is equal to EDGE_VER,</entry><entry/></row><row><entry>&#x2003;&#x2003;xD<sub>j </sub>= ( i &#x3c;&#x3c; 3 )</entry><entry>(8-1026)</entry></row><row><entry>&#x2003;&#x2003;yD<sub>j </sub>= cIdx = = 0 ? ( j &#x3c;&#x3c; 2 ) :</entry><entry/></row><row><entry>&#x2003;&#x2003;( j &#x3c;&#x3c; 1 )</entry><entry>(8-1027)</entry></row><row><entry>&#x2003;&#x2003;xN is set equal to Max( 0, ( nCbW / 8 ) &#x2212; 1 )</entry><entry>(8-1028)</entry></row><row><entry>&#x2003;&#x2003;yN = cIdx = = 0 ? ( nCbH / 4 ) &#x2212; 1 : ( nCbH / 2 ) &#x2212; 1</entry><entry>(8-1029)</entry></row><row><entry>&#x2003;&#x2212; Otherwise (edgeType is equal to EDGE_HOR)</entry><entry/></row><row><entry>&#x2003;&#x2003;xD<sub>i </sub>= cIdx = = 0 ? ( i &#x3c;&#x3c; 2 ) :</entry><entry/></row><row><entry>&#x2003;&#x2003;( i &#x3c;&#x3c; 1 )</entry><entry>(8-1030)</entry></row><row><entry>&#x2003;&#x2003;yD<sub>j </sub>= ( j &#x3c;&#x3c; 3 )</entry><entry>(8-1031)</entry></row><row><entry>&#x2003;&#x2003;xN = cIdx = = 0 ? ( nCbW / 4 ) &#x2212; 1 : ( nCbW / 2 ) &#x2212; 1</entry><entry>(8-1032)</entry></row><row><entry>&#x2003;&#x2003;yN = Max( 0, ( nCbH / 8 ) &#x2212; 1 )</entry><entry>(8-1033)</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="280pt" align="left"/><tbody valign="top"><row><entry>&#x2003;&#x2003;For xD<sub>i </sub>with i = 0..xN and yD<sub>j </sub>with j = 0..yN, the following applies:</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2212; If edgeFlags[ xD<sub>i </sub>][ yD<sub>j </sub>] is equal to 0, the variable bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 0.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2212; Otherwise, the following applies:</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; The sample values p<sub>0 </sub>and q<sub>0 </sub>are derived as follows:</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; If edgeType is equal to EDGE_VER, p<sub>0 </sub>is set equal to</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;recPicture[ xCb + xD<sub>i </sub>&#x2212; 1 ][ yCb + yD<sub>j </sub>] and q<sub>0 </sub>is set equal to</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;recPicture[ xCb + xD<sub>i </sub>][ yCb + yD<sub>j </sub>]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; Otherwise (edgeType is equal to EDGE_HOR), p<sub>0 </sub>is set equal to</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;recPicture[ xCb + xD<sub>i </sub>][ yCb + yD<sub>j </sub>&#x2212; 1 ] and q<sub>0 </sub>is set equal to</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;recPicture[ xCb + xD<sub>i </sub>][ yCb + yD<sub>j </sub>]</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; The variable bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is derived as follows:</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; If both samples p<sub>0 </sub>and q<sub>0 </sub>are in a coding block with intra_bdpcm_flag equal</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;to 1, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 0.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; Otherwise, if the sample p<sub>0 </sub>or q<sub>0 </sub>is in the coding block of a coding unit</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;coded with intra prediction mode, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 2.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; Otherwise, if the block edge is also a transform block edge and the sample p<sub>0</sub></entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;or q<sub>0 </sub>is in a coding block with ciip_flag equal to 1, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;to 2.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; Otherwise, if the block edge is also a transform block edge and the sample p<sub>0 </sub>or</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;q<sub>0 </sub>is in a transform block which contains one or more non-zero transform</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;coefficient levels, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 1.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; Otherwise, if the prediction mode of the coding subblock containing the sample</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;p<sub>0 </sub>is different from the prediction mode of the coding subblock containing the</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;sample q<sub>0</sub>, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 1.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; Otherwise, if cIdx is equal to 0 and one or more of the following conditions are</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;true, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 1:</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; The coding subblock containing the sample p<sub>0 </sub>and the coding subblock</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;containing the sample q<sub>0 </sub>are both coded in IBC prediction mode, and the</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;absolute difference between the horizontal or vertical component of the motion</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;vectors used in the prediction of the two coding subblocks is greater than or</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;equal to 4 in units of quarter luma samples.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; For the prediction of the coding subblock containing the sample p<sub>0 </sub>different</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;reference pictures or a different number of motion vectors are used than for the</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;prediction of the coding subblock containing the sample q<sub>0</sub>.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; One motion vector is used to predict the coding subblock containing the sample</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;p<sub>0 </sub>and one motion vector is used to predict the coding subblock containing the</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;sample q<sub>0</sub>, and the absolute difference between the horizontal or vertical</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;component of the motion vectors used is greater than or equal to 4 in units of</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;quarter luma samples.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; Two motion vectors and two different reference pictures are used to predict the</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;coding subblock containing the sample p<sub>0</sub>, two motion vectors for the same two</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;reference pictures are used to predict the coding subblock containing the sample</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;q<sub>0 </sub>and the absolute difference between the horizontal or vertical component of</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;the two motion vectors used in the prediction of the two coding subblocks for the</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;same reference picture is greater than or equal to 4 in units of quarter luma</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;samples.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; Two motion vectors for the same reference picture are used to predict the coding</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;subblock containing the sample p0 two motion vectors for the same reference</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;picture are used to predict the coding subblock containing the sample q0 and</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;both of the following conditions are true:</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; The absolute difference between the horizontal or vertical component of list 0</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;motion vectors used in the prediction of the two coding subblocks is greater than</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;or equal to 4 in quarter luma samples, or the absolute difference between the</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;horizontal or vertical component of the list 1 motion vectors used in the</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;prediction of the two coding subblocks is greater than or equal to 4 in units of</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;quarter luma samples.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; The absolute difference between the horizontal or vertical component of list 0</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;motion vector used in the prediction of the coding subblock containing the</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;sample p<sub>0 </sub>and the list 1 motion vector used in the prediction of the coding</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;subblock containing the sample q<sub>0 </sub>is greater than or equal to 4 in units of quarter</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;luma samples, or the absolute difference between the horizontal or vertical</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;component of the list 1 motion vector used in the prediction of the coding</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;subblock containing the sample p<sub>0 </sub>and list 0 motion vector used in the prediction</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;of the coding subblock containing the sample q<sub>0 </sub>is greater than or equal to 4 in</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;units of quarter luma samples.</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2212; Otherwise, the variable bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 0.</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row><row><entry namest="1" nameend="1" align="left" id="FOO-00001">NOTE 1</entry></row><row><entry namest="1" nameend="1" align="left" id="FOO-00002">The determination of whether the reference pictures used for the two coding sublocks are the same or different is based only on which pictures are referenced, without regard to whether a prediction is formed using an index into reference picture list 0 or an index into reference picture list 1, and also without regard to whether the index position within a reference picture list is different.</entry></row><row><entry namest="1" nameend="1" align="left" id="FOO-00003">NOTE 2</entry></row><row><entry namest="1" nameend="1" align="left" id="FOO-00004">The number of motion vectors that are used for the prediction of a coding subblock with top-left sample covering ( xSb, ySb ) is equal to PredFlagL0[ xSb ][ ySb ] + PredFlagL1[ xSb ][ ySb ].</entry></row></tbody></tgroup></table></tables></p><p id="p-0157" num="0142">In Table 5, as described above, in the case that a target boundary is a vertical boundary, based on the target boundary, a left block may be indicated as P, and a right block may be indicated as Q. Further, in the case that a target boundary is a horizontal boundary, based on the target boundary, a top block may be indicated as P, and a bottom block may be indicated as Q.</p><p id="p-0158" num="0143">The variable bS[xDi][yDj] for the bS may be derived as one of 0, 1, and 2.</p><p id="p-0159" num="0144">As represented in Table 5, in the case that both samples p<sub>0 </sub>and q<sub>0 </sub>are in a coding block with intra_bdpcm_flag equal to 1, bS[xDi][yDj] is set equal to 0. In this case, deblocking filtering is not performed.</p><p id="p-0160" num="0145">Otherwise, in the case that the sample p<sub>0 </sub>or q<sub>0 </sub>is in the coding block of a coding unit coded with the intra prediction mode, bS[xDi][yDj] is set equal to 2.</p><p id="p-0161" num="0146">In addition, in the case that the block edge is also a transform block edge and the sample p<sub>0 </sub>or q<sub>0 </sub>is in a transform block which contains one or more non-zero transform coefficient levels, bS[xDi][yDj] is set equal to 1.</p><p id="p-0162" num="0147">Alternatively, in the case that two blocks are coded with different prediction modes or different reference picture or different number of motion vectors are used, bS[xDi][yDj] may be set equal to 1.</p><p id="p-0163" num="0148">Meanwhile, according to another example, bdpcm flag information may be signaled as represented in the following table.</p><p id="p-0164" num="0000"><tables id="TABLE-US-00006" num="00006"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="217pt" align="center"/><thead><row><entry namest="1" nameend="1" rowsep="1">TABLE 6</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>7.3.2.3 Sequence parameter set RBSP syntax</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="189pt" align="left"/><colspec colname="2" colwidth="28pt" align="left"/><tbody valign="top"><row><entry>sps_sao_enabled_flag</entry><entry>u(1)</entry></row><row><entry>sps_alf_enabled_flag</entry><entry>u(1)</entry></row><row><entry>if( sps_alf_enabled_flag &#x26;&#x26; ChromaArrayType != 0 )</entry><entry/></row><row><entry>&#x2003;sps_ccalf_enabled_flag</entry><entry>u(1)</entry></row><row><entry>sps_transform_skip_enabled_flag</entry><entry>u(1)</entry></row><row><entry>if( sps_transform_skip_enabled_flag ) {</entry><entry/></row><row><entry>&#x2003;log2_transform_skip_max_size_minus2</entry><entry>ue(v)</entry></row><row><entry>&#x2003;sps_bdpcm_enabled_flag</entry><entry>u(1)</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="217pt" align="center"/><tbody valign="top"><row><entry>7.4.3.3 Sequence parameter set RBSP semantics</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row><row><entry>sps_bdpcm_enabled_flag equal to 1 specifies that intra_bdpcm_luma_flag </entry></row><row><entry>and intra_bdpcm_chroma_flag may be present in the coding unit syntax for </entry></row><row><entry>intra coding units. sps_bdpcm_enabled_flag equal to 0 specifies that </entry></row><row><entry>intra_bdpcm_luma_flag and intra_bdpcm_chroma_flag are not present in </entry></row><row><entry>the coding unit syntax for intra coding units. When not present, the value</entry></row><row><entry>of sps_bdpcm_enabled_flag is inferred to be equal to 0.</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0165" num="0149">Table 6 represents &#x201c;sps_bdpcm_enabled_flag&#x201d; signaled in a sequence parameter set (SPS). In the case that the syntax element &#x201c;sps_bdpcm_enabled_flag&#x201d; is 1, the case represents that the flag information representing whether the BDPCM is applied to a coding unit for which the intra prediction is performed, that is, intra_bdpcm_luma_flag&#x201d; and &#x201c;intra_bdpcm_chroma_flag&#x201d; are present in the coding unit.</p><p id="p-0166" num="0150">In the case that the syntax element &#x201c;sps_bdpcm_enabled_flag&#x201d; is not present, the value is regarded as zero.</p><p id="p-0167" num="0000"><tables id="TABLE-US-00007" num="00007"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="280pt" align="center"/><thead><row><entry namest="1" nameend="1" rowsep="1">TABLE 7</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>7.3.10.5 Coding unit syntax</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="259pt" align="left"/><colspec colname="2" colwidth="21pt" align="left"/><tbody valign="top"><row><entry>&#x2003;&#x2003;if( sps_bdpcm_enabled_flag &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;cbWidth &#x3c;= MaxTsSize &#x26;&#x26; cbHeight &#x3c;= MaxTsSize )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_bdpcm_luma_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;if( intra_bdpcm_luma_flag )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_bdpcm_luma_dir_flag</entry><entry>ae(v)</entry></row><row><entry>if( ( treeType = = SINGLE_TREE | | treeType = = DUAL_TREE_CHROMA ) &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;ChromaArrayType != 0 ) {</entry><entry/></row><row><entry>&#x2003;if( pred_mode_plt_flag &#x26;&#x26; treeType = = DUAL_TREE_CHROMA )</entry><entry/></row><row><entry>&#x2003;&#x2003;palette_coding( x0, y0, cbWidth / SubWidthC, cbHeight / SubHeightC, treeType )</entry><entry/></row><row><entry>&#x2003;else if( !pred_mode_plt_flag ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;if( !cu_act_enabled_flag ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if( cbWidth / SubWithC &#x3c;= MaxTsSize &#x26;&#x26; cbHeight / SubHeigth &#x3c;= MaxTsSize</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x26;&#x26; sps_bdpcm_enabled_flag</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;intra_bdpcm_chroma_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;if( intra_bdpcm_chroma_flag )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;intra_bdpcm_chroma_dir_flag</entry><entry>ae(v)</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="280pt" align="center"/><tbody valign="top"><row><entry>7.4.11.5 Coding unit semantics</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row><row><entry>intra_bdpcm_luma_flag equal to 1 specifies that BDPCM is applied to the current luma coding</entry></row><row><entry>block at the location ( x0, y0 ), i.e. the transform is skipped, the intra luma prediction mode is</entry></row><row><entry>specified by intra_bdpcm_luma_dir_flag. intra_bdpcm_luma_flag equal to 0 specifies that </entry></row><row><entry>BDPCM is not applied to the current luma coding block at the location ( x0, y0 ).</entry></row><row><entry>When intra_bdpcm_luma_flag is not present it is inferred to be equal to 0.</entry></row><row><entry>The variable BdpcmFlag[ x ][ y ][ cIdx ] is set equal to intra bdpcm_luma_flag for</entry></row><row><entry>x = x0..x0 + cbWidth &#x2212; 1, y = y0..y0 + cbHeight &#x2212; 1 and cIdx = 0.</entry></row><row><entry>intra_bdpcm_luma_dir_flag equal to 0 specifies that the BDPCM prediction direction is </entry></row><row><entry>horizontal. intra_bdpcm_luma_dir_flag equal to 1 specifies that the BDPCM prediction </entry></row><row><entry>direction is vertical. The variable BdpcmDir[ x ][ y ][ cIdx ] is set equal to </entry></row><row><entry>intra_bdpcm_luma_dir_flag for x = x0..x0 + cbWidth &#x2212; 1, y = y0..y0 + cbHeight &#x2212; 1 and </entry></row><row><entry>cIdx = 0.</entry></row><row><entry>intra_bdpcm_chroma_flag equal to 1 specifies that BDPCM is applied to the current chroma</entry></row><row><entry>coding blocks at the location ( x0, y0 ), i.e the transform is skipped, the intra chroma prediction</entry></row><row><entry>mode is specified by intra_bdpcm_chroma_dir_flag, intra_bdpcm_chroma_flag equal to 0 </entry></row><row><entry>specifies that BDPCM is not applied to the current chroma coding blocks at the location ( x0, y0 ).</entry></row><row><entry>When intra_bdpcm_chroma_flag is not present it is inferred to be equal to 0.</entry></row><row><entry>The variable BdpcmFlag[ x ][ y ][ cIdx ] is set equal to intra_bdpcm_chroma_flag for</entry></row><row><entry>x = x0..x0 + cbWidth &#x2212; 1, y = y0..y0 + cbHeight &#x2212; 1 and cIdx = 1..2.</entry></row><row><entry>intra_bdpcm_chroma_dir_flag equal to 0 specifies that the BDPCM prediction direction is</entry></row><row><entry>horizontal, intra_bdpcm_chroma_dir_flag equal to 1 specifies that the BDPCM prediction </entry></row><row><entry>direction is vertical.</entry></row><row><entry>The variable BdpcmDir[ x ][ y ][ cIdx ] is set equal to intra_bdpcm_chroma_dir_flag for</entry></row><row><entry>x = x0..x0 + cbWidth &#x2212; 1, y = y0..y0 + cbHeight &#x2212; 1 and cIdx = 1..2.</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0168" num="0151">The syntax element &#x201c;intra_bdpcm_luma_flag&#x201d; and &#x201c;intra_bdpcm_chroma_flag&#x201d; represented in Table 6 represents whether the BDPCM is applied to a current luma coding block or a current chroma coding block. In the case that &#x201c;intra_bdpcm_luma_flag&#x201d; or &#x201c;intra_bdpcm_chroma_flag&#x201d; is 1, the transform for the coding block may be skipped, and a prediction mode for the coding block may be set in a horizontal or vertical direction by &#x201c;intra_bdpcm_luma_dir_flag&#x201d; or &#x201c;intra_bdpcm_chroma_dir_flag&#x201d; that represents a prediction direction. In the case that &#x201c;intra_bdpcm_luma_flag&#x201d; or &#x201c;intra_bdpcm_chroma_flag&#x201d; is not present, the value is regarded as zero.</p><p id="p-0169" num="0152">&#x201c;intra_bdpcm_chroma_flag&#x201d; may be signaled for a chroma coding block of which a current block is a single tree type or a dual tree chroma.</p><p id="p-0170" num="0153">In the case that &#x201c;intra_bdpcm_luma_dir_flag&#x201d; or &#x201c;intra_bdpcm_chroma_dir_flag&#x201d; that represents a prediction direction is zero, the case represents that a BDPCM prediction direction is a horizontal direction, and in the case that &#x201c;intra_bdpcm_luma_dir_flag&#x201d; or &#x201c;intra_bdpcm_chroma_dir_flag&#x201d; value is 1, the case represents that a BDPCM prediction direction is a vertical direction.</p><p id="p-0171" num="0154">A bS determination method according to the flag information represented in Table 6 and Table 7 is represented as below.</p><p id="p-0172" num="0000"><tables id="TABLE-US-00008" num="00008"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="343pt" align="left"/><thead><row><entry namest="1" nameend="1" rowsep="1">TABLE 8</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>For xD<sub>i </sub>with i = 0..xN and yD<sub>j </sub>with j = 0..yN, the following applies:</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="329pt" align="left"/><tbody valign="top"><row><entry/><entry>-</entry><entry>If edgeFlags[ xD<sub>i </sub>][ yD<sub>j </sub>] is equal to 0, the variable bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 0.</entry></row><row><entry/><entry>-</entry><entry>Otherwise, if edgeType is equal to EDGE_VER, VirtualBoundariesPresentFlag equal to 1, and ( xCb + xD<sub>i </sub>) is</entry></row><row><entry/><entry/><entry>equal to VirualBoundariesPosX[ n ] for any n = 0..NumVerVirtualBoundaries &#x2212; 1, the variable bS[ xD<sub>i </sub>][ yD<sub>j </sub>]</entry></row><row><entry/><entry/><entry>is set equal to 0.</entry></row><row><entry/><entry>-</entry><entry>Otherwise, if edgeType is equal to EDGE_HOR, VirtualBoundariesPresentFlag equal to 1, and ( yCb + yD<sub>j </sub>) is</entry></row><row><entry/><entry/><entry>equal to VirtualBoundariesPosY[ n ] for any n = 0..NumHorVirtualBoundaries &#x2212; 1, the variable bS[ xD<sub>i </sub>][ yD<sub>j </sub>]</entry></row><row><entry/><entry/><entry>is set equal to 0.</entry></row><row><entry/><entry>-</entry><entry>Otherwise, the following applies:</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="4"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="7pt" align="left"/><colspec colname="4" colwidth="322pt" align="left"/><tbody valign="top"><row><entry/><entry/><entry>-</entry><entry>The sample values p<sub>0 </sub>and q<sub>0 </sub>are derived as follows:</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="5"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="7pt" align="left"/><colspec colname="4" colwidth="7pt" align="left"/><colspec colname="5" colwidth="315pt" align="left"/><tbody valign="top"><row><entry/><entry/><entry/><entry>- </entry><entry>If edgeType is equal to EDGE_VER, p<sub>0 </sub>is set equal to recPicture[ xCb + xD<sub>i </sub>&#x2212; l ][ yCb + yD<sub>j </sub>] and q<sub>0</sub></entry></row><row><entry/><entry/><entry/><entry/><entry>is set equal to recPicture[ xCb + xD<sub>i </sub>][ yCb + yD<sub>j </sub>].</entry></row><row><entry/><entry/><entry/><entry>-</entry><entry>Otherwise&#x2003;(edgeType&#x2003;is&#x2003;equal&#x2003;to&#x2003;EDGE_HOR)&#x2003;p<sub>0</sub>&#x2003; is&#x2003;set&#x2003;equal&#x2003;to</entry></row><row><entry/><entry/><entry/><entry/><entry>recPicture[ xCb + xD<sub>i </sub>][ yCb + yD<sub>j </sub>&#x2212; 1 ] and q<sub>0 </sub>is set equal to recPicture[ xCb + xD<sub>i </sub>][ yCb &#x2212; yD<sub>j </sub>].</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="4"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="7pt" align="left"/><colspec colname="4" colwidth="322pt" align="left"/><tbody valign="top"><row><entry/><entry/><entry>-</entry><entry>The variable bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is derived as follows:</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="5"><colspec colname="1" colwidth="7pt" align="left"/><colspec colname="2" colwidth="7pt" align="left"/><colspec colname="3" colwidth="7pt" align="left"/><colspec colname="4" colwidth="7pt" align="left"/><colspec colname="5" colwidth="315pt" align="left"/><tbody valign="top"><row><entry/><entry/><entry/><entry>- </entry><entry>If cIdx is equal to 0 and both samples p<sub>0 </sub>and q<sub>0 </sub>are in a coding block with intra_bdpcm_luma_flag</entry></row><row><entry/><entry/><entry/><entry/><entry>equal to 1, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 0.</entry></row><row><entry/><entry/><entry/><entry>- </entry><entry>Otherwise, if cIdx is greater than 0 and both samples p<sub>0 </sub>and q<sub>0 </sub>are in a coding block with</entry></row><row><entry/><entry/><entry/><entry/><entry>intra_bdpcm_chroma_flag equal to 1, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 0.</entry></row><row><entry/><entry/><entry/><entry>- </entry><entry>Otherwise, if the sample p<sub>0 </sub>or q<sub>0 </sub>is in the coding block of a coding unit coded with CuPredMode equal</entry></row><row><entry/><entry/><entry/><entry/><entry>to MODE_INTRA, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 2.</entry></row><row><entry/><entry/><entry/><entry>- </entry><entry>Otherwise, if the block edge is also a coding block edge and the sample p<sub>0 </sub>or q<sub>0 </sub>is in a coding block</entry></row><row><entry/><entry/><entry/><entry/><entry>with ciip_flag equal to 1, bS[ xD<sub>i </sub>][ yD<sub>j </sub>] is set equal to 2.</entry></row><row><entry namest="1" nameend="5" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0173" num="0155">As represented in Table 8, according to an example, whether two neighboring luma blocks are coded in the BDPCM may be indicated by intra_bdpcm_luma_flag. In the case that intra_bdpcm_luma_flag value is 1, bS[xDi][yDj] for a luma block may be set to zero.</p><p id="p-0174" num="0156">In addition, whether two neighboring chroma blocks are coded in the BDPCM may be indicated by intra_bdpcm_chroma_flag. In the case that intra_bdpcm_chroma_flag is 1, bS[xDi][yDj] for a luma block may be set to zero.</p><p id="p-0175" num="0157">That is, the flag information for the BDPCM may be signaled for each of the luma block and the chroma block, and in the case that the flag value is 1, the bS for deblocking filtering may be set to zero. That is, for the block coded in the BDPCM scheme, deblocking filtering may not be performed.</p><p id="p-0176" num="0158">The following drawings are provided to describe specific examples of the present disclosure. Since the specific designations of devices or the designations of specific signals/messages/fields illustrated in the drawings are provided for illustration, technical features of the present disclosure are not limited to specific designations used in the following drawings.</p><p id="p-0177" num="0159"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a control flowchart for describing a video decoding method according to an embodiment of the present disclosure.</p><p id="p-0178" num="0160">The decoding apparatus <b>300</b> receives coding information such as BDPCM information from a bitstream (step S<b>710</b>).</p><p id="p-0179" num="0161">The BDPCM information may include BDPCM flag information that indicates whether the BDPCM is applied to a current block and directional information for a direction in which the BDPCM is performed.</p><p id="p-0180" num="0162">When the BDPCM is applied to the current block, the BDPCM flag value may be 1, and when the BDPCM is not applied to the current block, the BDPCM flag value may be zero.</p><p id="p-0181" num="0163">Meanwhile, a tree type of the current block may be classified into a single tree SINGLE_TREE or a dual tree DUAL_TREE according to whether a chroma block corresponding to a luma block has an individual partition structure. In the case that a chroma block has the same partition structure as a luma block, the case may represent the single tree, and in the case that a chroma component block has a different partition structure from a luma component block, the case may represent the dual tree. According to an example, the BDPCM may be individually applied to a luma block or a chroma block of the current block. When the BDPCM is applied to a luma block, a transform index for the luma block may not be received, and when the BDPCM is applied to a chroma block, a transform index for the chroma block may not be received.</p><p id="p-0182" num="0164">In the case that a tree structure of the current block is the dual tree, the BDPCM may be applied to only one component block, and even in the case that the current block is the single tree structure, the BDPCM may be applied to only one component block.</p><p id="p-0183" num="0165">Meanwhile, the directional information for the BDPCM may indicate a horizontal direction or a vertical direction. According to the directional information, quantization information may be derived, and a prediction sample may be derived.</p><p id="p-0184" num="0166">The decoding apparatus <b>300</b> may derive a quantized transform coefficient for the current block, that is, untransformed quantized residual samples based on the BDPCM and derive a residual sample by performing dequantization for the quantized residual samples (step S<b>720</b>).</p><p id="p-0185" num="0167">In the case the BDPCM is applied to the current block, the residual information received in the decoding apparatus <b>300</b> may a differential value of the quantized residuals. According to a BDPCM direction, a differential value of quantized residuals of a line of a previous vertical or horizontal direction and a specific line may be received, and the decoding apparatus <b>300</b> may add the quantized residuals of a line of a previous vertical or horizontal direction to the received differential value of quantized residuals and derive a quantized residual of a specific line. The quantized residual may be derived based on Equation 3 or Equation 4.</p><p id="p-0186" num="0168">As described above, when the BDPCM is applied to the current block, a dequantized transform coefficient may be derived as a residual sample without going through a transform procedure.</p><p id="p-0187" num="0169">The intra predictor <b>331</b> may perform an intra prediction for the current block based on the BDPCM information, that is, the directional information in which the BDPCM is performed and derive prediction samples (step S<b>730</b>).</p><p id="p-0188" num="0170">When the BDPCM is applied to the current block, an intra prediction may be performed using the BDPCM, and this may mean that the BDPCM may be applied only to an intra slice or intra coding block predicted in the intra mode.</p><p id="p-0189" num="0171">The intra prediction may be performed based on the directional information for the BDPCM, and the intra prediction mode of the current block may be either one of a horizontal directional mode or a vertical directional mode.</p><p id="p-0190" num="0172">The decoding apparatus <b>300</b> may generate a reconstructed picture based on the derived residual sample and the prediction sample (step S<b>740</b>).</p><p id="p-0191" num="0173">The decoding apparatus <b>300</b> may perform deblocking filtering, which is one of in-loop filtering methods based on the BDPCM information, for the reconstructed picture (step S<b>750</b>). In this case, when BDPCM flag information is 1, the boundary strength (bS) is derived as zero, and deblocking filtering may not be performed.</p><p id="p-0192" num="0174">According to an example, in the case that a luma block is coded in the BDPCM in the single tree type, the boundary strength (bS) of a corresponding chroma block may be set as the same as the luma block.</p><p id="p-0193" num="0175">In the case that two blocks are BDPCM coded based on an edge between blocks, the bS may be derived as zero. That is, for a chroma block, without regard to whether the BDPCM is applied, in the case that a corresponding luma block is BDPCM coded, the bS of the chroma block may be derived as zero in the single tree type.</p><p id="p-0194" num="0176">As such, in the case that the bS is set to zero, deblocking filtering is not performed. That is, in the case that both two neighboring luma blocks are coded in the BDPCM scheme according to an embodiment, the bSs of the luma block and the chroma block are set to zero, and deblocking filtering is not performed.</p><p id="p-0195" num="0177">Alternatively, according to another example, whether two neighboring luma blocks are coded in the BDPCM may be indicated by intra_bdpcm_luma_flag. In the case that intra_bdpcm_luma_flag value is 1, bS[xDi][yDj] for a luma block may be set to zero. In addition, whether two neighboring chroma blocks are coded in the BDPCM may be indicated by intra_bdpcm_chroma_flag. In the case that intra_bdpcm_chroma_flag is 1, bS [xDi][yDj] for a luma block may be set to zero.</p><p id="p-0196" num="0178">That is, the flag information for the BDPCM may be signaled for each of the luma block and the chroma block, and in the case that the flag value is 1, the bS for deblocking filtering may be set to zero. That is, for the block coded in the BDPCM scheme, deblocking filtering may not be performed.</p><p id="p-0197" num="0179">In summary, the BDPCM information received in the decoding apparatus may include flag information indicating whether the BDPCM is applied to the current block, and when the flag information is 1, the boundary strength (bS) for deblocking filtering may be derived as zero.</p><p id="p-0198" num="0180">In this case, the current block may be either one of a luma coding block or a chroma coding block, and in the case that a tree type of the current block is the single tree type and a chroma coding block, when the flag information is 1, the boundary strength may be derived as 1.</p><p id="p-0199" num="0181">The following drawings are provided to describe specific examples of the present disclosure. Since the specific designations of devices or the designations of specific signals/messages/fields illustrated in the drawings are provided for illustration, technical features of the present disclosure are not limited to specific designations used in the following drawings.</p><p id="p-0200" num="0182"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a control flowchart for describing a video encoding method according to an embodiment of the present disclosure.</p><p id="p-0201" num="0183">The encoding apparatus <b>200</b> may derive prediction samples for a current block based on the BDPCM (step S<b>810</b>).</p><p id="p-0202" num="0184">The encoding apparatus <b>200</b> may derive an intra prediction sample for the current block based on a specific direction in which the BDPCM is performed. The specific direction may be a vertical direction or a horizontal direction, and according to the intra prediction mode, a prediction sample for the current block may be generated.</p><p id="p-0203" num="0185">Meanwhile, a tree type of the current block may be classified into a single tree SINGLE_TREE or a dual tree DUAL_TREE according to whether a chroma block corresponding to a luma block has an individual partition structure. In the case that a chroma block has the same partition structure as a luma block, the case may represent the single tree, and in the case that a chroma component block has a different partition structure from a luma component block, the case may represent the dual tree. According to an example, the BDPCM may be individually applied to a luma block or a chroma block of the current block.</p><p id="p-0204" num="0186">In the case that a tree structure of the current block is the dual tree, the BDPCM may be applied to only one component block, and even in the case that the current block is the single tree structure, the BDPCM may be applied to only one component block.</p><p id="p-0205" num="0187">Alternatively, according to an example, the BDPCM may be applied only in the case that a width of the current block is a first threshold value or smaller and a height of the current block is a second threshold value or smaller. The first threshold value and the second threshold value may be 32 and set to a maximum height or a maximum width of a transform block in which transform is performed.</p><p id="p-0206" num="0188">The encoding apparatus <b>200</b> may derive residual samples for the current block based on a prediction block (step S<b>820</b>) and generate a reconstructed picture based on the residual sample and the prediction sample (step S<b>830</b>).</p><p id="p-0207" num="0189">The encoding apparatus <b>200</b> may perform deblocking filtering, which is one of in-loop filtering methods based on the BDPCM information, for the reconstructed picture (step S<b>840</b>). In this case, when BDPCM flag information is 1, the boundary strength (bS) is derived as zero, and deblocking filtering may not be performed.</p><p id="p-0208" num="0190">According to an example, in the case that a luma block is coded in the BDPCM in the single tree type, the boundary strength (bS) of a corresponding chroma block may be set as the same as the luma block.</p><p id="p-0209" num="0191">In the case that two blocks are BDPCM coded based on an edge between blocks, the bS may be derived as zero. That is, for a chroma block, without regard to whether the BDPCM is applied, in the case that a corresponding luma block is BDPCM coded, the bS of the chroma block may be derived as zero in the single tree type.</p><p id="p-0210" num="0192">As such, in the case that the bS is set to zero, deblocking filtering is not performed. That is, in the case that both two neighboring luma blocks are coded in the BDPCM scheme according to an embodiment, the bSs of the luma block and the chroma block are set to zero, and deblocking filtering is not performed.</p><p id="p-0211" num="0193">Alternatively, according to another example, according to whether two luma blocks are coded in the BDPCM, bS[xDi][yDj] for a luma block may be derived as zero, and according to whether two chroma blocks are coded in the BDPCM, bS[xDi][yDj] for a chroma block may be derived as zero.</p><p id="p-0212" num="0194">In addition, the flag information for the BDPCM may be coded for each of the luma block and the chroma block, and in the case that the flag value is 1, the bS for deblocking filtering may be set to zero. That is, for the block coded in the BDPCM scheme, deblocking filtering may not be performed.</p><p id="p-0213" num="0195">Thereafter, the encoding apparatus <b>200</b> may derive quantized residual information based on the BDPCM.</p><p id="p-0214" num="0196">The encoding apparatus <b>200</b> may derive a quantized residual sample of a specific line and a differential value of a quantized residual sample of a line of a previous vertical or horizontal direction and a specific line as the quantized residual information. That is, a differential value of a quantized residual, not the conventional residual, is generated as the residual information, which may be derived based on Equation 1 or Equation 2.</p><p id="p-0215" num="0197">The encoding apparatus <b>200</b> may encode the quantized residual information and coding information for the current block, for example, the BDPCM information for the BDPCM (step S<b>850</b>).</p><p id="p-0216" num="0198">The BDPCM information may include BDPCM flag information that indicates whether the BDPCM is applied to a current block and directional information for a direction in which the BDPCM is performed.</p><p id="p-0217" num="0199">When the BDPCM is applied to the current block, the BDPCM flag value may be encoded to 1, and when the BDPCM is not applied to the current block, the BDPCM flag value may be encoded to zero.</p><p id="p-0218" num="0200">In addition, as described above, in the case that a tree structure of the current block is the dual tree, the BDPCM may be applied to only one component block, and even in the case that the current block is the single tree structure, the BDPCM may be applied to only one component block.</p><p id="p-0219" num="0201">The directional information for the BDPCM may indicate a horizontal direction or a vertical direction.</p><p id="p-0220" num="0202">In the present disclosure, at least one of quantization/dequantization and/or transform/inverse transform may be omitted. When quantization/dequantization is omitted, a quantized transform coefficient may be referred to as a transform coefficient. When transform/inverse transform is omitted, the transform coefficient may be referred to as a coefficient or a residual coefficient, or may still be referred to as a transform coefficient for consistency of expression.</p><p id="p-0221" num="0203">In addition, in the present disclosure, a quantized transform coefficient and a transform coefficient may be referred to as a transform coefficient and a scaled transform coefficient, respectively. In this case, residual information may include information on a transform coefficient(s), and the information on the transform coefficient(s) may be signaled through a residual coding syntax. Transform coefficients may be derived based on the residual information (or information on the transform coefficient(s)), and scaled transform coefficients may be derived through inverse transform (scaling) of the transform coefficients. Residual samples may be derived based on the inverse transform (transform) of the scaled transform coefficients. These details may also be applied/expressed in other parts of the present disclosure.</p><p id="p-0222" num="0204">In the above-described embodiments, the methods are explained on the basis of flowcharts by means of a series of steps or blocks, but the present disclosure is not limited to the order of steps, and a certain step may be performed in order or step different from that described above, or concurrently with another step. Further, it may be understood by a person having ordinary skill in the art that the steps shown in a flowchart are not exclusive, and that another step may be incorporated or one or more steps of the flowchart may be removed without affecting the scope of the present disclosure.</p><p id="p-0223" num="0205">The above-described methods according to the present disclosure may be implemented as a software form, and an encoding apparatus and/or decoding apparatus according to the disclosure may be included in a device for image processing, such as, a TV, a computer, a smartphone, a set-top box, a display device or the like.</p><p id="p-0224" num="0206">When embodiments in the present disclosure are embodied by software, the above-described methods may be embodied as modules (processes, functions or the like) to perform the above-described functions. The modules may be stored in a memory and may be executed by a processor. The memory may be inside or outside the processor and may be connected to the processor in various well-known manners. The processor may include an application-specific integrated circuit (ASIC), other chipset, logic circuit, and/or a data processing device. The memory may include a read-only memory (ROM), a random access memory (RAM), a flash memory, a memory card, a storage medium, and/or other storage device. That is, embodiments described in the present disclosure may be embodied and performed on a processor, a microprocessor, a controller or a chip. For example, function units shown in each drawing may be embodied and performed on a computer, a processor, a microprocessor, a controller or a chip.</p><p id="p-0225" num="0207">Further, the decoding apparatus and the encoding apparatus to which the present disclosure is applied, may be included in a multimedia broadcasting transceiver, a mobile communication terminal, a home cinema video device, a digital cinema video device, a surveillance camera, a video chat device, a real time communication device such as video communication, a mobile streaming device, a storage medium, a camcorder, a video on demand (VoD) service providing device, an over the top (OTT) video device, an Internet streaming service providing device, a three-dimensional (3D) video device, a video telephony video device, and a medical video device, and may be used to process a video signal or a data signal. For example, the over the top (OTT) video device may include a game console, a Blu-ray player, an Internet access TV, a Home theater system, a smartphone, a Tablet PC, a digital video recorder (DVR) and the like.</p><p id="p-0226" num="0208">In addition, the processing method to which the present disclosure is applied, may be produced in the form of a program executed by a computer, and be stored in a computer-readable recording medium. Multimedia data having a data structure according to the present disclosure may also be stored in a computer-readable recording medium. The computer-readable recording medium includes all kinds of storage devices and distributed storage devices in which computer-readable data are stored. The computer-readable recording medium may include, for example, a Blu-ray Disc (BD), a universal serial bus (USB), a ROM, a PROM, an EPROM, an EEPROM, a RAM, a CD-ROM, a magnetic tape, a floppy disk, and an optical data storage device. Further, the computer-readable recording medium includes media embodied in the form of a carrier wave (for example, transmission over the Internet). In addition, a bitstream generated by the encoding method may be stored in a computer-readable recording medium or transmitted through a wired or wireless communication network. Additionally, the embodiments of the present disclosure may be embodied as a computer program product by program codes, and the program codes may be executed on a computer by the embodiments of the present disclosure. The program codes may be stored on a computer-readable carrier.</p><p id="p-0227" num="0209"><figref idref="DRAWINGS">FIG. <b>9</b></figref> illustrates the structure of a content streaming system to which the present disclosure is applied.</p><p id="p-0228" num="0210">Further, the contents streaming system to which the present disclosure is applied may largely include an encoding server, a streaming server, a web server, a media storage, a user equipment, and a multimedia input device.</p><p id="p-0229" num="0211">The encoding server functions to compress to digital data the contents input from the multimedia input devices, such as the smart phone, the camera, the camcoder and the like, to generate a bitstream, and to transmit it to the streaming server. As another example, in a case where the multimedia input device, such as, the smart phone, the camera, the camcoder or the like, directly generates a bitstream, the encoding server may be omitted. The bitstream may be generated by an encoding method or a bitstream generation method to which the present disclosure is applied. And the streaming server may store the bitstream temporarily during a process to transmit or receive the bitstream.</p><p id="p-0230" num="0212">The streaming server transmits multimedia data to the user equipment on the basis of a user's request through the web server, which functions as an instrument that informs a user of what service there is. When the user requests a service which the user wants, the web server transfers the request to the streaming server, and the streaming server transmits multimedia data to the user. In this regard, the contents streaming system may include a separate control server, and in this case, the control server functions to control commands/responses between respective equipments in the content streaming system.</p><p id="p-0231" num="0213">The streaming server may receive contents from the media storage and/or the encoding server. For example, in a case the contents are received from the encoding server, the contents may be received in real time. In this case, the streaming server may store the bitstream for a predetermined period of time to provide the streaming service smoothly.</p><p id="p-0232" num="0214">For example, the user equipment may include a mobile phone, a smart phone, a laptop computer, a digital broadcasting terminal, a personal digital assistant (PDA), a portable multimedia player (PMP), a navigation, a slate PC, a tablet PC, an ultrabook, a wearable device (e.g., a watch-type terminal (smart watch), a glass-type terminal (smart glass), a head mounted display (HMD)), a digital TV, a desktop computer, a digital signage or the like. Each of servers in the contents streaming system may be operated as a distributed server, and in this case, data received by each server may be processed in distributed manner.</p><p id="p-0233" num="0215">Claims disclosed herein can be combined in a various way. For example, technical features of method claims of the present disclosure can be combined to be implemented or performed in an apparatus, and technical features of apparatus claims can be combined to be implemented or performed in a method. Further, technical features of method claims and apparatus claims can be combined to be implemented or performed in an apparatus, and technical features of method claims and apparatus claims can be combined to be implemented or performed in a method.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001" nb-file="US20230007268A1-20230105-M00001.NB"><img id="EMI-M00001" he="6.35mm" wi="76.20mm" file="US20230007268A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00002" nb-file="US20230007268A1-20230105-M00002.NB"><img id="EMI-M00002" he="6.69mm" wi="76.20mm" file="US20230007268A1-20230105-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00003" nb-file="US20230007268A1-20230105-M00003.NB"><img id="EMI-M00003" he="8.13mm" wi="76.20mm" file="US20230007268A1-20230105-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00004" nb-file="US20230007268A1-20230105-M00004.NB"><img id="EMI-M00004" he="8.13mm" wi="76.20mm" file="US20230007268A1-20230105-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><claims id="claims"><claim id="CLM-01-14" num="01-14"><claim-text><b>1</b>-<b>14</b>. (canceled)</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. A video decoding method performed by a decoding apparatus, the method comprising:<claim-text>obtaining Block-based Delta Pulse Code Modulation (BDPCM) flag information from a bitstream;</claim-text><claim-text>deriving quantized transform coefficients for a current block based on the BDPCM flag information;</claim-text><claim-text>deriving residual samples for the current block by performing a dequantization for the quantized transform coefficients;</claim-text><claim-text>deriving prediction samples for the current block based on the BDPCM flag information;</claim-text><claim-text>generating a reconstructed picture based on the residual samples and the prediction samples;</claim-text><claim-text>deriving a boundary strength (bS) for a target boundary of the current block in the reconstructed picture;</claim-text><claim-text>determining whether deblocking filtering is applied to the target boundary based on the bS; and</claim-text><claim-text>performing the deblocking filtering on the reconstructed picture based on a result of the determination,</claim-text><claim-text>wherein the bS for the target boundary is derived based on the BDPCM flag information,</claim-text><claim-text>wherein a tree type of the current block is a single tree type, and the current block is a chroma coding block, and</claim-text><claim-text>wherein based on a value of the BDPCM flag information being 1, the bS for the target boundary of the chroma coding block is derived as 0.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The video decoding method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the BDPCM flag information is related to whether a BDPCM is applied to the current block,<claim-text>wherein based on the BDPCM being applied to the current block, the value of the BDPCM flag information is 1, and</claim-text><claim-text>wherein based on the BDPCM being not applied to the current block, the value of the BDPCM flag information is 0.</claim-text></claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The video decoding method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein based on the bS for the target boundary being 0, the deblocking filtering is not applied to the target boundary.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The video decoding method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the quantized transform coefficient is derived based on directional information for a direction in which the BDPCM is performed.</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The video decoding method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein an intra prediction sample for the current block is derived based on a direction in which the BDPCM is performed.</claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. A video encoding method performed by an encoding apparatus, the method comprising:<claim-text>deriving prediction samples for a current block based on a Block-based Delta Pulse Code Modulation (BDPCM);</claim-text><claim-text>deriving residual samples for the current block based on the prediction samples;</claim-text><claim-text>generating a reconstructed picture based on the residual samples and the prediction samples;</claim-text><claim-text>deriving a boundary strength (bS) for a target boundary of the current block in the reconstructed picture;</claim-text><claim-text>determining whether deblocking filtering is applied to the target boundary based on the bS;</claim-text><claim-text>performing the deblocking filtering on the reconstructed picture based on a result of the determination;</claim-text><claim-text>generating quantized residual information by performing a quantization for the residual samples based on the BDPCM; and</claim-text><claim-text>encoding the quantized residual information and BDPCM flag information for the BDPCM,</claim-text><claim-text>wherein the bS for the target boundary is derived based on the BDPCM flag information,</claim-text><claim-text>wherein a tree type of the current block is a single tree type, and the current block is a chroma coding block, and</claim-text><claim-text>wherein based on a value of the BDPCM flag information being 1, the bS for the target boundary of the chroma coding block is derived as 0.</claim-text></claim-text></claim><claim id="CLM-00021" num="00021"><claim-text><b>21</b>. The video encoding method of <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein the BDPCM flag information is related to whether the BDPCM is applied to the current block,<claim-text>wherein based on the BDPCM being applied to the current block, the value of the BDPCM flag information is 1, and</claim-text><claim-text>wherein based on the BDPCM being not applied to the current block, the value of the BDPCM flag information is 0.</claim-text></claim-text></claim><claim id="CLM-00022" num="00022"><claim-text><b>22</b>. The video encoding method of <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein based on the bS for the target boundary being 0, the deblocking filtering is not applied to the target boundary.</claim-text></claim><claim id="CLM-00023" num="00023"><claim-text><b>23</b>. The video encoding method of <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein an intra prediction sample for the current block is derived based on a specific direction in which the BDPCM is performed, and<claim-text>wherein the quantization for the residual samples is performed based on the specific direction.</claim-text></claim-text></claim><claim id="CLM-00024" num="00024"><claim-text><b>24</b>. A non-transitory computer-readable digital storage medium storing a bitstream generated by a video encoding method, the method steps of:<claim-text>deriving prediction samples for a current block based on a Block-based Delta Pulse Code Modulation (BDPCM);</claim-text><claim-text>deriving residual samples for the current block based on the prediction samples;</claim-text><claim-text>generating a reconstructed picture based on the residual samples and the prediction samples;</claim-text><claim-text>deriving a boundary strength (bS) for a target boundary of the current block in the reconstructed picture;</claim-text><claim-text>determining whether deblocking filtering is applied to the target boundary based on the bS;</claim-text><claim-text>performing the deblocking filtering on the reconstructed picture based on a result of the determination;</claim-text><claim-text>generating quantized residual information by performing a quantization for the residual samples based on the BDPCM; and</claim-text><claim-text>encoding the quantized residual information and BDPCM flag information for the BDPCM to output the bitstream,</claim-text><claim-text>wherein the bS for the target boundary is derived based on the BDPCM flag information,</claim-text><claim-text>wherein a tree type of the current block is a single tree type, and the current block is a chroma coding block, and</claim-text><claim-text>wherein based on a value of the BDPCM flag information being 1, the bS for the target boundary of the chroma coding block is derived as 0.</claim-text></claim-text></claim><claim id="CLM-00025" num="00025"><claim-text><b>25</b>. A transmission method of data for a video, the method comprising:<claim-text>obtaining a bitstream for the video, wherein the bitstream is generated based on deriving prediction samples for a current block based on a Block-based Delta Pulse Code Modulation (BDPCM), deriving residual samples for the current block based on the prediction samples, generating a reconstructed picture based on the residual samples and the prediction samples, deriving a boundary strength (bS) for a target boundary of the current block in the reconstructed picture, determining whether deblocking filtering is applied to the target boundary based on the bS, performing the deblocking filtering on the reconstructed picture based on a result of the determination, generating quantized residual information by performing a quantization for the residual samples based on the BDPCM, and encoding the quantized residual information and BDPCM flag information for the BDPCM; and</claim-text><claim-text>transmitting the data comprising the bitstream,</claim-text><claim-text>wherein the bS for the target boundary is derived based on the BDPCM flag information,</claim-text><claim-text>wherein a tree type of the current block is a single tree type, and the current block is a chroma coding block, and</claim-text><claim-text>wherein based on a value of the BDPCM flag information being 1, the bS for the target boundary of the chroma coding block is derived as 0.</claim-text></claim-text></claim></claims></us-patent-application>