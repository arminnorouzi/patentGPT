<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230001935A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230001935</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17857805</doc-number><date>20220705</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="regional"><country>EP</country><doc-number>21183752.1</doc-number><date>20210705</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>B</section><class>60</class><subclass>W</subclass><main-group>50</main-group><subgroup>00</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>B</section><class>60</class><subclass>W</subclass><main-group>50</main-group><subgroup>0097</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>B</section><class>60</class><subclass>W</subclass><main-group>2520</main-group><subgroup>10</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>B</section><class>60</class><subclass>W</subclass><main-group>2720</main-group><subgroup>30</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>B</section><class>60</class><subclass>W</subclass><main-group>2520</main-group><subgroup>14</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>B</section><class>60</class><subclass>W</subclass><main-group>2520</main-group><subgroup>28</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>B</section><class>60</class><subclass>W</subclass><main-group>2540</main-group><subgroup>10</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>B</section><class>60</class><subclass>W</subclass><main-group>2540</main-group><subgroup>12</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>B</section><class>60</class><subclass>W</subclass><main-group>2050</main-group><subgroup>0028</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>B</section><class>60</class><subclass>W</subclass><main-group>30</main-group><subgroup>18172</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">CONTROLLING MOTION OF A VEHICLE</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="obligated-assignee"><addressbook><orgname>Rimac Automobiles Ltd.</orgname><address><city>Sveta Nedelja</city><country>HR</country></address></addressbook><residence><country>HR</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Hrvatinic</last-name><first-name>Kruno</first-name><address><city>Zagreb</city><country>HR</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Iles</last-name><first-name>Sandor</first-name><address><city>Zagreb</city><country>HR</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Krishnakumar</last-name><first-name>Ajinkya</first-name><address><city>Zagreb</city><country>HR</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>Matusko</last-name><first-name>Jadranko</first-name><address><city>Zagreb</city><country>HR</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>Spahija</last-name><first-name>Bojan</first-name><address><city>Zagreb</city><country>HR</country></address></addressbook></inventor><inventor sequence="05" designation="us-only"><addressbook><last-name>Svec</last-name><first-name>Marko</first-name><address><city>Sveta Nedjelja</city><country>HR</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A method for controlling motion of a vehicle, the method comprising the steps of: obtaining input information on a vector related to the velocity of said vehicle; computing repeatably a future trajectory of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; and applying the obtained target trial torques to the at least one wheel for controlling the motion of said vehicle.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="69.77mm" wi="154.09mm" file="US20230001935A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="138.01mm" wi="156.13mm" file="US20230001935A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="137.08mm" wi="156.80mm" file="US20230001935A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="155.53mm" wi="80.77mm" file="US20230001935A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">TECHNICAL FIELD</heading><p id="p-0002" num="0001">The present invention relates to controlling motion of a vehicle.</p><heading id="h-0002" level="1">TECHNICAL BACKGROUND</heading><p id="p-0003" num="0002">Conventionally, steering a vehicle according to the commands given by the driver and controlling the vehicle in case the vehicle risks to get off course due to skidding or a high yaw rate are taken care of separately. While such an approach might provide advantages in some scenarios or might even be required in some cases, this is by no means a necessity. In fact, such a modular approach in driving the vehicle as desired by the driver and keeping the vehicle on course are almost independent from each other, but definitely not considered as two aspects of the same concept, makes it impossible to realize a vehicle motion control in which the synergistic capabilities of combining the various aspects of motion of a vehicle are used.</p><p id="p-0004" num="0003">However, with the advent of vehicles that are driven entirely electrically, these concepts may be overturned and replaced by a more holistic approach in which such a synergistic combination can be realized.</p><p id="p-0005" num="0004">Moreover, in conventional approaches the steering of the vehicle is oftentimes exclusively based on feedback control, that is, past data is considered and only differences between measured and desired values are used to control the motion of the vehicle. However, this approach has the clear disadvantage that it is a merely reactive approach without any proactive aspect to it that would allow to include predictions about the possible future trajectory of the vehicle to influence the control of the motion.</p><heading id="h-0003" level="1">SUMMARY</heading><p id="p-0006" num="0005">The above problems are solved by the subject-matter of the independent claims. Further preferred embodiments are given by the subject-matter of the dependent claims.</p><p id="p-0007" num="0006">According to an embodiment of the present invention, there is provided a method for controlling motion of a vehicle, the method comprising the steps of: obtaining input information on a vector related to the velocity of said vehicle; computing repeatably a future trajectory of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; and applying the obtained target trial torques to the at least one wheel for controlling the motion of said vehicle.</p><p id="p-0008" num="0007">According to a further embodiment of the present invention, there is provided a vehicle configured to execute a method for controlling motion of said vehicle, the method comprising the steps of: obtaining input information on a vector related to the velocity of said vehicle; computing repeatably a future trajectory of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; and applying the obtained target trial torques to the least one wheel for controlling the motion of said vehicle.</p><p id="p-0009" num="0008">Accordingly to a further embodiment of the present invention, there is provided a device configured to execute a method for controlling motion of a vehicle, the method comprising the steps of: obtaining input information on a vector related to the velocity of said vehicle; computing repeatably a future trajectory of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; and applying the obtained target trial torques to the at least one wheel for controlling the motion of said vehicle.</p><p id="p-0010" num="0009">According to a further embodiment of the present invention, there is provided a device comprising an interface to a vehicle, said vehicle providing input information on a vector related to the velocity of said vehicle to said device via said interface, said device configured to: compute repeatably a future trajectory of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; output the obtained target trial torques to said vehicle to be applied to the at least one wheel for controlling the motion of said vehicle.</p><p id="p-0011" num="0010">Embodiments of the present invention improve the dynamic performance and drivability of the vehicle. It increases the maximum achievable lateral acceleration and yaw rate, improves vehicle controllability and stability. It speeds up vehicle lateral response to steering wheel inputs, improves steady state and transient response.</p><p id="p-0012" num="0011">Moreover, in electric vehicles, steering and accordingly also control of the motion of each wheel can be realized individually without any further development, thus electric vehicles are a particular good platform for the use of the present invention.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0013" num="0012">Embodiments of the present invention, which are presented for better understanding the inventive concepts, but which are not to be seen as limiting the invention, will now be described with reference to the figures in which:</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows a flowchart of general method embodiments of the present invention;</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows a schematic view of a vehicle configured to execute general motion control method of the present embodiment; and</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>3</b></figref> shows a schematic view of a device embodiment of the present invention.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0005" level="1">DETAILED DESCRIPTION</heading><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows a flowchart of general method embodiments of the present invention. A method for controlling motion of a vehicle according to the present invention comprises the steps of obtaining input information (S<b>101</b>) on a vector related to the velocity of said vehicle; computing repeatably a future trajectory (S<b>102</b>) of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; and applying the obtained target trial torques (S<b>103</b>) to the at least one wheel for controlling the motion of said vehicle.</p><p id="p-0018" num="0017">In the context of this application motion refers to all types of movement of the vehicle, that is, includes acceleration and deceleration of the vehicle as well as braking the vehicle and changing the direction of the vehicle and is thus not to be understood to limit the type of movement of the vehicle.</p><p id="p-0019" num="0018">The first step of obtaining input information may be realized in various ways. For example, the information may either be sensed or measured by the vehicle. Alternatively, the information may be obtained from the outside, for example, by a GPS signal or a similar signal. At least part of this information may also be provided by signals from another entity, for example a vehicle, e.g. may make use of vehicle-to-vehicle communication.</p><p id="p-0020" num="0019">Further, the input information on a vector related to the velocity of said vehicle may take various forms. For example, it might be that said vector comprises a velocity and a vehicle yaw rate. It might also be obtained independently, that is, the velocity of the vehicle is obtained by different means and/or a different source than the vehicle yaw rate. The information might be obtained directly, that is, information directly about the velocity and the yaw rate or indirectly, that is, information from which velocity and yaw rate can be deduced. For example, instead of obtaining velocities and yaw rate, positions and yaw angles may be obtained and corresponding derivatives may be computed to obtain the velocities resp. the yaw rate. Furthermore, the information is not limited and might contain further information relevant to the control of the motion of the vehicle. Examples for such information may be a yaw rate, a yaw angle, a lateral velocity, a longitudinal velocity, wheel speeds (also angular velocities) of at least one of the wheels of the vehicle, a steering wheel angle, lateral acceleration as well as longitudinal acceleration. It is clear that this list is not conclusive and that any quantity that can be used for the motion control of the vehicle may be included in this information.</p><p id="p-0021" num="0020">For example, the vector related to the velocity of said vehicle may comprise at least two of: a transversal velocity of said vehicle, a longitudinal velocity of said vehicle, a yaw rate of said vehicle, and a ratio of the transversal velocity of said vehicle and the longitudinal velocity of said vehicle or any derivative or integrated quantity of the above quantities. In other words, as can be appreciate by the skilled person, instead of using a velocity, an acceleration may be used and velocity may be obtained by integration. Equally, any quantity that is substantially the same as one of the above quantities or contains substantially the same information may be used. For example, a square of a velocity may be used instead of</p><p id="p-0022" num="0021">In a further example, said input information may further comprise a motion target of said vehicle. Herein, motion target refers, for example, to the input provided by the driver, which may be provided via the gas pedal and the breaking pedal. Alternatively, in a scenario involving autonomous driving, a motion target may be the input provided by the autonomous driving agent before the control provided by the present invention is executed. In other words, a motion target may refer to an intent regarding the motion of the vehicle.</p><p id="p-0023" num="0022">In another example based on the above, said input information may further comprise respective angular velocities of all four wheels of the vehicle and a yaw rate of said vehicle, and optimizing said future trajectory may include controlling said yaw rate of said vehicle.</p><p id="p-0024" num="0023">The second step of repeatably computing a future trajectory of said vehicle can be realized by a plethora of algorithms and is not limited to a particular algorithm or procedure. This algorithm may be based on said input information and trial torques to be applied to at least one wheel of said vehicle. The trial torques can be a first guess of the torque to be applied and may be based on several consideration. For example, it might be based on a previously applied torque or even based on a feedback loop calculation.</p><p id="p-0025" num="0024">It is noted computing the future trajectory may include past data, that is, may be based on results from measurements and/or may be based on previous results of the method applied at a previous time. It is thus clear that the method can be applied iteratively, and that each iteration may be used for the next iteration.</p><p id="p-0026" num="0025">Further, the duration of the future trajectory is variable and can be chosen according to various requirements. For example, a longer duration may likely lead to a longer calculation time making the requirement of real-time analysis more challenging. As all these decisions might also depend on each iteration of the step of repeatably computing the future trajectory, it might be appropriate that this parameter can be changed for each iteration of computing the trajectory.</p><p id="p-0027" num="0026">The optimization aspect of this step may take various forms. A possible approach is that the computed future trajectory is compared with a target trajectory, that is, a target vehicle motion, and it is then determined whether the future trajectory meets the requirements, e.g. is close enough to a target trajectory or not. If this is the case, the optimization is finished, and the trial torques are taken to be the target trial torques. If this is not the case, that is, the computed future trajectory does not correspond to a target trajectory with sufficient accuracy, the trial torques are modified and the computation is repeated. In particular, the modification of the trial torques may be based on the difference between the computed future trajectory and the target trajectory. Such a difference may be computed in different ways, for example both trajectories may be written as a vector and then the distance between these vectors may be calculated using an appropriate norm.</p><p id="p-0028" num="0027">Alternatively, such an evaluation may involve further parameters than merely the trajectory itself. By using a cost function in which several parameters that are relevant for the motion of the vehicle and the control of the same can be considered. Possible other parameters involved may be an error in motion target, for example a yaw rate error, a force request error, that is, a deviation between the applied force according to the commands by the driver and the force to be applied according to the computed future trajectory, one or more slack variables to limit the slip ratio as well as parameters to limit the inputs. These different parameters may be weighted differently with respect to each other and these difference in weights may be changed according to the situation. For example, different driving style.</p><p id="p-0029" num="0028">However, this is merely an example and in no way understood to be limiting. Any procedure that allows to determine whether the computed future trajectory is sufficient for the next step of controlling the motion, thus obtaining the target trial torque, and&#x2014;in case the computer future trajectory is not sufficient&#x2014;to determine new trial torques is enough for this aspect.</p><p id="p-0030" num="0029">In the third step, the obtained target trial torques are applied to the at least one wheel for controlling the motion of said vehicle.</p><p id="p-0031" num="0030">Here it is noted that the concept of computing a future trajectory may include that the trial torque is not a single value, for example, per wheel, but instead a time-series of trial torques, for example, per wheel. The first trial torque of this time-series of trial torques corresponds to the torque to be applied to the at least one wheel for controlling the motion of said vehicle. The remaining ones, as they refer to target trial torques to be applied in the future, may be used for as trial torques for the next iteration of the method.</p><p id="p-0032" num="0031">In an embodiment of the present invention, the second step of obtaining the target trial torques may include the following sub-steps:</p><p id="p-0033" num="0032">In a first sub-step, a future trajectory of the vehicle is computed based on said input information and trial torques to be applied to at least one wheel.</p><p id="p-0034" num="0033">In a second sub-step, the computed future trajectory is evaluated in view of a target vehicle motion.</p><p id="p-0035" num="0034">In a third sub-step, if the evaluation indicates that the target vehicle motion is not optimal, the trial torques are adjusted according to the evaluation and a further iteration is started at sub-step <b>1</b>; if the evaluation indicates that the target vehicle motion is optimal, the trial torques are set as the target trial torques.</p><p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows a schematic view of a vehicle <b>2</b> configured to execute general motion control method of the present embodiment. This method corresponds substantially to the method discuss above, that is the vehicle is configured to execute a method comprising the steps of: obtaining input information (S<b>101</b>) on a vector related to the velocity of said vehicle; computing repeatably a future trajectory (S<b>102</b>) of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; and applying the obtained target trial torques (S<b>103</b>) to the at least one wheel for controlling the motion of said vehicle.</p><p id="p-0037" num="0036">Accordingly, the above considerations in connection with the method discussed in connection with <figref idref="DRAWINGS">FIG. <b>1</b></figref> equally applies to the vehicle configured to execute such a method.</p><p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. <b>3</b></figref> shows a schematic view of a device embodiment of the present invention. This device <b>3</b> may comprise a processor <b>301</b> as well as a memory <b>302</b>. The processor may be Central Processing Unit (CPU) or a Graphical Processing Unit (GPU). Using a GPU may be advantageous for some optimization algorithms. Furthermore, it may optionally also comprise an interface <b>303</b>. These elements may be configured to exchange data with each other, that is, the processor <b>301</b> may receive data from both the memory <b>302</b> and the interface <b>303</b> that is then processed by the processor <b>301</b>. Accordingly, the memory <b>302</b> may receive and/or provide the processor <b>301</b> with data, that is, processed data resp. to-be-processed data. Further, the memory may also receive and/or provide the interface <b>303</b> with data. In line therewith, the interface <b>303</b> may provide and/or receive data from the processor <b>301</b> which then is to-be-processed data or processed data and may provide and/or receive data from the memory <b>302</b>.</p><p id="p-0039" num="0038">A device <b>3</b> as schematically shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref> may be configured to execute a method for controlling motion of a vehicle, the method comprising the steps of: obtaining input information (S<b>101</b>) on a vector related to the velocity of said vehicle; computing repeatably a future trajectory (S<b>102</b>) of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; and applying the obtained target trial torques (S<b>103</b>) to the at least one wheel for controlling the motion of said vehicle.</p><p id="p-0040" num="0039">In this case, the device <b>3</b> can be considered to be an integral part of the vehicle <b>1</b>.</p><p id="p-0041" num="0040">Alternatively, the device <b>3</b> schematically shown in <figref idref="DRAWINGS">FIG. <b>3</b></figref>, in particular in the case of the device comprising the interface <b>3</b>, it might be the case that it is said vehicle that provides input information (S<b>101</b>) on a vector related to the velocity of said vehicle to said device via said interface, and said device is configured to: compute repeatably a future trajectory (S<b>102</b>) of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; and output the obtained target trial torques (S<b>103</b>) to said vehicle to be applied to the at least one wheel for controlling the motion of said vehicle.</p><p id="p-0042" num="0041">In this case, the device <b>3</b> might be considered to be a modular part of the vehicle <b>1</b> as the device <b>3</b> is provided with the input information by the vehicle <b>1</b> and thus not obtained it on its own.</p><p id="p-0043" num="0042">In the following, a further embodiment of the present invention will be described in detail. This embodiment comprises three components: a yaw rate target calculation, a Model Predictive Control (MPC) problem formulation and a Quadratic Problem Solver.</p><p id="p-0044" num="0043">The yaw rate target calculation component calculates a yaw rate target based on a current state of the vehicle <b>1</b>, for example through a lookup table. Calculation using a lookup table may provide a faster calculation than an online calculation.</p><p id="p-0045" num="0044">The MPC problem formulation component creates a model predictive control problem suited to the vehicle's current state and desired behavior. This problem can be formulated as a finite horizon open-loop optimal control problem, which is passed to the Quadratic Program Solver for solving.</p><p id="p-0046" num="0045">The Quadratic Program Solver component calculates the torque commands, that is the target trial torques, to be applied to the vehicle, that is, at least one of the wheels of the vehicle. Current control action is obtained by solving the finite horizon open-loop optimal control problem. The optimization returns an optimal control sequence. The first control in this sequence is applied to the vehicle.</p><p id="p-0047" num="0046">Yaw rate targets may be obtained by a lookup table. The table is two-dimensional, with steering wheel angle and vehicle longitudinal velocity as inputs and reference yaw rate as output, that is:</p><p id="p-0048" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>{dot over (&#x3c8;)}<sub>k</sub><sup>ref</sup><i>=f</i>(&#x3b4;,v<sub>x</sub>)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0049" num="0047">The data for the reference table (lookup table) is generated offline, for example by performing a steady state analysis on the passive vehicle in simulation. For example, a slowly increasing longitudinal speed is applied at different constant steering angles, and the measured yaw rate is recorded as the steady-state passive yaw rate value.</p><p id="p-0050" num="0048">In a further detailed embodiment, the resulting steady-state passive yaw rate values are multiplied by a factor to produce yaw rate targets different from the vehicle passive behavior. Smaller factors are used for higher speeds, where vehicle instability is more dangerous.</p><p id="p-0051" num="0049">Furthermore, in the present embodiment it may be necessary to be aware of the vehicle's current state to be able to determine optimal wheel torques. The vehicle's current state may be a set of measurements or estimates which enable the system to specify initial conditions for its internal vehicle model.</p><p id="p-0052" num="0050">The following values may comprise the vehicle state: Current estimated vehicle longitudinal velocity, current estimated vehicle lateral velocity, current measured vehicle yaw rate, wheel rotational velocity (one per wheel).</p><p id="p-0053" num="0051">In a further embodiment, the discrete nonlinear vehicle model used for the MPC is given by:</p><p id="p-0054" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>{circumflex over (&#x3be;)}(<i>k+</i>1)=<i>f</i><sub>d</sub>(&#x3be;(<i>k</i>),<i>u</i>(<i>k</i>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0055" num="0052">The Linear Time Varying (LTV) MPC implemented in this embodiment uses a linear vehicle model approximated by the following equation:</p><p id="p-0056" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3be;(<i>k+</i>1)=<i>A</i><sub>k</sub>&#x3be;(<i>k</i>)+<i>B</i><sub>k</sub><i>u</i>(<i>k</i>)+<i>d</i><sub>k </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0057" num="0000">where &#x3be;(k) is the vehicle model state vector and u(k) is the input vector at the time step k, with t being the current time step. The prediction horizon is represented by N. Accordingly,</p><p id="p-0058" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3be;=[v<sub>x</sub>,v<sub>y</sub>,{dot over (&#x3c8;)},&#x3c9;<sub>fl</sub>,&#x3c9;<sub>fr</sub>,&#x3c9;<sub>rl</sub>,&#x3c9;<sub>rr</sub>]<sup>T </sup><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0059" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>u=[&#x3b4;,T<sub>fl</sub>,T<sub>fr</sub>,T<sub>rl</sub>,T<sub>rr</sub>]<sup>T </sup><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0060" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>k=t, . . . , t+N&#x2212;</i>1<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0061" num="0053">Here, &#x3be; is the steering wheel angle and wheel torques are denoted by T<sub>&#x2022;&#x2605; </sub>where marking &#x2022;&#x2208;{f,r} represents front or rear wheel values, while marking &#x2605;&#x2208;{l,r} represents left or right wheel values. While this assumes a vehicle with four wheels, front and rear, left and right, this is by no means limiting.</p><p id="p-0062" num="0054">In fact, the present embodiment is not limited to such a scenario and this is merely used for ease of understanding.</p><p id="p-0063" num="0055">The vehicle model used inside this embodiment is linearized once every algorithm iteration, for every time step in the prediction horizon. This produces a set of similar linear models&#x2014;one for every time step&#x2014;which can together be viewed as one Linear Time-Varying model (LTV model). The optimization algorithm uses the LTV model to arrive at optimal torque values.</p><p id="p-0064" num="0056">The model may be linearized around the most likely operating point at that time step. When Torque Vectoring first initializes, the most likely operating point for the future is the current operating point, so that value is used for all time steps. Once an optimal state trajectory is available (having been calculated in a previous algorithm iteration), it may be used to linearize the model around.</p><p id="p-0065" num="0057">The model may be linearized before optimization starts, and it may not be re-linearized when the predicted optimal trajectory changes. This may be acceptable because the optimal trajectory changes should be small when comparing consecutive algorithm iterations.</p><p id="p-0066" num="0058">As the model used in this MPC must be linear, the matrices A<sub>k </sub>and B<sub>k </sub>are obtained by successively linearizing the nonlinear vehicle model along a predicted state trajectory. States and inputs are predicted at each time step and the predicted values are then used for further predictions throughout the horizon.</p><p id="p-0067" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mrow>  <msub>   <mi>A</mi>   <mi>k</mi>  </msub>  <mo>=</mo>  <mrow>   <mfrac>    <mrow>     <mo>&#x2202;</mo>     <msub>      <mi>f</mi>      <mi>d</mi>     </msub>    </mrow>    <mrow>     <mo>&#x2202;</mo>     <mi>&#x3be;</mi>    </mrow>   </mfrac>   <msub>    <mo>&#x2758;</mo>    <mrow>     <msub>      <mi>&#x3be;</mi>      <mi>k</mi>     </msub>     <mo>,</mo>     <msub>      <mi>u</mi>      <mrow>       <mi>k</mi>       <mo>&#x2758;</mo>       <mrow>        <mi>t</mi>        <mo>-</mo>        <mn>1</mn>       </mrow>      </mrow>     </msub>    </mrow>   </msub>  </mrow> </mrow></math></maths><maths id="MATH-US-00001-2" num="00001.2"><math overflow="scroll"> <mrow>  <msub>   <mi>B</mi>   <mi>k</mi>  </msub>  <mo>=</mo>  <mrow>   <mfrac>    <mrow>     <mo>&#x2202;</mo>     <msub>      <mi>f</mi>      <mi>d</mi>     </msub>    </mrow>    <mrow>     <mo>&#x2202;</mo>     <mi>u</mi>    </mrow>   </mfrac>   <msub>    <mo>&#x2758;</mo>    <mrow>     <msub>      <mi>&#x3be;</mi>      <mi>k</mi>     </msub>     <mo>,</mo>     <msub>      <mi>u</mi>      <mrow>       <mi>k</mi>       <mo>&#x2758;</mo>       <mrow>        <mi>t</mi>        <mo>-</mo>        <mn>1</mn>       </mrow>      </mrow>     </msub>    </mrow>   </msub>  </mrow> </mrow></math></maths></p><p id="p-0068" num="0059">d<sub>k </sub>represents the predicted steady state response deviation of the non-linear model from the LTV model:</p><p id="p-0069" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>d</i><sub>k</sub>={circumflex over (&#x3be;)}(<i>k+</i>1)=<i>A</i><sub>k</sub>{circumflex over (&#x3be;)}(<i>k</i>)&#x2212;<i>B</i><sub>k</sub><i>u</i>(<i>k</i>)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0070" num="0060">An LTV model of the vehicle may be used to calculate the change in states produced by a change in inputs. However, the present embodiment may require the actual value of the states to compare with reference values. If the LTV model were simulated, its output may not exactly match the output of the nonlinear model, so a set of correction &#x201c;delta&#x201d; values are calculated.</p><p id="p-0071" num="0061">In the present embodiment, the delta values may be calculated once per algorithm iteration, after the system has been linearized. These delta values are then kept constant for all optimization iterations.</p><p id="p-0072" num="0062">The delta value is calculated by simulating the full nonlinear model over the prediction horizon. Then, for each time step, the LTV model is initialized to the nonlinear state values, the input values for that time step are applied and the state values for the next time step according to the LTV model are calculated. The difference between the nonlinear state values for the next time step and the LTV state values for the next time step are the delta values for this time step.</p><p id="p-0073" num="0063">Once calculated, the delta values are used in the objective function of the optimal control problem. At each time step, the delta values act as a known disturbance to align the predicted state to the nonlinear simulated state. If the system inputs do not change, the LTV model and the nonlinear model will match perfectly.</p><p id="p-0074" num="0064">The model used may be a dual-track bicycle model with nonlinear tyres, weight transfer effects and wheel dynamics. The coordinate system is chassis-fixed, and the position of the vehicle is not tracked.</p><p id="p-0075" num="0065">Equal steering angle is assumed on front left and front right wheel, and the model does not account for static toe on any of the wheels.</p><p id="p-0076" num="0066">Wheel slip is calculated the same way in both braking and acceleration, using the following equation:</p><p id="p-0077" num="0000"><maths id="MATH-US-00002" num="00002"><math overflow="scroll"> <mrow>  <mi>&#x3c3;</mi>  <mo>=</mo>  <mfrac>   <mrow>    <mrow>     <mi>&#x3c9;</mi>     <mo>&#x2062;</mo>     <mi>r</mi>    </mrow>    <mo>-</mo>    <msub>     <mi>v</mi>     <mi>x</mi>    </msub>   </mrow>   <msub>    <mi>v</mi>    <mi>x</mi>   </msub>  </mfrac> </mrow></math></maths></p><p id="p-0078" num="0067">The equation may not support operation under very low speed, which may be justified because the present embodiment should not be required to be active at very low speed.</p><p id="p-0079" num="0068">The model may include simple load transfer behavior with no dynamics. Lateral load transfer is assumed to be split evenly between the front and rear axle, and it is calculated purely from lateral acceleration. Longitudinal load transfer is calculated purely from longitudinal acceleration.</p><p id="p-0080" num="0069">Load transfer is calculated using the equations below:</p><p id="p-0081" num="0000"><maths id="MATH-US-00003" num="00003"><math overflow="scroll"> <mrow>  <msub>   <mi>F</mi>   <mrow>    <mi>z</mi>    <mo>,</mo>    <mi>fl</mi>   </mrow>  </msub>  <mo>=</mo>  <mrow>   <mfrac>    <mi>mgb</mi>    <mi>l</mi>   </mfrac>   <mo>-</mo>   <mfrac>    <mrow>     <msub>      <mi>a</mi>      <mi>x</mi>     </msub>     <mo>&#x2062;</mo>     <mi>h</mi>    </mrow>    <mrow>     <mn>2</mn>     <mo>&#x2062;</mo>     <mi>l</mi>    </mrow>   </mfrac>   <mo>-</mo>   <mfrac>    <mrow>     <msub>      <mi>a</mi>      <mi>y</mi>     </msub>     <mo>&#x2062;</mo>     <mi>h</mi>    </mrow>    <mrow>     <mn>4</mn>     <mo>&#x2062;</mo>     <mi>c</mi>    </mrow>   </mfrac>  </mrow> </mrow></math></maths><maths id="MATH-US-00003-2" num="00003.2"><math overflow="scroll"> <mrow>  <msub>   <mi>F</mi>   <mrow>    <mi>z</mi>    <mo>,</mo>    <mi>fr</mi>   </mrow>  </msub>  <mo>=</mo>  <mrow>   <mfrac>    <mi>mgb</mi>    <mi>l</mi>   </mfrac>   <mo>-</mo>   <mfrac>    <mrow>     <msub>      <mi>a</mi>      <mi>x</mi>     </msub>     <mo>&#x2062;</mo>     <mi>h</mi>    </mrow>    <mrow>     <mn>2</mn>     <mo>&#x2062;</mo>     <mi>l</mi>    </mrow>   </mfrac>   <mo>+</mo>   <mfrac>    <mrow>     <msub>      <mi>a</mi>      <mi>y</mi>     </msub>     <mo>&#x2062;</mo>     <mi>h</mi>    </mrow>    <mrow>     <mn>4</mn>     <mo>&#x2062;</mo>     <mi>c</mi>    </mrow>   </mfrac>  </mrow> </mrow></math></maths><maths id="MATH-US-00003-3" num="00003.3"><math overflow="scroll"> <mrow>  <msub>   <mi>F</mi>   <mrow>    <mi>z</mi>    <mo>,</mo>    <mi>rl</mi>   </mrow>  </msub>  <mo>=</mo>  <mrow>   <mfrac>    <mi>mgc</mi>    <mi>l</mi>   </mfrac>   <mo>+</mo>   <mfrac>    <mrow>     <msub>      <mi>a</mi>      <mi>x</mi>     </msub>     <mo>&#x2062;</mo>     <mi>h</mi>    </mrow>    <mrow>     <mn>2</mn>     <mo>&#x2062;</mo>     <mi>l</mi>    </mrow>   </mfrac>   <mo>-</mo>   <mfrac>    <mrow>     <msub>      <mi>a</mi>      <mi>y</mi>     </msub>     <mo>&#x2062;</mo>     <mi>h</mi>    </mrow>    <mrow>     <mn>4</mn>     <mo>&#x2062;</mo>     <mi>c</mi>    </mrow>   </mfrac>  </mrow> </mrow></math></maths><maths id="MATH-US-00003-4" num="00003.4"><math overflow="scroll"> <mrow>  <msub>   <mi>F</mi>   <mrow>    <mi>z</mi>    <mo>,</mo>    <mi>rr</mi>   </mrow>  </msub>  <mo>=</mo>  <mrow>   <mfrac>    <mi>mgc</mi>    <mi>l</mi>   </mfrac>   <mo>+</mo>   <mfrac>    <mrow>     <msub>      <mi>a</mi>      <mi>x</mi>     </msub>     <mo>&#x2062;</mo>     <mi>h</mi>    </mrow>    <mrow>     <mn>2</mn>     <mo>&#x2062;</mo>     <mi>l</mi>    </mrow>   </mfrac>   <mo>+</mo>   <mfrac>    <mrow>     <msub>      <mi>a</mi>      <mi>y</mi>     </msub>     <mo>&#x2062;</mo>     <mi>h</mi>    </mrow>    <mrow>     <mn>4</mn>     <mo>&#x2062;</mo>     <mi>c</mi>    </mrow>   </mfrac>  </mrow> </mrow></math></maths></p><p id="p-0082" num="0070">Since the model accepts wheel torque as an input, it has a model of wheel dynamics. The model assumes a fixed wheel radius and inertia and does not account for rolling resistance. Wheel dynamics for each individual wheel is described by the equation below:</p><p id="p-0083" num="0000"><maths id="MATH-US-00004" num="00004"><math overflow="scroll"> <mrow>  <mrow>   <mi>J</mi>   <mo>&#x2062;</mo>   <mfrac>    <mrow>     <mi>d</mi>     <mo>&#x2062;</mo>     <mi>&#x3c9;</mi>    </mrow>    <mi>dt</mi>   </mfrac>  </mrow>  <mo>=</mo>  <mrow>   <mi>T</mi>   <mo>-</mo>   <msub>    <mi>rF</mi>    <mi>x</mi>   </msub>  </mrow> </mrow></math></maths></p><p id="p-0084" num="0071">Aerodynamic drag, downforce and torque may not be modelled.</p><p id="p-0085" num="0072">The goal at each step is to find the optimal control sequence along the horizon which minimizes a cost function. This cost function may for example take the following form:</p><p id="p-0086" num="0000"><maths id="MATH-US-00005" num="00005"><math overflow="scroll"> <mrow>  <mrow>   <mi>J</mi>   <mo>&#x2061;</mo>   <mo>(</mo>   <mi>t</mi>   <mo>)</mo>  </mrow>  <mo>=</mo>  <mrow>   <mrow>    <munderover>     <mo>&#x2211;</mo>     <mrow>      <mi>k</mi>      <mo>=</mo>      <mi>t</mi>     </mrow>     <mrow>      <mi>t</mi>      <mo>+</mo>      <mi>N</mi>     </mrow>    </munderover>    <mrow>     <mo>(</mo>     <mrow>      <mrow>       <mi>q</mi>       <mo>&#x2062;</mo>       <msup>        <mrow>         <mo>&#xf605;</mo>         <mrow>          <msub>           <mover>            <mi>&#x3c8;</mi>            <mo>.</mo>           </mover>           <mi>k</mi>          </msub>          <mo>-</mo>          <msubsup>           <mover>            <mi>&#x3c8;</mi>            <mo>.</mo>           </mover>           <mi>k</mi>           <mi>ref</mi>          </msubsup>         </mrow>         <mo>&#xf606;</mo>        </mrow>        <mn>2</mn>       </msup>      </mrow>      <mo>+</mo>      <mrow>       <mi>w</mi>       <mo>&#x2062;</mo>       <msup>        <mrow>         <mo>&#xf605;</mo>         <mrow>          <msub>           <mi>f</mi>           <mi>k</mi>          </msub>          <mo>-</mo>          <msubsup>           <mi>f</mi>           <mi>k</mi>           <mi>ref</mi>          </msubsup>         </mrow>         <mo>&#xf606;</mo>        </mrow>        <mn>2</mn>       </msup>      </mrow>      <mo>+</mo>      <mrow>       <mi>p</mi>       <mo>&#x2062;</mo>       <msubsup>        <mrow>         <mo>&#xf605;</mo>         <msub>          <mi>&#x3b5;</mi>          <mi>k</mi>         </msub>         <mo>&#xf606;</mo>        </mrow>        <mi>I</mi>        <mn>2</mn>       </msubsup>      </mrow>     </mrow>     <mo>)</mo>    </mrow>   </mrow>   <mo>+</mo>   <mrow>    <munderover>     <mo>&#x2211;</mo>     <mrow>      <mi>k</mi>      <mo>=</mo>      <mi>t</mi>     </mrow>     <mrow>      <mi>t</mi>      <mo>+</mo>      <mi>N</mi>      <mo>-</mo>      <mn>1</mn>     </mrow>    </munderover>    <mrow>     <mo>(</mo>     <mrow>      <msubsup>       <mrow>        <mo>&#xf605;</mo>        <msub>         <mi>u</mi>         <mi>k</mi>        </msub>        <mo>&#xf606;</mo>       </mrow>       <mi>S</mi>       <mn>2</mn>      </msubsup>      <mo>+</mo>      <msubsup>       <mrow>        <mo>&#xf605;</mo>        <mrow>         <mi>&#x394;</mi>         <mo>&#x2062;</mo>         <msub>          <mi>u</mi>          <mi>k</mi>         </msub>        </mrow>        <mo>&#xf606;</mo>       </mrow>       <mi>R</mi>       <mn>2</mn>      </msubsup>     </mrow>     <mo>)</mo>    </mrow>   </mrow>  </mrow> </mrow></math></maths><ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0000">    <ul id="ul0002" list-style="none">        <li id="ul0002-0001" num="0073">The first part of the cost function (q&#x2225;{dot over (&#x3c8;)}<sub>k</sub>&#x2212;{dot over (&#x3c8;)}<sub>k</sub><sup>ref</sup>&#x2225;<sup>2</sup>) is the yaw rate tracking squared error weighted by the scalar q.</li>        <li id="ul0002-0002" num="0074">Second part (w&#x2225;f<sub>k</sub>&#x2212;f<sub>k</sub><sup>ref</sup>&#x2225;<sup>2</sup>) is the force request tracking squared error weighted by the scalar w.</li>        <li id="ul0002-0003" num="0075">Third part (p&#x2225;&#x3b5;<sub>k</sub>&#x2225;<sub>I</sub><sup>2</sup>) is the square of the slack variable vector &#x3b5;<sub>k </sub>multiplied by the identity matrix I and weighted by the scalar p</li>        <li id="ul0002-0004" num="0076">The last part is the cost of input variables: &#x2225;u<sub>k</sub>&#x2225;<sub>S</sub><sup>2 </sup>penalizes the squared value of inputs weighted with S matrix, while &#x2225;&#x394;u<sub>k</sub>&#x2225;<sub>R</sub><sup>2 </sup>penalizes the squared value of input change weighted with R matrix.</li>    </ul>    </li></ul></p><p id="p-0087" num="0077">Slack variables may be used for penalizing when a variable breaks its soft constraint. Example, we want to limit slip ratio:</p><p id="p-0088" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>slip&#x2264;slip_limit or slip&#x2212;slip_limit&#x2264;0<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0089" num="0078">In an optimization problem, the equations above would be considered hard constraints which means that if the inequality cannot be satisfied, the problem is infeasible.</p><p id="p-0090" num="0079">Since there may be indirect control over slips, it is possible that the limits will get broken and we want to penalize if the value goes above the limits. To achieve that, slack variables are added in the soft constraint inequations:</p><p id="p-0091" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>slip&#x2212;slip_limit&#x2264;&#x3b5;<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0092" num="0080">The optimization algorithm calculates the slack variable &#x3b5; so that it satisfies the soft constraint inequality above and keeps the cost function J(t) minimal. To keep the J(t) minimal, p&#x2225;&#x3b5;<sub>k</sub>&#x2225;<sub>I</sub><sup>2 </sup>must be minimal and that is the case when &#x3b5;<sub>k </sub>is as close as possible to 0.</p><p id="p-0093" num="0081">By changing the weights in the cost function, different behavior can be achieved. For example, if q is increased relative to R, the vehicle will follow yaw rate reference better, but the wheel torques might experience more aggressive changes.</p><p id="p-0094" num="0082">As regards hard constraints, any combination of the following might be considered in a further embodiment of the present invention.</p><p id="p-0095" num="0083">Upper and lower input limits:</p><p id="p-0096" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i><sub>low</sub><i>&#x2264;u</i>(<i>k</i>)&#x2264;<i>u</i><sub>high </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0097" num="0084">Upper and lower input rate limits:</p><p id="p-0098" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>u</i><sub>low</sub><i>&#x2264;u</i>(<i>k</i>)&#x2212;<i>u</i>(<i>k&#x2212;</i>1)&#x2264;&#x394;<i>u</i><sub>high </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0099" num="0085">Steering in MPC output must be the same as driver steering reference:</p><p id="p-0100" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i>(1,<i>k</i>)=&#x3b4;<sub>ref</sub>(<i>k</i>)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0101" num="0086">First state in the optimization is the current measured state</p><p id="p-0102" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3be;(1)=&#x3be;<sub>0 </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0103" num="0087">LTV vehicle model equation must be satisfied in all prediction steps:</p><p id="p-0104" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3be;(<i>k+</i>1)=<i>A</i><sub>k</sub>&#x3be;(<i>k</i>)+<i>B</i><sub>k</sub><i>u</i>(<i>k</i>)+<i>d</i><sub>k </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0105" num="0088">If the driver force request is negative (driver is braking) brake twice as hard with front wheels compared to the back wheels:</p><p id="p-0106" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i>(2,<i>k</i>)+<i>u</i>(3,<i>k</i>)=2*(<i>u</i>(4,<i>k</i>)+<i>u</i>(5,<i>k</i>)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0107" num="0089">Sum of wheel torques multiplied with the predicted wheel velocities (total power) must be lower than the battery's discharge power limit when accelerating and higher than the charge power limit when braking with the motors:</p><p id="p-0108" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x2212;chargePowerLimit&#x2264;<i>u</i>(2:5,<i>k</i>)*{circumflex over (&#x3be;)}(4:7,<i>k</i>)&#x2264;dischargePowerLimit<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0109" num="0090">Slip ratio and slip angle are placed between upper and lower bounds to keep the vehicle in the stable region:</p><p id="p-0110" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>s</i><sub>low</sub><i>&#x2264;s</i>(<i>k</i>)&#x2264;<i>s</i><sub>upp </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0111" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3b1;<sub>low</sub>&#x2264;&#x3b1;(<i>k</i>)&#x2264;&#x3b1;<sub>upp </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0112" num="0091">The sum of the forces on the wheels must be as close as possible to the driver's force request (force request tracking):</p><p id="p-0113" num="0000"><maths id="MATH-US-00006" num="00006"><math overflow="scroll"> <mrow>  <mrow>   <mi>forceRequest</mi>   <mo>-</mo>   <mrow>    <munderover>     <mo>&#x2211;</mo>     <mrow>      <mi>i</mi>      <mo>=</mo>      <mn>2</mn>     </mrow>     <mn>5</mn>    </munderover>    <mfrac>     <mrow>      <mi>u</mi>      <mo>&#x2061;</mo>      <mo>(</mo>      <mrow>       <mi>i</mi>       <mo>,</mo>       <mi>k</mi>      </mrow>      <mo>)</mo>     </mrow>     <mi>R</mi>    </mfrac>   </mrow>  </mrow>  <mo>&#x2265;</mo>  <mi>&#x3b5;</mi> </mrow></math></maths></p><p id="p-0114" num="0092">Once the MPC Problem is formulated as described elsewhere in this document, the problem can be passed to a Quadratic Program Solver&#x2014;a software component which solves a special class of optimization problem.</p><p id="p-0115" num="0093">In general, a Quadratic Program Solver solves an optimization problem formulated as a quadratic program:</p><p id="p-0116" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>minimize&#xbd;x<sup>T</sup>Px+q<sup>T</sup>x<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0117" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>subject to l&#x2264;Ax&#x2264;u<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0118" num="0094">In the case of the present disclosure:</p><p id="p-0119" num="0095">The vector x represents the optimization variables. The Solver will output the optimal values of these variables.</p><p id="p-0120" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>x=[u<sub>0</sub>;u<sub>1</sub>; . . . ;u<sub>Nc</sub>;&#x3f5;<sub>0</sub>;&#x3f5;<sub>1</sub>; . . . ;&#x3f5;<sub>Np</sub>]<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0121" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>u<sub>k</sub>=[T<sub>fl,k</sub>,T<sub>fr,k</sub>,T<sub>rl,k</sub>,T<sub>rr,k</sub>]<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0122" num="0096">Where u<sub>k </sub>are the torque inputs to be applied to the system, and &#x3f5;<sub>k </sub>are the slack variables which govern the soft constraints.</p><p id="p-0123" num="0097">The matrix P and the vector q are calculated from the cost function formulation, described elsewhere in this document. These parameters include the yaw rate tracking, slack variable and input variable terms. The soft constraints described elsewhere in this document are also implemented through these parameters.</p><p id="p-0124" num="0098">The matrix A and the vectors l and u are calculated from the hard constraint formulation, described elsewhere in this document. These parameters may include the vehicle model, output constraints (power and torque), initial conditions (current vehicle state) and a special affordance for regenerative braking torque split front-to-rear.</p><p id="p-0125" num="0099">Differential torque limits that are determining the maximum differential torques allowed to be applied on the rear and the front axle may be in form of a lookup table generated offline (based on the force request).</p><p id="p-0126" num="0100">Steering angle for the prediction horizon is predicted based on the last two values of the steering wheel angle:</p><p id="p-0127" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x3b4;(<i>k+</i>1)=&#x3b3;<sub>1</sub>&#x3b4;(<i>k</i>)+&#x3b3;<sub>2</sub>&#x3b4;(<i>k&#x2212;</i>1)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0128" num="0101">In the following, further details of the Model Predictive Controller as used in a further embodiment of the present invention will be discussed</p><p id="p-0129" num="0102">In each time sample the controller takes following inputs:<ul id="ul0003" list-style="none">    <li id="ul0003-0001" num="0000">    <ul id="ul0004" list-style="none">        <li id="ul0004-0001" num="0103">Current vehicle states (v<sub>x</sub>, v<sub>y</sub>, {dot over (&#x3c8;)}, &#x3c9;<sub>fl</sub>, &#x3c9;<sub>fr</sub>, &#x3c9;<sub>rl</sub>, &#x3c9;<sub>rr</sub>) and current accelerations (a<sub>x</sub>, a<sub>y</sub>)        <ul id="ul0005" list-style="none">            <li id="ul0005-0001" num="0104">Longitudinal and lateral velocities (v<sub>x</sub>, v<sub>y</sub>) are estimated through Vx and Vy Estimation Functionality on the PCU</li>            <li id="ul0005-0002" num="0105">Yaw rate ({dot over (&#x3c8;)}) and vehicle longitudinal and lateral accelerations (a<sub>x</sub>, a<sub>y</sub>) are obtained from the IMU sensors</li>            <li id="ul0005-0003" num="0106">Vehicle's four current wheel speeds (&#x3c9;<sub>fl</sub>, &#x3c9;<sub>fr</sub>, &#x3c9;<sub>rl</sub>, &#x3c9;<sub>rr</sub>) are coming from Wheelspeed Sensor Mapping functionality on the PCU</li>        </ul>        </li>        <li id="ul0004-0002" num="0107">Last two values of the steering wheel angle</li>        <li id="ul0004-0003" num="0108">Power and torque limits</li>        <li id="ul0004-0004" num="0109">Differential torque limits</li>        <li id="ul0004-0005" num="0110">Yaw rate reference based on the predicted steering angle for the whole prediction horizon</li>    </ul>    </li></ul></p><p id="p-0130" num="0111">In the following, further details of the vehicle models simulation as used in a further embodiment of the present invention will be discussed.</p><p id="p-0131" num="0112">Current vehicle states and accelerations are used as inputs in the nonlinear and linear vehicle model simulation, through which updates of all the states are obtained. Updated states and accelerations from the nonlinear model are then used as the starting point for the next loop of nonlinear and linear vehicle model simulations. The process is repeated until the whole prediction horizon is covered, i.e. until prediction of the vehicle states for both linear and nonlinear version of the model for the whole prediction horizon is achieved. Besides the vehicle states, vehicle models are using steering prediction on the whole horizon and four wheels torques as inputs as well. After the first &#x201c;turning on&#x201d;, torques that are used to get vehicle states prediction in both vehicle models are all equal to initial values. In every next iteration of the algorithm, optimal torques from the previous iteration are used for that purpose.</p><p id="p-0132" num="0113">The changes in velocities and yaw rate are captured by following equations:</p><p id="p-0133" num="0000"><maths id="MATH-US-00007" num="00007"><math overflow="scroll"> <mrow>  <mtext>	</mtext>  <mrow>   <mrow>    <msub>     <mi>dv</mi>     <mi>x</mi>    </msub>    <mo>=</mo>    <mrow>     <mrow>      <msub>       <mi>v</mi>       <mi>y</mi>      </msub>      <mo>&#x2062;</mo>      <mover>       <mi>&#x3c8;</mi>       <mo>.</mo>      </mover>     </mrow>     <mo>+</mo>     <mrow>      <mfrac>       <mn>1</mn>       <mi>m</mi>      </mfrac>      <mo>&#x2062;</mo>      <mrow>       <mo>(</mo>       <mrow>        <msub>         <mi>F</mi>         <mi>flx</mi>        </msub>        <mo>+</mo>        <msub>         <mi>F</mi>         <mi>frx</mi>        </msub>        <mo>+</mo>        <msub>         <mi>F</mi>         <mi>rlx</mi>        </msub>        <mo>+</mo>        <msub>         <mi>F</mi>         <mi>rrx</mi>        </msub>       </mrow>       <mo>)</mo>      </mrow>     </mrow>    </mrow>   </mrow>   <mo>,</mo>  </mrow> </mrow></math></maths><maths id="MATH-US-00007-2" num="00007.2"><math overflow="scroll"> <mrow>  <mtext>	</mtext>  <mrow>   <mrow>    <msub>     <mi>dv</mi>     <mi>y</mi>    </msub>    <mo>=</mo>    <mrow>     <mrow>      <mrow>       <mo>-</mo>       <msub>        <mi>v</mi>        <mi>x</mi>       </msub>      </mrow>      <mo>&#x2062;</mo>      <mover>       <mi>&#x3c8;</mi>       <mo>.</mo>      </mover>     </mrow>     <mo>+</mo>     <mrow>      <mfrac>       <mn>1</mn>       <mi>m</mi>      </mfrac>      <mo>&#x2062;</mo>      <mrow>       <mo>(</mo>       <mrow>        <msub>         <mi>F</mi>         <mi>fly</mi>        </msub>        <mo>+</mo>        <msub>         <mi>F</mi>         <mi>fry</mi>        </msub>        <mo>+</mo>        <msub>         <mi>F</mi>         <mi>rly</mi>        </msub>        <mo>+</mo>        <msub>         <mi>F</mi>         <mi>rry</mi>        </msub>       </mrow>       <mo>)</mo>      </mrow>     </mrow>    </mrow>   </mrow>   <mo>,</mo>  </mrow> </mrow></math></maths><maths id="MATH-US-00007-3" num="00007.3"><math overflow="scroll"> <mrow>  <mrow>   <mrow>    <mi>d</mi>    <mo>&#x2062;</mo>    <mover>     <mi>&#x3c8;</mi>     <mo>.</mo>    </mover>   </mrow>   <mo>=</mo>   <mrow>    <mrow>     <mfrac>      <mi>b</mi>      <msub>       <mi>I</mi>       <mi>z</mi>      </msub>     </mfrac>     <mo>&#x2062;</mo>     <mrow>      <mo>(</mo>      <mrow>       <msub>        <mi>F</mi>        <mi>fly</mi>       </msub>       <mo>+</mo>       <msub>        <mi>F</mi>        <mi>fry</mi>       </msub>      </mrow>      <mo>)</mo>     </mrow>    </mrow>    <mo>-</mo>    <mrow>     <mfrac>      <mi>c</mi>      <msub>       <mi>I</mi>       <mi>z</mi>      </msub>     </mfrac>     <mo>&#x2062;</mo>     <mrow>      <mo>(</mo>      <mrow>       <msub>        <mi>F</mi>        <mi>rly</mi>       </msub>       <mo>+</mo>       <msub>        <mi>F</mi>        <mi>rry</mi>       </msub>      </mrow>      <mo>)</mo>     </mrow>    </mrow>    <mo>+</mo>    <mrow>     <mfrac>      <mi>a</mi>      <msub>       <mi>I</mi>       <mi>z</mi>      </msub>     </mfrac>     <mo>&#x2062;</mo>     <mrow>      <mo>(</mo>      <mrow>       <mrow>        <mo>-</mo>        <msub>         <mi>F</mi>         <mi>flx</mi>        </msub>       </mrow>       <mo>+</mo>       <msub>        <mi>F</mi>        <mi>frx</mi>       </msub>       <mo>-</mo>       <msub>        <mi>F</mi>        <mi>rlx</mi>       </msub>       <mo>+</mo>       <msub>        <mi>F</mi>        <mi>rrx</mi>       </msub>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mrow>  </mrow>  <mo>,</mo> </mrow></math></maths></p><p id="p-0134" num="0000">where I<sub>z </sub>is the moment of inertia around yaw z-axis.</p><p id="p-0135" num="0114">The change in all four wheels speed is given through</p><p id="p-0136" num="0000"><maths id="MATH-US-00008" num="00008"><math overflow="scroll"> <mrow>  <mrow>   <mi>d</mi>   <mo>&#x2062;</mo>   <mi>&#x3c9;</mi>  </mrow>  <mo>=</mo>  <mrow>   <mfrac>    <mrow>     <mi>T</mi>     <mo>-</mo>     <msub>      <mi>rF</mi>      <mi>x</mi>     </msub>    </mrow>    <mi>J</mi>   </mfrac>   <mo>.</mo>  </mrow> </mrow></math></maths></p><p id="p-0137" num="0115">Accelerations update are done through the following equations</p><p id="p-0138" num="0000"><maths id="MATH-US-00009" num="00009"><math overflow="scroll"> <mrow>  <mrow>   <msub>    <mi>a</mi>    <mi>x</mi>   </msub>   <mo>=</mo>   <mrow>    <mfrac>     <mn>1</mn>     <mi>m</mi>    </mfrac>    <mo>&#x2062;</mo>    <mrow>     <mo>(</mo>     <mrow>      <msub>       <mi>F</mi>       <mi>flx</mi>      </msub>      <mo>+</mo>      <msub>       <mi>F</mi>       <mi>frx</mi>      </msub>      <mo>+</mo>      <msub>       <mi>F</mi>       <mi>rlx</mi>      </msub>      <mo>+</mo>      <msub>       <mi>F</mi>       <mi>rrx</mi>      </msub>     </mrow>     <mo>)</mo>    </mrow>   </mrow>  </mrow>  <mo>,</mo> </mrow></math></maths><maths id="MATH-US-00009-2" num="00009.2"><math overflow="scroll"> <mrow>  <msub>   <mi>a</mi>   <mi>y</mi>  </msub>  <mo>=</mo>  <mrow>   <mfrac>    <mn>1</mn>    <mi>m</mi>   </mfrac>   <mo>&#x2062;</mo>   <mrow>    <mo>(</mo>    <mrow>     <msub>      <mi>F</mi>      <mi>fly</mi>     </msub>     <mo>+</mo>     <msub>      <mi>F</mi>      <mi>fry</mi>     </msub>     <mo>+</mo>     <msub>      <mi>F</mi>      <mi>rly</mi>     </msub>     <mo>+</mo>     <msub>      <mi>F</mi>      <mi>rry</mi>     </msub>    </mrow>    <mo>)</mo>   </mrow>  </mrow> </mrow></math></maths></p><p id="p-0139" num="0116">Through above described simulations, matrices from the LTV model A<sub>k </sub>and B<sub>k </sub>are obtained, as well as a delta values matrix&#x2014;differences in the vehicle states obtained from the nonlinear and linear model on the whole prediction horizon.</p><p id="p-0140" num="0117">Delta values are used in the objective function of the optimal control problem and are kept constant for all optimization iterations.</p><p id="p-0141" num="0118">In the following, further details of the problem formulation and the optimization as used in a further embodiment of the present invention will be discussed.</p><p id="p-0142" num="0119">Measurements or estimates of the current vehicle state are used to initialize the optimization problem. The Model Predictive Controller starts its planned state trajectory from the current state, and plans control inputs that produce optimal future behavior. The goal at each step is to find the optimal control sequence along the horizon which minimizes the cost function.</p><p id="p-0143" num="0120">With varying the wheel torque inputs u<sub>k </sub>and obtaining corresponding vehicle states through the vehicle model, optimal torques are obtained as the ones where the cost function is minimal and all the constraints satisfied.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001 MATH-US-00001-2" nb-file="US20230001935A1-20230105-M00001.NB"><img id="EMI-M00001" he="12.70mm" wi="76.20mm" file="US20230001935A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00002" nb-file="US20230001935A1-20230105-M00002.NB"><img id="EMI-M00002" he="5.25mm" wi="76.20mm" file="US20230001935A1-20230105-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00003 MATH-US-00003-2 MATH-US-00003-3 MATH-US-00003-4" nb-file="US20230001935A1-20230105-M00003.NB"><img id="EMI-M00003" he="26.08mm" wi="76.20mm" file="US20230001935A1-20230105-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00004" nb-file="US20230001935A1-20230105-M00004.NB"><img id="EMI-M00004" he="5.67mm" wi="76.20mm" file="US20230001935A1-20230105-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00005" nb-file="US20230001935A1-20230105-M00005.NB"><img id="EMI-M00005" he="8.13mm" wi="76.20mm" file="US20230001935A1-20230105-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00006" nb-file="US20230001935A1-20230105-M00006.NB"><img id="EMI-M00006" he="8.13mm" wi="76.20mm" file="US20230001935A1-20230105-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00007 MATH-US-00007-2 MATH-US-00007-3" nb-file="US20230001935A1-20230105-M00007.NB"><img id="EMI-M00007" he="19.39mm" wi="76.20mm" file="US20230001935A1-20230105-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00008" nb-file="US20230001935A1-20230105-M00008.NB"><img id="EMI-M00008" he="5.25mm" wi="76.20mm" file="US20230001935A1-20230105-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00009 MATH-US-00009-2" nb-file="US20230001935A1-20230105-M00009.NB"><img id="EMI-M00009" he="12.36mm" wi="76.20mm" file="US20230001935A1-20230105-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><claims id="claims"><claim id="CLM-001-7" num="001-7"><claim-text><b>1</b>-<b>7</b>. (canceled)</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. A method for controlling motion of a vehicle, the method comprising:<claim-text>obtaining input information on a vector related to the velocity of said vehicle;</claim-text><claim-text>computing repeatably a future trajectory of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; and</claim-text><claim-text>applying the obtained target trial torques to the at least one wheel for controlling the motion of said vehicle.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the vector related to the velocity of said vehicle comprises at least two of:<claim-text>a transversal velocity of said vehicle, a longitudinal velocity of said vehicle, a yaw rate of said vehicle, and a ratio of the transversal velocity of said vehicle and the longitudinal velocity of said vehicle or any derivative or integrated quantity of the above quantities.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method according to <b>9</b>, wherein said input information further comprises information on a motion target of said vehicle.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein<claim-text>said input information further comprises respective angular velocities on respective angular velocities of all four wheels of the vehicle as well as a yaw rate of said vehicle, and</claim-text><claim-text>optimizing said future trajectory includes controlling said yaw rate of said vehicle.</claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The method according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the trial torques to be applied to at least one wheel of said vehicle are calculated by:<claim-text>comparing a computed future trajectory with a target trajectory, and</claim-text><claim-text>determining whether the computed future trajectory is close to a target trajectory.</claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The method according to <claim-ref idref="CLM-00012">claim 12</claim-ref>, comprising:<claim-text>selecting the trial torques that correspond to the computed future trajectory as the target trial torques when the computed future trajectory is close to the target trajectory, and</claim-text><claim-text>when the computed future trajectory is not close to the target trajectory, modifying the trial torques and comparing a computed future trajectory with a target trajectory.</claim-text></claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The method according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein input information further comprises a motion target of said vehicle, and wherein the motion target includes input provided by a driver on at least one of a gas pedal and a braking pedal of said vehicle.</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. A vehicle configured to execute a method for controlling motion of said vehicle, the method comprising:<claim-text>obtaining input information on a vector related to the velocity of said vehicle;</claim-text><claim-text>computing repeatably a future trajectory of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; and</claim-text><claim-text>applying the obtained target trial torques to the at least one wheel for controlling the motion of said vehicle.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. (canceled)</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. A device comprising an interface to a vehicle, said vehicle providing input information on a vector related to the velocity of said vehicle to said device via said interface, wherein<claim-text>said device is configured to:</claim-text><claim-text>compute repeatably a future trajectory of said vehicle based on said input information and trial torques to be applied to at least one wheel of said vehicle for optimizing said future trajectory in view of a target vehicle motion, thereby obtaining target trial torques; and</claim-text><claim-text>output the obtained target trial torques to said vehicle to be applied to the at least one wheel for controlling the motion of said vehicle.</claim-text></claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The device as claimed in <claim-ref idref="CLM-00017">claim 17</claim-ref> further comprising:<claim-text>a yaw rate target calculation component adapted to calculate a yaw rate target based on a current state of the vehicle, and</claim-text><claim-text>a model predictive control problem formulation component adapted to create a model predictive control problem suited to the vehicle's current state and desired behavior, wherein the model predictive control problem is being formulated as a finite horizon open-loop optimal control problem.</claim-text></claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The device as claimed in <claim-ref idref="CLM-00018">claim 18</claim-ref> further comprising:<claim-text>a quadratic program solver component adapted to calculate the torque commands, to be applied to at least one of the wheels of the vehicle.</claim-text></claim-text></claim></claims></us-patent-application>