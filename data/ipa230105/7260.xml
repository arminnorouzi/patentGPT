<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007261A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007261</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17470095</doc-number><date>20210909</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>CN</country><doc-number>PCT/CN2019/000051</doc-number><date>20190310</date></priority-claim><priority-claim sequence="02" kind="national"><country>CN</country><doc-number>PCT/CN2019/078148</doc-number><date>20190314</date></priority-claim><priority-claim sequence="03" kind="national"><country>CN</country><doc-number>PCT/CN2019/081933</doc-number><date>20190409</date></priority-claim><priority-claim sequence="04" kind="national"><country>CN</country><doc-number>PCT/CN2019/088453</doc-number><date>20190525</date></priority-claim><priority-claim sequence="05" kind="national"><country>CN</country><doc-number>PCT/CN2019/106487</doc-number><date>20190918</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>132</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>105</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>159</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>70</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>46</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>186</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>176</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>132</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>105</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>159</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>176</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>46</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>186</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>70</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e134">COMBINED SCREEN CONTENT CODING MODE</invention-title><us-related-documents><continuation><relation><parent-doc><document-id><country>US</country><doc-number>PCT/CN2020/078536</doc-number><date>20200310</date></document-id><parent-status>PENDING</parent-status></parent-doc><child-doc><document-id><country>US</country><doc-number>17470095</doc-number></document-id></child-doc></relation></continuation></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Beijing Bytedance Network Technology Co., Ltd.</orgname><address><city>Beijing</city><country>CN</country></address></addressbook><residence><country>CN</country></residence></us-applicant><us-applicant sequence="01" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Bytedance Inc.</orgname><address><city>Los Angeles</city><state>CA</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>ZHU</last-name><first-name>Weijia</first-name><address><city>San Diego</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>XU</last-name><first-name>Jizheng</first-name><address><city>San Diego</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>ZHANG</last-name><first-name>Li</first-name><address><city>San Diego</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>ZHANG</last-name><first-name>Kai</first-name><address><city>San Diego</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>LIU</last-name><first-name>Hongbin</first-name><address><city>Beijing</city><country>CN</country></address></addressbook></inventor><inventor sequence="05" designation="us-only"><addressbook><last-name>WANG</last-name><first-name>Yue</first-name><address><city>Beijing</city><country>CN</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A method of visual media processing video, includes determining that palette mode is to be used for processing a first portion of a video block and intra block copy (IBC) mode is to be used for processing a second portion of the video block, and performing further processing of the first portion of the video block using the palette mode and the second portion of the video using the IBC mode, wherein indications of the first portion of the video block processed using the palette mode and indications of the second portion of the video block processed using the IBC mode are included in a palette index identifying the first portion of the video block and the second portion of the video block.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="123.87mm" wi="158.75mm" file="US20230007261A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="131.66mm" wi="135.55mm" orientation="landscape" file="US20230007261A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="202.18mm" wi="139.36mm" orientation="landscape" file="US20230007261A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="188.21mm" wi="135.38mm" orientation="landscape" file="US20230007261A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="203.03mm" wi="135.72mm" orientation="landscape" file="US20230007261A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="211.41mm" wi="135.13mm" orientation="landscape" file="US20230007261A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="189.40mm" wi="135.64mm" orientation="landscape" file="US20230007261A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="106.34mm" wi="154.01mm" orientation="landscape" file="US20230007261A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="188.72mm" wi="128.78mm" orientation="landscape" file="US20230007261A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="116.59mm" wi="109.98mm" orientation="landscape" file="US20230007261A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="171.03mm" wi="136.06mm" orientation="landscape" file="US20230007261A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="211.67mm" wi="173.40mm" orientation="landscape" file="US20230007261A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="205.15mm" wi="178.22mm" orientation="landscape" file="US20230007261A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATIONS</heading><p id="p-0002" num="0001">This application is a continuation of International Patent Application No. PCT/CN2020/078536, filed on Mar. 10, 2020, which claims the priority to and benefits of International Patent Application No. PCT/CN2019/000051, filed on Mar. 10, 2019, International Patent Application No. PCT/CN2019/078148, filed on Mar. 14, 2019, International Patent Application No. PCT/CN2019/081933, filed on Apr. 9, 2019, International Patent Application No. PCT/CN2019/088453, filed on May 25, 2019, and International Patent Application No. PCT/CN2019/106487, filed on Sep. 18, 2019. The aforementioned applications are incorporated by reference as part of the disclosure of this application.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">This document is related to video and image coding and decoding technologies, devices and systems.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">Digital video accounts for the largest bandwidth use on the internet and other digital communication networks. As the number of connected user devices capable of receiving and displaying video increases, it is expected that the bandwidth demand for digital video usage will continue to grow.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0005" num="0004">The present document describes various embodiments and techniques for buffer management and block vector coding for intra block copy mode for decoding or encoding video or images.</p><p id="p-0006" num="0005">In one example aspect, a method for visual media processing is disclosed. The method includes determining, for a conversion between a video block of visual media data and a bitstream representation of the video block, that palette mode is to be used for processing a first portion of the video block and intra block copy (IBC) mode is to be used for processing a second portion of the video block wherein, in the palette mode, samples of the first portion of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, samples of the second portion of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks; and performing, during the conversion, further processing of the first portion of the video block using the palette mode and further processing of the second portion of the video block based on a prediction block derived using the IBC mode, wherein indications of the first portion of the video block processed using the palette mode and indications of the second portion of the video block processed using the IBC mode are included in a palette index map that identifies the first portion of the video block and the second portion of the video block.</p><p id="p-0007" num="0006">In another example aspect, another method for visual media processing is disclosed. The method includes determining, for samples of a video block, that a first combined palette and intra block copy (IBC) mode are to be used for processing the samples, wherein, in the palette mode, the samples of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, the samples of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks, wherein the samples of the video bock are associated with a palette index indicative of an INDEX mode or a COPY_ABOVE mode, wherein in the INDEX mode or in the COPY_ABOVE mode, the palette index of the current block is derived by copying a previously-coded index; and performing a conversion between the video block and a bitstream representation of the video block.</p><p id="p-0008" num="0007">In yet another example aspect, a video encoder or decoder apparatus comprising a processor configured to implement an above described method is disclosed.</p><p id="p-0009" num="0008">In another example aspect, a computer readable program medium is disclosed. The medium stores code that embodies processor executable instructions for implementing one of the disclosed methods.</p><p id="p-0010" num="0009">These, and other, aspects are described in greater details in the present document.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows an example of intra block copy.</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows an example of a block coded in palette mode.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>3</b></figref> shows an example of use of a palette predictor to signal palette entries.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>4</b></figref> shows an example of horizontal and vertical traverse scans.</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>5</b></figref> shows an example of coding of palette indices.</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a block diagram of an example of a hardware platform for implementing a visual media decoding or a visual media encoding technique described in the present document.</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>7</b></figref> shows a flowchart of an example method for video coding.</p><p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a pictorial depiction of a method that refines prediction block according to the palette information.</p><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>9</b></figref> shows an example of above and left neighboring blocks of current block.</p><p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a block diagram of an example video processing system in which disclosed techniques may be implemented.</p><p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. <b>11</b></figref> is a flowchart of an example method of visual data processing.</p><p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. <b>12</b></figref> is a flowchart of an example method of visual data processing.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION</heading><heading id="h-0007" level="1">1. Video Coding in HEVC/H.265</heading><p id="p-0023" num="0022">Video coding standards have evolved primarily through the development of the well-known ITU-T and ISO/IEC standards. The ITU-T produced H.261 and H.263, ISO/IEC produced MPEG-1 and MPEG-4 Visual, and the two organizations jointly produced the H.262/MPEG-2 Video and H.264/MPEG-4 Advanced Video Coding (AVC) and H.265/HEVC standards. Since H.262, the video coding standards are based on the hybrid video coding structure wherein temporal prediction plus transform coding are utilized. To explore the future video coding technologies beyond HEVC, Joint Video Exploration Team (JVET) was founded by VCEG and MPEG jointly in 2015. Since then, many new methods have been adopted by JVET and put into the reference software named Joint Exploration Model (JEM). In April 2018, the Joint Video Expert Team (JVET) between VCEG (Q6/16) and ISO/IEC JTC1 SC29/WG11 (MPEG) was created to work on the VVC standard targeting at 50% bitrate reduction compared to HEVC. The latest version of VVC draft, i.e., Versatile Video Coding (Draft 4) could be found at: http://phenix.it-sudparis.eudvet/doc_end_user/current_document.php?id=5755. The latest reference software of VVC, named VTM, could be found at: https://vcgit.hhi.fraunhoferdedvet/VVCSoftware_VTM/tags/VTM-4.0.</p><heading id="h-0008" level="2">2.1. Intra Block Copy</heading><p id="p-0024" num="0023">Intra block copy (IBC), a.k.a. current picture referencing, has been adopted in HEVC Screen Content Coding extensions (HEVC-SCC) and the current VVC test model (VTM-4.0). IBC extends the concept of motion compensation from inter-frame coding to intra-frame coding. As demonstrated in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the current block is predicted by a reference block in the same picture when IBC is applied. The samples in the reference block must have been already reconstructed before the current block is coded or decoded. Although IBC is not so efficient for most camera-captured sequences, it shows significant coding gains for screen content. The reason is that there are lots of repeating patterns, such as icons and text characters in a screen content picture. IBC can remove the redundancy between these repeating patterns effectively. In HEVC-SCC, an inter-coded coding unit (CU) can apply IBC if it chooses the current picture as its reference picture. The MV is renamed as block vector (BV) in this case, and a BV always has an integer-pixel precision. To be compatible with main profile HEVC, the current picture is marked as a &#x201c;long-term&#x201d; reference picture in the Decoded Picture Buffer (DPB). It should be noted that similarly, in multiple view/3D video coding standards, the inter-view reference picture is also marked as a &#x201c;long-term&#x201d; reference picture.</p><p id="p-0025" num="0024">Following a BV to find its reference block, the prediction can be generated by copying the reference block. The residual can be got by subtracting the reference pixels from the original signals. Then transform and quantization can be applied as in other coding modes.</p><p id="p-0026" num="0025">However, when a reference block is outside of the picture, or overlaps with the current block, or outside of the reconstructed area, or outside of the valid area restricted by some constrains, part or all pixel values are not defined. Basically, there are two solutions to handle such a problem. One is to disallow such a situation, e.g., in bitstream conformance. The other is to apply padding for those undefined pixel values. The following sub-sessions describe the solutions in detail.</p><heading id="h-0009" level="2">2.2. IBC in HEVC Screen Content Coding Extensions</heading><p id="p-0027" num="0026">In the screen content coding extensions of HEVC, when a block uses current picture as reference, it should guarantee that the whole reference block is within the available reconstructed area, as indicated in the following text in the standards specification: The variables off setX and off setY are derived as follows:</p><p id="p-0028" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>offset<i>X</i>=(ChromaArrayType==0)?0:(mv<i>CLX</i>[0] &#x26; 0<i>x</i>7?2:0)&#x2003;&#x2003; (8-104)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0029" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>offset<i>Y</i>=(ChromaArrayType==0)?0:(mv<i>CLX</i>[1] &#x26; 0<i>x</i>7?2:0)&#x2003;&#x2003; (8-105)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0030" num="0027">It is a requirement of bitstream conformance that when the reference picture is the current picture, the luma motion vector mvLX shall obey the following constraints:<ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0000">    <ul id="ul0002" list-style="none">        <li id="ul0002-0001" num="0028">When the derivation process for z-scan order block availability as specified in clause 6.4.1 is invoked with (xCurr, yCurr) set equal to (xCb, yCb) and the neighbouring luma location (xNbY, yNbY) set equal to (xPb+(mvLX[0]&#x3e;&#x3e;2)&#x2212;offsetX, yPb+(mvLX[1]&#x3e;&#x3e;2)&#x2212;offsetY) as inputs, the output shall be equal to TRUE.</li>        <li id="ul0002-0002" num="0029">When the derivation process for z-scan order block availability as specified in clause 6.4.1 is invoked with (xCurr, yCurr) set equal to (xCb, yCb) and the neighbouring luma location (xNbY, yNbY) set equal to (xPb+(mvLX[0]&#x3e;&#x3e;2)+nPbW&#x2212;1+offsetX, yPb+(mvLX[1]&#x3e;&#x3e;2)+nPbH&#x2212;1+offsetY) as inputs, the output shall be equal to TRUE.</li>        <li id="ul0002-0003" num="0030">One or both of the following conditions shall be true:        <ul id="ul0003" list-style="none">            <li id="ul0003-0001" num="0031">The value of (mvLX[0]&#x3e;&#x3e;2)+nPbW+xB1+offsetX is less than or equal to 0.</li>            <li id="ul0003-0002" num="0032">The value of (mvLX[1]&#x3e;&#x3e;2)+nPbH+yB1+offsetY is less than or equal to 0.</li>        </ul>        </li>        <li id="ul0002-0004" num="0033">The following condition shall be true:</li>    </ul>    </li></ul></p><p id="p-0031" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>(<i>xPb</i>+(mv<i>LX</i>[0]&#x3e;&#x3e;2)+<i>nPbSw</i>&#x2212;1+offset<i>X</i>)/<i>Ctb</i>Size<i>Y&#x2212;xCb/Ctb</i>Size<i>Y&#x3c;=yCb/Ctb</i>Size<i>Y</i>&#x2212;(<i>yPb</i>+(mv<i>LX</i>[1]&#x3e;&#x3e;2)+<i>nPbSh&#x2212;</i>1+offset<i>Y</i>)/<i>Ctb</i>Size<i>Y</i>&#x2003;&#x2003;(8-106)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0032" num="0034">Thus, the case that the reference block overlaps with the current block or the reference block is outside of the picture will not happen. There is no need to pad the reference or prediction block.</p><heading id="h-0010" level="2">2.3. IBC in VVC Test Model</heading><p id="p-0033" num="0035">In the current VVC test model, i.e., VTM-4.0 design, the whole reference block should be with the current coding tree unit (CTU) and does not overlap with the current block. Thus, there is no need to pad the reference or prediction block. The IBC flag is coded as a prediction mode of the current CU. Thus, there are totally three prediction modes, MODE_INTRA, MODE_INTER and MODE_IBC for each CU.</p><heading id="h-0011" level="2">2.3.1. IBC Merge Mode</heading><p id="p-0034" num="0036">In IBC merge mode, an index pointing to an entry in the IBC merge candidates list is parsed from the bitstream. The construction of the IBC merge list can be summarized according to the following sequence of steps:<ul id="ul0004" list-style="none">    <li id="ul0004-0001" num="0000">    <ul id="ul0005" list-style="none">        <li id="ul0005-0001" num="0037">Step 1: Derivation of spatial candidates</li>        <li id="ul0005-0002" num="0038">Step 2: Insertion of history-based motion vector prediction (HMVP) candidates</li>        <li id="ul0005-0003" num="0039">Step 3: Insertion of pairwise average candidates</li>    </ul>    </li></ul></p><p id="p-0035" num="0040">In the derivation of spatial merge candidates, a maximum of four merge candidates are selected among candidates located in the positions depicted in the figures. The order of derivation is A1, B1, B0, A0 and B2. Position B2 is considered only when any PU of position A1, B1, B0, A0 is not available (e.g., because it belongs to another slice or tile) or is not coded with IBC mode. After candidate at position A1 is added, the insertion of the remaining candidates is subject to a redundancy check which ensures that candidates with same motion information are excluded from the list so that coding efficiency is improved. To reduce computational complexity, not all possible candidate pairs are considered in the mentioned redundancy check. Instead only the pairs linked with an arrow in depicted in the figures are considered and a candidate is only added to the list if the corresponding candidate used for redundancy check has not the same motion information.</p><p id="p-0036" num="0041">After insertion of the spatial candidates, if the IBC merge list size is still smaller than the maximum IBC merge list size, IBC candidates from HMVP table may be inserted. Redundancy check are performed when inserting the HMVP candidates.</p><p id="p-0037" num="0042">Finally, pairwise average candidates are inserted into the IBC merge list.</p><p id="p-0038" num="0043">When a reference block identified by a merge candidate is outside of the picture, or overlaps with the current block, or outside of the reconstructed area, or outside of the valid area restricted by some constrains, the merge candidate is called invalid merge candidate.</p><p id="p-0039" num="0044">It is noted that invalid merge candidates may be inserted into the IBC merge list.</p><heading id="h-0012" level="2">2.3.2. IBC AMVP Mode</heading><p id="p-0040" num="0045">In IBC AMVP mode, an AMVP index point to an entry in the IBC AMVP list is parsed from the bitstream. The construction of the IBC AMVP list can be summarized according to the following sequence of steps:<ul id="ul0006" list-style="none">    <li id="ul0006-0001" num="0000">    <ul id="ul0007" list-style="none">        <li id="ul0007-0001" num="0046">Step 1: Derivation of spatial candidates        <ul id="ul0008" list-style="none">            <li id="ul0008-0001" num="0047">Check A<sub>0</sub>, A<sub>1 </sub>until an available candidate is found.</li>            <li id="ul0008-0002" num="0048">Check B<sub>0</sub>, B<sub>1</sub>, B<sub>2 </sub>until an available candidate is found.</li>        </ul>        </li>        <li id="ul0007-0002" num="0049">Step 2: Insertion of HMVP candidates</li>        <li id="ul0007-0003" num="0050">Step 3: Insertion of zero candidates</li>    </ul>    </li></ul></p><p id="p-0041" num="0051">After insertion of the spatial candidates, if the IBC AMVP list size is still smaller than the maximum IBC AMVP list size, IBC candidates from HMVP table may be inserted.</p><p id="p-0042" num="0052">Finally, zero candidates are inserted into the IBC AMVP list.</p><heading id="h-0013" level="2">2.4. Palette Mode</heading><p id="p-0043" num="0053">The basic idea behind a palette mode is that the samples in the CU are represented by a small set of representative colour values. This set is referred to as the palette. It is also possible to indicate a sample that is outside the palette by signaling an escape symbol followed by (possibly quantized) component values. This is illustrated in <figref idref="DRAWINGS">FIG. <b>2</b></figref>.</p><heading id="h-0014" level="2">2.5. Palette Mode in HEVC Screen Content Coding Extensions (HEVC-SCC)</heading><p id="p-0044" num="0054">In the palette mode in HEVC-SCC, a predictive way is used to code the palette and index map.</p><heading id="h-0015" level="2">2.5.1. CODING OF THE PALETTE ENTRIES</heading><p id="p-0045" num="0055">For coding of the palette entries, a palette predictor is maintained. The maximum size of the palette as well as the palette predictor is signalled in the SPS. In HEVC-SCC, a palette_predictor_initializer_present_flag is introduced in the PPS. When this flag is 1, entries for initializing the palette predictor are signalled in the bitstream. The palette predictor is initialized at the beginning of each CTU row, each slice and each tile. Depending on the value of the palette_predictor_initializer_present_flag, the palette predictor is reset to 0 or initialized using the palette predictor intializer entries signalled in the PPS. In HEVC-SCC, a palette predictor initializer of size 0 was enabled to allow explicit disabling of the palette predictor initialization at the PPS level.</p><p id="p-0046" num="0056">For each entry in the palette predictor, a reuse flag is signalled to indicate whether it is part of the current palette. This is illustrated in <figref idref="DRAWINGS">FIG. <b>3</b></figref>. The reuse flags are sent using run-length coding of zeros. After this, the number of new palette entries are signalled using exponential Golomb code of order 0. Finally, the component values for the new palette entries are signalled.</p><heading id="h-0016" level="2">2.5.2. Coding of Palette Indices</heading><p id="p-0047" num="0057">The palette indices are coded using horizontal and vertical traverse scans as shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>. The scan order is explicitly signalled in the bitstream using the palette_transpose_flag. For the rest of the subsection it is assumed that the scan is horizontal.</p><p id="p-0048" num="0058">The palette indices are coded using two main palette sample modes: &#x2018;INDEX&#x2019; and &#x2018;COPY_ABOVE&#x2019;. As explained previously, the escape symbol is also signalled as an &#x2018;INDEX&#x2019; mode and assigned an index equal to the maximum palette size. The mode is signalled using a flag except for the top row or when the previous mode was &#x2018;COPY_ABOVE&#x2019;. In the &#x2018;COPY_ABOVE&#x2019; mode, the palette index of the sample in the row above is copied. In the &#x2018;INDEX&#x2019; mode, the palette index is explicitly signalled. For both &#x2018;INDEX&#x2019; and &#x2018;COPY_ABOVE&#x2019; modes, a run value is signalled which specifies the number of subsequent samples that are also coded using the same mode. When escape symbol is part of the run in &#x2018;INDEX&#x2019; or &#x2018;COPY_ABOVE&#x2019; mode, the escape component values are signalled for each escape symbol. The coding of palette indices is illustrated in <figref idref="DRAWINGS">FIG. <b>5</b></figref>.</p><p id="p-0049" num="0059">This syntax order is accomplished as follows. First the number of index values for the CU is signaled. This is followed by signaling of the actual index values for the entire CU using truncated binary coding. Both the number of indices as well as the index values are coded in bypass mode. This groups the index-related bypass bins together. Then the palette sample mode (if necessary) and run are signaled in an interleaved manner. Finally, the component escape values corresponding to the escape samples for the entire CU are grouped together and coded in bypass mode.</p><p id="p-0050" num="0060">An additional syntax element, last run_type_flag, is signaled after signaling the index values. This syntax element, in conjunction with the number of indices, eliminates the need to signal the run value corresponding to the last run in the block.</p><p id="p-0051" num="0061">In HEVC-SCC, the palette mode is enabled for 4:4:4. 4:2:2, 4:2:0, and monochrome chroma formats. The signaling of the palette entries and palette indices is almost identical for all the chroma formats. In case of non-monochrome formats, each palette entry consists of 3 components. For the monochrome format, each palette entry consists of a single component. For subsampled chroma directions, the chroma samples are associated with luma sample indices that are divisible by 2. After reconstructing the palette indices for the CU, if a sample has only a single component associated with it, only the first component of the palette entry is used. The only difference in signaling is for the escape component values. For each escape sample, the number of escape component values signaled may be different depending on the number of components associated with that sample.</p><p id="p-0052" num="0000">2.6. Palette Mode Combining with Intra prediction (PCIP)</p><p id="p-0053" num="0062">In JVET-M0051, the palette mode combined with intra prediction is proposed. In this scheme, the decoder first derives the prediction block based on the intra prediction methods. Then, the decoder decodes a palette and an index map. Using the decoding palette information, the decoder refines the prediction block and reconstructs the block.</p><p id="p-0054" num="0063"><figref idref="DRAWINGS">FIG. <b>8</b></figref> shows an example combining the palette information and the intra prediction information. First, the decoder generates the prediction block (with pixel values A0-A15). And, the decoder decodes an index map in the palette mode. To reconstruct the block, if the decoded indices equal to &#x201c;0&#x201d;, the corresponding pixels are marked as &#x201c;P&#x201d; as shown in <figref idref="DRAWINGS">FIG. <b>8</b></figref>. The pixels marked as &#x201c;P&#x201d; is reconstructed by pixel values in the intra prediction block. Otherwise, the pixels are reconstructed by palette colors, e.g., C0, C1.</p><heading id="h-0017" level="1">3. Drawbacks of Existing Implementations</heading><p id="p-0055" num="0064">The palette mode only can use the samples inside the current block, which may limit its efficiency on screen content coding that usually shows non-local repeated patterns. It would be better if the palette mode can exploit both the local and non-local correlations.</p><heading id="h-0018" level="1">4. Example Embodiments and Techniques</heading><p id="p-0056" num="0065">The embodiments detailed below should be considered as examples to explain general concepts. These embodiments should not be interpreted in a narrow way. Furthermore, these embodiments can be combined in any manner.</p><p id="p-0057" num="0066">The proposed method is named Palette and Intra Block Copy Combined Prediction (PICP).<ul id="ul0009" list-style="none">    <li id="ul0009-0001" num="0000">    <ul id="ul0010" list-style="none">        <li id="ul0010-0001" num="0067">1. It is proposed to reconstruct one block with some samples are predicted from the IBC mode and some are predicted from the palette mode and the indication of which sample predicted from IBC or palette mode may be indicated by a specific palette index.        <ul id="ul0011" list-style="none">            <li id="ul0011-0001" num="0068">a. In one example, the reconstructions in the palette mode may copy the collocated samples in IBC prediction.</li>            <li id="ul0011-0002" num="0069">b. In one example, the indication of usage of copying from IBC prediction in the palette mode may be according to the index value in the index map.            <ul id="ul0012" list-style="none">                <li id="ul0012-0001" num="0070">i. In one example, when the specific index value is 0, the current sample may be reconstructed by copying the collocated sample in the IBC prediction. Alternatively, furthermore, the current sample may be reconstructed by copying the collocated sample in the IBC prediction when the current index value is 0.</li>                <li id="ul0012-0002" num="0071">ii. In one example, when the specific index value is equal to the number of palette entries minus 1, the current sample may be reconstructed by copying the collocated sample in the IBC prediction. Alternatively, furthermore, the current sample may be reconstructed by copying the collocated sample in the IBC prediction when the current index value is the number of palette entries minus 1.</li>                <li id="ul0012-0003" num="0072">iii. In one example, when the specific index value is equal to T, the current sample may be reconstructed by copying the collocated sample in the IBC prediction. Alternatively, furthermore, the current sample may be reconstructed by copying the collocated sample in the IBC prediction when the current index value is T. In one example, T is an integer positive number. Alternatively, furthermore, in one example, T may be based on                <ul id="ul0013" list-style="none">                    <li id="ul0013-0001" num="0073">1) block dimension of current block</li>                    <li id="ul0013-0002" num="0074">2) Current quantization parameter of current block</li>                    <li id="ul0013-0003" num="0075">3) Indication of the color format (such as 4:2:0, 4:4:4)</li>                    <li id="ul0013-0004" num="0076">4) Separate/dual coding tree structure</li>                    <li id="ul0013-0005" num="0077">5) Slice/tile group type and/or picture type</li>                    <li id="ul0013-0006" num="0078">6) T is signaled in the bitstream</li>                </ul>                </li>                <li id="ul0012-0004" num="0079">iv. In one example, the number of consecutive sample/pixel values copied from IBC prediction may be signaled.</li>                <li id="ul0012-0005" num="0080">v. In one example, the sample/pixel value copied from IBC prediction may be added as an entry to the palette predictor.                <ul id="ul0014" list-style="none">                    <li id="ul0014-0001" num="0081">1) Alternatively, in one example, the sample/pixel value copied from IBC prediction may be utilized to replace the existing entries in the palette predictor.</li>                    <li id="ul0014-0002" num="0082">2) Alternatively, furthermore, before adding the sample/pixel value copied from IBC prediction to the palette predictor, pruning may be applied to avoid duplicated sample/pixel values.</li>                    <li id="ul0014-0003" num="0083">3) In one example, the sample/pixel value copied from IBC prediction may be utilized to reorder entries in the palette predictor.</li>                </ul>                </li>            </ul>            </li>            <li id="ul0011-0003" num="0084">c. In one example, the indication of usage of copying from IBC prediction in the palette mode may be derived from coded information. In such a case, it is not necessary to send a special index to indicate if IBC is used or not.            <ul id="ul0015" list-style="none">                <li id="ul0015-0001" num="0085">i. In one example, for a chroma sample, if its co-located luma sample is coded in IBC mode, the sample may be inferred to be coded in IBC mode also.</li>                <li id="ul0015-0002" num="0086">ii. In one example, for a chroma sample, if its co-located sample in other color component is coded in IBC mode, the sample may be inferred to be coded in IBC mode also.</li>            </ul>            </li>            <li id="ul0011-0004" num="0087">d. In one example, the indication of usage of copying from IBC prediction in the palette mode may be signaled (e.g., plt_combined_ibc_sample_flag).            <ul id="ul0016" list-style="none">                <li id="ul0016-0001" num="0088">i. In one example, the current sample may be reconstructed by copying the collocated sample in the IBC prediction when the plt_combined_ibc_sample_flag is 1. Alternatively, furthermore, when the plt_combined_ibc_sample_flag is 1, the current sample may be reconstructed by copying the collocated sample in the IBC prediction.</li>                <li id="ul0016-0002" num="0089">ii. In one example, the current sample may be reconstructed by copying the collocated sample in the IBC prediction, which may be based on the value of the plt_combined_ibc_sample_flag of the neighboring samples.                <ul id="ul0017" list-style="none">                    <li id="ul0017-0001" num="0090">1) In one example, plt_combined_ibc_sample_flag may be inferred to 0 if the current sample doesn't have neighboring samples.</li>                    <li id="ul0017-0002" num="0091">2) In one example, the value of current plt_combined_ibc_sample_flag may be derived based on plt_combined_ibc_sample_flag of its left and/or above neighbor.</li>                    <li id="ul0017-0003" num="0092">3) In one example, the current plt_combined_ibc_sample_flag may be 1 when the value of plt_combined_ibc_sample_flag of its left and/or above neighbor is 1. Alternatively, furthermore, when the value of plt_combined_ibc_sample_flag of its left and/or above neighbor is 1, the current plt_combined_ibc_sample_flag may be 1.</li>                </ul>                </li>            </ul>            </li>            <li id="ul0011-0005" num="0093">e. In one example, the motion information of IBC prediction in the proposed method can be derived by the IBC merge mode or IBC AMVP mode.            <ul id="ul0018" list-style="none">                <li id="ul0018-0001" num="0094">i. In one example, the IBC merge mode or IBC AMVP mode on large blocks may be employed in the proposed method                <ul id="ul0019" list-style="none">                    <li id="ul0019-0001" num="0095">1) In one example, large block may be defined as current_block.width&#x3e;=T&#x2225;current_block.height&#x3e;=T, where the current_block.width and current_block.height denote the width and height of the current block respectively. T may be a fixed number (e.g., 16) and based on</li>                    <li id="ul0019-0002" num="0000">&#x2003;a) block dimension of current block</li>                    <li id="ul0019-0003" num="0000">&#x2003;b) Current quantization parameter of current block</li>                    <li id="ul0019-0004" num="0000">&#x2003;c) Indication of the color format (such as 4:2:0, 4:4:4)</li>                    <li id="ul0019-0005" num="0000">&#x2003;d) Separate/dual coding tree structure</li>                    <li id="ul0019-0006" num="0000">&#x2003;e) Slice/tile group type and/or picture type</li>                    <li id="ul0019-0007" num="0000">&#x2003;f) T is signaled in the bitstream</li>                </ul>                </li>                <li id="ul0018-0002" num="0096">ii. In one example, the IBC AMVP mode may be always employed in the proposed method.</li>                <li id="ul0018-0003" num="0097">iii. In one example, the IBC merge mode may be always employed in the proposed method.</li>                <li id="ul0018-0004" num="0098">iv. In one example, the IBC merge mode may be always employed and only the first available merge candidate in the merge list may be always employed.</li>                <li id="ul0018-0005" num="0099">v. In one example, the first valid merge candidate in the IBC AMVP/merge list may be utilized in the proposed method to derive IBC prediction.                <ul id="ul0020" list-style="none">                    <li id="ul0020-0001" num="0100">1) Alternatively, if none of the candidates in the IBC AMVP/merge list is valid, a default block vector may be utilized instead.</li>                    <li id="ul0020-0002" num="0000">&#x2003;a) In one example, the default block vector may be pre-defined or based on the decoded information, such as block dimension and/or block position.</li>                </ul>                </li>                <li id="ul0018-0006" num="0101">vi. In one example, the block vector to be utilized in the proposed method to derive IBC prediction may be derived or inherited from the HMVP table.</li>                <li id="ul0018-0007" num="0102">vii. In one example, the block vector to be utilized in the proposed method to derive IBC prediction may be derived or inherited from the IBC merge/AMVP candidates in the IBC merge/AMVP candidate list.                <ul id="ul0021" list-style="none">                    <li id="ul0021-0001" num="0103">1) Alternatively, indication of the block vector to be utilized in the proposed method to derive IBC prediction may be signaled in the bitstream.</li>                    <li id="ul0021-0002" num="0000">&#x2003;a) In one example, an index of IBC AMVP/merge candidate in the IBC AMVP/merge candidate list may be signaled.</li>                    <li id="ul0021-0003" num="0000">&#x2003;b) In one example, an index of valid IBC AMVP/merge candidate in the IBC AMVP/merge candidate list excluding invalid candidates may be signaled wherein only valid candidates are allowed to be selected.</li>                </ul>                </li>                <li id="ul0018-0008" num="0104">viii. In one example, indication of the block vector to be utilized in the proposed method to derive IBC prediction may be signaled, such as BV difference compared to a candidate in the IBC merge/AMVP candidate list may be signaled.</li>                <li id="ul0018-0009" num="0105">ix. In one example, when dual tree is enabled, the IBC mode for chroma blocks may be modified as follows.                <ul id="ul0022" list-style="none">                    <li id="ul0022-0001" num="0106">1) In one example, the chroma motion vectors (block vectors) may be derived by scaling the collocated luma motion vectors (block vectors) based on the chroma format.</li>                    <li id="ul0022-0002" num="0107">2) In one example, the chroma motion vectors (block vectors) may be derived by scaling the neighboring motion vectors (block vectors) of the collocated luma blocks based on the chroma format.</li>                    <li id="ul0022-0003" num="0108">3) In one example, the motion vector (block vector) of each chroma sub blocks (e.g., 2&#xd7;2) may be derived by averaging all available luma motion vectors based on the chroma format.</li>                </ul>                </li>            </ul>            </li>            <li id="ul0011-0006" num="0109">f. In one example, the indication of the usage of copying from IBC predictions in palette mode may be based on            <ul id="ul0023" list-style="none">                <li id="ul0023-0001" num="0110">i. block dimension of current block</li>                <li id="ul0023-0002" num="0111">ii. Current quantization parameter of current block</li>                <li id="ul0023-0003" num="0112">iii. Indication of the color format (such as 4:2:0, 4:4:4)</li>                <li id="ul0023-0004" num="0113">iv. Separate/dual coding tree structure</li>                <li id="ul0023-0005" num="0114">v. Slice/tile group type and/or picture type</li>            </ul>            </li>        </ul>        </li>        <li id="ul0010-0002" num="0115">2. The reconstructions of escape pixels in the palette mode may be based on the collocated samples in IBC prediction.        <ul id="ul0024" list-style="none">            <li id="ul0024-0001" num="0116">a. In one example, the residue between original samples and IBC predictions may be signalled for escape pixels.</li>            <li id="ul0024-0002" num="0117">b. In one example, the quantized residue between original samples and IBC predictions may be signalled.</li>            <li id="ul0024-0003" num="0118">c. In one example, the sign of the quantized residue between original samples and IBC predictions may be signalled.</li>        </ul>        </li>        <li id="ul0010-0003" num="0119">3. The reconstructions of escape pixels in the palette mode may be based on the collocated samples in the intra prediction.        <ul id="ul0025" list-style="none">            <li id="ul0025-0001" num="0120">a. In one example, the residue between original samples and intra predictions may be signalled for escape pixels.</li>            <li id="ul0025-0002" num="0121">b. In one example, the quantized residue between original samples and intra predictions may be signalled.</li>            <li id="ul0025-0003" num="0122">c. In one example, the sign of the quantized residue between original samples and intra predictions may be signalled.</li>        </ul>        </li>        <li id="ul0010-0004" num="0123">4. The palette mode and/or IBC mode may be performed at sub block level for one block        <ul id="ul0026" list-style="none">            <li id="ul0026-0001" num="0124">a. In one example, whether to enable palette/IBC mode may be decided in the sub-block level, e.g., 4&#xd7;4 luma block and/or 2&#xd7;2 chroma blocks.</li>            <li id="ul0026-0002" num="0125">b. In one example, the usage of chroma IBC may be firstly decided at sub block level. Then the palette mode may be applied to sub-blocks with chroma IBC disabled.            <ul id="ul0027" list-style="none">                <li id="ul0027-0001" num="0126">i. In one example, if the current chroma sub block is not coded in IBC mode, it may be coded in palette mode.                <ul id="ul0028" list-style="none">                    <li id="ul0028-0001" num="0127">1) In one example, if the collocated luma block of the current chroma sub-block is not coded in IBC mode, the current chroma sub block may be coded in palette mode.</li>                    <li id="ul0028-0002" num="0128">2) In one example, if the IBC prediction block of the current chroma sub-block is not reconstructed yet, the current chroma sub block may be coded in palette mode.</li>                </ul>                </li>                <li id="ul0027-0002" num="0129">ii. In one example, on the current sub-block, the chroma IBC may be enabled or disabled based on the prediction mode of its collocated luma block. Alternatively, furthermore, if collocated luma block of the current chroma sub-block is coded in IBC mode, that chroma sub block may be coded in IBC mode as well.</li>                <li id="ul0027-0003" num="0130">iii. In one example, the sub blocks with IBC enabled may be reconstructed by copying the collocated sample in IBC prediction and the sub blocks with IBC disabled may be reconstructed by palette colors.</li>            </ul>            </li>            <li id="ul0026-0003" num="0131">c. In one example, the indication of usage of the palette mode and/or IBC mode may be signalled at sub-blocks level.            <ul id="ul0029" list-style="none">                <li id="ul0029-0001" num="0132">i. In one example, one flag may be signalled for each sub-block to indicate whether the current sub-block is coded in chroma IBC mode or palette mode.</li>            </ul>            </li>            <li id="ul0026-0004" num="0133">d. In one example, one flag may be firstly signalled at block level and the sub-block level decision to choose either IBC or palette mode for one color component may be decided according to the information from another color component.</li>            <li id="ul0026-0005" num="0134">e. In one example, the sub-blocks may be square or rectangle blocks.            <ul id="ul0030" list-style="none">                <li id="ul0030-0001" num="0135">i. In one example, the sub-block size in the above methods may depend on                <ul id="ul0031" list-style="none">                    <li id="ul0031-0001" num="0136">1) block dimension of current block</li>                    <li id="ul0031-0002" num="0137">2) Current quantization parameter of current block</li>                    <li id="ul0031-0003" num="0138">3) The palette flag of neighboring blocks</li>                    <li id="ul0031-0004" num="0139">4) The intra block copy flags of neighboring blocks</li>                    <li id="ul0031-0005" num="0140">5) Indication of the color format (such as 4:2:0, 4:4:4)</li>                    <li id="ul0031-0006" num="0141">6) Separate/dual coding tree structure</li>                    <li id="ul0031-0007" num="0142">7) Slice/tile group type and/or picture type</li>                </ul>                </li>            </ul>            </li>            <li id="ul0026-0006" num="0143">f. In one example, in the above method, the samples may be coded in both palette mode and IBC mode, therefore INDEX mode and/or COPY_ABOVE mode may have some limitations.            <ul id="ul0032" list-style="none">                <li id="ul0032-0001" num="0144">i. In one example, the INDEX mode and/or COPY_ABOVE mode may not be allowed to copy an index of sample coded in IBC mode.</li>                <li id="ul0032-0002" num="0145">ii. In one example, a sample coded in IBC mode may be inferred to have a special index.                <ul id="ul0033" list-style="none">                    <li id="ul0033-0001" num="0146">1) In one example, the special index may be inferred to equal to any other palette indexes when performing INDEX mode and/or COPY_ABOVE mode.</li>                    <li id="ul0033-0002" num="0147">2) In one example, if a sample has a special index, it may be reconstructed by a collocated IBC prediction.</li>                </ul>                </li>                <li id="ul0032-0003" num="0148">iii. In one example, a sample coded in IBC mode may be skipped during performing INDEX mode and/or COPY_ABOVE mode.</li>            </ul>            </li>            <li id="ul0026-0007" num="0149">g. The above methods may be applicable to the combined mode of palette and intra prediction mode wherein some samples may be predicted from the intra prediction mode and others may be predicted from palette mode.</li>        </ul>        </li>        <li id="ul0010-0005" num="0150">5. A conformance bitstream shall obey the rule that when the PICP mode is selected, at least one valid BV candidate is existing in the IBC AMVP/Merge mode.</li>        <li id="ul0010-0006" num="0151">6. Whether or how to apply the above methods may be signaled in a video data unit level, such as SPS/VPS/PPS/APS/sequence header/picture header/slice header/tile group header/tile/LCU row.        <ul id="ul0034" list-style="none">            <li id="ul0034-0001" num="0152">a. In one example, furthermore, the signalling of the proposed method may be conditionally signaled, such as under the condition of IBC and palette modes are both enabled.</li>        </ul>        </li>        <li id="ul0010-0007" num="0153">7. Indication of the usage of the above methods may be signaled in block level.        <ul id="ul0035" list-style="none">            <li id="ul0035-0001" num="0154">a. Alternatively, furthermore, it may be based on the following conditions.            <ul id="ul0036" list-style="none">                <li id="ul0036-0001" num="0155">i. In one example, the conditions are                <ul id="ul0037" list-style="none">                    <li id="ul0037-0001" num="0156">1) block dimension of current block</li>                    <li id="ul0037-0002" num="0000">&#x2003;a) In one example, if the width of the current block is larger than K1 (e.g., K1=64) or the height of the current block is larger than K2 (e.g., K2=64), signaling of the indication may be skipped.</li>                    <li id="ul0037-0003" num="0157">2) prediction mode of current block</li>                    <li id="ul0037-0004" num="0158">3) Current quantization parameter of current block</li>                    <li id="ul0037-0005" num="0159">4) The palette flag of neighboring blocks</li>                    <li id="ul0037-0006" num="0160">5) The intra block copy flags of neighboring blocks</li>                    <li id="ul0037-0007" num="0161">6) Indication of the color format (such as 4:2:0, 4:4:4)</li>                    <li id="ul0037-0008" num="0162">7) Separate/dual coding tree structure</li>                    <li id="ul0037-0009" num="0163">8) Slice/tile group type and/or picture type</li>                </ul>                </li>            </ul>            </li>            <li id="ul0035-0002" num="0164">b. Alternatively, furthermore, it may be based on the usage of the palette mode.            <ul id="ul0038" list-style="none">                <li id="ul0038-0001" num="0165">i. In one example, the flag indicates the above methods may be signaled when the flag of palette mode is true. Alternatively, furthermore, if the flag of palette mode is true, the flag indicates the above method may be signaled.</li>                <li id="ul0038-0002" num="0166">ii. In one example, the flag indicates the above methods may be inferred to true when the flag of palette mode is true. Alternatively, furthermore, if the flag of palette mode is true, the above method may be inferred to true.</li>                <li id="ul0038-0003" num="0167">iii. In one example, the flag indicates the above methods may be inferred to false when the flag of palette mode is false. Alternatively, furthermore, if the flag of palette mode is false, the above method may be inferred to false.</li>            </ul>            </li>            <li id="ul0035-0003" num="0168">c. Alternatively, furthermore, it may be based on the usage of the PCIP.            <ul id="ul0039" list-style="none">                <li id="ul0039-0001" num="0169">i. In one example, the flag indicates the above methods may be signaled when the flag of PCIP is false. Alternatively, furthermore, if the flag of PCIP is false, the flag indicates the above method may be signaled.</li>                <li id="ul0039-0002" num="0170">ii. In one example, the flag indicates the above methods may be inferred to true when the flag of PCIP is false. Alternatively, furthermore, if the flag of palette mode is false, the above method may be inferred to true.</li>                <li id="ul0039-0003" num="0171">iii. In one example, the flag indicates the above methods may be inferred to false when the flag of PCIP is false. Alternatively, furthermore, if the flag of PCIP is false, the above method may be inferred to false.</li>                <li id="ul0039-0004" num="0172">iv. In one example, the flag indicates the above methods may be signaled before or after the flags of palette mode and/or PCIP.</li>            </ul>            </li>            <li id="ul0035-0004" num="0173">d. Alternatively, furthermore, it may be based on the usage of the palette mode and the prediction mode.            <ul id="ul0040" list-style="none">                <li id="ul0040-0001" num="0174">i. In one example, the flag indicates the above methods may be inferred to true when the flag of palette mode is true and the prediction mode is MODE_IBC. Alternatively, furthermore, if the flag of palette mode is true and the prediction mode is MODE_IBC, the flag indicates the above method may be inferred to true.</li>                <li id="ul0040-0002" num="0175">ii. In one example, the flag indicates the above methods may be inferred to true when the flag of palette mode is true and the prediction mode is MODE_INTER. Alternatively, furthermore, if the flag of palette mode is true and the prediction mode is MODE_INTER, the flag indicates the above method may be inferred to true.</li>                <li id="ul0040-0003" num="0176">iii. In one example, the flag indicates the above methods may be inferred to false when the flag of palette mode is true and the prediction mode is MODE_INTRA. Alternatively, furthermore, if the flag of palette mode is true and the prediction mode is MODE_INTRA, the flag indicates the above method may be inferred to false.</li>            </ul>            </li>            <li id="ul0035-0005" num="0177">e. In one example, indication of the palette mode may be firstly signaled, followed by indications of whether PCIP or above methods is applied to one block.            <ul id="ul0041" list-style="none">                <li id="ul0041-0001" num="0178">i. Alternatively, furthermore, when the palette mode is utilized, three choices may be allowed, conventional palette mode, PCIP or above method.                <ul id="ul0042" list-style="none">                    <li id="ul0042-0001" num="0179">1) In one example, a first flag may be coded to indicate whether it is coded with PCIP. A second flag may be coded to indicate whether it is coded with above method. When neither PCIP nor above methods are applied, the conventional palette mode is enabled.</li>                    <li id="ul0042-0002" num="0180">2) In one example, signalling of the second flag is skipped when PCIP is enabled. That is, when the second flag needs to be coded, it is coded after the first flag.</li>                    <li id="ul0042-0003" num="0181">3) Alternatively, signalling of the first flag is skipped when above method is enabled. That is, when the first flag needs to be coded, it is coded after the second flag.</li>                    <li id="ul0042-0004" num="0182">4) Alternatively, different orders of signalling of indications of the three choices may be utilized.</li>                </ul>                </li>                <li id="ul0041-0002" num="0183">ii. Alternatively, the conventional palette mode may be disabled without being signaled. Instead, one block may choose either to be coded with PCIP or above methods.                <ul id="ul0043" list-style="none">                    <li id="ul0043-0001" num="0184">1) Alternatively, furthermore, whether/how to use PCIP or above methods may be signaled when current prediction mode is intra mode.</li>                </ul>                </li>            </ul>            </li>            <li id="ul0035-0006" num="0185">f. In one example, the indication of the any one or multiple of the above methods may be signaled using bypass-coded bins or context-coded bins in arithmetic coding.            <ul id="ul0044" list-style="none">                <li id="ul0044-0001" num="0186">i. In one example, the context may be derived based on the indications of any one or multiple of the above methods of blocks neighboring to the current block.                <ul id="ul0045" list-style="none">                    <li id="ul0045-0001" num="0187">1) In one example, only one context may be used on the signaling of the indication of the above method.</li>                    <li id="ul0045-0002" num="0188">2) In one example, the context may be derived based on coded information of neighboring blocks.</li>                    <li id="ul0045-0003" num="0000">&#x2003;a) In one example, the context may be derived based on the indications of any one or multiple of the above methods of neighboring blocks left to and/or above to the current block (as shown in <figref idref="DRAWINGS">FIG. <b>9</b></figref>).</li>                    <li id="ul0045-0004" num="0000">&#x2003;b) For example, let cu_left_ibc_palette_mode and cu_above_ibc_palette_mode be the indications of above method of the left neighboring block and the above neighboring block of the current block (e.g., the neighboring blocks as shown in the <figref idref="DRAWINGS">FIG. <b>9</b></figref>). In one example, the current contexts may be derived by the following equation</li>                </ul>                </li>            </ul>            </li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0058" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>ctxlnc</i>=(<i>cu</i>_left_<i>ibc</i>_palette_mode?1:0)+(<i>cu</i>_above_<i>ibc</i>_palette_mode?1:0)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0046" list-style="none">    <li id="ul0046-0001" num="0000">    <ul id="ul0047" list-style="none">        <li id="ul0047-0001" num="0000">        <ul id="ul0048" list-style="none">            <li id="ul0048-0001" num="0000">            <ul id="ul0049" list-style="none">                <li id="ul0049-0001" num="0000">                <ul id="ul0050" list-style="none">                    <li id="ul0050-0001" num="0000">&#x2003;c) Alternatively, in one example, the current contexts may be derived by the following equation</li>                </ul>                </li>            </ul>            </li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0059" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>ctxlnc</i>=(<i>cu</i>_left_<i>ibc</i>_palette_mode?1:0)*2+(<i>cu</i>_above_<i>ibc</i>_palette_mode?1:0)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0051" list-style="none">    <li id="ul0051-0001" num="0000">    <ul id="ul0052" list-style="none">        <li id="ul0052-0001" num="0000">        <ul id="ul0053" list-style="none">            <li id="ul0053-0001" num="0000">            <ul id="ul0054" list-style="none">                <li id="ul0054-0001" num="0000">                <ul id="ul0055" list-style="none">                    <li id="ul0055-0001" num="0189">3) In one example, the context may be derived based on the availability of blocks neighboring to the current block.</li>                    <li id="ul0055-0002" num="0000">&#x2003;a) In one example, the indication of any one or multiple of the above methods of a neighbouring block may be set to be a default value (such as 0) if the neighbouring block is unavailable.</li>                    <li id="ul0055-0003" num="0000">&#x2003;b) In one example, a neighbouring block may be treated as unavailable if it is in a different CTU row to the current block.</li>                    <li id="ul0055-0004" num="0190">4) In one example, the context may be derived based on the coded information of current block, such as block dimension/partition splitting depth (e.g., quad-tree/binary tree/ternary tree).</li>                </ul>                </li>            </ul>            </li>            <li id="ul0053-0002" num="0191">g. In one example, the signaling of any one or multiple of the above methods may also be applied on conventional palette mode or PICP mode.</li>        </ul>        </li>    </ul>    </li></ul></p><heading id="h-0019" level="1">5. Embodiment Added to JVET-M1001-v5</heading><heading id="h-0020" level="2">1.1.1.1 Sequence Parameter Set RBSP Syntax</heading><p id="p-0060" num="0192">In this document, underlined italicized bolded font, or italicized bolded font, indicates text added to relevant parts of the JVET-M1001-v5 specification.</p><p id="p-0061" num="0000"><tables id="TABLE-US-00001" num="00001"><table frame="none" colsep="0" rowsep="0" tabstyle="monospace"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="161pt" align="left"/><colspec colname="2" colwidth="56pt" align="center"/><thead><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry>seq_parameter_set_rbsp( ) {</entry><entry>Descriptor</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>&#x2003;sps_max_sub_layers_minus1</entry><entry>u(3)</entry></row><row><entry>...</entry><entry/></row><row><entry>&#x2003;sps_ibc_enabled_flag</entry><entry>u(1)</entry></row><row><entry>&#x2003;<img id="CUSTOM-CHARACTER-00001" he="2.79mm" wi="15.92mm" file="US20230007261A1-20230105-P00001.TIF" alt="custom-character" img-content="character" img-format="tif"/> <img id="CUSTOM-CHARACTER-00002" he="2.79mm" wi="13.38mm" file="US20230007261A1-20230105-P00002.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry>u(1)</entry></row><row><entry>...</entry><entry>u(1)</entry></row><row><entry>}</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0062" num="0000"><tables id="TABLE-US-00002" num="00002"><table frame="none" colsep="0" rowsep="0" tabstyle="monospace"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="175pt" align="left"/><colspec colname="2" colwidth="42pt" align="center"/><thead><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry>coding_unit(&#x2003;x0,&#x2003;y0,&#x2003;cbWidth,&#x2003;</entry><entry/></row><row><entry>cbHeight,&#x2003;treeType&#x2003;)&#x2003;{</entry><entry>Descriptor</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>&#x2003;if(&#x2003;slice_type&#x2003;!=&#x2003;I&#x2003;)&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;cu_skip_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;if(&#x2003;cu_skip_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;pred_mode_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;}</entry><entry/></row><row><entry>&#x2003;if(&#x2003;CuPredMode[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;</entry><entry/></row><row><entry>&#x2003;MODE_INTRA&#x2003;)&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;if(&#x2003;pcm_enabled_flag&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;cbWidth&#x2003;&#x3e;=&#x2003;MinIpcmCbSizeY&#x2003;&#x26;&#x26;&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;cbWidth&#x2003;&#x3c;=&#x2003;MaxIpcmCbSizeY</entry><entry/></row><row><entry>&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;cbHeight&#x2003;&#x3e;=&#x2003;MinIpcmCbSizeY&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x26;&#x26;&#x2003;cbHeight&#x2003;&#x3c;=</entry><entry/></row><row><entry>MaxIpcmCbSizeY&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;pcm_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;if(&#x2003;pcm_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;)&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;while(&#x2003;!byte_aligned(&#x2003;)&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;pcm_alignment_zero_bit</entry><entry>f(1)</entry></row><row><entry>&#x2003;&#x2003;pcm_sample(&#x2003;cbWidth,&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;cbHeight,&#x2003;treeType&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;}&#x2003;else&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00003" he="2.79mm" wi="35.98mm" file="US20230007261A1-20230105-P00003.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00004" he="2.79mm" wi="29.29mm" file="US20230007261A1-20230105-P00004.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00005" he="2.79mm" wi="2.12mm" file="US20230007261A1-20230105-P00005.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00006" he="2.79mm" wi="31.75mm" file="US20230007261A1-20230105-P00006.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00007" he="2.79mm" wi="6.35mm" file="US20230007261A1-20230105-P00007.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00008" he="2.79mm" wi="26.50mm" file="US20230007261A1-20230105-P00008.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00009" he="2.79mm" wi="6.01mm" file="US20230007261A1-20230105-P00009.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00010" he="2.79mm" wi="30.73mm" file="US20230007261A1-20230105-P00010.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00011" he="2.79mm" wi="37.76mm" file="US20230007261A1-20230105-P00011.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00012" he="2.79mm" wi="26.50mm" file="US20230007261A1-20230105-P00012.TIF" alt="custom-character" img-content="character" img-format="tif"/> <img id="CUSTOM-CHARACTER-00013" he="2.79mm" wi="23.62mm" file="US20230007261A1-20230105-P00013.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00014" he="2.79mm" wi="10.92mm" file="US20230007261A1-20230105-P00014.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00015" he="2.79mm" wi="26.50mm" file="US20230007261A1-20230105-P00015.TIF" alt="custom-character" img-content="character" img-format="tif"/> <img id="CUSTOM-CHARACTER-00016" he="2.79mm" wi="17.61mm" file="US20230007261A1-20230105-P00016.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00017" he="2.79mm" wi="28.19mm" file="US20230007261A1-20230105-P00017.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00018" he="2.79mm" wi="22.94mm" file="US20230007261A1-20230105-P00018.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00019" he="2.79mm" wi="19.73mm" file="US20230007261A1-20230105-P00019.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00020" he="2.79mm" wi="26.50mm" file="US20230007261A1-20230105-P00020.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00021" he="2.79mm" wi="27.52mm" file="US20230007261A1-20230105-P00021.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00022" he="2.79mm" wi="20.83mm" file="US20230007261A1-20230105-P00022.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00023" he="2.79mm" wi="27.86mm" file="US20230007261A1-20230105-P00023.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00024" he="2.79mm" wi="4.23mm" file="US20230007261A1-20230105-P00024.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;}&#x2003;else&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;if(&#x2003;treeType&#x2003;=&#x2003;=&#x2003;</entry><entry/></row><row><entry>SINGLE_TREE&#x2003;|&#x2003;|&#x2003;treeType&#x2003;=&#x2003;=</entry><entry/></row><row><entry>DUAL_TREE_LUMA&#x2003;)&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;(&#x2003;y0&#x2003;%&#x2003;CtbSizeY&#x2003;)&#x2003;&#x3e;&#x2003;0&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_ref_idx[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;if&#x2003;(intra_luma_ref_idx</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;(&#x2003;cbWidth&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;|&#x2003;|&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbHeight&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;)&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;(&#x2003;cbWidth&#x2003;*&#x2003;cbHeight&#x2003;&#x3e;&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;MinTbSizeY&#x2003;*&#x2003;MinTbSizeY&#x2003;))</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;intra_subpartitions_mode_</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;1&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbWidth&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;&#x26;&#x26;&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbHeight&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_subpartitions_split_</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;intra_luma_ref_idx</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_subpartitions_mode_</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_mpm_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;intra_luma_mpm_</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_mpm_idx[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;else</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_mpm_</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;remainder[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry/></row><row><entry>&#x2003;&#x2003;}</entry><entry/></row><row><entry>...</entry><entry/></row><row><entry>}</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0063" num="0000"><tables id="TABLE-US-00003" num="00003"><table frame="none" colsep="0" rowsep="0" tabstyle="monospace"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="168pt" align="left"/><colspec colname="2" colwidth="49pt" align="center"/><thead><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry>coding_unit(&#x2003;x0,&#x2003;y0,&#x2003;cbWidth,&#x2003;</entry><entry/></row><row><entry>cbHeight,&#x2003;treeType&#x2003;)&#x2003;{</entry><entry>Descriptor</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>&#x2003;if(&#x2003;slice_type&#x2003;!=&#x2003;I&#x2003;)&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;cu_skip_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;if(&#x2003;cu_skip_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;pred_mode_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;}</entry><entry/></row><row><entry>&#x2003;if(&#x2003;CuPredMode[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;</entry><entry/></row><row><entry>&#x2003;MODE_INTRA&#x2003;)&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;if(&#x2003;pcm_enabled_flag&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;cbWidth&#x2003;&#x3e;=&#x2003;MinIpcmCbSizeY&#x2003;&#x26;&#x26;&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;cbWidth&#x2003;&#x3c;=&#x2003;MaxIpcmCbSizeY</entry><entry/></row><row><entry>&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;cbHeight&#x2003;&#x3e;=&#x2003;MinIpcmCbSizeY&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x26;&#x26;&#x2003;cbHeight&#x2003;&#x3c;=</entry><entry/></row><row><entry>MaxIpcmCbSizeY&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;pcm_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;if(&#x2003;pcm_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;)&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;while(&#x2003;!byte_aligned(&#x2003;)&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;pcm_alignment_zero_bit</entry><entry>f(1)</entry></row><row><entry>&#x2003;&#x2003;pcm_sample(&#x2003;cbWidth,&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;cbHeight,&#x2003;treeType&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;}&#x2003;else&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00025" he="2.79mm" wi="36.32mm" file="US20230007261A1-20230105-P00025.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00026" he="2.79mm" wi="27.52mm" file="US20230007261A1-20230105-P00026.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00027" he="2.79mm" wi="2.12mm" file="US20230007261A1-20230105-P00027.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00028" he="2.79mm" wi="31.07mm" file="US20230007261A1-20230105-P00028.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00029" he="2.79mm" wi="6.35mm" file="US20230007261A1-20230105-P00029.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00030" he="2.79mm" wi="27.18mm" file="US20230007261A1-20230105-P00030.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00031" he="2.79mm" wi="5.67mm" file="US20230007261A1-20230105-P00031.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00032" he="2.79mm" wi="30.73mm" file="US20230007261A1-20230105-P00032.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00033" he="2.79mm" wi="32.85mm" file="US20230007261A1-20230105-P00033.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00034" he="2.79mm" wi="16.93mm" file="US20230007261A1-20230105-P00034.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00035" he="2.79mm" wi="21.17mm" file="US20230007261A1-20230105-P00035.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00036" he="2.79mm" wi="28.19mm" file="US20230007261A1-20230105-P00036.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00037" he="2.79mm" wi="22.94mm" file="US20230007261A1-20230105-P00037.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00038" he="2.79mm" wi="9.91mm" file="US20230007261A1-20230105-P00038.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00039" he="2.79mm" wi="19.05mm" file="US20230007261A1-20230105-P00039.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00040" he="2.79mm" wi="24.72mm" file="US20230007261A1-20230105-P00040.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00041" he="2.79mm" wi="27.52mm" file="US20230007261A1-20230105-P00041.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00042" he="2.79mm" wi="22.94mm" file="US20230007261A1-20230105-P00042.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00043" he="2.79mm" wi="27.18mm" file="US20230007261A1-20230105-P00043.TIF" alt="custom-character" img-content="character" img-format="tif"/> <img id="CUSTOM-CHARACTER-00044" he="2.79mm" wi="21.17mm" file="US20230007261A1-20230105-P00044.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00045" he="2.79mm" wi="20.49mm" file="US20230007261A1-20230105-P00045.TIF" alt="custom-character" img-content="character" img-format="tif"/> <img id="CUSTOM-CHARACTER-00046" he="2.79mm" wi="29.29mm" file="US20230007261A1-20230105-P00046.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00047" he="2.79mm" wi="27.86mm" file="US20230007261A1-20230105-P00047.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00048" he="2.79mm" wi="4.23mm" file="US20230007261A1-20230105-P00048.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;}&#x2003;else&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;if(&#x2003;treeType&#x2003;=&#x2003;=&#x2003;SINGLE_</entry><entry/></row><row><entry>TREE&#x2003;|&#x2003;|&#x2003;treeType&#x2003;=&#x2003;=</entry><entry/></row><row><entry>DUAL_TREE_LUMA&#x2003;)&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;(&#x2003;y0&#x2003;%&#x2003;CtbSizeY&#x2003;)&#x2003;&#x3e;&#x2003;0&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_ref_idx[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;if&#x2003;(intra_luma_ref_idx</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;(&#x2003;cbWidth&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;|&#x2003;|&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbHeight&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;)&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;(&#x2003;cbWidth&#x2003;*&#x2003;cbHeight&#x2003;&#x3e;&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;MinTbSizeY&#x2003;*&#x2003;MinTbSizeY&#x2003;))</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_subpartitions_mode_</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;intra_subpartitions_mode_</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;1&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbWidth&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;&#x26;&#x26;&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbHeight&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_subpartitions_split_</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;intra_luma_ref_idx</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_subpartitions_mode_</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_mpm_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;intra_luma_mpm_</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_mpm_</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;idx[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;else</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_mpm_</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;remainder[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry/></row><row><entry>&#x2003;&#x2003;}</entry><entry/></row><row><entry>...</entry><entry/></row><row><entry>}</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0064" num="0000"><tables id="TABLE-US-00004" num="00004"><table frame="none" colsep="0" rowsep="0" tabstyle="monospace"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="168pt" align="left"/><colspec colname="2" colwidth="49pt" align="center"/><thead><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry>coding_unit(&#x2003;x0,&#x2003;y0,&#x2003;cbWidth,&#x2003;</entry><entry/></row><row><entry>cbHeight,&#x2003;treeType&#x2003;)&#x2003;{</entry><entry>Descriptor</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>&#x2003;if(&#x2003;slice_type&#x2003;!=&#x2003;I&#x2003;)&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;cu_skip_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;if(&#x2003;cu_skip_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;pred_mode_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;}</entry><entry/></row><row><entry>&#x2003;if(&#x2003;CuPredMode[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;</entry><entry/></row><row><entry>&#x2003;MODE_INTRA&#x2003;)&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00049" he="2.79mm" wi="39.20mm" file="US20230007261A1-20230105-P00049.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00050" he="2.79mm" wi="27.52mm" file="US20230007261A1-20230105-P00050.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00051" he="2.79mm" wi="2.12mm" file="US20230007261A1-20230105-P00051.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00052" he="2.79mm" wi="31.07mm" file="US20230007261A1-20230105-P00052.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00053" he="2.79mm" wi="6.35mm" file="US20230007261A1-20230105-P00053.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00054" he="2.79mm" wi="30.31mm" file="US20230007261A1-20230105-P00054.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00055" he="2.79mm" wi="4.23mm" file="US20230007261A1-20230105-P00055.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00056" he="2.79mm" wi="32.85mm" file="US20230007261A1-20230105-P00056.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00057" he="2.79mm" wi="32.85mm" file="US20230007261A1-20230105-P00057.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00058" he="2.79mm" wi="39.20mm" file="US20230007261A1-20230105-P00058.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00059" he="2.79mm" wi="27.52mm" file="US20230007261A1-20230105-P00059.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00060" he="2.79mm" wi="22.94mm" file="US20230007261A1-20230105-P00060.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00061" he="2.79mm" wi="9.91mm" file="US20230007261A1-20230105-P00061.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00062" he="2.79mm" wi="19.05mm" file="US20230007261A1-20230105-P00062.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00063" he="2.79mm" wi="23.96mm" file="US20230007261A1-20230105-P00063.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00064" he="2.79mm" wi="28.19mm" file="US20230007261A1-20230105-P00064.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00065" he="2.79mm" wi="22.94mm" file="US20230007261A1-20230105-P00065.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00066" he="2.79mm" wi="27.18mm" file="US20230007261A1-20230105-P00066.TIF" alt="custom-character" img-content="character" img-format="tif"/> <img id="CUSTOM-CHARACTER-00067" he="2.79mm" wi="21.17mm" file="US20230007261A1-20230105-P00067.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00068" he="2.79mm" wi="22.61mm" file="US20230007261A1-20230105-P00068.TIF" alt="custom-character" img-content="character" img-format="tif"/> <img id="CUSTOM-CHARACTER-00069" he="2.79mm" wi="26.08mm" file="US20230007261A1-20230105-P00069.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00070" he="2.79mm" wi="27.86mm" file="US20230007261A1-20230105-P00070.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00071" he="2.79mm" wi="4.91mm" file="US20230007261A1-20230105-P00071.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;}&#x2003;else&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00072" he="2.79mm" wi="28.19mm" file="US20230007261A1-20230105-P00072.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00073" he="2.79mm" wi="51.90mm" file="US20230007261A1-20230105-P00073.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00074" he="2.79mm" wi="22.94mm" file="US20230007261A1-20230105-P00074.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00075" he="2.79mm" wi="53.59mm" file="US20230007261A1-20230105-P00075.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00076" he="2.79mm" wi="19.39mm" file="US20230007261A1-20230105-P00076.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00077" he="2.79mm" wi="22.27mm" file="US20230007261A1-20230105-P00077.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00078" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00078.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00079" he="2.79mm" wi="26.50mm" file="US20230007261A1-20230105-P00079.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00080" he="2.79mm" wi="27.86mm" file="US20230007261A1-20230105-P00080.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00081" he="2.79mm" wi="29.29mm" file="US20230007261A1-20230105-P00081.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00082" he="2.79mm" wi="4.23mm" file="US20230007261A1-20230105-P00082.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry>&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00083" he="2.79mm" wi="26.50mm" file="US20230007261A1-20230105-P00083.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00084" he="2.79mm" wi="20.49mm" file="US20230007261A1-20230105-P00084.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;}&#x2003;else&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;if(&#x2003;treeType&#x2003;=&#x2003;=&#x2003;SINGLE_</entry><entry/></row><row><entry>TREE&#x2003;|&#x2003;|&#x2003;treeType&#x2003;=&#x2003;=</entry><entry/></row><row><entry>DUAL_TREE_LUMA&#x2003;)&#x2003;{</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;(&#x2003;y0&#x2003;%&#x2003;CtbSizeY&#x2003;)&#x2003;&#x3e;&#x2003;0&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_ref_idx[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;if&#x2003;(intra_luma_ref_idx</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;(&#x2003;cbWidth&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;|&#x2003;|&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbHeight&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;)&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;(&#x2003;cbWidth&#x2003;*&#x2003;cbHeight&#x2003;&#x3e;&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;MinTbSizeY&#x2003;*&#x2003;MinTbSizeY&#x2003;))</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_subpartitions_mode_</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;intra_subpartitions_mode_</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;1&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbWidth&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x26;&#x26;&#x2003;cbHeight&#x2003;&#x3c;=&#x2003;MaxTbSizeY&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_subpartitions_</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;split_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;intra_luma_ref_idx</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_subpartitions_mode_</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;=&#x2003;=&#x2003;0&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_mpm_flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;if(&#x2003;intra_luma_mpm_</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;flag[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]&#x2003;)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_mpm_idx[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;else</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;intra_luma_mpm_</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;remainder[&#x2003;x0&#x2003;][&#x2003;y0&#x2003;]</entry><entry/></row><row><entry>&#x2003;&#x2003;}</entry><entry/></row><row><entry>...</entry><entry/></row><row><entry>}</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0065" num="0000"><tables id="TABLE-US-00005" num="00005"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="224pt" align="left"/><colspec colname="2" colwidth="49pt" align="center"/><thead><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry>coding_unit( x0, y0, cbWidth, cbHeight, treeType ) {</entry><entry>Descriptor</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>&#x2003;if( slice_type != I ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;cu_skip_flag[ x0 ][ y0 ] </entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;if( cu_skip_flag[ x0 ][ y0 ] = = 0 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;pred_mode_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;}</entry><entry/></row><row><entry>&#x2003;if( CuPredMode[ x0 ][ y0 ] = = MODE_INTRA ) {</entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00085" he="2.79mm" wi="39.20mm" file="US20230007261A1-20230105-P00085.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00086" he="2.79mm" wi="25.74mm" file="US20230007261A1-20230105-P00086.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00087" he="2.79mm" wi="2.12mm" file="US20230007261A1-20230105-P00087.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00088" he="2.79mm" wi="31.07mm" file="US20230007261A1-20230105-P00088.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;<img id="CUSTOM-CHARACTER-00089" he="2.79mm" wi="6.35mm" file="US20230007261A1-20230105-P00089.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00090" he="2.79mm" wi="28.62mm" file="US20230007261A1-20230105-P00090.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry>ae(v)</entry></row><row><entry><img id="CUSTOM-CHARACTER-00091" he="2.79mm" wi="5.67mm" file="US20230007261A1-20230105-P00091.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00092" he="2.79mm" wi="31.41mm" file="US20230007261A1-20230105-P00092.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00093" he="2.79mm" wi="17.61mm" file="US20230007261A1-20230105-P00093.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00094" he="2.79mm" wi="21.17mm" file="US20230007261A1-20230105-P00094.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00095" he="2.79mm" wi="28.19mm" file="US20230007261A1-20230105-P00095.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00096" he="2.79mm" wi="22.94mm" file="US20230007261A1-20230105-P00096.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00097" he="2.79mm" wi="10.92mm" file="US20230007261A1-20230105-P00097.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00098" he="2.79mm" wi="20.49mm" file="US20230007261A1-20230105-P00098.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00099" he="2.79mm" wi="23.96mm" file="US20230007261A1-20230105-P00099.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00100" he="2.79mm" wi="27.52mm" file="US20230007261A1-20230105-P00100.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00101" he="2.79mm" wi="22.94mm" file="US20230007261A1-20230105-P00101.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00102" he="2.79mm" wi="19.73mm" file="US20230007261A1-20230105-P00102.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00103" he="2.79mm" wi="27.52mm" file="US20230007261A1-20230105-P00103.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00104" he="2.79mm" wi="28.19mm" file="US20230007261A1-20230105-P00104.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00105" he="2.79mm" wi="19.39mm" file="US20230007261A1-20230105-P00105.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00106" he="2.79mm" wi="27.86mm" file="US20230007261A1-20230105-P00106.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00107" he="2.79mm" wi="4.23mm" file="US20230007261A1-20230105-P00107.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00108" he="2.79mm" wi="9.14mm" file="US20230007261A1-20230105-P00108.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00109" he="2.79mm" wi="28.96mm" file="US20230007261A1-20230105-P00109.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00110" he="2.79mm" wi="34.54mm" file="US20230007261A1-20230105-P00110.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00111" he="2.79mm" wi="18.37mm" file="US20230007261A1-20230105-P00111.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00112" he="2.79mm" wi="22.94mm" file="US20230007261A1-20230105-P00112.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00113" he="2.79mm" wi="35.64mm" file="US20230007261A1-20230105-P00113.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00114" he="2.79mm" wi="18.71mm" file="US20230007261A1-20230105-P00114.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00115" he="2.79mm" wi="19.39mm" file="US20230007261A1-20230105-P00115.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00116" he="2.79mm" wi="22.27mm" file="US20230007261A1-20230105-P00116.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00117" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00117.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00118" he="2.79mm" wi="25.74mm" file="US20230007261A1-20230105-P00118.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00119" he="2.79mm" wi="28.62mm" file="US20230007261A1-20230105-P00119.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00120" he="2.79mm" wi="29.97mm" file="US20230007261A1-20230105-P00120.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00121" he="2.79mm" wi="4.23mm" file="US20230007261A1-20230105-P00121.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00122" he="2.79mm" wi="27.18mm" file="US20230007261A1-20230105-P00122.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00123" he="2.79mm" wi="19.39mm" file="US20230007261A1-20230105-P00123.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry>&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if( treeType = = SINGLE_TREE &#x2225; treeType = =</entry><entry/></row><row><entry>DUAL_TREE_LUMA ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if( ( y0 % CtbSizeY ) &#x3e; 0 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;intra_luma_ref_idx[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if (intra_luma_ref_idx[ x0 ][ y0 ] = = 0 &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;( cbWidth &#x3c;= MaxTbSizeY &#x2225; cbHeight &#x3c;= MaxTbSizeY ) &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;( cbWidth * cbHeight &#x3e; MinTbSizeY * MinTbSizeY ))</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;intra_subpartitions_mode_flag[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if( intra_subpartitions_mode_flag[ x0 ][ y0 ] = = 1 &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cbWidth &#x3c;= MaxTbSizeY &#x26;&#x26; cbHeight &#x3c;= MaxTbSizeY )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;intra_subpartitions_split_flag[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if( intra_luma_ref_idx[ x0 ][ y0 ] = = 0 &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;intra_subpartitions_mode_flag[ x0 ][ y0 ] = = 0 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;intra_luma_ mpm_flag[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if( intra_luma mpm_flag[ x0 ][ y0 ] )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;intra_luma_mpm_idx[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;else</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;intra_luma_mpm_remainder[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;}</entry><entry/></row><row><entry>...</entry><entry/></row><row><entry>}</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0066" num="0000"><tables id="TABLE-US-00006" num="00006"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="231pt" align="left"/><colspec colname="2" colwidth="49pt" align="center"/><thead><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry>coding_unit( x0, y0, cbWidth, cbHeight, treeType ) {</entry><entry>Descriptor</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>&#x2003;if( slice_type != I ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;cu_skip_flag[ x0 ][ y0 ] </entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;if( cu_skip_flag[ x0 ][ y0 ] = = 0 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;pred_mode_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;}</entry><entry/></row><row><entry>&#x2003;if( CuPredMode[ x0 ][ y0 ] = = MODE_INTRA ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;if( pcm_enabled_flag &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbWidth &#x3e;= MinIpcmCBSizeY &#x26;&#x26; cbWidth &#x3c;= MaxIpcmCbSizeY</entry><entry/></row><row><entry>&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbHeight &#x3e;= MinIpcmCBSizeY &#x26;&#x26; cbHeight &#x3c;=</entry><entry/></row><row><entry>MaxIpcmCbSizeY )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;pcm_flag[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;if( pcm_flag[ x0 ][ y0 ] ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;while( !byte_aligned( ) )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;pcm_alignment_zero_bit</entry><entry>f(1)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;pcm_sample( cbWidth, cbHeight, treeType)</entry><entry/></row><row><entry>&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;If(cbWidth &#x3e; 64 &#x2225; cbHeight &#x3e; 64 &#x2225; !sps_palette_enabled_flag)</entry><entry/></row><row><entry>{</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;cu_palette_flag[ x0 ][ y0 ] = 0</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;cu_palette_flag[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if(cu_palette_flag[ x0 ][ y0 ])&#xb7; {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if( (tree Type = = DUAL_TREE_LUMA &#x2225; treeType = =</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;DUAL_TREE_CHROMA) &#x26;&#x26; cbWidth * cbHeight &#x3e;= 256 ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cu_intrapalette_flag[ x0 ][ y0 ]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cu_intrapalette_flag[ x0 ][ y0 ] = 0</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if(cu_intrapalette_flag [ x0 ][ y0 ]){</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cu_intrapalette_mode[ x0 ][ y0 ]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;else{</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cu_palette_ibc_flag[ x0 ][ y0 ] </entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if(treeType = = SINGLE_TREE) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;palette_coding( x0, y0, , nWidth, nHeight, 0, 3)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;if(treeType = = DUAL_TREE_LUMA )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;palette_coding( x0, y0, , nWidth, nHeight, 0, 1 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if(treeType = = DUAL_TREE_CHROMA)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;palette_coding( x0, y0, , nWidth/SubWidthC,</entry><entry/></row><row><entry>nHeight/SubHeightC , 1, 2 )</entry><entry/></row><row><entry>&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if( treeType = = SINGLE_TREE &#x2225; treeType = =</entry><entry/></row><row><entry>DUAL_TREE_LUMA ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if( ( y0 % CtbSizeY ) &#x3e; 0 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;intra_luma_ref_idx[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>...</entry><entry/></row><row><entry>}</entry><entry/></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0067" num="0000"><tables id="TABLE-US-00007" num="00007"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="245pt" align="left"/><colspec colname="2" colwidth="42pt" align="center"/><thead><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry>coding_unit( x0, y0, cbWidth, cbHeight, treeType ) {</entry><entry>Descriptor</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>&#x2003;if( slice_type != I ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;cu_skip_flag[ x0 ][ y0 ] </entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;if( cu_skip_flag[ x0 ][ y0 ] = = 0 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;pred_mode_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;}</entry><entry/></row><row><entry>&#x2003;if( CuPredMode[ x0 ][ y0 ] = = MODE_INTRA ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;if( pcm_enabled_flag &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbWidth &#x3e;= MinIpcmCbSizeY &#x26;&#x26; cbWidth &#x3c;= MaxIpcmCbSizeY</entry><entry/></row><row><entry>&#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;cbHeight &#x3e;= MinIpcmCbSizeY &#x26;&#x26; cbHeight &#x3c;=</entry><entry/></row><row><entry>MaxIpcmCbSizeY )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;pcm_flag[ x0 ][ y0 ] </entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;if( pcm_flag[ x0 ][ y0 ] ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;while( !byte_aligned( ) )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;pcm_alignment_zero_bit</entry><entry>f(1)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;pcm_sample( cbWidth, cbHeight, treeType)</entry><entry/></row><row><entry>&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;If(cbWidth &#x3e;64 &#x2225; cbHeight &#x3e; 64 &#x2225; !sps_palette_enabled_flag)</entry><entry/></row><row><entry>{</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cu_palette_flag[ x0 ][ y0 ] = 0</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cu_palette_flag[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if(cu_palette_flag[ x0 ][ y0 ])&#xb7; {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cu_palette_ibc_flag[ x0 ][ y0 ]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;if( (treeType = = DUAL_TREE_LUMA &#x2225; treeType = =</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;DUAL_TREE_CHROMA) &#x26;&#x26; cbWidth * cbHeight &#x3e;= 256 &#x26;&#x26;</entry><entry/></row><row><entry>cu_palette_ibc_flag[ x0 ][ y0 ] = = 0 ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cu_intrapalette_flag[ x0 ][ y0 ]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cu_intrapalette_flag[ x0 ][ y0 ] = 0</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;if(cu_intrapalette_flag [ x0 ][ y0 ]){</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;cu_intrapalette_mode[ x0 ][ y0 ]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if(treeType = = SINGLE_TREE) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;palette_coding( x0, y0, , nWidth, nHeight, 0, 3)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;if(treeType = = DUAL_TREE_LUMA )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;palette_coding( x0, y0, , nWidth, nHeight, 0, 1 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;if(treeType = = DUAL_TREE_CHROMA)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;palette_coding( x0, y0, , nWidth/SubWidthC,</entry><entry/></row><row><entry>nHeight/SubHeightC , 1, 2 )</entry><entry/></row><row><entry>&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if( treeType = = SINGLE_TREE &#x2225; treeType = =</entry><entry/></row><row><entry>DUAL_TREE_LUMA ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;if( ( y0 % CtbSizeY ) &#x3e; 0 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;intra_luma_ref_idx[ x0 ][ y0 ]</entry><entry>ae(v)</entry></row><row><entry>...</entry><entry/></row><row><entry>}</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables><br/>cu_intrapalette_flag specifies the use of intra-palette combine mode in the current coding unit. cu_intrapalette_flag==1 indicates that intra-palette combine mode is applied in the current coding unit. cu_intrapalette_flag==0 indicates that intra-palette combine mode is not applied for the current coding unit.<br/>treeType specifies whether joint tree is applied in the current coding tree. treeType==SINGLE_TREE indicates that the same coding unit partition is applied for both luma and chorma. treeType !=SINGLE_TREE indicates that separate coding unit partitions are applied for luma and chroma (dual tree). treeType==DUAL_TREE_LUMA indicates that the current partition is for luma component in dual tree and treeType==DUAL_TREE_CHROMA indicates that the current partition is for luma component in dual tree.<br/>startComp specifies the first colour component of the current palette table. startComp==0 indicates the Y component and startComp==1 and 2 indicates Cb and Cr components. numComps specifies the number of colour components in the current palette table.<br/>The predictor palette consists of palette entries from previous coding units that are used to predict the entries in the current palette.<br/>The variable PredictorPaletteSize [startComp] specifies the size of the predictor palette for the first colour component of the current palette table startComp.<br/>The variable PalettePredictorEntryReuseFlags[i] equal to 1 specifies that the i-th entry in the predictor palette is reused in the current palette.<br/>PalettePredictorEntryReuseFlags[i] equal to 0 specifies that the i-th entry in the predictor palette is not an entry in the current palette. All elements of the array PalettePredictorEntryReuseFlags[i] are initialized to 0.</p><p id="p-0068" num="0000"><tables id="TABLE-US-00008" num="00008"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="217pt" align="left"/><colspec colname="2" colwidth="56pt" align="left"/><thead><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry><img id="CUSTOM-CHARACTER-00124" he="2.79mm" wi="32.85mm" file="US20230007261A1-20230105-P00124.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00125" he="2.79mm" wi="21.17mm" file="US20230007261A1-20230105-P00125.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00126" he="2.79mm" wi="14.48mm" file="US20230007261A1-20230105-P00126.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00127" he="2.79mm" wi="10.92mm" file="US20230007261A1-20230105-P00127.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="217pt" align="left"/><colspec colname="2" colwidth="56pt" align="center"/><tbody valign="top"><row><entry><img id="CUSTOM-CHARACTER-00128" he="2.79mm" wi="32.43mm" file="US20230007261A1-20230105-P00128.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00129" he="2.79mm" wi="35.31mm" file="US20230007261A1-20230105-P00129.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00130" he="2.79mm" wi="29.29mm" file="US20230007261A1-20230105-P00130.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00131" he="2.79mm" wi="21.17mm" file="US20230007261A1-20230105-P00131.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00132" he="2.79mm" wi="20.83mm" file="US20230007261A1-20230105-P00132.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00133" he="2.79mm" wi="16.93mm" file="US20230007261A1-20230105-P00133.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00134" he="2.79mm" wi="30.31mm" file="US20230007261A1-20230105-P00134.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00135" he="2.79mm" wi="33.87mm" file="US20230007261A1-20230105-P00135.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00136" he="2.79mm" wi="33.19mm" file="US20230007261A1-20230105-P00136.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00137" he="2.79mm" wi="25.74mm" file="US20230007261A1-20230105-P00137.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00138" he="2.79mm" wi="23.62mm" file="US20230007261A1-20230105-P00138.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00139" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00139.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00140" he="2.79mm" wi="34.54mm" file="US20230007261A1-20230105-P00140.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00141" he="2.79mm" wi="31.41mm" file="US20230007261A1-20230105-P00141.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00142" he="2.79mm" wi="25.74mm" file="US20230007261A1-20230105-P00142.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00143" he="2.79mm" wi="27.52mm" file="US20230007261A1-20230105-P00143.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><u style="single"><b>&#x2003;</b></u></entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00144" he="2.79mm" wi="30.73mm" file="US20230007261A1-20230105-P00144.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00145" he="2.79mm" wi="36.32mm" file="US20230007261A1-20230105-P00145.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00146" he="2.79mm" wi="6.35mm" file="US20230007261A1-20230105-P00146.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00147" he="2.79mm" wi="46.91mm" file="US20230007261A1-20230105-P00147.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00148" he="2.79mm" wi="8.13mm" file="US20230007261A1-20230105-P00148.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00149" he="2.79mm" wi="34.97mm" file="US20230007261A1-20230105-P00149.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00150" he="2.79mm" wi="5.67mm" file="US20230007261A1-20230105-P00150.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00151" he="2.79mm" wi="35.31mm" file="US20230007261A1-20230105-P00151.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00152" he="2.79mm" wi="31.07mm" file="US20230007261A1-20230105-P00152.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00153" he="2.79mm" wi="2.46mm" file="US20230007261A1-20230105-P00153.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00154" he="2.79mm" wi="25.74mm" file="US20230007261A1-20230105-P00154.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00155" he="2.79mm" wi="19.39mm" file="US20230007261A1-20230105-P00155.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00156" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00156.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><u style="single"><b>&#x2003;</b></u></entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00157" he="2.79mm" wi="29.63mm" file="US20230007261A1-20230105-P00157.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00158" he="2.79mm" wi="28.96mm" file="US20230007261A1-20230105-P00158.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00159" he="2.79mm" wi="9.14mm" file="US20230007261A1-20230105-P00159.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00160" he="2.79mm" wi="31.07mm" file="US20230007261A1-20230105-P00160.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00161" he="2.79mm" wi="34.54mm" file="US20230007261A1-20230105-P00161.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00162" he="2.79mm" wi="38.78mm" file="US20230007261A1-20230105-P00162.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00163" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00163.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00164" he="2.79mm" wi="29.97mm" file="US20230007261A1-20230105-P00164.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00165" he="2.79mm" wi="21.17mm" file="US20230007261A1-20230105-P00165.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00166" he="2.79mm" wi="27.18mm" file="US20230007261A1-20230105-P00166.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00167" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00167.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00168" he="2.79mm" wi="29.29mm" file="US20230007261A1-20230105-P00168.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00169" he="2.79mm" wi="30.73mm" file="US20230007261A1-20230105-P00169.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00170" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00170.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00171" he="2.79mm" wi="12.70mm" file="US20230007261A1-20230105-P00171.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00172" he="2.79mm" wi="29.97mm" file="US20230007261A1-20230105-P00172.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00173" he="2.79mm" wi="22.61mm" file="US20230007261A1-20230105-P00173.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00174" he="2.79mm" wi="38.10mm" file="US20230007261A1-20230105-P00174.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00175" he="2.79mm" wi="23.62mm" file="US20230007261A1-20230105-P00175.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00176" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00176.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00177" he="2.79mm" wi="27.18mm" file="US20230007261A1-20230105-P00177.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00178" he="2.79mm" wi="18.37mm" file="US20230007261A1-20230105-P00178.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00179" he="2.79mm" wi="5.67mm" file="US20230007261A1-20230105-P00179.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00180" he="2.79mm" wi="14.48mm" file="US20230007261A1-20230105-P00180.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00181" he="2.79mm" wi="5.67mm" file="US20230007261A1-20230105-P00181.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00182" he="2.79mm" wi="23.62mm" file="US20230007261A1-20230105-P00182.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00183" he="2.79mm" wi="18.03mm" file="US20230007261A1-20230105-P00183.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00184" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00184.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00185" he="2.79mm" wi="22.27mm" file="US20230007261A1-20230105-P00185.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00186" he="2.79mm" wi="18.03mm" file="US20230007261A1-20230105-P00186.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00187" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00187.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00188" he="2.79mm" wi="3.22mm" file="US20230007261A1-20230105-P00188.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00189" he="2.79mm" wi="27.18mm" file="US20230007261A1-20230105-P00189.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00190" he="2.79mm" wi="32.09mm" file="US20230007261A1-20230105-P00190.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00191" he="2.79mm" wi="21.84mm" file="US20230007261A1-20230105-P00191.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><u style="single"><b>&#x2003;</b></u></entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00192" he="2.79mm" wi="24.38mm" file="US20230007261A1-20230105-P00192.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00193" he="2.79mm" wi="21.84mm" file="US20230007261A1-20230105-P00193.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00194" he="2.79mm" wi="14.14mm" file="US20230007261A1-20230105-P00194.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00195" he="2.79mm" wi="30.73mm" file="US20230007261A1-20230105-P00195.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00196" he="2.79mm" wi="23.62mm" file="US20230007261A1-20230105-P00196.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00197" he="2.79mm" wi="13.80mm" file="US20230007261A1-20230105-P00197.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00198" he="2.79mm" wi="30.73mm" file="US20230007261A1-20230105-P00198.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00199" he="2.79mm" wi="23.62mm" file="US20230007261A1-20230105-P00199.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00200" he="2.79mm" wi="27.86mm" file="US20230007261A1-20230105-P00200.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00201" he="2.79mm" wi="18.37mm" file="US20230007261A1-20230105-P00201.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00202" he="2.79mm" wi="30.73mm" file="US20230007261A1-20230105-P00202.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00203" he="2.79mm" wi="27.52mm" file="US20230007261A1-20230105-P00203.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00204" he="2.79mm" wi="18.03mm" file="US20230007261A1-20230105-P00204.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00205" he="2.79mm" wi="30.73mm" file="US20230007261A1-20230105-P00205.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00206" he="2.79mm" wi="26.84mm" file="US20230007261A1-20230105-P00206.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00207" he="2.79mm" wi="5.67mm" file="US20230007261A1-20230105-P00207.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00208" he="2.79mm" wi="29.97mm" file="US20230007261A1-20230105-P00208.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00209" he="2.79mm" wi="28.96mm" file="US20230007261A1-20230105-P00209.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00210" he="2.79mm" wi="39.20mm" file="US20230007261A1-20230105-P00210.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00211" he="2.79mm" wi="27.52mm" file="US20230007261A1-20230105-P00211.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00212" he="2.79mm" wi="32.09mm" file="US20230007261A1-20230105-P00212.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00213" he="2.79mm" wi="34.54mm" file="US20230007261A1-20230105-P00213.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00214" he="2.79mm" wi="28.62mm" file="US20230007261A1-20230105-P00214.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00215" he="2.79mm" wi="33.87mm" file="US20230007261A1-20230105-P00215.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00216" he="2.79mm" wi="23.96mm" file="US20230007261A1-20230105-P00216.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00217" he="2.79mm" wi="24.38mm" file="US20230007261A1-20230105-P00217.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00218" he="2.79mm" wi="32.85mm" file="US20230007261A1-20230105-P00218.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00219" he="2.79mm" wi="24.38mm" file="US20230007261A1-20230105-P00219.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00220" he="2.79mm" wi="23.62mm" file="US20230007261A1-20230105-P00220.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00221" he="2.79mm" wi="39.20mm" file="US20230007261A1-20230105-P00221.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00222" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00222.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00223" he="2.79mm" wi="40.56mm" file="US20230007261A1-20230105-P00223.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00224" he="2.79mm" wi="33.87mm" file="US20230007261A1-20230105-P00224.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00225" he="2.79mm" wi="9.91mm" file="US20230007261A1-20230105-P00225.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00226" he="2.79mm" wi="27.52mm" file="US20230007261A1-20230105-P00226.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00227" he="2.79mm" wi="26.84mm" file="US20230007261A1-20230105-P00227.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00228" he="2.79mm" wi="28.19mm" file="US20230007261A1-20230105-P00228.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00229" he="2.79mm" wi="42.33mm" file="US20230007261A1-20230105-P00229.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00230" he="2.79mm" wi="9.14mm" file="US20230007261A1-20230105-P00230.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00231" he="2.79mm" wi="42.33mm" file="US20230007261A1-20230105-P00231.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00232" he="2.79mm" wi="29.63mm" file="US20230007261A1-20230105-P00232.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00233" he="2.79mm" wi="17.61mm" file="US20230007261A1-20230105-P00233.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00234" he="2.79mm" wi="28.96mm" file="US20230007261A1-20230105-P00234.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00235" he="2.79mm" wi="30.31mm" file="US20230007261A1-20230105-P00235.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00236" he="2.79mm" wi="23.96mm" file="US20230007261A1-20230105-P00236.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00237" he="2.79mm" wi="23.96mm" file="US20230007261A1-20230105-P00237.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00238" he="2.79mm" wi="34.97mm" file="US20230007261A1-20230105-P00238.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00239" he="2.79mm" wi="4.91mm" file="US20230007261A1-20230105-P00239.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00240" he="2.79mm" wi="29.63mm" file="US20230007261A1-20230105-P00240.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00241" he="2.79mm" wi="46.23mm" file="US20230007261A1-20230105-P00241.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00242" he="2.79mm" wi="34.21mm" file="US20230007261A1-20230105-P00242.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;</entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00243" he="2.79mm" wi="38.44mm" file="US20230007261A1-20230105-P00243.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00244" he="2.79mm" wi="21.84mm" file="US20230007261A1-20230105-P00244.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00245" he="2.79mm" wi="25.40mm" file="US20230007261A1-20230105-P00245.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00246" he="2.79mm" wi="45.89mm" file="US20230007261A1-20230105-P00246.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00247" he="2.79mm" wi="34.21mm" file="US20230007261A1-20230105-P00247.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00248" he="2.79mm" wi="35.98mm" file="US20230007261A1-20230105-P00248.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00249" he="2.79mm" wi="26.84mm" file="US20230007261A1-20230105-P00249.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00250" he="2.79mm" wi="20.83mm" file="US20230007261A1-20230105-P00250.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00251" he="2.79mm" wi="29.63mm" file="US20230007261A1-20230105-P00251.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00252" he="2.79mm" wi="22.94mm" file="US20230007261A1-20230105-P00252.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00253" he="2.79mm" wi="5.33mm" file="US20230007261A1-20230105-P00253.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00254" he="2.46mm" wi="31.41mm" file="US20230007261A1-20230105-P00254.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00255" he="2.46mm" wi="24.72mm" file="US20230007261A1-20230105-P00255.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00256" he="2.46mm" wi="37.08mm" file="US20230007261A1-20230105-P00256.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00257" he="2.46mm" wi="21.51mm" file="US20230007261A1-20230105-P00257.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00258" he="2.46mm" wi="5.33mm" file="US20230007261A1-20230105-P00258.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00259" he="2.79mm" wi="4.23mm" file="US20230007261A1-20230105-P00259.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00260" he="2.79mm" wi="3.56mm" file="US20230007261A1-20230105-P00260.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00261" he="2.79mm" wi="14.14mm" file="US20230007261A1-20230105-P00261.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00262" he="2.79mm" wi="33.87mm" file="US20230007261A1-20230105-P00262.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00263" he="2.79mm" wi="12.70mm" file="US20230007261A1-20230105-P00263.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00264" he="2.79mm" wi="30.73mm" file="US20230007261A1-20230105-P00264.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00265" he="2.79mm" wi="23.62mm" file="US20230007261A1-20230105-P00265.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00266" he="2.79mm" wi="13.04mm" file="US20230007261A1-20230105-P00266.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00267" he="2.79mm" wi="30.73mm" file="US20230007261A1-20230105-P00267.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00268" he="2.79mm" wi="23.62mm" file="US20230007261A1-20230105-P00268.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00269" he="2.46mm" wi="46.91mm" file="US20230007261A1-20230105-P00269.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00270" he="2.46mm" wi="41.66mm" file="US20230007261A1-20230105-P00270.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00271" he="2.46mm" wi="45.89mm" file="US20230007261A1-20230105-P00271.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00272" he="2.46mm" wi="18.03mm" file="US20230007261A1-20230105-P00272.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00273" he="2.79mm" wi="9.14mm" file="US20230007261A1-20230105-P00273.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00274" he="2.46mm" wi="41.66mm" file="US20230007261A1-20230105-P00274.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00275" he="2.46mm" wi="31.07mm" file="US20230007261A1-20230105-P00275.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00276" he="2.46mm" wi="45.89mm" file="US20230007261A1-20230105-P00276.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00277" he="2.46mm" wi="19.05mm" file="US20230007261A1-20230105-P00277.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00278" he="2.46mm" wi="24.38mm" file="US20230007261A1-20230105-P00278.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00279" he="2.46mm" wi="7.79mm" file="US20230007261A1-20230105-P00279.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00280" he="2.46mm" wi="23.28mm" file="US20230007261A1-20230105-P00280.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00281" he="2.46mm" wi="22.61mm" file="US20230007261A1-20230105-P00281.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00282" he="2.46mm" wi="19.05mm" file="US20230007261A1-20230105-P00282.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00283" he="2.46mm" wi="24.38mm" file="US20230007261A1-20230105-P00283.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00284" he="2.46mm" wi="6.01mm" file="US20230007261A1-20230105-P00284.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00285" he="2.46mm" wi="13.80mm" file="US20230007261A1-20230105-P00285.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00286" he="2.46mm" wi="21.84mm" file="US20230007261A1-20230105-P00286.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00287" he="2.46mm" wi="6.01mm" file="US20230007261A1-20230105-P00287.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00288" he="2.46mm" wi="4.91mm" file="US20230007261A1-20230105-P00288.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00289" he="2.46mm" wi="20.49mm" file="US20230007261A1-20230105-P00289.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00290" he="2.46mm" wi="19.73mm" file="US20230007261A1-20230105-P00290.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00291" he="2.46mm" wi="25.74mm" file="US20230007261A1-20230105-P00291.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00292" he="2.46mm" wi="34.97mm" file="US20230007261A1-20230105-P00292.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00293" he="2.46mm" wi="9.14mm" file="US20230007261A1-20230105-P00293.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00294" he="2.46mm" wi="33.87mm" file="US20230007261A1-20230105-P00294.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00295" he="2.46mm" wi="19.39mm" file="US20230007261A1-20230105-P00295.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00296" he="2.46mm" wi="27.52mm" file="US20230007261A1-20230105-P00296.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00297" he="2.46mm" wi="30.73mm" file="US20230007261A1-20230105-P00297.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00298" he="2.46mm" wi="28.96mm" file="US20230007261A1-20230105-P00298.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00299" he="2.46mm" wi="29.29mm" file="US20230007261A1-20230105-P00299.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00300" he="2.46mm" wi="25.06mm" file="US20230007261A1-20230105-P00300.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00301" he="2.46mm" wi="25.40mm" file="US20230007261A1-20230105-P00301.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00302" he="2.46mm" wi="25.40mm" file="US20230007261A1-20230105-P00302.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00303" he="2.46mm" wi="37.08mm" file="US20230007261A1-20230105-P00303.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00304" he="2.46mm" wi="26.84mm" file="US20230007261A1-20230105-P00304.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00305" he="2.46mm" wi="4.57mm" file="US20230007261A1-20230105-P00305.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00306" he="2.46mm" wi="25.40mm" file="US20230007261A1-20230105-P00306.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00307" he="2.46mm" wi="6.69mm" file="US20230007261A1-20230105-P00307.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00308" he="2.46mm" wi="23.96mm" file="US20230007261A1-20230105-P00308.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00309" he="2.46mm" wi="17.27mm" file="US20230007261A1-20230105-P00309.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00310" he="2.46mm" wi="26.50mm" file="US20230007261A1-20230105-P00310.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00311" he="2.46mm" wi="22.61mm" file="US20230007261A1-20230105-P00311.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00312" he="2.46mm" wi="19.73mm" file="US20230007261A1-20230105-P00312.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00313" he="2.46mm" wi="6.01mm" file="US20230007261A1-20230105-P00313.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><u style="single"><b>&#x2003;&#x2003;</b></u></entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00314" he="2.46mm" wi="35.31mm" file="US20230007261A1-20230105-P00314.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00315" he="2.46mm" wi="30.31mm" file="US20230007261A1-20230105-P00315.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00316" he="2.46mm" wi="7.45mm" file="US20230007261A1-20230105-P00316.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00317" he="2.46mm" wi="24.72mm" file="US20230007261A1-20230105-P00317.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00318" he="2.46mm" wi="4.57mm" file="US20230007261A1-20230105-P00318.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00319" he="2.46mm" wi="23.62mm" file="US20230007261A1-20230105-P00319.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00320" he="2.46mm" wi="7.45mm" file="US20230007261A1-20230105-P00320.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00321" he="2.46mm" wi="32.09mm" file="US20230007261A1-20230105-P00321.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00322" he="2.46mm" wi="32.85mm" file="US20230007261A1-20230105-P00322.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00323" he="2.46mm" wi="41.66mm" file="US20230007261A1-20230105-P00323.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00324" he="2.46mm" wi="5.67mm" file="US20230007261A1-20230105-P00324.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00325" he="2.46mm" wi="4.91mm" file="US20230007261A1-20230105-P00325.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00326" he="2.46mm" wi="4.23mm" file="US20230007261A1-20230105-P00326.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00327" he="2.46mm" wi="3.22mm" file="US20230007261A1-20230105-P00327.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00328" he="2.46mm" wi="2.46mm" file="US20230007261A1-20230105-P00328.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><heading id="h-0021" level="2">1.1.1.2 Palette Semantics</heading><p id="p-0069" num="0193">In the following semantics, the array indices x0, v0 specify the location (x0, v0) of the top-left luma sample of the considered coding block relative to the top-left luma sample of the picture.<br/>cu palette flag specifies the use of palette mode in the current coding unit. cu palette flag==1 indicates that palette mode is applied in the current coding unit. cu palette flag==0 indicates that palette mode is not applied for the current coding unit.<br/>cu_palette_ibc_flag specifies the use of palette mode in the current coding unit. cu_palette_ibc_flag==1 indicates that the mode of palette combined IBC prediction is applied in the current coding unit. cu_palette_ibc_flag==0 indicates that the mode of palette combined IBC prediction is not applied for the current coding unit.<br/>palette_predictor_run is used to determine the number of zeros that precede a non-zero entry in the array PalettePredictorEntryReuseFlags.<br/>It is a requirement of bitstream conformance that the value of palette predictor run shall be in the range of 0 to (PredictorPaletteSize&#x2212;predictorEntryIdx), inclusive, where predictorEntryIdx corresponds to the current position in the array PalettePredictorEntryReuseFlags. The variable NumPredictedPaletteEntries specifies the number of entries in the current palette that are reused from the predictor palette. The value of NumPredictedPaletteEntries shall be in the range of 0 to palette max size, inclusive.<br/>num_signalled_palette_entries [startComp] specifies the number of entries in the current palette that are explicitly signalled for the first colour component of the current palette table startComp.<br/>When num_signalled_palette_entries [startComp] is not present, it is inferred to be equal to 0.<br/>The variable CurrentPaletteSize specifies the size of the current palette and is derived as follows:</p><p id="p-0070" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>CurrentPaletteSize [startComp]=NumPredictedPaletteEntries [startComp]+num_signalled_palette_entries [startComp]&#x2003;&#x2003;(XX)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0071" num="0000">The value of CurrentPaletteSize [startComp] shall be in the range of 0 to palette_max_size, inclusive.<br/>new_palette_entries[cIdx][i] specifies the value for the i-th signalled palette entry for the colour component cIdx.<br/>The variable PredictorPaletteEntries[cIdx][1] specifies the i-th element in the predictor palette for the colour component cIdx.<br/>The variable CurrentPaletteEntries[cIdx][1] specifies the i-th element in the current palette for the colour component cIdx and is derived as follows:</p><p id="p-0072" num="0000"><tables id="TABLE-US-00009" num="00009"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="196pt" align="left"/><colspec colname="2" colwidth="21pt" align="right"/><thead><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>numPredictedPaletteEntries = 0</entry><entry>(XX)</entry></row><row><entry>for( i = 0; i &#x3c;PredictorPaletteSize[ startComp]; i++)</entry><entry/></row><row><entry>&#x2003;if( PalettePredictorEntrvReuseFlaas[ i 1 ]) {</entry><entry/></row><row><entry>&#x2003;&#x2003;for( cidx =startComp; cidx &#x3c; (startComp + numComps); cIdx++)</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;CurrentPaletteEntries[ cIdx ][ numPredictedPaletteEntries ]=</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;PredictorPaletteEntries[ cIdx][ i ]</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;numPredictedPaletteEntries++</entry><entry/></row><row><entry>}</entry><entry/></row><row><entry>for( i = 0; i &#x3c; num_signalled_palette_entries[startComp]; i++)</entry><entry/></row><row><entry>&#x2003;for( cIdx =startComp; cIdx &#x3c; (startComp + numComps); cIdx++)</entry><entry/></row><row><entry>&#x2003;&#x2003;CurrentPaletteEntries[ cIdx ][ numPredictedPaletteEntries + i ] =</entry><entry/></row><row><entry>&#x2003;&#x2003;new palette entries[ cIdxg ][ i ]</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables><br/>palette_escape_val_present_flag equal to 1 specifies that the current coding unit contains at least one escape coded sample. escape_val_present_flag equal to 0 specifies that there are no escape coded samples in the current coding unit. When not present, the value of palette escape_val_present_flag is inferred to be equal to 1.<br/>The variable MaxPaletteIndex specifies the maximum possible value for a palette index for the current coding unit. The value of MaxPaletteIndex is set equal to CurrentPaletteSize+palette escape_val_present_flag.<br/>num_palette_indices_minus1 plus 1 is the number of palette indices explicitly signalled or inferred for the current block.<br/>When num_palette_indices_minus1 is not present, it is inferred to be equal to 0.<br/>palette_index_idc is an indication of an index to the array represented by CurrentPaletteEntries. The value of palette_index_idc shall be in the range of 0 to MaxPaletteIndex, inclusive, for the first index in the block and in the range of 0 to (MaxPaletteIndex&#x2212;1), inclusive, for the remaining indices in the block.<br/>When palette_index_idc is not present, it is inferred to be equal to 0.<br/>The variable PaletteIndexIdc[i] stores the i-th palette index idc explicitly signalled or inferred. All elements of the array PaletteIndexIdc[i] are initialized to 0.<br/>copy_above_indices_for_final_run_flag equal to 1 specifies that the palette indices of the last positions in the coding unit are copied from the palette indices in the row above if horizontal traverse scan is used or the palette indices in the left column if vertical traverse scan is used. copy above indices for final run flag equal to 0 specifies that the palette indices of the last positions in the coding unit are copied from PaletteIndexIdc[num palette indices minus1].<br/>When copy_above_indices_for_final_run_flag is not present, it is inferred to be equal to 0.<br/>palette_transpose_flag equal to 1 specifies that vertical traverse scan is applied for scanning the indices for pixels in the current coding unit. palette_transpose_flag equal to 0 specifies that horizontal traverse scan is applied for scanning the indices for pixels in the current coding unit.<br/>copy_above_palette_indices_flag equal to 1 specifies that the palette index is equal to the palette index at the same location in the row above if horizontal traverse scan is used or the same location in the left column if vertical traverse scan is used. copy_above_palette_indices_flag equal to 0 specifies that an indication of the palette index of the sample is coded in the bitstream or inferred.<br/>The variable CopyAboveIndicesFlag[xC][yC] equal to 1 specifies that the palette index is copied from the palette index in the row above (horizontal scan) or left column (vertical scan). CopyAboveIndicesFlag[xC][yC] equal to 0 specifies that the palette index is explicitly coded in the bitstream or inferred. The array indices xC, yC specify the location (xC, yC) of the sample relative to the top-left luma sample of the picture.<br/>The variable PaletteIndexMap[xC][yC] specifies a palette index, which is an index to the array represented by CurrentPaletteEntries. The array indices xC, yC specify the location (xC, yC) of the sample relative to the top-left luma sample of the picture. The value of PaletteIndexMap[xC][yC] shall be in the range of 0 to MaxPaletteIndex, inclusive.<br/>The variable PaletteRun specifies the number of consecutive locations minus 1 with the same palette index as the position in the above row (horizontal scan) or in the left column (vertical scan) when CopvAboveIndicesFlag[xC][yC] is equal to 1 or specifies the number of consecutive locations minus 1 with the same palette index when CopyAboveIndicesFlag[xC][yC] is equal to 0.<br/>The variable PaletteMaxRun represents the maximum possible value for PaletteRun. It is a requirement of bitstream conformance that the value of PaletteMaxRun shall be greater than or equal to 0.<br/>palette_run_prefix specifies the prefix part in the binarization of PaletteRun.<br/>palette run suffix specifies the suffix part in the binarization of PaletteRun. When palette run suffix is not present, the value of palette run suffix is inferred to be equal to 0.</p><p id="p-0073" num="0194">The value of PaletteRun is derived as follows:<ul id="ul0056" list-style="none">    <li id="ul0056-0001" num="0000">    <ul id="ul0057" list-style="none">        <li id="ul0057-0001" num="0195">If palette_run_prefix is less than 2, the following applies:</li>    </ul>    </li></ul></p><p id="p-0074" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>PaletteRun=palette run prefix&#x2003;&#x2003; (XX)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0058" list-style="none">    <li id="ul0058-0001" num="0000">    <ul id="ul0059" list-style="none">        <li id="ul0059-0001" num="0196">Otherwise (palette_run_prefix is greater than or equal to 2), the following applies:</li>    </ul>    </li></ul></p><p id="p-0075" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>PrefixOffset=1&#x3c;&#x3c;(palette_run_prefix&#x2212;1)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0076" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>PaletteRun=PrefixOffset+palette run suffix&#x2003;&#x2003;(XX)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0077" num="0000">palette_escape_val specifies the magnitude of the quantized escape coded sample value for a component.<br/>palette_escape_sign specifies the sign of quantized escape coded sample value for a component.<br/>The variable PaletteEscapeVal[cIdx][xC][yC] specifies the escape value of a sample for which PaletteIndexMap[xC][yC] is equal to (MaxPaletteIndex&#x2212;1) and palette_escape_val_present_flag is equal to 1. The array index cIdx specifies the colour component. The array indices xC, yC specify the location (xC, yC) of the sample relative to the top-left luma sample of the picture.<br/>It is a requirement of bitstream conformance that PaletteEscapeVal[cIdx][xC][yC] shall be in the range of &#x2212;((1&#x3c;&#x3c;(BitDepth<sub>Y</sub>+1))&#x2212;1) to (1&#x3c;&#x3c;(BitDepth<sub>Y</sub>+1))&#x2212;1, inclusive, for cIdx equal to 0, and in the range of 0 to (1&#x3c;&#x3c;(BitDepth<sub>C</sub>+1))&#x2212;1, inclusive, for cIdx not equal to 0</p><heading id="h-0022" level="2">Decoding Process for Palette Mode</heading><p id="p-0078" num="0197">Inputs to this process are:<ul id="ul0060" list-style="none">    <li id="ul0060-0001" num="0000">    <ul id="ul0061" list-style="none">        <li id="ul0061-0001" num="0198">a location (xCb, yCb) specifying the top-left luma sample of the current block relative to the top-left luma sample of the current picture,</li>        <li id="ul0061-0002" num="0199">a variable startComp specifies the first colour component in the palette table,</li>        <li id="ul0061-0003" num="0200">a variable cIdx specifying the colour component of the current block,</li>        <li id="ul0061-0004" num="0201">two variables nTbW and nTbH specifying the width and height of the current block, respectively.<br/>Output of this process is an array recSamples[x][y], with x=0 . . . nTbW&#x2212;1, y=0 . . . nTbH&#x2212;1 specifying reconstructed sample values for the block.<br/>Depending on the value of cIdx, the variables nSubWidth and nSubHeight are derived as follows:</li>        <li id="ul0061-0005" num="0202">If cIdx is equal to 0, nSubWidth is set to 1 and nSubHeight is set to 1.</li>        <li id="ul0061-0006" num="0203">If startComp is equal to 1 and if cIdx&#x3e;1, nSubWidth is set to 1 and nSubHeight is set to 1.</li>        <li id="ul0061-0007" num="0204">Otherwise, nSubWidth is set to SubWidthC and nSubHeight is set to SubHeightC.</li>        <li id="ul0061-0008" num="0205">If cu_palette_ibc_flag is equal to 1, the following applies:        <ul id="ul0062" list-style="none">            <li id="ul0062-0001" num="0206">The derivation process for the motion vectors as specified in clause 8.6.2 is invoked with a luma location (xCb, yCb) of the top-left sample of the current luma coding block relative to the top-left luma sample of the current picture, a variable cbWidth specifying the width of the current coding block in luma samples, and a variable cbHeight specifying the height of the current coding block in luma samples. The outputs are the luma motion vector in 1/16 fractional-sample accuracy mvL.</li>            <li id="ul0062-0002" num="0207">The general IBC prediction process as specified in clause 8.6.3 is invoked with a luma location (xCb, yCb) specifying the top-left sample of the current coding block relative to the top-left luma sample of the current picture, a variable cbWidth specifying the width of the current coding block in luma samples, a variable cbHeight specifying the height of the current coding block in luma samples, variables numSbX and numSbY specifying the number of luma coding subblocks in horizontal and vertical direction, the motion vectors mv[xSbIdx][ySbIdx] with xSbIdx=0 . . . numSbX&#x2212;1, and ySbIdx=0 . . . numSbY&#x2212;1, a variable cIdx specifying the colour component index of the current block. The output is an array predSamples of prediction samples predSamples[x][y].<br/>The (nTbW&#xd7;nTbH) block of the reconstructed sample array recSamples at location (xCb, yCb) is represented by recSamples [x][y] with x=0 . . . nTbW&#x2212;1 and y=0 . . . nTbH&#x2212;1, and the value of recSamples[x][y] for each x in the range of 0 to nTbW&#x2212;1, inclusive, and each v in the range of 0 to nTbH&#x2212;1, inclusive, is derived as follows:</li>        </ul>        </li>        <li id="ul0061-0009" num="0208">The variables xL and yL are derived as follows:</li>    </ul>    </li></ul></p><p id="p-0079" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>xL</i>=palette_transpose_flag?<i>x*n</i>SubHeight:<i>x*nSubWidth</i>&#x2003;&#x2003;(5-1)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0080" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>yL</i>=palette tra1nspose flag?<i>y*n</i>SubWidth:<i>y*n</i>SubHeight&#x2003;&#x2003;(5-2)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0063" list-style="none">    <li id="ul0063-0001" num="0000">    <ul id="ul0064" list-style="none">        <li id="ul0064-0001" num="0209">The variable bIsEscapeSample is derived as follows:        <ul id="ul0065" list-style="none">            <li id="ul0065-0001" num="0210">If PaletteIndexMap[xCb+xL][yCb+yL] is equal to MaxPaletteIndex and palette escape_val_present_flag is equal to 1, bIsEscapeSample is set equal to 1.</li>            <li id="ul0065-0002" num="0211">Otherwise, bIsEscapeSample is set equal to 0.</li>        </ul>        </li>        <li id="ul0064-0002" num="0212">If bIsEscapeSample is equal to 0, the following applies:        <ul id="ul0066" list-style="none">            <li id="ul0066-0001" num="0213">If cu palette ibc flag is equal to 1, the following applies:</li>            <li id="ul0066-0002" num="0214">If PaletteIndexMap[xCb+xL][yCb+yL] is equal to 0, the following applies:</li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0081" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>recSamples[<i>x</i>][<i>y</i>]=predSamples[<i>x</i>][<i>y</i>]<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0067" list-style="none">    <li id="ul0067-0001" num="0000">    <ul id="ul0068" list-style="none">        <li id="ul0068-0001" num="0000">        <ul id="ul0069" list-style="none">            <li id="ul0069-0001" num="0215">Otherwise, the following applies:</li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0082" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>recSamples[<i>x</i>][<i>y</i>]=CurrentPaletteEntries[<i>cIdx</i>][PaletteIndexMap[<i>xCb+xL</i>][<i>yCb+yL</i>]&#x2212;1]&#x2003;&#x2003;(5-3)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0070" list-style="none">    <li id="ul0070-0001" num="0000">    <ul id="ul0071" list-style="none">        <li id="ul0071-0001" num="0000">        <ul id="ul0072" list-style="none">            <li id="ul0072-0001" num="0216">Otherwise, the following applies:</li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0083" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>recSamples[<i>x</i>][<i>y</i>]=CurrentPaletteEntries[<i>cIdx</i>][PaletteIndexMap[<i>xCb+xL</i>][<i>yCb+yL</i>]]&#x2003;&#x2003;(5-4)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0073" list-style="none">    <li id="ul0073-0001" num="0000">    <ul id="ul0074" list-style="none">        <li id="ul0074-0001" num="0217">Otherwise, if cu transquant bypass flag is equal to 1, the following applies:</li>    </ul>    </li></ul></p><p id="p-0084" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>recSamples[<i>x</i>][<i>y</i>]=predSamples[<i>x</i>][<i>y</i>]+PaletteEscapeVal[<i>cIdx</i>][<i>xCb+xL</i>][<i>yCb+yL</i>]&#x2003;&#x2003;(5-5)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0075" list-style="none">    <li id="ul0075-0001" num="0000">    <ul id="ul0076" list-style="none">        <li id="ul0076-0001" num="0218">Otherwise (bIsEscapeSample is equal to 1 and cu transquant bypass flag is equal to 0), the following ordered steps apply:        <ul id="ul0077" list-style="none">            <li id="ul0077-0001" num="0219">1. The derivation process for quantization parameters is invoked with the location (xCb, yCb) specifying the top-left sample of the current block relative to the top-left sample of the current picture.</li>            <li id="ul0077-0002" num="0220">2. The quantization parameter qP is derived as follows:            <ul id="ul0078" list-style="none">                <li id="ul0078-0001" num="0221">If cIdx is equal to 0,</li>            </ul>            </li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0085" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>qP</i>=Max(0,<i>Qp&#x2032;Y</i>)&#x2003;&#x2003;(5-6)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0079" list-style="none">    <li id="ul0079-0001" num="0000">    <ul id="ul0080" list-style="none">        <li id="ul0080-0001" num="0000">        <ul id="ul0081" list-style="none">            <li id="ul0081-0001" num="0000">            <ul id="ul0082" list-style="none">                <li id="ul0082-0001" num="0222">Otherwise, if cIdx is equal to 1,</li>            </ul>            </li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0086" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>qP</i>=Max(0,<i>Qp&#x2032;Cb</i>)&#x2003;&#x2003;(5-7)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0083" list-style="none">    <li id="ul0083-0001" num="0000">    <ul id="ul0084" list-style="none">        <li id="ul0084-0001" num="0000">        <ul id="ul0085" list-style="none">            <li id="ul0085-0001" num="0000">            <ul id="ul0086" list-style="none">                <li id="ul0086-0001" num="0223">Otherwise (cIdx is equal to 2),</li>            </ul>            </li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0087" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>qP</i>=Max(0<i>,Qp&#x2032;Cr</i>)&#x2003;&#x2003;(5-8)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0087" list-style="none">    <li id="ul0087-0001" num="0000">    <ul id="ul0088" list-style="none">        <li id="ul0088-0001" num="0000">        <ul id="ul0089" list-style="none">            <li id="ul0089-0001" num="0224">3. The variables bitDepth is derived as follows:</li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0088" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>bitDepth=(<i>cIdx==</i>0)?BitDepth<sub>Y</sub>:BitDepth<sub>C</sub>&#x2003;&#x2003;(5-9)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0090" list-style="none">    <li id="ul0090-0001" num="0000">    <ul id="ul0091" list-style="none">        <li id="ul0091-0001" num="0000">        <ul id="ul0092" list-style="none">            <li id="ul0092-0001" num="0225">4. The list levelScale[ ] is specified as levelScale[k]={40, 45, 51, 57, 64, 72} with k=0 . . . 5.</li>            <li id="ul0092-0002" num="0226">5. The following applies:            <ul id="ul0093" list-style="none">                <li id="ul0093-0001" num="0227">If cu_palette_ibc_flag is equal to 1, the following applies</li>            </ul>            </li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0089" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>tmpVal=(PaletteEscapeVal[<i>cIdx</i>][<i>xCb+xL</i>][<i>yCb+yL</i>]*levelScale[<i>qP </i>%6])&#x3c;&#x3c;(<i>qP/</i>6)+32)&#x3e;&#x3e;6&#x2003;&#x2003;(5-10)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0090" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>recSamples[<i>x</i>][<i>y</i>]=Clip3(0,(1&#x3c;&#x3c;bitDepth)&#x2212;1,predSamples[<i>x</i>][<i>y</i>]+tmpVal)&#x2003;&#x2003; (5-11)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0094" list-style="none">    <li id="ul0094-0001" num="0000">    <ul id="ul0095" list-style="none">        <li id="ul0095-0001" num="0000">        <ul id="ul0096" list-style="none">            <li id="ul0096-0001" num="0000">            <ul id="ul0097" list-style="none">                <li id="ul0097-0001" num="0228">Otherwise, if cu_palette_ibc_flag is equal to 0, the following applies</li>            </ul>            </li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0091" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>tmpVal=(PaletteEscapeVal[<i>cIdx</i>][<i>xCb+xL</i>][<i>yCb+yL</i>]*levelScale[<i>gP </i>%6])&#x3c;&#x3c;(<i>gP/</i>6)+32)&#x3e;&#x3e;6&#x2003;&#x2003;(5-10)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0092" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>recSamples[<i>x</i>][<i>y</i>]=Clip3(0,(1&#x3c;&#x3c;bitDepth)&#x2212;1,tmpVal)&#x2003;&#x2003;(5-11)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0093" num="0000">Palette predictor update process for palette mode<br/>Inputs to this process are:<ul id="ul0098" list-style="none">    <li id="ul0098-0001" num="0000">    <ul id="ul0099" list-style="none">        <li id="ul0099-0001" num="0229">a location (xCb, yCb) specifying the top-left luma sample of the current block relative to the top-left luma sample of the current picture,</li>        <li id="ul0099-0002" num="0230">a variable startComp specifies the first colour component in the palette table,</li>        <li id="ul0099-0003" num="0231">a variable numComps specifies the number of colour components in the palette table,<br/>Output of this process is a variable PredictorPaletteSize[startComp] specifying the size of the updated palette predictor, and an array PredictorPaletteEntries [cIdx][i], with cIdx=startComp, . . . , startComp+numComps&#x2212;1, i=0 . . . PredictorPaletteSize&#x2212;1 specifying the updated palette predictor for the next block.<br/>The variable PredictorPaletteSize and the array PredictorPaletteEntries are derived or modified as follows:</li>    </ul>    </li></ul></p><p id="p-0094" num="0000"><tables id="TABLE-US-00010" num="00010"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="217pt" align="left"/><thead><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry>for( i = 0; i &#x3c; CurrentPaletteSize; i++)</entry></row><row><entry>&#x2003;for( cIdx = startComp; cIdx &#x3c; (startComp + numComps); cIdx++)</entry></row><row><entry>&#x2003;&#x2003;newPredictorPaletteEntries[ cIdx ][ i ] = CurrentPaletteEntries[ cIdx ][ i ]</entry></row><row><entry>newPredictorPaletteSize = CurrentPaletteSize</entry></row><row><entry>for( i = 0; i &#x3c; PredictorPaletteSize &#x26;&#x26; newPredictorPaletteSize &#x3c;</entry></row><row><entry>PaletteMaxPredictorSize; i++)</entry></row><row><entry>&#x2003;if( !PalettePredictorEntrvReuseFlaasi i 1 ) </entry></row><row><entry>&#x2003;&#x2003;for( cIdx = startComp; cIdx &#x3c; (startComp +numComps); cIdx++)</entry></row><row><entry>&#x2003;&#x2003;&#x2003;newPredictorPaletteEntries[ cIdx ][ newPredictorPaletteSize ] =</entry></row><row><entry>&#x2003;&#x2003;&#x2003;PredictorPaletteEntries[ cIdx ][ i ]</entry></row><row><entry>&#x2003;newPredictorPaletteSize++</entry></row><row><entry>&#x2003;}</entry></row><row><entry>for( cIdx = startComp; cIdx &#x3c; (startComp + numComps); cIdx++)</entry></row><row><entry>&#x2003;for( i = 0; i &#x3c; newPredictorPaletteSize; I++)</entry></row><row><entry>&#x2003;PredictorPaletteEntries[ cIdx ][ i ] = newPredictorPaletteEntries[ cIdx ][ i ]</entry></row><row><entry>PredictorPaletteSize = newPredictorPaletteSize</entry></row><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row></tbody></tgroup></table></tables><br/>It is a requirement of bitstream conformance that the value of PredictorPaletteSize shall be in the range of 0 to PaletteMaxPredictorSize, inclusive</p><p id="p-0095" num="0000"><tables id="TABLE-US-00011" num="00011"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="217pt" align="center"/><thead><row><entry namest="1" nameend="1" rowsep="1">TABLE 1</entry></row></thead><tbody valign="top"><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row><row><entry><img id="CUSTOM-CHARACTER-00329" he="2.46mm" wi="17.27mm" file="US20230007261A1-20230105-P00329.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00330" he="2.46mm" wi="38.10mm" file="US20230007261A1-20230105-P00330.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="1" colwidth="56pt" align="left"/><colspec colname="2" colwidth="63pt" align="left"/><colspec colname="3" colwidth="98pt" align="center"/><tbody valign="top"><row><entry><img id="CUSTOM-CHARACTER-00331" he="2.46mm" wi="7.45mm" file="US20230007261A1-20230105-P00331.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/><entry><img id="CUSTOM-CHARACTER-00332" he="2.46mm" wi="13.04mm" file="US20230007261A1-20230105-P00332.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="4"><colspec colname="1" colwidth="56pt" align="left"/><colspec colname="2" colwidth="63pt" align="left"/><colspec colname="3" colwidth="35pt" align="left"/><colspec colname="4" colwidth="63pt" align="left"/><tbody valign="top"><row><entry><img id="CUSTOM-CHARACTER-00333" he="2.46mm" wi="9.57mm" file="US20230007261A1-20230105-P00333.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00334" he="2.46mm" wi="15.92mm" file="US20230007261A1-20230105-P00334.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00335" he="2.12mm" wi="8.13mm" file="US20230007261A1-20230105-P00335.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00336" he="2.46mm" wi="16.93mm" file="US20230007261A1-20230105-P00336.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry namest="1" nameend="4" align="center" rowsep="1"/></row><row><entry><img id="CUSTOM-CHARACTER-00337" he="2.46mm" wi="14.82mm" file="US20230007261A1-20230105-P00337.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00338" he="2.46mm" wi="17.61mm" file="US20230007261A1-20230105-P00338.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00339" he="2.46mm" wi="3.56mm" file="US20230007261A1-20230105-P00339.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00340" he="2.46mm" wi="9.91mm" file="US20230007261A1-20230105-P00340.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry/><entry><img id="CUSTOM-CHARACTER-00341" he="2.12mm" wi="2.79mm" file="US20230007261A1-20230105-P00341.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry namest="1" nameend="4" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><p id="p-0096" num="0000"><tables id="TABLE-US-00012" num="00012"><table frame="none" colsep="0" rowsep="0"><tgroup align="left" colsep="0" rowsep="0" cols="1"><colspec colname="1" colwidth="217pt" align="center"/><thead><row><entry namest="1" nameend="1" rowsep="1">TABLE 2</entry></row></thead><tbody valign="top"><row><entry namest="1" nameend="1" align="center" rowsep="1"/></row><row><entry>Assignment of ctxInc to syntax elements </entry></row><row><entry>with context coded bins</entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="3"><colspec colname="offset" colwidth="14pt" align="left"/><colspec colname="1" colwidth="28pt" align="left"/><colspec colname="2" colwidth="175pt" align="center"/><tbody valign="top"><row><entry/><entry/><entry><img id="CUSTOM-CHARACTER-00342" he="2.46mm" wi="7.03mm" file="US20230007261A1-20230105-P00342.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="8"><colspec colname="offset" colwidth="14pt" align="left"/><colspec colname="1" colwidth="28pt" align="left"/><colspec colname="2" colwidth="35pt" align="left"/><colspec colname="3" colwidth="28pt" align="left"/><colspec colname="4" colwidth="28pt" align="left"/><colspec colname="5" colwidth="28pt" align="left"/><colspec colname="6" colwidth="28pt" align="left"/><colspec colname="7" colwidth="28pt" align="left"/><tbody valign="top"><row><entry/><entry><img id="CUSTOM-CHARACTER-00343" he="2.46mm" wi="15.92mm" file="US20230007261A1-20230105-P00343.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00344" he="2.46mm" wi="2.12mm" file="US20230007261A1-20230105-P00344.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00345" he="2.46mm" wi="2.12mm" file="US20230007261A1-20230105-P00345.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00346" he="2.46mm" wi="2.12mm" file="US20230007261A1-20230105-P00346.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00347" he="2.46mm" wi="2.12mm" file="US20230007261A1-20230105-P00347.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00348" he="2.46mm" wi="2.12mm" file="US20230007261A1-20230105-P00348.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00349" he="2.46mm" wi="4.91mm" file="US20230007261A1-20230105-P00349.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry/><entry namest="offset" nameend="7" align="center" rowsep="1"/></row><row><entry/><entry><img id="CUSTOM-CHARACTER-00350" he="2.46mm" wi="19.73mm" file="US20230007261A1-20230105-P00350.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00351" he="2.46mm" wi="2.12mm" file="US20230007261A1-20230105-P00351.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00352" he="2.12mm" wi="2.79mm" file="US20230007261A1-20230105-P00352.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00353" he="2.12mm" wi="2.79mm" file="US20230007261A1-20230105-P00353.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00354" he="2.12mm" wi="2.79mm" file="US20230007261A1-20230105-P00354.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00355" he="2.12mm" wi="2.79mm" file="US20230007261A1-20230105-P00355.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00356" he="2.12mm" wi="2.79mm" file="US20230007261A1-20230105-P00356.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry/><entry namest="offset" nameend="7" align="center" rowsep="1"/></row></tbody></tgroup></table></tables></p><heading id="h-0023" level="1">7. Embodiment Based on JVET-O2001-vE</heading><p id="p-0097" num="0232">Changes are highlighted by bolded, italicized, underlined text. Deleted texts are marked with <img id="CUSTOM-CHARACTER-00357" he="2.79mm" wi="13.38mm" file="US20230007261A1-20230105-P00357.TIF" alt="custom-character" img-content="character" img-format="tif"/>.</p><heading id="h-0024" level="1">Embodiment 1</heading><heading id="h-0025" level="2">7.3.8.5 Coding Unit Syntax</heading><p id="p-0098" num="0233"></p><p id="p-0099" num="0000"><tables id="TABLE-US-00013" num="00013"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="224pt" align="left"/><colspec colname="2" colwidth="49pt" align="left"/><thead><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry>coding_unit( x0, y0, cbWidth, cbHeight, cqtDepth, treeType, modeTyp</entry><entry/></row><row><entry>e ) {</entry><entry>Descriptor</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="224pt" align="left"/><colspec colname="2" colwidth="49pt" align="center"/><tbody valign="top"><row><entry>&#x2003;chType = treeType = = DUAL_TREE_CHROMA? 1 : 0</entry><entry/></row><row><entry>&#x2003;if( slice_type != I &#x2225; sps_ibc_enabled_flag &#x2225;</entry><entry/></row><row><entry>sps_palette_enabled_flag) {</entry><entry/></row><row><entry>&#x2003;...</entry><entry/></row><row><entry>&#x2003;&#x2003;if( ( ( ( slice_type = = I &#x2225; ( cbWidth = = 4 &#x26;&#x26; cbHeight = = 4 ) &#x2225;</entry><entry/></row><row><entry>sps_ibc_enabled_flag ) &#x26;&#x26; CuPredMode[ x0 ][ y0 ] = =</entry><entry/></row><row><entry>MODE_INTRA ) &#x2225;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;( slice_type != I &#x26;&#x26; !( cbWidth = = 4 &#x26;&#x26; cbHeight = = 4 ) &#x26;&#x26;</entry><entry/></row><row><entry>!sps_ibc_enabled_flag &#x26;&#x26; CuPredMode[ x0 ][ y0 ] !=</entry><entry/></row><row><entry>MODE_INTRA ) ) &#x26;&#x26; sps_palette_enabled_flag &#x26;&#x26; cbWidth &#x3c;= 64</entry><entry/></row><row><entry>&#x26;&#x26; cbHeight &#x3c;= 64 &#x26;&#x26; &#x26;&#x26; cu_skip_flag[ x0 ][ y0 ] = = 0 &#x26;&#x26;</entry><entry/></row><row><entry>modeType != MODE_INTER )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;pred_mode_plt_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;}</entry><entry/></row><row><entry>&#x2003;if( CuPredMode[ chType ][ x0 ][ y0 ] = = MODE_INTRA &#x2225;</entry><entry/></row><row><entry>&#x2003;&#x2003;CuPredMode[ chType ][ x0 ][ y0 ] = = MODE_PLT ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;if( treeType = = SINGLE_TREE &#x2225; treeType = =</entry><entry/></row><row><entry>DUAL_TREE_LUMA ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if( pred_mode_plt_flag ) {</entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00358" he="2.46mm" wi="21.84mm" file="US20230007261A1-20230105-P00358.TIF" alt="custom-character" img-content="character" img-format="tif"/> &#x2009;<img id="CUSTOM-CHARACTER-00359" he="2.46mm" wi="25.06mm" file="US20230007261A1-20230105-P00359.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00360" he="2.46mm" wi="16.93mm" file="US20230007261A1-20230105-P00360.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00361" he="2.46mm" wi="5.67mm" file="US20230007261A1-20230105-P00361.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;if( treeType = = DUAL_TREE_LUMA )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;palette_coding( x0, y0, cbWidth, cbHeight, 0, 1 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;else /* SINGLE_TREE */</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;palette_coding( x0, y0, cbWidth, cbHeight, 0, 3 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;...</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;...</entry><entry/></row><row><entry>}</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables><br/>plt ibc flag specifies the use of palette mode in the current coding unit. plt_ibc_flag equal to 1 indicates that compound palette mode is applied in the current coding unit. plt_ibc_flag equal to 0 indicates that compound palette mode is not applied in the current coding unit. When plt_ibc_flag is not present, it is inferred to be equal to 0.<br/>palette_escape_val_present_flag equal to 1 specifies that the current coding unit contains at least one escape coded sample. escape_val_present_flag equal to 0 specifies that there are no escape coded samples in the current coding unit. When not present, the value of palette_escape_val_present_flag is inferred to be equal to 1.<br/>The variable MaxPaletteIndex specifies the maximum possible value for a palette index for the current coding unit. The value of MaxPaletteIndex is set equal to CurrentPaletteSize[startComp]&#x2212;1+palette_escape_val_present_flag+(plt_ibc_flag?1:0).</p><heading id="h-0026" level="2">8.4.5.3 Decoding Process for Palette Mode</heading><p id="p-0100" num="0234">Inputs to this process are:<ul id="ul0100" list-style="none">    <li id="ul0100-0001" num="0000">    <ul id="ul0101" list-style="none">        <li id="ul0101-0001" num="0235">a location (xCb, yCb) specifying the top-left luma sample of the current block relative to the top-left luma sample of the current picture,</li>        <li id="ul0101-0002" num="0236">a variable startComp specifies the first colour component in the palette table,</li>        <li id="ul0101-0003" num="0237">a variable cIdx specifying the colour component of the current block,</li>        <li id="ul0101-0004" num="0238">two variables nCbW and nCbH specifying the width and height of the current block, respectively.</li>    </ul>    </li></ul></p><p id="p-0101" num="0239">Output of this process is an array recSamples[x][y], with x=0 . . . nCbW&#x2212;1, y=0 . . . nCbH&#x2212;1 specifying reconstructed sample values for the block.</p><p id="p-0102" num="0240">Depending on the value of cIdx, the variables nSubWidth and nSubHeight are derived as follows:<ul id="ul0102" list-style="none">    <li id="ul0102-0001" num="0000">    <ul id="ul0103" list-style="none">        <li id="ul0103-0001" num="0241">If cIdx is equal to 0, nSubWidth is set to 1 and nSubHeight is set to 1.</li>        <li id="ul0103-0002" num="0242">Otherwise, nSubWidth is set to SubWidthC and nSubHeight is set to SubHeightC.</li>    </ul>    </li></ul></p><p id="p-0103" num="0243">If plt_ibc_flag is equal to 1 the following applies:<ul id="ul0104" list-style="none">    <li id="ul0104-0001" num="0000">    <ul id="ul0105" list-style="none">        <li id="ul0105-0001" num="0244">The derivation process for IBC luma motion vector prediction as specified in clause 8.6.2.2 is invoked with the luma location (xCb, yCb), the variables cbWidth and cbHeight inputs, merge_idx[xCb][yCb] is set as the first valid BV merge index, and the output being the luma motion vector mvL.</li>        <li id="ul0105-0002" num="0245">The decoding process for ibc blocks as specified in clause 8.6.3.1 is invoked with the luma coding block location (xCb, yCb), the luma coding block width cbWidth and the luma coding block height cbHeight, the number of luma coding subblocks in horizontal direction numSbX and in vertical direction numSbY, the luma motion vectors mvL[xSbIdx][ySbIdx] with xSbIdx=0 . . . numSbX&#x2212;1, and ySbIdx=0 . . . numSbY&#x2212;1, the variable cIdx set equal to 0 as inputs, and the ibc prediction samples (predSamples) that are an (cbWidth)&#xd7;(cbHeight) array predSamplesL of prediction luma samples as outputs.</li>    </ul>    </li></ul></p><p id="p-0104" num="0246">It is a requirement of bitstream conformance that at least one merge index indicates a valid luma block vector bvL and the bvL shall obey the following constraints:</p><p id="p-0105" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>Ctb</i>Size<i>Y </i>is greater than or equal to ((<i>yCb</i>+(<i>bvL</i>[1]&#x3e;&#x3e;4)) &#x26; (<i>Ctb</i>Size<i>Y</i>&#x2212;1))+<i>cb</i>Height.<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0106" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>IbcVirBuf</i>[0][(<i>x</i>+(<i>bvL</i>[0]&#x3e;&#x3e;4)) &#x26; (<i>IbcVirBuf</i>Width&#x2212;1)][(<i>y</i>+(<i>bvL</i>[1]&#x3e;&#x3e;4)) &#x26; (<i>Ctb</i>Size<i>Y</i>&#x2212;1)] shall not be equal to &#x2212;1 for <i>x=xCb . . . xCb+cb</i>Width&#x2212;1 and <i>y=yCb . . . yCb+cb</i>Height&#x2212;1<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0107" num="0247">The (nCbW&#xd7;nCbH) block of the reconstructed sample array recSamples at location (xCb, yCb) is represented by recSamples[x][y] with x=0 . . . nCTbW&#x2212;1 and y=0 . . . nCbH&#x2212;1, and the value of recSamples[x][y] for each x in the range of 0 to nCbW&#x2212;1, inclusive, and each y in the range of 0 to nCbH&#x2212;1, inclusive, is derived as follows:<ul id="ul0106" list-style="none">    <li id="ul0106-0001" num="0000">    <ul id="ul0107" list-style="none">        <li id="ul0107-0001" num="0248">The variables xL and yL are derived as follows:</li>    </ul>    </li></ul></p><p id="p-0108" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>xL</i>=palette_transpose_flag?<i>x*n</i>SubHeight: <i>x*n</i>SubWidth&#x2003;&#x2003;(8-268)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0109" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>yL</i>=palette_transpose_flag?<i>y*n</i>SubWidth: <i>y*n</i>SubHeight&#x2003;&#x2003;(8-269)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0108" list-style="none">    <li id="ul0108-0001" num="0000">    <ul id="ul0109" list-style="none">        <li id="ul0109-0001" num="0249">The variable bIsEscapeSample is derived as follows:        <ul id="ul0110" list-style="none">            <li id="ul0110-0001" num="0250">If PaletteIndexMap[xCb+xL][yCb+yL] is equal to MaxPaletteIndex and palette_escape_val_present_flag is equal to 1, bIsEscapeSample is set equal to 1.</li>            <li id="ul0110-0002" num="0251">Otherwise, bIsEscapeSample is set equal to 0.</li>        </ul>        </li>        <li id="ul0109-0002" num="0252">If bIsEscapeSample is equal to 0, the following applies:</li>        <li id="ul0109-0003" num="0253">If plt_ibc_flag is 1, the following applies:</li>    </ul>    </li></ul></p><p id="p-0110" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>recSamples[<i>x</i>][<i>y</i>]=PaletteIndexMap[<i>xCb+xL</i>][<i>yCb+yL</i>]==0?predSamples[<i>x</i>][<i>y</i>]:<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0111" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>CurrentPaletteEntries[<i>cIdx</i>][PaletteIndexMap[<i>xCb+xL</i>][<i>yCb+yL</i>]&#x2212;1]<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0111" list-style="none">    <li id="ul0111-0001" num="0000">    <ul id="ul0112" list-style="none">        <li id="ul0112-0001" num="0254">Otherwise, the following applies:</li>    </ul>    </li></ul></p><p id="p-0112" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>recSamples[<i>x</i>][<i>y</i>]=CurrentPaletteEntries[<i>cIdx</i>][PaletteIndexMap[<i>xCb+xL</i>][<i>yCb+yL</i>]]&#x2003;&#x2003; (8-270)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0113" num="0255">It is a requirement of bitstream conformance that the value of PredictorPaletteSize[startComp] shall be in the range of 0 to PaletteMaxPredictorSize, inclusive.</p><heading id="h-0027" level="2">8.6.2.2 Derivation Process for IBC Luma Block Vector Prediction</heading><p id="p-0114" num="0256">This process is only invoked when CuPredMode[0][xCb][yCb] is equal to MODE_IBC or pit ibc flap is 1, where (xCb, yCb) specify the top-left sample of the current luma coding block relative to the top-left luma sample of the current picture.</p><p id="p-0115" num="0000">. . .</p><heading id="h-0028" level="2">8.8.3.5 Derivation Process of Boundary Filtering Strength</heading><p id="p-0116" num="0257">Inputs to this process are:<ul id="ul0113" list-style="none">    <li id="ul0113-0001" num="0000">    <ul id="ul0114" list-style="none">        <li id="ul0114-0001" num="0258">a picture sample array recPicture,</li>        <li id="ul0114-0002" num="0259">a location (xCb, yCb) specifying the top-left sample of the current coding block relative to the top-left sample of the current picture,</li>        <li id="ul0114-0003" num="0260">a variable nCbW specifying the width of the current coding block,</li>        <li id="ul0114-0004" num="0261">a variable nCbH specifying the height of the current coding block,</li>        <li id="ul0114-0005" num="0262">a variable edgeType specifying whether a vertical (EDGE_VER) or a horizontal</li>    </ul>    </li></ul></p><p id="p-0117" num="0263">(EDGE_HOR) edge is filtered,<ul id="ul0115" list-style="none">    <li id="ul0115-0001" num="0000">    <ul id="ul0116" list-style="none">        <li id="ul0116-0001" num="0264">a variable cIdx specifying the colour component of the current coding block,</li>        <li id="ul0116-0002" num="0265">a two-dimensional (nCbW)&#xd7;(nCbH) array edgeFlags.</li>    </ul>    </li></ul></p><p id="p-0118" num="0266">Output of this process is a two-dimensional (nCbW)x(nCbH) array bS specifying the boundary filtering strength.</p><p id="p-0119" num="0000">. . .</p><p id="p-0120" num="0267">For xD<sub>i </sub>with i=0 . . . xN and yD<sub>j </sub>with j=0 . . . yN, the following applies:<ul id="ul0117" list-style="none">    <li id="ul0117-0001" num="0000">    <ul id="ul0118" list-style="none">        <li id="ul0118-0001" num="0268">If edgeFlags[xD<sub>i</sub>][yD<sub>j</sub>] is equal to 0, the variable bS[xD<sub>i</sub>][yD<sub>j</sub>] is set equal to 0.</li>        <li id="ul0118-0002" num="0269">Otherwise, the following applies:</li>        <li id="ul0118-0003" num="0270">. . .        <ul id="ul0119" list-style="none">            <li id="ul0119-0001" num="0271">The variable bS[xD<sub>i</sub>][yD<sub>j</sub>] is derived as follows:            <ul id="ul0120" list-style="none">                <li id="ul0120-0001" num="0272">. . .</li>                <li id="ul0120-0002" num="0273">Otherwise, if cIdx is equal to 0 and one or more of the following conditions are true, bS[xD<sub>i</sub>][yD<sub>j</sub>] is set equal to 1:                <ul id="ul0121" list-style="none">                    <li id="ul0121-0001" num="0274">The coding subblock containing the sample p<sub>0 </sub>and the coding subblock containing the sample q<sub>0 </sub>are both coded in IBC prediction mode or their plt ibc flap are 1, and the absolute difference between the horizontal or vertical component of the block vectors used in the prediction of the two coding subblocks is greater than or equal to 8 in units of 1/16 luma samples.</li>                    <li id="ul0121-0002" num="0275">For the prediction of the coding subblock containing the sample p<sub>0 </sub>different reference pictures or a different number of motion vectors are used than for the prediction of the coding subblock containing the sample q<sub>0</sub>.</li>                    <li id="ul0121-0003" num="0000">&#x2003;NOTE 1&#x2014;The determination of whether the reference pictures used for the two coding sublocks are the same or different is based only on which pictures are referenced, without regard to whether a prediction is formed using an index into reference picture list 0 or an index into reference picture list 1, and also without regard to whether the index position within a reference picture list is different.</li>                    <li id="ul0121-0004" num="0000">&#x2003;NOTE 2&#x2014;The number of motion vectors that are used for the prediction of a coding subblock with top-left sample covering (xSb, ySb), is equal to PredFlagL0[xSb][ySb]+PredFlagL1[xSb][ySb].</li>                </ul>                </li>            </ul>            </li>            <li id="ul0119-0002" num="0276">. . .            <ul id="ul0122" list-style="none">                <li id="ul0122-0001" num="0277">Otherwise, the variable bS[xD<sub>i</sub>][yD<sub>j</sub>] is set equal to 0.</li>            </ul>            </li>        </ul>        </li>    </ul>    </li></ul></p><heading id="h-0029" level="2">6.4.4 Derivation Process for Neighbouring Block Availability</heading><p id="p-0121" num="0278">Inputs to this process are:<ul id="ul0123" list-style="none">    <li id="ul0123-0001" num="0000">    <ul id="ul0124" list-style="none">        <li id="ul0124-0001" num="0279">the luma location (xCurr, yCurr) of the top-left sample of the current block relative to the top-left luma sample of the current picture,</li>        <li id="ul0124-0002" num="0280">the luma location (xNbY, yNbY) covered by a neighbouring block relative to the top-left luma sample of the current picture,</li>        <li id="ul0124-0003" num="0281">the variable checkPredModeY specifying whether availability depends on the prediction mode.</li>        <li id="ul0124-0004" num="0282">the variable cIdx specifying the colour component of the current block.</li>    </ul>    </li></ul></p><p id="p-0122" num="0283">Output of this process is the availability of the neighbouring block covering the location (xNbY, yNbY), denoted as availableN.</p><p id="p-0123" num="0000">. . .</p><p id="p-0124" num="0284">When all of the following conditions are true, availableN is set equal to FALSE.<ul id="ul0125" list-style="none">    <li id="ul0125-0001" num="0000">    <ul id="ul0126" list-style="none">        <li id="ul0126-0001" num="0285">checkPredModeY is equal to TRUE.</li>        <li id="ul0126-0002" num="0286">availableN is set equal to TRUE. <img id="CUSTOM-CHARACTER-00362" he="2.79mm" wi="26.84mm" file="US20230007261A1-20230105-P00362.TIF" alt="custom-character" img-content="character" img-format="tif"/><img id="CUSTOM-CHARACTER-00363" he="2.79mm" wi="21.84mm" file="US20230007261A1-20230105-P00363.TIF" alt="custom-character" img-content="character" img-format="tif"/><img id="CUSTOM-CHARACTER-00364" he="2.79mm" wi="13.38mm" file="US20230007261A1-20230105-P00364.TIF" alt="custom-character" img-content="character" img-format="tif"/><img id="CUSTOM-CHARACTER-00365" he="2.79mm" wi="18.03mm" file="US20230007261A1-20230105-P00365.TIF" alt="custom-character" img-content="character" img-format="tif"/>        <ul id="ul0127" list-style="none">            <li id="ul0127-0001" num="0287">All of the following conditions are false            <ul id="ul0128" list-style="none">                <li id="ul0128-0001" num="0288">CuPredMode[0][xNbY][yNbY] is IBC, CuPredMode[0][xCurr][yCurr] is MODE PLT, and plt ibc flag[xCurr][yCurr] is 1</li>                <li id="ul0128-0002" num="0289">CuPredMode[0][xNbY][yNbY] is MODE_PLT, plt_ibc_flag[xNbY][yNbY] is 1 and CuPredMode[0][xCurr][yCurr] is PLT</li>                <li id="ul0128-0003" num="0290">CuPredMode[0][xNbY][yNbY] is equal to CuPredMode[0][xCurr][yCurr]</li>            </ul>            </li>        </ul>        </li>    </ul>    </li></ul></p><heading id="h-0030" level="1">Embodiment 2</heading><heading id="h-0031" level="2">7.3.8.5 Coding Unit Syntax</heading><p id="p-0125" num="0291"></p><p id="p-0126" num="0000"><tables id="TABLE-US-00014" num="00014"><table frame="none" colsep="0" rowsep="0" pgwide="1"><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="231pt" align="left"/><colspec colname="2" colwidth="49pt" align="left"/><thead><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row><row><entry>coding_unit( x0, y0, cbWidth, cbHeight, cqtDepth, treeType, modeTyp</entry><entry/></row><row><entry>e ) {</entry><entry>Descriptor</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></thead><tbody valign="top"><row><entry/></row></tbody></tgroup><tgroup align="left" colsep="0" rowsep="0" cols="2"><colspec colname="1" colwidth="231pt" align="left"/><colspec colname="2" colwidth="49pt" align="center"/><tbody valign="top"><row><entry>&#x2003;chType = treeType = = DUAL_TREE_CHROMA? 1 : 0</entry><entry/></row><row><entry>&#x2003;if( slice_type != I &#x2225; sps_ibc_enabled_flag &#x2225;</entry><entry/></row><row><entry>sps_palette_enabled_flag) {</entry><entry/></row><row><entry>&#x2003;...</entry><entry/></row><row><entry>&#x2003;&#x2003;if( ( ( ( slice_type = = I &#x2225; ( cbWidth = = 4 &#x26;&#x26; cbHeight = = 4 ) &#x2225;</entry><entry/></row><row><entry>sps_ibc_enabled_flag ) &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;CuPredMode[ x0 ][ y0 ] = = MODE_INTRA ) &#x2225;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;( slice_type != I &#x26;&#x26; !( cbWidth = = 4 &#x26;&#x26; cbHeight = = 4 ) &#x26;&#x26;</entry><entry/></row><row><entry>!sps_ibc_enabled_flag</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x26;&#x26; CuPredMode[ x0 ][ y0 ] != MODE_INTRA ) ) &#x26;&#x26;</entry><entry/></row><row><entry>sps_palette_enabled_flag &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;cbWidth &#x3c;= 64 &#x26;&#x26; cbHeight &#x3c;= 64 &#x26;&#x26; &#x26;&#x26;</entry><entry/></row><row><entry>cu_skip_flag[ x0 ][ y0 ] = = 0 &#x26;&#x26;</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;modeType != MODE_INTER )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;pred_mode_plt_flag</entry><entry>ae(v)</entry></row><row><entry>&#x2003;}</entry><entry/></row><row><entry>&#x2003;if( CuPredMode[ chType ][ x0 ][ y0 ] = = MODE_INTRA &#x2225;</entry><entry/></row><row><entry>&#x2003;&#x2003;CuPredMode[ chType ][ x0 ][ y0 ] = = MODE_PLT ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;if( treeType = = SINGLE_TREE &#x2225; treeType = =</entry><entry/></row><row><entry>DUAL_TREE_LUMA ) {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;if( pred_mode_plt_flag ) {</entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00366" he="2.46mm" wi="42.33mm" file="US20230007261A1-20230105-P00366.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00367" he="2.46mm" wi="16.93mm" file="US20230007261A1-20230105-P00367.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00368" he="2.46mm" wi="5.67mm" file="US20230007261A1-20230105-P00368.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry></row><row><entry><img id="CUSTOM-CHARACTER-00369" he="2.46mm" wi="21.17mm" file="US20230007261A1-20230105-P00369.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry/></row><row><entry><img id="CUSTOM-CHARACTER-00370" he="2.46mm" wi="25.06mm" file="US20230007261A1-20230105-P00370.TIF" alt="custom-character" img-content="character" img-format="tif"/> </entry><entry><img id="CUSTOM-CHARACTER-00371" he="2.46mm" wi="5.67mm" file="US20230007261A1-20230105-P00371.TIF" alt="custom-character" img-content="character" img-format="tif"/>  </entry></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;if( treeType = = DUAL_TREE_LUMA )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;palette_coding( x0, y0, cbWidth, cbHeight, 0, 1 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;else /* SINGLE_TREE */</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;&#x2003;palette_coding( x0, y0, cbWidth, cbHeight, 0, 3 )</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;} else {</entry><entry/></row><row><entry>&#x2003;&#x2003;&#x2003;...</entry><entry/></row><row><entry>&#x2003;&#x2003;}</entry><entry/></row><row><entry>&#x2003;...</entry><entry/></row><row><entry>}</entry></row><row><entry namest="1" nameend="2" align="center" rowsep="1"/></row></tbody></tgroup></table></tables><br/>plt_ibc_flag specifies the use of palette mode in the current coding unit. plt_ibc_flag equal to 1 indicates that compound palette mode is applied in the current coding unit. plt_ibc_flag equal to 0 indicates that compound palette mode is not applied in the current coding unit. When plt_ibc_flag is not present, it is inferred to be equal to 0.<br/>palette_escape_val_present_flag equal to 1 specifies that the current coding unit contains at least one escape coded sample. escape_val_present_flag equal to 0 specifies that there are no escape coded samples in the current coding unit. When not present, the value of palette_escape_val_present_flag is inferred to be equal to 1.<br/>The variable MaxPaletteIndex specifies the maximum possible value for a palette index for the current coding unit. The value of MaxPaletteIndex is set equal to CurrentPaletteSize[startComp]&#x2212;1+palette_escape_val_present_flag+(plt_ibc_flap?1:0).</p><heading id="h-0032" level="2">8.4.5.3 Decoding Process for Palette Mode</heading><p id="p-0127" num="0292">Inputs to this process are:<ul id="ul0129" list-style="none">    <li id="ul0129-0001" num="0000">    <ul id="ul0130" list-style="none">        <li id="ul0130-0001" num="0293">a location (xCb, yCb) specifying the top-left luma sample of the current block relative to the top-left luma sample of the current picture,</li>        <li id="ul0130-0002" num="0294">a variable startComp specifies the first colour component in the palette table,</li>        <li id="ul0130-0003" num="0295">a variable cIdx specifying the colour component of the current block,</li>        <li id="ul0130-0004" num="0296">two variables nCbW and nCbH specifying the width and height of the current block, respectively.</li>    </ul>    </li></ul></p><p id="p-0128" num="0297">Output of this process is an array recSamples[x][y], with x=0 . . . nCbW&#x2212;1, y=0 . . . nCbH&#x2212;1 specifying reconstructed sample values for the block.</p><p id="p-0129" num="0298">Depending on the value of cIdx, the variables nSubWidth and nSubHeight are derived as follows:<ul id="ul0131" list-style="none">    <li id="ul0131-0001" num="0000">    <ul id="ul0132" list-style="none">        <li id="ul0132-0001" num="0299">If cIdx is equal to 0, nSubWidth is set to 1 and nSubHeight is set to 1.</li>        <li id="ul0132-0002" num="0300">Otherwise, nSubWidth is set to SubWidthC and nSubHeight is set to SubHeightC.</li>    </ul>    </li></ul></p><p id="p-0130" num="0301">If plt ibc flag is equal to 1 the following applies:<ul id="ul0133" list-style="none">    <li id="ul0133-0001" num="0000">    <ul id="ul0134" list-style="none">        <li id="ul0134-0001" num="0302">The derivation process for IBC luma motion vector prediction as specified in clause 8.6.2.2 is invoked with the luma location (xCb, yCb), the variables cbWidth and cbHeight inputs, and the output being the luma motion vector mvL.</li>        <li id="ul0134-0002" num="0303">The decoding process for ibc blocks as specified in clause 8.6.3.1 is invoked with the luma coding block location (xCb, yCb), the luma coding block width cbWidth and the luma coding block height cbHeight, the number of luma coding subblocks in horizontal direction numSbX and in vertical direction numSbY, the luma motion vectors mvL[xSbIdx][ySbIdx] with xSbIdx=0 . . . numSbX&#x2212;1, and ySbIdx=0 . . . numSbY&#x2212;1, the variable cIdx set equal to 0 as inputs, and the ibc prediction samples (predSamples) that are an (cbWidth)&#xd7;(cbHeight) array predSamplesL of prediction luma samples as outputs.</li>    </ul>    </li></ul></p><p id="p-0131" num="0304">The (nCbW&#xd7;nCbH) block of the reconstructed sample array recSamples at location (xCb, yCb) is represented by recSamples[x][y] with x=0 . . . nCTbW&#x2212;1 and y=0 . . . nCbH&#x2212;1, and the value of recSamples[x][y] for each x in the range of 0 to nCbW&#x2212;1, inclusive, and each y in the range of 0 to nCbH&#x2212;1, inclusive, is derived as follows:<ul id="ul0135" list-style="none">    <li id="ul0135-0001" num="0000">    <ul id="ul0136" list-style="none">        <li id="ul0136-0001" num="0305">The variables xL and yL are derived as follows:</li>    </ul>    </li></ul></p><p id="p-0132" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>xL</i>=palette_transpose_flag?<i>x*n</i>SubHeight:<i>x*n</i>SubWidth&#x2003;&#x2003;(8-268)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0133" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>yL</i>=palette_transpose_flag?<i>y*n</i>SubWidth:<i>y*n</i>SubHeight&#x2003;&#x2003;(8-269)<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0137" list-style="none">    <li id="ul0137-0001" num="0000">    <ul id="ul0138" list-style="none">        <li id="ul0138-0001" num="0306">The variable bIsEscapeSample is derived as follows:        <ul id="ul0139" list-style="none">            <li id="ul0139-0001" num="0307">If PaletteIndexMap[xCb+xL][yCb+yL] is equal to MaxPaletteIndex and palette_escape_val_present_flag is equal to 1, bIsEscapeSample is set equal to 1.</li>        </ul>        </li>        <li id="ul0138-0002" num="0308">Otherwise, bIsEscapeSample is set equal to 0.</li>        <li id="ul0138-0003" num="0309">If bIsEscapeSample is equal to 0, the following applies:</li>        <li id="ul0138-0004" num="0310">If plt ibc flag is 1        <ul id="ul0140" list-style="none">            <li id="ul0140-0001" num="0311">1. If PaletteIndexMap[xCb+xL][yCb+yL]==0</li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0134" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>recSamples[<i>x</i>][<i>y</i>]=predSamples[<i>x</i>][<i>y</i>]<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0141" list-style="none">    <li id="ul0141-0001" num="0000">    <ul id="ul0142" list-style="none">        <li id="ul0142-0001" num="0000">        <ul id="ul0143" list-style="none">            <li id="ul0143-0001" num="0312">2. Otherwise, if PaletteIndexMap[xCb+xL][yCb+yL]&#x3e;0</li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0135" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>recSamples[<i>x</i>][<i>y</i>]=CurrentPaletteEntries[<i>cIdx</i>][PaletteIndexMap[<i>xCb+xL</i>][<i>yCb+yL</i>]&#x2212;1]<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0144" list-style="none">    <li id="ul0144-0001" num="0000">    <ul id="ul0145" list-style="none">        <li id="ul0145-0001" num="0313">Otherwise, if pit ibc flag is 0</li>    </ul>    </li></ul></p><p id="p-0136" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>recSamples[<i>x</i>][<i>y</i>]=CurrentPaletteEntries[<i>cIdx</i>][PaletteIndexMap[<i>xCb+xL</i>][<i>yCb+yL</i>]]&#x2003;&#x2003; (8-270)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0137" num="0000">. . .</p><p id="p-0138" num="0314">It is a requirement of bitstream conformance that the value of PredictorPaletteSize[startComp] shall be in the range of 0 to PaletteMaxPredictorSize, inclusive.</p><heading id="h-0033" level="2">8.6.2.2 Derivation Process for IBC Luma Block Vector Prediction</heading><p id="p-0139" num="0315">This process is only invoked when CuPredMode[0][xCb][yCb] is equal to MODE_IBC or pit ibc flag is 1, where (xCb, yCb) specify the top-left sample of the current luma coding block relative to the top-left luma sample of the current picture.</p><p id="p-0140" num="0000">. . .</p><heading id="h-0034" level="2">8.8.3.5 Derivation Process of Boundary Filtering Strength</heading><p id="p-0141" num="0316">Inputs to this process are:<ul id="ul0146" list-style="none">    <li id="ul0146-0001" num="0000">    <ul id="ul0147" list-style="none">        <li id="ul0147-0001" num="0317">a picture sample array recPicture,</li>        <li id="ul0147-0002" num="0318">a location (xCb, yCb) specifying the top-left sample of the current coding block relative to the top-left sample of the current picture,</li>        <li id="ul0147-0003" num="0319">a variable nCbW specifying the width of the current coding block,</li>        <li id="ul0147-0004" num="0320">a variable nCbH specifying the height of the current coding block,</li>        <li id="ul0147-0005" num="0321">a variable edgeType specifying whether a vertical (EDGE_VER) or a horizontal (EDGE_HOR) edge is filtered,</li>        <li id="ul0147-0006" num="0322">a variable cIdx specifying the colour component of the current coding block,</li>        <li id="ul0147-0007" num="0323">a two-dimensional (nCbW)x(nCbH) array edgeFlags.</li>    </ul>    </li></ul></p><p id="p-0142" num="0324">Output of this process is a two-dimensional (nCbW)x(nCbH) array bS specifying the boundary filtering strength.</p><p id="p-0143" num="0000">. . .</p><p id="p-0144" num="0325">For xD<sub>i </sub>with i=0 . . . xN and yD<sub>j </sub>with j=0 . . . yN, the following applies:<ul id="ul0148" list-style="none">    <li id="ul0148-0001" num="0000">    <ul id="ul0149" list-style="none">        <li id="ul0149-0001" num="0326">If edgeFlags[xD<sub>i</sub>][yD<sub>j</sub>] is equal to 0, the variable bS[xD<sub>i</sub>][yD<sub>j</sub>] is set equal to 0.</li>        <li id="ul0149-0002" num="0327">Otherwise, the following applies:        <ul id="ul0150" list-style="none">            <li id="ul0150-0001" num="0328">. . .</li>            <li id="ul0150-0002" num="0329">The variable bS[xD<sub>i</sub>][yD<sub>j</sub>] is derived as follows:</li>            <li id="ul0150-0003" num="0330">. . .            <ul id="ul0151" list-style="none">                <li id="ul0151-0001" num="0331">Otherwise, if cIdx is equal to 0 and one or more of the following conditions are true, bS[xD<sub>i</sub>][yD<sub>j</sub>] is set equal to 1:                <ul id="ul0152" list-style="none">                    <li id="ul0152-0001" num="0332">The coding subblock containing the sample p<sub>0 </sub>and the coding subblock containing the sample q<sub>0 </sub>are both coded in IBC prediction mode or their plt_ibc_flag are 1, and the absolute difference between the horizontal or vertical component of the block vectors used in the prediction of the two coding subblocks is greater than or equal to 8 in units of 1/16 luma samples.</li>                    <li id="ul0152-0002" num="0333">For the prediction of the coding subblock containing the sample p<sub>0 </sub>different reference pictures or a different number of motion vectors are used than for the prediction of the coding subblock containing the sample q<sub>0</sub>.</li>                    <li id="ul0152-0003" num="0000">&#x2003;NOTE 1&#x2014;The determination of whether the reference pictures used for the two coding sublocks are the same or different is based only on which pictures are referenced, without regard to whether a prediction is formed using an index into reference picture list 0 or an index into reference picture list 1, and also without regard to whether the index position within a reference picture list is different.</li>                    <li id="ul0152-0004" num="0000">&#x2003;NOTE 2&#x2014;The number of motion vectors that are used for the prediction of a coding subblock with top-left sample covering (xSb, ySb), is equal to PredFlagL0[xSb][ySb]+PredFlagL1[xSb][ySb].</li>                </ul>                </li>            </ul>            </li>            <li id="ul0150-0004" num="0334">. . .            <ul id="ul0153" list-style="none">                <li id="ul0153-0001" num="0335">Otherwise, the variable bS[xD<sub>i</sub>][yD<sub>j</sub>] is set equal to 0.</li>            </ul>            </li>        </ul>        </li>    </ul>    </li></ul></p><heading id="h-0035" level="2">6.4.4 Derivation Process for Neighbouring Block Availability</heading><p id="p-0145" num="0336">Inputs to this process are:<ul id="ul0154" list-style="none">    <li id="ul0154-0001" num="0000">    <ul id="ul0155" list-style="none">        <li id="ul0155-0001" num="0337">the luma location (xCurr, yCurr) of the top-left sample of the current block relative to the top-left luma sample of the current picture,</li>        <li id="ul0155-0002" num="0338">the luma location (xNbY, yNbY) covered by a neighbouring block relative to the top-left luma sample of the current picture,</li>        <li id="ul0155-0003" num="0339">the variable checkPredModeY specifying whether availability depends on the prediction mode.</li>        <li id="ul0155-0004" num="0340">the variable cIdx specifying the colour component of the current block.</li>    </ul>    </li></ul></p><p id="p-0146" num="0341">Output of this process is the availability of the neighbouring block covering the location (xNbY, yNbY), denoted as availableN.</p><p id="p-0147" num="0000">. . .</p><p id="p-0148" num="0342">When all of the following conditions are true, availableN is set equal to FALSE.<ul id="ul0156" list-style="none">    <li id="ul0156-0001" num="0000">    <ul id="ul0157" list-style="none">        <li id="ul0157-0001" num="0343">checkPredModeY is equal to TRUE.</li>        <li id="ul0157-0002" num="0344">availableN is set equal to TRUE. <img id="CUSTOM-CHARACTER-00372" he="2.79mm" wi="25.40mm" file="US20230007261A1-20230105-P00372.TIF" alt="custom-character" img-content="character" img-format="tif"/><img id="CUSTOM-CHARACTER-00373" he="2.79mm" wi="20.15mm" file="US20230007261A1-20230105-P00373.TIF" alt="custom-character" img-content="character" img-format="tif"/><img id="CUSTOM-CHARACTER-00374" he="2.79mm" wi="15.92mm" file="US20230007261A1-20230105-P00374.TIF" alt="custom-character" img-content="character" img-format="tif"/><img id="CUSTOM-CHARACTER-00375" he="2.79mm" wi="18.03mm" file="US20230007261A1-20230105-P00375.TIF" alt="custom-character" img-content="character" img-format="tif"/></li>        <li id="ul0157-0003" num="0345">All of the following conditions are false        <ul id="ul0158" list-style="none">            <li id="ul0158-0001" num="0346">CuPredMode[0][xNbY][yNbY] is IBC, CuPredMode[0][xCurr][yCurr] is MODE_PLT, and plt_ibc_flag[xCurr][yCurr] is 1</li>            <li id="ul0158-0002" num="0347">CuPredMode[0][xNbY][yNbY] is MODE PLT, plt ibc flag[xNbY][yNbY] is 1 and CuPredMode[0][xCurr][yCurr] is PLT</li>            <li id="ul0158-0003" num="0348">CuPredMode[0][xNbY][yNbY] is equal to CuPredMode[0][xCurr][yCurr]</li>        </ul>        </li>    </ul>    </li></ul></p><heading id="h-0036" level="1">7. Example Implementations of the Disclosed Technology</heading><p id="p-0149" num="0349"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a block diagram of a video processing apparatus <b>600</b>. The apparatus <b>600</b> may be used to implement one or more of the methods described herein. The apparatus <b>600</b> may be embodied in a smartphone, tablet, computer, Internet of Things (IoT) receiver, and so on. The apparatus <b>600</b> may include one or more processors <b>602</b>, one or more memories <b>604</b> and video processing hardware <b>606</b>. The processor(s) <b>602</b> may be configured to implement one or more methods described in the present document. The memory (memories) <b>604</b> may be used for storing data and code used for implementing the methods and techniques described herein. The video processing hardware <b>606</b> may be used to implement, in hardware circuitry, some techniques described in the present document, and may be partly or completely be a part of the processors <b>602</b> (e.g., graphics processor core GPU or other signal processing circuitry).</p><p id="p-0150" num="0350">In the present document, the term &#x201c;video processing&#x201d; may refer to video encoding, video decoding, video compression or video decompression. For example, video compression algorithms may be applied during conversion from pixel representation of a video to a corresponding bitstream representation or vice versa. The bitstream representation of a current video block may, for example, correspond to bits that are either co-located or spread in different places within the bitstream, as is defined by the syntax. For example, a macroblock may be encoded in terms of transformed and coded error residual values and also using bits in headers and other fields in the bitstream.</p><p id="p-0151" num="0351">It will be appreciated that the disclosed methods and techniques will benefit video encoder and/or decoder embodiments incorporated within video processing devices such as smartphones, laptops, desktops, and similar devices by allowing the use of the techniques disclosed in the present document.</p><p id="p-0152" num="0352"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a flowchart for an example method <b>700</b> of video processing. The method <b>700</b> includes, at <b>710</b>, determining that palette mode is to be used for processing a first portion of a video block and intra block copy (IBC) mode is to be used for processing a second portion of the video block wherein, in the palette mode, samples of the first portion of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, samples of the second portion of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks. The method includes, at <b>720</b>, performing further processing of the first portion of the video block using the palette mode and the second portion of the video using the IBC mode, wherein indications of the first portion of the video block processed using the palette mode and indications of the second portion of the video block processed using the IBC mode are included in a palette index identifying the first portion of the video block and the second portion of the video block.</p><p id="p-0153" num="0353">Some embodiments may be described using the following clause-based format.</p><p id="p-0154" num="0354">1. A method for processing video, comprising:</p><p id="p-0155" num="0355">determining that palette mode is to be used for processing a first portion of a video block and intra block copy (IBC) mode is to be used for processing a second portion of the video block wherein, in the palette mode, samples of the first portion of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, samples of the second portion of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks; and</p><p id="p-0156" num="0356">performing further processing of the first portion of the video block using the palette mode and the second portion of the video using the IBC mode, wherein indications of the first portion of the video block processed using the palette mode and indications of the second portion of the video block processed using the IBC mode are included in a palette index identifying the first portion of the video block and the second portion of the video block.</p><p id="p-0157" num="0357">2. The method of clause 1, wherein processing the first portion of the video block includes copying collocated samples from the second portion of the video block.</p><p id="p-0158" num="0358">3. The method of clause 2, wherein copying collocated samples from the second portion of the video block is in accordance with the palette index included in an index map.</p><p id="p-0159" num="0359">4. The method of any one or more of clauses 2-3, wherein the palette index is 0.</p><p id="p-0160" num="0360">5. The method of any one or more of clauses 2-3, wherein the palette index is equal to one less than a total number of palette entries.</p><p id="p-0161" num="0361">6. The method of any one or more of clauses 2-3, wherein the palette index is equal to an integer value based on one or more of: a dimension of the video block, a quantization parameter of the video block, a quantization parameter of the video block, a color format of the video block, a coding tree structure of the video block, a picture/group/slice type of the video block, or a parameter included in a bitstream representation associated with conversion of the video block.</p><p id="p-0162" num="0362">7. The method of any one or more of clauses 2-3, wherein the palette index identifying the first portion of the video block and the second portion of the video block is signaled as a flag denoted plt_combined_ibc_sample_flag of the video block.</p><p id="p-0163" num="0363">8. The method of clause 7, wherein a value of plt_combined_ibc_sample_flag equals one.</p><p id="p-0164" num="0364">9. The method of clause 7, wherein plt_combined_ibc_sample_flag of the video block is based on values of plt_combined_ibc_sample_flag flags of the neighboring samples of the video block.</p><p id="p-0165" num="0365">10. The method of clause 7, wherein plt_combined_ibc_sample_flag of the video block is inferred to be zero when the neighboring samples of the video block are non-existent.</p><p id="p-0166" num="0366">11. The method of clause 9, wherein the neighboring samples of the video block include a spatially left neighbor of the video block and a spatially above member of the video block.</p><p id="p-0167" num="0367">12. The method of clause 11, wherein plt_combined_ibc_sample_flag of the video block is one, and wherein the spatially left neighbor of the video block and the spatially above member of the video block both have plt_combined_ibc_sample_flag flags of one.</p><p id="p-0168" num="0368">13. The method of clause 1, wherein the second portion of the video block processed using the IBC mode is based at least in part on a motion information derived from (i) an IBC merge mode or (ii) an IBC advanced motion vector prediction (AMVP) mode, wherein, in the IBC merge mode, an index pointing to an entry in an IBC merge candidates list is parsed from a bitstream representation associated with conversion of the video block, and wherein, in the IBC AMVP mode, an index pointing to an IBC AMVP list is parsed from the bitstream representation associated with conversion of the video block.</p><p id="p-0169" num="0369">14. The method of clause 13, wherein a height of the video block and/or a width of the video block exceed a threshold value.</p><p id="p-0170" num="0370">15. The method of clause 14, wherein the threshold value is based at least on one or more of: a dimension of the video block, a quantization parameter of the video block, a quantization parameter of the video block, a color format of the video block, a coding tree structure of the video block, a picture/group/slice type of the video block, or a parameter included in the bitstream representation associated with conversion of the video block.</p><p id="p-0171" num="0371">16. The method of clause 13, wherein the second portion of the video block processed using the IBC mode is based at least in part on the motion information derived always from the IBC merge mode.</p><p id="p-0172" num="0372">17. The method of clause 13, wherein the second portion of the video block processed using the IBC mode is based at least in part on the motion information derived always from the IBC AMVP mode.</p><p id="p-0173" num="0373">18. The method of clause 17, wherein in the IBC AMVP mode, the entry in the IBC merge candidates list corresponds to a first entry in the IBC merge candidates list.</p><p id="p-0174" num="0374">19. The method of clause 13, further comprising:</p><p id="p-0175" num="0375">in response to determining that a dual coding tree structure of the video block is enabled, wherein the motion information in the IBC mode includes chroma motion vectors or luma motion vectors, wherein, based on a chroma format of the second portion of the video block, the chroma motion vectors are derived by any one or more of: (a) scaling collocated luma motion vectors, (b) scaling neighboring motion vectors of collocated luma blocks, or (c) averaging, for each chroma sub-block, available luma motion vectors.</p><p id="p-0176" num="0376">20. The method of any one or more of clauses 2-3, wherein the indications of the second portion of the video block processed using the IBC mode include an indication of copying collocated samples from the second portion of the video block, wherein the indication of copying collocated samples from the second portion of the video block is based on one or more of: a dimension of the video block, a quantization parameter of the video block, a quantization parameter of the video block, a color format of the video block, a coding tree structure of the video block, or a picture/group/slice type of the video block.</p><p id="p-0177" num="0377">21. The method of any one or more of clauses 2-3, wherein the first portion of the video block includes escape pixels, wherein, for the escape pixels, a residue obtained from computing a difference between original samples of the first block and of the collocated samples from the second portion of the video block is signaled in a bitstream representation associated with conversion of the video block.</p><p id="p-0178" num="0378">22. The method of clause 21, wherein the residue is quantized according to a quantization parameter, and wherein the quantized residue is signaled in the bitstream representation associated with conversion of the video block.</p><p id="p-0179" num="0379">23. The method of clause 22, wherein the quantized residue includes a positive or a negative sign, wherein the positive or the negative sign is signaled in the bitstream representation associated with conversion of the video block.</p><p id="p-0180" num="0380">24. The method of any one or more of clauses 1-23, wherein information identifying an associated method is included in a video parameter set (VPS), a sequence parameter set (SPS), a picture parameter set (PPS), an adaptation parameter set (APS), a picture header, a tile group header, a tile header, a slice header, or a largest coding unit (LCU) row.</p><p id="p-0181" num="0381">25. The method of clause 24, wherein the information defined for the video block is based on one or more of: a dimension of the video block, a quantization parameter of the video block, a quantization parameter of the video block, a color format of the video block, a coding tree structure of the video block, or a picture/group/slice type of the video block, values of palette flags indicating the palette mode of one or more neighboring samples of the video block, and values of intra block copy flags indicating the IBC mode of one or more neighboring samples of the video block.</p><p id="p-0182" num="0382">26. The method of clause 25, wherein values of the palette flags correspond to a Boolean true or false, indicating that the palette mode is enabled or disabled.</p><p id="p-0183" num="0383">27. The method of clause 25, wherein values of the intra block copy flags correspond to a Boolean true or false, indicating that the IBC mode is enabled or disabled.</p><p id="p-0184" num="0384">28. The method of any one or more of clauses 24-27, wherein the values of the palette flags and/or the values of the intra block copy flags are signaled in the bitstream representation associated with conversion of the video block.</p><p id="p-0185" num="0385">29. The method of any one or more of clauses 24-27, wherein the values of the palette flags and/or the values of the intra block copy flags are computed or inferred.</p><p id="p-0186" num="0386">30. The method of any one or more of clauses 24-29, wherein the information defined for the video block includes a prediction mode, wherein the prediction mode is MODE_IBC, MODE_INTRA, or MODE_INTER, respectively corresponding to the IBC mode, an intra mode, or an inter mode.</p><p id="p-0187" num="0387">31. The method of one or more of clauses 1-23, wherein the first portion of the video block and/or the second portion of the video block correspond to a sub-block further comprising:</p><p id="p-0188" num="0388">selectively enabling or disabling the palette mode and/or the IBC mode to be used on the sub-block.</p><p id="p-0189" num="0389">32. The method of clause 31, wherein the sub-block is a 4&#xd7;4 luma block or a 2&#xd7;2 chroma block.</p><p id="p-0190" num="0390">33. The method of clause 31, wherein the intra block copy (IBC) mode is to be used prior to the palette mode.</p><p id="p-0191" num="0391">34. The method of clause 31, wherein the palette mode is used on a current chroma sub-block if a collocated luma block of the current chroma sub-block is not coded in IBC mode</p><p id="p-0192" num="0392">35. The method of clause 31, wherein the palette mode is used on a current chroma sub-block if an IBC prediction block of the current chroma sub-block is not reconstructed.</p><p id="p-0193" num="0393">36. The method of clause 31, wherein the selectively enabling or disabling is based, at least in part, on a prediction mode of a collocated luma block of the sub-block.</p><p id="p-0194" num="0394">37. The method of clause 31, wherein the selectively enabling of the IBC mode for the sub-block includes copying a collocated sample in IBC prediction and the selectively disabling of the IBC mode for the sub-block includes reconstructing the sub-block using palette colors.</p><p id="p-0195" num="0395">38. The method of clause 31, wherein a size of the sub-block is based on one or more of the following: a dimension of the video block, a quantization parameter of the video block, the palette index, one or more intra block copy (IBC) flags of neighboring blocks of the video block, a color format of the video block, a coding tree structure of the sub-block, a slice/group/picture type of the sub-block.</p><p id="p-0196" num="0396">39. A method for processing video, comprising:</p><p id="p-0197" num="0397">determining, for samples of a video block, that palette mode and intra block copy (IBC) mode are to be used for processing the samples, wherein, in the palette mode, the samples of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, the samples of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks, wherein the samples of the video bock are associated with an index.</p><p id="p-0198" num="0398">40. A video decoding apparatus comprising a processor configured to implement a method recited in one or more of clauses 1 to 39.</p><p id="p-0199" num="0399">41. A video encoding apparatus comprising a processor configured to implement a method recited in one or more of clauses 1 to 39.</p><p id="p-0200" num="0400">42. A computer program product having computer code stored thereon, the code, when executed by a processor, causes the processor to implement a method recited in any of clauses 1 to 39.</p><p id="p-0201" num="0401">43. A method, apparatus or system described in the present document.</p><p id="p-0202" num="0402"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a block diagram showing an example video processing system <b>1000</b> in which various techniques disclosed herein may be implemented. Various implementations may include some or all of the components of the system <b>1000</b>. The system <b>1000</b> may include input <b>1002</b> for receiving video content. The video content may be received in a raw or uncompressed format, e.g., 8 or 10 bit multi-component pixel values, or may be in a compressed or encoded format. The input <b>1002</b> may represent a network interface, a peripheral bus interface, or a storage interface. Examples of network interface include wired interfaces such as Ethernet, passive optical network (PON), etc. and wireless interfaces such as Wi-Fi or cellular interfaces.</p><p id="p-0203" num="0403">The system <b>1000</b> may include a coding component <b>1004</b> that may implement the various coding or encoding methods described in the present document. The coding component <b>1004</b> may reduce the average bitrate of video from the input <b>1002</b> to the output of the coding component <b>1004</b> to produce a coded representation of the video. The coding techniques are therefore sometimes called video compression or video transcoding techniques. The output of the coding component <b>1004</b> may be either stored, or transmitted via a communication connected, as represented by the component <b>1006</b>. The stored or communicated bitstream (or coded) representation of the video received at the input <b>1002</b> may be used by the component <b>1008</b> for generating pixel values or displayable video that is sent to a display interface <b>1010</b>. The process of generating user-viewable video from the bitstream representation is sometimes called video decompression. Furthermore, while certain video processing operations are referred to as &#x201c;coding&#x201d; operations or tools, it will be appreciated that the coding tools or operations are used at an encoder and corresponding decoding tools or operations that reverse the results of the coding will be performed by a decoder.</p><p id="p-0204" num="0404">Examples of a peripheral bus interface or a display interface may include universal serial bus (USB) or high definition multimedia interface (HDMI) or Displayport, and so on. Examples of storage interfaces include SATA (serial advanced technology attachment), PCI, IDE interface, and the like. The techniques described in the present document may be embodied in various electronic devices such as mobile phones, laptops, smartphones or other devices that are capable of performing digital data processing and/or video display.</p><p id="p-0205" num="0405"><figref idref="DRAWINGS">FIG. <b>11</b></figref> is a flowchart of an example method of visual data processing. At step <b>1102</b>, the process determines, for a conversion between a video block of visual media data and a bitstream representation of the video block, that palette mode is to be used for processing a first portion of the video block and intra block copy (IBC) mode is to be used for processing a second portion of the video block wherein, in the palette mode, samples of the first portion of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, samples of the second portion of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks. At step <b>1104</b>, the process performs, during the conversion, further processing of the first portion of the video block using the palette mode and further processing of the second portion of the video block based on a prediction block derived using the IBC mode, wherein indications of the first portion of the video block processed using the palette mode and indications of the second portion of the video block processed using the IBC mode are included in a palette index map that identifies the first portion of the video block and the second portion of the video block.</p><p id="p-0206" num="0406"><figref idref="DRAWINGS">FIG. <b>12</b></figref> is a flowchart of an example method of visual data processing. At step <b>1202</b>, the process determines, for samples of a video block, that a first combined palette and intra block copy (IBC) mode are to be used for processing the samples, wherein, in the palette mode, the samples of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, the samples of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks, wherein the samples of the video bock are associated with a palette index indicative of an INDEX mode or a COPY_ABOVE mode, wherein in the INDEX mode or in the COPY_ABOVE mode, the palette index of the current block is derived by copying a previously-coded index. At step <b>1204</b>, the process performs a conversion between the video block and a bitstream representation of the video block.</p><p id="p-0207" num="0407">Some embodiments of the present disclosure are presented in clause-based format.</p><p id="p-0208" num="0408">1. A method for visual media processing, comprising:</p><p id="p-0209" num="0409">determining, for a conversion between a video block of visual media data and a bitstream representation of the video block, that palette mode is to be used for processing a first portion of the video block and intra block copy (IBC) mode is to be used for processing a second portion of the video block wherein, in the palette mode, samples of the first portion of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, samples of the second portion of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks; and</p><p id="p-0210" num="0410">performing, during the conversion, further processing of the first portion of the video block using the palette mode and further processing of the second portion of the video block based on a prediction block derived using the IBC mode, wherein indications of the first portion of the video block processed using the palette mode and indications of the second portion of the video block processed using the IBC mode are included in a palette index map that identifies the first portion of the video block and the second portion of the video block.</p><p id="p-0211" num="0411">2. The method of clause 1, wherein further processing of the second portion of the video block includes:</p><p id="p-0212" num="0412">reconstructing samples of the second portion of the video block by copying collocated samples in the prediction block derived using the IBC mode.</p><p id="p-0213" num="0413">3. The method of clause 1, wherein a palette index included in the palette index map indicates whether a sample belongs to the first portion of the video block or the second portion of the video block.</p><p id="p-0214" num="0414">4. The method of any one or more of clauses 2-3, wherein the palette index of a sample belonging to the second portion of the video block is set to 0.</p><p id="p-0215" num="0415">5. The method of any one or more of clauses 2-3, wherein an actual palette index of a sample belonging to the first portion is equal to one less than a decoded palette index.</p><p id="p-0216" num="0416">6. The method of any one or more of clauses 2-3, wherein the palette index is equal to an integer value based on one or more of: a dimension of the video block, a quantization parameter of the video block, a quantization parameter of the video block, a color format of the video block, a coding tree structure of the video block, a picture/group/slice type of the video block, or a parameter included in the bitstream representation associated with conversion of the video block.</p><p id="p-0217" num="0417">7. The method of any one or more of clauses 1 and 3, wherein the palette index identifying the first portion of the video block and the second portion of the video block is signaled as a flag denoted by plt_combined_ibc_sample_flag of the video block.</p><p id="p-0218" num="0418">8. The method of any one or more of clauses 2-3, wherein samples of the second portion of the video block are added as new entries in a palette predictor, wherein the palette predictor maintains a list of samples that make use of the palette.</p><p id="p-0219" num="0419">9. The method of any one or more of clauses 2-3, wherein samples of the second portion of the video block are used to replace existing entries in a palette predictor, wherein the palette predictor maintains a list of coded samples that make use of the palette.</p><p id="p-0220" num="0420">10. The method of any one or more of clauses 2-3, wherein samples of the second portion of the video block are added as new entries in a palette predictor, wherein the palette predictor maintains a list of samples that make use of the palette, and wherein, after addition, the list of samples in the palette predictor is reordered.</p><p id="p-0221" num="0421">11. The method of clause 7, wherein a value of plt_combined_ibc_sample_flag equals one when a sample belongs to the second portion of the video block.</p><p id="p-0222" num="0422">12. The method of clause 7, wherein plt_combined_ibc_sample_flag of the video block is based on values of plt_combined_ibc_sample_flag flags of the neighboring samples of the video block.</p><p id="p-0223" num="0423">13. The method of clause 7, wherein plt_combined_ibc_sample_flag of the video block is inferred to be zero when the neighboring samples of the video block are non-existent.</p><p id="p-0224" num="0424">14. The method of clause 12, wherein the neighboring samples of the video block include a spatially left neighbor of the video block and a spatially above neighbor of the video block.</p><p id="p-0225" num="0425">15. The method of clause 11, wherein plt combined ibc sample flag of the video block is one, and wherein the spatially left neighbor of the video block and the spatially above neighbor of the video block both have plt combined ibc sample flag flags of one.</p><p id="p-0226" num="0426">16. The method of clause 1, wherein the second portion of the video block processed using the IBC mode is based at least in part on a motion information derived from (i) an IBC merge mode or (ii) an IBC advanced motion vector prediction (AMVP) mode, wherein, in the IBC merge mode, an index pointing to an entry in an IBC merge candidates list is parsed from a bitstream representation associated with conversion of the video block, and wherein, in the IBC AMVP mode, an index pointing to an IBC AMVP list is parsed from the bitstream representation associated with the conversion of the video block.</p><p id="p-0227" num="0427">17. The method of clause 16, wherein a height of the video block and/or a width of the video block exceed a threshold value.</p><p id="p-0228" num="0428">18. The method of clause 17, wherein the threshold value is based at least on one or more of: a dimension of the video block, a quantization parameter of the video block, a quantization parameter of the video block, a color format of the video block, a coding tree structure of the video block, a picture/group/slice type of the video block, or a parameter included in the bitstream representation associated with conversion of the video block.</p><p id="p-0229" num="0429">19. The method of clause 16, wherein the second portion of the video block is processed only using the prediction block derived using the IBC merge mode.</p><p id="p-0230" num="0430">20. The method of clause 16, wherein the second portion of the video block is processed only using the prediction block derived using the IBC AMVP mode.</p><p id="p-0231" num="0431">21. The method of clause 16, wherein the second portion of the video block is processed using the prediction block derived by a motion candidate in a history-based motion vector prediction (HMVP) table.</p><p id="p-0232" num="0432">22. The method of clause 19, wherein the index of an IBC merge candidate used by the prediction block for the second portion of the video block is included as a field in the bitstream representation associated with conversion of the video block.</p><p id="p-0233" num="0433">23. The method of clause 22, wherein indexes of invalid entries in the IBC merge candidates list are excluded from being signaled in the bitstream representation.</p><p id="p-0234" num="0434">24. The method of clause 20, wherein a block vector difference between the motion information of the prediction block for the second portion of the video block and an entry in the IBC AMVP list is included as a field in the bitstream representation associated with conversion of the video block.</p><p id="p-0235" num="0435">25. The method of clause 19, wherein a first valid candidate in the IBC merge candidates list is used to derive the prediction block, wherein a valid candidate satisfies a condition that an entirety of a reference block is within an available reconstructed area.</p><p id="p-0236" num="0436">26. The method of clause 19, wherein a first valid candidate in the IBC AMVP list is used to derive the prediction block, wherein a valid candidate satisfies a condition that an entirety of a reference block is within an available reconstructed area.</p><p id="p-0237" num="0437">27. The method of clause 20, wherein in the IBC AMVP mode, further comprising:</p><p id="p-0238" num="0438">upon determining that all entries in the IBC merge candidates list is invalid, using default motion information.</p><p id="p-0239" num="0439">28. The method of clause 27, wherein the default motion information is based at least in part on a dimension of the video block or a location of the video block.</p><p id="p-0240" num="0440">29. The method of clause 27, wherein the default motion information is predefined.</p><p id="p-0241" num="0441">30. The method of clause 16, further comprising:</p><p id="p-0242" num="0442">in response to determining that a dual coding tree structure of the video block is enabled, wherein the motion information in the IBC mode includes chroma motion vectors or luma motion vectors, wherein, based on a chroma format of the second portion of the video block, the chroma motion vectors are derived by any one or more of: (a) scaling collocated luma motion vectors, (b) scaling neighboring motion vectors of collocated luma blocks, or (c) averaging, for each chroma sub-block, available luma motion vectors.</p><p id="p-0243" num="0443">31. The method of any one or more of clauses 2-30, wherein the indications of the second portion of the video block processed using the IBC mode is based on one or more of: a dimension of the video block, a quantization parameter of the video block, a quantization parameter of the video block, a color format of the video block, a coding tree structure of the video block, or a picture/group/slice type of the video block.</p><p id="p-0244" num="0444">32. The method of any one or more of clauses 2-3, wherein the first portion of the video block includes escape pixels, wherein, for the escape pixels, a residue obtained from computing a difference between the samples of the first portion of the video block and the samples of the second portion of the video block is signaled in a bitstream representation associated with the conversion of the video block.</p><p id="p-0245" num="0445">33. The method of any one or more of clauses 2-3, wherein the first portion of the video block includes escape pixels, wherein, for the escape pixels, a residue obtained from computing a difference between the samples of the first portion of the video block and the reconstructed samples of the second portion of the video block is signaled in a bitstream representation associated with the conversion of the video block.</p><p id="p-0246" num="0446">34. The method of clause 33, wherein the residue is quantized according to a quantization parameter, and wherein the quantized residue is signaled in the bitstream representation associated with the conversion of the video block.</p><p id="p-0247" num="0447">35. The method of clause 34, wherein the quantized residue includes a positive or a negative sign, wherein the positive or the negative sign is signaled in the bitstream representation associated with the conversion of the video block.</p><p id="p-0248" num="0448">36. The method of one or more of clauses 1-35, wherein the first portion of the video block and/or the second portion of the video block correspond to a sub-block further comprising:</p><p id="p-0249" num="0449">selectively enabling or disabling the palette mode and/or the IBC mode to be used on the sub-block.</p><p id="p-0250" num="0450">37. The method of clause 36, wherein the sub-block is a 4&#xd7;4 luma block or a 2&#xd7;2 chroma block.</p><p id="p-0251" num="0451">38. The method of clause 36, wherein the intra block copy (IBC) mode is used prior to the palette mode.</p><p id="p-0252" num="0452">39. The method of clause 36, wherein the palette mode is used on a current chroma sub-block if the current chroma sub-block is not coded in IBC mode.</p><p id="p-0253" num="0453">40. The method of clause 36, wherein the palette mode is used on a current chroma sub-block if a collocated luma block of the current chroma sub-block is not coded in IBC mode.</p><p id="p-0254" num="0454">41. The method of clause 36, wherein the palette mode is used on a current chroma sub-block if an IBC prediction block of the current chroma sub-block is not reconstructed.</p><p id="p-0255" num="0455">42. The method of clause 36, wherein the selectively enabling or disabling is based, at least in part, on a prediction mode of a collocated luma block of the sub-block.</p><p id="p-0256" num="0456">43. The method of clause 36, wherein the selectively enabling of the IBC mode for the sub-block includes copying a collocated sample in IBC prediction and the selectively disabling of the IBC mode for the sub-block includes reconstructing the sub-block using palette colors.</p><p id="p-0257" num="0457">44. The method of clause 36, wherein indications of usage of the palette mode and/or the IBC mode is signaled at sub-block level.</p><p id="p-0258" num="0458">45. The method of clause 44, wherein a flag associated with the sub-block is included in the bitstream representation to indicate whether the sub-block is coded in the palette mode or in the IBC mode.</p><p id="p-0259" num="0459">46. The method of clause 43, wherein a flag associated with the video block is included in the bitstream representation to indicate whether the video block is coded in the palette mode or in the IBC mode, further comprising:</p><p id="p-0260" num="0460">selectively enabling or disabling the palette mode and/or the IBC mode to be used on a first color component of the sub-block is based on information from a second color component of the sub-block.</p><p id="p-0261" num="0461">47. The method of clause 36, wherein a size of the sub-block is based on one or more of the following: a dimension of the video block, a quantization parameter of the video block, the palette index, one or more intra block copy (IBC) flags of neighboring blocks of the video block, a color format of the video block, a coding tree structure of the sub-block, a slice/group/picture type of the sub-block.</p><p id="p-0262" num="0462">48. A method for visual media processing, comprising:</p><p id="p-0263" num="0463">determining, for samples of a video block, that a first combined palette and intra block copy (IBC) mode are to be used for processing the samples, wherein, in the palette mode, the samples of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, the samples of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks, wherein the samples of the video bock are associated with a palette index indicative of an INDEX mode or a COPY_ABOVE mode, wherein in the INDEX mode or in the COPY_ABOVE mode, the palette index of the current block is derived by copying a previously-coded index; and</p><p id="p-0264" num="0464">performing a conversion between the video block and a bitstream representation of the video block.</p><p id="p-0265" num="0465">49. The method of clause 48, wherein the sample of the video block coded in the IBC mode is inferred to have a special index.</p><p id="p-0266" num="0466">50. The method of clause 49, wherein, in the INDEX mode and/or the COPY_ABOVE mode, a value of the special index is based on other palette indices.</p><p id="p-0267" num="0467">51. The method of clause 49, wherein, in the INDEX mode and/or the COPY_ABOVE mode, a sample in a first portion of the video block is prevented from copying a sample from a second portion of the video block.</p><p id="p-0268" num="0468">52. The method of clause 49, wherein a sample coded in the IBC mode is skipped when the palette index of the sample indicates the INDEX and/or the COPY_ABOVE mode.</p><p id="p-0269" num="0469">53. The method of clause 48, further comprising:</p><p id="p-0270" num="0470">determining, for samples of a video block, that a second combined palette and intra prediction mode are to be used for processing the samples using a prediction block generated based on the intra prediction mode and the palette index.</p><p id="p-0271" num="0471">54. The method of clause 48, wherein in the first combined palette mode and intra block copy (IBC) mode, further comprising:</p><p id="p-0272" num="0472">applying a constraint-based rule that specifies at least one valid motion information derived from (i) an IBC merge mode or (ii) an IBC advanced motion vector prediction (AMVP) mode.</p><p id="p-0273" num="0473">55. The method of any one or more of clauses 1-53, wherein information identifying an associated method is included in a video parameter set (VPS), a sequence parameter set (SPS), a picture parameter set (PPS), an adaptation parameter set (APS), a picture header, a tile group header, a tile header, a slice header, or a largest coding unit (LCU) row.</p><p id="p-0274" num="0474">56. The method of clause 55, wherein the information defined for the video block is based on one or more of: a dimension of the video block, a quantization parameter of the video block, a quantization parameter of the video block, a color format of the video block, a coding tree structure of the video block, or a picture/group/slice type of the video block, values of palette flags indicating the palette mode of one or more neighboring samples of the video block, values of intra block copy flags indicating the IBC mode of one or more neighboring samples of the video block, values of the first combined mode flags indicating the combined palette and intra block copy mode of one or more neighboring samples of the video block, and values of the second combined mode flags indicating the combined palette and intra mode of one or more neighboring samples of the video block.</p><p id="p-0275" num="0475">57. The method of clause 54, wherein, when the dimension of the video block exceeds a threshold quantity, the information identifying the associated method is excluded from the bitstream representation.</p><p id="p-0276" num="0476">58. The method of clause 56, wherein values of the palette flags correspond to a Boolean true or false, indicating that the palette mode is enabled or disabled.</p><p id="p-0277" num="0477">59. The method of clause 56, wherein values of the intra block copy flags correspond to a Boolean true or false, indicating that the IBC mode is enabled or disabled.</p><p id="p-0278" num="0478">60. The method of clause 56, wherein values of the first combined mode flags correspond to a Boolean true or false, indicating that the first combined palette and intra block copy mode is disabled or enabled.</p><p id="p-0279" num="0479">61. The method of clause 56, wherein values of the second combined mode flags correspond to a Boolean true or false, indicating that the second combined palette and intra mode is disabled or enabled.</p><p id="p-0280" num="0480">62. The method of clause 56, wherein the information defined for the video block includes a prediction mode, wherein the prediction mode is MODE_IBC, MODE_INTRA, or MODE_INTER, respectively corresponding to the IBC mode, an intra mode, or an inter mode.</p><p id="p-0281" num="0481">63. The method of any one or more of clauses 58-61, wherein the values of the palette flags and/or the values of the intra block copy flags and/or the values of the first combined mode flags and/or the values of the second combined mode flags are signaled in the bitstream representation associated with the conversion of the video block.</p><p id="p-0282" num="0482">64. The method of any one or more of clauses 58-61, wherein the values of the palette flags and/or the values of the intra block copy flags and/or the values of the first combined mode flags and/or the values of the second combined mode flags are computed or inferred.</p><p id="p-0283" num="0483">65. The method of any one or more of clauses 58-61, wherein, in the bitstream representation, the values of the palette flags are signaled prior to the values of the first and second combined mode flags and the values of the intra block copy flags.</p><p id="p-0284" num="0484">66. The method of any one or more of clauses 58-61, wherein, in the bitstream representation, the values of the palette flags, the values of the intra block copy flags, and the values of the first and second combined mode flags are signaled in accordance with an order.</p><p id="p-0285" num="0485">67. The method of any one or more of clauses 58-61, wherein a first flag and a second flag associated with the video block is included in the bitstream representation, wherein the first flag indicates a use of the first combined mode and the second flag indicates a use of the second combined mode, and wherein the first flag is computed or inferred from the second flag.</p><p id="p-0286" num="0486">68. The method of any one or more of clauses 58-61, wherein usage of the palette mode is signaled with a first indication and usage of the first and/or second combined modes is signaled with a second indication.</p><p id="p-0287" num="0487">69. The method of clause 67, wherein the first flag and/or the second flag included in the bitstream representation are signaled using bypass-coded bins or context-coded bins based on arithmetic coding.</p><p id="p-0288" num="0488">70. The method of clause 69, wherein a context of the first flag and/or a context of the second flag is based on one or more neighboring blocks of the video block.</p><p id="p-0289" num="0489">71. The method of clause 69, wherein a context of the first flag and/or a context of the second flag is based on a coded information associated with the one or more neighboring blocks of the video block.</p><p id="p-0290" num="0490">72. The method of any one or more of clauses 68-71, wherein the one or more neighboring blocks of the video block are located left of the video block and/or above the video block.</p><p id="p-0291" num="0491">73. The method of clause 72, wherein a context of the video block, denoted ctxlnc, is computed as ctxlnc=(cu_left_ibc_palette_mode? 1:0)+(cu_above_ibc_palette_mode? 1:0), where cu_left_ibc_palette_mode and cu_above_ibc_palette_mode are contexts of a neighboring left block and above block respectively.</p><p id="p-0292" num="0492">74. The method of clause 71, wherein a context of the video block, denoted ctxlnc, is computed as ctxlnc=(cu_left_ibc_palette_mode? 1:0)*2+(cu_above_ibc_palette_mode? 1:0), where cu_left_ibc_palette_mode and cu_above_ibc_palette_mode are contexts of a neighboring left block and above block respectively.</p><p id="p-0293" num="0493">75. The method of any one or more of clauses 69-73, wherein a context of a neighboring block is set to a default value if the neighboring block is unavailable.</p><p id="p-0294" num="0494">76. The method of clause 75, wherein the default value is zero.</p><p id="p-0295" num="0495">77. The method of clause 71, wherein a context of the first flag and/or a context of the second flag is based on coded information of the video block.</p><p id="p-0296" num="0496">78. The method of clause 77, wherein the coded information includes a dimension of the video block or a partitioning process associated with the video block.</p><p id="p-0297" num="0497">79. The method of clause 78, wherein the partitioning process associated with the video block includes one of: a quad-tree partitioning, a binary partitioning, or a ternary tree partitioning.</p><p id="p-0298" num="0498">80. The method of any of clauses 1-79, wherein the conversion includes generating the bitstream representation from the current video block.</p><p id="p-0299" num="0499">81. The method of any of clauses 1-79, wherein the conversion includes generating pixel values of the current video block from the bitstream representation.</p><p id="p-0300" num="0500">82. A video encoder apparatus comprising a processor configured to implement a method recited in any one or more of clauses 1-79.</p><p id="p-0301" num="0501">83. A video decoder apparatus comprising a processor configured to implement a method recited in any one or more of clauses 1-79.</p><p id="p-0302" num="0502">84. A computer readable medium having code stored thereon, the code embodying processor-executable instructions for implementing a method recited in any of or more of clauses 1-79.</p><p id="p-0303" num="0503">In the present document, the term &#x201c;video processing&#x201d; may refer to video encoding, video decoding, video compression or video decompression. For example, video compression algorithms may be applied during conversion from pixel representation of a video to a corresponding bitstream representation or vice versa. The bitstream representation of a current video block may, for example, correspond to bits that are either co-located or spread in different places within the bitstream, as is defined by the syntax. For example, a macroblock may be encoded in terms of transformed and coded error residual values and also using bits in headers and other fields in the bitstream. Furthermore, during conversion, a decoder may parse a bitstream with the knowledge that some fields may be present, or absent, based on the determination, as is described in the above solutions. Similarly, an encoder may determine that certain syntax fields are or are not to be included and generate the coded representation accordingly by including or excluding the syntax fields from the coded representation.</p><p id="p-0304" num="0504">The disclosed and other solutions, examples, embodiments, modules and the functional operations described in this document can be implemented in digital electronic circuitry, or in computer software, firmware, or hardware, including the structures disclosed in this document and their structural equivalents, or in combinations of one or more of them. The disclosed and other embodiments can be implemented as one or more computer program products, i.e., one or more modules of computer program instructions encoded on a computer readable medium for execution by, or to control the operation of, data processing apparatus. The computer readable medium can be a machine-readable storage device, a machine-readable storage substrate, a memory device, a composition of matter effecting a machine-readable propagated signal, or a combination of one or more them. The term &#x201c;data processing apparatus&#x201d; encompasses all apparatus, devices, and machines for processing data, including by way of example a programmable processor, a computer, or multiple processors or computers. The apparatus can include, in addition to hardware, code that creates an execution environment for the computer program in question, e.g., code that constitutes processor firmware, a protocol stack, a database management system, an operating system, or a combination of one or more of them. A propagated signal is an artificially generated signal, e.g., a machine-generated electrical, optical, or electromagnetic signal, that is generated to encode information for transmission to suitable receiver apparatus.</p><p id="p-0305" num="0505">A computer program (also known as a program, software, software application, script, or code) can be written in any form of programming language, including compiled or interpreted languages, and it can be deployed in any form, including as a stand-alone program or as a module, component, subroutine, or other unit suitable for use in a computing environment. A computer program does not necessarily correspond to a file in a file system. A program can be stored in a portion of a file that holds other programs or data (e.g., one or more scripts stored in a markup language document), in a single file dedicated to the program in question, or in multiple coordinated files (e.g., files that store one or more modules, sub programs, or portions of code). A computer program can be deployed to be executed on one computer or on multiple computers that are located at one site or distributed across multiple sites and interconnected by a communication network.</p><p id="p-0306" num="0506">The processes and logic flows described in this document can be performed by one or more programmable processors executing one or more computer programs to perform functions by operating on input data and generating output. The processes and logic flows can also be performed by, and apparatus can also be implemented as, special purpose logic circuitry, e.g., an FPGA (field programmable gate array) or an ASIC (application specific integrated circuit).</p><p id="p-0307" num="0507">Processors suitable for the execution of a computer program include, by way of example, both general and special purpose microprocessors, and any one or more processors of any kind of digital computer. Generally, a processor will receive instructions and data from a read only memory or a random-access memory or both. The essential elements of a computer are a processor for performing instructions and one or more memory devices for storing instructions and data. Generally, a computer will also include, or be operatively coupled to receive data from or transfer data to, or both, one or more mass storage devices for storing data, e.g., magnetic, magneto optical disks, or optical disks. However, a computer need not have such devices. Computer readable media suitable for storing computer program instructions and data include all forms of non-volatile memory, media and memory devices, including by way of example semiconductor memory devices, e.g., EPROM, EEPROM, and flash memory devices; magnetic disks, e.g., internal hard disks or removable disks; magneto optical disks; and CD ROM and DVD-ROM disks. The processor and the memory can be supplemented by, or incorporated in, special purpose logic circuitry.</p><p id="p-0308" num="0508">While this patent document contains many specifics, these should not be construed as limitations on the scope of any subject matter or of what may be claimed, but rather as descriptions of features that may be specific to particular embodiments of particular techniques. Certain features that are described in this patent document in the context of separate embodiments can also be implemented in combination in a single embodiment. Conversely, various features that are described in the context of a single embodiment can also be implemented in multiple embodiments separately or in any suitable subcombination. Moreover, although features may be described above as acting in certain combinations and even initially claimed as such, one or more features from a claimed combination can in some cases be excised from the combination, and the claimed combination may be directed to a subcombination or variation of a subcombination.</p><p id="p-0309" num="0509">Similarly, while operations are depicted in the drawings in a particular order, this should not be understood as requiring that such operations be performed in the particular order shown or in sequential order, or that all illustrated operations be performed, to achieve desirable results. Moreover, the separation of various system components in the embodiments described in this patent document should not be understood as requiring such separation in all embodiments.</p><p id="p-0310" num="0510">Only a few implementations and examples are described and other implementations, enhancements and variations can be made based on what is described and illustrated in this patent document.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A method for process video data, comprising:<claim-text>determining, for a conversion between a video block of the video data and a bitstream of the video block, that palette mode is to be used for processing a first portion of the video block and intra block copy (IBC) mode is to be used for processing a second portion of the video block wherein, in the palette mode, samples of the first portion of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, samples of the second portion of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks using motion information; and</claim-text><claim-text>performing, during the conversion, further processing of the first portion of the video block using the palette mode and further processing of the second portion of the video block based on a prediction block derived using the IBC mode, wherein further processing of the second portion of the video block includes:</claim-text><claim-text>reconstructing samples of the second portion of the video block by copying collocated samples derived using the IBC mode.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein indications of the first portion of the video block processed using the palette mode and indications of the second portion of the video block processed using the IBC mode are included in a palette index map that identifies the first portion of the video block and the second portion of the video block.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein a palette index included in the palette index map indicates whether a sample belongs to the first portion of the video block or the second portion of the video block.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the palette index of a sample belonging to the second portion of the video block is set to 0.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein an actual palette index of a sample belonging to the first portion is equal to one less than a decoded palette index.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the palette index is equal to an integer value based on one or more of: a dimension of the video block, a quantization parameter of the video block, a quantization parameter of the video block, a color format of the video block, a coding tree structure of the video block, a picture/group/slice type of the video block, or a parameter included in the bitstream associated with conversion of the video block.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein indications identifying the first portion of the video block and the second portion of the video block is signaled as a syntax element flag.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein a value of the syntax element flag is derived based on neighboring samples of the block.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first portion of the video block includes escape pixels, wherein, for the escape pixels, a residue obtained from computing a difference between the samples of the first portion of the video block and collocated prediction samples using IBC mode or a intra mode.</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the conversion includes encoding the video block into the bitstream.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the conversion includes decoding the video block from the bitstream.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. An apparatus for processing video data comprising a processor and a non-transitory memory with instructions thereon, wherein the instructions upon execution by the processor, cause the processor to:<claim-text>determine, for a conversion between a video block of the video data and a bitstream of the video block, that palette mode is to be used for processing a first portion of the video block and intra block copy (IBC) mode is to be used for processing a second portion of the video block wherein, in the palette mode, samples of the first portion of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, samples of the second portion of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks using motion information; and</claim-text><claim-text>perform, during the conversion, further processing of the first portion of the video block using the palette mode and further processing of the second portion of the video block based on a prediction block derived using the IBC mode, wherein further processing of the second portion of the video block includes:</claim-text><claim-text>reconstruct samples of the second portion of the video block by copying collocated samples derived using the IBC mode.</claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein indications of the first portion of the video block processed using the palette mode and indications of the second portion of the video block processed using the IBC mode are included in a palette index map that identifies the first portion of the video block and the second portion of the video block.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. The apparatus of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein a palette index included in the palette index map indicates whether a sample belongs to the first portion of the video block or the second portion of the video block.</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The apparatus of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the palette index of a sample belonging to the second portion of the video block is set to 0.</claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The apparatus of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein an actual palette index of a sample belonging to the first portion is equal to one less than a decoded palette index.</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. A non-transitory computer-readable recording medium storing a bitstream of a video which is generated by a method performed by a video processing apparatus,<claim-text>wherein the method comprises:</claim-text><claim-text>determining that palette mode is to be used for processing a first portion of the video block and intra block copy (IBC) mode is to be used for processing a second portion of the video block wherein, in the palette mode, samples of the first portion of the video block are coded according to a set of representative color values included in a predefined palette and wherein, in the IBC mode, samples of the second portion of the video block are predicted from adjacent pixels from neighboring, previously-decoded video blocks using motion information;</claim-text><claim-text>performing further processing of the first portion of the video block using the palette mode and further processing of the second portion of the video block based on a prediction block derived using the IBC mode, wherein further processing of the second portion of the video block includes:</claim-text><claim-text>reconstructing samples of the second portion of the video block by copying collocated samples derived using the IBC mode; and</claim-text><claim-text>generating the bitstream based on the performing.</claim-text></claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The non-transitory computer-readable recording medium of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein indications of the first portion of the video block processed using the palette mode and indications of the second portion of the video block processed using the IBC mode are included in a palette index map that identifies the first portion of the video block and the second portion of the video block.</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The non-transitory computer-readable recording medium of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein a palette index included in the palette index map indicates whether a sample belongs to the first portion of the video block or the second portion of the video block.</claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The non-transitory computer-readable recording medium of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the palette index of a sample belonging to the second portion of the video block is set to 0.</claim-text></claim></claims></us-patent-application>