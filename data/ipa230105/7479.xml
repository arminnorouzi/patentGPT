<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007480A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007480</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17781840</doc-number><date>20201130</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>CN</country><doc-number>201911219000.X</doc-number><date>20191203</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>069</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20210101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>12</main-group><subgroup>069</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc></classifications-cpc><invention-title id="d2e61">PROVISIONING METHOD AND TERMINAL DEVICE</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="obligated-assignee"><addressbook><orgname>CHINA MOBILE COMMUNICATION CO., LTD RESEARCH INSTITUTE</orgname><address><city>Beijing</city><country>CN</country></address></addressbook><residence><country>CN</country></residence></us-applicant><us-applicant sequence="01" app-type="applicant" designation="us-only" applicant-authority-category="obligated-assignee"><addressbook><orgname>CHINA MOBILE COMMUNICATIONS GROUP CO., LTD.</orgname><address><city>Beijing</city><country>CN</country></address></addressbook><residence><country>CN</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>TIAN</last-name><first-name>Ye</first-name><address><city>Beijing</city><country>CN</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>REN</last-name><first-name>Xiaoming</first-name><address><city>Beijing</city><country>CN</country></address></addressbook></inventor></inventors></us-parties><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/CN2020/132712</doc-number><date>20201130</date></document-id><us-371c12-date><date>20220602</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">The present disclosure provides a provisioning method and a terminal device. The provisioning method is applied to the terminal device, including: the security module establishes a secure channel with the certificate authority CA server through one or more session keys shared by the security module and the CA server; and obtains one or more digital certificates from the CA server; wherein, the security module is to implement Universal Subscriber Identity Module (USIM) functions.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="59.86mm" wi="135.81mm" file="US20230007480A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="126.15mm" wi="140.04mm" file="US20230007480A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="92.03mm" wi="133.43mm" file="US20230007480A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="162.90mm" wi="147.07mm" file="US20230007480A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="219.54mm" wi="137.92mm" file="US20230007480A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="197.10mm" wi="126.75mm" file="US20230007480A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading><p id="p-0002" num="0001">The application claims priority to Chinese patent application No. 201911219000.X, filed on Dec. 3, 2019, the disclosure of which is hereby incorporated by reference in its entirety.</p><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">The present disclosure relates to the technical field of Internet of Vehicles (IoV), and in particular to a provisioning method and a terminal device.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">In order to reduce the impact of the introduction of the Vehicle-to-Everything (V2X) technology on the production of enterprises, the initial security configuration of an IoV terminal should reduce the dependence on the secure environment and security capability of the production of enterprises as much as possible. Therefore, a simpler and effective method for V2X terminal identity authentication and information security interaction is needed to minimize the cost of upgrading the production line of enterprises.</p><p id="p-0005" num="0004">An on-line initial security configuration scheme based on a Generic Bootstrapping Architecture (GBA) that is proposed by the Fifth Generation Automotive Association (5GAA) avoids a production mode of off-line filling of production line and pre-configuration of the X.509 digital certificate(s), which can save the cost of security reformation of the production environment in enterprises. However, the proposed scheme has the problem that a shared session key(s) (Ks_NAF) may be exposed when transmitted outside the secure environment and faces security risks such as a physical attack.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0006" num="0005">Embodiments of the present disclosure provide a provisioning method and a terminal device to solve the problem in the related art that a session key(s) need(s) to be transmitted between a Universal Subscriber Identity Module (USIM) and a Hardware Security Module (HSM) of a terminal device, as a result, the session key(s) is/are transmitted outside a secure environment and may be vulnerable to physical attacks, and therefore, the security of provisioning cannot be guaranteed.</p><p id="p-0007" num="0006">To solve the above problem, the embodiments of the present disclosure provide a provisioning method, which is applied to a terminal device, and may include the following operations.</p><p id="p-0008" num="0007">A security module establishes a secure channel with a Certificate Authority (CA) server through one or more session keys shared by the security module and the CA server.</p><p id="p-0009" num="0008">One or more digital certificates are obtained from the CA server.</p><p id="p-0010" num="0009">The security module is to implement Universal Subscriber Identity Module (USIM) functions.</p><p id="p-0011" num="0010">Optionally, when the CA server is an Enrollment Certificate Authority (ECA) server, the one or more digital certificates are one or more Enrollment Certificates (ECs). The operation of obtaining the one or more digital certificates from the CA server may include the following operations.</p><p id="p-0012" num="0011">The security module generates one or more public and private key pairs for applying for the one or more ECs.</p><p id="p-0013" num="0012">The one or more ECs are obtained from the ECA server with the one or more public and private key pairs.</p><p id="p-0014" num="0013">Optionally, when the CA server is the ECA server, the one or more digital certificates are one or more ECs. After the one or more digital certificates are obtained from the CA server, the method may further include the following operation.</p><p id="p-0015" num="0014">The one or more ECs are stored by the security module.</p><p id="p-0016" num="0015">Further, when the CA server is a Pseudonym Certificate Authority (PCA) server, the one or more digital certificates are one or more Pseudonym Certificates (PCs). The operation of obtaining the one or more digital certificates from the CA sever may include the following operations.</p><p id="p-0017" num="0016">The security module signs one or more PC application messages with the one or more private keys of the one or more ECs.</p><p id="p-0018" num="0017">The one or more PCs are obtained from the PCA server according to the one or more PC application messages.</p><p id="p-0019" num="0018">Specifically, the operation of obtaining the one or more PCs from the PCA server may include the following operation.</p><p id="p-0020" num="0019">One or more feedback messages sent by the PCA server are received, the signature(s) of the received one or more feedback messages is/are verified with the one or more public keys of the PCA server, and the one or more PCs are obtained.</p><p id="p-0021" num="0020">Specifically, after the one or more PCs are obtained from the PCA server, the method may further include the following operations.</p><p id="p-0022" num="0021">The security module signs the one or more messages transmitted directly on PC5 interface with one or more private keys of the one or more PCs.</p><p id="p-0023" num="0022">The signed one or more messages are sent to the external device.</p><p id="p-0024" num="0023">Optionally, when the CA server is the ECA server, the one or more digital certificates are one or more ECs. After the one or more digital certificates are obtained from the CA server, the method may further include the following operations.</p><p id="p-0025" num="0024">The one or more ECs are sent to the HSM by the security module.</p><p id="p-0026" num="0025">The HSM stores the one or more ECs.</p><p id="p-0027" num="0026">Further, the operation of obtaining the one or more digital certificates from the CA server may further include the following operations.</p><p id="p-0028" num="0027">The HSM generates the one or more public and private key pairs for applying for the one or more ECs.</p><p id="p-0029" num="0028">The HSM sends the one or more public keys for applying for the one or more ECs to the security module.</p><p id="p-0030" num="0029">The security module obtains the one or more ECs from the ECA server with the one or more public keys.</p><p id="p-0031" num="0030">Optionally, when the CA server is the PCA server, the one or more digital certificates are the one or more PCs, and the operation of obtaining the one or more digital certificates from the CA sever may include the following operations.</p><p id="p-0032" num="0031">The one or more PCs are sent to the HSM by the security module.</p><p id="p-0033" num="0032">The HSM stores the one or more PCs.</p><p id="p-0034" num="0033">Further, the operation of obtaining the one or more digital certificates from the CA server may include the following operations.</p><p id="p-0035" num="0034">The HSM generates the one or more public and private key pairs for applying for the one or more PCs.</p><p id="p-0036" num="0035">The HSM sends the one or more public keys for applying for the one or more PCs to the security module.</p><p id="p-0037" num="0036">The security module obtains the one or more PCs from the PCA server with the one or more public keys.</p><p id="p-0038" num="0037">Further, after the one or more digital certificates are obtained from the CA server, the method may further include the following operations.</p><p id="p-0039" num="0038">The security module sign the one or more messages transmitted directly on PC5 interface with one or more private keys of the one or more PCs.</p><p id="p-0040" num="0039">The signed one or more messages are sent to the external device.</p><p id="p-0041" num="0040">Specifically, a secure channel is established between the security module and the CA server through a Generic Bootstrapping Architecture based on a Universal Integrated Circuit Card (GBA_U).</p><p id="p-0042" num="0041">The embodiments of the present disclosure also provide a terminal device, which may include a security module.</p><p id="p-0043" num="0042">The security module is configured to: establish a secure channel with a CA server through one or more session keys shared by the security module and the CA server; and</p><p id="p-0044" num="0043">obtain one or more digital certificates from the CA server.</p><p id="p-0045" num="0044">The security module is to implement Universal Subscriber Identity Module (USIM) functions.</p><p id="p-0046" num="0045">The embodiments of the present disclosure also provide a terminal device, which may include a transceiver and a processor.</p><p id="p-0047" num="0046">The processor is configured to:</p><p id="p-0048" num="0047">control a security module to establish a secure channel with a CA server through one or more session keys shared by the security module and the CA server; and</p><p id="p-0049" num="0048">obtain one or more digital certificates from the CA server.</p><p id="p-0050" num="0049">The security module is to implement Universal Subscriber Identity Module (USIM) functions.</p><p id="p-0051" num="0050">The embodiments of the present disclosure also provide a computer-readable storage medium, in which a computer program may be stored. The program, when executed by the processor, implements the steps in the above provisioning method.</p><p id="p-0052" num="0051">The present disclosure has the following beneficial effects.</p><p id="p-0053" num="0052">By directly establishing a secure channel between a security module that can implement USIM functions and a CA server, and obtaining a session key(s) and a digital certificate(s) from the CA server through the secure channel, the above solution prevents the session key(s) used for applying for the digital certificate(s) from being transmitted in an environment other than the secure channel, thereby reducing the probability of the session key(s) being subjected to physical attacks, reducing the security risk, and improving the security of provisioning.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a schematic diagram of an autonomous mode of off-line filling of a production line.</p><p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a schematic diagram of a Device Configuration Manager (DCM) agent mode of off-line filling of a production line.</p><p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a schematic diagram of a GBA.</p><p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is an architecture diagram of applying for a PC(s) based on Transport Layer Security (TLS).</p><p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is a schematic diagram of security risks in terminal implementation based on a GBA in the related art.</p><p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a schematic diagram of security risks when a configuration scheme based on a GBA that is proposed by the 5GAA is used for PC application.</p><p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a flowchart of a provisioning method according to an embodiment of the present disclosure.</p><p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a schematic diagram of a security implementation architecture based on a GBA for applying for one or more ECs according to embodiments of the present disclosure.</p><p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a schematic diagram of a security implementation architecture based on a GBA for applying for a PC(s) according to embodiments of the present disclosure.</p><p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a diagram of an architecture of a USIM according to embodiments of the present disclosure.</p><p id="p-0064" num="0063"><figref idref="DRAWINGS">FIG. <b>11</b></figref> is a schematic diagram of modules of a terminal device according to embodiments of the present disclosure.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION</heading><p id="p-0065" num="0064">The technologies related to the embodiments of the present disclosure are briefly introduced as follows.</p><p id="p-0066" num="0065">At present, off-line filling of a production line is a primary method for realizing initial security configuration of V2X terminal devices (including an On Board Unit (OBU), a Road Side Unit (RSU), etc.), which can perform provisioning to Hardware Security Modules (HSMs) of the devices. Here, a provisioning process of the OBU device before an automobile with a V2X function comes off a production line is described as an example. Other types of V2X terminals also have the similar process.</p><p id="p-0067" num="0066">According to different implementation methods, the off-line filling of a production line includes an autonomous mode and a DCM agent mode. The processes are shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref> and <figref idref="DRAWINGS">FIG. <b>2</b></figref> respectively.</p><p id="p-0068" num="0067">In the autonomous mode, a production line worker triggers, through an external device, an HSM of an OBU device to generate one or more public and private key pairs, or injects one or more public and private key pairs generated by an external cryptographic device into the HSM. At the same time, the production line injects address information and a digital certificate(s) of an Enrollment Certificate Authority (ECA) server. Then, the production line worker triggers the OBU device to access the ECA server. The OBU device uses the digital certificate(s) of the ECA server to authenticate its identity and establishes a secure communication channel between them. Finally, under the protection of the secure channel, the OBU device uploads one or more public keys to the ECA server, applies for and downloads a digital EC(s), and stores the same securely in the HSM.</p><p id="p-0069" num="0068">The working principle of the DCM agent mode is basically the same as that of the autonomous mode, but the implementation process is different. In the DCM agent mode, the production line needs to deploy a DCM agent node, and performs mutual authentication with the ECA server in advance to establish the secure communication channel, and provides uniform services for all vehicles coming off the production line. In the process of initial security configuration, the DCM generates the one or more public and private key pairs for the OBU device and interacts with the ECA server instead of the OBU device to apply for and download the one or more digital ECs. Finally, the DCM securely injects the generated one or more public and private key pairs, the obtained one or more digital ECs, and the one or more certificates and address information of the ECA server into the HSM of the OBU, thereby completing the initial security configuration of the OBU device.</p><p id="p-0070" num="0069">The 5GAA proposes an initial security configuration method for a V2X terminal device based on a GBA technology in the research report &#x201c;Efficient Provisioning System Simplifications&#x201d;. In the method, a USIM and its code number (such as the International Mobile Subscriber Identification Number (IMSI), the Mobile Station International Subscriber Directory Number (MSISDN) and the Integrate Circuit Card Identity (ICCID)) are used as the identity of the V2X terminal device at the initial time to represent the device identity. Based on the USIM, the V2X terminal device can access an operator network, perform bidirectional authentication and key negotiation with the network through an Authentication and Key Agreement (AKA) mechanism, and generate and provide a shared session key(s) Ks_NAF for applications. Finally, secure transmission channels, such as a TLS secure channel, can be established between the V2X device and the ECA server.</p><p id="p-0071" num="0070"><figref idref="DRAWINGS">FIG. <b>3</b></figref> gives a GBA, which consists of the following parts:</p><p id="p-0072" num="0071">A11, software providing GBA capability support on the V2X terminal device, namely a GAA server;</p><p id="p-0073" num="0072">A12, V2X client software on the V2X terminal device, which interfaces with the GAA server;</p><p id="p-0074" num="0073">A13, a USIM communicating with the GAA server;</p><p id="p-0075" num="0074">A14, a Network Application Function (NAF) software in the ECA server; and</p><p id="p-0076" num="0075">A15, a Bootstrapping Server Function (BSF) core network element.</p><p id="p-0077" num="0076">Based on the security authentication method of network GBA, the V2X terminal device may use a root key(s) in the USIM card to perform bidirectional identity authentication with a mobile cellular network through the AKA mechanism, and negotiate with the BSF to generate the shared session key(s) Ks_NAF. Then, when receiving a certificate application request(s) from the V2X terminal device, the ECA server may interact with the BSF to obtain the session key(s) Ks_NAF, and authenticate the identity of the V2X terminal device based on the Ks_NAF. After the identity authentication is approved, the ECA server accepts the EC application request(s) of the V2X terminal device and issues the digital EC(s) to the V2X terminal device upon approval. In the above process, application layer information interaction between the ECA server and the V2X terminal device is performed in a secure channel established based on the shared session key(s) Ks_NAF, so the security of message transmission can be guaranteed.</p><p id="p-0078" num="0077">In the above solution based on the GBA, the USIM is used as the initial identity of the V2X terminal device, and without pre-configuring any security credentials (such as the X.509 digital certificate(s)), the secure channel between the V2X terminal device and the ECA server can be established through the mobile cellular network to complete the provisioning of the device online. In the solution, operations and interactions related to the initial security configuration are performed by the V2X terminal device itself without the need of relying on the secure environment of the production line to ensure the security of configuration operations as in the off-line filing mode, thus greatly reducing the cost of upgrading the production line of enterprises.</p><p id="p-0079" num="0078">In addition, the method can be applied to a scenario where the place of automobile production and the place of automobile sales are not in the same region. Through the network configuration, an OBU terminal is allowed to access the ECA server at the place where the automobile is sold and used, thereby solving the problem of determining the place of the ECA server of which an X.509 digital certificate(s) is/are pre-configured for the OBU terminal in an automobile production process.</p><p id="p-0080" num="0079">In the process of identity authentication and establishment of a secure channel, the code number in the USIM may be used as the unique identity of the V2X device, which avoids the situation in which the identity of the V2X terminal device has not been authenticated and the V2X terminal device cannot be authenticated only based on the X.509 digital certificate(s) of the ECA server.</p><p id="p-0081" num="0080">In &#x201c;Technical Specification of Communication (Pseudonym) Certificate Management Based on Cooperative Vehicle Infrastructure System&#x201d; being discussed by China ITS Industry Alliance, a method for a V2X terminal device (including the OBU, the RSU, etc.) to apply for one or more PCs is proposed. The general idea of this method is that Transport Layer Security (TLS) is recommended for the identity authentication and the establishment of the TLS secure channel between a PCA server and the V2X terminal device, and then the V2X terminal device interacts with the PCA server through the TLS secure channel to apply for the digital PC(s). In the draft specification, the sections related to applying for the one or more PCs are described as follows.</p><p id="p-0082" num="0081">The specification is applicable to a scenario where an On Board Unit (OBU) or a Road Side Unit (RSU) with a valid EC(s) issued by the ECA applies for a communication (pseudonym) certificate(s) from the Authorization Certificate Authority (ACA) for information interaction with the RSU or the OBU, so as to obtain relevant information services and have the capability to verify the signature of the obtained information. In addition, the specification is also applicable to a scenario where an OBU applies for the communication (pseudonym) certificate(s) from the ACA and communicates with other OBUs.</p><p id="p-0083" num="0082">An Application Programming Interface (API) in the specification uses Hypertext Transfer Protocol over Secure Socket Layer (HTTPS), specifically it is suggested to use at least the version of TLS 1.2, and the version of TLS 1.3 is recommended, supports a standard HTTPS Transport Control Protocol (TCP) 443 port, and uses the X.509 certificate(s) to perform the identity authentication among components.</p><p id="p-0084" num="0083">Here, the ACA refers to an organization that manages the communication (pseudonym) certificate(s), namely the PCA in the present application.</p><p id="p-0085" num="0084">In order to ensure the security of a process of applying for and obtaining the one or more PCs, on the V2X terminal device, the TLS scheme may be implemented using the scheme shown in <figref idref="DRAWINGS">FIG. <b>4</b></figref>. The X.509 device certificate(s) is/are pre-configured for the V2X terminal device in the HSM, and the TLS secure channel is established between the HSM and the PCA server to ensure communication security. The public and private key pair(s) related to the one or more PCs are generated in the secure environment of the HSM. Through the TLS secure channel, a public key(s) and device information are reported, and the digital PC(s) is/are applied for, downloaded, and stored securely. The whole scheme is conducted in a secure environment to ensure the security of the whole process.</p><p id="p-0086" num="0085">The 5GAA proposes an initial security configuration method for a V2X terminal device based on a GBA technology in the research report &#x201c;Efficient Provisioning System Simplifications&#x201d;. If the method is applied to applying for the one or more PCs, the pre-configuration of the X.509 certificate(s) can be avoided and then the cost of production line reformation can be reduced.</p><p id="p-0087" num="0086">The related art has the following disadvantages.</p><p id="p-0088" num="0087">Because a secure initialization process of the V2X terminal device involves the provisioning of sensitive parameters and information such as keys and digital certificates, the process has very strict requirements for security, and it is necessary to ensure the security of production environment, terminal device, message exchange and other links.</p><heading id="h-0007" level="1">1.1 Off-Line Filling of a Production Line</heading><p id="p-0089" num="0088">The initial security configuration method for the off-line filling of production line needs to generate the public and private key pair(s) outside the V2X terminal device and even apply for the digital EC(s) by an agent, which puts forward high security requirements on the production environment of an automobile enterprise or a V2X terminal device supplier (depending on who completes the initial security configuration). Enterprises have to invest a lot of time and cost to upgrade the production line and train the production line workers to meet the production safety requirements in compliance, audit, management and control and other aspects.</p><p id="p-0090" num="0089">At present, powerful foreign automobile enterprises have deployed a secure production environment for production by means of off-line filling. However, most of Chinese domestic automobile enterprises do not have such a secure production environment. If they are required to also use off-line filling for production, great cost will be brought to the enterprises. Therefore, a simpler and securer solution is needed.</p><heading id="h-0008" level="1">1.2 On-Line Configuration of EC(s) Based on GBA Technology</heading><p id="p-0091" num="0090">The current implementation scheme on the V2X terminal device side proposed by the 5GAA has security vulnerabilities and has a security risk of physical attack on the shared session key(s) Ks_NAF. The specific reasons are as follows.</p><p id="p-0092" num="0091">In order ensure the security of the initial security configuration of the V2X terminal device, it is generally required that the sensitive security parameters and information (such as the public and private key pair(s), the shared key(s), and various intermediate key(s)) involved in the process are processed in the local secure environment of the device and cannot leave the local secure environment of the terminal in its life cycle. The local secure environment of the terminal is usually provided by hardware modules that reach a certain security level through assessment, such as the USIM and the HSM. In addition, to realize the security of external communication of the V2X terminal device, it is needed to ensure the security of message transmission. Corresponding to the process of initial security configuration of the V2X terminal device, it is required that the V2X terminal device and the ECA server communicate through a secure communication channel, and the secure channel should terminate in a security module of the device on the terminal side, to ensure that all information is interacted in the secure environment.</p><p id="p-0093" num="0092">In the implementation scheme proposed in a report of the 5GAA, the HSM is an object of the initial security configuration of the V2X terminal device. The one or more public and private key pairs used to apply for the one or more ECs is generated by the HSM. The TLS secure channel is established between the HSM and the ECA server using the shared session key(s) Ks_NAF generated by the USIM based on the GBA technology. However, due to the limitation of the V2X terminal device architecture, the USIM is an independent security entity outside the HSM, so the USIM needs to pass the shared session key(s) Ks_NAF generated by the GBA mechanism to the HSM through a transmission channel outside the secure environment. In this way, the shared session key(s) Ks_NAF is exposed outside the secure environment, especially after passing an Application Processor (AP), and it faces the physical attacks and other security risks. Once the shared session key(s) Ks_NAF for establishing the secure channel is leaked during transmission, the security of message exchange between the V2X terminal device and the ECA server cannot be guaranteed.</p><p id="p-0094" num="0093">Due to the above security risks, enterprises need to conduct a security assessment on the risks when choosing a technical scheme, and may use a GBA initial security configuration scheme only if the risks are controllable, which greatly limits the application scope of the scheme.</p><p id="p-0095" num="0094">In addition, when the GBA scheme proposed by the 5GAA is implemented on the terminal, the HSM is responsible for generating the one or more public and private key pairs, establishing the TLS secure channel, applying for, downloading and storing the EC(s), and the USIM is responsible for generating the related session key(s) based on the GBA technology. The cost of terminal implementation is high. The terminal is required to support both the USIM and the HSM, and the security hardware of the HSM is expensive, so the cost of terminal implementation is high.</p><p id="p-0096" num="0095">For the above deficiencies, a more straightforward solution is to integrate the USIM and the HSM into the same physical module or chip to avoid exposure during key transmission and improve the security. However, at present, such a terminal chip or module product is not available and cannot be realized on the V2X terminal device.</p><heading id="h-0009" level="1">1.3 PC Deployment Scheme Based on TLS</heading><p id="p-0097" num="0096">&#x201c;Technical Specification of Communication (Pseudonym) Certificate Management Based on Cooperative Vehicle Infrastructure System&#x201d; proposes that the digital PC is applied for the V2X terminal device by means of the TLS, and the X.509 certificate(s) is/are required to establish the secure channel between the V2X terminal device and the PCA server. This means that the automobile enterprise or the V2X terminal device supplier needs to pre-configure the X.509 digital certificate(s) for the V2X terminal device, which brings a requirement for upgrading the production line. At the same time, because the pre-configuration of the X.509 digital certificate(s) involve(s) the configuration of the sensitive security information such as keys, the process has strict requirements on the secure production environment, which brings a large cost to the enterprise for upgrading the production line.</p><heading id="h-0010" level="1">1.4 On-Line Deployment of PC(s) Based on GBA Technology</heading><p id="p-0098" num="0097">The provisioning method based on the GBA which is proposed by the 5GAA in the research report &#x201c;Efficient Provisioning System Simplifications&#x201d; is mainly used for the provisioning of the one or more ECs. The method is mainly used for completing the provisioning of the EC(s), and is not designed for the initial application of the one or more PCs. If the method is applied to applying for the one or more PCs, the terminal may have the potential security risks such as a physical attack. Similar to the problem shown in <figref idref="DRAWINGS">FIG. <b>5</b></figref>, the shared session key(s) Ks_NAF will be exposed outside the secure environment during transmission, and there is a security risk that the Ks_NAF is tampered with and leaked, as shown in <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0099" num="0098">For the problem in the related art that the session key(s) needs to be transmitted between the USIM and the HSM of a terminal device, as a result, the session key(s) is/are transmitted outside a secure environment and may be vulnerable to a physical attack, the present disclosure provides a provisioning method and a terminal device.</p><p id="p-0100" num="0099">For making the purpose, technical solutions and advantages of the present disclosure clearer, the present disclosure is described in details below in combination with the accompanying drawings and the specific embodiments.</p><p id="p-0101" num="0100">As shown in <figref idref="DRAWINGS">FIG. <b>7</b></figref>, the provisioning method of the embodiments of the present disclosure is applied to a terminal device, and may include the following operations.</p><p id="p-0102" num="0101">A security module establishes a secure channel with a CA server through one or more session keys shared by the security module and the CA server.</p><p id="p-0103" num="0102">One or more digital certificates are obtained from the CA server.</p><p id="p-0104" num="0103">It is to be noted that the security module in the embodiments of the present disclosure is to implement USIM functions, that is, when the security module only realizes the USIM functions, it is the USIM. Optionally, when the security module is further to implement functions of the USIM and an HSM, it indicates that the USIM and the HSM are integrated in the terminal device, and it may also be understood that the terminal device has the HSM that can implement the USIM functions.</p><p id="p-0105" num="0104">It is to be noted that in this mode, the secure channel is directly established between the security module that can implement the functions of the USIM and the CA server, and during applying for the digital certificate(s), the USIM directly uses the session key(s) to encrypt and protect an application message(s), without the need of sending the session key(s) to the HSM. Therefore, the session key(s) do(es) not have to be exposed outside the secure environment, thereby reducing the probability of the session key(s) being subjected to physical attacks.</p><p id="p-0106" num="0105">It is to be noted that the terminal device mentioned in the embodiments of the present disclosure is a V2X terminal device based on the GBA technology, which may be an OBU, an RSU, a wearable device for pedestrian and other types of V2X terminal devices and IoV terminal devices. The problem that the shared session key(s) (Ks_NAF) generated by GBA-based negotiation is transmitted outside the local secure environment of the terminal can be solved, and the security risks such as a physical attack can be eliminated.</p><p id="p-0107" num="0106">It is to be noted that the embodiment may be used for applying for either an EC(s) or a PC(s). When the one or more digital certificates are one or more ECs, the CA server is an ECA server. When the one or more digital certificates are one or more PCs, the CA server is a PCA server.</p><p id="p-0108" num="0107">For example, if the security module is a USIM, the specific implementation processes of applying for the one or more ECs and the one or more PCs are described below respectively.</p><heading id="h-0011" level="1">First, Applying for the One or more ECs</heading><p id="p-0109" num="0108"><figref idref="DRAWINGS">FIG. <b>8</b></figref> shows a schematic diagram of security implementation architecture based on a GBA. The V2X terminal device includes: an application processor (AP), an LTE-V2X communication module connected to the AP, and an LTE-Uu communication module connected to the AP. The LTE-Uu communication module includes: a modem and a USIM. Specifically, a secure channel is established between the USIM and the ECA server, and the one or more ECs are obtained from the ECA server through the secure channel Here, it is to be noted that, in this case, the HSM may or may not exist. Generally, the HSM can be omitted to reduce the production cost of the terminal device.</p><p id="p-0110" num="0109">Specifically, before the one or more ECs are obtained from the ECA server, the USIM also needs to generate one or more public and private key pairs for applying for the one or more ECs, so as to use the one or more public and private key pairs to obtain the one or more ECs from the ECA server. After the one or more ECs are obtained, the USIM is further configured to store the one or more ECs.</p><p id="p-0111" num="0110">Specifically, a GBA secure channel is established between the USIM and the ECA server by means of the a GBA based on a Universal Integrated Circuit Card (UICC) (GBA_U). It is to be noted that the GBA_U scheme can make the shared session key(s) Ks_NAF or a derived next-level key(s) completely be generated, stored and used by the USIM, and ensure that the secure channel between the V2X terminal device and the ECA server terminates inside the USIM on the terminal side, which eliminates the security risks such as a physical attack brought by the method in the related art that in which the shared session key(s) Ks_NAF or the derived next-level key(s) is/are transmitted to the HSM through an insecure environment.</p><p id="p-0112" num="0111">It is to be noted that the terminal device may also send direct communication service messages. Specifically, the USIM signs a message(s) transmitted directly on PC5 interface with the one or more private keys of the one or more ECs, and sends the signed message(s) transmitted directly on PC5 interface to other devices (e.g., an external device).</p><p id="p-0113" num="0112">That is, in this case, the USIM is used as a local security module to implement the initial security configuration of the V2X terminal device. The USIM generates, stores and uses the session key(s) and the one or more public and private key pairs, and applies for, stores, and uses the one or more ECs. The USIM is a multi-functional security entity at a security level of EAL 4+ and has functions such as random number generation, cryptographic algorithm operation, and secure storage, so it has the capability of securely implementing the initial security configuration of the V2X terminal device.</p><p id="p-0114" num="0113">In the scheme, the V2X terminal device triggers the USIM to generate the one or more public and private key pairs used for applying for the one or more ECs. After that, the V2X terminal device invokes the supported GBA security authentication capability, accesses the ECA server through a mobile cellular network and generates a shared session key(s) Ks_NAF by negotiation with the ECA server, and establishes an initial security trust relationship with the ECA server. The ECA server verifies whether the identity of the V2X terminal device is valid according to the shared session key(s) Ks_NAF. After the verification succeeds, the ECA server establishes a secure transmission channel with the V2X terminal device to ensure the security of data interaction between them. The secure channel may be established using the session key(s) Ks_NAF or the next-level session key(s) derived from the Ks_NAF. The derived key(s) is/are calculated in a secure environment of the USIM.</p><p id="p-0115" num="0114">To sum up, in this case, the main responsibilities of the USIM of the terminal device include:</p><p id="p-0116" num="0115">B11, establishing a GBA secure channel with an ECA server, preferentially, by means of the GBA_U;</p><p id="p-0117" num="0116">B12, generating one or more public and private key pairs for applying for an EC;</p><p id="p-0118" num="0117">B13, interacting with the ECA server through the GBA secure communication channel, and applying for and downloading a digital EC(s) and a certificate(s) of the ECA server; and</p><p id="p-0119" num="0118">B14, storing the one or more ECs and the related one or more public and private key pairs locally and securely.</p><heading id="h-0012" level="1">Second, Applying for the One or more PCs</heading><p id="p-0120" num="0119">It is to be noted that, in this case, the V2X terminal device includes: an AP, a LTE-V2X communication module connected to the AP, and an LTE-Uu communication module connected to the AP. The LTE-Uu communication module includes: a modem and a USIM. Specifically, a secure channel is established between the USIM and the PCA server, and one or more PCs are obtained from the PCA server through the secure channel. Here, it is to be noted that, in this case, the HSM may or may not exist. Generally, the HSM can be omitted to reduce the production cost of the terminal device.</p><p id="p-0121" num="0120">Specifically, before the one or more PCs are obtained from the PCA server, the USIM further needs to generate one or more public and private key pairs for applying for the one or more PCs, so as to use the one or more public and private key pairs to obtain the one or more PCs from the PCA server. After the one or more PCs are obtained, the USIM is further configured to store the one or more PCs.</p><p id="p-0122" num="0121">It is to be noted that the one or more ECs are used for verifying the identity of the V2X terminal device, and signing for protection one or more PC application messages to apply for the one or more PCs. Specifically, the USIM uses the one or more private keys of the one or more ECs to sign the one or more PC application messages, and then obtains the one or more PCs from the PCA server according to the one or more PC application messages. In other words, applying for the one or more PCs must be based on the EC(s), that is, the terminal device has applied for and obtained the one or more ECs before applying for the one or more PCs. After obtaining the one or more ECs securely, the V2X terminal device interacts with the PCA server to further apply for the digital PC(s). In this process, the V2X terminal device should sign a sent PC application request message(s), and verifies the signature of a received PC application response message(s), so as to ensure the authenticity and integrity of the message(s). According to the requirements in protocols in the related art, the one or more PC application messages should be signed with the one or more private keys of the one or more ECs. In order to ensure the security of usage of the one or more private keys of the one or more ECs, the embodiments of the present disclosure propose that the USIM performs the signature protection for the one or more PC application messages, so as to eliminate the potential security risks such as a physical attack brought by the transmission of the one or more private keys of the one or more ECs between the USIM and the HSM. For security and simplicity, the signature of the one or more PC application response messages may also be verified by the USIM.</p><p id="p-0123" num="0122">The USIM has the capability of performing dozens to hundreds times of signature/signature verification processing per second, while the processing of the one or more PC application messages does not have a high real-time requirement, so using the USIM for the above processing can fully meet the requirements on performance of applying for the one or more PCs.</p><p id="p-0124" num="0123">After the V2X terminal device completes the initial security configuration and obtains the digital EC(s), it needs to use the digital EC(s) to further apply for the digital PC(s) to protect the security of the messages transmitted directly on PC5 interface.</p><p id="p-0125" num="0124">According to the protocols in the related art, when applying for the digital PC from the PCA server, the V2X terminal device needs to use the one or more ECs to prove validity of its identity and use the one or more private keys of the one or more ECs to sign the one or more PC application messages, so as to ensure the authenticity of the message(s).</p><p id="p-0126" num="0125">Further, when receiving a feedback message(s) sent by the PCA server (for example, the feedback message(s) is/are a response message(s) to the certificate application), the V2X terminal device needs to use the one or more public keys of the PCA server to verify the signature(s) of the received feedback message(s) to obtain the one or more PCs.</p><p id="p-0127" num="0126">In order to ensure the security of obtaining and configuring of the digital PC(s) and prevent potential physical security risks, all keys should be ensured to be processed in the local secure environment of the V2X terminal device, and the shared session key(s) Ks_NAF generated based on the GBA technology should be prevented from being transmitted between the USIM and other security modules (such as the HSM).</p><p id="p-0128" num="0127">Therefore, the embodiments of the present disclosure proposes that the USIM is used as the local security module to implement the initial security configuration of the V2X terminal device, and the USIM generates, stores and uses the session key(s) and the public and private key pair(s), and applies for, stores, and uses the one or more PCs. The USIM is a multi-functional security entity at security level of EAL 4+ and has functions such as random number generation, cryptographic algorithm operation, and secure storage, so it has the capability of securely implementing the initial security configuration of the V2X terminal device.</p><p id="p-0129" num="0128">In the embodiments of the present disclosure, the V2X terminal device triggers the USIM to generate the one or more public and private key pairs used for applying for the one or more PCs. After that, the V2X terminal device invokes the supported GBA security authentication capability, accesses the ECA server through a mobile cellular network and generates the shared session key(s) Ks_NAF by negotiation with the ECA server, to establish an initial security trust relationship with the PCA server. The PCA server verifies whether the identity of the V2X terminal device is valid according to the shared session key(s) Ks_NAF. After the verification succeeds, the PCA server establishes a secure transmission channel with the V2X terminal device to ensure the security of data interaction between them. The secure channel may be established using the session key(s) Ks_NAF or the next-level session key(s) derived from the Ks_NAF. The derived key(s) is/are calculated in a secure environment of the USIM.</p><p id="p-0130" num="0129">In the embodiments of the present disclosure, the USIM is used to generate the public and private key pair(s) required for applying for the digital PC(s), and a secure communication channel between the USIM and the PCA server is established by means of the GBA_U preferentially. Through the GBA secure channel, the USIM interacts with the PCA server, applies for the digital PC(s), downloads the certificate(s) of the PCA server, and stores the downloaded digital certificate(s) and public and private key pair(s) in the USIM locally and securely.</p><p id="p-0131" num="0130">The one or more PC application messages exchanged between the V2X terminal device and the PCA server should be digitally signed using the one or more private keys of the one or more ECs stored in the USIM.</p><p id="p-0132" num="0131">Considering the low sending rate of the PC5 interface (namely a direct link interface) direct communication service message(s) of the IoV, which is about 10 messages per second, the USIM can meet the requirement for signing the sent message(s) in real time. Therefore, the embodiments of the present disclosure propose to use the USIM to sign for protection the message(s) transmitted directly on PC5 interface, that is, when sending the message(s) transmitted directly on PC5 interface, the AP of the terminal first sends the message(s) to the USIM, and then the USIM sends the message(s) through the LTE-V2X communication module after signing the message(s) with one or more private keys of the one or more PCs. At the same time, in order to reduce the delay of sending the message(s) transmitted directly on PC5 interface, the USIM may send the obtained digital PC(s) to an external module or chip (such as an AP, an HSM, and an LTE-V2X communication module), so that the one or more PCs can be sent along with the message(s) transmitted directly on PC5 interface, thereby realizing the point-to-point distribution of the digital certificate(s) between an automobile and an automobile and between an automobile and an RSU.</p><p id="p-0133" num="0132">The embodiments of the present disclosure may ensure that all keys (such as the one or more private keys of the one or more ECs, the one or more public and private keys of the one or more PCs, the shared session key(s) Ks_NAF generated based on GBA negotiation or the derived next-level key) and cryptography calculation related to applying for the one or more PCs are processed in the secure environment of the USIM, and the GBA secure channel terminates in the secure environment of the USIM. Therefore, the processes of applying for, transmitting, processing and storing the one or more PCs are secure, avoiding the potential physical attack and other security risks in the scheme of the 5GAA. Because the digital PC(s) is/are allowed to be disclosed, sending the one or more PCs to an external module or chip for processing does not affect the security of the scheme.</p><p id="p-0134" num="0133">To sum up, in this case, the main responsibilities of the USIM of the terminal device include:</p><p id="p-0135" num="0134">B21, establishing the GBA secure channel with the PCA server, preferentially, by means of the GBA_U;</p><p id="p-0136" num="0135">B22, generating the one or more public and private key pairs for applying for the one or more PCs;</p><p id="p-0137" num="0136">B23, interacting with the PCA server through the GBA secure communication channel, and applying for and downloading the digital PC(s) and the certificate(s) of the PCA server. In this process, the one or more private keys of the one or more ECs are used to sign the one or more PC application messages, and the one or more public keys of the one or more certificates of the PCA server is used to verify the signature(s) of the received message(s);</p><p id="p-0138" num="0137">B24, storing the digital PC(s) and the related public and private key pair(s) locally and securely;</p><p id="p-0139" num="0138">B25, signing the sent message(s) transmitted directly on PC5 interface with private key(s) corresponding to the PC(s);</p><p id="p-0140" num="0139">B27, sending the PC(s) to the external module or chip; and</p><p id="p-0141" num="0140">B28, signing and verifying the signature(s) of the one or more PC application message(s).</p><p id="p-0142" num="0141">It is to be noted that, in order to facilitate compatibility with an implementation scheme of automobile industry terminal in the related art, the embodiments of the present disclosure also provide a method for securely applying for the certificate(s) based on the GBA technology when the HSM generates, stores and uses the key(s), so as to extend the applicability of the embodiments of the present disclosure. It is to be noted that, in this case, the security module merely implements the USIM functions, that is, the security module is a USIM.</p><p id="p-0143" num="0142">Specifically, after obtaining the one or more digital certificates from the CA server, the USIM sends the one or more digital certificates to the HSM, and the HSM stores the one or more digital certificates. It is also to be noted that before applying for the one or more digital certificates, the HSM needs to first generate the public and private key pair(s) for applying for the digital certificate(s) and store the same; then, the HSM sends the public key(s) for applying for the digital certificate(s) to the USIM, and the USIM uses the public key(s) to apply for and obtain the digital certificate(s) from the CA server. In this case, the HSM sends the direct communication service message(s). Specifically, the HSM first uses the private key(s) of the digital certificate(s) to sign the message(s) transmitted directly on PC5 interface, and then sends the signed message(s) transmitted directly on PC5 interface to other devices.</p><p id="p-0144" num="0143">The specific implementation processes of applying for the one or more ECs and the one or more PCs are respectively described below.</p><heading id="h-0013" level="1">First, Applying for the One or more PCs</heading><p id="p-0145" num="0144">In this case, the HSM is used to generate the one or more public and private key pairs required for applying for the one or more PCs, and the secure communication channel between the USIM and the PCA server is established by means of the GBA_U preferentially. When applying for the one or more PCs, the HSM sends the generated one or more public keys of the one or more digital PCs to the USIM, and then the USIM interacts with the PCA server to apply for the one or more digital PCs and download the one or more certificates of the PCA server. After that, the USIM sends the downloaded one or more PCs and the one or more certificates of the PCA server to the HSM for secure storage. In the process of applying for the one or more certificates, the USIM uses the one or more private keys of the stored one or more ECs to digitally sign the one or more PC application messages.</p><p id="p-0146" num="0145">In order to reduce the delay of sending the message(s) transmitted directly on PC5 interface, the USIM/HSM may also send the obtained one or more PCs to another external module or chip (such as an AP and an LTE-V2X communication module), so that the one or more PCs can be sent along with the message(s) transmitted directly on PC5 interface, thereby realizing the point-to-point distribution of the digital certificate(s) between an automobile and an automobile and between an automobile and an RSU.</p><p id="p-0147" num="0146">When sending the message(s) transmitted directly on PC5 interface, the V2X terminal device sends the message(s) to the HSM, and then the HSM uses the private keys of the digital PCs to sign the message(s) and sends the signed message(s) through the LTE-V2X communication module.</p><p id="p-0148" num="0147">As shown in <figref idref="DRAWINGS">FIG. <b>9</b></figref>, in this case, the public key(s) of the PC(s) is/are transmitted from the HSM to the USIM. Because public key(s) is/are allowed to be disclosed, there is no risk of leakage of the public key(s), which improves the security.</p><p id="p-0149" num="0148">To sum up, in this case, the main responsibilities of the USIM of the terminal device include:</p><p id="p-0150" num="0149">C11, establishing the GBA secure channel with the PCA server, preferentially by means of the GBA_U;</p><p id="p-0151" num="0150">C12, receiving the public key(s) of the PC(s) sent by the HSM, and applying for the digital PC(s) for it;</p><p id="p-0152" num="0151">C13, interacting with the PCA server through the GBA secure communication channel, and applying for and downloading the digital PC(s) and the certificate(s) of the PCA server. In this process, the private key(s) of the EC(s) is/are used to sign the one or more PC application messages, and the public key(s) of the certificate(s) of the PCA server is/are used to verify the signature of the received message(s); and</p><p id="p-0153" num="0152">C14, sending the digital PC(s) and the certificate(s) of the PCA server to the HSM.</p><p id="p-0154" num="0153">To sum up, in this case, the main responsibilities of the HSM of the terminal device include:</p><p id="p-0155" num="0154">C21, generating the one or more public and private key pairs for applying for the one or more PCs;</p><p id="p-0156" num="0155">C22, sending the generated one or more public keys to the USIM for applying for the one or more digital PCs;</p><p id="p-0157" num="0156">C23, storing the received one or more digital PCs and the related one or more public and private key pairs locally and securely; and</p><p id="p-0158" num="0157">C24, using the one or more private keys of the one or more PCs to sign the sent message(s) transmitted directly on PC5 interface.</p><heading id="h-0014" level="1">Second, Applying for the One or more ECs</heading><p id="p-0159" num="0158">In this case, the HSM is used to generate the one or more public and private key pairs required for applying for the one or more ECs, and the secure communication channel between the USIM and the ECA server is established, preferentially by means of the GBA_U. When applying for the one or more ECs, the HSM sends the generated one or more public keys of the one or more digital ECs to the USIM, and then the USIM interacts with the ECA server to apply for the one or more digital ECs and download the one or more certificates of the ECA server. After that, the USIM sends the downloaded one or more ECs and one or more certificates of the ECA server to the HSM for secure storage.</p><p id="p-0160" num="0159">In order to reduce the delay of sending the message(s) transmitted directly on PC5 interface, the USIM/HSM may also send the obtained EC(s) to another external module or chip (such as an AP and an LTE-V2X communication module), so that the one or more ECs can be sent along with the message(s) transmitted directly on PC5 interface, thereby realizing the point-to-point distribution of the digital certificate(s) between an automobile and an automobile and between an automobile and an RSU.</p><p id="p-0161" num="0160">When sending the message(s) transmitted directly on PC5 interface, the V2X terminal device sends the message(s) to the HSM, and then the HSM uses the one or more private keys of the one or more digital ECs to sign the message(s) and sends the message(s) through the LTE-V2X communication module.</p><p id="p-0162" num="0161">In this case, the public key(s) of the EC(s) is/are transmitted from the HSM to the USIM. Because the public key(s) is/are allowed to be disclosed, there is no security risk of leakage of the public key(s), which improves the security.</p><p id="p-0163" num="0162">To sum up, in this case, the main responsibilities of the USIM of the terminal device include:</p><p id="p-0164" num="0163">D11, establishing the GBA secure channel with the ECA server, preferentially by means of the GBA_U;</p><p id="p-0165" num="0164">D12, receiving the one or more public keys of the one or more ECs sent by the HSM, and applying for the one or more ECs for the HSM;</p><p id="p-0166" num="0165">D13, interacting with the ECA server through the GBA secure communication channel, and applying for and downloading the one or more ECs and the one or more certificates of the PCA server; and</p><p id="p-0167" num="0166">D14, sending the one or more ECs and the one or more certificates of the ECA server to the HSM.</p><p id="p-0168" num="0167">To sum up, in this case, the main responsibilities of the HSM of the terminal device include:</p><p id="p-0169" num="0168">D21, generating the one or more public and private key pairs for applying for the one or more ECs;</p><p id="p-0170" num="0169">D22, sending the generated one or more public keys to the USIM for applying for the one or more ECs;</p><p id="p-0171" num="0170">D23, storing the received one or more ECs and related one or more public and private key pairs locally and securely;</p><p id="p-0172" num="0171">D24, using the one or more private keys of the one or more ECs to sign the sent message(s) transmitted directly on PC5 interface.</p><p id="p-0173" num="0172">To sum up, the initial security configuration of the V2X terminal device needs to complete the following operations:</p><p id="p-0174" num="0173">first, generating the one or more public and private key pairs, and preparing for applying for the EC(s)/PC(s);</p><p id="p-0175" num="0174">second, establishing the secure channel to the ECA/PCA server, and using the generated the public key(s) to apply for the EC(s)/PC(s) from the ECA/PCA server;</p><p id="p-0176" num="0175">third, downloading the EC(s)/PC(s) issued by the ECA/PCA server and the digital certificate(s) of the ECA/PCA server; and</p><p id="p-0177" num="0176">fourth, storing for use the one or more public and private key pairs, the one or more digital certificates, etc. locally and securely.</p><p id="p-0178" num="0177">In order to meet the requirements of applying for the certificate(s), the USIM needs to be added with a certificate application function module and related interfaces, and its architecture is shown in <figref idref="DRAWINGS">FIG. <b>10</b></figref>.</p><p id="p-0179" num="0178">An interface IF<b>1</b> and an application function of the USIM are used for implementing a GBA process.</p><p id="p-0180" num="0179">Interfaces IF<b>2</b> and IF<b>3</b> and the certificate application function are used for applying for the EC(s)/PC(s) and signing the PC5 message(s).</p><p id="p-0181" num="0180">An interaction process in the USIM card is as follows.</p><p id="p-0182" num="0181">Applying for the digital certificate(s) (high security):</p><p id="p-0183" num="0182">first, the certificate application module generates a public and private key pair(s), constructs a certificate request message(s), and requests, through the interface IF<b>3</b>, the USIM application module for using the Ks_NAF generated by using the GBA or the derived next-level key(s) to encrypt the certificate request(s);</p><p id="p-0184" num="0183">second, after the certificate request(s) is/are encrypted, the certificate application module sends, through the interface IF<b>2</b>, the protected certificate request(s) to the ECA/PCA server through the AP to apply for the digital EC(s)/PC(s);</p><p id="p-0185" num="0184">third, the digital certificate(s) issued by the ECA/PCA server and the certificate(s) of the ECA/PCA server are sent to the certificate application module through the interface IF<b>2</b>, and the certificate application module invokes the interface IF<b>3</b> to request the USIM application module to use the Ks_NAF or the derived next-level key(s) for decrypting and verifying the message(s);</p><p id="p-0186" num="0185">fourth, if the verification succeeds, the certificate application module stores the decrypted EC(s)/PC(s) and the certificate(s) of the ECA/PCA server securely and feeds back a processing result.</p><p id="p-0187" num="0186">Applying for the digital PC(s) (high compatibility):</p><p id="p-0188" num="0187">first, the certificate application module receives, through the interface IF<b>2</b>, the public key(s) of the PC(s) generated by the external HSM;</p><p id="p-0189" num="0188">second, the certificate application module constructs the certificate request message(s), and requests, through the interface IF<b>3</b>, the USIM application module for using the Ks_NAF generated by using the GBA or the derived next-level key(s) to encrypt the certificate request(s);</p><p id="p-0190" num="0189">third, after the certificate request(s) is/are encrypted, the certificate application module sends, through the interface IF<b>2</b>, the protected certificate request(s) to the PCA server through the AP to apply for the digital PC(s);</p><p id="p-0191" num="0190">fourth, the digital certificate(s) issued by the PCA server and the certificate(s) of the PCA server are sent to the certificate application module through the interface IF<b>2</b>, and the certificate application module invokes the interface IF<b>3</b> to request the USIM application module to use the Ks_NAF or the derived next-level key(s) for decrypting and verifying the message(s); and</p><p id="p-0192" num="0191">fifth, if the verification succeeds, the certificate application module sends the decrypted PC(s) and the certificate(s) of the PCA server to the HSM for secure storage.</p><p id="p-0193" num="0192">It is to be noted that the embodiments of the present disclosure have the following advantages.</p><p id="p-0194" num="0193">First, the present disclosure eliminates the security risks such as a physical attack in the process of initial security configuration of the V2X terminal device based on the GBA, thereby ensuring the security of the whole process of initial security configuration.</p><p id="p-0195" num="0194">Second, the present disclosure maximizes the capability of the USIM as the security module on the V2X terminal device, and results in that the terminal does not have to use the HSM, thereby reducing the cost of terminal implementation while improving the security of the whole system.</p><p id="p-0196" num="0195">Third, the present disclosure can be compatible with the related technical solutions tin the automobile industry in which the HSM is generally used to generate and manage the keys, so it has good compatibility.</p><p id="p-0197" num="0196">Fourth, the present disclosure lays a foundation for ensuring the security of PC5 interface direct communication of the V2X terminal device.</p><p id="p-0198" num="0197">As shown in <figref idref="DRAWINGS">FIG. <b>11</b></figref>, the terminal device according to the embodiments of the present disclosure may include a security module <b>111</b>.</p><p id="p-0199" num="0198">The security module <b>111</b> is configured to: establish a secure channel with a CA server through one or more session keys shared by the security module and the CA server; and</p><p id="p-0200" num="0199">obtain one or more digital certificates from the CA server.</p><p id="p-0201" num="0200">The security module is to implement USIM functions.</p><p id="p-0202" num="0201">Optionally, when the CA server is an ECA server, the one or more digital certificates are one or more ECs, and in order to obtain the one or more digital certificates from the CA server, the security module <b>11</b> is configured to:</p><p id="p-0203" num="0202">generate one or more public and private key pairs for applying for the one or more ECs; and</p><p id="p-0204" num="0203">obtain the one or more ECs from the ECA server with the one or more public and private key pairs.</p><p id="p-0205" num="0204">Optionally, when the CA server is an ECA server, the one or more digital certificates are one or more ECs. After obtaining the one or more digital certificates from the CA server, the security module <b>111</b> is further configured to:</p><p id="p-0206" num="0205">store the one or more ECs by the security module.</p><p id="p-0207" num="0206">Further, when the CA server is a PCA server, the one or more digital certificates are one or more PCs, and in order to obtain the one or more digital certificates from the CA server, the security module <b>11</b> is configured to:</p><p id="p-0208" num="0207">sign one or more PC application messages by using the one or more private keys of the one or more ECs; and</p><p id="p-0209" num="0208">obtain the one or more PCs from the PCA server according to the one or more PC application messages.</p><p id="p-0210" num="0209">Specifically, in order to obtain the one or more PCs from the PCA server, the security module <b>111</b> is configured to:</p><p id="p-0211" num="0210">receive one or more feedback messages sent by the PCA server, verify one or more signatures of the received one or more feedback messages with the one or more public keys of the PCA server, and obtain the one or more PCs.</p><p id="p-0212" num="0211">Further, after obtaining the one or more PCs from the PCA server, the security module <b>111</b> is further configured to:</p><p id="p-0213" num="0212">sign message(s) transmitted directly on PC5 interface with one or more private keys of the one or more PCs; and</p><p id="p-0214" num="0213">send the signed message(s) transmitted directly on PC5 interface to the other device.</p><p id="p-0215" num="0214">Optionally, when the CA server is an ECA server, the one or more digital certificates are one or more ECs. After obtaining the one or more digital certificates from the CA server, the security module <b>111</b> is further configured to:</p><p id="p-0216" num="0215">send the one or more ECs to the HSM.</p><p id="p-0217" num="0216">The HSM is configured to store the one or more ECs.</p><p id="p-0218" num="0217">The HSM is further configured to:</p><p id="p-0219" num="0218">generate the one or more public and private key pairs for applying for the one or more ECs; and</p><p id="p-0220" num="0219">send the one or more public keys for applying for the one or more ECs to the security module.</p><p id="p-0221" num="0220">The security module <b>111</b> is further configured to obtain the one or more ECs from the ECA server with the one or more public keys.</p><p id="p-0222" num="0221">Further, when the CA server is a PCA server, the one or more digital certificates are one or more PCs. In order to obtain the one or more digital certificates from the CA server, the security module <b>11</b> is configured to:</p><p id="p-0223" num="0222">send the one or more PCs to the HSM.</p><p id="p-0224" num="0223">The HSM is configured to store the one or more PCs.</p><p id="p-0225" num="0224">Specifically, the HSM is further configured to generate the one or more public and private key pairs for applying for the one or more PCs.</p><p id="p-0226" num="0225">The HSM is configured to send the one or more public keys for applying for the one or more PCs to the security module.</p><p id="p-0227" num="0226">The security module <b>111</b> is further configured to obtain the one or more PCs from the PCA server with the one or more public keys.</p><p id="p-0228" num="0227">Further, after obtaining the one or more digital certificates from the CA server, the security module <b>111</b> is further configured to:</p><p id="p-0229" num="0228">sign message(s) transmitted directly on PC5 interface with one or more private keys of the one or more PCs; and</p><p id="p-0230" num="0229">send the signed message(s) transmitted directly on PC5 interface to the other devices.</p><p id="p-0231" num="0230">Specifically, a Generic Bootstrapping Architecture (GBA) secure channel is established between the security module and the CA server by means of a GBA based on a Universal Integrated Circuit Card (UICC).</p><p id="p-0232" num="0231">It is to be noted that the terminal device according to the embodiments of the present disclosure can perform the provisioning method, so all implementation modes in the embodiments of the provisioning method are applied to the terminal device and can achieve the same or similar beneficial effects.</p><p id="p-0233" num="0232">The embodiments of the present disclosure also provide a terminal device, which includes a transceiver and a processor.</p><p id="p-0234" num="0233">The processor is configured to:</p><p id="p-0235" num="0234">control a security module to establish a secure channel with a CA server through one or more session keys shared by the security module and the CA server; and</p><p id="p-0236" num="0235">obtain one or more digital certificates from the CA server.</p><p id="p-0237" num="0236">The security module is configured to implement USIM functions.</p><p id="p-0238" num="0237">Optionally, when the CA server is an ECA server, the one or more digital certificates are one or more ECs. In obtaining the one or more digital certificates from the CA server, the processor is configured to:</p><p id="p-0239" num="0238">control the security module to generate one or more public and private key pairs for applying for the one or more ECs; and</p><p id="p-0240" num="0239">obtain the one or more ECs from the ECA server with the one or more public and private key pairs.</p><p id="p-0241" num="0240">Optionally, when the CA server is an ECA server, the one or more digital certificates are one or more ECs. After obtaining the one or more digital certificates from the CA server, the processor is further configured to:</p><p id="p-0242" num="0241">store the one or more ECs by the security module.</p><p id="p-0243" num="0242">Further, when the CA server is an PCA server, the one or more digital certificates are one or more PCs. In obtaining the one or more digital certificates from the CA server, the processor is configured to:</p><p id="p-0244" num="0243">control the security module to sign the one or more PC application messages with the one or more private keys of the one or more ECs; and</p><p id="p-0245" num="0244">obtain the one or more PCs from the PCA server according to the one or more PC application messages.</p><p id="p-0246" num="0245">Specifically, in obtaining the one or more PCs from the PCA server, the processor is configured to:</p><p id="p-0247" num="0246">receive one or more feedback messages sent by the PCA server, verify a signature of the received one or more feedback messages with the one or more public keys of the PCA server, and obtain the one or more PCs.</p><p id="p-0248" num="0247">Further, after obtaining the one or more PCs from the PCA server, the processor is further configured to:</p><p id="p-0249" num="0248">control the security module to sign message(s) transmitted directly on PC5 interface with one or more private keys of the one or more PCs; and</p><p id="p-0250" num="0249">send the signed message(s) transmitted directly on PC5 interface to other devices.</p><p id="p-0251" num="0250">Optionally, when the CA server is an ECA server, the one or more digital certificates are one or more ECs, and after obtaining the one or more digital certificates from the CA server, the processor is further configured to:</p><p id="p-0252" num="0251">control the transceiver to send the one or more ECs to the HSM;</p><p id="p-0253" num="0252">control the HSM to store the one or more ECs.</p><p id="p-0254" num="0253">Further, in obtaining the one or more digital certificates from the CA server, the processor is further configured to:</p><p id="p-0255" num="0254">control the HSM to generate the one or more public and private key pairs for applying for the one or more ECs;</p><p id="p-0256" num="0255">control the HSM to send the one or more public keys for applying for the one or more ECs to the security module; and</p><p id="p-0257" num="0256">control the security module to obtain the one or more ECs from the ECA server with the one or more public keys.</p><p id="p-0258" num="0257">Further, when the CA server is a PCA server, the one or more digital certificates are one or more PCs, and in obtaining the one or more digital certificates from the CA sever, the processor is configured to:</p><p id="p-0259" num="0258">control the transceiver to send the one or more PCs to the HSM;</p><p id="p-0260" num="0259">control the HSM to store the one or more PCs.</p><p id="p-0261" num="0260">Further, in obtaining the one or more digital certificates from the CA sever, the processor is configured to:</p><p id="p-0262" num="0261">control the HSM to generate the one or more public and private key pairs for applying for the one or more PCs;</p><p id="p-0263" num="0262">control the HSM to send the one or more public keys for applying for the one or more PCs to the security module; and</p><p id="p-0264" num="0263">control the security module to obtain the one or more PCs from the PCA server with the one or more public keys.</p><p id="p-0265" num="0264">Further, after obtaining the one or more digital certificates from the CA server, the processor is further configured to:</p><p id="p-0266" num="0265">control the security module to sign the message(s) transmitted directly on PC5 interface with one or more private keys of the one or more PCs; and</p><p id="p-0267" num="0266">send the signed message(s) transmitted directly on PC5 interface to the other devices.</p><p id="p-0268" num="0267">Specifically, a secure channel is established between the security module and the CA server by means of a Generic Bootstrapping Architecture based on a Universal Integrated Circuit Card (UICC) (GBA_U).</p><p id="p-0269" num="0268">The embodiments of the present disclosure also provide a terminal device, which may include: a memory, a processor and a computer program stored in the memory and capable of running on the processor. When executing the program, the processor implements each process in the above embodiments of provisioning transmission method and can achieve the same technical effects. For avoiding repetitions, elaborations are omitted herein.</p><p id="p-0270" num="0269">The embodiments of the present disclosure also provide a computer readable storage medium, in which a computer program is stored. When executed by the processor, the program implements each process in the above embodiments of the provisioning method and can achieve the same technical effects. For avoiding repetitions, elaborations are omitted herein. The computer-readable storage medium is a Read-Only Memory (ROM), a Random Access Memory (RAM), a magnetic disk or an optical disc, etc.</p><p id="p-0271" num="0270">Those skilled in the art should understand that the embodiments of the present application may be provided as a method, a system or a computer program product. Thus, the present application may adopt forms of complete hardware embodiments, complete software embodiments or embodiments integrating software and hardware. Moreover, the present application may adopt the form of a computer program product implemented on one or more computer readable storage media (including, but not limited to, a disk memory and an optical memory) containing computer available program codes.</p><p id="p-0272" num="0271">The present application is described with reference to flowcharts and/or block diagrams of the method, the device (system) and the computer program product according to the embodiments of the present application. It is to be understood that each flow and/or block in the flowcharts and/or the block diagrams and combinations of the flows and/or blocks in the flowcharts and/or the block diagrams may be implemented by computer program instructions. These computer program instructions can be provided to a processor of a general-purpose computer, a special-purpose computer, an embedded processor or other programmable data processing devices to generate a machine, so that instructions which are executed by the processor of the computer or other programmable data processing devices generate a device which is used for implementing the specified functions in one or more flows of the flowchart and/or one or more blocks of the block diagram.</p><p id="p-0273" num="0272">These computer program instructions may also be stored in the computer-readable storage medium which can guide the computer or other programmable data processing devices to work in a particular way, so that the instructions stored in the computer-readable storage medium generate a product including an instruction device. The instruction device implements the specified functions in one or more flows of the flowchart and/or one or more blocks of the block diagram.</p><p id="p-0274" num="0273">These computer program instructions may also be loaded on the computer or other programmable data processing devices, so that a series of operation steps are performed on the computer or other programmable data processing devices to generate the processing implemented by the computer, and the instructions executed on the computer or other programmable data processing devices provide the steps for implementing the specified functions in one or more flows of the flowchart and/or one or more blocks of the block diagram.</p><p id="p-0275" num="0274">Modules, units, subunits or sub-modules may be one or more integrated circuits configured to implement the above method, for example, one or more Application Specific Integrated Circuits (ASICs), or one or more Digital Signal Processors (DSPs), or one or more Field Programmable Gate Arrays (FPGAs), etc. For another example, when one of the above modules is realized by a processing component calling program codes, the processing component can be a general-purpose processor, such as a Central Processing Unit (CPU), or other processors that can call the program codes. For another example, these modules can be integrated together in the form of System-On-a-Chip (SOC).</p><p id="p-0276" num="0275">Terms &#x201c;first&#x201d;, &#x201c;second&#x201d; and the like in the specification and claims of the present disclosure are used to distinguish similar objects and do not have to describe a specific sequence or order. It should be understood that the objects may be exchanged under appropriate circumstances, so that the embodiments of the present application described here may be implemented in an order different from that described or shown here. In addition, terms &#x201c;include&#x201d; and &#x201c;have&#x201d; and any variations thereof are intended to cover non-exclusive inclusions. For example, it is not limited for processes, methods, systems, products or devices containing a series of steps or units to clearly list those steps or units, and other steps or units which are not clearly listed or are inherent to these processes, methods, products or devices may be included instead. In addition, &#x201c;and/or&#x201d; is used in the specification and claims to indicate at least one of the connected objects. For example, A and/or B and/or C indicates seven cases, that is, individual A is included, individual B is included, individual C is included, both A and B exist, both B and C exist, both A and C exist, and A, B, and C all exist. Similarly, the use of &#x201c;at least one of A and B&#x201d; in the specification and claims should be understood as &#x201c;separate A, separate B, or both A and B&#x201d;.</p><p id="p-0277" num="0276">The above is the optional implementation mode of the disclosure. It is to be pointed out that those of ordinary skill in the art may further make a plurality of improvements and embellishments without departing from the principle of the disclosure, and these improvements and embellishments shall fall within the scope of protection of the disclosure.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A provisioning method, applied to a terminal device, the method comprising:<claim-text>establishing, by a security module, a secure channel with a Certificate Authority (CA) server through one or more session keys shared by the security module and the CA server; and</claim-text><claim-text>obtaining one or more digital certificates from the CA server;</claim-text><claim-text>wherein the security module is to implement Universal Subscriber Identity Module (USIM) functions.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The provisioning method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein when the CA server is an Enrollment Certificate Authority (ECA) server, the one or more digital certificates are one or more Enrollment Certificates (ECs), and obtaining the one or more digital certificates from the CA server comprises:<claim-text>generating, by the security module, one or more public and private key pairs for applying for the one or more ECs; and</claim-text><claim-text>obtaining the one or more ECs from the ECA server with the one or more public and private key pairs.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The provisioning method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein when the CA server is an Enrollment Certificate Authority (ECA) server, the one or more digital certificates are one or more Enrollment Certificates (ECs), and after obtaining the one or more digital certificates from the CA server, the method further comprises:<claim-text>storing, by the security module, the one or more ECs.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The provisioning method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein when the CA server is a Pseudonym Certificate Authority (PCA) server, the one or more digital certificates are one or more Pseudonym Certificates (PCs), and obtaining the one or more digital certificates from the CA sever comprises:<claim-text>signing, by the security module, one or more PC application messages with the one or more private keys of one or more Enrollment Certificates (ECs); and</claim-text><claim-text>obtaining, by the security module, one or more PCs from the PCA server according to the one or more PC application messages.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The provisioning method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein obtaining the one or more PCs from the PCA server comprises:<claim-text>receiving one or more feedback messages sent by the PCA server;</claim-text><claim-text>verifying one or more signatures of the received one or more feedback messages with one or more public keys of the PCA server; and</claim-text><claim-text>obtaining the one or more PCs.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The provisioning method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein after obtaining the one or more PCs from the PCA sever, the method further comprises:<claim-text>signing, by the security module, one or more messages transmitted directly on PC5 interface with one or more private keys of the one or more PCs; and</claim-text><claim-text>sending the signed one or more messages to other devices.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The provisioning method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein when the CA server is an Enrollment Certificate Authority (ECA) server, the one or more digital certificates are one or more Enrollment Certificates (ECs), and after obtaining the one or more digital certificates from the CA server, the method further comprises:<claim-text>sending, by the security module, the one or more ECs to a Hardware Security Module (HSM); and</claim-text><claim-text>storing, by the HSM, the one or more ECs.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The provisioning method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein obtaining the one or more digital certificates from the CA server further comprises:<claim-text>generating, by the HSM, one or more public and private key pairs for applying for the one or more ECs;</claim-text><claim-text>sending, by the HSM, the one or more public keys for applying for the one or more ECs to the security module; and</claim-text><claim-text>obtaining, by the security module, the one or more ECs from the ECA server with the one or more public keys.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The provisioning method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein when the CA server is a Pseudonym Certificate Authority (PCA) server, the one or more digital certificates are one or more Pseudonym Certificates (PCs), and obtaining the one or more digital certificates from the CA server comprises:<claim-text>sending, by the security module, the one or more PCs to a Hardware Security Module (HSM); and</claim-text><claim-text>storing, by the HSM, the one or more PCs.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The provisioning method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein obtaining the one or more digital certificates from the CA server comprises:<claim-text>generating, by the HSM, one or more public and private key pairs for applying for the one or more PCs;</claim-text><claim-text>sending, by the HSM, the one or more public keys for applying for the one or more PCs to the security module; and</claim-text><claim-text>obtaining, by the security module, the one or more PCs from the PCA server with the one or more public keys.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The provisioning method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein after obtaining the one or more digital certificates from the CA server, the method further comprises:<claim-text>signing, by the security module, one or more messages transmitted directly on PC5 interface with one or more private keys of the one or more PCs; and</claim-text><claim-text>sending the signed one or more messages to other devices.</claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The provisioning method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein secure channel is established between the security module and the CA server through a Generic Bootstrapping Architecture based on a Universal Integrated Circuit Card (GBA_U).</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. (canceled)</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. A terminal device, comprising a transceiver and a processor;<claim-text>the processor is configured to control a security module to:</claim-text><claim-text>establish a secure channel with a Certificate Authority (CA) server through one or more session keys shared by the security module and the CA server; and</claim-text><claim-text>obtain one or more digital certificates from the CA server;</claim-text><claim-text>wherein the security module is to implement Universal Subscriber Identity Module (USIM) functions.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. A non-transitory computer-readable storage medium, in which a computer program is stored, wherein the computer program, when executed by a processor, implements steps of a provisioning method, comprising:<claim-text>establishing, by an security module in the processor, a secure channel with a Certificate Authority (CA) server through one or more session keys shared by the security module and the CA server; and</claim-text><claim-text>obtaining one or more digital certificates from the CA server;</claim-text><claim-text>wherein the security module is to implement Universal Subscriber Identity Module (USIM) functions.</claim-text></claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The terminal device of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein when the CA server is an Enrollment Certificate Authority (ECA) server, the one or more digital certificates are one or more Enrollment Certificates (ECs), and in order to obtain the one or more digital certificates from the CA server, the processor is configured to control the security module to:<claim-text>generate one or more public and private key pairs for applying for the one or more ECs; and</claim-text><claim-text>obtain the one or more ECs from the ECA server with the one or more public and private key pairs.</claim-text></claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The terminal device of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein when the CA server is an Enrollment Certificate Authority (ECA) server, the one or more digital certificates are one or more Enrollment Certificates (ECs), and after obtaining the one or more digital certificates from the CA server, the processor is further configured to control the security module to store one or more Enrollment Certificates (ECs).</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The terminal device of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein when the CA server is a Pseudonym Certificate Authority (PCA) server, the one or more digital certificates are one or more Pseudonym Certificates (PCs), and in order to obtain the one or more digital certificates from the CA sever, the processor is configured to control the security module to:<claim-text>sign one or more PC application messages with one or more private keys of one or more Enrollment Certificates (ECs); and</claim-text><claim-text>obtain the one or more PCs from the PCA server according to the one or more PC application messages.</claim-text></claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The terminal device of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein in order to obtain the one or more PCs from the PCA server, the processor is configured to control the security module to:<claim-text>receive one or more feedback messages sent by the PCA server;</claim-text><claim-text>verify a signature of the received one or more feedback messages with one or more public keys of the PCA server; and</claim-text><claim-text>obtain the one or more PCs.</claim-text></claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The terminal device of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein after obtaining the one or more PCs from the PCA sever, the processor is further configured to control the security module to:<claim-text>sign one or more messages transmitted directly on PC5 interface with one or more private keys of the one or more PCs; and</claim-text><claim-text>send the signed one or more messages to other devices.</claim-text></claim-text></claim><claim id="CLM-00021" num="00021"><claim-text><b>21</b>. The terminal device of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein when the CA server is an Enrollment Certificate Authority (ECA) server, the one or more digital certificates are one or more Enrollment Certificates (ECs), and after obtaining the one or more digital certificates from the CA server, the processor is further configured to:<claim-text>control the security module to send the one or more ECs to a Hardware Security Module (HSM); and</claim-text><claim-text>control the HSM to store the one or more ECs.</claim-text></claim-text></claim></claims></us-patent-application>