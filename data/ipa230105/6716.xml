<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230006717A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230006717</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17943954</doc-number><date>20220913</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20170101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>B</subclass><main-group>7</main-group><subgroup>0452</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>1</main-group><subgroup>18</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20170101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>B</subclass><main-group>7</main-group><subgroup>0456</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>27</main-group><subgroup>26</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20150101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>B</subclass><main-group>17</main-group><subgroup>391</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20090101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>W</subclass><main-group>88</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>N</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>B</subclass><main-group>7</main-group><subgroup>0452</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>1</main-group><subgroup>1812</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>B</subclass><main-group>7</main-group><subgroup>0456</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>27</main-group><subgroup>2628</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20150115</date></cpc-version-indicator><section>H</section><class>04</class><subclass>B</subclass><main-group>17</main-group><subgroup>3913</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>W</subclass><main-group>88</main-group><subgroup>085</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">USER GROUPING FOR MULTI-USER MIMO</invention-title><us-related-documents><continuation><relation><parent-doc><document-id><country>US</country><doc-number>17491307</doc-number><date>20210930</date></document-id><parent-grant-document><document-id><country>US</country><doc-number>11476903</doc-number></document-id></parent-grant-document></parent-doc><child-doc><document-id><country>US</country><doc-number>17943954</doc-number></document-id></child-doc></relation></continuation><us-provisional-application><document-id><country>US</country><doc-number>63211978</doc-number><date>20210617</date></document-id></us-provisional-application></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Meta Platforms, Inc.</orgname><address><city>Menlo Park</city><state>CA</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Sahin</last-name><first-name>Mustafa Emin</first-name><address><city>Porter Ranch</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Schein</last-name><first-name>Brett Eric</first-name><address><city>Mountain View</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>Tujkovic</last-name><first-name>Djordje</first-name><address><city>Los Altos</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>Gomadam</last-name><first-name>Krishna Srikanth</first-name><address><city>San Jose</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>Huang</last-name><first-name>Po Han</first-name><address><city>Cypress</city><state>TX</state><country>US</country></address></addressbook></inventor><inventor sequence="05" designation="us-only"><addressbook><last-name>Gopala</last-name><first-name>Praveen Kumar</first-name><address><city>Sunnyvale</city><state>CA</state><country>US</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">In one embodiment, a method includes sending SRS received from a plurality of UEs associated with the base station to a DU associated with the base station, receiving information regarding a subset of the plurality of UEs selected for downlink data transmissions for an RBG, multi-user data to be transmitted to UEs in the subset, and identities of selected beams among a plurality of pre-determined beams to be associated with the UEs in the subset from the DU, where each of the plurality of pre-determined beams corresponds to a DFT vector, computing a precoding matrix for the RBG based on IDFT vectors corresponding to the selected beams, preparing pre-coded multi-user data by applying the precoding matrix to the multi-user data, and transmitting the pre-coded multi-user data to the UEs in the subset for the RBG using MIMO technologies.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="199.14mm" wi="158.75mm" file="US20230006717A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="223.44mm" wi="108.80mm" orientation="landscape" file="US20230006717A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="235.80mm" wi="145.63mm" file="US20230006717A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="233.43mm" wi="170.10mm" file="US20230006717A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="235.80mm" wi="145.63mm" file="US20230006717A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="233.43mm" wi="170.10mm" file="US20230006717A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="235.80mm" wi="145.63mm" file="US20230006717A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="233.43mm" wi="170.10mm" file="US20230006717A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="233.43mm" wi="170.10mm" file="US20230006717A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="235.80mm" wi="145.63mm" file="US20230006717A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="233.43mm" wi="170.10mm" file="US20230006717A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="233.43mm" wi="170.10mm" file="US20230006717A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="213.44mm" wi="124.46mm" file="US20230006717A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00013" num="00013"><img id="EMI-D00013" he="213.44mm" wi="132.42mm" file="US20230006717A1-20230105-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00014" num="00014"><img id="EMI-D00014" he="234.27mm" wi="118.36mm" orientation="landscape" file="US20230006717A1-20230105-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00015" num="00015"><img id="EMI-D00015" he="200.83mm" wi="159.85mm" orientation="landscape" file="US20230006717A1-20230105-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00016" num="00016"><img id="EMI-D00016" he="181.27mm" wi="130.56mm" file="US20230006717A1-20230105-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">PRIORITY</heading><p id="p-0002" num="0001">This application is a continuation under 35 U.S.C. &#xa7; 120 of U.S. patent application Ser. No. 17/491,307, filed 30 Sep. 2021, which claims the benefit under 35 U.S.C. &#xa7; 119(e) of U.S. Provisional Patent Application No. 63/211,978, filed 17 Jun. 2021, which is incorporated herein by reference.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">This disclosure generally relates to wireless networks, and in particular, related to Multiple-Input Multiple-Output (MIMO) technologies.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">Multi-user MIMO (MU-MIMO) is a set of MIMO technologies for multipath wireless communication, in which multiple users or terminals, each radioing over one or more antennas, communicate with one another. In contrast, single-user MIMO (SU MIMO) involves a single multi-antenna-equipped user or terminal communicating with precisely one other similarly equipped node. MU-MIMO algorithms enhance MIMO systems where connections among users count greater than one. MU-MIMO may be generalized into two categories: MIMO broadcast channels (MIMO BC) and MIMO multiple-access channels (MIMO MAC) for downlink and uplink situations, respectively. Downlink MU-MIMO is a case where a base station transmits to multiple receivers within the wireless network. Examples of advanced-transmit processing for downlink MU-MIMO are interference-aware precoding and space-division multiple access (SDMA)-based downlink user scheduling. For advanced-transmit processing, channel state information has to be known at the transmitter. Knowledge of channel state information allows throughput improvement. Thus, methods to obtain channel state information at the transmitter become of significant importance. Downlink MU-MIMO systems have an outstanding advantage over SU-MIMO systems, especially when the number of antennas at the transmitter is larger than the number of antennas at each receiver (user). For MU-MIMO, a base station is the transmitter, and a user is the receiver for downlink connections, and vice versa for uplink connections.</p><heading id="h-0004" level="1">SUMMARY OF PARTICULAR EMBODIMENTS</heading><p id="p-0005" num="0004">Particular embodiments described herein relate to systems and methods for optimized user grouping and beamforming for downlink MU-MIMO. In MU-MIMO-capable wireless systems, one of the primary goals may be to maximize the MU-MIMO capacity by placing as many parallel layers of user data as possible in the same Resource Block Group (RBG) in the same Transmit Time Interval (TTI). Reaching a high number of parallel layers may require selecting a set of appropriate users based on their instant channel conditions and performing precoding/beamforming in such a way to orthogonalize transmissions to those users as much as possible. To achieve this goal, the system may perform channel estimation, find the UE channels with the least correlation, group the users accordingly, and calculate the precoder/beamformer. Though most of those tasks may be initially considered L1 tasks, those tasks actually require significant involvement of L2 due to the scheduling aspects of the task. Given the fact that L1, by default, is a stateless entity not keeping any UE state information in its memory, L2 may need to keep UE specific information in its memory including an amount of pending data, served throughput, Quality of Service (QoS) data, and hybrid automatic repeat request (HARQ) information. Therefore, L1/L2 cross layer optimizations may be desired for highly efficient user grouping/beamforming algorithms. When an L1/L2-cross-layer-optimized user grouping and beamforming algorithm is designed, special attention may need to be paid to two aspects. The one may be a computational complexity. Although the computing power of a DU may be significantly higher than the legacy RAN node, the extended amount of computations may be still expensive. Another aspect may be an amount of data to be transferred between the Distributed Unit (DU) and the Radio Unit (RU). The fronthaul between DU and RU has a finite capacity. Thus, the amount of data the L1 conveys to the RU for precoding/beamforming purposes over the fronthaul may be important factor to consider.</p><p id="p-0006" num="0005">In particular embodiments, a DU associated with a gNB may comprise one or more computing devices. An RU associated with the gNB may receive sounding reference signal (SRS) from a plurality of UEs associated with the gNB. The DU may receive the SRS from the RU. The DU may compute an SRS-based channel matrix for each of the plurality of UEs by performing SRS-based downlink channel estimations with the received SRS. The DU may estimate strengths or SNRs for a plurality of pre-determined beams for each of the plurality of UEs by performing a two-dimensional discrete Fourier transform (2D-DFT) on the SRS-based channel matrix for each of the plurality of UEs. The DU may select a subset of the plurality of UEs to which downlink data is to be transmitted for a resource block group (RBG) in a transmission time interval (TTI). The subset may be selected based on the estimated strengths or SNRs of the plurality of pre-determined beams, the CQIs, and downlink traffic information associated with each of the plurality of UEs. The DU may establish a massive MIMO (maMIMO) channel matrix between UEs in the selected subset and transmission antenna ports associated with the gNB based on the SRS-based channel matrices. The DU may compute a precoding matrix for the RBG by performing a regularized zero forcing (RZF) on the maMIMO channel matrix. The DU may determine modulation and coding scheme (MCS) for each of the plurality of UEs for the TTI. The DU may prepare multi-layered UE data for the RBG based on the selected subset of the plurality of UEs, the computed precoding matrix, determined MCS values corresponding to the plurality of UEs, and a number of layers for each of the plurality of UEs. The DU may send the multi-layered UE data and the precoding matrix for the RBG to the RU. The RU may transmit pre-coded multi-layered UE data to UEs in the selected subset for the RBG using MIMO technologies.</p><p id="p-0007" num="0006">In alternative embodiments, an RU associated with a gNB may receive SRS from a plurality of UEs associated with the gNB. The RU may send the SRS to a DU associated with the gNB. The DU may compute an SRS-based channel matrix for each of the plurality of UEs by performing SRS-based downlink channel estimations with the received SRS. The DU may estimate strengths or SNRs for a plurality of pre-determined beams for each of the plurality of UEs by performing a 2D-DFT on the SRS-based channel matrix for each of the plurality of UEs. The DU may select a subset of the plurality of UEs to which downlink data is to be transmitted for an RBG in a TTI. The subset may be selected based on the estimated strengths or SNRs of the plurality of pre-determined beams, the CQIs, and downlink traffic information associated with each of the plurality of UEs. The DU may determine modulation and coding scheme (MCS) for each of the plurality of UEs for the TTI. The DU may associate a beam to each UE in the selected subset for the RBG. The associated beam for a UE is a beam with a highest strength for the UE. The RU may receive information regarding the selected subset, the beams associated with UEs in the selected subset, and data to be transmitted to the UEs in the selected subset from the DU. The RU may establish a maMIMO channel matrix by calculating the IDFT of the DFT vectors corresponding to the beams associated with the UEs in the selected subset. The RU may compute a precoding matrix for the RBG by RZF-ing the maMIMO matrix. The RU may prepare pre-coded multi-user data by applying the precoding matrix to the UE data. The RU may transmit the pre-coded data to the UEs in the selected subset for the RBG using MU-MIMO technologies.</p><p id="p-0008" num="0007">The embodiments disclosed herein are only examples, and the scope of this disclosure is not limited to them. Particular embodiments may include all, some, or none of the components, elements, features, functions, operations, or steps of the embodiments disclosed herein. Embodiments according to the invention are in particular disclosed in the attached claims directed to a method, a storage medium, a system and a computer program product, wherein any feature mentioned in one claim category, e.g. method, can be claimed in another claim category, e.g. system, as well. The dependencies or references back in the attached claims are chosen for formal reasons only. However any subject matter resulting from a deliberate reference back to any previous claims (in particular multiple dependencies) can be claimed as well, so that any combination of claims and the features thereof are disclosed and can be claimed regardless of the dependencies chosen in the attached claims. The subject-matter which can be claimed comprises not only the combinations of features as set out in the attached claims but also any other combination of features in the claims, wherein each feature mentioned in the claims can be combined with any other feature or combination of other features in the claims. Furthermore, any of the embodiments and features described or depicted herein can be claimed in a separate claim and/or in any combination with any embodiment or feature described or depicted herein or with any of the features of the attached claims.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates an example architecture for open Radio Access Network (RAN).</p><p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates an example logical structure for a Regularized Zero Forcing (RZF)-based user grouping for downlink MU-MIMO.</p><p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates an example flow for RZF-based user grouping for downlink MU-MIMO.</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates an example logical structure for a 2D-DFT-based user grouping for downlink MU-MIMO.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates an example flow for 2D-DFT-based user grouping for downlink MU-MIMO.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>6</b></figref> illustrates an example logical structure for a 2D-DFT+RZF-based user grouping for downlink MU-MIMO.</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>7</b></figref> illustrates an example flow for 2D-DFT+RZF-based user grouping for downlink MU-MIMO.</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>8</b></figref> illustrates an example alternative flow for 2D-DFT+RZF-based user grouping for downlink MU-MIMO.</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>9</b></figref> illustrates an example logical structure for computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO.</p><p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. <b>10</b>A</figref> illustrates an example flow for computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO.</p><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>10</b>B</figref> illustrates an alternative example flow for computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO.</p><p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. <b>11</b></figref> illustrates an example method <b>1100</b> for computing a precoding matrix for downlink MU-MIMO by performing an RZF on a MIMO channel matrix between selected UEs and transmission antenna ports associated with the base station.</p><p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. <b>12</b></figref> illustrates an example method <b>1200</b> for computing a precoding matrix for downlink MU-MIMO by performing an RZF on a MIMO channel matrix established based on IDFT vectors corresponding to selected beams.</p><p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. <b>13</b></figref> illustrates example comparisons between the presented L1/L2 cross layer optimization algorithms.</p><p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. <b>14</b></figref> illustrates example results for simulations comparing performance of the algorithms.</p><p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. <b>15</b></figref> illustrates an example computer system.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DESCRIPTION OF EXAMPLE EMBODIMENTS</heading><p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates an example architecture for open RAN. A functional split RAN architecture has been proposed for 5G networks, where each of one or more radio units (RUs) <b>110</b> is connected with a distributed unit (DU) <b>120</b> via a fronthaul <b>115</b>. An RU <b>110</b> may handle the digital front end (DFE) and parts of the physical (PHY) layer as well as the digital beamforming functionality. A DU <b>120</b> may locate close to the RU <b>110</b> and may comprise a layer-2 (L2) module that runs radio link control (RLC) and media access control (MAC) layers and a layer-1 (L1) module that runs parts of the PHY layer. The DU <b>120</b> may include a subset of eNB/gNB functions depending on the functional split option. The DU <b>120</b> may be controlled by a CU <b>130</b>. The CU <b>130</b> may be a centralized unit that runs radio resource control (RRC) and packet data convergence protocol (PDCP) layers. A typical gNB may consist of a CU <b>130</b> and a DU <b>120</b>, which are connected via F-C and F-U interfaces <b>125</b> for control plane and user plane respectively, and one or more RUs <b>110</b>. A CU <b>130</b> with multiple DUs <b>120</b> may support multiple gNBs. The CU <b>130</b> may be connected to the core network <b>140</b> via NG interface <b>135</b>. Functional split between RU <b>110</b> and DU <b>120</b> may bring a number of benefits: (1) cost reduction&#x2014;less intelligent RU may cost less, (2) ability to look at a sector of RUs <b>110</b> at once&#x2014;the ability may help to enable features like Coordinated Multipoint (CoMP), and (3) resource pooling gains&#x2014;computationally expensive processing may be pooled in a DU <b>120</b>. The fronthaul <b>115</b> between the RU <b>110</b> and the DU <b>120</b> may be a bottleneck. In a typical open RAN, fronthaul latency may be constrained to <b>100</b> microsections. Although this disclosure describes a particular RAN architecture, this disclosure contemplates any suitable RAN architecture.</p><heading id="h-0007" level="2">RZF-Based User Grouping</heading><p id="p-0026" num="0025">RZF-based user grouping may require full channel state information in L2 of the DU <b>120</b>. The DU <b>120</b> may perform an almost exhaustive search to find a combination of users that may maximize the capacity. In the process of the search, the DU <b>120</b> may calculate the precoding matrix a number of times. Although the RZF-based user grouping may result in minimum inter-layer interference, and hence, maximized signal-to-interference-and-noise-ratio (SINR), the RZF-based user grouping is a most computationally expensive algorithm.</p><p id="p-0027" num="0026">In particular embodiments, a DU <b>120</b> associated with a gNB, a type of base station, may comprise one or more computing devices. An RU <b>110</b> associated with the gNB may receive SRS from a plurality of user equipments (UEs) associated with the gNB. The DU <b>120</b> may receive the SRS from the RU <b>110</b>. The DU <b>120</b> may compute SRS-based channel estimates for each of the plurality of UEs by performing SRS-based downlink channel estimations with the received SRS. The DU <b>120</b> may select a subset of the plurality of UEs to which downlink data is to be transmitted for an RBG in a TTI. The subset may be selected based on the SRS-based channel estimates, the CQIs, and downlink traffic information associated with each of the plurality of UEs. A process for selecting the subset may also comprise computing an RZF precoding matrix to be used for the RBG. The DU <b>120</b> may determine modulation and coding scheme (MCS) for each of the plurality of UEs for the TTI. The DU <b>120</b> may prepare multi-layered UE data for the RBG based on the selected subset of the plurality of UEs, the computed precoding matrix, determined MCS values corresponding to the plurality of UEs, and a number of layers for each of the plurality of UEs. The DU <b>120</b> may send the multi-layered UE data and the precoding matrix for the RBG to the RU <b>110</b>. The RU <b>110</b> may transmit pre-coded multi-layered UE data to UEs in the selected subset for the RBG using MIMO technologies. Although this disclosure describes performing an RZF-based user grouping for downlink MU-MIMO in a particular manner, this disclosure contemplates performing an RZF-based user grouping for downlink MU-MIMO in any suitable manner.</p><p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. <b>2</b></figref> illustrates an example logical structure for an RZF-based user grouping for downlink MU-MIMO. In particular embodiments, an RU <b>210</b> associated with a gNB may receive SRS from a plurality of UEs <b>205</b> associated with the gNB at step <b>251</b>. At step <b>252</b>, the L1 <b>221</b> of the DU <b>220</b> may receive SRS from the RU <b>210</b>. The RU <b>210</b> may also receive channel quality indicators (CQIs) from the plurality of UEs <b>205</b> at step <b>251</b>. At step <b>252</b>, the L1 <b>221</b> may also receive the CQIs from the RU <b>210</b>.</p><p id="p-0029" num="0028">In particular embodiments, a channel estimation unit <b>221</b>A of the L1 <b>221</b> may compute SRS-based channel estimates for each of the plurality of UEs <b>205</b> by performing SRS-based downlink channel estimations with the received SRS. An SRS-based channel estimate may be represented by a channel matrix. An SRS-based downlink channel estimation may be an SRS-based least squares channel estimation. At step <b>253</b>, the L1 may convey the computed SRS-based channel estimates and CQIs for the plurality of UEs <b>205</b> to an L2 <b>223</b> of the DU <b>220</b> over an L1/L2 interface. Although this disclosure describes calculating channel estimates based on SRS in a particular manner, this disclosure contemplates calculating channel estimates based on SRS in any suitable manner.</p><p id="p-0030" num="0029">In particular embodiments, The L2 <b>223</b> may select a subset of the plurality of UEs <b>205</b> to which downlink data is to be transmitted for a RBG in a TTI. The subset may be selected based on the SRS-based channel estimates, the CQIs, and downlink traffic information associated with each of the plurality of UEs <b>205</b>. The downlink traffic information associated with a UE <b>205</b> may comprise traffic class type, HARQ retransmission information, and any pre-scheduled persistent or semi-persistent transmission allocations. A downlink traffic information unit <b>223</b>D may comprise downlink UE traffic queues and an HARQ module. A process for selecting the subset may also comprise computing a precoding matrix to be used for the RBG. Although this disclosure describes selecting a subset of UEs to which downlink data is to be transmitted for a RBG in a TTI in a particular manner, this disclosure contemplates selecting a subset of UEs to which downlink data is to be transmitted for a RBG in a TTI in any suitable manner.</p><p id="p-0031" num="0030">In particular embodiments, a pre-scheduler unit <b>223</b>A in the L2 <b>223</b> of the DU <b>220</b> may calculate an achievable weighted data rate for each of the plurality of UEs <b>205</b>. To calculate an achievable weighted data rate for each of the plurality of UEs, the pre-scheduler unit <b>223</b>A may calculate a signal-to-noise ratio (SNR) for each of the plurality of UEs <b>205</b> based on the SRS-based channel estimate and the CQI for the UE <b>205</b>. The pre-scheduler unit <b>223</b>A may take traffic class types, HARQ retransmission information, and any pre-scheduled persistent/semi-persistent allocations as per-TTI input from the downlink traffic information unit <b>223</b>D. The pre-scheduler unit <b>223</b>A may also take information regarding scheduled UEs and total pending bytes in the UE traffic queues as per-RBG input from the downlink traffic information unit <b>223</b>D. The pre-scheduler unit <b>223</b>A may determine a scheduling priority per UE <b>205</b> by calculating user selection metrics based on the downlink traffic information including traffic class types, HARQ retransmission information, any pre-scheduled persistent/semi-persistent allocations, scheduled UEs, and total pending bytes in the UE traffic queues. The user selection metrics may comprise proportional fairness metric, max CQI, round robin, or any suitable user selection metric. The pre-scheduler unit <b>223</b>A may determine a weight for each of the plurality of UEs <b>205</b> based on a scheduling priority associated with the UE <b>205</b>. Then, the pre-scheduler unit <b>223</b>A may calculate the achievable weighted data rate for the UE based on the calculated SNR and the determined weight. Although this disclosure describes calculating an achievable weighted data rate for a UE in a particular manner, this disclosure contemplates calculating an achievable weighted data rate for a UE in any suitable manner.</p><p id="p-0032" num="0031">In particular embodiments, a UE grouping/scheduling unit <b>223</b>B in the L2 <b>223</b> of the DU <b>220</b> may determine a subset of the plurality of UEs that maximizes a sum of weighted data rate for the RBG. To determine the subset of the plurality of UEs, the UE grouping/scheduling unit <b>223</b>B may sort the plurality of UEs <b>205</b> based on their corresponding achievable weighted data rate. the UE grouping/scheduling unit <b>223</b>B may prepare an empty candidate set. The UE grouping/scheduling unit <b>223</b>B may move the first UE among the sorted UEs into the candidate set. Then the UE grouping/scheduling unit <b>223</b>B may repeat removing a candidate UE from the sorted UEs and adding the candidate UE into the candidate set when adding the candidate UE to the candidate set is determined to increase a sum of achievable weighted data rate for the candidate set. The UE grouping/scheduling unit <b>223</b>B may stop the repetition when a finishing condition is met. The finishing condition may comprise (1) a size of the candidate set reaches a pre-determined size, or (2) a number of the repetition reaches a pre-determined number. Although this disclosure describes determining a subset of the plurality of UEs that maximizes a sum of weighted data rate for the RBG in a particular manner, this disclosure contemplates determining a subset of the plurality of UEs that maximizes a sum of weighted data rate for the RBG in any suitable manner.</p><p id="p-0033" num="0032">In particular embodiments, the UE grouping/scheduling unit <b>223</b>B may determine the candidate UE among the sorted UEs. The UE grouping/scheduling unit <b>223</b>B may select first k UEs among the sorted UEs. The UE grouping/scheduling unit <b>223</b>B may calculate a sum of correlation values with UEs in the candidate set for each of the selected k UEs. Then, the UE grouping/scheduling unit <b>223</b>B may determine a UE associated with a minimum sum of correlation values as the candidate UE. Although this disclosure describes determining a candidate UE among the sorted UEs in a particular manner, this disclosure contemplates determining a candidate UE among the sorted UEs in any suitable manner.</p><p id="p-0034" num="0033">In particular embodiments, the UE grouping/scheduling unit <b>223</b>B may, in the repetition loop, determine whether adding the candidate UE to the candidate set increases a sum of achievable weighted data rate for the candidate set. The UE grouping/scheduling unit <b>223</b>B may calculate a sum of achievable weighted data rate if the candidate UE is added to the candidate set. First, the UE grouping/scheduling unit <b>223</b>B may define a temporary set with the candidate UE and all the UEs in the candidate set. The UE grouping/scheduling unit <b>223</b>B may determine whether adding the candidate UE to the candidate set increases a sum of achievable weighted data rate for the candidate set by comparing the sum of achievable weighted data rate for the temporary set and a previously-calculated sum of achievable weighted data rate for the candidate set. To calculate the sum of achievable weighted data rate for the temporary set, the UE grouping/scheduling unit <b>223</b>B may calculate a regularized pseudo-inverse of a massive MIMO (maMIMO) channel matrix between UEs in the temporary set and transmission antenna ports associated with the base station. The UE grouping/scheduling unit <b>223</b>B may obtain a regularized zero forcing (RZF) precoding matrix by normalizing the calculated regularized pseudo-inverse of the maMIMO channel matrix. And, the UE grouping/scheduling unit <b>223</b>B may calculate a sum of achievable weighted data rate for the temporary set based on the RZF precoding matrix. Although this disclosure describes determining whether adding the candidate UE to the candidate set increases a sum of achievable weighted data rate for the candidate set in a particular manner, this disclosure contemplates determining whether adding the candidate UE to the candidate set increases a sum of achievable weighted data rate for the candidate set in any suitable manner.</p><p id="p-0035" num="0034">In particular embodiments, a link adaptation unit <b>223</b>C of the L1 <b>223</b> in the DU <b>220</b> may determine modulation and coding scheme (MCS) for each of the plurality of UEs <b>205</b> for the TTI. The link adaptation unit <b>223</b>C may calculate an initial (rough) MCS as a function of an effective SINR (subject to an upper limit set by CQI) for a UE. The link adaptation unit <b>223</b>C may determine a Transport Block (TB) size as a function of the initial MCS and a number of resource blocks allocated to the UE. The link adaptation unit <b>223</b>C may adjust the effective SINR based on HARQ responses acquired from the downlink traffic information unit <b>223</b>D. The link adaptation unit <b>223</b>C may optimize the MCS in a recursive fashion while sticking to a block error rate (BLER) target. Although this disclosure describes determining MCS for each of the plurality of UEs for the TTI in a particular manner, this disclosure contemplates determining MCS for each of the plurality of UEs for the TTI in any suitable manner.</p><p id="p-0036" num="0035">In particular embodiments, at step <b>254</b>, the L2 <b>223</b> may convey the selected subset of UEs, corresponding precoding matrix per RBG to the L1 <b>221</b>. The L2 <b>223</b> may also convey the determined MCS and a number of layers for each of the UEs per TTI to the L1 <b>221</b>.</p><p id="p-0037" num="0036">In particular embodiments, a codeword generation/layer mapping unit <b>221</b>B of the L2 <b>221</b> in the DU <b>220</b> may prepare multi-layered UE data for the RBG based on the selected subset of the plurality of UEs, the computed precoding matrix, the determined MCS values corresponding to the plurality of UEs, and a number of layers for each of the plurality of UEs. For preparing multi-layered UE data for the RBG, the codeword generation/layer mapping unit <b>221</b>B may generate codewords using information associated with the selected subset of the plurality of UEs, the determined MCS value for each of the plurality of UEs, and the number of layers for each of the plurality of UEs. The codeword generation/layer mapping unit <b>221</b>B may map user data onto layers allocated to the UE for each of the plurality of UEs based on the computed precoding matrix. Although this disclosure describes preparing multi-layered UE data for the RBG in a particular manner, this disclosure contemplates preparing multi-layered UE data for the RBG in any suitable manner.</p><p id="p-0038" num="0037">In particular embodiments, at step <b>255</b>, the L1 <b>221</b> of the DU <b>220</b> may send the multi-layered UE data and the precoding matrix for the RBG to the RU <b>210</b> over the fronthaul <b>115</b>.</p><p id="p-0039" num="0038">In particular embodiments, a precoding unit <b>215</b> of the RU <b>210</b> may perform a precoding on the multi-layered UE data using the precoding matrix. The RU <b>210</b> may transmit pre-coded multi-layered UE data to UEs <b>205</b> in the selected subset for the RBG using MU-MIMO technologies. Although this disclosure describes transmitting UE data to the UEs in a selected subset of plurality of UEs using MU-MIMO technologies in a particular manner, this disclosure contemplates transmitting UE data to the UEs in a selected subset of plurality of UEs using MU-MIMO technologies in any suitable manner.</p><p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. <b>3</b></figref> illustrates an example flow for RZF-based user grouping for downlink MU-MIMO. At step <b>305</b>, the RU <b>210</b> may send SRS and CQI received from the plurality of UEs <b>205</b> to the L1 <b>221</b> of the DU <b>220</b>. At step <b>310</b>, the L1 <b>221</b> may perform SRS-based channel estimation. At step <b>315</b>, the L1 <b>221</b> may convey the channel estimates for the plurality of UEs <b>205</b> and CQIs to the L2 <b>223</b> of the DU <b>220</b>. At step <b>320</b>, the L2 <b>223</b> may perform the user grouping/scheduling based on the received channel estimates, CQIs and downlink traffic information. A precoding matrix may be generated in the process of the user grouping/scheduling. The L2 <b>223</b> may also perform a link adaptation procedure. At step <b>325</b>, the L2 <b>223</b> may convey information regarding the scheduled UE, the precoding matrix, determined MCSs, and a number of layers assigned to each UE to the L1 <b>221</b>. At step <b>330</b>, the L1 <b>221</b> may perform the codeword generation and layer mapping. At step <b>335</b>, the L1 <b>221</b> may send the multi-layered UE data and the precoding matrix to the RU <b>210</b>. At step <b>340</b>, the RU <b>210</b> may perform precoding on the multi-layered UE data using the precoding matrix. The RU <b>210</b> may send the pre-coded UE data to the scheduled UEs. Although this disclosure describes a particular flow for downlink MU-MIMO downlink based on the RZF-based user group algorithm, this disclosure contemplates any suitable flow for downlink MU-MIMO downlink based on the RZF-based user group algorithm.</p><heading id="h-0008" level="2">2D-DFT-Based User Grouping</heading><p id="p-0041" num="0040">2D-DFT-based user grouping algorithm may select a subset of UEs whose beams are geometrically distinguishable from each other. The 2D-DFT-based user grouping algorithm may require only the knowledge of beams with highest strength for each of the plurality of UEs. The algorithm may require relatively lower computing power because the 2D-DFT-based user grouping is much simpler than RZF-based user grouping algorithm. The 2D-DFT-based user grouping may be vulnerable to inter-layer interference. When a beams with the highest strength is associated with a UE, the UE may be vulnerable to directions of secondary beams for the UE. When transmissions to other UEs in those directions are made, the UE may experience an interference. Information regarding secondary beams for the UE may also be used for user grouping to mitigate the inter-layer interference.</p><p id="p-0042" num="0041">In particular embodiments, a DU <b>120</b> associated with a gNB may comprise one or more computing devices. An RU <b>110</b> associated with the gNB may receive sounding reference signal (SRS) from a plurality of user equipments (UEs) associated with the gNB. The DU <b>120</b> may receive the SRS from the RU <b>110</b>. The DU <b>120</b> may compute an SRS-based channel matrix for each of the plurality of UEs by performing SRS-based downlink channel estimations with the received SRS. The DU <b>120</b> may estimate strengths or SNRs for a plurality of pre-determined beams for each of the plurality of UEs by performing a 2D-DFT on the SRS-based channel matrix for each of the plurality of UEs. The DU <b>120</b> may select a subset of the plurality of UEs to which downlink data is to be transmitted for an RBG in a TTI. The subset may be selected based on the estimated strengths or SNRs of the plurality of pre-determined beams, the CQIs, and downlink traffic information associated with each of the plurality of UEs. The DU <b>120</b> may determine modulation and coding scheme (MCS) for each of the plurality of UEs for the TTI. The DU <b>120</b> may associate a beam to each UE in the selected subset for the RBG. The associated beam for a UE is a beam with a highest strength for the UE. The DU <b>120</b> may send information regarding the beams associated with UEs in the selected subset and data to be transmitted to the UEs in the selected subset to the RU <b>110</b>. The RU <b>110</b> may transmit beamformed data to the UEs in the selected subset for the RBG using their associated beams. Although this disclosure describes performing a 2D-DFT-based user grouping for downlink MU-MIMO in a particular manner, this disclosure contemplates performing a 2D-DFT-based user grouping for downlink MU-MIMO in any suitable manner.</p><p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. <b>4</b></figref> illustrates an example logical structure for a 2D-DFT-based user grouping for downlink MU-MIMO. In particular embodiments, an RU <b>410</b> associated with a gNB may receive SRS from a plurality of UEs <b>405</b> associated with the gNB at step <b>451</b>. At step <b>452</b>, L1 <b>421</b> of the DU <b>420</b> may receive SRS from the RU <b>410</b>. The RU <b>410</b> may also receive CQIs from the plurality of UEs <b>405</b> at step <b>451</b>. At step <b>452</b>, the L1 <b>421</b> may also receive the CQIs from the RU <b>410</b>.</p><p id="p-0044" num="0043">In particular embodiments, the channel estimation unit <b>421</b>A of the L1 <b>421</b> of the DU <b>420</b> may compute a channel matrix for each of the plurality of UEs <b>405</b> by performing SRS-based downlink channel estimations with the received SRS. The channel matrix may be between an antenna array for the UE <b>405</b> and an antenna array for the gNB. An SRS-based downlink channel estimation may be an SRS-based least squares channel estimation. Although this disclosure describes computing a channel matrix for a UE in a particular manner, this disclosure contemplates computing a channel matrix for a UE in any suitable manner.</p><p id="p-0045" num="0044">In particular embodiments, a 2D-DFT unit <b>421</b>B of the L1 <b>421</b> in the DU <b>420</b> may estimate strengths or SNRs for a plurality of pre-determined beams for each of the plurality of UEs based on the computed channel matrices. The 2D-DFT unit <b>421</b>B may perform a 2D-DFT on the channel matrix for the UE to estimate strengths or SNRs for the plurality of pre-determined beams. As the channel matrix may be between an antenna array for the UE <b>405</b> and an antenna array for the gNB, the antenna array size may play a direct role in a beam resolution. The 2D-DFT unit <b>421</b>B may perform oversampling of DFT vectors for better granularity. At step <b>453</b>, the L1 <b>421</b> may convey indices of one or more beams with highest strength and their corresponding SNRs, and CQI for each of the plurality of UEs <b>405</b> to the L2 <b>423</b> over an L1/L2 interface. Although this disclosure describes estimating strengths or SNRs for a plurality of pre-determined beams for a UE in a particular manner, this disclosure contemplates estimating strengths or SNRs for a plurality of pre-determined beams for a UE in any suitable manner.</p><p id="p-0046" num="0045">In particular embodiments, the L2 <b>423</b> may select a subset of the plurality of UEs to which downlink data is to be transmitted for a RBG in a TTI based on the one or more beams with highest strength and their corresponding SNRs, the CQIs, and downlink traffic information associated with each of the plurality of UEs. The downlink traffic information associated with a UE <b>405</b> may comprise traffic class type, HARQ retransmission information, and any pre-scheduled persistent or semi-persistent transmission allocations. A downlink traffic information unit <b>423</b>C may comprise downlink UE traffic queues and an HARQ module. Although this disclosure describes selecting a subset of the plurality of UEs to which downlink data is to be transmitted for a RBG in a TTI in a particular manner, this disclosure contemplates selecting a subset of the plurality of UEs to which downlink data is to be transmitted for a RBG in a TTI in any suitable manner.</p><p id="p-0047" num="0046">In particular embodiments, a UE grouping/scheduling unit <b>423</b>A of the L2 <b>423</b> in the DU <b>420</b> may calculate a user selection metric for each of the plurality of UEs. In particular embodiments, the user selection metric may comprise a proportional fair metric. Calculating a PF metric for a UE may be based on a beam with the highest strength for the UE and its corresponding SNR, and the downlink traffic information associated with the UE. Although this disclosure describes calculating a user selection metric for a UE in a particular manner, this disclosure contemplates calculating a user selection metric for a UE in any suitable manner.</p><p id="p-0048" num="0047">In particular embodiments, the UE grouping/scheduling unit <b>423</b>A may determine a subset of the plurality of UEs that maximizes an estimated system capacity for the RBG. The UE grouping/scheduling unit <b>423</b>A may sort the plurality of UEs <b>405</b> based on their corresponding PF metrics. The UE grouping/scheduling unit <b>423</b>A may prepare an empty candidate set. The UE grouping/scheduling unit <b>423</b>A may prepare an empty list of reserved beams. The UE grouping/scheduling unit <b>423</b>A may add the first UE among the sorted UEs into the candidate set. The UE grouping/scheduling unit <b>423</b>A may repeat removing a first UE from the sorted UEs as a candidate UE and adding the candidate UE into the candidate set when (1) a beam with the highest strength for the candidate UE is not in the list of reserved beams and (2) adding the candidate UE to the candidate set is determined not to decrease the estimated system capacity for UEs in the candidate set. The UE grouping/scheduling unit <b>423</b>A may stop the repetition when a finishing condition is met. The finishing condition may comprise a size of the candidate set reaches a pre-determined size, or no more UE exists in the sorted UEs. Adding a UE into the candidate set may comprise adding a beam with the highest strength for the UE to the list of reserved beams. Although this disclosure describes determining a subset of the plurality of UEs that maximizes an estimated system capacity for the RBG in a particular manner, this disclosure contemplates determining a subset of the plurality of UEs that maximizes an estimated system capacity for the RBG in any suitable manner.</p><p id="p-0049" num="0048">In particular embodiments, the L1 <b>421</b> may perform oversampling of DFT vectors for better granularity. Although, using an oversampled set of basis vectors may improve system performance due to higher granularity, an oversampled version of DFT vectors does not constitute an orthogonal Eigenbasis. Thus, an energy in one beam may be seen leaking to a number of other beams. In order to avoid interferences caused by an oversampling, the UE grouping/scheduling unit <b>423</b>A may also add k adjacent beams to the beam with the highest strength for the UE to the list of reserved beams, where k may be an oversampling factor. The UE grouping/scheduling unit <b>423</b>A may add k/2 adjacent beams in each side of the beam with the highest strength to the list of reserved beams. Although this disclosure describes avoiding interferences caused by an oversampling in a particular manner, this disclosure contemplates avoiding interferences caused by an oversampling in any suitable manner.</p><p id="p-0050" num="0049">In particular embodiments, most UEs may have secondary beams along with the beam with the highest strength due to multipath. If a transmission is made to a direction that collides with the secondary beams of the UE, the UE may experience an interference. To mitigate this type of interferences, the UE grouping/scheduling unit <b>423</b>A may add n beams with next highest strength for the UE beyond the beam with the highest strength for the UE to the list of reserved beams. The L1 <b>221</b> may need to convey information regarding the n beams for the UE to the L2 <b>223</b> at step <b>453</b> for this feature. Although this disclosure describes avoiding interferences caused by secondary beams in a particular manner, this disclosure contemplates avoiding interferences caused by secondary beams in any suitable manner.</p><p id="p-0051" num="0050">In particular embodiments, the UE grouping/scheduling unit <b>423</b>A may repeatedly determine in a loop whether adding the candidate UE to the candidate set decreases an estimated system capacity for UEs in the candidate set. The UE grouping/scheduling unit <b>423</b>A may define a temporary set as UEs in the candidate set and the candidate UE. The UE grouping/scheduling unit <b>423</b>A may adjust a transmission signal power based on a number of UEs in the temporary set. The UE grouping/scheduling unit <b>423</b>A may calculate an estimated system capacity for UEs in the temporary set based on an assumption that a beam with the highest strength for each UE is used for a transmission. The UE grouping/scheduling unit <b>423</b>A may determine whether adding the candidate UE to the candidate set decreases an estimated system capacity for the candidate set by comparing the estimated system capacity for UEs in the temporary set and a previously-calculated estimated system capacity for UEs in the candidate set. Although this disclosure describes determining whether adding the candidate UE to the candidate set decreases an estimated system capacity for UEs in the candidate set in a particular manner, this disclosure contemplates determining whether adding the candidate UE to the candidate set decreases an estimated system capacity for UEs in the candidate set in any suitable manner.</p><p id="p-0052" num="0051">In particular embodiments, a link adaptation unit <b>423</b>B of the L1 <b>423</b> in the DU <b>420</b> may determine MCS for each of the plurality of UEs <b>405</b> for the TTI. The link adaptation unit <b>423</b>B may calculate an initial MCS as a function of an effective SINR (subject to an upper limit set by CQI) for a UE. The link adaptation unit <b>423</b>B may determine a Transport Block (TB) size as a function of the initial MCS and a number of resource blocks allocated to the UE. The link adaptation unit <b>423</b>B may adjust the effective SINR based on HARQ responses acquired from the downlink traffic information unit <b>423</b>C. The link adaptation unit <b>423</b>B may optimize the MCS in a recursive fashion while sticking to a BLER target. Although this disclosure describes determining MCS for each of the plurality of UEs for the TTI in a particular manner, this disclosure contemplates determining MCS for each of the plurality of UEs for the TTI in any suitable manner.</p><p id="p-0053" num="0052">In particular embodiments, at step <b>454</b>, the L2 <b>423</b> may convey the selected subset of UEs per RBG to the L1 <b>421</b>. The L2 <b>423</b> may also convey the determined MCS and a number of layers for each of the UEs per TTI to the L1 <b>421</b>.</p><p id="p-0054" num="0053">In particular embodiments, a beam mapping unit <b>421</b>C of the L1 <b>421</b> in the DU <b>420</b> may associate a beam to each UE in the selected subset for the RBG. The associated beam for a UE is a beam with the highest strength for the UE. Although this disclosure describes mapping a beam to a UE in a particular manner, this disclosure contemplates mapping a beam to a UE in any suitable manner.</p><p id="p-0055" num="0054">In particular embodiments, at step <b>455</b>, the L1 <b>421</b> may send information regarding the beams associated with UEs in the selected subset and data to be transmitted to the UEs in the selected subset per RBG to RU <b>410</b> over the fronthaul <b>115</b>.</p><p id="p-0056" num="0055">In particular embodiments, a beamforming unit <b>415</b> of the RU <b>410</b> may perform beamforming on the UE data using a beam associated with the UE. The RU <b>410</b> may transmit the beamformed UE data to UEs <b>405</b> in the selected subset for the RBG using MU-MIMO technologies. Although this disclosure describes transmitting UE data to the UEs in a selected subset of plurality of UEs using MU-MIMO technologies in a particular manner, this disclosure contemplates transmitting UE data to the UEs in a selected subset of plurality of UEs using MU-MIMO technologies in any suitable manner.</p><p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates an example flow for 2D-DFT-based user grouping for downlink MU-MIMO. At step <b>505</b>, the RU <b>410</b> may send SRS and CQI received from the plurality of UEs <b>405</b> to the L1 <b>421</b> of the DU <b>420</b>. At step <b>510</b>, the L1 <b>421</b> may compute a channel matrix for each of the plurality of UEs <b>405</b> based on the SRS and estimate strengths or SNRs of a plurality of pre-determined beams for the UE by performing 2D-DFT on the channel matrix. At step <b>515</b>, the L1 <b>421</b> may convey information regarding one or more beams with highest strength for each UE and their corresponding SNRs, and CQIs to the L2 <b>423</b> of the DU <b>420</b>. At step <b>520</b>, the L2 <b>423</b> may perform the user grouping/scheduling based on the received information regarding the one or more beams with highest strength, their corresponding SNRs, CQIs and downlink traffic information for each UE. The L2 <b>423</b> may also perform a link adaptation procedure to determine an MCS value for each UE per TTI. At step <b>525</b>, the L2 <b>423</b> may convey information regarding the scheduled UEs, determined MCS, and a number of layers assigned to each UE to the L1 <b>421</b>. At step <b>530</b>, the L1 <b>421</b> may map a beam to a UE in the scheduled UEs. At step <b>535</b>, the L1 <b>421</b> may send the UE data and an index of the beam associated with each UE to the RU <b>410</b>. At step <b>540</b>, the RU <b>410</b> may perform beamforming on the UE data using the beam associated with the UE. The RU <b>410</b> may send the beamformed UE data to the scheduled UEs. Although this disclosure describes a particular flow for downlink MU-MIMO downlink based on the 2D-DFT-based user group algorithm, this disclosure contemplates any suitable flow for downlink MU-MIMO downlink based on the 2D-DFT-based user group algorithm.</p><heading id="h-0009" level="2">2D-DFT+RZF-Based User Grouping</heading><p id="p-0058" num="0057">2D-DFT+RZF-based user grouping algorithm may select a subset of UEs for an RBG in a same manner with the 2D-DFT-based user grouping algorithm. As L1 of the DU <b>120</b> possesses the full channel information for all the UEs, the L1 may be able to establish a maMIMO channel matrix between the selected UEs and transmission antenna ports associated with the gNB. The L1 may compute a precoding matrix for an RBG by performing an RZF on the maMIMO channel matrix. While user grouping may require relatively simple computations based on the knowledge of beam(s) with highest strength for each UE, the computed precoding matrix may reduce inter-layer interferences. Consequently, the 2D-DFT+RZF-based user grouping algorithm may achieve performance close to the RZF-based user grouping algorithm. The computational load may be mostly on the L1 of the DU.</p><p id="p-0059" num="0058">In particular embodiments, a DU <b>120</b> associated with a gNB may comprise one or more computing devices. An RU <b>110</b> associated with the gNB may receive SRS from a plurality of UEs associated with the gNB. The DU <b>120</b> may receive the SRS from the RU <b>110</b>. The DU <b>120</b> may compute an SRS-based channel matrix for each of the plurality of UEs by performing SRS-based downlink channel estimations with the received SRS. The DU <b>120</b> may estimate strengths or SNRs for a plurality of pre-determined beams for each of the plurality of UEs by performing a 2D-DFT on the SRS-based channel matrix for each of the plurality of UEs. The DU <b>120</b> may select a subset of the plurality of UEs to which downlink data is to be transmitted for an RBG in a TTI. The subset may be selected based on the estimated strengths or SNRs of the plurality of pre-determined beams, the CQIs, and downlink traffic information associated with each of the plurality of UEs. The DU <b>120</b> may establish a maMIMO channel matrix between UEs in the selected subset and transmission antenna ports associated with the gNB based on the SRS-based channel matrices. The DU <b>120</b> may compute a precoding matrix for the RBG by RZF-ing the maMIMO channel matrix. The DU <b>120</b> may determine modulation and coding scheme (MCS) for each of the plurality of UEs for the TTI. The DU <b>120</b> may prepare multi-layered UE data for the RBG based on the selected subset of the plurality of UEs, the computed precoding matrix, determined MCS values corresponding to the plurality of UEs, and a number of layers for each of the plurality of UEs. The DU <b>120</b> may send the multi-layered UE data and the precoding matrix for the RBG to the RU <b>110</b>. The RU <b>110</b> may transmit pre-coded multi-layered UE data to UEs in the selected subset for the RBG using MIMO technologies. Although this disclosure describes performing a 2D-DF T+RZF-based user grouping for downlink MU-MIMO in a particular manner, this disclosure contemplates performing a 2D-DFT+RZF-based user grouping for downlink MU-MIMO in any suitable manner.</p><p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. <b>6</b></figref> illustrates an example logical structure for a 2D-DFT+RZF-based user grouping for downlink MU-MIMO. In particular embodiments, an RU <b>610</b> associated with a gNB may receive SRS from a plurality of UEs <b>605</b> associated with the gNB at step <b>651</b>. At step <b>652</b>, L1 <b>621</b> of the DU <b>620</b> may receive SRS from the RU <b>610</b>. The RU <b>610</b> may also receive CQIs from the plurality of UEs <b>605</b> at step <b>651</b>. At step <b>652</b>, the L1 <b>621</b> may also receive the CQIs from the RU <b>610</b>.</p><p id="p-0061" num="0060">In particular embodiments, the channel estimation unit <b>621</b>A of the L1 <b>621</b> of the DU <b>620</b> may compute a channel matrix for each of the plurality of UEs <b>605</b> by performing SRS-based downlink channel estimations with the received SRS. The channel matrix may be between an antenna array for the UE <b>605</b> and an antenna array for the gNB. An SRS-based downlink channel estimation may be an SRS-based least squares channel estimation. Although this disclosure describes computing a channel matrix for a UE in a particular manner, this disclosure contemplates computing a channel matrix for a UE in any suitable manner.</p><p id="p-0062" num="0061">In particular embodiments, a 2D-DFT unit <b>621</b>B of the L1 <b>621</b> in the DU <b>620</b> may estimate strengths or SNRs for a plurality of pre-determined beams for each of the plurality of UEs <b>605</b> based on the computed channel matrices. The 2D-DFT unit <b>621</b>B may perform a 2D-DFT on the channel matrix for the UE to estimate strengths or SNRs for the plurality of pre-determined beams. Similarly to the 2D-DFT-based user grouping algorithm, the 2D-DFT unit <b>621</b>B may perform oversampling of DFT vectors for better granularity. At step <b>653</b>, the L1 <b>621</b> may convey indices of one or more beams with highest strength and their corresponding SNRs, and CQI for each of the plurality of UEs <b>605</b> to the L2 <b>623</b> over an L1/L2 interface. Although this disclosure describes estimating strengths or SNRs for a plurality of pre-determined beams for a UE in a particular manner, this disclosure contemplates estimating strengths or SNRs for a plurality of pre-determined beams for a UE in any suitable manner.</p><p id="p-0063" num="0062">In particular embodiments, the L2 <b>623</b> may select a subset of the plurality of UEs to which downlink data is to be transmitted for a RBG in a TTI based on the one or more beams with highest strength and their corresponding SNRs, the CQIs, and downlink traffic information associated with each of the plurality of UEs. The downlink traffic information associated with a UE <b>605</b> may comprise traffic class type, HARQ retransmission information, and any pre-scheduled persistent or semi-persistent transmission allocations. A downlink traffic information unit <b>623</b>C may comprise downlink UE traffic queues and an HARQ module. Although this disclosure describes selecting a subset of the plurality of UEs to which downlink data is to be transmitted for a RBG in a TTI in a particular manner, this disclosure contemplates selecting a subset of the plurality of UEs to which downlink data is to be transmitted for a RBG in a TTI in any suitable manner.</p><p id="p-0064" num="0063">In particular embodiments, a UE grouping/scheduling unit <b>623</b>A of the L2 <b>623</b> in the DU <b>620</b> may calculate a user selection metric for each of the plurality of UEs. In particular embodiments, the user selection metric may comprise a proportional fair metric. Calculating a PF metric for a UE may be based on a beam with the highest strength for the UE and its corresponding SNR, and the downlink traffic information associated with the UE. Although this disclosure describes calculating a user selection metric for a UE in a particular manner, this disclosure contemplates calculating a user selection metric for a UE in any suitable manner.</p><p id="p-0065" num="0064">In particular embodiments, the UE grouping/scheduling unit <b>623</b>A may determine a subset of the plurality of UEs that maximizes an estimated system capacity for the RBG. The UE grouping/scheduling unit <b>623</b>A may sort the plurality of UEs <b>605</b> based on their corresponding PF metrics. The UE grouping/scheduling unit <b>623</b>A may prepare an empty candidate set. The UE grouping/scheduling unit <b>623</b>A may prepare an empty list of reserved beams. The UE grouping/scheduling unit <b>623</b>A may add the first UE among the sorted UEs into the candidate set. The UE grouping/scheduling unit <b>623</b>A may repeat removing a first UE from the sorted UEs as a candidate UE and adding the candidate UE into the candidate set when (1) a beam with the highest strength for the candidate UE is not in the list of reserved beams and (2) adding the candidate UE to the candidate set is determined not to decrease the estimated system capacity for UEs in the candidate set. The UE grouping/scheduling unit <b>623</b>A may stop the repetition when a finishing condition is met. The finishing condition may comprise a size of the candidate set reaches a pre-determined size, or no more UE exists in the sorted UEs. Adding a UE into the candidate set may comprise adding a beam with the highest strength for the UE to the list of reserved beams. Although this disclosure describes determining a subset of the plurality of UEs that maximizes an estimated system capacity for the RBG in a particular manner, this disclosure contemplates determining a subset of the plurality of UEs that maximizes an estimated system capacity for the RBG in any suitable manner.</p><p id="p-0066" num="0065">In particular embodiments, the UE grouping/scheduling unit <b>623</b>A may also add k adjacent beams to the beam with the highest strength for the UE to the list of reserved beams in order to avoid interferences caused by an oversampling, where k may be an oversampling factor. The UE grouping/scheduling unit <b>623</b>A may add k/2 adjacent beams in each side of the beam with the highest strength to the list of reserved beams. Although this disclosure describes avoiding interferences caused by an oversampling in a particular manner, this disclosure contemplates avoiding interferences caused by an oversampling in any suitable manner.</p><p id="p-0067" num="0066">In particular embodiments, the UE grouping/scheduling unit <b>623</b>A may add n beams with next highest strength for the UE beyond the beam with the highest strength for the UE to the list of reserved beams to mitigate this type of interferences. The L1 <b>621</b> may need to convey information regarding the n beams for the UE to the L2 <b>623</b> at step <b>653</b> for this feature. Although this disclosure describes avoiding interferences caused by secondary beams in a particular manner, this disclosure contemplates avoiding interferences caused by secondary beams in any suitable manner.</p><p id="p-0068" num="0067">In particular embodiments, the UE grouping/scheduling unit <b>623</b>A may repeatedly determine in a loop whether adding the candidate UE to the candidate set decreases an estimated system capacity for UEs in the candidate set. The UE grouping/scheduling unit <b>623</b>A may define a temporary set as UEs in the candidate set and the candidate UE. The UE grouping/scheduling unit <b>623</b>A may adjust a transmission signal power based on a number of UEs in the temporary set. The UE grouping/scheduling unit <b>623</b>A may calculate an estimated system capacity for UEs in the temporary set based on an assumption that a beam with the highest strength for each UE is used for a transmission. The UE grouping/scheduling unit <b>623</b>A may determine whether adding the candidate UE to the candidate set decreases an estimated system capacity for the candidate set by comparing the estimated system capacity for UEs in the temporary set and a previously-calculated estimated system capacity for UEs in the candidate set. Although this disclosure describes determining whether adding the candidate UE to the candidate set decreases an estimated system capacity for UEs in the candidate set in a particular manner, this disclosure contemplates determining whether adding the candidate UE to the candidate set decreases an estimated system capacity for UEs in the candidate set in any suitable manner.</p><p id="p-0069" num="0068">In particular embodiments, at step <b>654</b>, the L2 <b>623</b> may convey the information regarding the selected subset of the plurality of UEs for the RBG and a number of layers for each of the UEs per TTI to the L1 <b>611</b> over an L1/L2 interface.</p><p id="p-0070" num="0069">In particular embodiments, a precoder calculation unit <b>621</b>C of the L1 in the DU <b>620</b> may compute a precoding matrix for the RBG based on the selected subset. The precoder calculation unit <b>621</b>C may establish a massive MIMO (maMIMO) channel matrix between UEs in the selected subset and transmission antenna ports associated with the gNB based on the SRS-based channel estimates. The precoder calculation unit <b>621</b>C may calculate a regularized pseudo-inverse of the maMIMO channel matrix. The precoder calculation unit <b>621</b>C may obtain a regularized zero forcing (RZF) precoding matrix by normalizing power of each column of the regularized pseudo-inverse of the maMIMO channel matrix. As a result of the normalizing, a transmit power level for each UE in the selected subset may equal to each other. Although this disclosure describes computing a precoding matrix for the RBG in a particular manner, this disclosure computing a precoding matrix for the RBG in any suitable manner.</p><p id="p-0071" num="0070">In particular embodiments, at step <b>655</b>, the L1 <b>621</b> may convey the computed precoding matrix to the L2 <b>623</b> over the L1/L2 interface.</p><p id="p-0072" num="0071">In particular embodiments, a link adaptation unit <b>623</b>B of the L1 <b>623</b> in the DU <b>620</b> may determine MCS for each of the plurality of UEs <b>605</b> for the TTI. The link adaptation unit <b>623</b>B may calculate an initial MCS as a function of an effective SINR (subject to an upper limit set by CQI) for a UE. The link adaptation unit <b>623</b>B may determine a Transport Block (TB) size as a function of the initial MCS and a number of resource blocks allocated to the UE. The link adaptation unit <b>623</b>B may adjust the effective SINR based on HARQ responses acquired from the downlink traffic information unit <b>623</b>C. The link adaptation unit <b>623</b>B may optimize the MCS in a recursive fashion while sticking to a BLER target. Although this disclosure describes determining MCS for each of the plurality of UEs for the TTI in a particular manner, this disclosure contemplates determining MCS for each of the plurality of UEs for the TTI in any suitable manner.</p><p id="p-0073" num="0072">In particular embodiments, at step <b>656</b>, the L2 <b>623</b> may convey the determined MCS for each of the UEs per TTI to the L1 <b>621</b>.</p><p id="p-0074" num="0073">In particular embodiments, a codeword generation/layer mapping unit <b>621</b>D of the L2 <b>621</b> in the DU <b>620</b> may prepare multi-layered UE data for the RBG based on the selected subset of the plurality of UEs, the computed precoding matrix, the determined MCS, and a number of layers for each of the plurality of UEs. For preparing multi-layered UE data for the RBG, the codeword generation/layer mapping unit <b>621</b>D may generate codewords using information associated with the selected subset of the plurality of UEs, the determined MCS value for each of the plurality of UEs, and the number of layers for each of the plurality of UEs. The codeword generation/layer mapping unit <b>621</b>D may map user data onto layers allocated to the UE for each of the plurality of UEs based on the computed precoding matrix. Although this disclosure describes preparing multi-layered UE data for the RBG in a particular manner, this disclosure contemplates preparing multi-layered UE data for the RBG in any suitable manner.</p><p id="p-0075" num="0074">In particular embodiments, at step <b>657</b>, the L1 <b>621</b> may send the multi-layered UE data and the precoding matrix for the RBG to the RU <b>210</b> over the fronthaul <b>115</b>.</p><p id="p-0076" num="0075">In particular embodiments, a precoding unit <b>615</b> of the RU <b>610</b> may perform a precoding on the multi-layered UE data using the precoding matrix. The RU <b>210</b> may transmit pre-coded multi-layered UE data to UEs <b>605</b> in the selected subset for the RBG using MU-MIMO technologies. Although this disclosure describes transmitting UE data to the UEs in a selected subset of plurality of UEs using MU-MIMO technologies in a particular manner, this disclosure contemplates transmitting UE data to the UEs in a selected subset of plurality of UEs using MU-MIMO technologies in any suitable manner.</p><p id="p-0077" num="0076"><figref idref="DRAWINGS">FIG. <b>7</b></figref> illustrates an example flow for 2D-DFT+RZF-based user grouping for downlink MU-MIMO. At step <b>705</b>, the RU <b>610</b> may send SRS and CQI received from the plurality of UEs <b>605</b> to the L1 <b>621</b> of the DU <b>620</b>. At step <b>710</b>, the L1 <b>621</b> may compute a channel matrix for each of the plurality of UEs <b>605</b> based on the SRS and estimate strengths or SNRs of a plurality of pre-determined beams for the UE by performing 2D-DFT on the channel matrix. At step <b>715</b>, the L1 <b>621</b> may convey information regarding one or more beams with highest strength for each UE and their corresponding SNRs, and CQIs to the L2 <b>623</b> of the DU <b>620</b>. At step <b>720</b>, the L2 <b>623</b> may perform the user grouping/scheduling based on the received information regarding the one or more beams with highest strength, their corresponding SNRs, CQIs and downlink traffic information for each UE. At step <b>725</b>, the L2 <b>623</b> may convey information regarding the selected subset of UEs for the RBG and a number of layers for each of the UEs per TTI to the L1 <b>621</b>. At step <b>730</b>, the L1 <b>621</b> may compute a precoding matrix for the RBG based on the selected subset. At step <b>735</b>, the L1 <b>621</b> may convey the computed precoding matrix to the L2 <b>623</b>. At step <b>740</b>, the L2 <b>623</b> may perform a link adaptation procedure to determine MCS for each of the plurality of UEs per TTI. At step <b>745</b>, the L2 <b>623</b> may convey the MCS for each UE per TTI to the L1 <b>621</b>. At step <b>750</b>, the L1 <b>621</b> may perform the codeword generation and layer mapping. At step <b>755</b>, the L1 <b>621</b> may send the multi-layered UE data and the precoding matrix to the RU <b>610</b>. At step <b>760</b>, the RU <b>610</b> may perform precoding on the multi-layered UE data using the precoding matrix. The RU <b>610</b> may send the pre-coded UE data to the UEs in the selected subset for the RBG. Although this disclosure describes a particular flow for downlink MU-MIMO downlink based on the 2D-DFT+RZF-based user group algorithm, this disclosure contemplates any suitable flow for downlink MU-MIMO downlink based on the 2D-DFT+RZF-based user group algorithm.</p><p id="p-0078" num="0077">In the flow illustrated in <figref idref="DRAWINGS">FIG. <b>7</b></figref>, a number of data exchanges are introduced between the L1 <b>621</b> and the L2 <b>623</b> because the L1 calculates the precoding matrix. The number of data exchanges may be reduced at a cost of conveying channel estimates from the L1 to L2. Then, the L2 may have sufficient information for establishing a maMIMO matrix between the UEs in the selected subset and transmission antenna ports associated with the gNB. The L2 may be able to calculate the precoding matrix by performing an RZF on the maMIMO. <figref idref="DRAWINGS">FIG. <b>8</b></figref> illustrates an example alternative flow for 2D-DFT+RZF-based user grouping for downlink MU-MIMO. At step <b>805</b>, the RU <b>610</b> may send SRS and CQI received from the plurality of UEs <b>605</b> to the L1 <b>621</b> of the DU <b>620</b>. At step <b>810</b>, the L1 <b>621</b> may compute a channel matrix for each of the plurality of UEs <b>605</b> based on the SRS and estimate strengths or SNRs of a plurality of pre-determined beams for the UE by performing 2D-DFT on the channel matrix. At step <b>815</b>, the L1 <b>621</b> may convey information regarding one or more beams with highest strength for each UE and their corresponding SNRs, and CQIs to the L2 <b>623</b> of the DU <b>620</b>. The L1 <b>621</b> may also convey the channel estimates (in forms of channel matrices) for all of the plurality of UEs. At step <b>820</b>, the L2 <b>623</b> may perform the user grouping/scheduling based on the received information regarding the one or more beams with highest strength, their corresponding SNRs, CQIs and downlink traffic information for each UE. At step <b>830</b>, the L2 <b>623</b> may compute a precoding matrix for the RBG based on the selected subset by performing an RZF on a maMIMO matrix between the UEs in the selected subset and transmission antenna ports associated with the gNB. At step <b>840</b>, the L2 <b>623</b> may perform a link adaptation procedure to determine MCS for each of the plurality of UEs per TTI. At step <b>845</b>, the L2 <b>623</b> may convey information regarding the selected subset of UEs and the computed precoding matrix for the RBG to the L1 <b>621</b>. The L2 <b>623</b> may also convey the MCS and a number of layers for each UE per TTI to the L1 <b>621</b>. At step <b>850</b>, the L1 <b>621</b> may perform the codeword generation and layer mapping. At step <b>855</b>, the L1 <b>621</b> may send the multi-layered UE data and the precoding matrix to the RU <b>610</b>. At step <b>860</b>, the RU <b>610</b> may perform precoding on the multi-layered UE data using the precoding matrix. The RU <b>610</b> may send the pre-coded UE data to the UEs in the selected subset for the RBG. Although this disclosure describes a particular flow for downlink MU-MIMO downlink based on the 2D-DFT+RZF-based user group algorithm, this disclosure contemplates any suitable flow for downlink MU-MIMO downlink based on the 2D-DFT+RZF-based user group algorithm.</p><heading id="h-0010" level="2">RZF of IDFT</heading><p id="p-0079" num="0078">Another alternative optimization algorithm, Regularized Zero Forcing IDFT vectors of the selected UEs, may select a subset of UEs for an RBG in a same manner with the 2D-DFT-based user grouping algorithm. The RU <b>110</b> may establish a maMIMO channel matrix by conjugating DFT vectors corresponding to the subset of UEs. The conjugated DFT vectors are IDFT vectors of the DFT vectors. The RU <b>110</b> may compute a precoding matrix by performing an RZF on the maMIMO channel matrix. The RU <b>110</b> may not need to have channel knowledge for computing the precoding matrix. The algorithm may be particularly effective for high level of DFT oversampling, where significant level of interference between the DFT vectors of the UEs in the selected subset. A computational complexity for this alternative algorithm may be slightly higher than the 2D-DFT-based user grouping algorithm. Also, the amount of data transferred over the fronthaul <b>115</b> may be identical to that of the 2D-DFT-based user grouping algorithm. But the performance gain may be significant in many cases.</p><p id="p-0080" num="0079">In particular embodiments, an RU <b>110</b> associated with a gNB may comprise one or more computing devices. The RU <b>110</b> may receive SRS from a plurality of UEs associated with the gNB. The RU may send the SRS to a DU <b>120</b> associated with the gNB. The DU <b>120</b> may compute an SRS-based channel matrix for each of the plurality of UEs by performing SRS-based downlink channel estimations with the received SRS. The DU <b>120</b> may estimate strengths or SNRs for a plurality of pre-determined beams for each of the plurality of UEs by performing a 2D-DFT on the SRS-based channel matrix for each of the plurality of UEs. The DU <b>120</b> may select a subset of the plurality of UEs to which downlink data is to be transmitted for an RBG in a TTI. The subset may be selected based on the estimated strengths or SNRs of the plurality of pre-determined beams, the CQIs, and downlink traffic information associated with each of the plurality of UEs. The DU <b>120</b> may determine modulation and coding scheme (MCS) for each of the plurality of UEs for the TTI. The DU <b>120</b> may associate a beam to each UE in the selected subset for the RBG. The associated beam for a UE is a beam with a highest strength for the UE. The RU <b>110</b> may receive information regarding the selected subset, the beams associated with UEs in the selected subset, and data to be transmitted to the UEs in the selected subset from the DU <b>120</b>. The RU <b>110</b> may establish a maMIMO channel matrix by calculating the IDFT of the DFT vectors corresponding to the beams associated with the UEs in the selected subset. The RU <b>110</b> may compute a precoding matrix for the RBG by RZF-ing the maMIMO matrix. The RU <b>110</b> may prepare pre-coded multi-user data by applying the precoding matrix to the UE data. The RU <b>110</b> may transmit the pre-coded data to the UEs in the selected subset for the RBG using MU-MIMO technologies. Although this disclosure describes computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO in a particular manner, this disclosure contemplates computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO in any suitable manner.</p><p id="p-0081" num="0080"><figref idref="DRAWINGS">FIG. <b>9</b></figref> illustrates an example logical structure for computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO. In particular embodiments, an RU <b>910</b> associated with a gNB may receive SRS from a plurality of UEs <b>905</b> associated with the gNB at step <b>951</b>. At step <b>952</b>, L1 <b>921</b> of the DU <b>920</b> may receive SRS from the RU <b>910</b>. The RU <b>910</b> may also receive CQIs from the plurality of UEs <b>905</b> at step <b>951</b>. At step <b>952</b>, the L1 <b>921</b> may also receive the CQIs from the RU <b>910</b>.</p><p id="p-0082" num="0081">In particular embodiments, the channel estimation unit <b>921</b>A of the L1 <b>921</b> of the DU <b>920</b> may compute a channel matrix for each of the plurality of UEs <b>905</b> by performing SRS-based downlink channel estimations with the received SRS. The channel matrix may be between an antenna array for the UE <b>905</b> and an antenna array for the gNB. An SRS-based downlink channel estimation may be an SRS-based least squares channel estimation. Although this disclosure describes computing a channel matrix for a UE in a particular manner, this disclosure contemplates computing a channel matrix for a UE in any suitable manner.</p><p id="p-0083" num="0082">In particular embodiments, a 2D-DFT unit <b>921</b>B of the L1 <b>921</b> in the DU <b>920</b> may estimate strengths or SNRs for a plurality of pre-determined beams for each of the plurality of UEs based on the computed channel matrices. The 2D-DFT unit <b>921</b>B may perform a 2D-DFT on the channel matrix for the UE to estimate strengths or SNRs for the plurality of pre-determined beams. As the channel matrix may be between an antenna array for the UE <b>905</b> and an antenna array for the gNB, the antenna array size may play a direct role in a beam resolution. The 2D-DFT unit <b>921</b>B may perform oversampling of DFT vectors for better granularity. Although this disclosure describes estimating strengths or SNRs for a plurality of pre-determined beams for a UE in a particular manner, this disclosure contemplates estimating strengths or SNRs for a plurality of pre-determined beams for a UE in any suitable manner.</p><p id="p-0084" num="0083">In particular embodiments, at step <b>953</b>, the L1 <b>921</b> may convey indices of one or more beams with highest strength and their corresponding SNRs, and CQI for each of the plurality of UEs <b>905</b> to the L2 <b>923</b> over an L1/L2 interface.</p><p id="p-0085" num="0084">In particular embodiments, the L2 <b>923</b> may select a subset of the plurality of UEs to which downlink data is to be transmitted for a RBG in a TTI based on the one or more beams with highest strength and their corresponding SNRs, the CQIs, and downlink traffic information associated with each of the plurality of UEs. The downlink traffic information associated with a UE <b>905</b> may comprise traffic class type, HARQ retransmission information, and any pre-scheduled persistent or semi-persistent transmission allocations. A downlink traffic information unit <b>923</b>C may comprise downlink UE traffic queues and an HARQ module. Although this disclosure describes selecting a subset of the plurality of UEs to which downlink data is to be transmitted for a RBG in a TTI in a particular manner, this disclosure contemplates selecting a subset of the plurality of UEs to which downlink data is to be transmitted for a RBG in a TTI in any suitable manner.</p><p id="p-0086" num="0085">In particular embodiments, a UE grouping/scheduling unit <b>923</b>A of the L2 <b>923</b> in the DU <b>920</b> may calculate a user selection metric for each of the plurality of UEs. In particular embodiments, the user selection metric may comprise a proportional fair metric. Calculating a PF metric for a UE may be based on a beam with the highest strength for the UE and its corresponding SNR, and the downlink traffic information associated with the UE. Although this disclosure describes calculating a user selection metric for a UE in a particular manner, this disclosure contemplates calculating a user selection metric for a UE in any suitable manner.</p><p id="p-0087" num="0086">In particular embodiments, the UE grouping/scheduling unit <b>923</b>A may determine a subset of the plurality of UEs that maximizes an estimated system capacity for the RBG. The UE grouping/scheduling unit <b>923</b>A may sort the plurality of UEs <b>905</b> based on their corresponding PF metrics. The UE grouping/scheduling unit <b>923</b>A may prepare an empty candidate set. The UE grouping/scheduling unit <b>923</b>A may prepare an empty list of reserved beams. The UE grouping/scheduling unit <b>923</b>A may add the first UE among the sorted UEs into the candidate set. The UE grouping/scheduling unit <b>923</b>A may repeat removing a first UE from the sorted UEs as a candidate UE and adding the candidate UE into the candidate set when (1) a beam with the highest strength for the candidate UE is not in the list of reserved beams and (2) adding the candidate UE to the candidate set is determined not to decrease the estimated system capacity for UEs in the candidate set. The UE grouping/scheduling unit <b>923</b>A may stop the repetition when a finishing condition is met. The finishing condition may comprise a size of the candidate set reaches a pre-determined size, or no more UE exists in the sorted UEs. Adding a UE into the candidate set may comprise adding a beam with the highest strength for the UE to the list of reserved beams. Although this disclosure describes determining a subset of the plurality of UEs that maximizes an estimated system capacity for the RBG in a particular manner, this disclosure contemplates determining a subset of the plurality of UEs that maximizes an estimated system capacity for the RBG in any suitable manner.</p><p id="p-0088" num="0087">In particular embodiments, the UE grouping/scheduling unit <b>923</b>A may also add k adjacent beams to the beam with the highest strength for the UE to the list of reserved beams to avoid interferences caused by an oversampling, where k may be an oversampling factor. The UE grouping/scheduling unit <b>923</b>A may add k/2 adjacent beams in each side of the beam with the highest strength to the list of reserved beams. Although this disclosure describes avoiding interferences caused by an oversampling in a particular manner, this disclosure contemplates avoiding interferences caused by an oversampling in any suitable manner.</p><p id="p-0089" num="0088">In particular embodiments, the UE grouping/scheduling unit <b>923</b>A may add n beams with next highest strength for the UE beyond the beam with the highest strength for the UE to the list of reserved beams to mitigate interferences caused by secondary beams. The L1 <b>221</b> may need to convey information regarding the n beams for the UE to the L2 <b>223</b> at step <b>953</b> for this feature. Although this disclosure describes avoiding interferences caused by secondary beams in a particular manner, this disclosure contemplates avoiding interferences caused by secondary beams in any suitable manner.</p><p id="p-0090" num="0089">In particular embodiments, the UE grouping/scheduling unit <b>923</b>A may repeatedly determine in a loop whether adding the candidate UE to the candidate set decreases an estimated system capacity for UEs in the candidate set. The UE grouping/scheduling unit <b>923</b>A may define a temporary set as UEs in the candidate set and the candidate UE. The UE grouping/scheduling unit <b>923</b>A may adjust a transmission signal power based on a number of UEs in the temporary set. The UE grouping/scheduling unit <b>923</b>A may calculate an estimated system capacity for UEs in the temporary set based on an assumption that a beam with the highest strength for each UE is used for a transmission. The UE grouping/scheduling unit <b>923</b>A may determine whether adding the candidate UE to the candidate set decreases an estimated system capacity for the candidate set by comparing the estimated system capacity for UEs in the temporary set and a previously-calculated estimated system capacity for UEs in the candidate set. Although this disclosure describes determining whether adding the candidate UE to the candidate set decreases an estimated system capacity for UEs in the candidate set in a particular manner, this disclosure contemplates determining whether adding the candidate UE to the candidate set decreases an estimated system capacity for UEs in the candidate set in any suitable manner.</p><p id="p-0091" num="0090">In particular embodiments, a link adaptation unit <b>923</b>B of the L1 <b>923</b> in the DU <b>920</b> may determine MCS for each of the plurality of UEs <b>905</b> for the TTI. The link adaptation unit <b>923</b>B may calculate an initial MCS as a function of an effective SINR (subject to an upper limit set by CQI) for a UE. The link adaptation unit <b>923</b>B may determine a Transport Block (TB) size as a function of the initial MCS and a number of resource blocks allocated to the UE. The link adaptation unit <b>923</b>B may adjust the effective SINR based on HARQ responses acquired from the downlink traffic information unit <b>923</b>C. The link adaptation unit <b>923</b>B may optimize the MCS in a recursive fashion while sticking to a BLER target. Although this disclosure describes determining MCS for each of the plurality of UEs for the TTI in a particular manner, this disclosure contemplates determining MCS for each of the plurality of UEs for the TTI in any suitable manner.</p><p id="p-0092" num="0091">In particular embodiments, at step <b>954</b>, the L2 <b>923</b> may convey the selected subset of UEs per RBG to the L1 <b>921</b>. The L2 <b>923</b> may also convey the determined MCS and a number of layers for each of the UEs per TTI to the L1 <b>921</b>.</p><p id="p-0093" num="0092">In particular embodiments, a beam mapping unit <b>921</b>C of the L1 <b>921</b> in the DU <b>920</b> may associate a beam to each UE in the selected subset for the RBG. The associated beam for a UE is a beam with the highest strength for the UE. Although this disclosure describes mapping a beam to a UE in a particular manner, this disclosure contemplates mapping a beam to a UE in any suitable manner.</p><p id="p-0094" num="0093">In particular embodiments, at step <b>955</b>, the L1 <b>921</b> may send information regarding the selected subset for the RBG, multi-user data to be transmitted to UEs in the selected subset, and identities of selected beams among a plurality of pre-determined beams to be associated with the UEs in the subset to RU <b>910</b> over the fronthaul <b>115</b>. Each of the plurality of pre-determined beams may correspond to a discrete Fourier transform (DFT) vector.</p><p id="p-0095" num="0094">In particular embodiments, a precoding calculation unit <b>913</b> of the RU <b>910</b> may compute a precoding matrix for the RBG based on inverse-DFT (IDFT) vectors corresponding to the selected beams. The precoding calculation unit <b>913</b> may establish a maMIMO channel matrix by calculating the IDFT of the DFT vectors corresponding to the selected beams. Calculating an IDFT of a DFT vector may be calculating a complex conjugate of the DFT vector. The precoding calculation unit <b>913</b> may calculate a regularized pseudo-inverse of the maMIMO channel matrix. The precoding calculation unit <b>913</b> may normalize power of each column of the regularized pseudo-inverse of the maMIMO channel matrix such that a transmit power level for each UE in the selected subset equals to each other. Although this disclosure describes computing a precoding matrix for an RBG based on IDFT vectors corresponding to the selected beams in a particular manner, this disclosure contemplates computing a precoding matrix for an RBG based on IDFT vectors corresponding to the selected beams in any suitable manner.</p><p id="p-0096" num="0095">In particular embodiments, a precoding unit <b>915</b> of the RU <b>910</b> may perform a precoding on the multi-user data using the computed precoding matrix. The RU <b>910</b> may transmit pre-coded multi-user data to UEs <b>205</b> in the selected subset for the RBG using MU-MIMO technologies. Although this disclosure describes transmitting user data to the UEs in a selected subset of plurality of UEs using MU-MIMO technologies in a particular manner, this disclosure contemplates transmitting user data to the UEs in a selected subset of plurality of UEs using MU-MIMO technologies in any suitable manner.</p><p id="p-0097" num="0096"><figref idref="DRAWINGS">FIG. <b>10</b>A</figref> illustrates an example flow for computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO. At step <b>1005</b>A, the RU <b>910</b> may send SRS and CQI received from the plurality of UEs <b>905</b> to the L1 <b>921</b> of the DU <b>920</b>. At step <b>1010</b>A, the L1 <b>921</b> may compute a channel matrix for each of the plurality of UEs <b>905</b> based on the SRS and estimate strengths or SNRs of a plurality of pre-determined beams for the UE by performing 2D-DFT on the channel matrix. At step <b>1015</b>A, the L1 <b>921</b> may convey information regarding one or more beams with highest strength for each UE and their corresponding SNRs, and CQIs to the L2 <b>923</b> of the DU <b>920</b>. At step <b>1020</b>A, the L2 <b>923</b> may perform the user grouping/scheduling based on the received information regarding the one or more beams with highest strength, their corresponding SNRs, CQIs and downlink traffic information for each UE. The L2 <b>923</b> may also perform a link adaptation procedure to determine an MCS value for each UE per TTI. At step <b>1025</b>A, the L2 <b>923</b> may convey information regarding the scheduled UEs, determined MCS, and number of layers assigned to each UE to the L1 <b>921</b>. At step <b>1030</b>A, the L1 <b>921</b> may map a beam to a UE in the scheduled UEs. At step <b>1035</b>A, the L1 <b>921</b> may send the UE data and an index of the beam associated with each UE to the RU <b>910</b>. At step <b>1040</b>A, the RU <b>910</b> may compute a precoding matrix for the RBG based on IDFT vectors corresponding to the selected beams. The RU <b>910</b> may also perform a precoding on the multi-user data using the computed precoding matrix. The RU <b>910</b> may send the pre-coded multi-user data to UEs <b>205</b> in the selected subset for the RBG using MU-MIMO technologies. Although this disclosure describes a particular flow for computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO, this disclosure contemplates any suitable flow for computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO.</p><p id="p-0098" num="0097">While computing the precoding matrix by performing RZF on the IDFT vectors of the selected UEs may reduce the requirement on the bandwidth of the fronthaul, the fronthaul bandwidth can be further preserved when the RU <b>910</b> computes SRS-based channel matrices for the UEs and selects one or more strongest beams for each UE by performing 2D-DFT on each of the SRS-based channel matrix. Then, the RU <b>910</b> may need to send only indices of the one or more strongest beams for each UE instead of whole SRS to the L1 <b>921</b> of the DU <b>920</b>. <figref idref="DRAWINGS">FIG. <b>10</b>B</figref> illustrates an alternative example flow for computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO. In this alternative flow, the RU <b>910</b>, instead of the L1 <b>921</b> of the DU <b>920</b>, may compute a channel matrix for each of the plurality of UEs <b>905</b> and estimate strengths or SNRs of a plurality of pre-determined beams for the UE by performing 2D-DFT on the channel matrix. At step <b>1010</b>B, the RU <b>910</b> may compute a channel matrix for each of the plurality of UEs <b>905</b> based on SRS received from each of the plurality of UEs <b>905</b> and estimate strengths or SNRs of a plurality of pre-determined beams for the UE by performing 2D-DFT on the channel matrix. At step <b>1015</b>B, the RU <b>910</b> may send information regarding one or more beams with highest strength for each UE and their corresponding SNRs, and CQIs to the L1 <b>921</b> of the DU <b>920</b>. The L1 <b>921</b> may forward the received information to the L2 <b>923</b> of the DU <b>920</b>. At step <b>1020</b>B, the L2 <b>923</b> may perform the user grouping/scheduling based on the received information regarding the one or more beams with highest strength, their corresponding SNRs, CQIs and downlink traffic information for each UE. The L2 <b>923</b> may also perform a link adaptation procedure to determine an MCS value for each UE per TTI. At step <b>1025</b>B, the L2 <b>923</b> may convey information regarding the scheduled UEs, determined MCS, and number of layers assigned to each UE to the L1 <b>921</b>. The L1 <b>921</b> may forward the received information to the RU <b>910</b>. At step <b>1030</b>B, the RU <b>910</b> may map a beam to a UE in the scheduled UEs. At step <b>1040</b>B, the RU <b>910</b> may compute a precoding matrix for the RBG based on IDFT vectors corresponding to the selected beams. The RU <b>910</b> may also perform a precoding on the multi-user data using the computed precoding matrix. The RU <b>910</b> may send the pre-coded multi-user data to UEs <b>205</b> in the selected subset for the RBG using MU-MIMO technologies. Although this disclosure describes a particular flow for computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO, this disclosure contemplates any suitable flow for computing a precoding matrix based on IDFT vectors corresponding to UEs in the selected subset for downlink MU-MIMO.</p><p id="p-0099" num="0098"><figref idref="DRAWINGS">FIG. <b>11</b></figref> illustrates an example method <b>1100</b> for computing a precoding matrix for downlink MU-MIMO by performing an RZF on a MIMO channel matrix between selected UEs and transmission antenna ports associated with the base station. The method may begin at step <b>1110</b>, where a DU associated with a base station may receive SRS received from a plurality of UEs associated with the base station from an RU associated with the base station. At step <b>1120</b>, the DU may estimate strengths or SNRs for pre-determined beams for each of the plurality of UEs based on the received SRS. At step <b>1130</b>, the DU may select a subset of the plurality of UEs to which downlink data is to be transmitted for an RBG in a TTI based on the estimated strengths or SNRs of the pre-determined beams for the plurality of UEs. At step <b>1140</b>, the DU may compute a precoding matrix for the RBG based on the selected subset. Computing the precoding matrix may comprise establishing a maMIMO channel matrix between UEs in the selected subset and transmission antenna ports associated with the base station, calculating a regularized pseudo-inverse of the maMIMO channel matrix, and normalizing power of each column of the regularized pseudo-inverse of the maMIMO channel matrix. At step <b>1150</b>, the DU may prepare multi-layered UE data for the RBG based on the selected subset and the computed precoding matrix. At step <b>1160</b>, the DU may send the multi-layered UE data and the precoding matrix for the RBG to the RU. The RU may transmit pre-coded multi-layered UE data to the UEs in the subset using MIMO technologies. Particular embodiments may repeat one or more steps of the method of <figref idref="DRAWINGS">FIG. <b>11</b></figref>, where appropriate. Although this disclosure describes and illustrates particular steps of the method of <figref idref="DRAWINGS">FIG. <b>11</b></figref> as occurring in a particular order, this disclosure contemplates any suitable steps of the method of <figref idref="DRAWINGS">FIG. <b>11</b></figref> occurring in any suitable order. Moreover, although this disclosure describes and illustrates an example method for computing a precoding matrix for downlink MU-MIMO by performing an RZF on a MIMO channel matrix between selected UEs and transmission antenna ports associated with the base station including the particular steps of the method of <figref idref="DRAWINGS">FIG. <b>11</b></figref>, this disclosure contemplates any suitable method for computing a precoding matrix for downlink MU-MIMO by performing an RZF on a MIMO channel matrix between selected UEs and transmission antenna ports associated with the base station including any suitable steps, which may include all, some, or none of the steps of the method of <figref idref="DRAWINGS">FIG. <b>11</b></figref>, where appropriate. Furthermore, although this disclosure describes and illustrates particular components, devices, or systems carrying out particular steps of the method of <figref idref="DRAWINGS">FIG. <b>11</b></figref>, this disclosure contemplates any suitable combination of any suitable components, devices, or systems carrying out any suitable steps of the method of <figref idref="DRAWINGS">FIG. <b>11</b></figref>.</p><p id="p-0100" num="0099"><figref idref="DRAWINGS">FIG. <b>12</b></figref> illustrates an example method <b>1200</b> for computing a precoding matrix for downlink MU-MIMO by performing an RZF on a MIMO channel matrix established based on IDFT vectors corresponding to selected beams. The method may begin at step <b>1210</b>, where an RU may send SRS received from a plurality of UEs associated with the base station to a DU associated with the base station. At step <b>1220</b>, the RU may receive information regarding a subset of the plurality of UEs selected for downlink data transmissions for an RBG, multi-user data to be transmitted to UEs in the subset, and identities of selected beams among a plurality of pre-determined beams to be associated with the UEs in the subset from the DU. Each of the plurality of pre-determined beams may correspond to a DFT vector. At step <b>1230</b>, the RU may compute a precoding matrix for the RBG based on IDFT vectors corresponding to the selected beams. At step <b>1240</b>, the RU may prepare pre-coded multi-user data by applying the precoding matrix to the multi-user data. At <b>1250</b>, the RU may transmit the pre-coded multi-user data to the UEs in the subset for the RBG using Multiple-Input Multiple-Output (MIMO) technologies. Particular embodiments may repeat one or more steps of the method of <figref idref="DRAWINGS">FIG. <b>12</b></figref>, where appropriate. Although this disclosure describes and illustrates particular steps of the method of <figref idref="DRAWINGS">FIG. <b>12</b></figref> as occurring in a particular order, this disclosure contemplates any suitable steps of the method of <figref idref="DRAWINGS">FIG. <b>12</b></figref> occurring in any suitable order. Moreover, although this disclosure describes and illustrates an example method for computing a precoding matrix for downlink MU-MIMO by performing an RZF on a MIMO channel matrix established based on IDFT vectors corresponding to selected beams including the particular steps of the method of <figref idref="DRAWINGS">FIG. <b>12</b></figref>, this disclosure contemplates any suitable method for computing a precoding matrix for downlink MU-MIMO by performing an RZF on a MIMO channel matrix established based on IDFT vectors corresponding to selected beams including any suitable steps, which may include all, some, or none of the steps of the method of <figref idref="DRAWINGS">FIG. <b>12</b></figref>, where appropriate. Furthermore, although this disclosure describes and illustrates particular components, devices, or systems carrying out particular steps of the method of <figref idref="DRAWINGS">FIG. <b>12</b></figref>, this disclosure contemplates any suitable combination of any suitable components, devices, or systems carrying out any suitable steps of the method of <figref idref="DRAWINGS">FIG. <b>12</b></figref>.</p><heading id="h-0011" level="2">Evaluation</heading><p id="p-0101" num="0100"><figref idref="DRAWINGS">FIG. <b>13</b></figref> illustrates example comparisons between the presented L1/L2 cross layer optimization algorithms. The values are computed based on a set of assumptions applied to all the algorithms. For calculations of required complex multiplier-accumulators (CMACs), a number of antenna ports at the base station is assumed to be 64. A size of sliding window that determines a set of potential candidates is assumed to be 16. A number of active UEs associated with the base station is assumed to be 64. A number of UEs to be selected in a subset is assumed to be 16. And, a median number of iterations per layer is assumed to be 3. The RZF-based user grouping algorithm requires the most computations while the 2D-IDF-based user grouping algorithm requires the least computations. Both 2D-DFT+RZF-based algorithm and the RZF of IDFT algorithm require slightly more computations than the 2D-IDF-based user grouping algorithm. Considering that both 2D-DFT+RZF-based algorithm and the RZF of IDFT algorithm are based on the 2D-IDF-based user grouping algorithm, their own computational load would not be high. As for the maximum fronthaul data rate for the algorithms, comparison, the RZF-based user grouping algorithm and the 2D-DFT+RZF-based algorithm requires significantly more fronthaul bandwidth compared to the 2D-IDF-based user grouping algorithm and the RZF of IDFT algorithm. For the RZF-based user grouping algorithm and the 2D-DFT+RZF-based algorithm, the L1 of the DU transmits entire precoder information over the fronthaul while the L1 of the DU, for the 2D-IDF-based user grouping algorithm and the RZF of IDFT algorithm, transmits only index of the selected beam for a UE.</p><p id="p-0102" num="0101"><figref idref="DRAWINGS">FIG. <b>14</b></figref> illustrates example results for simulations comparing performance of the algorithms. In the simulations, clustered delay line (CDL) channel models are employed where each channel path has a certain delay, path gain, as well as an azimuth and elevation of arrival. For the results presented in <figref idref="DRAWINGS">FIG. <b>14</b></figref>, CDL-A channel model is utilized. CDF curves indicating the average UE throughput obtained using the <b>4</b> algorithms disclosed in this application are plotted. The plots in <figref idref="DRAWINGS">FIG. <b>14</b></figref> are obtained for <b>30</b>dB SNR. A plot <b>1401</b> indicates the average UE throughput for the 2D-DFT-based user grouping algorithm without oversampling. A plot <b>1402</b> indicates the average UE throughput for 2D-DFT-based user grouping algorithm with azimuthal oversampling of 4. A plot <b>1403</b> indicates the average UE throughput for RZF of IDFT algorithm with azimuthal oversampling of 8. A plot <b>1404</b> indicates the average UE throughput for 2D DFT+RZF algorithm. A plot <b>1405</b> indicates the average UE throughput for the RZF-based user grouping algorithm. The 2D-DFT+RZF algorithm achieves comparable throughput to the RZF-based user grouping algorithm while requires much less computations. The RZF of IDFT algorithm requires significantly less computations and smaller bandwidth for the fronthaul between the DU and the RU compared to the RZF-based user grouping algorithm. Considering those resource requirements, the RZF of IDFT algorithm may be useful in certain circumstances.</p><heading id="h-0012" level="2">Systems and Methods</heading><p id="p-0103" num="0102"><figref idref="DRAWINGS">FIG. <b>15</b></figref> illustrates an example computer system <b>1500</b>. In particular embodiments, one or more computer systems <b>1500</b> perform one or more steps of one or more methods described or illustrated herein. In particular embodiments, one or more computer systems <b>1500</b> provide functionality described or illustrated herein. In particular embodiments, software running on one or more computer systems <b>1500</b> performs one or more steps of one or more methods described or illustrated herein or provides functionality described or illustrated herein. Particular embodiments include one or more portions of one or more computer systems <b>1500</b>. Herein, reference to a computer system may encompass a computing device, and vice versa, where appropriate. Moreover, reference to a computer system may encompass one or more computer systems, where appropriate.</p><p id="p-0104" num="0103">This disclosure contemplates any suitable number of computer systems <b>1500</b>. This disclosure contemplates computer system <b>1500</b> taking any suitable physical form. As example and not by way of limitation, computer system <b>1500</b> may be an embedded computer system, a system-on-chip (SOC), a single-board computer system (SBC) (such as, for example, a computer-on-module (COM) or system-on-module (SOM)), a desktop computer system, a laptop or notebook computer system, an interactive kiosk, a mainframe, a mesh of computer systems, a mobile telephone, a personal digital assistant (PDA), a server, a tablet computer system, an augmented/virtual reality device, or a combination of two or more of these. Where appropriate, computer system <b>1500</b> may include one or more computer systems <b>1500</b>; be unitary or distributed; span multiple locations; span multiple machines; span multiple data centers; or reside in a cloud, which may include one or more cloud components in one or more networks. Where appropriate, one or more computer systems <b>1500</b> may perform without substantial spatial or temporal limitation one or more steps of one or more methods described or illustrated herein. As an example and not by way of limitation, one or more computer systems <b>1500</b> may perform in real time or in batch mode one or more steps of one or more methods described or illustrated herein. One or more computer systems <b>1500</b> may perform at different times or at different locations one or more steps of one or more methods described or illustrated herein, where appropriate.</p><p id="p-0105" num="0104">In particular embodiments, computer system <b>1500</b> includes a processor <b>1502</b>, memory <b>1504</b>, storage <b>1506</b>, an input/output (I/O) interface <b>1508</b>, a communication interface <b>1510</b>, and a bus <b>1512</b>. Although this disclosure describes and illustrates a particular computer system having a particular number of particular components in a particular arrangement, this disclosure contemplates any suitable computer system having any suitable number of any suitable components in any suitable arrangement.</p><p id="p-0106" num="0105">In particular embodiments, processor <b>1502</b> includes hardware for executing instructions, such as those making up a computer program. As an example and not by way of limitation, to execute instructions, processor <b>1502</b> may retrieve (or fetch) the instructions from an internal register, an internal cache, memory <b>1504</b>, or storage <b>1506</b>; decode and execute them; and then write one or more results to an internal register, an internal cache, memory <b>1504</b>, or storage <b>1506</b>. In particular embodiments, processor <b>1502</b> may include one or more internal caches for data, instructions, or addresses. This disclosure contemplates processor <b>1502</b> including any suitable number of any suitable internal caches, where appropriate. As an example and not by way of limitation, processor <b>1502</b> may include one or more instruction caches, one or more data caches, and one or more translation lookaside buffers (TLBs). Instructions in the instruction caches may be copies of instructions in memory <b>1504</b> or storage <b>1506</b>, and the instruction caches may speed up retrieval of those instructions by processor <b>1502</b>. Data in the data caches may be copies of data in memory <b>1504</b> or storage <b>1506</b> for instructions executing at processor <b>1502</b> to operate on; the results of previous instructions executed at processor <b>1502</b> for access by subsequent instructions executing at processor <b>1502</b> or for writing to memory <b>1504</b> or storage <b>1506</b>; or other suitable data. The data caches may speed up read or write operations by processor <b>1502</b>. The TLBs may speed up virtual-address translation for processor <b>1502</b>. In particular embodiments, processor <b>1502</b> may include one or more internal registers for data, instructions, or addresses. This disclosure contemplates processor <b>1502</b> including any suitable number of any suitable internal registers, where appropriate. Where appropriate, processor <b>1502</b> may include one or more arithmetic logic units (ALUs); be a multi-core processor; or include one or more processors <b>1502</b>. Although this disclosure describes and illustrates a particular processor, this disclosure contemplates any suitable processor.</p><p id="p-0107" num="0106">In particular embodiments, memory <b>1504</b> includes main memory for storing instructions for processor <b>1502</b> to execute or data for processor <b>1502</b> to operate on. As an example and not by way of limitation, computer system <b>1500</b> may load instructions from storage <b>1506</b> or another source (such as, for example, another computer system <b>1500</b>) to memory <b>1504</b>. Processor <b>1502</b> may then load the instructions from memory <b>1504</b> to an internal register or internal cache. To execute the instructions, processor <b>1502</b> may retrieve the instructions from the internal register or internal cache and decode them. During or after execution of the instructions, processor <b>1502</b> may write one or more results (which may be intermediate or final results) to the internal register or internal cache. Processor <b>1502</b> may then write one or more of those results to memory <b>1504</b>. In particular embodiments, processor <b>1502</b> executes only instructions in one or more internal registers or internal caches or in memory <b>1504</b> (as opposed to storage <b>1506</b> or elsewhere) and operates only on data in one or more internal registers or internal caches or in memory <b>1504</b> (as opposed to storage <b>1506</b> or elsewhere). One or more memory buses (which may each include an address bus and a data bus) may couple processor <b>1502</b> to memory <b>1504</b>. Bus <b>1512</b> may include one or more memory buses, as described below. In particular embodiments, one or more memory management units (MMUs) reside between processor <b>1502</b> and memory <b>1504</b> and facilitate accesses to memory <b>1504</b> requested by processor <b>1502</b>. In particular embodiments, memory <b>1504</b> includes random access memory (RAM). This RAM may be volatile memory, where appropriate. Where appropriate, this RAM may be dynamic RAM (DRAM) or static RAM (SRAM). Moreover, where appropriate, this RAM may be single-ported or multi-ported RAM. This disclosure contemplates any suitable RAM. Memory <b>1504</b> may include one or more memories <b>1504</b>, where appropriate. Although this disclosure describes and illustrates particular memory, this disclosure contemplates any suitable memory.</p><p id="p-0108" num="0107">In particular embodiments, storage <b>1506</b> includes mass storage for data or instructions. As an example and not by way of limitation, storage <b>1506</b> may include a hard disk drive (HDD), a floppy disk drive, flash memory, an optical disc, a magneto-optical disc, magnetic tape, or a Universal Serial Bus (USB) drive or a combination of two or more of these. Storage <b>1506</b> may include removable or non-removable (or fixed) media, where appropriate. Storage <b>1506</b> may be internal or external to computer system <b>1500</b>, where appropriate. In particular embodiments, storage <b>1506</b> is non-volatile, solid-state memory. In particular embodiments, storage <b>1506</b> includes read-only memory (ROM). Where appropriate, this ROM may be mask-programmed ROM, programmable ROM (PROM), erasable PROM (EPROM), electrically erasable PROM (EEPROM), electrically alterable ROM (EAROM), or flash memory or a combination of two or more of these. This disclosure contemplates mass storage <b>1506</b> taking any suitable physical form. Storage <b>1506</b> may include one or more storage control units facilitating communication between processor <b>1502</b> and storage <b>1506</b>, where appropriate. Where appropriate, storage <b>1506</b> may include one or more storages <b>1506</b>. Although this disclosure describes and illustrates particular storage, this disclosure contemplates any suitable storage.</p><p id="p-0109" num="0108">In particular embodiments, I/O interface <b>1508</b> includes hardware, software, or both, providing one or more interfaces for communication between computer system <b>1500</b> and one or more I/O devices. Computer system <b>1500</b> may include one or more of these I/O devices, where appropriate. One or more of these I/O devices may enable communication between a person and computer system <b>1500</b>. As an example and not by way of limitation, an I/O device may include a keyboard, keypad, microphone, monitor, mouse, printer, scanner, speaker, still camera, stylus, tablet, touch screen, trackball, video camera, another suitable I/O device or a combination of two or more of these. An I/O device may include one or more sensors. This disclosure contemplates any suitable I/O devices and any suitable I/O interfaces <b>1508</b> for them. Where appropriate, I/O interface <b>1508</b> may include one or more device or software drivers enabling processor <b>1502</b> to drive one or more of these I/O devices. I/O interface <b>1508</b> may include one or more I/O interfaces <b>1508</b>, where appropriate. Although this disclosure describes and illustrates a particular I/O interface, this disclosure contemplates any suitable I/O interface.</p><p id="p-0110" num="0109">In particular embodiments, communication interface <b>1510</b> includes hardware, software, or both providing one or more interfaces for communication (such as, for example, packet-based communication) between computer system <b>1500</b> and one or more other computer systems <b>1500</b> or one or more networks. As an example and not by way of limitation, communication interface <b>1510</b> may include a network interface controller (NIC) or network adapter for communicating with an Ethernet or other wire-based network or a wireless NIC (WNIC) or wireless adapter for communicating with a wireless network, such as a WI-FI network. This disclosure contemplates any suitable network and any suitable communication interface <b>1510</b> for it. As an example and not by way of limitation, computer system <b>1500</b> may communicate with an ad hoc network, a personal area network (PAN), a local area network (LAN), a wide area network (WAN), a metropolitan area network (MAN), or one or more portions of the Internet or a combination of two or more of these. One or more portions of one or more of these networks may be wired or wireless. As an example, computer system <b>1500</b> may communicate with a wireless PAN (WPAN) (such as, for example, a BLUETOOTH WPAN), a WI-FI network, a WI-MAX network, a cellular telephone network (such as, for example, a Global System for Mobile Communications (GSM) network), or other suitable wireless network or a combination of two or more of these. Computer system <b>1500</b> may include any suitable communication interface <b>1510</b> for any of these networks, where appropriate. Communication interface <b>1510</b> may include one or more communication interfaces <b>1510</b>, where appropriate. Although this disclosure describes and illustrates a particular communication interface, this disclosure contemplates any suitable communication interface.</p><p id="p-0111" num="0110">In particular embodiments, bus <b>1512</b> includes hardware, software, or both coupling components of computer system <b>1500</b> to each other. As an example and not by way of limitation, bus <b>1512</b> may include an Accelerated Graphics Port (AGP) or other graphics bus, an Enhanced Industry Standard Architecture (EISA) bus, a front-side bus (FSB), a HYPERTRANSPORT (HT) interconnect, an Industry Standard Architecture (ISA) bus, an INFINIBAND interconnect, a low-pin-count (LPC) bus, a memory bus, a Micro Channel Architecture (MCA) bus, a Peripheral Component Interconnect (PCI) bus, a PCI-Express (PCIe) bus, a serial advanced technology attachment (SATA) bus, a Video Electronics Standards Association local (VLB) bus, or another suitable bus or a combination of two or more of these. Bus <b>1512</b> may include one or more buses <b>1512</b>, where appropriate. Although this disclosure describes and illustrates a particular bus, this disclosure contemplates any suitable bus or interconnect.</p><p id="p-0112" num="0111">Herein, a computer-readable non-transitory storage medium or media may include one or more semiconductor-based or other integrated circuits (ICs) (such, as for example, field-programmable gate arrays (FPGAs) or application-specific ICs (ASICs)), hard disk drives (HDDs), hybrid hard drives (HHDs), optical discs, optical disc drives (ODDs), magneto-optical discs, magneto-optical drives, floppy diskettes, floppy disk drives (FDDs), magnetic tapes, solid-state drives (SSDs), RAM-drives, SECURE DIGITAL cards or drives, any other suitable computer-readable non-transitory storage media, or any suitable combination of two or more of these, where appropriate. A computer-readable non-transitory storage medium may be volatile, non-volatile, or a combination of volatile and non-volatile, where appropriate.</p><p id="p-0113" num="0112">Herein, &#x201c;or&#x201d; is inclusive and not exclusive, unless expressly indicated otherwise or indicated otherwise by context. Therefore, herein, &#x201c;A or B&#x201d; means &#x201c;A, B, or both,&#x201d; unless expressly indicated otherwise or indicated otherwise by context. Moreover, &#x201c;and&#x201d; is both joint and several, unless expressly indicated otherwise or indicated otherwise by context. Therefore, herein, &#x201c;A and B&#x201d; means &#x201c;A and B, jointly or severally,&#x201d; unless expressly indicated otherwise or indicated otherwise by context.</p><p id="p-0114" num="0113">The scope of this disclosure encompasses all changes, substitutions, variations, alterations, and modifications to the example embodiments described or illustrated herein that a person having ordinary skill in the art would comprehend. The scope of this disclosure is not limited to the example embodiments described or illustrated herein. Moreover, although this disclosure describes and illustrates respective embodiments herein as including particular components, elements, feature, functions, operations, or steps, any of these embodiments may include any combination or permutation of any of the components, elements, features, functions, operations, or steps described or illustrated anywhere herein that a person having ordinary skill in the art would comprehend. Furthermore, reference in the appended claims to an apparatus or system or a component of an apparatus or system being adapted to, arranged to, capable of, configured to, enabled to, operable to, or operative to perform a particular function encompasses that apparatus, system, component, whether or not it or that particular function is activated, turned on, or unlocked, as long as that apparatus, system, or component is so adapted, arranged, capable, configured, enabled, operable, or operative. Additionally, although this disclosure describes or illustrates particular embodiments as providing particular advantages, particular embodiments may provide none, some, or all of these advantages.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-01-20" num="01-20"><claim-text><b>1</b>-<b>20</b>. (canceled)</claim-text></claim><claim id="CLM-00021" num="00021"><claim-text><b>21</b>. A method comprising, by a computing device associated with a base station of a wireless network:<claim-text>receiving, from a plurality of user equipments (UEs) associated with the base station, sounding reference signal (SRS);</claim-text><claim-text>sending, to a distributed unit (DU) associated with the base station, information regarding one or more beams selected for each of the plurality of UEs based on the received SRS;</claim-text><claim-text>receiving, from the DU, information regarding a subset of the plurality of UEs selected for downlink data transmissions for a resource block group (RBG), multi-user data to be transmitted to UEs in the subset, and identities of beams to be associated with the UEs in the subset; and</claim-text><claim-text>transmitting pre-coded multi-user data to the UEs in the subset for the RBG using Multiple-Input Multiple-Output (MIMO) technologies, wherein the pre-coded multi-user data is prepared using a precoding matrix computed based on inverse-DFT (IDFT) vectors corresponding to the selected beams for the subset of the plurality of UEs.</claim-text></claim-text></claim><claim id="CLM-00022" num="00022"><claim-text><b>22</b>. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, further comprising:<claim-text>computing, for each of the plurality of UEs, a channel matrix by performing SRS-based downlink channel estimations based on the received SRS, wherein the channel matrix is between an antenna array for the UE and an antenna array for the base station;</claim-text><claim-text>estimating, for each of the plurality of UEs, strengths or signal-to-noise ratios (SNRs) of a plurality of pre-determined beams for the UE by performing a two-dimensional discrete Fourier transform (2D-DFT) on the computed channel matrix; and</claim-text><claim-text>selecting, for each of the plurality of UEs, the one or more beams among the plurality of pre-determined beams based on the estimated strengths.</claim-text></claim-text></claim><claim id="CLM-00023" num="00023"><claim-text><b>23</b>. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein an SRS-based downlink channel estimation is an SRS-based least squares channel estimation.</claim-text></claim><claim id="CLM-00024" num="00024"><claim-text><b>24</b>. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the estimated strengths or SNRs of the selected one or more beams are also sent to the DU.</claim-text></claim><claim id="CLM-00025" num="00025"><claim-text><b>25</b>. The method of <claim-ref idref="CLM-00024">claim 24</claim-ref>, wherein the DU selects the subset of the plurality of UEs based on the strengths or SNRs of the selected one or more beams.</claim-text></claim><claim id="CLM-00026" num="00026"><claim-text><b>26</b>. The method of <claim-ref idref="CLM-00025">claim 25</claim-ref>, further comprising sending channel quality indicators (CQIs) received from the plurality of UEs to the DU.</claim-text></claim><claim id="CLM-00027" num="00027"><claim-text><b>27</b>. The method of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the DU selects the subset of the plurality of UEs further based on the CQIs.</claim-text></claim><claim id="CLM-00028" num="00028"><claim-text><b>28</b>. The method of <claim-ref idref="CLM-00027">claim 27</claim-ref>, wherein the DU selects the subset of the plurality of UEs further based on downlink traffic information associated with each of the plurality of UEs.</claim-text></claim><claim id="CLM-00029" num="00029"><claim-text><b>29</b>. The method of <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein the downlink traffic information associated with a UE comprises traffic class type, hybrid automatic repeat request (HARD) retransmission information, and any pre-scheduled persistent or semi-persistent transmission allocations.</claim-text></claim><claim id="CLM-00030" num="00030"><claim-text><b>30</b>. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein each of the beams to be associated with the UEs in the subset corresponds to a discrete Fourier transform (DFT) vector.</claim-text></claim><claim id="CLM-00031" num="00031"><claim-text><b>31</b>. The method of <claim-ref idref="CLM-00030">claim 30</claim-ref>, wherein the pre-coded multi-user data is created based on a precoding matrix for the RBG.</claim-text></claim><claim id="CLM-00032" num="00032"><claim-text><b>32</b>. The method of <claim-ref idref="CLM-00030">claim 30</claim-ref>, wherein the precoding matrix for the RBG is computed by:<claim-text>establishing a maMIMO channel matrix by calculating inverse-DFT (IDFT) vectors of the DFT vectors corresponding to the beams to be associated with the UEs in the subset;</claim-text><claim-text>calculating a regularized pseudo-inverse of the maMIMO channel matrix; and</claim-text><claim-text>normalizing power of each column of the regularized pseudo-inverse of the maMIMO channel matrix such that a transmit power level for each UE in the selected subset equals to each other.</claim-text></claim-text></claim><claim id="CLM-00033" num="00033"><claim-text><b>33</b>. The method of <claim-ref idref="CLM-00032">claim 32</claim-ref>, wherein calculating an IDFT vector of a DTF vector is calculating a complex conjugate of the DFT vector.</claim-text></claim><claim id="CLM-00034" num="00034"><claim-text><b>34</b>. One or more computer-readable non-transitory storage media embodying software that is operable when executed, by a computing device associated with a base station of a wireless network, to:<claim-text>receive, from a plurality of user equipments (UEs) associated with the base station, sounding reference signal (SRS);</claim-text><claim-text>send, to a distributed unit (DU) associated with the base station, information regarding one or more beams selected for each of the plurality of UEs based on the received SRS;</claim-text><claim-text>receive, from the DU, information regarding a subset of the plurality of UEs selected for downlink data transmissions for a resource block group (RBG), multi-user data to be transmitted to UEs in the subset, and identities of beams to be associated with the UEs in the subset; and</claim-text><claim-text>transmit pre-coded multi-user data to the UEs in the subset for the RBG using Multiple-Input Multiple-Output (MIA/<b>10</b>) technologies, wherein the pre-coded multi-user data is prepared using a precoding matrix computed based on inverse-DFT (IDFT) vectors corresponding to the selected beams for the subset of the plurality of UEs.</claim-text></claim-text></claim><claim id="CLM-00035" num="00035"><claim-text><b>35</b>. The media of <claim-ref idref="CLM-00034">claim 34</claim-ref>, wherein the software is further operable when executed to:<claim-text>compute, for each of the plurality of UEs, a channel matrix by performing SRS-based downlink channel estimations based on the received SRS, wherein the channel matrix is between an antenna array for the UE and an antenna array for the base station;</claim-text><claim-text>estimate, for each of the plurality of UEs, strengths or signal-to-noise ratios (SNRs) of a plurality of pre-determined beams for the UE by performing a two-dimensional discrete Fourier transform (2D-DFT) on the computed channel matrix; and</claim-text><claim-text>select, for each of the plurality of UEs, the one or more beams among the plurality of pre-determined beams based on the estimated strengths.</claim-text></claim-text></claim><claim id="CLM-00036" num="00036"><claim-text><b>36</b>. The media of <claim-ref idref="CLM-00035">claim 35</claim-ref>, wherein an SRS-based downlink channel estimation is an SRS-based least squares channel estimation.</claim-text></claim><claim id="CLM-00037" num="00037"><claim-text><b>37</b>. The media of <claim-ref idref="CLM-00035">claim 35</claim-ref>, wherein the estimated strengths or SNRs of the selected one or more beams are also sent to the DU.</claim-text></claim><claim id="CLM-00038" num="00038"><claim-text><b>38</b>. The media of <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein the DU selects the subset of the plurality of UEs based on the strengths or SNRs of the selected one or more beams.</claim-text></claim><claim id="CLM-00039" num="00039"><claim-text><b>39</b>. The media of <claim-ref idref="CLM-00038">claim 38</claim-ref>, wherein the SRS-based downlink channel estimation is an SRS-based least squares channel estimation.</claim-text></claim><claim id="CLM-00040" num="00040"><claim-text><b>40</b>. A computing device associated with a base station of a wireless network comprising:<claim-text>one or more processors; and</claim-text><claim-text>one or more computer-readable non-transitory storage media coupled to one or more of the processors and comprising instructions operable when executed by one or more of the processors to cause the system to:</claim-text><claim-text>receive, from a plurality of user equipments (UEs) associated with the base station, sounding reference signal (SRS);</claim-text><claim-text>send, to a distributed unit (DU) associated with the base station, information regarding one or more beams selected for each of the plurality of UEs based on the received SRS;</claim-text><claim-text>receive, from the DU, information regarding a subset of the plurality of UEs selected for downlink data transmissions for a resource block group (RBG), multi-user data to be transmitted to UEs in the subset, and identities of beams to be associated with the UEs in the subset; and</claim-text><claim-text>transmit pre-coded multi-user data to the UEs in the subset for the RBG using Multiple-Input Multiple-Output (MIMO) technologies, wherein the pre-coded multi-user data is prepared using a precoding matrix computed based on inverse-DFT (IDFT) vectors corresponding to the selected beams for the subset of the plurality of UEs.</claim-text></claim-text></claim></claims></us-patent-application>