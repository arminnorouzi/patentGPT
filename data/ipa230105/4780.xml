<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230004781A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230004781</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17784430</doc-number><date>20210729</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>CN</country><doc-number>202011411870.X</doc-number><date>20201204</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>04</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>F</subclass><main-group>17</main-group><subgroup>16</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>063</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>B</section><class>21</class><subclass>B</subclass><main-group>37</main-group><subgroup>38</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>0445</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>17</main-group><subgroup>16</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>N</subclass><main-group>3</main-group><subgroup>063</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>B</section><class>21</class><subclass>B</subclass><main-group>37</main-group><subgroup>38</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>B</section><class>21</class><subclass>B</subclass><main-group>2269</main-group><subgroup>02</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">LSTM-BASED HOT-ROLLING ROLL-BENDING FORCE PREDICTING METHOD</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Northeastern University</orgname><address><city>Shenyang City</city><country>CN</country></address></addressbook><residence><country>CN</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>LI</last-name><first-name>Xu</first-name><address><city>Shenyang City</city><country>CN</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>LUAN</last-name><first-name>Feng</first-name><address><city>Shenyang City</city><country>CN</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>WANG</last-name><first-name>Lin</first-name><address><city>Shenyang City</city><country>CN</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>WU</last-name><first-name>Yan</first-name><address><city>Shenyang City</city><country>CN</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>HAN</last-name><first-name>Yuejiao</first-name><address><city>Shenyang City</city><country>CN</country></address></addressbook></inventor><inventor sequence="05" designation="us-only"><addressbook><last-name>ZHANG</last-name><first-name>Dianhua</first-name><address><city>Shenyang City</city><country>CN</country></address></addressbook></inventor></inventors></us-parties><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/CN2021/109203</doc-number><date>20210729</date></document-id><us-371c12-date><date>20220610</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">Provided is an LSTM-based hot-rolling roll-bending force predicting method including the steps of acquiring final rolling data of a stand of a stainless steel rolling mill when performing a hot rolling process, and dividing the data into a training set traindata and a test set testdata; normalizing the traindata; building a matrix P; using a last row of the matrix P as a label of the training set, namely a true value; calculating and updating an output value and the true value of a network; after network training is completed, taking the last m output data of the LSTM network as an input at a next moment, and then obtaining an output of the network at the next moment, wherein the output is a predicted value of the roll-bending force at the next moment; repeating the steps until a sufficient number of prediction data is obtained; and comparing the processed data with the true value in the testdata to check the validity of the network.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="197.78mm" wi="84.92mm" file="US20230004781A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="220.39mm" wi="86.95mm" file="US20230004781A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="179.49mm" wi="115.82mm" orientation="landscape" file="US20230004781A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="157.40mm" wi="121.84mm" orientation="landscape" file="US20230004781A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="180.85mm" wi="115.65mm" orientation="landscape" file="US20230004781A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="185.00mm" wi="133.18mm" orientation="landscape" file="US20230004781A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="196.17mm" wi="136.74mm" orientation="landscape" file="US20230004781A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="190.33mm" wi="133.94mm" orientation="landscape" file="US20230004781A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="163.75mm" wi="137.16mm" orientation="landscape" file="US20230004781A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="163.07mm" wi="138.51mm" orientation="landscape" file="US20230004781A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="161.80mm" wi="136.06mm" orientation="landscape" file="US20230004781A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="164.85mm" wi="137.84mm" orientation="landscape" file="US20230004781A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="165.27mm" wi="138.77mm" orientation="landscape" file="US20230004781A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00013" num="00013"><img id="EMI-D00013" he="165.86mm" wi="139.02mm" orientation="landscape" file="US20230004781A1-20230105-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00014" num="00014"><img id="EMI-D00014" he="165.18mm" wi="138.43mm" orientation="landscape" file="US20230004781A1-20230105-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00015" num="00015"><img id="EMI-D00015" he="166.12mm" wi="138.94mm" orientation="landscape" file="US20230004781A1-20230105-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00016" num="00016"><img id="EMI-D00016" he="165.95mm" wi="137.67mm" orientation="landscape" file="US20230004781A1-20230105-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00017" num="00017"><img id="EMI-D00017" he="165.44mm" wi="138.01mm" orientation="landscape" file="US20230004781A1-20230105-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00018" num="00018"><img id="EMI-D00018" he="162.73mm" wi="137.84mm" orientation="landscape" file="US20230004781A1-20230105-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00019" num="00019"><img id="EMI-D00019" he="163.41mm" wi="138.77mm" orientation="landscape" file="US20230004781A1-20230105-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading><heading id="h-0002" level="1">1. Field of the Invention</heading><p id="p-0002" num="0001">The invention relates to a rolling roll-bending force predicting technique, in particular to an LSTM-based hot-rolling roll-bending force predicting method.</p><heading id="h-0003" level="1">2. The Prior Arts</heading><p id="p-0003" num="0002">High-precision rolling requires a rolled steel sheet shape control system to have high precision, fast response and anti-disturbance. Hydraulic roll-bending force control is a basic link of a sheet shape control system in sheet rolling production, and the principle is to change the crown of a roll gap by applying roll-bending force to the necks of work rolls and support rolls to cause bending deformation of the rolls, thereby affecting the shape of the roll gap in the rolling process, promoting the shape of strip steels to change in the width direction, compensating the poor sheet shape caused by changes in other rolling process factors, and guaranteeing the sheet shape accuracy of outlets of strip steels. Therefore, the prediction accuracy of the roll-bending force has an important influence on the sheet shape and the sheet shape control accuracy, especially the heads of the strip steels. The higher prediction accuracy of the roll-bending force is beneficial to closed-loop feedback control. In actual production, the roll-bending force is usually calculated comprehensively according to temperature, thickness, width, rolling force, material, thermal expansion of the rolls, wear, flatness, and crown of the rolls, and the like of the strip steels. However, an existing roll-bending force prediction model based on a traditional mathematical method has a very complex structure, and each influencing factor has the characteristics of being non-linear, strong in coupling and time-varying, which seriously affects the improvement accuracy of the roll-bending force prediction model. Therefore, it is very necessary to explore a new roll-bending force prediction model.</p><p id="p-0004" num="0003">The neural network has been widely used in many fields because of unique properties. The neural network is characterized in that system modeling with complex internal relations can be completed, and traditional nonlinear problems can be solved. In addition, the network also has good robustness and fault tolerance. In recent years, many scholars gradually apply the neural network algorithm to the field of roll-bending force prediction, and achieve good prediction results, such as preset control of the roll-bending force of a hot continuous rolling mill by genetic algorithm, preset optimization of the roll-bending force by a BP neural network, and a roll-bending force prediction model of the hot rolled strip steels by the neural network optimized by the genetic algorithm. However, for most of the existing neural network roll-bending force prediction models, many parameters that affect the roll-bending force need to be collected as an input. The parameters are scattered in each component of the entire rolling process, thereby resulting in difficulty in data acquisition work and arduousness in tasks. At the same time, more input parameters not only increase the task of data processing, but also easily lead to the complexity of the model, which further affects the training speed and prediction accuracy of the network. By analyzing the rolling process, it can be found that in the actual rolling process, the rolling roll-bending force is continuous, and each rolling roll-bending force is related to the previous time moment, so that the method has the characteristics of time sequence, while the ordinary neural network does not consider time context information, it is difficult for the ordinary neural network to learn the trend of the time sequence, which will lead to low accuracy of the prediction model, and it is difficult to accurately predict the roll-bending force at the subsequent time.</p><heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading><p id="p-0005" num="0004">In view of defects existing in the prior art, the problem to be solved by the invention is to provide an LSTM-based hot-rolling roll-bending force predicting method, and the method can accurately and efficiently predict the roll-bending force of hot rolled strip steels.</p><p id="p-0006" num="0005">In order to solve the technical problem, the LSTM-based hot-rolling roll-bending force predicting method comprises the following steps:</p><p id="p-0007" num="0006">1) Acquiring final rolling data of a stand of a stainless steel rolling mill when performing a hot rolling process, and collecting roll-bending force data for experiment;</p><p id="p-0008" num="0007">2) Dividing the roll-bending force data into two parts: a training set traindata and a test set testdata according to a specified ratio in time sequence;</p><p id="p-0009" num="0008">3) Normalizing the traindata to obtain a normalized vector A;</p><p id="p-0010" num="0009">4) Building a matrix P by using the vector A in step 3);</p><p id="p-0011" num="0010">5) Taking first m rows of the matrix P in step 4) as an input and sending the first m rows to an LSTM network;</p><p id="p-0012" num="0011">6) Using a last row of the matrix P as a label, namely a true value, of the training set, performing calculation on an output value and the true value of the LSTM network by using a formula to obtain an error, and updating a weight and a bias of the LSTM network by a gradient descent method;</p><p id="p-0013" num="0012">7) After the LSTM network training is completed, taking last m output data of the LSTM network as an input at a next moment, and then obtaining the output of the LSTM network at the next moment, wherein the output is a predicted value of a roll-bending force at the next moment;</p><p id="p-0014" num="0013">8) Repeating step 7) until a sufficient number of prediction data is obtained; and</p><p id="p-0015" num="0014">9) Performing an inverse normalization on the obtained predicted value of the roll-bending force, and comparing the processed data with the true value in the testdata to check the validity of the LSTM network.</p><p id="p-0016" num="0015">In step 4), a matrix</p><p id="p-0017" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mrow>  <mrow>   <mi>P</mi>   <mo>=</mo>   <mrow>    <mo>[</mo>    <mtable>     <mtr>      <mtd>       <msub>        <mi>a</mi>        <mn>1</mn>       </msub>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mn>2</mn>       </msub>      </mtd>      <mtd>       <mo>&#x2026;</mo>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>n</mi>         <mo>-</mo>         <mi>m</mi>        </mrow>       </msub>      </mtd>     </mtr>     <mtr>      <mtd>       <msub>        <mi>a</mi>        <mn>2</mn>       </msub>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mn>3</mn>       </msub>      </mtd>      <mtd>       <mo>&#x2026;</mo>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>n</mi>         <mo>-</mo>         <mi>m</mi>         <mo>+</mo>         <mn>1</mn>        </mrow>       </msub>      </mtd>     </mtr>     <mtr>      <mtd>       <mo>&#x22ee;</mo>      </mtd>      <mtd>       <mo>&#x22ee;</mo>      </mtd>      <mtd>       <mo>&#x22f1;</mo>      </mtd>      <mtd>       <mo>&#x22ee;</mo>      </mtd>     </mtr>     <mtr>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>m</mi>         <mo>+</mo>         <mn>1</mn>        </mrow>       </msub>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>m</mi>         <mo>+</mo>         <mn>2</mn>        </mrow>       </msub>      </mtd>      <mtd>       <mo>&#x2026;</mo>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mi>n</mi>       </msub>      </mtd>     </mtr>    </mtable>    <mo>]</mo>   </mrow>  </mrow>  <mo>,</mo> </mrow></math></maths></p><p id="p-0018" num="0000">wherein a parameter m is the number of input layer units of a neural network, and n is the number of samples contained in a neural network training set.</p><p id="p-0019" num="0016">In step 5), the LSTM network can adopt a traditional LSTM network, and can also adopt an ON-LSTM network or a double-layer ON-LSTM network, and the double-layer ON-LSTM network is adopted as:</p><p id="p-0020" num="0017">Taking the first m rows of the matrix P in step 4) as an input of a first-layer LSTM, and sending obtained output data as an input to a second-layer LSTM, wherein output data of the second-layer LSTM is an output of the whole LSTM network.</p><p id="p-0021" num="0018">The first layer LSTM and the second layer LSTM of the double-layer ON-LSTM network introduce an ordered neurons LSTM of an update mechanism, namely ON-LSTM, and when parameters of the LSTM are updated, neurons are sorted, and an importance level, namely a hierarchical structure, is introduced; higher-level information represents important information, which needs to be retained in the LSTM network; on the contrary, lower-level information represents unimportant information, which needs to be updated with new input data; and a detailed process and calculation formula are as follows:</p><p id="p-0022" num="0019">Assuming that a primary hierarchical position corresponding to the important information is represented by S1, a secondary hierarchical position corresponding to the unimportant information is represented by S2, and S1 and S2 are respectively calculated as:</p><p id="p-0023" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>1<i>=F</i><sub>1</sub>(<i>x</i><sub>t</sub><i>,h</i><sub>t&#x2212;1</sub>)=index max(soft max(<i>W</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0024" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>2<i>=F</i><sub>2</sub>(<i>x</i><sub>t</sub><i>,h</i><sub>t&#x2212;1</sub>)=index max(soft max(<i>W</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0025" num="0000">wherein an indexmax function is used to find a position number corresponding to the largest element in the vector; x<sub>t </sub>is input data, h<sub>t&#x2212;1 </sub>is recursive data, W<sub>f</sub><sub><sup2>&#x2dc;</sup2></sub> and U<sub>f</sub><sub><sup2>&#x2dc;</sup2></sub> are main forget gate weight matrixes, b<sub>f</sub><sub><sup2>&#x2dc;</sup2></sub> is a main forget gate bias, W<sub>i</sub><sub><sup2>&#x2dc;</sup2></sub> and U<sub>i</sub><sub><sup2>&#x2dc;</sup2></sub> are main input gate weight matrixes, and b<sub>i</sub><sub><sup2>&#x2dc;</sup2></sub> is a main input gate bias.</p><p id="p-0026" num="0020">When S2&#x2265;S1, positions corresponding to the important information and the unimportant information partially overlap, and the calculation formula of a current cell state c<sub>t </sub>is:</p><p id="p-0027" num="0000"><maths id="MATH-US-00002" num="00002"><math overflow="scroll"> <mrow>  <msub>   <mi>c</mi>   <mi>t</mi>  </msub>  <mo>=</mo>  <mrow>   <mrow>    <mo>(</mo>    <mtable>     <mtr>      <mtd>       <mtable>        <mtr>         <mtd>          <mrow>           <msub>            <mi>c</mi>            <mrow>             <mi>t</mi>             <mo>-</mo>             <mn>1</mn>            </mrow>           </msub>           <mo>[</mo>           <mrow>            <mrow>             <mi>S</mi>             <mo>&#x2062;</mo>             <mn>2</mn>            </mrow>            <mo>,</mo>            <mi>k</mi>           </mrow>           <mo>]</mo>          </mrow>         </mtd>        </mtr>        <mtr>         <mtd>          <mrow>           <mrow>            <mo>(</mo>            <mrow>             <mrow>              <msub>               <mi>f</mi>               <mi>t</mi>              </msub>              <mo>&#x2218;</mo>              <msub>               <mi>c</mi>               <mrow>                <mi>t</mi>                <mo>-</mo>                <mn>1</mn>               </mrow>              </msub>             </mrow>             <mo>+</mo>             <mrow>              <msub>               <mi>i</mi>               <mi>t</mi>              </msub>              <mo>&#x2218;</mo>              <msub>               <mover>                <mi>c</mi>                <mo>~</mo>               </mover>               <mi>t</mi>              </msub>             </mrow>            </mrow>            <mo>)</mo>           </mrow>           <mo>&#x2062;</mo>           <mrow>            <mo>(</mo>            <mrow>             <mrow>              <mi>S</mi>              <mo>&#x2062;</mo>              <mn>1</mn>             </mrow>             <mo>,</mo>             <mrow>              <mi>S</mi>              <mo>&#x2062;</mo>              <mn>2</mn>             </mrow>            </mrow>            <mo>)</mo>           </mrow>          </mrow>         </mtd>        </mtr>       </mtable>      </mtd>     </mtr>     <mtr>      <mtd>       <mrow>        <msub>         <mover>          <mi>c</mi>          <mo>~</mo>         </mover>         <mi>t</mi>        </msub>        <mo>[</mo>        <mrow>         <mn>1</mn>         <mo>,</mo>         <mrow>          <mi>S</mi>          <mo>&#x2062;</mo>          <mn>1</mn>         </mrow>        </mrow>        <mo>]</mo>       </mrow>      </mtd>     </mtr>    </mtable>    <mo>)</mo>   </mrow>   <mo>.</mo>  </mrow> </mrow></math></maths></p><p id="p-0028" num="0021">When S2&#x3c;S1, positions corresponding to the important information and the unimportant information are independent of each other, and the current cell state c<sub>t </sub>is calculated by the following formula:</p><p id="p-0029" num="0000"><maths id="MATH-US-00003" num="00003"><math overflow="scroll"> <mrow>  <mrow>   <msub>    <mi>c</mi>    <mi>t</mi>   </msub>   <mo>=</mo>   <mrow>    <mo>(</mo>    <mtable>     <mtr>      <mtd>       <mtable>        <mtr>         <mtd>          <mrow>           <msub>            <mi>c</mi>            <mrow>             <mi>t</mi>             <mo>-</mo>             <mn>1</mn>            </mrow>           </msub>           <mo>[</mo>           <mrow>            <mrow>             <mi>S</mi>             <mo>&#x2062;</mo>             <mn>1</mn>            </mrow>            <mo>,</mo>            <mi>k</mi>           </mrow>           <mo>]</mo>          </mrow>         </mtd>        </mtr>        <mtr>         <mtd>          <mrow>           <mn>0</mn>           <mo>&#x2062;</mo>           <mrow>            <mo>(</mo>            <mrow>             <mrow>              <mi>S</mi>              <mo>&#x2062;</mo>              <mn>2</mn>             </mrow>             <mo>,</mo>             <mrow>              <mi>S</mi>              <mo>&#x2062;</mo>              <mn>1</mn>             </mrow>            </mrow>            <mo>)</mo>           </mrow>          </mrow>         </mtd>        </mtr>       </mtable>      </mtd>     </mtr>     <mtr>      <mtd>       <mrow>        <msub>         <mover>          <mi>c</mi>          <mo>~</mo>         </mover>         <mi>t</mi>        </msub>        <mo>[</mo>        <mtable>         <mtr>          <mtd>           <mrow>            <mn>1</mn>            <mo>,</mo>           </mrow>          </mtd>          <mtd>           <mrow>            <mi>S</mi>            <mo>&#x2062;</mo>            <mn>2</mn>           </mrow>          </mtd>         </mtr>        </mtable>        <mo>]</mo>       </mrow>      </mtd>     </mtr>    </mtable>    <mo>)</mo>   </mrow>  </mrow>  <mo>,</mo> </mrow></math></maths></p><p id="p-0030" num="0000">wherein k is the dimension of c<sub>t</sub>, f<sub>t </sub>and i<sub>t </sub>are forget gate output and input gate output respectively, {tilde over (c)}<sub>t </sub>is an intermediate unit state, and c<sub>t&#x2212;1 </sub>is a cell state at a previous time moment.</p><p id="p-0031" num="0022">{tilde over (f)}<sub>t </sub>and &#x129;<sub>t </sub>are defined as a main forget gate and a main input gate respectively, wherein w<sub>t1</sub>, w<sub>t2 </sub>and w<sub>t3 </sub>represent the high, medium and low levels in the hierarchical structure respectively,</p><p id="p-0032" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>{tilde over (f)}</i><sub>t</sub>=cumsum(soft max(<i>W</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0033" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>&#x129;</i><sub>t</sub>=1&#x2212;cumsum(soft max(<i>W</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0034" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>t2</sub><i>={tilde over (f)}</i><sub>t</sub><i>&#x2218;&#x129;</i><sub>t </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0035" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>t1</sub><i>={tilde over (f)}</i><sub>t</sub><i>&#x2212;W</i><sub>t2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0036" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>t3</sub><i>=&#x129;</i><sub>t</sub><i>&#x2212;W</i><sub>t2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0037" num="0000">wherein {tilde over (f)}<sub>t </sub>is a main forget gate output, and &#x129;<sub>t </sub>is a main input gate output.</p><p id="p-0038" num="0023">The method has the following beneficial effects and advantages:</p><p id="p-0039" num="0024">1. The LSTM-based hot-rolling roll-bending force predicting method according to the present invention selects an LSTM (Long Short-Term Memory) neural network model, and only a certain number of historical data of roll-bending force that are needed to be input into the network can effectively predict the roll-bending force data at the future time. In addition to the traditional LSTM, an ON-LSTM network with an added update mechanism is also used for prediction. Compared with a method adopting the traditional LSTM network, the accuracy of the network model after adding the update mechanism is improved, and the network is more stable.</p><p id="p-0040" num="0025">2. The invention integrates the update mechanism with a double-layer structure, and thus improves the network performance, so that the prediction accuracy of the network is further improved. Through experiments performed on the traditional LSTM network, the ON-LSTM network and the double-layer ON-LSTM network on the above three data sets, and experiments performed on an artificial neural network (ANN) with the same data set, the comparative experimental results prove the effectiveness of the LSTM (traditional LSTM, ON-LSTM, double-layer ON-LSTM) network model provided by the invention.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p-0041" num="0026"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows a flowchart of an LSTM-based hot-rolling roll-bending force predicting method according to the present invention.</p><p id="p-0042" num="0027"><figref idref="DRAWINGS">FIG. <b>2</b></figref> shows a diagram of a hidden-layer structure of a traditional LSTM.</p><p id="p-0043" num="0028"><figref idref="DRAWINGS">FIG. <b>3</b></figref> shows a diagram of a hidden-layer structure of an ON-LSTM.</p><p id="p-0044" num="0029"><figref idref="DRAWINGS">FIG. <b>4</b></figref> shows a structure diagram of a double-layer ON-LSTM.</p><p id="p-0045" num="0030"><figref idref="DRAWINGS">FIG. <b>5</b>A</figref> shows an error comparison diagram of four network models for a data set (1).</p><p id="p-0046" num="0031"><figref idref="DRAWINGS">FIG. <b>5</b>B</figref> shows an error comparison diagram of the four network models for a data set (2).</p><p id="p-0047" num="0032"><figref idref="DRAWINGS">FIG. <b>5</b>C</figref> shows an error comparison diagram of the four network models for a data set (3).</p><p id="p-0048" num="0033"><figref idref="DRAWINGS">FIG. <b>6</b>A</figref> shows a roll-bending force prediction result of a traditional LSTM network for a data set (1).</p><p id="p-0049" num="0034"><figref idref="DRAWINGS">FIG. <b>6</b>B</figref> shows a roll-bending force prediction result of the traditional LSTM network for a data set (2).</p><p id="p-0050" num="0035"><figref idref="DRAWINGS">FIG. <b>6</b>C</figref> shows a the roll-bending force prediction result of the traditional LSTM network for a data set (3).</p><p id="p-0051" num="0036"><figref idref="DRAWINGS">FIG. <b>7</b>A</figref> shows a roll-bending force prediction result of an ON-LSTM network for a data set (1).</p><p id="p-0052" num="0037"><figref idref="DRAWINGS">FIG. <b>7</b>B</figref> shows a roll-bending force prediction result of the ON-LSTM network for a data set (2).</p><p id="p-0053" num="0038"><figref idref="DRAWINGS">FIG. <b>7</b>C</figref> shows a roll-bending force prediction result of the ON-LSTM network for a data set (3).</p><p id="p-0054" num="0039"><figref idref="DRAWINGS">FIG. <b>8</b>A</figref> shows a roll-bending force prediction result of a double-layer ON-LSTM network for a data set (1).</p><p id="p-0055" num="0040"><figref idref="DRAWINGS">FIG. <b>8</b>B</figref> shows a roll-bending force prediction result of the double-layer ON-LSTM network for a data set (2).</p><p id="p-0056" num="0041"><figref idref="DRAWINGS">FIG. <b>8</b>C</figref> shows a roll-bending force prediction result of the double-layer ON-LSTM network for a data set (3).</p><p id="p-0057" num="0042"><figref idref="DRAWINGS">FIG. <b>9</b>A</figref> shows a roll-bending force prediction result of an ANN network for a data set (1).</p><p id="p-0058" num="0043"><figref idref="DRAWINGS">FIG. <b>9</b>B</figref> shows a roll-bending force prediction result of the ANN network for a data set (2).</p><p id="p-0059" num="0044"><figref idref="DRAWINGS">FIG. <b>9</b>C</figref> shows a roll-bending force prediction result of the ANN network for a data set (3).</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT</heading><p id="p-0060" num="0045">The invention will be further described below with reference to the accompanying drawings.</p><p id="p-0061" num="0046">As shown in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, the LSTM-based hot-rolling roll-bending force predicting method according to the present invention comprises the following steps:</p><p id="p-0062" num="0047">1) Acquiring final rolling data of a stand of a stainless steel rolling mill when performing a hot rolling process, and collecting roll-bending force data for experiment;</p><p id="p-0063" num="0048">2) Dividing the roll-bending force data into two parts: a training set traindata and a test set testdata according to a specified ratio in time sequence;</p><p id="p-0064" num="0049">3) Normalizing the input data to obtain a normalized vector A, specifically comprising: performing a linear normalization on the traindata to obtain the normalized vector A=(a<sub>1</sub>, a<sub>2</sub>, . . . , a<sub>n</sub>)<sup>T</sup>, wherein a parameter n is the number of samples contained in a neural network training set, and a<sub>1</sub>&#x2dc;a<sub>n </sub>an are the samples contained in the neural network training set;</p><p id="p-0065" num="0050">4) Building a matrix P by using the vector A in step 3),</p><p id="p-0066" num="0000"><maths id="MATH-US-00004" num="00004"><math overflow="scroll"> <mrow>  <mrow>   <mi>P</mi>   <mo>=</mo>   <mrow>    <mo>[</mo>    <mtable>     <mtr>      <mtd>       <msub>        <mi>a</mi>        <mn>1</mn>       </msub>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mn>2</mn>       </msub>      </mtd>      <mtd>       <mo>&#x2026;</mo>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>n</mi>         <mo>-</mo>         <mi>m</mi>        </mrow>       </msub>      </mtd>     </mtr>     <mtr>      <mtd>       <msub>        <mi>a</mi>        <mn>2</mn>       </msub>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mn>3</mn>       </msub>      </mtd>      <mtd>       <mo>&#x2026;</mo>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>n</mi>         <mo>-</mo>         <mi>m</mi>         <mo>+</mo>         <mn>1</mn>        </mrow>       </msub>      </mtd>     </mtr>     <mtr>      <mtd>       <mo>&#x22ee;</mo>      </mtd>      <mtd>       <mo>&#x22ee;</mo>      </mtd>      <mtd>       <mo>&#x22f1;</mo>      </mtd>      <mtd>       <mo>&#x22ee;</mo>      </mtd>     </mtr>     <mtr>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>m</mi>         <mo>+</mo>         <mn>1</mn>        </mrow>       </msub>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>m</mi>         <mo>+</mo>         <mn>2</mn>        </mrow>       </msub>      </mtd>      <mtd>       <mo>&#x2026;</mo>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mi>n</mi>       </msub>      </mtd>     </mtr>    </mtable>    <mo>]</mo>   </mrow>  </mrow>  <mo>,</mo> </mrow></math></maths></p><p id="p-0067" num="0000">wherein a parameter m is the number of input layer units of a neural network, and n is the number of samples;</p><p id="p-0068" num="0051">5) Taking first m rows of the matrix P in step 4) as an input and sending the first m rows to the LSTM network;</p><p id="p-0069" num="0052">6) Using a last row of the matrix P as a label, namely a true value, of the training set, performing calculation on an output value and the true value of the LSTM network by using a formula to obtain an error, and updating a weight and a bias of the LSTM network by a gradient descent method;</p><p id="p-0070" num="0053">7) After the LSTM network training is completed, taking last m output data of the LSTM network as an input at a next moment, and then obtaining the output of the LSTM network at the next moment, wherein the output is a predicted value of a roll-bending force at the next moment;</p><p id="p-0071" num="0054">8) Repeating step 7) until a sufficient number of prediction data is obtained; and</p><p id="p-0072" num="0055">9) Performing an inverse normalization on the obtained predicted value of the roll-bending force, and comparing the processed data with the true value in the testdata to check the validity of the LSTM network.</p><p id="p-0073" num="0056">In step 5), the LSTM network can adopt a traditional LSTM network (a hidden-layer structure is shown as <figref idref="DRAWINGS">FIG. <b>2</b></figref>), and can also adopt an ON-LSTM network (the hidden-layer structure is shown as <figref idref="DRAWINGS">FIG. <b>3</b></figref>), or a double-layer ON-LSTM network (the hidden-layer structure is shown as <figref idref="DRAWINGS">FIG. <b>4</b></figref>).</p><p id="p-0074" num="0057">When the ON-LSTM network is adopted, steps 1)-9) of the method adopting the ON-LSTM network are the same as those of the method adopting the traditional LSTM network.</p><p id="p-0075" num="0058">When the double-layer ON-LSTM network is adopted, steps 1)-4) and steps 6)-9) of the method adopting the double-layer ON-LSTM network are the same as those of the method adopting the traditional LSTM network, but step 5) is implemented in the following way: the first m rows of the matrix Pin step 4) are used as an input of a first-layer LSTM, and the obtained output data as an input is sent to the second-layer LSTM. The output data of the second-layer LSTM is an output of the whole LSTM network.</p><p id="p-0076" num="0059">In step 5), the first-layer LSTM and the second-layer LSTM are ordered neuron LSTMs that introduce an update mechanism, namely ON-LSTM. The function of the update mechanism lies in that when the parameters of the LSTM are updated, each neuron is sorted in a certain order, and the importance level, that is, a hierarchical structure, is introduced. Higher-level information represents important information, which needs to be retained in the LSTM network. Conversely, lower-level information represents unimportant information. For example, if the roll-bending force data at a certain moment is very different from that at the previous time moment and the subsequent time moment, thereby resulting in a big jump, it does not contribute much to the trend learning of the entire roll-bending force data, so that it is the unimportant information, and the other data are relatively the important information.</p><p id="p-0077" num="0060">The unimportant information needs to be updated with new input data. The detailed process and calculation formula are as follows:</p><p id="p-0078" num="0061">Assuming that a primary hierarchical position corresponding to the important information is represented by S1, a secondary hierarchical position corresponding to the unimportant information is represented by S2. Through x<sub>t </sub>and h<sub>t&#x2212;1</sub>, S1 and S2 are calculated as:</p><p id="p-0079" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>1<i>=F</i><sub>1</sub>(<i>x</i><sub>t</sub><i>,h</i><sub>t&#x2212;1</sub>)=index max(soft max(<i>W</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0080" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>2<i>=F</i><sub>2</sub>(<i>x</i><sub>t</sub><i>,h</i><sub>t&#x2212;1</sub>)=index max(soft max(<i>W</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0081" num="0000">wherein an indexmax function is used to find a position number (sorting from 1) corresponding to the largest element in the vector, x<sub>t </sub>is input data, h<sub>t&#x2212;1 </sub>is recursive data, W and U are weight matrixes, and b is a bias.</p><p id="p-0082" num="0062">The network updates c<sub>t </sub>based on the hierarchical positions. Considering the relative magnitude between S1 and S2, there are two classes of update models: (1) when S2&#x2265;S1, the positions corresponding to the important information and the unimportant information partially overlap, and the calculation formula of a current cell state c<sub>t </sub>is:</p><p id="p-0083" num="0000"><maths id="MATH-US-00005" num="00005"><math overflow="scroll"> <mrow>  <msub>   <mi>c</mi>   <mi>t</mi>  </msub>  <mo>=</mo>  <mrow>   <mrow>    <mo>(</mo>    <mtable>     <mtr>      <mtd>       <mtable>        <mtr>         <mtd>          <mrow>           <msub>            <mi>c</mi>            <mrow>             <mi>t</mi>             <mo>-</mo>             <mn>1</mn>            </mrow>           </msub>           <mo>[</mo>           <mrow>            <mrow>             <mi>S</mi>             <mo>&#x2062;</mo>             <mn>2</mn>            </mrow>            <mo>,</mo>            <mi>k</mi>           </mrow>           <mo>]</mo>          </mrow>         </mtd>        </mtr>        <mtr>         <mtd>          <mrow>           <mrow>            <mo>(</mo>            <mrow>             <mrow>              <msub>               <mi>f</mi>               <mi>t</mi>              </msub>              <mo>&#x2218;</mo>              <msub>               <mi>c</mi>               <mrow>                <mi>t</mi>                <mo>-</mo>                <mn>1</mn>               </mrow>              </msub>             </mrow>             <mo>+</mo>             <mrow>              <msub>               <mi>i</mi>               <mi>t</mi>              </msub>              <mo>&#x2218;</mo>              <msub>               <mover>                <mi>c</mi>                <mo>~</mo>               </mover>               <mi>t</mi>              </msub>             </mrow>            </mrow>            <mo>)</mo>           </mrow>           <mo>&#x2062;</mo>           <mrow>            <mo>(</mo>            <mrow>             <mrow>              <mi>S</mi>              <mo>&#x2062;</mo>              <mn>1</mn>             </mrow>             <mo>,</mo>             <mrow>              <mi>S</mi>              <mo>&#x2062;</mo>              <mn>2</mn>             </mrow>            </mrow>            <mo>)</mo>           </mrow>          </mrow>         </mtd>        </mtr>       </mtable>      </mtd>     </mtr>     <mtr>      <mtd>       <mrow>        <msub>         <mover>          <mi>c</mi>          <mo>~</mo>         </mover>         <mi>t</mi>        </msub>        <mo>[</mo>        <mrow>         <mn>1</mn>         <mo>,</mo>         <mrow>          <mi>S</mi>          <mo>&#x2062;</mo>          <mn>1</mn>         </mrow>        </mrow>        <mo>]</mo>       </mrow>      </mtd>     </mtr>    </mtable>    <mo>)</mo>   </mrow>   <mo>.</mo>  </mrow> </mrow></math></maths></p><p id="p-0084" num="0063">(2) When S2&#x3c;S1, the positions corresponding to the important information and the unimportant information are independent of each other, and the current cell state c<sub>t </sub>is calculated by the following formula:</p><p id="p-0085" num="0000"><maths id="MATH-US-00006" num="00006"><math overflow="scroll"> <mrow>  <msub>   <mi>c</mi>   <mi>t</mi>  </msub>  <mo>=</mo>  <mrow>   <mo>(</mo>   <mtable>    <mtr>     <mtd>      <mtable>       <mtr>        <mtd>         <mrow>          <msub>           <mi>c</mi>           <mrow>            <mi>t</mi>            <mo>-</mo>            <mn>1</mn>           </mrow>          </msub>          <mo>[</mo>          <mrow>           <mrow>            <mi>S</mi>            <mo>&#x2062;</mo>            <mn>1</mn>           </mrow>           <mo>,</mo>           <mi>k</mi>          </mrow>          <mo>]</mo>         </mrow>        </mtd>       </mtr>       <mtr>        <mtd>         <mrow>          <mn>0</mn>          <mo>&#x2062;</mo>          <mrow>           <mo>(</mo>           <mrow>            <mrow>             <mi>S</mi>             <mo>&#x2062;</mo>             <mn>2</mn>            </mrow>            <mo>,</mo>            <mrow>             <mi>S</mi>             <mo>&#x2062;</mo>             <mn>1</mn>            </mrow>           </mrow>           <mo>)</mo>          </mrow>         </mrow>        </mtd>       </mtr>      </mtable>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <msub>        <mover>         <mi>c</mi>         <mo>~</mo>        </mover>        <mi>t</mi>       </msub>       <mo>[</mo>       <mtable>        <mtr>         <mtd>          <mrow>           <mn>1</mn>           <mo>,</mo>          </mrow>         </mtd>         <mtd>          <mrow>           <mi>S</mi>           <mo>&#x2062;</mo>           <mn>2</mn>          </mrow>         </mtd>        </mtr>       </mtable>       <mo>]</mo>      </mrow>     </mtd>    </mtr>   </mtable>   <mo>)</mo>  </mrow> </mrow></math></maths></p><p id="p-0086" num="0000">wherein k is the dimension of c<sub>t</sub>, f<sub>t </sub>and i<sub>t </sub>are forget gate output and input gate output, respectively, and {tilde over (c)}<sub>t</sub>is an intermediate unit state.</p><p id="p-0087" num="0064">For the convenience of describing the update process, {tilde over (f)}<sub>t </sub>and &#x129;<sub>t </sub>are defined as a main forget gate and a main input gate, respectively, wherein w<sub>t1</sub>, w<sub>t2 </sub>and w<sub>t3 </sub>represent high, medium and low levels in the hierarchical structure, respectively.</p><p id="p-0088" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>{tilde over (f)}</i><sub>t</sub>=cumsum(soft max(<i>W</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0089" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>&#x129;</i><sub>t</sub>=1&#x2212;cumsum(soft max(<i>W</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0090" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>t2</sub><i>={tilde over (f)}</i><sub>t</sub><i>&#x2218;&#x129;</i><sub>t </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0091" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>t1</sub><i>={tilde over (f)}</i><sub>t</sub><i>&#x2212;W</i><sub>t2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0092" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>t3</sub><i>=&#x129;</i><sub>t</sub><i>&#x2212;W</i><sub>t2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0093" num="0065">The complete update formula of the ON-LSTM network is:</p><p id="p-0094" num="0000"><maths id="MATH-US-00007" num="00007"><math overflow="scroll"> <mrow>  <mo>{</mo>  <mtable>   <mtr>    <mtd>     <mtable>      <mtr>       <mtd>        <mtable>         <mtr>          <mtd>           <mtable>            <mtr>             <mtd>              <mtable>               <mtr>                <mtd>                 <mtable>                  <mtr>                   <mtd>                    <mtable>                     <mtr>                      <mtd>                       <mtable>                        <mtr>                         <mtd>                          <mtable>                           <mtr>                            <mtd>                             <mtable>                              <mtr>                               <mtd>                                <mrow>                                 <msub>                                  <mi>f</mi>                                  <mi>t</mi>                                 </msub>                                 <mo>=</mo>                                 <mrow>                                  <mi>&#x3c3;</mi>                                  <mo>&#x2061;</mo>                                  <mo>(</mo>                                  <mrow>                                   <mrow>                                    <msub>                                     <mi>W</mi>                                     <mi>fx</mi>                                    </msub>                                    <mo>&#x2062;</mo>                                    <msub>                                     <mi>x</mi>                                     <mi>t</mi>                                    </msub>                                   </mrow>                                   <mo>+</mo>                                   <mrow>                                    <msub>                                     <mi>W</mi>                                     <mi>fh</mi>                                    </msub>                                    <mo>&#x2062;</mo>                                    <msub>                                     <mi>h</mi>                                     <mrow>                                      <mi>t</mi>                                      <mo>-</mo>                                      <mn>1</mn>                                     </mrow>                                    </msub>                                   </mrow>                                   <mo>+</mo>                                   <msub>                                    <mi>b</mi>                                    <mi>f</mi>                                   </msub>                                  </mrow>                                  <mo>)</mo>                                 </mrow>                                </mrow>                               </mtd>                              </mtr>                              <mtr>                               <mtd>                                <mrow>                                 <msub>                                  <mi>i</mi>                                  <mi>t</mi>                                 </msub>                                 <mo>=</mo>                                 <mrow>                                  <mi>&#x3c3;</mi>                                  <mo>&#x2062;</mo>                                  <mrow>                                   <mo>(</mo>                                   <mrow>                                    <mrow>                                     <msub>                                      <mi>W</mi>                                      <mi>ix</mi>                                     </msub>                                     <mo>&#x2062;</mo>                                     <msub>                                      <mi>x</mi>                                      <mi>t</mi>                                     </msub>                                    </mrow>                                    <mo>+</mo>                                    <mrow>                                     <msub>                                      <mi>W</mi>                                      <mi>ih</mi>                                     </msub>                                     <mo>&#x2062;</mo>                                     <msub>                                      <mi>h</mi>                                      <mrow>                                       <mi>t</mi>                                       <mo>-</mo>                                       <mn>1</mn>                                      </mrow>                                     </msub>                                    </mrow>                                    <mo>+</mo>                                    <msub>                                     <mi>b</mi>                                     <mi>i</mi>                                    </msub>                                   </mrow>                                   <mo>)</mo>                                  </mrow>                                 </mrow>                                </mrow>                               </mtd>                              </mtr>                             </mtable>                            </mtd>                           </mtr>                           <mtr>                            <mtd>                             <mrow>                              <msub>                               <mi>o</mi>                               <mi>t</mi>                              </msub>                              <mo>=</mo>                              <mrow>                               <mi>&#x3c3;</mi>                               <mo>&#x2062;</mo>                               <mrow>                                <mo>(</mo>                                <mrow>                                 <mrow>                                  <msub>                                   <mi>W</mi>                                   <mi>ox</mi>                                  </msub>                                  <mo>&#x2062;</mo>                                  <msub>                                   <mi>x</mi>                                   <mi>t</mi>                                  </msub>                                 </mrow>                                 <mo>+</mo>                                 <mrow>                                  <msub>                                   <mi>W</mi>                                   <mi>oh</mi>                                  </msub>                                  <mo>&#x2062;</mo>                                  <msub>                                   <mi>h</mi>                                   <mrow>                                    <mi>t</mi>                                    <mo>-</mo>                                    <mn>1</mn>                                   </mrow>                                  </msub>                                 </mrow>                                 <mo>+</mo>                                 <msub>                                  <mi>b</mi>                                  <mi>o</mi>                                 </msub>                                </mrow>                                <mo>)</mo>                               </mrow>                              </mrow>                             </mrow>                            </mtd>                           </mtr>                          </mtable>                         </mtd>                        </mtr>                        <mtr>                         <mtd>                          <mrow>                           <msub>                            <mover>                             <mi>c</mi>                             <mo>~</mo>                            </mover>                            <mi>t</mi>                           </msub>                           <mo>=</mo>                           <mrow>                            <mi>tanh</mi>                            <mo>&#x2061;</mo>                            <mo>(</mo>                            <mrow>                             <mrow>                              <msub>                               <mi>W</mi>                               <mi>cx</mi>                              </msub>                              <mo>&#x2062;</mo>                              <msub>                               <mi>x</mi>                               <mi>t</mi>                              </msub>                             </mrow>                             <mo>+</mo>                             <mrow>                              <msub>                               <mi>W</mi>                               <mi>ch</mi>                              </msub>                              <mo>&#x2062;</mo>                              <msub>                               <mi>h</mi>                               <mrow>                                <mi>t</mi>                                <mo>-</mo>                                <mn>1</mn>                               </mrow>                              </msub>                             </mrow>                             <mo>+</mo>                             <msub>                              <mi>b</mi>                              <mi>c</mi>                             </msub>                            </mrow>                            <mo>)</mo>                           </mrow>                          </mrow>                         </mtd>                        </mtr>                       </mtable>                      </mtd>                     </mtr>                     <mtr>                      <mtd>                       <mrow>                        <msub>                         <mover>                          <mi>f</mi>                          <mo>~</mo>                         </mover>                         <mi>t</mi>                        </msub>                        <mo>=</mo>                        <mrow>                         <mi>cu</mi>                         <mo>&#x2062;</mo>                         <mtext>  </mtext>                         <mrow>                          <mi>max</mi>                          <mo>&#x2061;</mo>                          <mo>(</mo>                          <mrow>                           <mrow>                            <msub>                             <mi>W</mi>                             <mrow>                              <mover>                               <mi>f</mi>                               <mo>~</mo>                              </mover>                              <mo>&#x2062;</mo>                              <mi>x</mi>                             </mrow>                            </msub>                            <mo>&#x2062;</mo>                            <msub>                             <mi>x</mi>                             <mi>t</mi>                            </msub>                           </mrow>                           <mo>+</mo>                           <mrow>                            <msub>                             <mi>W</mi>                             <mrow>                              <mover>                               <mi>f</mi>                               <mo>~</mo>                              </mover>                              <mo>&#x2062;</mo>                              <mi>h</mi>                             </mrow>                            </msub>                            <mo>&#x2062;</mo>                            <msub>                             <mi>h</mi>                             <mrow>                              <mi>t</mi>                              <mo>-</mo>                              <mn>1</mn>                             </mrow>                            </msub>                           </mrow>                           <mo>+</mo>                           <msub>                            <mi>b</mi>                            <mover>                             <mi>f</mi>                             <mo>~</mo>                            </mover>                           </msub>                          </mrow>                          <mo>)</mo>                         </mrow>                        </mrow>                       </mrow>                      </mtd>                     </mtr>                    </mtable>                   </mtd>                  </mtr>                  <mtr>                   <mtd>                    <mrow>                     <msub>                      <mover>                       <mi>i</mi>                       <mo>~</mo>                      </mover>                      <mi>t</mi>                     </msub>                     <mo>=</mo>                     <mrow>                      <mn>1</mn>                      <mo>-</mo>                      <mrow>                       <mi>cu</mi>                       <mo>&#x2062;</mo>                       <mtext>  </mtext>                       <mrow>                        <mi>max</mi>                        <mo>&#x2061;</mo>                        <mo>(</mo>                        <mrow>                         <mrow>                          <msub>                           <mi>W</mi>                           <mrow>                            <mover>                             <mi>i</mi>                             <mo>~</mo>                            </mover>                            <mo>&#x2062;</mo>                            <mi>x</mi>                           </mrow>                          </msub>                          <mo>&#x2062;</mo>                          <msub>                           <mi>x</mi>                           <mi>t</mi>                          </msub>                         </mrow>                         <mo>+</mo>                         <mrow>                          <msub>                           <mi>W</mi>                           <mrow>                            <mover>                             <mi>i</mi>                             <mo>~</mo>                            </mover>                            <mo>&#x2062;</mo>                            <mi>h</mi>                           </mrow>                          </msub>                          <mo>&#x2062;</mo>                          <msub>                           <mi>h</mi>                           <mrow>                            <mi>t</mi>                            <mo>-</mo>                            <mn>1</mn>                           </mrow>                          </msub>                         </mrow>                         <mo>+</mo>                         <msub>                          <mi>b</mi>                          <mover>                           <mi>i</mi>                           <mo>~</mo>                          </mover>                         </msub>                        </mrow>                        <mo>)</mo>                       </mrow>                      </mrow>                     </mrow>                    </mrow>                   </mtd>                  </mtr>                 </mtable>                </mtd>               </mtr>               <mtr>                <mtd>                 <mrow>                  <msub>                   <mi>W</mi>                   <mrow>                    <mi>t</mi>                    <mo>&#x2062;</mo>                    <mn>2</mn>                   </mrow>                  </msub>                  <mo>=</mo>                  <mrow>                   <msub>                    <mover>                     <mi>f</mi>                     <mo>~</mo>                    </mover>                    <mi>t</mi>                   </msub>                   <mo>&#x2218;</mo>                   <msub>                    <mover>                     <mi>i</mi>                     <mo>~</mo>                    </mover>                    <mi>t</mi>                   </msub>                  </mrow>                 </mrow>                </mtd>               </mtr>              </mtable>             </mtd>            </mtr>            <mtr>             <mtd>              <mrow>               <msub>                <mi>W</mi>                <mrow>                 <mi>t</mi>                 <mo>&#x2062;</mo>                 <mn>1</mn>                </mrow>               </msub>               <mo>=</mo>               <mrow>                <msub>                 <mover>                  <mi>f</mi>                  <mo>~</mo>                 </mover>                 <mi>t</mi>                </msub>                <mo>-</mo>                <msub>                 <mi>W</mi>                 <mrow>                  <mi>t</mi>                  <mo>&#x2062;</mo>                  <mn>2</mn>                 </mrow>                </msub>               </mrow>              </mrow>             </mtd>            </mtr>           </mtable>          </mtd>         </mtr>         <mtr>          <mtd>           <mrow>            <msub>             <mi>W</mi>             <mrow>              <mi>t</mi>              <mo>&#x2062;</mo>              <mn>3</mn>             </mrow>            </msub>            <mo>=</mo>            <mrow>             <msub>              <mover>               <mi>i</mi>               <mo>~</mo>              </mover>              <mi>t</mi>             </msub>             <mo>-</mo>             <msub>              <mi>W</mi>              <mrow>               <mi>t</mi>               <mo>&#x2062;</mo>               <mn>2</mn>              </mrow>             </msub>            </mrow>           </mrow>          </mtd>         </mtr>        </mtable>       </mtd>      </mtr>      <mtr>       <mtd>        <mrow>         <msub>          <mi>c</mi>          <mi>t</mi>         </msub>         <mo>=</mo>         <mrow>          <mrow>           <msub>            <mi>W</mi>            <mrow>             <mi>t</mi>             <mo>&#x2062;</mo>             <mn>1</mn>            </mrow>           </msub>           <mo>&#x2218;</mo>           <msub>            <mi>c</mi>            <mrow>             <mi>t</mi>             <mo>-</mo>             <mn>1</mn>            </mrow>           </msub>          </mrow>          <mo>+</mo>          <mrow>           <msub>            <mi>W</mi>            <mrow>             <mi>t</mi>             <mo>&#x2062;</mo>             <mn>2</mn>            </mrow>           </msub>           <mo>&#x2218;</mo>           <mrow>            <mo>(</mo>            <mrow>             <mrow>              <msub>               <mi>f</mi>               <mi>t</mi>              </msub>              <mo>&#x2218;</mo>              <msub>               <mi>c</mi>               <mrow>                <mi>t</mi>                <mo>-</mo>                <mn>1</mn>               </mrow>              </msub>             </mrow>             <mo>+</mo>             <mrow>              <msub>               <mi>i</mi>               <mi>t</mi>              </msub>              <mo>&#x2218;</mo>              <msub>               <mover>                <mi>c</mi>                <mo>~</mo>               </mover>               <mi>t</mi>              </msub>             </mrow>            </mrow>            <mo>)</mo>           </mrow>          </mrow>          <mo>+</mo>          <mrow>           <msub>            <mi>W</mi>            <mrow>             <mi>t</mi>             <mo>&#x2062;</mo>             <mn>3</mn>            </mrow>           </msub>           <mo>&#x2218;</mo>           <msub>            <mover>             <mi>c</mi>             <mo>~</mo>            </mover>            <mi>t</mi>           </msub>          </mrow>         </mrow>        </mrow>       </mtd>      </mtr>     </mtable>    </mtd>   </mtr>   <mtr>    <mtd>     <mrow>      <msub>       <mi>h</mi>       <mi>t</mi>      </msub>      <mo>=</mo>      <mrow>       <msub>        <mi>o</mi>        <mi>t</mi>       </msub>       <mo>&#x2218;</mo>       <mrow>        <mi>tanh</mi>        <mo>&#x2061;</mo>        <mo>(</mo>        <msub>         <mi>c</mi>         <mi>t</mi>        </msub>        <mo>)</mo>       </mrow>      </mrow>     </mrow>    </mtd>   </mtr>  </mtable> </mrow></math></maths></p><p id="p-0095" num="0000">wherein the cumax function is an abbreviation for cumsum(softmax( )).</p><p id="p-0096" num="0066">The update calculation process of the LSTM network weights and biases mentioned in step 6) is as follows:</p><p id="p-0097" num="0067">The calculation formula of the weighted input error term of the traditional LSTM and the ON-LSTM networks is:</p><p id="p-0098" num="0000"><maths id="MATH-US-00008" num="00008"><math overflow="scroll"> <mrow>  <mo>{</mo>  <mtable>   <mtr>    <mtd>     <mtable>      <mtr>       <mtd>        <mtable>         <mtr>          <mtd>           <mrow>            <msubsup>             <mi>&#x3b4;</mi>             <mrow>              <mi>i</mi>              <mo>,</mo>              <mi>t</mi>             </mrow>             <mi>T</mi>            </msubsup>            <mo>=</mo>            <mrow>             <msubsup>              <mi>&#x3b4;</mi>              <mi>t</mi>              <mi>T</mi>             </msubsup>             <mo>&#x2218;</mo>             <msub>              <mi>o</mi>              <mi>t</mi>             </msub>             <mo>&#x2218;</mo>             <mrow>              <mo>(</mo>              <mrow>               <mn>1</mn>               <mo>-</mo>               <msup>                <mrow>                 <mi>tanh</mi>                 <mo>&#x2061;</mo>                 <mo>(</mo>                 <msub>                  <mi>c</mi>                  <mi>t</mi>                 </msub>                 <mo>)</mo>                </mrow>                <mn>2</mn>               </msup>              </mrow>              <mo>)</mo>             </mrow>             <mo>&#x2218;</mo>             <msub>              <mi>W</mi>              <mrow>               <mi>t</mi>               <mo>&#x2062;</mo>               <mn>2</mn>              </mrow>             </msub>             <mo>&#x2218;</mo>             <msub>              <mover>               <mi>c</mi>               <mo>~</mo>              </mover>              <mi>t</mi>             </msub>             <mo>&#x2218;</mo>             <msub>              <mi>i</mi>              <mi>t</mi>             </msub>             <mo>&#x2218;</mo>             <mrow>              <mo>(</mo>              <mrow>               <mn>1</mn>               <mo>-</mo>               <msub>                <mi>i</mi>                <mi>t</mi>               </msub>              </mrow>              <mo>)</mo>             </mrow>            </mrow>           </mrow>          </mtd>         </mtr>         <mtr>          <mtd>           <mrow>            <msubsup>             <mi>&#x3b4;</mi>             <mrow>              <mi>f</mi>              <mo>,</mo>              <mi>t</mi>             </mrow>             <mi>T</mi>            </msubsup>            <mo>=</mo>            <mrow>             <msubsup>              <mi>&#x3b4;</mi>              <mi>t</mi>              <mi>T</mi>             </msubsup>             <mo>&#x2218;</mo>             <msub>              <mi>o</mi>              <mi>t</mi>             </msub>             <mo>&#x2218;</mo>             <mrow>              <mo>(</mo>              <mrow>               <mn>1</mn>               <mo>-</mo>               <msup>                <mrow>                 <mi>tanh</mi>                 <mo>&#x2061;</mo>                 <mo>(</mo>                 <msub>                  <mi>c</mi>                  <mi>t</mi>                 </msub>                 <mo>)</mo>                </mrow>                <mn>2</mn>               </msup>              </mrow>              <mo>)</mo>             </mrow>             <mo>&#x2218;</mo>             <msub>              <mi>W</mi>              <mrow>               <mi>t</mi>               <mo>&#x2062;</mo>               <mn>2</mn>              </mrow>             </msub>             <mo>&#x2218;</mo>             <msub>              <mi>c</mi>              <mrow>               <mi>t</mi>               <mo>-</mo>               <mn>1</mn>              </mrow>             </msub>             <mo>&#x2218;</mo>             <msub>              <mi>f</mi>              <mi>t</mi>             </msub>             <mo>&#x2218;</mo>             <mrow>              <mo>(</mo>              <mrow>               <mn>1</mn>               <mo>-</mo>               <msub>                <mi>f</mi>                <mi>t</mi>               </msub>              </mrow>              <mo>)</mo>             </mrow>            </mrow>           </mrow>          </mtd>         </mtr>        </mtable>       </mtd>      </mtr>      <mtr>       <mtd>        <mrow>         <msubsup>          <mi>&#x3b4;</mi>          <mrow>           <mi>o</mi>           <mo>,</mo>           <mi>t</mi>          </mrow>          <mi>T</mi>         </msubsup>         <mo>=</mo>         <mrow>          <msubsup>           <mi>&#x3b4;</mi>           <mi>t</mi>           <mi>T</mi>          </msubsup>          <mo>&#x2218;</mo>          <mrow>           <mi>tanh</mi>           <mo>&#x2061;</mo>           <mo>(</mo>           <msub>            <mi>c</mi>            <mi>t</mi>           </msub>           <mo>)</mo>          </mrow>          <mo>&#x2218;</mo>          <msub>           <mi>o</mi>           <mi>t</mi>          </msub>          <mo>&#x2218;</mo>          <mrow>           <mo>(</mo>           <mrow>            <mn>1</mn>            <mo>-</mo>            <msub>             <mi>o</mi>             <mi>t</mi>            </msub>           </mrow>           <mo>)</mo>          </mrow>         </mrow>        </mrow>       </mtd>      </mtr>     </mtable>    </mtd>   </mtr>   <mtr>    <mtd>     <mrow>      <msubsup>       <mi>&#x3b4;</mi>       <mrow>        <mover>         <mi>c</mi>         <mo>~</mo>        </mover>        <mo>,</mo>        <mi>t</mi>       </mrow>       <mi>T</mi>      </msubsup>      <mo>=</mo>      <mrow>       <msubsup>        <mi>&#x3b4;</mi>        <mi>t</mi>        <mi>T</mi>       </msubsup>       <mo>&#x2218;</mo>       <msub>        <mi>o</mi>        <mi>t</mi>       </msub>       <mo>&#x2218;</mo>       <mrow>        <mo>(</mo>        <mrow>         <mn>1</mn>         <mo>-</mo>         <msup>          <mrow>           <mi>tanh</mi>           <mo>&#x2061;</mo>           <mo>(</mo>           <msub>            <mi>c</mi>            <mi>t</mi>           </msub>           <mo>)</mo>          </mrow>          <mn>2</mn>         </msup>        </mrow>        <mo>)</mo>       </mrow>       <mo>&#x2218;</mo>       <mrow>        <mo>(</mo>        <mrow>         <mrow>          <msub>           <mi>W</mi>           <mrow>            <mi>t</mi>            <mo>&#x2062;</mo>            <mn>2</mn>           </mrow>          </msub>          <mo>&#x2218;</mo>          <msub>           <mi>i</mi>           <mi>t</mi>          </msub>         </mrow>         <mo>+</mo>         <msub>          <mi>W</mi>          <mrow>           <mi>t</mi>           <mo>&#x2062;</mo>           <mn>3</mn>          </mrow>         </msub>        </mrow>        <mo>)</mo>       </mrow>       <mo>&#x2218;</mo>       <mrow>        <mo>(</mo>        <mrow>         <mn>1</mn>         <mo>-</mo>         <msubsup>          <mover>           <mi>c</mi>           <mo>~</mo>          </mover>          <mi>t</mi>          <mn>2</mn>         </msubsup>        </mrow>        <mo>)</mo>       </mrow>      </mrow>     </mrow>    </mtd>   </mtr>  </mtable> </mrow></math></maths></p><p id="p-0099" num="0068">The double-layer ON-LSTM with a double-layer structure is adopted, and two layers of the network are slightly different in the calculation when the weights and the biases are updated. The calculation formulas of the weighted input error terms of the first-layer LSTM and the second-layer LSTM respectively are:</p><p id="p-0100" num="0069">The first-layer LSTM:</p><p id="p-0101" num="0000"><maths id="MATH-US-00009" num="00009"><math overflow="scroll"> <mrow>  <mo>{</mo>  <mrow>   <mtable>    <mtr>     <mtd>      <mtable>       <mtr>        <mtd>         <mtable>          <mtr>           <mtd>            <mrow>             <msubsup>              <mi>&#x3b4;</mi>              <mrow>               <mi>i</mi>               <mo>,</mo>               <mi>t</mi>              </mrow>              <mi>T</mi>             </msubsup>             <mo>=</mo>             <mrow>              <mrow>               <mo>(</mo>               <mrow>                <mrow>                 <msubsup>                  <mi>&#x3b4;</mi>                  <mrow>                   <mi>f</mi>                   <mo>,</mo>                   <mi>t</mi>                  </mrow>                  <mi>T</mi>                 </msubsup>                 <mo>&#x2062;</mo>                 <msub>                  <mi>W</mi>                  <mi>fx</mi>                 </msub>                </mrow>                <mo>+</mo>                <mrow>                 <msubsup>                  <mi>&#x3b4;</mi>                  <mrow>                   <mi>i</mi>                   <mo>,</mo>                   <mi>t</mi>                  </mrow>                  <mi>T</mi>                 </msubsup>                 <mo>&#x2062;</mo>                 <msub>                  <mi>W</mi>                  <mi>ix</mi>                 </msub>                </mrow>                <mo>+</mo>                <mrow>                 <msubsup>                  <mi>&#x3b4;</mi>                  <mrow>                   <mover>                    <mi>c</mi>                    <mo>~</mo>                   </mover>                   <mo>,</mo>                   <mi>t</mi>                  </mrow>                  <mi>T</mi>                 </msubsup>                 <mo>&#x2062;</mo>                 <msub>                  <mi>W</mi>                  <mi>cx</mi>                 </msub>                </mrow>                <mo>+</mo>                <mrow>                 <msubsup>                  <mi>&#x3b4;</mi>                  <mrow>                   <mi>o</mi>                   <mo>,</mo>                   <mi>t</mi>                  </mrow>                  <mi>T</mi>                 </msubsup>                 <mo>&#x2062;</mo>                 <msub>                  <mi>W</mi>                  <mi>ox</mi>                 </msub>                </mrow>               </mrow>               <mo>)</mo>              </mrow>              <mo>&#x2218;</mo>             </mrow>            </mrow>           </mtd>          </mtr>          <mtr>           <mtd>            <mrow>             <msub>              <mi>o</mi>              <mi>t</mi>             </msub>             <mo>&#x2218;</mo>             <mrow>              <mo>(</mo>              <mrow>               <mn>1</mn>               <mo>-</mo>               <msup>                <mrow>                 <mi>tanh</mi>                 <mo>&#x2061;</mo>                 <mo>(</mo>                 <msub>                  <mi>c</mi>                  <mi>t</mi>                 </msub>                 <mo>)</mo>                </mrow>                <mn>2</mn>               </msup>              </mrow>              <mo>)</mo>             </mrow>             <mo>&#x2218;</mo>             <msub>              <mi>W</mi>              <mrow>               <mi>t</mi>               <mo>&#x2062;</mo>               <mn>2</mn>              </mrow>             </msub>             <mo>&#x2218;</mo>             <msub>              <mover>               <mi>c</mi>               <mo>~</mo>              </mover>              <mi>t</mi>             </msub>             <mo>&#x2218;</mo>             <msub>              <mi>i</mi>              <mi>t</mi>             </msub>             <mo>&#x2218;</mo>             <mrow>              <mo>(</mo>              <mrow>               <mn>1</mn>               <mo>-</mo>               <msub>                <mi>i</mi>                <mi>t</mi>               </msub>              </mrow>              <mo>)</mo>             </mrow>            </mrow>           </mtd>          </mtr>         </mtable>        </mtd>       </mtr>       <mtr>        <mtd>         <mrow>          <msubsup>           <mi>&#x3b4;</mi>           <mrow>            <mi>f</mi>            <mo>,</mo>            <mi>t</mi>           </mrow>           <mi>T</mi>          </msubsup>          <mo>=</mo>          <mrow>           <mrow>            <mo>(</mo>            <mrow>             <mrow>              <msubsup>               <mi>&#x3b4;</mi>               <mrow>                <mi>f</mi>                <mo>,</mo>                <mi>t</mi>               </mrow>               <mi>T</mi>              </msubsup>              <mo>&#x2062;</mo>              <msub>               <mi>W</mi>               <mi>fx</mi>              </msub>             </mrow>             <mo>+</mo>             <mrow>              <msubsup>               <mi>&#x3b4;</mi>               <mrow>                <mi>i</mi>                <mo>,</mo>                <mi>t</mi>               </mrow>               <mi>T</mi>              </msubsup>              <mo>&#x2062;</mo>              <msub>               <mi>W</mi>               <mi>ix</mi>              </msub>             </mrow>             <mo>+</mo>             <mrow>              <msubsup>               <mi>&#x3b4;</mi>               <mrow>                <mover>                 <mi>c</mi>                 <mo>~</mo>                </mover>                <mo>,</mo>                <mi>t</mi>               </mrow>               <mi>T</mi>              </msubsup>              <mo>&#x2062;</mo>              <msub>               <mi>W</mi>               <mi>cx</mi>              </msub>             </mrow>             <mo>+</mo>             <mrow>              <msubsup>               <mi>&#x3b4;</mi>               <mrow>                <mi>o</mi>                <mo>,</mo>                <mi>t</mi>               </mrow>               <mi>T</mi>              </msubsup>              <mo>&#x2062;</mo>              <msub>               <mi>W</mi>               <mi>ox</mi>              </msub>             </mrow>            </mrow>            <mo>)</mo>           </mrow>           <mo>&#x2218;</mo>          </mrow>         </mrow>        </mtd>       </mtr>      </mtable>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <msub>        <mi>o</mi>        <mi>t</mi>       </msub>       <mo>&#x2218;</mo>       <mrow>        <mo>(</mo>        <mrow>         <mn>1</mn>         <mo>-</mo>         <msup>          <mrow>           <mi>tanh</mi>           <mo>&#x2061;</mo>           <mo>(</mo>           <msub>            <mi>c</mi>            <mi>t</mi>           </msub>           <mo>)</mo>          </mrow>          <mn>2</mn>         </msup>        </mrow>        <mo>)</mo>       </mrow>       <mo>&#x2218;</mo>       <msub>        <mi>W</mi>        <mrow>         <mi>t</mi>         <mo>&#x2062;</mo>         <mn>2</mn>        </mrow>       </msub>       <mo>&#x2218;</mo>       <msub>        <mi>c</mi>        <mrow>         <mi>t</mi>         <mo>-</mo>         <mn>1</mn>        </mrow>       </msub>       <mo>&#x2218;</mo>       <msub>        <mi>f</mi>        <mi>t</mi>       </msub>       <mo>&#x2218;</mo>       <mrow>        <mo>(</mo>        <mrow>         <mn>1</mn>         <mo>-</mo>         <msub>          <mi>f</mi>          <mi>t</mi>         </msub>        </mrow>        <mo>)</mo>       </mrow>      </mrow>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <msubsup>        <mi>&#x3b4;</mi>        <mrow>         <mi>o</mi>         <mo>,</mo>         <mi>t</mi>        </mrow>        <mi>T</mi>       </msubsup>       <mo>=</mo>       <mrow>        <mrow>         <mrow>          <mo>(</mo>          <mrow>           <mrow>            <msubsup>             <mi>&#x3b4;</mi>             <mrow>              <mi>f</mi>              <mo>,</mo>              <mi>t</mi>             </mrow>             <mi>T</mi>            </msubsup>            <mo>&#x2062;</mo>            <msub>             <mi>W</mi>             <mi>fx</mi>            </msub>           </mrow>           <mo>+</mo>           <mrow>            <msubsup>             <mi>&#x3b4;</mi>             <mrow>              <mi>i</mi>              <mo>,</mo>              <mi>t</mi>             </mrow>             <mi>T</mi>            </msubsup>            <mo>&#x2062;</mo>            <msub>             <mi>W</mi>             <mi>ix</mi>            </msub>           </mrow>           <mo>+</mo>           <mrow>            <msubsup>             <mi>&#x3b4;</mi>             <mrow>              <mover>               <mi>c</mi>               <mo>~</mo>              </mover>              <mo>,</mo>              <mi>t</mi>             </mrow>             <mi>T</mi>            </msubsup>            <mo>&#x2062;</mo>            <msub>             <mi>W</mi>             <mi>cx</mi>            </msub>           </mrow>           <mo>+</mo>           <mrow>            <msubsup>             <mi>&#x3b4;</mi>             <mrow>              <mi>o</mi>              <mo>,</mo>              <mi>t</mi>             </mrow>             <mi>T</mi>            </msubsup>            <mo>&#x2062;</mo>            <msub>             <mi>W</mi>             <mi>ox</mi>            </msub>           </mrow>          </mrow>          <mo>)</mo>         </mrow>         <mo>&#x2218;</mo>         <mi>tanh</mi>        </mrow>        <mo>&#x2062;</mo>        <mrow>         <mrow>          <mo>(</mo>          <msub>           <mi>c</mi>           <mi>t</mi>          </msub>          <mo>)</mo>         </mrow>         <mo>&#x2218;</mo>         <msub>          <mi>o</mi>          <mi>t</mi>         </msub>         <mo>&#x2218;</mo>         <mrow>          <mo>(</mo>          <mrow>           <mn>1</mn>           <mo>-</mo>           <msub>            <mi>o</mi>            <mi>t</mi>           </msub>          </mrow>          <mo>)</mo>         </mrow>        </mrow>       </mrow>      </mrow>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <msubsup>        <mi>&#x3b4;</mi>        <mrow>         <mover>          <mi>c</mi>          <mo>~</mo>         </mover>         <mo>,</mo>         <mi>t</mi>        </mrow>        <mi>T</mi>       </msubsup>       <mo>=</mo>       <mrow>        <mrow>         <mo>(</mo>         <mrow>          <mrow>           <msubsup>            <mi>&#x3b4;</mi>            <mrow>             <mi>f</mi>             <mo>,</mo>             <mi>t</mi>            </mrow>            <mi>T</mi>           </msubsup>           <mo>&#x2062;</mo>           <msub>            <mi>W</mi>            <mi>fx</mi>           </msub>          </mrow>          <mo>+</mo>          <mrow>           <msubsup>            <mi>&#x3b4;</mi>            <mrow>             <mi>i</mi>             <mo>,</mo>             <mi>t</mi>            </mrow>            <mi>T</mi>           </msubsup>           <mo>&#x2062;</mo>           <msub>            <mi>W</mi>            <mi>ix</mi>           </msub>          </mrow>          <mo>+</mo>          <mrow>           <msubsup>            <mi>&#x3b4;</mi>            <mrow>             <mover>              <mi>c</mi>              <mo>~</mo>             </mover>             <mo>,</mo>             <mi>t</mi>            </mrow>            <mi>T</mi>           </msubsup>           <mo>&#x2062;</mo>           <msub>            <mi>W</mi>            <mi>cx</mi>           </msub>          </mrow>          <mo>+</mo>          <mrow>           <msubsup>            <mi>&#x3b4;</mi>            <mrow>             <mi>o</mi>             <mo>,</mo>             <mi>t</mi>            </mrow>            <mi>T</mi>           </msubsup>           <mo>&#x2062;</mo>           <msub>            <mi>W</mi>            <mi>ox</mi>           </msub>          </mrow>         </mrow>         <mo>)</mo>        </mrow>        <mo>&#x2218;</mo>       </mrow>      </mrow>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <msub>        <mi>o</mi>        <mi>t</mi>       </msub>       <mo>&#x2218;</mo>       <mrow>        <mo>(</mo>        <mrow>         <mn>1</mn>         <mo>-</mo>         <msup>          <mrow>           <mi>tanh</mi>           <mo>&#x2061;</mo>           <mo>(</mo>           <msub>            <mi>c</mi>            <mi>t</mi>           </msub>           <mo>)</mo>          </mrow>          <mn>2</mn>         </msup>        </mrow>        <mo>)</mo>       </mrow>       <mo>&#x2218;</mo>       <mrow>        <mo>(</mo>        <mrow>         <mrow>          <msub>           <mi>W</mi>           <mrow>            <mi>t</mi>            <mo>&#x2062;</mo>            <mn>2</mn>           </mrow>          </msub>          <mo>&#x2218;</mo>          <msub>           <mi>i</mi>           <mi>t</mi>          </msub>         </mrow>         <mo>+</mo>         <msub>          <mi>W</mi>          <mrow>           <mi>t</mi>           <mo>&#x2062;</mo>           <mn>3</mn>          </mrow>         </msub>        </mrow>        <mo>)</mo>       </mrow>       <mo>&#x2218;</mo>       <mrow>        <mo>(</mo>        <mrow>         <mn>1</mn>         <mo>-</mo>         <msubsup>          <mover>           <mi>c</mi>           <mo>~</mo>          </mover>          <mi>t</mi>          <mn>2</mn>         </msubsup>        </mrow>        <mo>)</mo>       </mrow>      </mrow>     </mtd>    </mtr>   </mtable>   <mo>.</mo>  </mrow> </mrow></math></maths></p><p id="p-0102" num="0070">The second-layer LSTM:</p><p id="p-0103" num="0000"><maths id="MATH-US-00010" num="00010"><math overflow="scroll"> <mrow>  <mo>{</mo>  <mrow>   <mtable>    <mtr>     <mtd>      <mtable>       <mtr>        <mtd>         <mtable>          <mtr>           <mtd>            <mrow>             <msubsup>              <mi>&#x3b4;</mi>              <mrow>               <mi>i</mi>               <mo>,</mo>               <mi>t</mi>              </mrow>              <mi>T</mi>             </msubsup>             <mo>=</mo>             <mrow>              <msubsup>               <mi>&#x3b4;</mi>               <mi>t</mi>               <mi>T</mi>              </msubsup>              <mo>&#x2218;</mo>              <msub>               <mi>o</mi>               <mi>t</mi>              </msub>              <mo>&#x2218;</mo>              <mrow>               <mo>(</mo>               <mrow>                <mn>1</mn>                <mo>-</mo>                <msup>                 <mrow>                  <mi>tanh</mi>                  <mo>&#x2061;</mo>                  <mo>(</mo>                  <msub>                   <mi>c</mi>                   <mi>t</mi>                  </msub>                  <mo>)</mo>                 </mrow>                 <mn>2</mn>                </msup>               </mrow>               <mo>)</mo>              </mrow>              <mo>&#x2218;</mo>              <msub>               <mi>W</mi>               <mrow>                <mi>t</mi>                <mo>&#x2062;</mo>                <mn>2</mn>               </mrow>              </msub>              <mo>&#x2218;</mo>              <msub>               <mover>                <mi>c</mi>                <mo>~</mo>               </mover>               <mi>t</mi>              </msub>              <mo>&#x2218;</mo>              <msub>               <mi>i</mi>               <mi>t</mi>              </msub>              <mo>&#x2218;</mo>              <mrow>               <mo>(</mo>               <mrow>                <mn>1</mn>                <mo>-</mo>                <msub>                 <mi>i</mi>                 <mi>t</mi>                </msub>               </mrow>               <mo>)</mo>              </mrow>             </mrow>            </mrow>           </mtd>          </mtr>          <mtr>           <mtd>            <mrow>             <msubsup>              <mi>&#x3b4;</mi>              <mrow>               <mi>f</mi>               <mo>,</mo>               <mi>t</mi>              </mrow>              <mi>T</mi>             </msubsup>             <mo>=</mo>             <mrow>              <msubsup>               <mi>&#x3b4;</mi>               <mi>t</mi>               <mi>T</mi>              </msubsup>              <mo>&#x2218;</mo>              <msub>               <mi>o</mi>               <mi>t</mi>              </msub>              <mo>&#x2218;</mo>              <mrow>               <mo>(</mo>               <mrow>                <mn>1</mn>                <mo>-</mo>                <msup>                 <mrow>                  <mi>tanh</mi>                  <mo>&#x2061;</mo>                  <mo>(</mo>                  <msub>                   <mi>c</mi>                   <mi>t</mi>                  </msub>                  <mo>)</mo>                 </mrow>                 <mn>2</mn>                </msup>               </mrow>               <mo>)</mo>              </mrow>              <mo>&#x2218;</mo>              <msub>               <mi>W</mi>               <mrow>                <mi>t</mi>                <mo>&#x2062;</mo>                <mn>2</mn>               </mrow>              </msub>              <mo>&#x2218;</mo>              <msub>               <mi>c</mi>               <mrow>                <mi>t</mi>                <mo>-</mo>                <mn>1</mn>               </mrow>              </msub>              <mo>&#x2218;</mo>              <msub>               <mi>f</mi>               <mi>t</mi>              </msub>              <mo>&#x2218;</mo>              <mrow>               <mo>(</mo>               <mrow>                <mn>1</mn>                <mo>-</mo>                <msub>                 <mi>f</mi>                 <mi>t</mi>                </msub>               </mrow>               <mo>)</mo>              </mrow>             </mrow>            </mrow>           </mtd>          </mtr>         </mtable>        </mtd>       </mtr>       <mtr>        <mtd>         <mrow>          <msubsup>           <mi>&#x3b4;</mi>           <mrow>            <mi>o</mi>            <mo>,</mo>            <mi>t</mi>           </mrow>           <mi>T</mi>          </msubsup>          <mo>=</mo>          <mrow>           <msubsup>            <mi>&#x3b4;</mi>            <mi>t</mi>            <mi>T</mi>           </msubsup>           <mo>&#x2218;</mo>           <mrow>            <mi>tanh</mi>            <mo>&#x2061;</mo>            <mo>(</mo>            <msub>             <mi>c</mi>             <mi>t</mi>            </msub>            <mo>)</mo>           </mrow>           <mo>&#x2218;</mo>           <msub>            <mi>o</mi>            <mi>t</mi>           </msub>           <mo>&#x2218;</mo>           <mrow>            <mo>(</mo>            <mrow>             <mn>1</mn>             <mo>-</mo>             <msub>              <mi>o</mi>              <mi>t</mi>             </msub>            </mrow>            <mo>)</mo>           </mrow>          </mrow>         </mrow>        </mtd>       </mtr>      </mtable>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <msubsup>        <mi>&#x3b4;</mi>        <mrow>         <mover>          <mi>c</mi>          <mo>~</mo>         </mover>         <mo>,</mo>         <mi>t</mi>        </mrow>        <mi>T</mi>       </msubsup>       <mo>=</mo>       <mrow>        <msubsup>         <mi>&#x3b4;</mi>         <mi>t</mi>         <mi>T</mi>        </msubsup>        <mo>&#x2218;</mo>        <msub>         <mi>o</mi>         <mi>t</mi>        </msub>        <mo>&#x2218;</mo>        <mrow>         <mo>(</mo>         <mrow>          <mn>1</mn>          <mo>-</mo>          <msup>           <mrow>            <mi>tanh</mi>            <mo>&#x2061;</mo>            <mo>(</mo>            <msub>             <mi>c</mi>             <mi>t</mi>            </msub>            <mo>)</mo>           </mrow>           <mn>2</mn>          </msup>         </mrow>         <mo>)</mo>        </mrow>        <mo>&#x2218;</mo>        <mrow>         <mo>(</mo>         <mrow>          <mrow>           <msub>            <mi>W</mi>            <mrow>             <mi>t</mi>             <mo>&#x2062;</mo>             <mn>2</mn>            </mrow>           </msub>           <mo>&#x2218;</mo>           <msub>            <mi>i</mi>            <mi>t</mi>           </msub>          </mrow>          <mo>+</mo>          <msub>           <mi>W</mi>           <mrow>            <mi>t</mi>            <mo>&#x2062;</mo>            <mn>3</mn>           </mrow>          </msub>         </mrow>         <mo>)</mo>        </mrow>        <mo>&#x2218;</mo>        <mrow>         <mo>(</mo>         <mrow>          <mn>1</mn>          <mo>-</mo>          <msubsup>           <mover>            <mi>c</mi>            <mo>~</mo>           </mover>           <mi>t</mi>           <mn>2</mn>          </msubsup>         </mrow>         <mo>)</mo>        </mrow>       </mrow>      </mrow>     </mtd>    </mtr>   </mtable>   <mo>.</mo>  </mrow> </mrow></math></maths></p><p id="p-0104" num="0071">Wherein f<sub>t </sub>is a forget gate output, i<sub>t </sub>is an input gate output, o<sub>t </sub>is an output gate output, c<sub>t </sub>is a current cell state, c<sub>t&#x2212;1 </sub>is a cell state at a previous time moment, {tilde over (c)}<sub>t </sub>is an intermediate unit state, x<sub>t </sub>is input data, h<sub>t </sub>is recursive data, h<sub>t&#x2212;1 </sub>is recursive data at the previous time moment, {tilde over (f)}<sub>t </sub>is a main forget gate output, &#x129;<sub>t </sub>is a main input gate output, w<sub>t1</sub>is a high level, w<sub>t2 </sub>is a medium level, w<sub>t3 </sub>is a low level, W<sub>fx</sub>, W<sub>ix</sub>, W<sub>cx</sub>, W<sub>ox</sub>, W<sub>{tilde over (f)}x</sub>, W<sub>&#x129;x</sub>, W<sub>fh</sub>, W<sub>ih</sub>, W<sub>ch</sub>, W<sub>oh</sub>, W<sub>{tilde over (f)}h </sub>and W<sub>&#x129;h </sub>are weight matrices, b<sub>f</sub>, b<sub>i</sub>, b<sub>c</sub>, b<sub>o</sub>, b<sub>&#x129;</sub> and b<sub>{tilde over (f)}</sub> are bias vectors, &#x3b4;<sub>t </sub>is an error term at a time moment t, &#x3b4;<sub>f,t</sub>, &#x3b4;<sub>i,t</sub>, &#x3b4;<sub>{tilde over (c)},t </sub>and &#x3b4;<sub>o,t </sub>are error terms corresponding to four weighted inputs of f<sub>t</sub>, i<sub>t</sub>, c<sub>t</sub>, and o<sub>t</sub>, respectively.</p><p id="p-0105" num="0072">The calculation of a weight gradient:</p><p id="p-0106" num="0000"><maths id="MATH-US-00011" num="00011"><math overflow="scroll"> <mrow>  <mo>{</mo>  <mtable>   <mtr>    <mtd>     <mtable>      <mtr>       <mtd>        <mtable>         <mtr>          <mtd>           <mrow>            <mfrac>             <mrow>              <mo>&#x2202;</mo>              <mi>E</mi>             </mrow>             <mrow>              <mo>&#x2202;</mo>              <msub>               <mi>W</mi>               <mrow>                <mi>oh</mi>                <mo>,</mo>                <mi>t</mi>               </mrow>              </msub>             </mrow>            </mfrac>            <mo>=</mo>            <mrow>             <msub>              <mi>&#x3b4;</mi>              <mrow>               <mi>o</mi>               <mo>,</mo>               <mi>t</mi>              </mrow>             </msub>             <mo>&#x2062;</mo>             <msubsup>              <mi>h</mi>              <mrow>               <mi>t</mi>               <mo>-</mo>               <mn>1</mn>              </mrow>              <mi>T</mi>             </msubsup>            </mrow>           </mrow>          </mtd>         </mtr>         <mtr>          <mtd>           <mrow>            <mfrac>             <mrow>              <mo>&#x2202;</mo>              <mi>E</mi>             </mrow>             <mrow>              <mo>&#x2202;</mo>              <msub>               <mi>W</mi>               <mrow>                <mi>fh</mi>                <mo>,</mo>                <mi>t</mi>               </mrow>              </msub>             </mrow>            </mfrac>            <mo>=</mo>            <mrow>             <msub>              <mi>&#x3b4;</mi>              <mrow>               <mi>f</mi>               <mo>,</mo>               <mi>t</mi>              </mrow>             </msub>             <mo>&#x2062;</mo>             <msubsup>              <mi>h</mi>              <mrow>               <mi>t</mi>               <mo>-</mo>               <mn>1</mn>              </mrow>              <mi>T</mi>             </msubsup>            </mrow>           </mrow>          </mtd>         </mtr>        </mtable>       </mtd>      </mtr>      <mtr>       <mtd>        <mrow>         <mfrac>          <mrow>           <mo>&#x2202;</mo>           <mi>E</mi>          </mrow>          <mrow>           <mo>&#x2202;</mo>           <msub>            <mi>W</mi>            <mrow>             <mi>ih</mi>             <mo>,</mo>             <mi>t</mi>            </mrow>           </msub>          </mrow>         </mfrac>         <mo>=</mo>         <mrow>          <msub>           <mi>&#x3b4;</mi>           <mrow>            <mi>i</mi>            <mo>,</mo>            <mi>t</mi>           </mrow>          </msub>          <mo>&#x2062;</mo>          <msubsup>           <mi>h</mi>           <mrow>            <mi>t</mi>            <mo>-</mo>            <mn>1</mn>           </mrow>           <mi>T</mi>          </msubsup>         </mrow>        </mrow>       </mtd>      </mtr>     </mtable>    </mtd>   </mtr>   <mtr>    <mtd>     <mrow>      <mfrac>       <mrow>        <mo>&#x2202;</mo>        <mi>E</mi>       </mrow>       <mrow>        <mo>&#x2202;</mo>        <msub>         <mi>W</mi>         <mrow>          <mi>ch</mi>          <mo>,</mo>          <mi>t</mi>         </mrow>        </msub>       </mrow>      </mfrac>      <mo>=</mo>      <mrow>       <msub>        <mi>&#x3b4;</mi>        <mrow>         <mover>          <mi>c</mi>          <mo>~</mo>         </mover>         <mo>,</mo>         <mi>t</mi>        </mrow>       </msub>       <mo>&#x2062;</mo>       <msubsup>        <mi>h</mi>        <mrow>         <mi>t</mi>         <mo>-</mo>         <mn>1</mn>        </mrow>        <mi>T</mi>       </msubsup>      </mrow>     </mrow>    </mtd>   </mtr>  </mtable> </mrow></math></maths><maths id="MATH-US-00011-2" num="00011.2"><math overflow="scroll"> <mrow>  <mo>{</mo>  <mtable>   <mtr>    <mtd>     <mtable>      <mtr>       <mtd>        <mtable>         <mtr>          <mtd>           <mrow>            <mfrac>             <mrow>              <mo>&#x2202;</mo>              <mi>E</mi>             </mrow>             <mrow>              <mo>&#x2202;</mo>              <msub>               <mi>W</mi>               <mrow>                <mi>ox</mi>                <mo>,</mo>                <mi>t</mi>               </mrow>              </msub>             </mrow>            </mfrac>            <mo>=</mo>            <mrow>             <msub>              <mi>&#x3b4;</mi>              <mrow>               <mi>o</mi>               <mo>,</mo>               <mi>t</mi>              </mrow>             </msub>             <mo>&#x2062;</mo>             <msubsup>              <mi>x</mi>              <mi>t</mi>              <mi>T</mi>             </msubsup>            </mrow>           </mrow>          </mtd>         </mtr>         <mtr>          <mtd>           <mrow>            <mfrac>             <mrow>              <mo>&#x2202;</mo>              <mi>E</mi>             </mrow>             <mrow>              <mo>&#x2202;</mo>              <msub>               <mi>W</mi>               <mrow>                <mi>fx</mi>                <mo>,</mo>                <mi>t</mi>               </mrow>              </msub>             </mrow>            </mfrac>            <mo>=</mo>            <mrow>             <msub>              <mi>&#x3b4;</mi>              <mrow>               <mi>f</mi>               <mo>,</mo>               <mi>t</mi>              </mrow>             </msub>             <mo>&#x2062;</mo>             <msubsup>              <mi>x</mi>              <mi>t</mi>              <mi>T</mi>             </msubsup>            </mrow>           </mrow>          </mtd>         </mtr>        </mtable>       </mtd>      </mtr>      <mtr>       <mtd>        <mrow>         <mfrac>          <mrow>           <mo>&#x2202;</mo>           <mi>E</mi>          </mrow>          <mrow>           <mo>&#x2202;</mo>           <msub>            <mi>W</mi>            <mrow>             <mi>ix</mi>             <mo>,</mo>             <mi>t</mi>            </mrow>           </msub>          </mrow>         </mfrac>         <mo>=</mo>         <mrow>          <msub>           <mi>&#x3b4;</mi>           <mrow>            <mi>i</mi>            <mo>,</mo>            <mi>t</mi>           </mrow>          </msub>          <mo>&#x2062;</mo>          <msubsup>           <mi>x</mi>           <mi>t</mi>           <mi>T</mi>          </msubsup>         </mrow>        </mrow>       </mtd>      </mtr>     </mtable>    </mtd>   </mtr>   <mtr>    <mtd>     <mrow>      <mfrac>       <mrow>        <mo>&#x2202;</mo>        <mi>E</mi>       </mrow>       <mrow>        <mo>&#x2202;</mo>        <msub>         <mi>W</mi>         <mrow>          <mi>cx</mi>          <mo>,</mo>          <mi>t</mi>         </mrow>        </msub>       </mrow>      </mfrac>      <mo>=</mo>      <mrow>       <msub>        <mi>&#x3b4;</mi>        <mrow>         <mover>          <mi>c</mi>          <mo>~</mo>         </mover>         <mo>,</mo>         <mi>t</mi>        </mrow>       </msub>       <mo>&#x2062;</mo>       <msubsup>        <mi>x</mi>        <mi>t</mi>        <mi>T</mi>       </msubsup>      </mrow>     </mrow>    </mtd>   </mtr>  </mtable> </mrow></math></maths></p><p id="p-0107" num="0073">The calculation of a bias gradient:</p><p id="p-0108" num="0000"><maths id="MATH-US-00012" num="00012"><math overflow="scroll"> <mrow>  <mo>{</mo>  <mtable>   <mtr>    <mtd>     <mtable>      <mtr>       <mtd>        <mtable>         <mtr>          <mtd>           <mrow>            <mfrac>             <mrow>              <mo>&#x2202;</mo>              <mi>E</mi>             </mrow>             <mrow>              <mo>&#x2202;</mo>              <msub>               <mi>b</mi>               <mrow>                <mi>o</mi>                <mo>,</mo>                <mi>t</mi>               </mrow>              </msub>             </mrow>            </mfrac>            <mo>=</mo>            <msub>             <mi>&#x3b4;</mi>             <mrow>              <mi>o</mi>              <mo>,</mo>              <mi>t</mi>             </mrow>            </msub>           </mrow>          </mtd>         </mtr>         <mtr>          <mtd>           <mrow>            <mfrac>             <mrow>              <mo>&#x2202;</mo>              <mi>E</mi>             </mrow>             <mrow>              <mo>&#x2202;</mo>              <msub>               <mi>b</mi>               <mrow>                <mi>f</mi>                <mo>,</mo>                <mi>t</mi>               </mrow>              </msub>             </mrow>            </mfrac>            <mo>=</mo>            <msub>             <mi>&#x3b4;</mi>             <mrow>              <mi>f</mi>              <mo>,</mo>              <mi>t</mi>             </mrow>            </msub>           </mrow>          </mtd>         </mtr>        </mtable>       </mtd>      </mtr>      <mtr>       <mtd>        <mrow>         <mfrac>          <mrow>           <mo>&#x2202;</mo>           <mi>E</mi>          </mrow>          <mrow>           <mo>&#x2202;</mo>           <msub>            <mi>b</mi>            <mrow>             <mi>i</mi>             <mo>,</mo>             <mi>t</mi>            </mrow>           </msub>          </mrow>         </mfrac>         <mo>=</mo>         <msub>          <mi>&#x3b4;</mi>          <mrow>           <mi>i</mi>           <mo>,</mo>           <mi>t</mi>          </mrow>         </msub>        </mrow>       </mtd>      </mtr>     </mtable>    </mtd>   </mtr>   <mtr>    <mtd>     <mrow>      <mfrac>       <mrow>        <mo>&#x2202;</mo>        <mi>E</mi>       </mrow>       <mrow>        <mo>&#x2202;</mo>        <msub>         <mi>b</mi>         <mrow>          <mi>c</mi>          <mo>,</mo>          <mi>t</mi>         </mrow>        </msub>       </mrow>      </mfrac>      <mo>=</mo>      <msub>       <mi>&#x3b4;</mi>       <mrow>        <mover>         <mi>c</mi>         <mo>~</mo>        </mover>        <mo>,</mo>        <mi>t</mi>       </mrow>      </msub>     </mrow>    </mtd>   </mtr>  </mtable> </mrow></math></maths></p><p id="p-0109" num="0074">Wherein E is an error, h<sub>1&#x2212;1</sub><sup>T </sup>is a transpose of h<sub>t&#x2212;1</sub>, x<sub>t</sub><sup>T </sup>is a transpose of x<sub>t</sub>, and W<sub>oh,t </sub>is the W<sub>oh </sub>at the time moment t. Similarly, W<sub>fh,t</sub>, W<sub>ih,t</sub>, W<sub>ch,t</sub>, W<sub>ox,t</sub>, W<sub>fx,t</sub>, W<sub>ix,t</sub>, W<sub>cx,t</sub>, b<sub>o,t</sub>, b<sub>f,t</sub>, b<sub>i,t </sub>and b<sub>c,t </sub>are W<sub>fh</sub>, W<sub>ih</sub>, W<sub>ch</sub>, W<sub>ox</sub>, W<sub>fx</sub>, W<sub>ix</sub>, W<sub>cx</sub>, b<sub>o</sub>, b<sub>f</sub>, b<sub>i </sub>and b<sub>c </sub>at the time moment t.</p><p id="p-0110" num="0075">According to the continuity and time sequence characteristics of the rolling process, the invention selects the LSTM (Long Short-Term Memory) neural network model. The LSTM is a long-term and short-term memory network, which is a time recurrent neural network (RNN), and is mainly used to solve the problem of gradient disappearance and gradient explosion in the long sequence training process. In short, the LSTM can perform better in longer sequences than ordinary RNN.</p><p id="p-0111" num="0076">The invention selects the LSTM network to predict the roll-bending force. Different from the traditional neural network or other machine learning methods, the invention does not need to acquire a large number of input parameters that affect the roll-bending force in advance, and thus the preliminary data preparation work is simplified, and only the roll-bending force data of each moment acquired till the current moment are formed to be a time series as an input and sent to the network, so as to train the LSTM network and predict the roll-bending force at the subsequent time moments.</p><p id="p-0112" num="0077">The invention adopts three different LSTM network models to predict the roll-bending force. In addition to the traditional LSTM network, two improved LSTM networks are also proposed for experiments. The two improved LSTM networks are:</p><p id="p-0113" num="0078">(1) ON-LSTM network: The ON-LSTM network adds an update mechanism on the basis of the traditional LSTM network, and compared with the traditional LSTM, the ON-LSTM can effectively enhance the robustness of the network and improve the accuracy of the network; and</p><p id="p-0114" num="0079">(2) Double-layer ON-LSTM: The double-layer ON-LSTM network organically combines the update mechanism with the double-layer structure. Because the double-layer structure has strong function fitting ability, the double-layer ON-LSTM can further improve the prediction accuracy of the network on the basis of the ON-LSTM.</p><p id="p-0115" num="0080">In order to prove the effectiveness of the LSTM (traditional LSTM, ON-LSTM, double-layer ON-LSTM) network model provided by the invention, the roll-bending force data of a 1580 mm hot rolling process of a stainless steel rolling mill are acquired and divided into three different datasets, and each dataset contains 500 sample points. The traditional LSTM network, the ON-LSTM network and the double-layer ON-LSTM network are subjected to experiment on the above three datasets, respectively, and the artificial neural network (ANN) is used to do an experiment with the same dataset to compare the experiment results. The maximum and average errors of three different network models on the three datasets are shown as <figref idref="DRAWINGS">FIGS. <b>5</b>A-<b>5</b>C</figref>. According to <figref idref="DRAWINGS">FIGS. <b>5</b>A-<b>5</b>C</figref>, it can be seen that the prediction errors of the three LSTM networks are far smaller than those of the ANN network. Good performance is achieved on the three datasets 1-3 (The acquired roll-bending force data are cut and divided into the datasets 1-3, which selects three representative pieces of different data as three datasets for the experiments) in three LSTM networks, and it can be found that the ON-LSTM network with the update mechanism is better than the traditional LSTM network. In addition, after constructing the ON-LSTM into the double-layer structure, the network performance is further improved, and the double-layer ON-LSTM network has the smallest error and the best performance among the three LSTM networks.</p><p id="p-0116" num="0081">First 450 sample points are taken from three different datasets for network training, and the trained LSTM networks are used to predict next 50 sample points, namely the roll-bending force data at the next 50 sample points. The results are shown as <figref idref="DRAWINGS">FIGS. <b>6</b>A-<b>6</b>C</figref>, <figref idref="DRAWINGS">FIGS. <b>7</b>A-<b>7</b>C</figref> and <figref idref="DRAWINGS">FIGS. <b>8</b>A-<b>8</b>C</figref>, and it can be seen that the three LSTM networks provided by the invention can effectively predict the roll-bending force data in the subsequent time moment, and have good fitting ability. The degree of excellence of the three LSTM networks is from high to low: the double-layer ON-LSTM, the ON-LSTM and the traditional LSTM.</p><p id="p-0117" num="0082">Under the condition of keeping the used dataset, the number of training samples, the number of prediction samples and the like unchanged, the LSTM networks used in the invention are replaced with the ANN network for comparative experiments. The results are shown as <figref idref="DRAWINGS">FIGS. <b>9</b>A to <b>9</b>C</figref>. Experiment results show that the results obtained by using the ANN network to predict the roll-bending force have a large error, and the effect is far less than the prediction effect of the three LSTM networks provided by the invention. By comparing with the ANN network, it can be seen that the LSTM networks have a strong advantage in the aspect of processing continuous time sequence, and can effectively solve the roll-bending force prediction problem, thereby having great practical significance and application value.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001" nb-file="US20230004781A1-20230105-M00001.NB"><img id="EMI-M00001" he="12.36mm" wi="76.20mm" file="US20230004781A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00002" nb-file="US20230004781A1-20230105-M00002.NB"><img id="EMI-M00002" he="9.14mm" wi="76.20mm" file="US20230004781A1-20230105-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00003" nb-file="US20230004781A1-20230105-M00003.NB"><img id="EMI-M00003" he="9.14mm" wi="76.20mm" file="US20230004781A1-20230105-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00004" nb-file="US20230004781A1-20230105-M00004.NB"><img id="EMI-M00004" he="12.36mm" wi="76.20mm" file="US20230004781A1-20230105-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00005" nb-file="US20230004781A1-20230105-M00005.NB"><img id="EMI-M00005" he="9.14mm" wi="76.20mm" file="US20230004781A1-20230105-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00006" nb-file="US20230004781A1-20230105-M00006.NB"><img id="EMI-M00006" he="9.14mm" wi="76.20mm" file="US20230004781A1-20230105-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00007" nb-file="US20230004781A1-20230105-M00007.NB"><img id="EMI-M00007" he="40.56mm" wi="76.20mm" file="US20230004781A1-20230105-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00008" nb-file="US20230004781A1-20230105-M00008.NB"><img id="EMI-M00008" he="15.83mm" wi="76.20mm" file="US20230004781A1-20230105-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00009" nb-file="US20230004781A1-20230105-M00009.NB"><img id="EMI-M00009" he="28.19mm" wi="76.20mm" file="US20230004781A1-20230105-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00010" nb-file="US20230004781A1-20230105-M00010.NB"><img id="EMI-M00010" he="15.83mm" wi="76.20mm" file="US20230004781A1-20230105-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00011 MATH-US-00011-2" nb-file="US20230004781A1-20230105-M00011.NB"><img id="EMI-M00011" he="55.71mm" wi="76.20mm" file="US20230004781A1-20230105-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00012" nb-file="US20230004781A1-20230105-M00012.NB"><img id="EMI-M00012" he="27.18mm" wi="76.20mm" file="US20230004781A1-20230105-M00012.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00013" nb-file="US20230004781A1-20230105-M00013.NB"><img id="EMI-M00013" he="12.36mm" wi="76.20mm" file="US20230004781A1-20230105-M00013.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00014" nb-file="US20230004781A1-20230105-M00014.NB"><img id="EMI-M00014" he="9.14mm" wi="76.20mm" file="US20230004781A1-20230105-M00014.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00015" nb-file="US20230004781A1-20230105-M00015.NB"><img id="EMI-M00015" he="9.14mm" wi="76.20mm" file="US20230004781A1-20230105-M00015.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. An LSTM-based hot-rolling roll-bending force predicting method, comprising the following steps:<claim-text><b>1</b>) acquiring final rolling data of a stand of a stainless steel rolling mill when performing a hot rolling process, and collecting roll-bending force data for experiment;</claim-text><claim-text><b>2</b>) dividing the roll-bending force data into two parts: a training set traindata and a test set testdata according to a specified ratio in time sequence;</claim-text><claim-text><b>3</b>) normalizing the traindata to obtain a normalized vector A;</claim-text><claim-text><b>4</b>) building a matrix P by using the vector A in step 3);</claim-text><claim-text><b>5</b>) taking first m rows of the matrix P in step 4) as an input and sending the first m rows to an LSTM network;</claim-text><claim-text><b>6</b>) using a last row of the matrix P as a label, namely a true value, of the training set, performing calculation on an output value and the true value of the LSTM network by using a formula to obtain an error, and updating a weight and a bias of the LSTM network by a gradient descent method;</claim-text><claim-text><b>7</b>) after the LSTM network training is completed, taking last m output data of the LSTM network as an input at a next moment, and then obtaining the output of the LSTM network at the next moment, wherein the output is a predicted value of a roll-bending force at the next moment;</claim-text><claim-text><b>8</b>) repeating step 7) until a sufficient number of prediction data is obtained; and</claim-text><claim-text><b>9</b>) performing an inverse normalization on the obtained predicted value of the roll-bending force, and comparing the processed data with the true value in the testdata to check the validity of the LSTM network.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The LSTM-based hot-rolling roll-bending force predicting method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein in step 4), a matrix</claim-text><claim-text><maths id="MATH-US-00013" num="00013"><math overflow="scroll"> <mrow>  <mrow>   <mi>P</mi>   <mo>=</mo>   <mrow>    <mo>[</mo>    <mtable>     <mtr>      <mtd>       <msub>        <mi>a</mi>        <mn>1</mn>       </msub>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mn>2</mn>       </msub>      </mtd>      <mtd>       <mo>&#x2026;</mo>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>n</mi>         <mo>-</mo>         <mi>m</mi>        </mrow>       </msub>      </mtd>     </mtr>     <mtr>      <mtd>       <msub>        <mi>a</mi>        <mn>2</mn>       </msub>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mn>3</mn>       </msub>      </mtd>      <mtd>       <mo>&#x2026;</mo>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>n</mi>         <mo>-</mo>         <mi>m</mi>         <mo>+</mo>         <mn>1</mn>        </mrow>       </msub>      </mtd>     </mtr>     <mtr>      <mtd>       <mo>&#x22ee;</mo>      </mtd>      <mtd>       <mo>&#x22ee;</mo>      </mtd>      <mtd>       <mo>&#x22f1;</mo>      </mtd>      <mtd>       <mo>&#x22ee;</mo>      </mtd>     </mtr>     <mtr>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>m</mi>         <mo>+</mo>         <mn>1</mn>        </mrow>       </msub>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mrow>         <mi>m</mi>         <mo>+</mo>         <mn>2</mn>        </mrow>       </msub>      </mtd>      <mtd>       <mo>&#x2026;</mo>      </mtd>      <mtd>       <msub>        <mi>a</mi>        <mi>n</mi>       </msub>      </mtd>     </mtr>    </mtable>    <mo>]</mo>   </mrow>  </mrow>  <mo>,</mo> </mrow></math></maths><claim-text>wherein a parameter m is the number of input layer units of a neural network, and n is the number of samples contained in a neural network training set.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The LSTM-based hot-rolling roll-bending force predicting method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein in step 5), the LSTM network adopts a traditional LSTM network, or adopts an ON-LSTM network or a double-layer ON-LSTM network, and the double-layer ON-LSTM network is adopted as:<claim-text>taking the first m rows of the matrix P in step 4) as an input of a first-layer LSTM, and sending obtained output data as an input to a second-layer LSTM, wherein output data of the second-layer LSTM is an output of the whole LSTM network.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The LSTM-based hot-rolling roll-bending force predicting method of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the first layer LSTM and the second layer LSTM of the double-layer ON-LSTM network introduce an ordered neurons LSTM of an update mechanism, namely ON-LSTM, and when parameters of the LSTM are updated, neurons are sorted, and an importance level, namely a hierarchical structure, is introduced; higher-level information represents important information, which needs to be retained in the LSTM network; on the contrary, lower-level information represents unimportant information, which needs to be updated with new input data; and a detailed process and calculation formula are as follows:<claim-text>assuming that a primary hierarchical position corresponding to the important information is represented by S1, a secondary hierarchical position corresponding to the unimportant information is represented by S2, and S1 and S2 are respectively calculated as:<claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>1<i>=F</i><sub>1</sub>(<i>x</i><sub>t</sub><i>,h</i><sub>t&#x2212;1</sub>)=index max(soft max(<i>W</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>2<i>=F</i><sub>2</sub>(<i>x</i><sub>t</sub><i>,h</i><sub>t&#x2212;1</sub>)=index max(soft max(<i>W</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text></claim-text><claim-text>wherein an indexmax function is used to find a position number corresponding to the largest element in the vector; x<sub>t </sub>is input data, h<sub>t&#x2212;1 </sub>is recursive data, W<sub>f</sub><sub><sup2>&#x2dc;</sup2></sub> and U<sub>f</sub><sub><sup2>&#x2dc;</sup2></sub> are main forget gate weight matrixes, b<sub>f</sub><sub><sup2>&#x2dc;</sup2></sub> is a main forget gate bias, W<sub>i</sub><sub><sup2>&#x2dc;</sup2></sub> and U<sub>i</sub><sub><sup2>&#x2dc;</sup2></sub> are main input gate weight matrixes, and b<sub>i</sub><sub><sup2>&#x2dc;</sup2></sub> is a main input gate bias;</claim-text><claim-text>when S2&#x2265;S1, positions corresponding to the important information and the unimportant information partially overlap, and the calculation formula of a current cell state c<sub>t </sub>is:</claim-text></claim-text><claim-text><maths id="MATH-US-00014" num="00014"><math overflow="scroll"> <mrow>  <msub>   <mi>c</mi>   <mi>t</mi>  </msub>  <mo>=</mo>  <mrow>   <mo>(</mo>   <mtable>    <mtr>     <mtd>      <mtable>       <mtr>        <mtd>         <mrow>          <msub>           <mi>c</mi>           <mrow>            <mi>t</mi>            <mo>-</mo>            <mn>1</mn>           </mrow>          </msub>          <mo>[</mo>          <mrow>           <mrow>            <mi>S</mi>            <mo>&#x2062;</mo>            <mn>2</mn>           </mrow>           <mo>,</mo>           <mi>k</mi>          </mrow>          <mo>]</mo>         </mrow>        </mtd>       </mtr>       <mtr>        <mtd>         <mrow>          <mrow>           <mo>(</mo>           <mrow>            <mrow>             <msub>              <mi>f</mi>              <mi>t</mi>             </msub>             <mo>&#x2218;</mo>             <msub>              <mi>c</mi>              <mrow>               <mi>t</mi>               <mo>-</mo>               <mn>1</mn>              </mrow>             </msub>            </mrow>            <mo>+</mo>            <mrow>             <msub>              <mi>i</mi>              <mi>t</mi>             </msub>             <mo>&#x2218;</mo>             <msub>              <mover>               <mi>c</mi>               <mo>~</mo>              </mover>              <mi>t</mi>             </msub>            </mrow>           </mrow>           <mo>)</mo>          </mrow>          <mo>&#x2062;</mo>          <mrow>           <mo>(</mo>           <mrow>            <mrow>             <mi>S</mi>             <mo>&#x2062;</mo>             <mn>1</mn>            </mrow>            <mo>,</mo>            <mrow>             <mi>S</mi>             <mo>&#x2062;</mo>             <mn>2</mn>            </mrow>           </mrow>           <mo>)</mo>          </mrow>         </mrow>        </mtd>       </mtr>      </mtable>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <msub>        <mover>         <mi>c</mi>         <mo>~</mo>        </mover>        <mi>t</mi>       </msub>       <mo>[</mo>       <mrow>        <mn>1</mn>        <mo>,</mo>        <mrow>         <mi>S</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </mrow>       <mo>]</mo>      </mrow>     </mtd>    </mtr>   </mtable>   <mo>)</mo>  </mrow> </mrow></math></maths><claim-text>when S2&#x3c;S1, positions corresponding to the important information and the unimportant information are independent of each other, and the current cell state c<sub>t </sub>is calculated by the following formula:</claim-text></claim-text><claim-text><maths id="MATH-US-00015" num="00015"><math overflow="scroll"> <mrow>  <msub>   <mi>c</mi>   <mi>t</mi>  </msub>  <mo>=</mo>  <mrow>   <mo>(</mo>   <mtable>    <mtr>     <mtd>      <mtable>       <mtr>        <mtd>         <mrow>          <msub>           <mi>c</mi>           <mrow>            <mi>t</mi>            <mo>-</mo>            <mn>1</mn>           </mrow>          </msub>          <mo>[</mo>          <mrow>           <mrow>            <mi>S</mi>            <mo>&#x2062;</mo>            <mn>1</mn>           </mrow>           <mo>,</mo>           <mi>k</mi>          </mrow>          <mo>]</mo>         </mrow>        </mtd>       </mtr>       <mtr>        <mtd>         <mrow>          <mn>0</mn>          <mo>&#x2062;</mo>          <mrow>           <mo>(</mo>           <mrow>            <mrow>             <mi>S</mi>             <mo>&#x2062;</mo>             <mn>2</mn>            </mrow>            <mo>,</mo>            <mrow>             <mi>S</mi>             <mo>&#x2062;</mo>             <mn>1</mn>            </mrow>           </mrow>           <mo>)</mo>          </mrow>         </mrow>        </mtd>       </mtr>      </mtable>     </mtd>    </mtr>    <mtr>     <mtd>      <mrow>       <msub>        <mover>         <mi>c</mi>         <mo>~</mo>        </mover>        <mi>t</mi>       </msub>       <mo>[</mo>       <mtable>        <mtr>         <mtd>          <mrow>           <mn>1</mn>           <mo>,</mo>          </mrow>         </mtd>         <mtd>          <mrow>           <mi>S</mi>           <mo>&#x2062;</mo>           <mn>2</mn>          </mrow>         </mtd>        </mtr>       </mtable>       <mo>]</mo>      </mrow>     </mtd>    </mtr>   </mtable>   <mo>)</mo>  </mrow> </mrow></math></maths><claim-text>wherein k is the dimension of c<sub>t</sub>, f<sub>t </sub>and i<sub>t </sub>are forget gate output and input gate output, respectively, {tilde over (c)}<sub>t </sub>is an intermediate unit state, and c<sub>t&#x2212;1 </sub>is a cell state at a previous time moment.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The LSTM-based hot-rolling roll-bending force predicting method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein {tilde over (f)}<sub>t </sub>and &#x129;<sub>t </sub>are defined as a main forget gate and a main input gate, respectively, and wherein w<sub>t1</sub>, w<sub>t2 </sub>and w<sub>t3 </sub>represent high, medium and low levels in the hierarchical structure, respectively,<claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>{tilde over (f)}</i><sub>t</sub>=cumsum(soft max(<i>W</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>f</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>&#x129;</i><sub>t</sub>=1&#x2212;cumsum(soft max(<i>W</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>x</i><sub>t</sub><i>+U</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub><i>h</i><sub>t&#x2212;1</sub><i>+b</i><sub>i</sub><sub><sup2>&#x2dc;</sup2></sub>))<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>t2</sub><i>={tilde over (f)}</i><sub>t</sub><i>&#x2218;&#x129;</i><sub>t </sub><?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>t1</sub><i>={tilde over (f)}</i><sub>t</sub><i>&#x2212;W</i><sub>t2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i><sub>t3</sub><i>=&#x129;</i><sub>t</sub><i>&#x2212;W</i><sub>t2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text>wherein {tilde over (f)}<sub>t </sub>is a main forget gate output, and &#x129;<sub>t </sub>is a main input gate output.</claim-text></claim-text></claim></claims></us-patent-application>