<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007294A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007294</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17781165</doc-number><date>20201203</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="regional"><country>EP</country><doc-number>19214124.0</doc-number><date>20191206</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>50</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>169</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>186</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>50</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>1887</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20141101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>N</subclass><main-group>19</main-group><subgroup>186</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">CASCADE PREDICTION</invention-title><us-related-documents><us-provisional-application><document-id><country>US</country><doc-number>62944636</doc-number><date>20191206</date></document-id></us-provisional-application></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>Dolby Laboratories Licensing Corporation</orgname><address><city>San Francisco</city><state>CA</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>KADU</last-name><first-name>Harshad</first-name><address><city>Santa Clara</city><state>CA</state><country>US</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>SU</last-name><first-name>Guan-Ming</first-name><address><city>Fremont</city><state>CA</state><country>US</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>Dolby Laboratories Licensing Corporation</orgname><role>02</role><address><city>San Francisco</city><state>CA</state><country>US</country></address></addressbook></assignee></assignees><pct-or-regional-filing-data><document-id><country>WO</country><doc-number>PCT/US2020/063165</doc-number><date>20201203</date></document-id><us-371c12-date><date>20220531</date></us-371c12-date></pct-or-regional-filing-data></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A first predictor is applied to an input image to generate first-stage predicted codewords approximating prediction target codewords of a prediction target image. Second-stage prediction target values are created by performing an inverse cascade operation on the prediction target codewords and the first-stage predicted codewords. A second predictor is applied to the input image to generate second-stage predicted values approximating the second-stage prediction target values. Multiple sets of cascade prediction coefficients are generated to comprise first and second sets of cascade prediction coefficients specifying the first and second predictors. The multiple sets of cascade prediction coefficients are encoded, in a video signal, as image metadata. The video signal is further encoded with the input image.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="127.08mm" wi="158.75mm" file="US20230007294A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="250.36mm" wi="168.32mm" file="US20230007294A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="241.81mm" wi="168.83mm" file="US20230007294A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="207.69mm" wi="168.40mm" orientation="landscape" file="US20230007294A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="195.75mm" wi="165.86mm" orientation="landscape" file="US20230007294A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="204.30mm" wi="165.10mm" orientation="landscape" file="US20230007294A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="201.34mm" wi="165.95mm" orientation="landscape" file="US20230007294A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="255.10mm" wi="157.73mm" orientation="landscape" file="US20230007294A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="223.86mm" wi="161.21mm" file="US20230007294A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="211.92mm" wi="121.07mm" orientation="landscape" file="US20230007294A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading><p id="p-0002" num="0001">This application claims priority to European Patent Application No. 19214124.0 filed 6 Dec. 2019 and U.S. Provisional Patent Application No. 62/944,636 filed 6 Dec. 2019, which are incorporated herein by reference.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">TECHNOLOGY</heading><p id="p-0003" num="0002">The present disclosure relates generally to image processing operations. More particularly, an embodiment of the present disclosure relates to video codecs.</p><heading id="h-0003" level="1">BACKGROUND</heading><p id="p-0004" num="0003">As used herein, the term &#x201c;dynamic range&#x201d; (DR) may relate to a capability of the human visual system (HVS) to perceive a range of intensity (e.g., luminance, luma) in an image, e.g., from darkest blacks (darks) to brightest whites (highlights). In this sense, DR relates to a &#x201c;scene-referred&#x201d; intensity. DR may also relate to the ability of a display device to adequately or approximately render an intensity range of a particular breadth. In this sense, DR relates to a &#x201c;display-referred&#x201d; intensity. Unless a particular sense is explicitly specified to have particular significance at any point in the description herein, it should be inferred that the term may be used in either sense, e.g. interchangeably.</p><p id="p-0005" num="0004">As used herein, the term high dynamic range (HDR) relates to a DR breadth that spans the some 14-15 or more orders of magnitude of the human visual system (HVS). In practice, the DR over which a human may simultaneously perceive an extensive breadth in intensity range may be somewhat truncated, in relation to HDR. As used herein, the terms enhanced dynamic range (EDR) or visual dynamic range (VDR) may individually or interchangeably relate to the DR that is perceivable within a scene or image by a human visual system (HVS) that includes eye movements, allowing for some light adaptation changes across the scene or image. As used herein, EDR may relate to a DR that spans 5 to 6 orders of magnitude. Thus while perhaps somewhat narrower in relation to true scene referred HDR, EDR nonetheless represents a wide DR breadth and may also be referred to as HDR.</p><p id="p-0006" num="0005">In practice, images comprise one or more color components (e.g., luma Y and chroma Cb and Cr) of a color space, where each color component is represented by a precision of n-bits per pixel (e.g., n=8). Using non-linear luminance coding (e.g., gamma encoding), images where n&#x2264;8 (e.g., color 24-bit JPEG images) are considered images of standard dynamic range, while images where n&#x3e;8 may be considered images of enhanced dynamic range.</p><p id="p-0007" num="0006">A reference electro-optical transfer function (EOTF) for a given display characterizes the relationship between color values (e.g., luminance) of an input video signal to output screen color values (e.g., screen luminance) produced by the display. For example, ITU Rec. ITU-R BT. 1886, &#x201c;Reference electro-optical transfer function for flat panel displays used in HDTV studio production,&#x201d; (March 2011), which is incorporated herein by reference in its entirety, defines the reference EOTF for flat panel displays. Given a video stream, information about its EOTF may be embedded in the bitstream as (image) metadata. The term &#x201c;metadata&#x201d; herein relates to any auxiliary information transmitted as part of the coded bitstream and assists a decoder to render a decoded image. Such metadata may include, but are not limited to, color space or gamut information, reference display parameters, and auxiliary signal parameters, as those described herein.</p><p id="p-0008" num="0007">The term &#x201c;PQ&#x201d; as used herein refers to perceptual luminance amplitude quantization. The human visual system responds to increasing light levels in a very nonlinear way. A human's ability to see a stimulus is affected by the luminance of that stimulus, the size of the stimulus, the spatial frequencies making up the stimulus, and the luminance level that the eyes have adapted to at the particular moment one is viewing the stimulus. In some embodiments, a perceptual quantizer function maps linear input gray levels to output gray levels that better match the contrast sensitivity thresholds in the human visual system. An example PQ mapping function is described in SMPTE ST 2084:2014 &#x201c;High Dynamic Range EOTF of Mastering Reference Displays&#x201d; (hereinafter &#x201c;SMPTE&#x201d;), which is incorporated herein by reference in its entirety, where given a fixed stimulus size, for every luminance level (e.g., the stimulus level, etc.), a minimum visible contrast step at that luminance level is selected according to the most sensitive adaptation level and the most sensitive spatial frequency (according to HVS models).</p><p id="p-0009" num="0008">Displays that support luminance of 200 to 1,000 cd/m<sup>2 </sup>or nits typify a lower dynamic range (LDR), also referred to as a standard dynamic range (SDR), in relation to EDR (or HDR). EDR content may be displayed on EDR displays that support higher dynamic ranges (e.g., from 1,000 nits to 5,000 nits or more). Such displays may be defined using alternative EOTFs that support high luminance capability (e.g., 0 to 10,000 or more nits). An example of such an EOTF is defined in SMPTE 2084 and Rec. ITU-R BT.100<i>, &#x201c;Image parameter values for high dynamic range television for use in production and international programme exchange</i>,&#x201d; (June 2017). As appreciated by the inventors here, improved techniques for composing video content data that can be used to support display capabilities of a wide variety of SDR and HDR display devices are desired.</p><p id="p-0010" num="0009">The approaches described in this section are approaches that could be pursued, but not necessarily approaches that have been previously conceived or pursued. Therefore, unless otherwise indicated, it should not be assumed that any of the approaches described in this section qualify as prior art merely by virtue of their inclusion in this section. Similarly, issues identified with respect to one or more approaches should not assume to have been recognized in any prior art on the basis of this section, unless otherwise indicated.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0011" num="0010">An embodiment of the present invention is illustrated by way of example, and not by way of limitation, in the figures of the accompanying drawings and in which like reference numerals refer to similar elements and in which:</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>1</b>A</figref> depicts an example process of a video delivery pipeline; <figref idref="DRAWINGS">FIG. <b>1</b>B</figref> through <figref idref="DRAWINGS">FIG. <b>1</b>F</figref> illustrate example codecs implementing cascade prediction operations;</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> through <figref idref="DRAWINGS">FIG. <b>2</b>D</figref> illustrate example distributions and correlations of input codewords and predicted codewords;</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>3</b>A</figref> illustrates an example single-layer backward compatible (SLBC) codec; <figref idref="DRAWINGS">FIG. <b>3</b>B</figref> illustrates an example single-layer inverse display management (SLiDM) codec;</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>4</b>A</figref> and <figref idref="DRAWINGS">FIG. <b>4</b>B</figref> illustrate example process flows; and</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates a simplified block diagram of an example hardware platform on which a computer or a computing device as described herein may be implemented.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0005" level="1">DESCRIPTION OF EXAMPLE EMBODIMENTS</heading><p id="p-0017" num="0016">In the following description, for the purposes of explanation, numerous specific details are set forth in order to provide a thorough understanding of the present disclosure. It will be apparent, however, that the present disclosure may be practiced without these specific details. In other instances, well-known structures and devices are not described in exhaustive detail, in order to avoid unnecessarily occluding, obscuring, or obfuscating the present disclosure.</p><p id="p-0018" num="0017">Summary</p><p id="p-0019" num="0018">Cascade prediction methods as described herein can be implemented and performed in a wide variety of video delivery and display applications including but not limited to those supporting backward compatibility. In some operational scenarios, base layer (BL) image data may be encoded in a first domain (e.g., of a first dynamic range, in a first color space, corresponding to a first Electro-Optic Transfer Function or EOTF, etc.) in a coded bitstream along with image metadata used for generating/reconstructing image data coded in a second domain (e.g., of a second dynamic range, in a second color space, corresponding to a second EOTF, etc.) from the BL image data encoded in the first domain. The BL image data and the image metadata can be provided to recipient decoding and playback devices, which may directly render the BL image data (e.g., of the first dynamic range, in the first color space, corresponding to the first EOTF, etc.) after decoding on displays supporting rendering images in the first domain or which may reconstruct image data in the second domain from the decoded BL image data and image metadata and render the reconstructed image data (e.g., of the second dynamic range, in the second color space, corresponding to the second EOTF, etc.) on displays supporting rendering images in the second domain. The BL or input image data in the first domain and the reconstructed or output image data in the second domain may be of different dynamic ranges. Additionally, optionally or alternatively, the BL or input image data in the first domain and the reconstructed or output image data in the second domain may be of the same dynamic range; however the BL or input image data and the reconstructed or output image data may be in different color spaces and/or may correspond to different EOTFs. For example, the BL or input image data in the first domain may be of a dynamic range with a maximum luminance 1000 nits in an R.2020 color space corresponding to an HLG EOTF, whereas the reconstructed or output image data may be of the same dynamic range with a maximum luminance 1000 nits in an R.2020 color space corresponding to an PQ EOTF. In this example, the first domain and the second domain both have the same dynamic range with the maximum luminance 1000 nits and are also in the same color space; however, the BL or input image data and the reconstructed or output image data may be coded according to, or correspond to, different EOTFs. Thus, so long as at least one attribute of a domain&#x2014;e.g., among dynamic range, color space or EOTF&#x2014;in which image data is represented/coded is different between the BL or input image data and the reconstructed or output image data, cascade prediction methods as described herein may be applied. As a result, image data coded in a coded bit stream for a domain supported by some display devices can be used to generate reconstructed image data for one or more other domains supported by some other display devices without needing to other image data for the other domains in the coded bit stream. In some operational scenarios, a wide variety of display device types supporting display or image processing operations in various domains may be supported by coded streams generated under techniques as described herein.</p><p id="p-0020" num="0019">In some operational scenarios, multiple different sets of cascade prediction coefficients may be generated to support various video quality levels in reconstructed image data. For example, a first set of cascade prediction coefficients may be used to construct a first predicted video signal with reconstructed image data to support a first video quality level. A second set of cascade prediction coefficients may be used to construct a refinement signal, which when combined with the first predicted signal gives rise to a second predicted signal with reconstructed image data to support a second video quality level higher than the first video quality level. The different sets of cascade prediction coefficients may be used to support different versions of video decoders or playback devices. Some of the video decoders or playback devices, which may be widely deployed in the field, may only recognize the first set of cascade prediction coefficients and apply the first set of cascade prediction coefficients in prediction operations accordingly. Video quality levels can be gradually improved when additional set(s) of prediction coefficients are recognized and applied in prediction operations by relatively advanced video decoders or playback devices.</p><p id="p-0021" num="0020">Example embodiments described herein relate to generating and encoding cascade prediction metadata for image reconstruction. A first predictor is applied to an input image coded in a first domain to generate first-stage predicted codewords approximating prediction target codewords of a prediction target image coded in a second domain that is different from the first domain. Second-stage prediction target values are created by performing an inverse cascade operation on the prediction target codewords and the first-stage predicted codewords. A second predictor is applied to the input image in the first domain to generate second-stage predicted values approximating the second-stage prediction target values. Multiple sets of cascade prediction coefficients are generated to comprise a first set of cascade prediction coefficients specifying the first predictor and a second different set of cascade prediction coefficients specifying the second predictor. The multiple sets of cascade prediction coefficients are encoded, in a video signal, as image metadata. The video signal is further encoded with the input image In the first domain. A recipient device of the video signal uses the multiple sets of cascade prediction coefficients to apply the first predictor and the second predictor to the input image to generate a predicted image in the second domain. The predicted image in the second domain approximates the prediction target image in the second domain.</p><p id="p-0022" num="0021">Example embodiments described herein relate to decoding cascade prediction metadata for image reconstruction and rendering. An input image coded in a first domain is decoded from a video signal. Image metadata comprising multiple sets of cascade prediction coefficients is decoded from the video signal. The multiple sets of cascade prediction coefficients were generated by an upstream image processing device to comprise a first set of cascade prediction coefficients, generated based at least in part on a prediction target image coded in a second domain, specifying a first predictor and a second set of cascade prediction coefficients, generated based at least in part on the prediction target image in the second domain, specifying a second predictor. The first domain is different from the second domain. The first predictor and the second predictor, as joined by a cascade operation, are applied to the input image in the first domain to generate a reconstructed image in the second domain to approximate the prediction target image in the second domain. A display image derived from the reconstructed image in the second domain is caused to be rendered with a display device.</p><p id="p-0023" num="0022">Example Video Delivery Processing Pipeline</p><p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. <b>1</b>A</figref> depicts an example process of a video delivery pipeline (<b>100</b>) showing various stages from video capture to video content display. A sequence of video frames (<b>102</b>) is captured or generated using image generation block (<b>105</b>). Video frames (<b>102</b>) may be digitally captured (e.g. by a digital camera, etc.) or generated by a computer (e.g. using computer animation, etc.) to provide video data (<b>107</b>). Additionally, optionally or alternatively, video frames (<b>102</b>) may be captured on film by a film camera. The film can be converted to a digital format to provide the video data (<b>107</b>). In a production phase (<b>110</b>), the video data (<b>107</b>) is edited to provide a video production stream (<b>112</b>).</p><p id="p-0025" num="0024">The video data of the production stream (<b>112</b>) is then provided to a processor for post-production editing (<b>115</b>). The post-production editing (<b>115</b>) may include adjusting or modifying colors or brightness in particular areas of an image to enhance the image quality or achieve a particular appearance for the image in accordance with the video creator's creative intent. This is sometimes called &#x201c;color timing&#x201d; or &#x201c;color grading.&#x201d; Other editing (e.g. scene selection and sequencing, manual and/or automatic scene cut information generation, image cropping, addition of computer-generated visual special effects, etc.) may be performed at the post-production editing (<b>115</b>) to yield a release version of HDR images (<b>117</b>-<b>1</b>) or SDR (or relatively narrow dynamic range) images (<b>117</b>) (e.g., SDR, etc.). In some embodiments, during post-production editing (<b>115</b>), the HDR images (<b>117</b>-<b>1</b>) are viewed on a reference HDR display that supports the high dynamic range by a colorist who is performing post-production editing operations on the HDR images (<b>117</b>-<b>1</b>). Additionally, optionally or alternatively, during post-production editing (<b>115</b>), the SDR images (<b>117</b>) are viewed on a reference display (<b>125</b>) that supports the standard dynamic range (or a relatively narrow dynamic range) by a colorist who is performing post-production editing operations on the SDR images (<b>117</b>). Additionally, optionally or alternatively, the SDR images (<b>117</b>) may be content mapped from the HDR images (<b>117</b>-<b>1</b>).</p><p id="p-0026" num="0025">In some embodiments, the coding block (<b>120</b>) may implement some or all of cascade prediction operations to generate multiple sets of cascade prediction coefficients. The coding block (<b>120</b>) receives the HDR images (<b>117</b>-<b>1</b>) from the post-production editing (<b>115</b>), and forward reshapes the HDR images (<b>117</b>-<b>1</b>) into (forward) reshaped SDR images. The forward reshaped SDR images may closely approximate the SDR images (<b>117</b>) (if available) from color grading operations. For the purpose of illustration only, the coding block (<b>120</b>) is to generate a coded bitstream that includes SDR images (e.g., forward reshaped SDR images, etc.) and image metadata used by a recipient device of the coded bitstream to reconstruct HDR image from the SDR images. It should be noted, however, that in various embodiments, image data coded/represented in a first domain may be encoded in a coded bitstream along with image metadata used by a recipient device of the coded bitstream to reconstruct image data coded in a second domain from the image data in the first domain.</p><p id="p-0027" num="0026">In some embodiments, the coding block (<b>120</b>) may include audio and video encoders, such as those defined by ATSC, DVB, DVD, Blu-Ray, and other delivery formats, to generate the coded bitstream (<b>122</b>).</p><p id="p-0028" num="0027">The forward reshaped SDR images can be compressed/encoded by the coding block (<b>120</b>) into a coded bitstream (<b>122</b>). The multiple sets of cascade prediction coefficients may be included or encoded in the same coded bitstream as a part of image metadata.</p><p id="p-0029" num="0028">The coded bitstream (<b>122</b>) may represent a video signal (e.g., an 8-bit SDR video signal, a 10-bit SDR video signal, etc.) that is backward compatible with a wide variety of SDR display devices (e.g., SDR displays, etc.). In a non-limiting example, the video signal encoded with the reshaped SDR images may be a single-layer backward compatible video signal. Here, a &#x201c;single-layer backward compatible video signal&#x201d; may refer to a video signal that carries SDR images that are specifically optimized or color graded for SDR displays in a single signal layer. Example single layer video coding operations are described in U.S. Provisional Patent Application No. 62/312,450, filed on Mar. 23, 2016, also published on Apr. 11, 2019, as U.S. Patent Application Publication Ser. No. 2019/011054, the entire contents of which are hereby incorporated by reference as if fully set forth herein.</p><p id="p-0030" num="0029">The multiple sets of cascade prediction coefficients may be decoded and used in cascade prediction operations by a recipient device of the video signal or coded bitstream to generate reconstructed HDR images from the decoded forward reshaped SDR images. The reconstructed HDR images may approximate corresponding input or source HDR images in the color graded HDR images (<b>117</b>-<b>1</b>). Different video quality levels may be generated for the reconstructed HDR images using cascade prediction operations (e.g., backward reshaping operations, inverse tone mapping operations, etc.) with the multiple sets of cascade prediction coefficients generated by the (upstream) coding block (<b>120</b>). A used herein, backward reshaping refers to image processing operations that convert images&#x2014;e.g., to be or as encoded in a coded bitstream&#x2014;of a first dynamic range to images of a second higher dynamic range. Forward reshaping refers to image processing operations that convert images of a second dynamic range to images&#x2014;e.g., to be or as encoded in a coded bitstream&#x2014;of a first higher dynamic range. Example reshaping operations are described in U.S. Provisional Application Ser. No. 62/136,402, filed on Mar. 20, 2015, (also published on Jan. 18, 2018, as U.S. Patent Application Publication Ser. No. 2018/0020224), the entire contents of which are hereby incorporated by reference as if fully set forth herein.</p><p id="p-0031" num="0030">Additionally, optionally, or alternatively, the coded bit stream (<b>122</b>) is encoded with additional image metadata including but not limited to display management (DM) metadata that can be used by the downstream decoders to perform display management operations on the backward reshaped images for the HDR reference displays to generate display images optimized for rendering on other displays such as non-reference HDR displays, etc.</p><p id="p-0032" num="0031">The coded bitstream (<b>122</b>) is then delivered downstream to receivers such as decoding and playback devices, media source devices, media streaming client devices, television sets (e.g., smart TVs, etc.), set-top boxes, movie theaters, and the like. In a receiver (or a downstream device), the coded bitstream (<b>122</b>) is decoded by decoding block (<b>130</b>) to generate decoded images <b>182</b>, which may be the same as the reshaped SDR images, subject to quantization errors generated in compression performed by the coding block (<b>120</b>) and decompression performed by the decoding block (<b>130</b>).</p><p id="p-0033" num="0032">In operational scenarios in which the receiver operates with (or is attached or operatively linked to) a target display <b>140</b> that supports the standard dynamic range or a relatively narrow dynamic range comparable with or less than the standard dynamic range, the decoding block (<b>130</b>) can decode the reshaped SDR images from (e.g., the single layer in, etc.) the coded bitstream (<b>122</b>), and use the decoded reshaped SDR images directly or indirectly for rendering on the target display (<b>140</b>). In embodiments in which the target display (<b>140</b>) is of similar characteristics as the SDR reference display (<b>125</b>), the reshaped SDR images can be directly watchable on the target display (<b>140</b>).</p><p id="p-0034" num="0033">In some embodiments, the receiver operates with (or is attached or operatively linked to) a HDR target display <b>140</b>-<b>1</b> that supports a high dynamic range (e.g., 400 nits, 1000 nits, 4000 nits, 10000 nits or more, etc.) can extract image metadata from (e.g., metadata container(s) in, etc.) the coded bitstream (<b>122</b>), use two or more of the multiple sets of cascade prediction coefficients in the image metadata (or composer metadata) to compose backward reshaped images <b>132</b>-<b>1</b> from the reshaped SDR images by backward reshaping&#x2014;including but not limited to performing cascade prediction operations on&#x2014;the reshaped SDR images based at least in part on the image metadata (composer metadata).</p><p id="p-0035" num="0034">In some operational scenarios, the backward reshaped images (<b>132</b>-<b>1</b>) represent reconstructed HDR images optimized for viewing on an HDR (e.g., reference, etc.) display that is the same as, or comparable with, an HDR target display operating in conjunction with the receiver. The receiver may directly use the backward reshaped images (<b>132</b>-<b>1</b>) for rendering on the HDR target display.</p><p id="p-0036" num="0035">In some operational scenarios, the backward reshaped images (<b>132</b>-<b>1</b>) represent reconstructed HDR images optimized for viewing on an HDR (e.g., reference, etc.) display that is not the same as an HDR target display (<b>140</b>-<b>1</b>) operating in conjunction with the receiver. A display management block (e.g., <b>135</b>-<b>1</b>, etc.)&#x2014;which may be in the receiver, in the HDR target display (<b>140</b>-<b>1</b>), or in a separate device&#x2014;further adjusts the backward reshaped images (<b>132</b>-<b>1</b>) to characteristics of the HDR target display (<b>140</b>-<b>1</b>) by generating a display-mapped signal (<b>137</b>-<b>1</b>) adapted to the characteristics of the HDR target display (<b>140</b>-<b>1</b>). Display images or the adjusted backward reshaped images may be rendered on the HDR target display (<b>140</b>-<b>1</b>).</p><p id="p-0037" num="0036">Video Codecs and Cascade Prediction</p><p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. <b>1</b>B</figref> illustrates example two-stage cascade prediction operations at the decoder side. As shown, an input signal is fed as input into a first prediction block (denoted as &#x201c;prediction 1&#x201d;), which generates a first predicted (video) signal (denoted as &#x201c;predicted signal 1&#x201d;) as output. The input signal is also fed as input into a second prediction block (denoted as &#x201c;prediction 2&#x201d;) to generate a predicted residual (video) signal as output. The first predicted signal as outputted from the first prediction block and the predicted residual signal as generated by the second prediction block are fed as input into a cascade operational block, which performs a merge operations (e.g., addition, multiplication, etc.) on the inputted signals to generate a second predicted (video) signal (denoted as &#x201c;predicted signal 2&#x201d;) as output. The second predicted signal represents a reconstructed video signal that is of higher accuracy and better quality than the first predicted signal, in relation to a source or input (video) signal to which each of the first predicted signal and the second predicted signal is tasked to approximate.</p><p id="p-0039" num="0038">In some operational scenarios, the first prediction block of <figref idref="DRAWINGS">FIG. <b>1</b>B</figref> performs prediction operations in a luma channel (denoted as &#x201c;Y&#x201d;) of a color space (e.g., YCbCr, etc.) with an 8-piece 2nd order polynomial and in chroma channels (denoted as &#x201c;Cb&#x201d; or &#x201c;C0&#x201d;, &#x201c;Cr&#x201d; or &#x201c;C1&#x201d;) of the color space with MMR coefficients. The second prediction block of <figref idref="DRAWINGS">FIG. <b>1</b>B</figref> performs prediction operations in some or all of the luma and chroma channels with MMR (Multiple color channel Multiple Regression) coefficients or TPB (Tensor Product B-spline) prediction coefficients. In scenarios in which MMR-based prediction are used in both the first and second prediction blocks, some or all processing logics implementing MMR-based prediction may be re-used in these prediction blocks. Example cumulative density function (CDF) matching operations are described in PCT Application No. PCT/US2017/50980, filed on Sep. 11, 2017; U.S. Provisional Application Ser. No. 62/404,307, filed on Oct. 5, 2016, (also published in Apr. 5, 2018, as U.S. Patent Application Publication Ser. No. 2018/0098094), the entire contents of which are hereby incorporated by reference as if fully set forth herein. Examples of MMR operations are described in U.S. Pat. No. 8,811,490, which are incorporated by reference in its entirety as if fully set forth herein. Examples of TPB operations are described in U.S. Provisional Application Ser. No. 62/908,770 (Attorney Docket No. 60175-0417), titled &#x201c;TENSOR-PRODUCT B-SPLINE PREDICTOR,&#x201d; filed on Oct. 1, 2019, which are incorporated by reference in its entirety as if fully set forth herein.</p><p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. <b>1</b>C</figref> illustrates example two-stage prediction based on a function-of-function model. In this model, the output of the first prediction block is fed directly into the second prediction block. In some operational scenarios, the prediction operations in this model may gain no or little additional information beyond what has been obtained by the first prediction block. In contrast, in a cascade model as illustrated in <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>, the second prediction block receives original image data from the input (or source) signal directly. Thus, the second prediction block is better position to correct prediction errors or inaccuracies generated by the first prediction block.</p><p id="p-0041" num="0040">Example advantages and benefits produced by cascade prediction as described herein include but are not necessarily limited to only: (1) backward compatibility to existing codec architectures; (2) parallel processing for the first prediction block and the second prediction block, which can be exploited or implemented to provide relatively low (e.g., processing, overall, etc.) delay and relatively independent prediction processing.</p><p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. <b>1</b>D</figref> illustrates example encoder-side architecture for cascade prediction. A video codec (e.g., video encoder, video transcoder, etc.) receives a source (video) signal and a reference (video) signal. For the purpose of illustration only, the source signal comprises SDR images (e.g., to be encoded in a coded bitstream such as <b>122</b> of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, forward reshaped SDR images, etc.). The reference signal comprises reference HDR images to which reconstructed HDR images generated by a recipient device from the SDR images are to approximate. The goal for the codec is to generate multiple sets of cascade prediction coefficients such that, when applying one, some or all of the multiple sets of cascade prediction coefficients to the SDR images in the source signal, reconstructed HDR images are generated in a predicted (video) signal to approximate (e.g., closely, with a specific quality level among multiple quality levels, as closely as possible, etc.) to the reference HDR images in the reference signal.</p><p id="p-0043" num="0042">A first set of cascade prediction coefficients (e.g., specifying an 8-piece 2nd order polynomial and MMR coefficients, etc.) in the multiple sets of cascade prediction coefficients may be used by a first population of recipient decoding or playback devices that are deployed in the field relatively extensively to generate first reconstructed HDR images that approximate the reference HDR images at a first quality level.</p><p id="p-0044" num="0043">As illustrated in <figref idref="DRAWINGS">FIG. <b>1</b>D</figref>, the codec may use a first prediction block (denoted as &#x201c;Prediction 1&#x201d;) to receive the reference and source signals, generate the first set of cascade prediction coefficients based at least in part on the received reference and source signals, output the first set of cascade prediction coefficients (denoted as &#x201c;Predictor 1 coeffs&#x201d;) as a part of image metadata (or composer metadata) to be encoded along with the source signal in a coded bitstream (e.g., <b>122</b> of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, etc.), and generate and output a first predicted (video) signal that is generated based at least in part on the first set of cascade prediction coefficients from the source images in the source signal.</p><p id="p-0045" num="0044">A second set of cascade prediction coefficients (e.g., specifying MMR coefficients or TPB prediction coefficients, etc.) in the multiple sets of cascade prediction coefficients may be used along with the first set by a second population of recipient decoding or playback devices that are relatively advanced to generate second reconstructed HDR images that approximate the reference HDR images at a second quality level higher than the first quality level.</p><p id="p-0046" num="0045">As illustrated in <figref idref="DRAWINGS">FIG. <b>1</b>D</figref>, the codec may use two stages to generate the second set of cascade prediction coefficients. The first stage is implemented by an inverse cascade operation block to generate a second reference signal and output the second reference signal to a second prediction block (denoted as &#x201c;Prediction 2&#x201d;). The inverse cascade operation block may implement an inverse cascade operation such as an inverse of (or the opposite to) a cascade operation to be applied by a recipient decoder or playback device. In addition to receiving the second reference signal generated by the inverse cascade operation block, the second prediction block also receives the same source signal received by the first prediction block. The second prediction block generates the second set of cascade prediction coefficients based at least in part on the source signal and the second reference signal such that a predicted residual signal can be generated from the source signal based at least in part on the second set of cascade prediction coefficients to approximate as closely as possible to the second reference signal outputted from the inverse cascade operation block. The codec of <figref idref="DRAWINGS">FIG. <b>1</b>D</figref> may (e.g., on demand, dynamically, statically, etc.) include the second set of cascade prediction coefficients (denoted as &#x201c;Predictor 2 coeffs&#x201d;) as a part of the image metadata in the coded bitstream to be delivered to recipient decoder or playback device(s).</p><p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. <b>1</b>E</figref> illustrates example decoder-side architecture for cascade prediction. A video codec (e.g., video decoder, video transcoder, etc.) decodes a received coded bitstream (e.g., <b>122</b> of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, etc.) into a decoded version (which may be same as the source signal subject to quantization/coding errors incurred by coding/decoding or compression/decompression) of the source signal and one or more of the multiple sets of cascade prediction coefficients generated by an upstream codec (e.g., in <figref idref="DRAWINGS">FIG. <b>1</b>D</figref>, the coding block (<b>120</b>), etc.).</p><p id="p-0048" num="0047">The one or more of the multiple sets of cascade prediction coefficients comprise the first set of cascade prediction coefficients. A first prediction block (denoted as &#x201c;Prediction 1&#x201d;) of the codec of <figref idref="DRAWINGS">FIG. <b>1</b>E</figref> may receive the source signal (or the decoded version thereof) and the first set of cascade prediction coefficients (denoted as &#x201c;Predictor 1 coeffs&#x201d;), and generate first reconstructed HDR images (in a first predicted reference signal) from the SDR images in the source signal based at least in part on the first set of cascade prediction coefficients. The first reconstructed HDR images approximates the reference HDR images (in the reference signal of <figref idref="DRAWINGS">FIG. <b>1</b>D</figref>) at the first quality level.</p><p id="p-0049" num="0048">In some operational scenarios, the codec of <figref idref="DRAWINGS">FIG. <b>1</b>E</figref> derives first display images based on the first reconstructed HDR images and rendered the first display images on an HDR display device without involving any further sets of cascade prediction coefficients other than the first set of cascade prediction coefficients.</p><p id="p-0050" num="0049">In some operational scenarios, the codec of <figref idref="DRAWINGS">FIG. <b>1</b>E</figref> decodes the second set of cascade prediction coefficients (denoted as &#x201c;Predictor 2 coeffs&#x201d;) from the received coded bitstream and uses a Prediction 2 to receive the source signal (or the decoded version thereof) and the second set of cascade prediction coefficients as input and generate the predicted residual signal from the source signal based at least in part on the second set of cascade coefficients. The predicted residual signal may be outputted by the Prediction 2 to the cascade operation block (denoted as &#x201c;Prediction 2&#x201d;). The first predicted signal may be outputted by the first prediction block to the cascade operation block, which combines the predicted residual signal with the first prediction signal to generate a second predicted signal comprising second reconstructed HDR images approximating the reference HDR images at a second quality level higher than the first quality level.</p><p id="p-0051" num="0050">Cascade Prediction in Forward and Backward Mappings at Encoders</p><p id="p-0052" num="0051">In some operational scenarios, a video encoder as described herein may perform both (HDR-to-SDR) forward mapping and (SDR-to-HDR) backward mapping as a part of overall image processing operations performed by the encoder. For example, the encoder may receive a reference (or input) HDR video signal and a content-mapped SDR video signal. One or more of the video signals may be a result of color grading operations, for example performed by colorist(s) using an SDR reference display, an HDR reference display, both SDR and HDR reference displays, and so forth. Additionally, optionally or alternatively, image data in one of the video signals may be content-mapped from corresponding image data in the other the video signals, for example fully automatically without user intervention or manual input, substantially automatically with user intervention and manual input, and so forth.</p><p id="p-0053" num="0052">Cascade prediction may be applied to the forward mapping as well as the backward mapping in the encoder. Accuracies and qualities of both the forward mapping and the backward mapping can be improved by the application of cascade prediction in the encoder.</p><p id="p-0054" num="0053">To apply cascade prediction as described herein to either the forward mapping or the backward mapping at the encoder side, a multi-stage (or cascade) prediction that is the same as or similar to what is depicted in <figref idref="DRAWINGS">FIG. <b>1</b>D</figref> may be implemented and performed.</p><p id="p-0055" num="0054">Cascade Prediction in Forward Mapping at Encoders</p><p id="p-0056" num="0055">Suppose there are P pixels in each of an input j-th SDR image in an input SDR video signal (as received by a video encoder) and an input j-th HDR image (depicting the same visual semantic content as the input SDR image but with a higher luminance dynamic range) in an input HDR video signal (as received by the video encoder).</p><p id="p-0057" num="0056">Let triplets (s<sub>ji</sub><sup>y</sup>, s<sub>ji</sub><sup>c0</sup>, s<sub>ji</sub><sup>c1</sup>) and (v<sub>ji</sub><sup>y</sup>, v<sub>ji</sub><sup>c0</sup>, v<sub>ji</sub><sup>c1</sup>) represent normalized Y, C<sub>0 </sub>and C<sub>1 </sub>values (of a color space such as YCbCr or YC<sub>0</sub>C<sub>1</sub>) for the i-th pixel in the j-th SDR and HDR images respectively.</p><p id="p-0058" num="0057">In the luma or luminance channel (denoted as Y) of the color space, a single-channel luma prediction operation may be performed to map or forward reshape the HDR codeword {v<sub>ji</sub><sup>y</sup>} into a predicted or mapped SDR codeword (denoted as {&#x15d;<sub>ij</sub><sup>y,1</sup>}) using a luma forward reshaping function &#x192;<sub>j</sub><sup>y,1</sup>( ) to approximate the SDR codeword {s<sub>ij</sub><sup>y</sup>}, as follows:</p><p id="p-0059" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>&#x15d;</i><sub>ij</sub><sup>y,1</sup>=&#x192;<sub>j</sub><sup>y,1</sup>(<i>v</i><sub>ij</sub><sup>y</sup>)&#x2003;&#x2003;(1)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0060" num="0058">The luma forward reshaping function may be a one-dimensional lookup table (1D-LUT)&#x2014;or a FLUT&#x2014;that provides a one-to-one mapping from HDR luma codewords/values to predicted or mapped SDR luma codewords/values. The luma forward reshaping function may be generated using the input HDR signal as the input (e.g., comprising to-be-mapped HDR codewords {v<sub>ij</sub><sup>y</sup>}, etc.) for prediction and the input SDR signal as the reference (e.g., comprising SDR codewords {s<sub>ij</sub><sup>y</sup>} to be approximated by predicted SDR codewords {&#x15d;<sub>ij</sub><sup>y,1</sup>}, etc.) for prediction.</p><p id="p-0061" num="0059">However, luma codewords/values/intensities of pixels are often influenced by chroma components of these pixels. The single-channel luma forward reshaping function may not be adept in capturing cross-color information or influence between the chroma components and the luma components of the pixels. As a result, the predicted SDR codeword {&#x15d;<sub>ij</sub><sup>y,1</sup>} may deviate from the expected SDR codeword represented by the input SDR codeword {s<sub>ij</sub><sup>y</sup>} that is to be approximated by the predicted SDR codeword {&#x15d;<sub>ij</sub><sup>y,1</sup>}.</p><p id="p-0062" num="0060">To overcome shortcomings associated with the single-channel luma forward reshaping function, the single-channel luma forward reshaping function may be regarded (e.g., only, etc.) as a first luma forward prediction function generated with the input SDR signal as a first prediction target signal comprising first prediction target values. A second luma forward prediction function &#x192;<sub>j</sub><sup>y,2</sup>( ) may be used to further incorporate (or better capture) chroma information or influence on the luma component.</p><p id="p-0063" num="0061">A second prediction target signal (denoted as &#x394;s<sub>ij</sub><sup>y,2</sup>) may be generated to comprise second prediction target values to which second predicted values generated using the second luma forward prediction function are to approximate, as follows:</p><p id="p-0064" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>s</i><sub>ji</sub><sup>y,2</sup><i>=s</i><sub>ij</sub><sup>y</sup><i>&#x2212;&#x15d;</i><sub>ji</sub><sup>y,1</sup>&#x2003;&#x2003;(2)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0065" num="0000">where the operator &#x201c;&#x2212;&#x201d; on the right-hand side of expression (2) represents an inverse cascade operator OP<sup>&#x2212;1 </sup>( ). For the purpose of illustration only, the inverse cascade operator OP<sup>&#x2212;1 </sup>( ) is represented as a subtraction operator in expression (2). It should be noted that, in various embodiments, an inverse cascade operator as described herein may be represented as a subtraction operator, a division operator, a reversible operator, a functional-based operator, etc.</p><p id="p-0066" num="0062">The second luma forward prediction function (denoted as &#x192;<sub>j</sub><sup>y,2</sup>) may be generated using HDR luma and/or chroma codewords (e.g., v<sub>ji</sub><sup>y</sup>, v<sub>ji</sub><sup>c0</sup>, v<sub>ji</sub><sup>c1</sup>, etc.)&#x2014;or a specific function thereof&#x2014;in the input HDR image as input and using the second prediction target signal &#x394;s<sub>ji</sub><sup>y,2 </sup>as a prediction target. Once generated, the second luma forward prediction function &#x192;<sub>j</sub><sup>y,2 </sup>can be used to map the HDR luma and chroma codewords v<sub>ji</sub><sup>y</sup>, v<sub>ji</sub><sup>c0</sup>, v<sub>ji</sub><sup>c1</sup>&#x2014;or the specific function thereof&#x2014;in the input HDR image into predicted codeword residuals &#x394;&#x15d;<sub>ji</sub><sup>y,2</sup>, as follows:</p><p id="p-0067" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>&#x15d;</i><sub>ij</sub><sup>y,2</sup>=&#x192;<sub>j</sub><sup>y,2</sup>(<i>v</i><sub>ij</sub><sup>y</sup><i>,v</i><sub>ij</sub><sup>c0</sup><i>,v</i><sub>ij</sub><sup>c1</sup>)&#x2003;&#x2003;(3)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0068" num="0063">An overall luma forward prediction function (denoted as &#x192;<sub>j</sub><sup>y</sup>( )) may be given as both the first and second luma forward prediction functions joined with a cascade operator OP ( ), as follows:</p><p id="p-0069" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x192;<sub>j</sub><sup>y</sup>( )=<i>OP</i>(&#x192;<sub>j</sub><sup>y,1</sup>( ),&#x192;<sub>j</sub><sup>y,2</sup>( ))=&#x192;<sub>j</sub><sup>y,1</sup>( )+&#x192;<sub>j</sub><sup>y,2</sup>( )&#x2003;&#x2003;(4)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0070" num="0000">where the operator &#x201c;+&#x201d; on the right-hand side of expression (4) represents the cascade operator OP( ) that is an inverse to the inverse cascade operator OP<sup>&#x2212;1 </sup>( ) in expression (2). For the purpose of illustration only, the cascade operator OP( ) is represented as an addition operator in expression (4). It should be noted that, in various embodiments, a cascade operator as described herein may be represented as an addition operator, a multiplication operator, a reversible operator, a functional-based operator, etc., so long as the cascade operation as represented in expression (4) is conjugate to the inverse cascade operation in expression (2).</p><p id="p-0071" num="0064">More specifically, a forward reshaped SDR signal comprising overall mapped (or overall forward reshaped) SDR codewords/values in the SDR luma channel may be obtained by adding the second mapped values&#x2014;generated by applying the second luma forward prediction function to the input HDR signal&#x2014;as predicted residues to first mapped values generated by applying the first luma forward prediction function to the input HDR signal, as follows:</p><p id="p-0072" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>&#x15d;</i><sub>ij</sub><sup>y</sup><i>=&#x15d;</i><sub>ji</sub><sup>y,1</sup><i>+&#x394;&#x15d;</i><sub>ji</sub><sup>y,2</sup>&#x2003;&#x2003;(5)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0073" num="0065">Forward prediction (or prediction operations in forward reshaping) in a chroma channel (or a non-luma channel) can follow a similar cascade process to that described herein for forward prediction in the luma channel. In various embodiments, the forward prediction in chroma channels may use similar or different choices of prediction functions as used in the forward prediction in the luma channel. By way of illustration but not limitation, the forward prediction in the chroma channels may select the first chroma prediction function to be a second order MMR operator (as specified with second order MMR coefficients) for predicting SDR chroma codewords/values in the chroma channels, and further select the second chroma prediction function to be a third order MMR operator (as specified with third order MMR coefficients) or some other operator (e.g., other than a second order MMR operator, etc.) for predicting residual SDR chroma codewords/values in the chroma channels.</p><p id="p-0074" num="0066">An SDR signal of forward reshaped SDR images comprising forward reshaped SDR codewords/values generated with the cascade forward prediction as described herein may be encoded in a coded bitstream (e.g., <b>122</b> of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, etc.) with backward reshaping metadata for generating and rendering reconstructed HDR images from the forward reshaped SDR images and delivered to downstream decoder and/or playback devices.</p><p id="p-0075" num="0067">Cascade Prediction in Backward Mapping at Encoders</p><p id="p-0076" num="0068">Suppose there are P pixels in each of a (to-be-backward reshaped) j-th SDR image in an SDR video signal and a (corresponding prediction target) j-th HDR image (depicting the same visual semantic content as the SDR image but with a higher luminance dynamic range) in an HDR video signal.</p><p id="p-0077" num="0069">Let triplets (s<sub>ji</sub><sup>y</sup>, s<sub>ji</sub><sup>c0</sup>, s<sub>ji</sub><sup>c1</sup>) and (v<sub>ji</sub><sup>y</sup>, v<sub>ji</sub><sup>c0</sup>, v<sub>ji</sub><sup>c1</sup>) represent normalized Y, C<sub>0 </sub>and C<sub>1 </sub>values (of a color space such as YCbCr or YC<sub>0</sub>C<sub>1</sub>) for the i-th pixel in the j-th SDR and HDR images respectively.</p><p id="p-0078" num="0070">In the luma or luminance channel (denoted as Y) of the color space, a single-channel luma prediction operation may be performed to map or backward reshape the SDR codewords {s<sub>ji</sub><sup>y</sup>} to a predicted or mapped HDR codeword (denoted as {{circumflex over (v)}<sub>ji</sub><sup>y,1</sup>}) using a luma backward reshaping function b<sub>j</sub><sup>y,1</sup>( ) to approximate the HDR codeword {v<sub>ji</sub><sup>y</sup>}, as follows:</p><p id="p-0079" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>{circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup><i>=b</i><sub>j</sub><sup>y,1</sup>(<i>s</i><sub>ji</sub><sup>y</sup>)&#x2003;&#x2003;(6)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0080" num="0071">The luma backward reshaping function may be a one-dimensional lookup table (1D-LUT)&#x2014;or a BLUT&#x2014;that provides a one-to-one mapping from SDR luma codewords/values to predicted or mapped HDR luma codewords/values. The luma backward reshaping function may be generated using the (to-be-backward-reshaped) SDR image as the input (e.g., comprising to-be-mapped SDR codewords {s<sub>ji</sub><sup>y</sup>}, etc.) for prediction and the (prediction target) HDR image as the reference (e.g., comprising HDR codewords {v<sub>ji</sub><sup>y</sup>} to be approximated by predicted HDR codewords {{circumflex over (v)}<sub>ji</sub><sup>y,1</sup>}, etc.) for prediction.</p><p id="p-0081" num="0072">However, luma codewords/values/intensities of pixels are often influenced by chroma components of these pixels. The single-channel luma backward reshaping function may not be adept in capturing cross-color information or influence between the chroma components and the luma components of the pixels. As a result, the predicted HDR codeword {{circumflex over (v)}<sub>ji</sub><sup>y,1</sup>} may deviate from the expected HDR codeword represented by the HDR codeword {v<sub>ji</sub><sup>y</sup>} that is to be approximated by the predicted HDR codeword {{circumflex over (v)}<sub>ji</sub><sup>y,1</sup>}.</p><p id="p-0082" num="0073">To overcome shortcomings associated with the single-channel luma backward reshaping function, the single-channel luma backward reshaping function may be regarded (e.g., only, etc.) as a first luma backward prediction function generated with the (prediction target) HDR image as a prediction target comprising first prediction target values. A second luma backward prediction function b<sub>j</sub><sup>y,2 </sup>may be used to further incorporate (or better capture) chroma information or influence on the luma component.</p><p id="p-0083" num="0074">A second prediction target signal (denoted as &#x394;v<sub>ji</sub><sup>y,2</sup>) may be generated to comprise second prediction target values to which second predicted values generated using the second luma backward prediction function are to approximate, as follows:</p><p id="p-0084" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>v</i><sub>ji</sub><sup>y,2</sup><i>=v</i><sub>ji</sub><sup>y</sup><i>&#x2212;{circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup>&#x2003;&#x2003;(7)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0085" num="0000">where the operator &#x201c;&#x2212;&#x201d; on the right-hand side of expression (7) represents an inverse cascade operator OP<sup>&#x2212;1 </sup>( ). For the purpose of illustration only, the inverse cascade operator OP<sup>&#x2212;1 </sup>( ) is represented as a subtraction operator in expression (7). It should be noted that, in various embodiments, an inverse cascade operator as described herein may be represented as a subtraction operator, a division operator, a reversible operator, a functional-based operator, etc. Additionally, optionally or alternatively, in various embodiments, similar or different types of inverse cascade operators may be used in forward reshaping and backward reshaping. Thus, there is no need to use identical types of inverse cascade operations in forward reshaping and backward reshaping.</p><p id="p-0086" num="0075">The second luma backward prediction function (denoted as b<sub>j</sub><sup>y,2</sup>) may be generated using (to-be-backward-reshaped) SDR luma and chroma codewords (e.g., s<sub>ji</sub><sup>y</sup>, s<sub>ji</sub><sup>c0</sup>, s<sub>ji</sub><sup>c1</sup>, etc.)&#x2014;or a specific function thereof&#x2014;in the (to-be-backward-reshaped) SDR image as input and using the second prediction target signal &#x394;v<sub>ji</sub><sup>y,2 </sup>as a prediction target. Once generated, the second luma backward prediction function b<sub>j</sub><sup>y,2 </sup>can be used to map the (to-be-backward-reshaped) SDR luma and chroma codewords s<sub>ji</sub><sup>y</sup>, s<sub>ji</sub><sup>c0</sup>, s<sub>ji</sub><sup>c1</sup>&#x2014;or the specific function thereof&#x2014;in the (to-be-backward-reshaped) SDR image into predicted codeword residuals &#x394;{circumflex over (v)}<sub>ji</sub><sup>y,2</sup>, as follows:</p><p id="p-0087" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>{circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup><i>=b</i><sub>j</sub><sup>y,2</sup>(<i>s</i><sub>ji</sub><sup>y</sup><i>,s</i><sub>ji</sub><sup>c0</sup><i>,s</i><sub>ji</sub><sup>c1</sup>)&#x2003;&#x2003;(8)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0088" num="0076">An overall luma backward prediction function (denoted as b<sub>j</sub><sup>y</sup>( )) may be given as both the first and second luma backward prediction functions joined with the inverse cascade operator OP ( ), as follows:</p><p id="p-0089" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>b</i><sub>j</sub><sup>y</sup>( )=<i>OP</i>(<i>b</i><sub>j</sub><sup>y,1</sup>( ),<i>b</i><sub>j</sub><sup>y,2</sup>( ))=<i>b</i><sub>j</sub><sup>y,1</sup>( )+<i>b</i><sub>j</sub><sup>y,2</sup>( )&#x2003;&#x2003;(9)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0090" num="0000">where the operator &#x201c;+&#x201d; on the right-hand side of expression (9) represents a cascade operator OP( ) that is an inverse to the inverse cascade operator OP<sup>&#x2212;1 </sup>( ) in expression (7). For the purpose of illustration only, the cascade operator OP( ) is represented as an addition operator in expression (9). It should be noted that, in various embodiments, a cascade operator as described herein may be represented as an addition operator, a multiplication operator, a reversible operator, a functional-based operator, etc., so long as the cascade operation as represented in expression (9) is conjugate to the inverse cascade operation in expression (7). Additionally, optionally or alternatively, in various embodiments, similar or different types of cascade operators may be used in forward reshaping and backward reshaping. Thus, there is no need to use identical types of cascade operations in forward reshaping and backward reshaping.</p><p id="p-0091" num="0077">More specifically, a backward reshaped HDR signal comprising overall mapped (or overall backward reshaped) HDR codewords/values in the HDR luma channel may be obtained by adding the second mapped values&#x2014;generated by applying the second luma backward prediction function to the (to-be-backward-reshaped) SDR signal&#x2014;or SDR images therein&#x2014;as predicted residues to first mapped values generated by applying the first luma backward prediction function to the (to-be-backward-reshaped) SDR signal or the SDR images therein, as follows:</p><p id="p-0092" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>{circumflex over (v)}</i><sub>ji</sub><sup>y</sup><i>={circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup><i>+&#x394;{circumflex over (v)}</i><sub>ji</sub><sup>y,2</sup>&#x2003;&#x2003;(10)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0093" num="0078">Backward prediction (or prediction operations in backward reshaping) in a chroma channel (or a non-luma channel) can follow a similar cascade process to that described herein for backward prediction in the luma channel. In various embodiments, the backward prediction in chroma channels may use similar or different choices of prediction functions as used in the backward prediction in the luma channel. By way of illustration but not limitation, the backward prediction in the chroma channels may select the first chroma prediction function to be a second order MMR operator (as specified with second order MMR coefficients) for predicting HDR chroma codewords/values in the chroma channels, and further select the second chroma prediction function to be a third order MMR operator (as specified with third order MMR coefficients) or some other operator (e.g., other than a second order MMR operator, etc.) for predicting residual HDR chroma codewords/values in the chroma channels.</p><p id="p-0094" num="0079">A first set of cascade prediction coefficients (or prediction operational parameters) that specifies a first backward reshaping mapping such as the first luma and chroma backward prediction functions and a second set of cascade prediction coefficients (or prediction operational parameters) that specifies a second backward reshaping mapping such as the second luma and chroma backward prediction functions may be included as a part of image metadata in a coded bitstream (e.g., <b>122</b> of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, etc.) encoded with the (to-be-backward-reshaped) SDR images and delivered to downstream decoder and/or playback devices for generating and rendering reconstructed HDR images from the SDR images.</p><p id="p-0095" num="0080">Cascade Prediction at Decoders</p><p id="p-0096" num="0081">In some operational scenarios, as illustrated in <figref idref="DRAWINGS">FIG. <b>1</b>E</figref>, a codec such as a video decoder performs only backward mapping from SDR to HDR. For the purpose of illustration only, decoder-side backward mapping may be first explained in terms of luma backward reshaping (or backward reshaping in the luma channel). The decoder decodes or reads in multiple sets of cascade prediction coefficients from a received coded bitstream (e.g., <b>122</b> of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, etc.) or image metadata containers therein.</p><p id="p-0097" num="0082">The multiple sets of cascade prediction coefficients comprise a first set of cascade prediction coefficients for a first prediction operation and a second set of cascade prediction coefficients for a second prediction operation. The first set of cascade prediction coefficients may specify a first luma backward prediction function b<sub>j</sub><sup>y,1</sup>( ), for example as an 8-piece second order polynomial that maps decoded SDR codewords {s<sub>ji</sub><sup>y</sup>} to predicted HDR codewords{{circumflex over (v)}<sub>ji</sub><sup>y,1</sup>} that approximates reference HDR images in a prediction target (or reference) HDR signal in an upstream device that generates the multiple sets of cascade prediction coefficients, as follows:</p><p id="p-0098" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>{circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup><i>=b</i><sub>j</sub><sup>y,1</sup>(<i>s</i><sub>ji</sub><sup>y</sup>)&#x2003;&#x2003;(11)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0099" num="0083">In some operational scenarios, the decoder may generate display images from first predicted/reconstructed HDR images comprising the predicted HDR luma codewords {{circumflex over (v)}<sub>ji</sub><sup>y,1</sup>} generated with the first luma backward prediction function and render the display images with a display device operating in conjunction with the decoder.</p><p id="p-0100" num="0084">In some operational scenarios, the decoder may (e.g., concurrently, in parallel processing, etc.) use a second luma backward prediction function b<sub>j</sub><sup>y,2 </sup>as specified by the second set of cascade prediction coefficients to predict or estimate a difference signal (e.g., prediction residuals) &#x394;{circumflex over (v)}<sub>ji</sub><sup>y,2 </sup>from decoded SDR luma and chroma codewords (e.g., s<sub>ji</sub><sup>y</sup>, s<sub>ji</sub><sup>c0</sup>, s<sub>ji</sub><sup>c1</sup>, etc.) or a specific function thereof, as follows:</p><p id="p-0101" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>{circumflex over (v)}</i><sub>ji</sub><sup>y,2</sup><i>=b</i><sub>j</sub><sup>y,2</sup>(<i>s</i><sub>ji</sub><sup>y</sup><i>,s</i><sub>ji</sub><sup>c0</sup><i>,s</i><sub>ji</sub><sup>c1</sup>)&#x2003;&#x2003;(12)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0102" num="0085">The estimated difference signal generated with the second luma backward prediction function is added using a cascade operation onto the predicted HDR codewords {{circumflex over (v)}<sub>ji</sub><sup>y,1</sup>} generated with the first luma backward prediction function to obtain second predicted or backward reshaped HDR images in a further improved predicted signal (denoted as {circumflex over (v)}<sub>ji</sub><sup>y</sup>), as follows:</p><p id="p-0103" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>{circumflex over (v)}</i><sub>ji</sub><sup>y</sup><i>={circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup><i>+&#x394;{circumflex over (v)}</i><sub>ji</sub><sup>y,2</sup>&#x2003;&#x2003;(13)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0104" num="0086">Chroma components of the first and second predicted/reconstructed HDR images may be obtained similarly. In some operational scenarios, the first chroma backward prediction function/mapping may be a three-channel MMR predictor or function. The second chroma backward prediction function/mapping can be an MMR predictor or function of different order or different type, or another predictor/function that is different or divers from (or more advanced than) the first chroma backward prediction function/mapping.</p><p id="p-0105" num="0087">Example Cascade Predictor and Operation Types/Categories</p><p id="p-0106" num="0088">In some operational scenarios, a first cascade predictor among multiple cascade predictors may, but is not necessarily limited to only, a relatively simple predictor (e.g., a single-channel predictor, a lower order polynomial, a lower order MMR operator, etc.), whereas a second or a further cascade predictor among the multiple cascade predictors may, but is not necessarily limited to only, a relatively complex or advanced predictor (e.g., a cross-channel predictor, a higher order polynomial, a higher order MMR operator, etc.).</p><p id="p-0107" num="0089">In some operational scenarios, two or more cascade predictors among multiple cascade predictors may, but is not necessarily limited to only, predictors of comparable complexity. The two or more cascade predictors may be diverse or different in types or categories.</p><p id="p-0108" num="0090">By way of illustration only, HDR to SDR mappings (e.g., backward reshaping mappings, etc.) may be used as examples to explain different types or categories of cascade predictors or operations. It should be noted that in various embodiments, similar or different types or categories of cascade predictors or operations to or from those for the HDR to SDR mappings may be used for SDR to HDR mappings (e.g., forward reshaping mappings, etc.).</p><p id="p-0109" num="0091">A first example type or category of cascade predictor is single-variable functions using polynomials with a single input variable composed of codewords in chroma channel(s). Since only one input variable is used, chroma saturation is one candidate among many different candidates. The chroma saturation (denoted as v<sub>ji</sub><sup>&#x3c0;</sup>) may be defined or computed as follows:</p><p id="p-0110" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>v</i><sub>ji</sub><sup>&#x3c0;</sup>=&#x221a;{square root over ((<i>v</i><sub>ji</sub><sup>c0</sup>)<sup>2</sup>+(<i>v</i><sub>ji</sub><sup>c1</sup>)<sup>2</sup>)}&#x2003;&#x2003;(14)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0111" num="0092">The first example type of cascade predictor may be represented by a polynomial with the chroma saturation in expression (14) as the single input variable may be denoted as &#x192;<sub>j</sub><sup>poly,y,2</sup>(v<sub>ji</sub><sup>&#x3c0;</sup>). Polynomial coefficients of such a polynomial representing a cascade predictor may be obtained through minimizing an error measure/cost as a function of a prediction target signal (e.g., a to-be-approximated signal, etc.) and a prediction input signal (e.g., a to-be-forward-reshaped signal, a to-be-backward-reshaped signal, etc.).</p><p id="p-0112" num="0093">A second example type or category of cascade predictor is MMR predictors/functions with codewords in chroma channels as input. Many options exist in choosing input variables.</p><p id="p-0113" num="0094">As a first example option, two input variables v<sub>ji</sub><sup>c0 </sup>and v<sub>ji</sub><sup>c1 </sup>may be used in an MMR predictor/function (denoted as &#x192;<sub>j</sub><sup>MMR,y,2</sup>(v<sub>ji</sub><sup>c0</sup>,v<sub>ji</sub><sup>c1</sup>)) as described herein.</p><p id="p-0114" num="0095">As a second example option, two input variables v<sub>ji</sub><sup>y </sup>and v<sub>ji</sub><sup>&#x3c0; </sup>may be used in an MMR predictor/function (denoted as &#x192;<sub>j</sub><sup>MMR,y,2</sup>(v<sub>ji</sub><sup>y</sup>, v<sub>ji</sub><sup>&#x3c0;</sup>)) as described herein.</p><p id="p-0115" num="0096">As a third example option, three input variables v<sub>ji</sub><sup>y</sup>, v<sub>ji</sub><sup>c0</sup>, and v<sub>ji</sub><sup>c1 </sup>may be used in an MMR predictor/function (denoted as &#x192;<sub>j</sub><sup>MMR,y,2</sup>(v<sub>ji</sub><sup>y</sup>,v<sub>ji</sub><sup>c0</sup>,v<sub>ji</sub><sup>c1</sup>)) as described herein.</p><p id="p-0116" num="0097">As a fourth example option, three input variables v<sub>ji</sub><sup>&#x3c0;</sup>, i, and j may be used in an MMR predictor/function (denoted as &#x192;<sub>j</sub><sup>MMR,y,2</sup>(v<sub>ji</sub><sup>&#x3c0;</sup>,i,j)) as described herein. The input variables i and j may be used to efficiently capture local variation at specific pixel position(s).</p><p id="p-0117" num="0098">MMR prediction coefficients of an MMR predictor representing a cascade predictor may be obtained through minimizing an error measure/cost as a function of a prediction target signal (e.g., a to-be-approximated signal, etc.) and a prediction input signal (e.g., a to-be-forward-reshaped signal, a to-be-backward-reshaped signal, etc.).</p><p id="p-0118" num="0099">A third example type or category of cascade predictor is TPB predictors/functions with codewords in chroma channels as input. Many options exist in choosing input variables.</p><p id="p-0119" num="0100">As a first example option, two input variables v<sub>ji</sub><sup>c0 </sup>and v<sub>ji</sub><sup>c1 </sup>may be used in a TPB predictor/function (denoted as &#x192;<sub>j</sub><sup>PB,y,2</sup>(v<sub>ji</sub><sup>c0</sup>,v<sub>ji</sub><sup>c1</sup>)) as described herein.</p><p id="p-0120" num="0101">As a second example option, two input variables v<sub>ji</sub><sup>y </sup>and v<sub>ji</sub><sup>&#x3c0; </sup>may be used in an MMR predictor/function (denoted as &#x192;<sub>j</sub><sup>PB,y,2</sup>(v<sub>ji</sub><sup>y</sup>,v<sub>ji</sub><sup>&#x3c0;</sup>) as described herein.</p><p id="p-0121" num="0102">As a third example option, three input variables v<sub>ji</sub><sup>y</sup>, v<sub>ji</sub><sup>c0</sup>, and v<sub>ji</sub><sup>c1 </sup>may be used in an MMR predictor/function (denoted as &#x192;<sub>j</sub><sup>PB,y,2</sup>(v<sub>ji</sub><sup>&#x3c0;</sup>,v<sub>ji</sub><sup>c0</sup>,v<sub>ji</sub><sup>c1</sup>)) as described herein.</p><p id="p-0122" num="0103">As a fourth example option, three input variables v<sub>ji</sub><sup>&#x3c0;</sup>, i, and j may be used in an MMR predictor/function (denoted as &#x192;<sub>j</sub><sup>PB,y,2</sup>(v<sub>ji</sub><sup>&#x3c0;</sup>,i,j)) as described herein. The input variables i and j may be used to efficiently capture local variation at specific pixel position(s).</p><p id="p-0123" num="0104">TPB prediction coefficients of an TPB predictor representing a cascade predictor may be obtained through minimizing an error measure/cost as a function of a prediction target signal (e.g., a to-be-approximated signal, etc.) and a prediction input signal (e.g., a to-be-forward-reshaped signal, a to-be-backward-reshaped signal, etc.).</p><p id="p-0124" num="0105">Additionally, optionally or alternatively, types or categories of cascade predictors (e.g., non-polynomial, non-MMR, non-TPB, etc.) other than those illustrated herein may be used in a type or category of cascade predictors. Additionally, optionally or alternatively, input variables other than those illustrated herein may be used in a type or category of cascade predictors.</p><p id="p-0125" num="0106">In various embodiments, similar or different types or categories of (e.g., reversible, invertible, etc.) cascade operations and their conjugate or inverse cascade operations may be used.</p><p id="p-0126" num="0107">A first example cascade operation is an (arithmetic) addition such as in &#x192;<sub>j</sub><sup>y</sup>( )=&#x192;<sub>j</sub><sup>y,1</sup>( )+&#x192;<sub>j</sub><sup>y,2</sup>( ). A second example cascade operations is an (arithmetic) multiplication such as in &#x192;<sub>j</sub><sup>y </sup>( )=&#x192;<sub>j</sub><sup>y,1</sup>( )&#xb7;&#x192;<sub>j</sub><sup>y,2</sup>( ).</p><p id="p-0127" num="0108">Additionally, optionally or alternatively, types of cascade operations other than those (arithmetic addition and multiplication) illustrated herein may be used in a type or category of cascade predictors.</p><p id="p-0128" num="0109">Multiple Cascade Prediction</p><p id="p-0129" num="0110">Two-stage cascade prediction can be extended to multiple (or multiple-stage) cascade prediction such as three-stage cascade prediction. In some operational scenarios, multiple piecewise MMR operators may be generated as multiple predictors in cascade prediction as described herein. Additionally, optionally or alternatively, instead of or in addition to creating 1D-LUT to guide MMR prediction (e.g., single-channel multi-piece MMR prediction, multi-channel single-piece MMR prediction, etc.), cascade prediction may be applied to support multi-channel multi-piece MMR prediction without needing to perform special handling at piece partition boundaries such as fusing multiple MMR prediction results at the piece partition boundaries. For example, different types of multi-channel multi-piece MMR predictions may be implemented in different successive or cascade prediction stages with relatively high computational efficiency and relatively high performance. As illustrated in <figref idref="DRAWINGS">FIG. <b>1</b>F</figref>, a third prediction operation (denoted as &#x201c;Prediction 3&#x201d;) may make use of a third predictor &#x192;<sub>j</sub><sup>y,3</sup>( ) in addition to first and second prediction operations (denoted as &#x201c;Prediction 1&#x201d; and &#x201c;Prediction 2&#x201d; respectively) using first and second predictors &#x192;<sub>j</sub><sup>y,1</sup>( ) and &#x192;<sub>j</sub><sup>y,2</sup>( ), respectively.</p><p id="p-0130" num="0111">As previously noted, different types of cascade operations may be used in different operational scenarios by a codec as described herein. By way of illustration but not limitation, two different types of cascade operators may be used.</p><p id="p-0131" num="0112">First, in some operational scenarios, an (arithmetic) addition operator may be used as cascade operations to combine predicted values from the three prediction operations of <figref idref="DRAWINGS">FIG. <b>1</b>F</figref>, as follows:</p><p id="p-0132" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x192;<sub>j</sub><sup>y</sup>( )=&#x192;<sub>j</sub><sup>y,1</sup>( )+&#x192;<sub>j</sub><sup>y,2</sup>( )+&#x192;<sub>j</sub><sup>y,3</sup>( )&#x2003;&#x2003;(15)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0133" num="0113">Second, in some operational scenarios, an (arithmetic) multiplication operator may be used as cascade operations to combine predicted values from the three prediction operations of <figref idref="DRAWINGS">FIG. <b>1</b>F</figref>, as follows:</p><p id="p-0134" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x192;<sub>j</sub><sup>y</sup>( )=&#x192;<sub>j</sub><sup>y,1</sup>( )&#xb7;&#x192;<sub>j</sub><sup>y,2</sup>( )&#xb7;&#x192;<sub>j</sub><sup>y,3</sup>( )&#x2003;&#x2003;(16)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0135" num="0114">With the addition of the third and new stage (as compared with the two-stage cascade prediction), some additional structure, information, etc., in the image data missed by other prediction operations in other stages may be captured. Later prediction operation(s)&#x2014;which may be fully concurrently executed with earlier prediction operation(s) in a decoder as described herein&#x2014;may be selected to be different or diverse from or more advanced than the earlier prediction operation(s). As new stages are added, subsequent residues to be predicted by subsequent prediction operations may become more like random noise, thereby providing less or more marginal benefits while increasing computational complexity as more and more new stages are added.</p><p id="p-0136" num="0115">Derivation of Predictor Coefficients</p><p id="p-0137" num="0116">A first predictor may be computed or represented with polynomials, MMR, TPB, etc. By way of illustration but not limitation, example computation of cascade prediction coefficients (or operational parameters) for a second predictor is described herein with respect to forward reshaping (from HDR to SDR).</p><p id="p-0138" num="0117">For simplicity, denote a target signal for the second predictor as s<sub>ji </sub>and (first) predicted values from the first predictor &#x192;<sub>j</sub><sup>1</sup>( ) as &#x15d;<sub>ji</sub><sup>1</sup>. Thus,</p><p id="p-0139" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>&#x15d;</i><sub>ji</sub><sup>1</sup>=&#x192;<sub>j</sub><sup>1</sup>(<i>v</i><sub>ji</sub><sup>y</sup><i>,v</i><sub>ji</sub><sup>c0</sup><i>,v</i><sub>ji</sub><sup>c1</sup>)&#x2003;&#x2003;(17)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0140" num="0118">The first predictor (or the first prediction operation) can be based on a single-channel polynomial or MMR with input in the form of a single input variable or multiple input variables. Prediction coefficients (constituting a first set of cascade prediction coefficients) may be obtained via an optimization process to minimize an error measure/cost such as one represented as mean-squared errors (MSE) as follows:</p><p id="p-0141" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mrow>       <mo>(</mo>       <mi>optimal</mi>       <mo>)</mo>      </mrow>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mi>coeff</mi>      <mo>&#x2062;</mo>      <mtext>  </mtext>      <mi>of</mi>      <mo>&#x2062;</mo>      <mtext>  </mtext>      <mrow>       <msubsup>        <mi>f</mi>        <mi>j</mi>        <mn>1</mn>       </msubsup>       <mo>(</mo>       <mo>)</mo>      </mrow>     </mrow>     <mo>=</mo>     <mrow>      <mi>arg</mi>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mi>min</mi>      <mo>&#x2062;</mo>      <mtext>  </mtext>      <mrow>       <munderover>        <mo>&#x2211;</mo>        <mrow>         <mi>i</mi>         <mo>=</mo>         <mn>0</mn>        </mrow>        <mrow>         <mi>P</mi>         <mo>-</mo>         <mn>1</mn>        </mrow>       </munderover>       <msup>        <mrow>         <mo>&#xf605;</mo>         <mrow>          <msub>           <mi>s</mi>           <mi>ji</mi>          </msub>          <mo>-</mo>          <msubsup>           <mover accent="true">            <mi>s</mi>            <mi>&#x2c6;</mi>           </mover>           <mi>ji</mi>           <mn>1</mn>          </msubsup>         </mrow>         <mo>&#xf606;</mo>        </mrow>        <mn>2</mn>       </msup>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>18</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0142" num="0119">At the encoder side, a residual signal such as a difference between an original prediction target (or reference) signal and an output predicted signal from the first predictor denoted as &#x394;s<sub>ji</sub><sup>2 </sup>may be determined. Depending on a type of (e.g., reversible, etc.) cascade operator or cascade operation to be used in conjunction with the first and second predictors, different prediction target (or reference) values for the second predictor to predict in the second prediction operation may be determined.</p><p id="p-0143" num="0120">In an example, the cascade operation is an arithmetic addition. Thus, the corresponding inverse cascade operation (or inverse cascade operator) is an (arithmetic) subtraction. The residual signal in a luma channel may be computed from the original prediction target signal and the first predicted signal with the inverse cascade operator, as follows:</p><p id="p-0144" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<sub>ji</sub><sup>y,2</sup><i>=s</i><sub>ji</sub><sup>y</sup><i>&#x2212;&#x15d;</i><sub>ji</sub><sup>y,1</sup>&#x2003;&#x2003;(19)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0145" num="0121">In another example, the cascade operation is an arithmetic multiplication. Thus, the corresponding inverse cascade operation (or inverse cascade operator) is an (arithmetic) division. The residual signal in a luma channel may be computed from the original prediction target signal and the first predicted signal with the inverse cascade operator, as follows:</p><p id="p-0146" num="0000"><maths id="MATH-US-00002" num="00002"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mi>s</mi>       <mi>ji</mi>       <mrow>        <mi>y</mi>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mfrac>      <msubsup>       <mi>s</mi>       <mi>ji</mi>       <mi>y</mi>      </msubsup>      <msubsup>       <mover accent="true">        <mi>s</mi>        <mi>&#x2c6;</mi>       </mover>       <mi>ji</mi>       <mrow>        <mi>y</mi>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>     </mfrac>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>20</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0147" num="0122">The second predictor (or prediction operation) may be represented by a second prediction function as follows:</p><p id="p-0148" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>&#x15d;</i><sub>ji</sub><sup>2</sup>=&#x192;<sub>j</sub><sup>2</sup>(<i>v</i><sub>ji</sub><sup>y</sup><i>,v</i><sub>ji</sub><sup>c0</sup><i>,v</i><sub>ji</sub><sup>c1</sup>)&#x2003;&#x2003;(21)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0149" num="0123">The second predictor (or prediction operation) aims to predict &#x394;s<sub>ji</sub><sup>y,2 </sup>using the original input value (v<sub>ji</sub><sup>y</sup>,v<sub>ji</sub><sup>c0</sup>,v<sub>ji</sub><sup>c1</sup>). By way of example but not limitation, a type of the second prediction operator can be MMR, TPB, or another type with input in the form of multiple input variables. Prediction coefficients (constituting a second set of cascade prediction coefficients) for the second predictor may be obtained via an optimization process to minimize an error measure/cost such as one represented as mean-squared errors (MSE) as follows:</p><p id="p-0150" num="0000"><maths id="MATH-US-00003" num="00003"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mrow>       <mo>(</mo>       <mi>optimal</mi>       <mo>)</mo>      </mrow>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mi>coeff</mi>      <mo>&#x2062;</mo>      <mtext>  </mtext>      <mi>of</mi>      <mo>&#x2062;</mo>      <mtext>  </mtext>      <mrow>       <msubsup>        <mi>f</mi>        <mi>j</mi>        <mn>2</mn>       </msubsup>       <mo>(</mo>       <mo>)</mo>      </mrow>     </mrow>     <mo>=</mo>     <mrow>      <mi>arg</mi>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mi>min</mi>      <mo>&#x2062;</mo>      <mtext>  </mtext>      <mrow>       <munderover>        <mo>&#x2211;</mo>        <mrow>         <mi>i</mi>         <mo>=</mo>         <mn>0</mn>        </mrow>        <mrow>         <mi>P</mi>         <mo>-</mo>         <mn>1</mn>        </mrow>       </munderover>       <msup>        <mrow>         <mo>&#xf605;</mo>         <mrow>          <msubsup>           <mi>s</mi>           <mi>ji</mi>           <mn>2</mn>          </msubsup>          <mo>-</mo>          <msubsup>           <mover accent="true">            <mi>s</mi>            <mi>&#x2c6;</mi>           </mover>           <mi>ji</mi>           <mn>1</mn>          </msubsup>         </mrow>         <mo>&#xf606;</mo>        </mrow>        <mn>2</mn>       </msup>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>22</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0151" num="0124">Take 3-channel MMR as an example, a design vector can be constructed as a vector of multivariate polynomial of input source (e.g., to be forward reshaped, etc.) signal, as follows:</p><p id="p-0152" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>v</i><sub>i,i</sub>=[1<i>v</i><sub>ji</sub><sup>y</sup><i>v</i><sub>ji</sub><sup>c0</sup><i>v</i><sub>ji</sub><sup>c1</sup><i>v</i><sub>ji</sub><sup>y</sup><i>&#xb7;v</i><sub>ji</sub><sup>c1</sup><i>v</i><sub>ji</sub><sup>y</sup><i>&#xb7;v</i><sub>ji</sub><sup>c1</sup><i>v</i><sub>ji</sub><sup>c0</sup><i>&#xb7;v</i><sub>ji</sub><sup>c1</sup><i>v</i><sub>ji</sub><sup>y</sup><i>&#xb7;v</i><sub>ji</sub><sup>c0</sup><i>&#xb7;v</i><sub>ji</sub><sup>c1</sup>(<i>v</i><sub>ji</sub><sup>y</sup>)<sup>2</sup>(<i>v</i><sub>ji</sub><sup>c0</sup>)<sup>2</sup>(<i>v</i><sub>ji</sub><sup>c1</sup>)<sup>2</sup>(<i>v</i><sub>ji</sub><sup>y</sup>&#xb7;<sub>ji</sub><sup>c0</sup>)<sup>2</sup>(<i>v</i><sub>ji</sub><sup>y</sup><i>&#xb7;v</i><sub>ji</sub><sup>c1</sup>)<sup>2</sup>(<i>v</i><sub>ji</sub><sup>c0</sup><i>&#xb7;v</i><sub>ji</sub><sup>c1</sup>)<sup>2</sup>(<i>v</i><sub>ji</sub><sup>y</sup><i>&#xb7;v</i><sub>ji</sub><sup>c0</sup><i>&#xb7;v</i><sub>ji</sub><sup>c1</sup>)<sup>2</sup>]&#x2003;&#x2003; (23)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0153" num="0125">A design matrix comprising design vectors in expression (23) for all pixels (or SDR and HDR pixel pairs) may be constructed as follows:</p><p id="p-0154" num="0000"><maths id="MATH-US-00004" num="00004"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msub>      <mi>V</mi>      <mi>j</mi>     </msub>     <mo>=</mo>     <mrow>      <mo>[</mo>      <mtable>       <mtr>        <mtd>         <msub>          <mi>v</mi>          <mrow>           <mi>j</mi>           <mo>,</mo>           <mn>0</mn>          </mrow>         </msub>        </mtd>       </mtr>       <mtr>        <mtd>         <msub>          <mi>v</mi>          <mrow>           <mi>j</mi>           <mo>,</mo>           <mn>1</mn>          </mrow>         </msub>        </mtd>       </mtr>       <mtr>        <mtd>         <mo>&#x22ee;</mo>        </mtd>       </mtr>       <mtr>        <mtd>         <msub>          <mi>v</mi>          <mrow>           <mi>j</mi>           <mo>,</mo>           <mrow>            <mi>P</mi>            <mo>-</mo>            <mn>1</mn>           </mrow>          </mrow>         </msub>        </mtd>       </mtr>      </mtable>      <mo>]</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mn>24</mn>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0155" num="0126">Y, Cb or C0, and Cr or C1 components of a reference (or prediction target) signal &#x394;s<sub>ji</sub><sup>2</sup>, comprising to-be-approximated values by values generated with the second predictor for Y, Cb and Cr channels for all pixels (or SDR and HDR pixel pairs) may be constructed as follows:</p><p id="p-0156" num="0000"><maths id="MATH-US-00005" num="00005"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mi>s</mi>       <mi>j</mi>       <mrow>        <mi>y</mi>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <mo>[</mo>      <msup>       <mtable>        <mtr>         <mtd>          <mrow>           <mi>&#x394;</mi>           <mo>&#x2062;</mo>           <msubsup>            <mi>s</mi>            <mrow>             <mi>j</mi>             <mo>,</mo>             <mn>0</mn>            </mrow>            <mrow>             <mi>y</mi>             <mo>,</mo>             <mn>2</mn>            </mrow>           </msubsup>          </mrow>         </mtd>         <mtd>          <mrow>           <mi>&#x394;</mi>           <mo>&#x2062;</mo>           <msubsup>            <mi>s</mi>            <mrow>             <mi>j</mi>             <mo>,</mo>             <mn>1</mn>            </mrow>            <mrow>             <mi>y</mi>             <mo>,</mo>             <mn>2</mn>            </mrow>           </msubsup>          </mrow>         </mtd>         <mtd>          <mo>&#x2026;</mo>         </mtd>         <mtd>          <mrow>           <mrow>            <mi>&#x394;</mi>            <mo>&#x2062;</mo>            <msubsup>             <mi>s</mi>             <mrow>              <mi>j</mi>              <mo>,</mo>              <mrow>               <mi>P</mi>               <mo>-</mo>               <mn>1</mn>              </mrow>             </mrow>             <mrow>              <mi>y</mi>              <mo>,</mo>              <mn>2</mn>             </mrow>            </msubsup>           </mrow>           <mo>]</mo>          </mrow>         </mtd>        </mtr>       </mtable>       <mi>T</mi>      </msup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>25</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00005-2" num="00005.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mi>s</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <mo>[</mo>      <msup>       <mtable>        <mtr>         <mtd>          <mrow>           <mi>&#x394;</mi>           <mo>&#x2062;</mo>           <msubsup>            <mi>s</mi>            <mrow>             <mi>j</mi>             <mo>,</mo>             <mn>0</mn>            </mrow>            <mrow>             <mrow>              <mi>c</mi>              <mo>&#x2062;</mo>              <mn>0</mn>             </mrow>             <mo>,</mo>             <mn>2</mn>            </mrow>           </msubsup>          </mrow>         </mtd>         <mtd>          <mrow>           <mi>&#x394;</mi>           <mo>&#x2062;</mo>           <msubsup>            <mi>s</mi>            <mrow>             <mi>j</mi>             <mo>,</mo>             <mn>1</mn>            </mrow>            <mrow>             <mrow>              <mi>c</mi>              <mo>&#x2062;</mo>              <mn>0</mn>             </mrow>             <mo>,</mo>             <mn>2</mn>            </mrow>           </msubsup>          </mrow>         </mtd>         <mtd>          <mo>&#x2026;</mo>         </mtd>         <mtd>          <mrow>           <mrow>            <mi>&#x394;</mi>            <mo>&#x2062;</mo>            <msubsup>             <mi>s</mi>             <mrow>              <mi>j</mi>              <mo>,</mo>              <mrow>               <mi>P</mi>               <mo>-</mo>               <mn>1</mn>              </mrow>             </mrow>             <mrow>              <mrow>               <mi>c</mi>               <mo>&#x2062;</mo>               <mn>0</mn>              </mrow>              <mo>,</mo>              <mn>2</mn>             </mrow>            </msubsup>           </mrow>           <mo>]</mo>          </mrow>         </mtd>        </mtr>       </mtable>       <mi>T</mi>      </msup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>25</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00005-3" num="00005.3"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mi>s</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <mo>[</mo>      <msup>       <mtable>        <mtr>         <mtd>          <mrow>           <mi>&#x394;</mi>           <mo>&#x2062;</mo>           <msubsup>            <mi>s</mi>            <mrow>             <mi>j</mi>             <mo>,</mo>             <mn>0</mn>            </mrow>            <mrow>             <mrow>              <mi>c</mi>              <mo>&#x2062;</mo>              <mn>1</mn>             </mrow>             <mo>,</mo>             <mn>2</mn>            </mrow>           </msubsup>          </mrow>         </mtd>         <mtd>          <mrow>           <mi>&#x394;</mi>           <mo>&#x2062;</mo>           <msubsup>            <mi>s</mi>            <mrow>             <mi>j</mi>             <mo>,</mo>             <mn>1</mn>            </mrow>            <mrow>             <mrow>              <mi>c</mi>              <mo>&#x2062;</mo>              <mn>1</mn>             </mrow>             <mo>,</mo>             <mn>2</mn>            </mrow>           </msubsup>          </mrow>         </mtd>         <mtd>          <mo>&#x2026;</mo>         </mtd>         <mtd>          <mrow>           <mrow>            <mi>&#x394;</mi>            <mo>&#x2062;</mo>            <msubsup>             <mi>s</mi>             <mrow>              <mi>j</mi>              <mo>,</mo>              <mrow>               <mi>P</mi>               <mo>-</mo>               <mn>1</mn>              </mrow>             </mrow>             <mrow>              <mrow>               <mi>c</mi>               <mo>&#x2062;</mo>               <mn>1</mn>              </mrow>              <mo>,</mo>              <mn>2</mn>             </mrow>            </msubsup>           </mrow>           <mo>]</mo>          </mrow>         </mtd>        </mtr>       </mtable>       <mi>T</mi>      </msup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>25</mn>      <mo>-</mo>      <mn>3</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0157" num="0127">The second predictor may be specified with MMR coefficients for the luma and chroma channels, as follows:</p><p id="p-0158" num="0000"><maths id="MATH-US-00006" num="00006"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mi>m</mi>      <mi>j</mi>      <mrow>       <mi>y</mi>       <mo>,</mo>       <mn>2</mn>      </mrow>     </msubsup>     <mo>=</mo>     <msup>      <mrow>       <mo>[</mo>       <mtable>        <mtr>         <mtd>          <msubsup>           <mi>m</mi>           <mrow>            <mi>j</mi>            <mo>,</mo>            <mn>0</mn>           </mrow>           <mrow>            <mi>y</mi>            <mo>,</mo>            <mn>2</mn>           </mrow>          </msubsup>         </mtd>         <mtd>          <msubsup>           <mi>m</mi>           <mrow>            <mi>j</mi>            <mo>,</mo>            <mn>1</mn>           </mrow>           <mrow>            <mi>y</mi>            <mo>,</mo>            <mn>2</mn>           </mrow>          </msubsup>         </mtd>         <mtd>          <mo>&#x2026;</mo>         </mtd>         <mtd>          <msubsup>           <mi>m</mi>           <mrow>            <mi>j</mi>            <mo>,</mo>            <mrow>             <mi>M</mi>             <mo>-</mo>             <mn>1</mn>            </mrow>           </mrow>           <mrow>            <mi>y</mi>            <mo>,</mo>            <mn>2</mn>           </mrow>          </msubsup>         </mtd>        </mtr>       </mtable>       <mo>]</mo>      </mrow>      <mi>T</mi>     </msup>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>26</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00006-2" num="00006.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mi>m</mi>      <mi>j</mi>      <mrow>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>0</mn>       </mrow>       <mo>,</mo>       <mn>2</mn>      </mrow>     </msubsup>     <mo>=</mo>     <msup>      <mrow>       <mo>[</mo>       <mtable>        <mtr>         <mtd>          <msubsup>           <mi>m</mi>           <mrow>            <mi>j</mi>            <mo>,</mo>            <mn>0</mn>           </mrow>           <mrow>            <mrow>             <mi>c</mi>             <mo>&#x2062;</mo>             <mn>0</mn>            </mrow>            <mo>,</mo>            <mn>2</mn>           </mrow>          </msubsup>         </mtd>         <mtd>          <msubsup>           <mi>m</mi>           <mrow>            <mi>j</mi>            <mo>,</mo>            <mn>1</mn>           </mrow>           <mrow>            <mrow>             <mi>c</mi>             <mo>&#x2062;</mo>             <mn>0</mn>            </mrow>            <mo>,</mo>            <mn>2</mn>           </mrow>          </msubsup>         </mtd>         <mtd>          <mo>&#x2026;</mo>         </mtd>         <mtd>          <msubsup>           <mi>m</mi>           <mrow>            <mi>j</mi>            <mo>,</mo>            <mrow>             <mi>M</mi>             <mo>-</mo>             <mn>1</mn>            </mrow>           </mrow>           <mrow>            <mrow>             <mi>c</mi>             <mo>&#x2062;</mo>             <mn>0</mn>            </mrow>            <mo>,</mo>            <mn>2</mn>           </mrow>          </msubsup>         </mtd>        </mtr>       </mtable>       <mo>]</mo>      </mrow>      <mi>T</mi>     </msup>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>26</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00006-3" num="00006.3"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mi>m</mi>      <mi>j</mi>      <mrow>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>1</mn>       </mrow>       <mo>,</mo>       <mn>2</mn>      </mrow>     </msubsup>     <mo>=</mo>     <msup>      <mrow>       <mo>[</mo>       <mtable>        <mtr>         <mtd>          <msubsup>           <mi>m</mi>           <mrow>            <mi>j</mi>            <mo>,</mo>            <mn>0</mn>           </mrow>           <mrow>            <mrow>             <mi>c</mi>             <mo>&#x2062;</mo>             <mn>1</mn>            </mrow>            <mo>,</mo>            <mn>2</mn>           </mrow>          </msubsup>         </mtd>         <mtd>          <msubsup>           <mi>m</mi>           <mrow>            <mi>j</mi>            <mo>,</mo>            <mn>1</mn>           </mrow>           <mrow>            <mrow>             <mi>c</mi>             <mo>&#x2062;</mo>             <mn>1</mn>            </mrow>            <mo>,</mo>            <mn>2</mn>           </mrow>          </msubsup>         </mtd>         <mtd>          <mo>&#x2026;</mo>         </mtd>         <mtd>          <msubsup>           <mi>m</mi>           <mrow>            <mi>j</mi>            <mo>,</mo>            <mrow>             <mi>M</mi>             <mo>-</mo>             <mn>1</mn>            </mrow>           </mrow>           <mrow>            <mrow>             <mi>c</mi>             <mo>&#x2062;</mo>             <mn>1</mn>            </mrow>            <mo>,</mo>            <mn>2</mn>           </mrow>          </msubsup>         </mtd>        </mtr>       </mtable>       <mo>]</mo>      </mrow>      <mi>T</mi>     </msup>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>26</mn>      <mo>-</mo>      <mn>3</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0159" num="0000">where M is the total number of MMR coefficients, for example, 7*MMR_ORDER+1.</p><p id="p-0160" num="0128">Predicted values to approximate each of the Y, Cb or C0, and Cr or C1 components of the reference (or prediction target) signal &#x394;s<sub>ji</sub><sup>2 </sup>in expressions (25) may be generated with the MMR coefficients, as follows:</p><p id="p-0161" num="0000"><maths id="MATH-US-00007" num="00007"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mover>        <mi>s</mi>        <mo>^</mo>       </mover>       <mi>j</mi>       <mrow>        <mi>y</mi>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msub>       <mi>V</mi>       <mi>j</mi>      </msub>      <mo>&#x2062;</mo>      <msubsup>       <mi>m</mi>       <mi>j</mi>       <mrow>        <mi>y</mi>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>27</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00007-2" num="00007.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mover>        <mi>s</mi>        <mo>^</mo>       </mover>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msub>       <mi>V</mi>       <mi>j</mi>      </msub>      <mo>&#x2062;</mo>      <msubsup>       <mi>m</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>27</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00007-3" num="00007.3"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mover>        <mi>s</mi>        <mo>^</mo>       </mover>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msub>       <mi>V</mi>       <mi>j</mi>      </msub>      <mo>&#x2062;</mo>      <msubsup>       <mi>m</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>27</mn>      <mo>-</mo>      <mn>3</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0162" num="0129">An optimization problem to minimize an overall approximation error for all pixels (or bins of pixels) for the purpose of deriving the MMR coefficients may be solved as follows:</p><p id="p-0163" num="0000"><maths id="MATH-US-00008" num="00008"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mi>For</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mi>channel</mi>     <mo>&#x2062;</mo>     <mtext>  </mtext>     <mi>y</mi>     <mo>:</mo>     <mtext>   </mtext>     <munder>      <mi>min</mi>      <msubsup>       <mi>m</mi>       <mi>j</mi>       <mrow>        <mi>y</mi>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </munder>     <mtext>   </mtext>     <msup>      <mrow>       <mo>&#xf605;</mo>       <mrow>        <mrow>         <mi>&#x394;</mi>         <mo>&#x2062;</mo>         <msubsup>          <mi>s</mi>          <mi>j</mi>          <mrow>           <mi>y</mi>           <mo>,</mo>           <mn>2</mn>          </mrow>         </msubsup>        </mrow>        <mo>-</mo>        <mrow>         <mi>&#x394;</mi>         <mo>&#x2062;</mo>         <msubsup>          <mover accent="true">           <mi>s</mi>           <mi>&#x2c6;</mi>          </mover>          <mi>j</mi>          <mrow>           <mi>y</mi>           <mo>,</mo>           <mn>2</mn>          </mrow>         </msubsup>        </mrow>       </mrow>       <mo>&#xf606;</mo>      </mrow>      <mn>2</mn>     </msup>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>28</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00008-2" num="00008.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mi>For</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mi>channel</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mi>c</mi>     <mo>&#x2062;</mo>     <mn>0</mn>     <mo>:</mo>     <mtext>   </mtext>     <munder>      <mi>min</mi>      <msubsup>       <mi>m</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </munder>     <msup>      <mrow>       <mo>&#xf605;</mo>       <mrow>        <mrow>         <mi>&#x394;</mi>         <mo>&#x2062;</mo>         <msubsup>          <mi>s</mi>          <mi>j</mi>          <mrow>           <mrow>            <mi>c</mi>            <mo>&#x2062;</mo>            <mn>0</mn>           </mrow>           <mo>,</mo>           <mn>2</mn>          </mrow>         </msubsup>        </mrow>        <mo>-</mo>        <mrow>         <mi>&#x394;</mi>         <mo>&#x2062;</mo>         <msubsup>          <mover accent="true">           <mi>s</mi>           <mi>&#x2c6;</mi>          </mover>          <mi>j</mi>          <mrow>           <mrow>            <mi>c</mi>            <mo>&#x2062;</mo>            <mn>0</mn>           </mrow>           <mo>,</mo>           <mn>2</mn>          </mrow>         </msubsup>        </mrow>       </mrow>       <mo>&#xf606;</mo>      </mrow>      <mn>2</mn>     </msup>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>28</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00008-3" num="00008.3"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mi>For</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mi>channel</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mi>c</mi>     <mo>&#x2062;</mo>     <mn>1</mn>     <mo>:</mo>     <mtext>   </mtext>     <munder>      <mi>min</mi>      <msubsup>       <mi>m</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </munder>     <msup>      <mrow>       <mo>&#xf605;</mo>       <mrow>        <mrow>         <mi>&#x394;</mi>         <mo>&#x2062;</mo>         <msubsup>          <mi>s</mi>          <mi>j</mi>          <mrow>           <mrow>            <mi>c</mi>            <mo>&#x2062;</mo>            <mn>1</mn>           </mrow>           <mo>,</mo>           <mn>2</mn>          </mrow>         </msubsup>        </mrow>        <mo>-</mo>        <mrow>         <mi>&#x394;</mi>         <mo>&#x2062;</mo>         <msubsup>          <mover accent="true">           <mi>s</mi>           <mi>&#x2c6;</mi>          </mover>          <mi>j</mi>          <mrow>           <mrow>            <mi>c</mi>            <mo>&#x2062;</mo>            <mn>1</mn>           </mrow>           <mo>,</mo>           <mn>2</mn>          </mrow>         </msubsup>        </mrow>       </mrow>       <mo>&#xf606;</mo>      </mrow>      <mn>2</mn>     </msup>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>28</mn>      <mo>-</mo>      <mn>3</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0164" num="0130">This optimization problem can be solved with a linear least squared solution, as follows:</p><p id="p-0165" num="0000"><maths id="MATH-US-00009" num="00009"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mi>m</mi>      <mi>j</mi>      <mrow>       <mi>y</mi>       <mo>,</mo>       <mn>2</mn>       <mo>,</mo>       <mi>opt</mi>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msup>       <mrow>        <mo>(</mo>        <mrow>         <msup>          <mrow>           <mo>(</mo>           <msub>            <mi>V</mi>            <mi>j</mi>           </msub>           <mo>)</mo>          </mrow>          <mi>T</mi>         </msup>         <mo>&#x2062;</mo>         <msub>          <mi>V</mi>          <mi>j</mi>         </msub>        </mrow>        <mo>)</mo>       </mrow>       <mrow>        <mo>-</mo>        <mn>1</mn>       </mrow>      </msup>      <mo>&#x2062;</mo>      <mrow>       <mo>(</mo>       <mrow>        <msup>         <mrow>          <mo>(</mo>          <msub>           <mi>V</mi>           <mi>j</mi>          </msub>          <mo>)</mo>         </mrow>         <mi>T</mi>        </msup>        <mo>&#x2062;</mo>        <mi>&#x394;</mi>        <mo>&#x2062;</mo>        <msubsup>         <mi>s</mi>         <mi>j</mi>         <mrow>          <mi>y</mi>          <mo>,</mo>          <mn>2</mn>         </mrow>        </msubsup>       </mrow>       <mo>)</mo>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>29</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00009-2" num="00009.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mi>m</mi>      <mi>j</mi>      <mrow>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>0</mn>       </mrow>       <mo>,</mo>       <mn>2</mn>       <mo>,</mo>       <mi>opt</mi>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msup>       <mrow>        <mo>(</mo>        <mrow>         <msup>          <mrow>           <mo>(</mo>           <msub>            <mi>V</mi>            <mi>j</mi>           </msub>           <mo>)</mo>          </mrow>          <mi>T</mi>         </msup>         <mo>&#x2062;</mo>         <msub>          <mi>V</mi>          <mi>j</mi>         </msub>        </mrow>        <mo>)</mo>       </mrow>       <mrow>        <mo>-</mo>        <mn>1</mn>       </mrow>      </msup>      <mo>&#x2062;</mo>      <mrow>       <mo>(</mo>       <mrow>        <msup>         <mrow>          <mo>(</mo>          <msub>           <mi>V</mi>           <mi>j</mi>          </msub>          <mo>)</mo>         </mrow>         <mi>T</mi>        </msup>        <mo>&#x2062;</mo>        <mi>&#x394;</mi>        <mo>&#x2062;</mo>        <msubsup>         <mi>s</mi>         <mi>j</mi>         <mrow>          <mrow>           <mi>c</mi>           <mo>&#x2062;</mo>           <mn>0</mn>          </mrow>          <mo>,</mo>          <mn>2</mn>         </mrow>        </msubsup>       </mrow>       <mo>)</mo>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>29</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00009-3" num="00009.3"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mi>m</mi>      <mi>j</mi>      <mrow>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>1</mn>       </mrow>       <mo>,</mo>       <mn>2</mn>       <mo>,</mo>       <mi>opt</mi>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msup>       <mrow>        <mo>(</mo>        <mrow>         <msup>          <mrow>           <mo>(</mo>           <msub>            <mi>V</mi>            <mi>j</mi>           </msub>           <mo>)</mo>          </mrow>          <mi>T</mi>         </msup>         <mo>&#x2062;</mo>         <msub>          <mi>V</mi>          <mi>j</mi>         </msub>        </mrow>        <mo>)</mo>       </mrow>       <mrow>        <mo>-</mo>        <mn>1</mn>       </mrow>      </msup>      <mo>&#x2062;</mo>      <mrow>       <mo>(</mo>       <mrow>        <msup>         <mrow>          <mo>(</mo>          <msub>           <mi>V</mi>           <mi>j</mi>          </msub>          <mo>)</mo>         </mrow>         <mi>T</mi>        </msup>        <mo>&#x2062;</mo>        <mi>&#x394;</mi>        <mo>&#x2062;</mo>        <msubsup>         <mi>s</mi>         <mi>j</mi>         <mrow>          <mrow>           <mi>c</mi>           <mo>&#x2062;</mo>           <mn>1</mn>          </mrow>          <mo>,</mo>          <mn>2</mn>         </mrow>        </msubsup>       </mrow>       <mo>)</mo>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>29</mn>      <mo>-</mo>      <mn>3</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0166" num="0131"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> illustrates an example scatterplot of luma (Y) codewords/values (as indicated with a vertical axis) in an SDR image versus corresponding luma (Y) codewords/values (as indicated with a horizontal axis) in a corresponding HDR image depicting the same visual sematic content as the SDR image.</p><p id="p-0167" num="0132"><figref idref="DRAWINGS">FIG. <b>2</b>B</figref> illustrates an example scatterplot of predicted luma (Y) codewords/values (as indicated with a vertical axis)&#x2014;as generated by a first predictor or prediction operation (denoted as &#x201c;predictor #1&#x201d;) using the HDR image as input and using the SDR image as a prediction target/reference to be approximated by the predicted luma (Y) codewords/values&#x2014;versus corresponding luma (Y) codewords/values (as indicated with a horizontal axis) in the SDR image.</p><p id="p-0168" num="0133"><figref idref="DRAWINGS">FIG. <b>2</b>C</figref> illustrates an example scatterplot of second-stage predicted values (as indicated with a vertical axis; denoted as &#x201c;predicted signal #2)&#x2014;as generated by a second predictor or prediction operation using the HDR image as input and using target/reference values generated by an inverse cascade operation and approximated by the second-stage predicted values versus the predicted luma (Y) codewords/values (as indicated with a horizontal axis) generated by the first predictor or prediction operation.</p><p id="p-0169" num="0134"><figref idref="DRAWINGS">FIG. <b>2</b>D</figref> illustrates an example scatterplot of overall predicted luma (Y) codewords/values (as indicated with a vertical axis)&#x2014;as generated by combining the prediction values from the first and second predictors or prediction operations&#x2014;versus corresponding luma (Y) codewords/values (as indicated with a horizontal axis) in the SDR image.</p><p id="p-0170" num="0135">As compared with the scatter plot of <figref idref="DRAWINGS">FIG. <b>2</b>B</figref> using only the first predictor or prediction operation, the overall predicted luma (Y) codewords/values generated by both the first and second predictors or prediction operations under cascade prediction as described herein show a relatively strong correlation with the luma (Y) codewords/values in the SDR image, thereby achieving a relatively high accuracy and quality level in a predicted image comprising the overall predicted luma (Y) codewords/values.</p><p id="p-0171" num="0136">Application Architectures</p><p id="p-0172" num="0137">Cascade prediction as described herein can be integrated into a wide variety of application architectures implemented with video codecs, including but not limited to those supporting single-layer backward compatible (SLBC) and single-layer inverse display management (SLiDM) video applications.</p><p id="p-0173" num="0138">SLBC Architecture</p><p id="p-0174" num="0139"><figref idref="DRAWINGS">FIG. <b>3</b>A</figref> illustrates an example SLBC codec (e.g., an SLBC video encoder, an SLBC video transcoder comprising a forward reshaping path and a backward reshaping path. Cascade prediction such as two-stage cascade predictions joined with an inverse cascade operation may be (e.g., additionally, optionally, or alternatively, etc.) performed in each of the forward and backward reshaping paths.</p><p id="p-0175" num="0140">As shown, cascade prediction in the forward reshaping path comprises a first forward prediction operation (denoted as &#x201c;forward prediction 1&#x201d;) and a second forward prediction operation (denoted as &#x201c;forward prediction 2&#x201d;). Cascade prediction in the backward reshaping path comprises a first backward prediction operation (denoted as &#x201c;backward prediction 1&#x201d;) and a second backward prediction operation (denoted as &#x201c;backward prediction 2&#x201d;).</p><p id="p-0176" num="0141">It should be noted that the predictor or prediction operation in the forward reshaping path need not be symmetric or otherwise deterministic with respect to the predictor or prediction operation in the backward reshaping path. For example, the second forward prediction need not be the same as or conjugate to (e.g., inverse to, transposed from, etc.) the first backward prediction. Similarly, the first forward prediction need not be the same as or conjugate to (e.g., inverse to, transposed from, etc.) the second backward prediction.</p><p id="p-0177" num="0142">Additionally, optionally or alternatively, different types of cascade predictions may be used in the two-stage prediction of each of the forwarding and backward reshaping paths. For example, for each of the forward and backward reshaping paths, a relatively simple predictor or prediction operation may be placed in the first stage, whereas a different, a relatively advanced predictor or prediction operations can be placed in the second stage after the simpler predictor or prediction operation to obtain additional prediction accuracy and performance gain.</p><p id="p-0178" num="0143">More specifically, in some operational scenarios, the second forward predictor or prediction operation may be selected to be different or diverse from (or more advanced than) the first forward predictor or prediction operation. Similarly, the second backward predictor or prediction operation may be selected to be different or diverse from (or more advanced than) the first backward predictor or prediction operation.</p><p id="p-0179" num="0144">In the forward reshaping path, luma and chroma HDR codewords/values constituting each HDR image in an input (or source) HDR signal (denoted as &#x201c;HDR signal&#x201d;) may be forward reshaped into luma and chroma SDR codewords/values constituting a corresponding forward reshaped SDR image in a forward reshaped signal (denoted as &#x201c;Forward Reshaped SDR signal&#x201d;). The forward reshaped luma and chroma SDR codewords/values (e.g., closely, with various quality levels, etc.) approximate luma and chroma SDR codewords/values in a corresponding reference (or target) SDR image in a reference (or target) SDR signal (denoted as &#x201c;SDR signal&#x201d;).</p><p id="p-0180" num="0145">By way of example but not limitation, in the forward (reshaping) path, the first forward predictor or prediction operation comprises a first luma forward predictor (e.g., a function, a curve, a lookup table, a FLUT, etc.) constructed from CDF matching techniques, as follows:</p><p id="p-0181" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>&#x15d;</i><sub>ji</sub><sup>y,1</sup>=&#x192;<sub>j</sub><sup>y,1</sup>(<i>v</i><sub>ji</sub><sup>y</sup>)&#x2003;&#x2003;(30)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0182" num="0000">where &#x15d;<sub>ji</sub><sup>y,1 </sup>represents a first predicted luma codeword/value outputted by the first luma forward predictor.</p><p id="p-0183" num="0146">A prediction error between the first predicted luma codeword/value and a target luma codeword/value s<sub>ji</sub><sup>y </sup>in the reference (or target) SDR signal to be approximated by the first predicted luma codeword/value may be generated using an inverse cascade operation (which may be luma specific, first-stage-specific, encoder-specific, etc.), as follows:</p><p id="p-0184" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>s</i><sub>ji</sub><sup>y,2</sup><i>=s</i><sub>ji</sub><sup>y</sup><i>&#x2212;&#x15d;</i><sub>ji</sub><sup>y,1</sup>&#x2003;&#x2003;(31)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0185" num="0147">The prediction error may be used as prediction target values to be predicted or approximated using a second luma forward predictor such as an MMR mapping in the second forward predictor or prediction operation, as follows:</p><p id="p-0186" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>&#x15d;</i><sub>ji</sub><sup>y,2</sup>=&#x192;<sub>j</sub><sup>y,2</sup>(<i>v</i><sub>ji</sub><sup>y</sup><i>,v</i><sub>ji</sub><sup>c0</sup><i>,v</i><sub>ji</sub><sup>c1</sup>)&#x2003;&#x2003;(32)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0187" num="0148">The final predicted value &#x15d;<sub>ji</sub><sup>y </sup>for the luma channel is generated by summing up predicted values outputted by both the and second luma forward predictors, as follows:</p><p id="p-0188" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>&#x15d;</i><sub>ji</sub><sup>y</sup><i>=&#x15d;</i><sub>ji</sub><sup>y,1</sup><i>+&#x394;&#x15d;</i><sub>ji</sub><sup>y,2</sup>&#x2003;&#x2003;(33)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0189" num="0149">Similarly, in the forward (reshaping) path, for chroma channels Cb/C0 and Cr/C1, the first forward predictor or prediction operation comprises a first chroma forward predictor, as follows:</p><p id="p-0190" num="0000"><maths id="MATH-US-00010" num="00010"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>s</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>0</mn>       </mrow>       <mo>,</mo>       <mn>1</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mi>f</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>34</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00010-2" num="00010.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>s</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>1</mn>       </mrow>       <mo>,</mo>       <mn>1</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mi>f</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>34</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0191" num="0000">where &#x15d;<sub>ji</sub><sup>0,1 </sup>and &#x15d;<sub>ji</sub><sup>c1,1 </sup>denote first predicted chroma values for the chroma channels based on a single-stage MMR operation.</p><p id="p-0192" num="0150">Prediction errors between the first predicted chroma codeword/value &#x15d;<sub>ji</sub><sup>c0,1</sup>, &#x15d;<sub>ji</sub><sup>c1,1 </sup>and target chroma codewords/values s<sub>ji</sub><sup>c0</sup>,s<sub>ji</sub><sup>c1 </sup>in the reference SDR signal to be approximated by the first predicted chroma codewords/values may be generated for each chroma channel using an inverse cascade operation (which may be luma specific, first-stage-specific, encoder-specific, etc.), as follows:</p><p id="p-0193" num="0000"><maths id="MATH-US-00011" num="00011"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mi>s</mi>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>s</mi>       <mi>ji</mi>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>0</mn>       </mrow>      </msubsup>      <mo>-</mo>      <msubsup>       <mover>        <mi>s</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>35</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00011-2" num="00011.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mi>s</mi>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>s</mi>       <mi>ji</mi>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>-</mo>      <msubsup>       <mover>        <mi>s</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>35</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0194" num="0151">The prediction errors may be used as prediction target values to be predicted or approximated using a second chroma forward predictor such as a more advanced MMR mapping (than that used in the first chroma forward predictor in terms of type of the total number of stages used, the order or degree of constructs, mappings and functions used, operations, total number of input variables, type(s) of input variables, etc.) in the second forward predictor or prediction operation, as follows:</p><p id="p-0195" num="0000"><maths id="MATH-US-00012" num="00012"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mover>        <mi>s</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>f</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>36</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00012-2" num="00012.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mover>        <mi>s</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>f</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>v</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>36</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0196" num="0152">The final predicted values &#x15d;<sub>ji</sub><sup>c0 </sup>and &#x15d;<sub>ji</sub><sup>c1 </sup>for the chroma channels are generated by summing up predicted values outputted by both the and second chroma forward predictors, as follows:</p><p id="p-0197" num="0000"><maths id="MATH-US-00013" num="00013"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>s</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mi>c</mi>       <mo>&#x2062;</mo>       <mn>0</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mover>        <mi>s</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>+</mo>      <mrow>       <mi>&#x394;</mi>       <mo>&#x2062;</mo>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mrow>          <mi>c</mi>          <mo>&#x2062;</mo>          <mn>0</mn>         </mrow>         <mo>,</mo>         <mn>2</mn>        </mrow>       </msubsup>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>37</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00013-2" num="00013.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>s</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mi>c</mi>       <mo>&#x2062;</mo>       <mn>1</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mover>        <mi>s</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>+</mo>      <mrow>       <mi>&#x394;</mi>       <mo>&#x2062;</mo>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mrow>          <mi>c</mi>          <mo>&#x2062;</mo>          <mn>1</mn>         </mrow>         <mo>,</mo>         <mn>2</mn>        </mrow>       </msubsup>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>37</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0198" num="0153">In some operational scenarios, the final predicted values in expressions (33) and (37) may be outputted as forward reshaped luma and chroma codewords/values as a part of the forward reshaped SDR image/signal. The forward reshaped image/signal is encoded in a coded bitstream (e.g., <b>122</b> of FIG. TA, etc.) and provided as input to the backward reshaping path.</p><p id="p-0199" num="0154">In the backward reshaping path, the forward reshaped luma and chroma SDR codewords/values constituting each forward reshaped SDR image in the forward reshaped SDR signal may be backward reshaped into reconstructed luma and chroma HDR codewords/values constituting a corresponding reconstructed HDR image in a reconstructed HDR signal. The reconstructed or backward reshaped luma and chroma HDR codewords/values (e.g., closely, with various quality levels, etc.) approximate the luma and chroma HDR codewords/values in a corresponding input HDR image in the input HDR signal. Neither the input HDR signal nor the reconstructed HDR signal is encoded in the coded bitstream. Rather, image metadata (or composer metadata) specifying backward reshaping mappings such as multiple sets of cascade prediction operations are included in the coded bitstream. Instead of decoding HDR images from the coded bitstream, a recipient decoder or playback device decodes the forward reshaped SDR image and generates a reconstructed HDR image from the forward reshaped SDR image by applying the backward reshaping mappings to the forward reshaped SDR image.</p><p id="p-0200" num="0155">By way of example but not limitation, in the backward (reshaping) path, the first backward predictor or prediction operation comprises a first luma backward predictor (e.g., a function, a curve, a lookup table, a BLUT, etc.) constructed from CDF matching techniques, as follows:</p><p id="p-0201" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>{circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup><i>=b</i><sub>j</sub><sup>y,1</sup>(<i>&#x15d;</i><sub>ji</sub><sup>y</sup>)&#x2003;&#x2003;(38)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0202" num="0000">where {circumflex over (v)}<sub>ji</sub><sup>y,1 </sup>represents a first predicted luma codeword/value outputted by the first luma backward predictor.</p><p id="p-0203" num="0156">A prediction error between the first predicted luma codeword/value and a target luma codeword/value v<sub>ji</sub><sup>y </sup>in the input HDR signal to be approximated by the first predicted luma codeword/value may be generated using an inverse cascade operation (which may be luma specific, first-stage-specific, encoder-specific, etc.), as follows:</p><p id="p-0204" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>v</i><sub>ji</sub><sup>y,2</sup><i>=v</i><sub>ji</sub><sup>y</sup><i>&#x2212;{circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup>&#x2003;&#x2003;(39)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0205" num="0157">The prediction error may be used as prediction target values to be predicted or approximated using a second luma backward predictor such as an MMR mapping in the second backward predictor or prediction operation, as follows:</p><p id="p-0206" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>{circumflex over (v)}</i><sub>ji</sub><sup>y,2</sup><i>=b</i><sub>j</sub><sup>y,2</sup>(<i>&#x15d;</i><sub>ji</sub><sup>y</sup><i>,&#x15d;</i><sub>ji</sub><sup>c0</sup><i>,&#x15d;</i><sub>ji</sub><sup>c1</sup>)&#x2003;&#x2003;(40)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0207" num="0158">The final predicted value {circumflex over (v)}<sub>ji</sub><sup>y </sup>for the luma channel is generated by summing up predicted values outputted by both the first and second luma backward predictors, as follows:</p><p id="p-0208" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>{circumflex over (v)}</i><sub>ji</sub><sup>y</sup><i>={circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup><i>+&#x394;{circumflex over (v)}</i><sub>ji</sub><sup>y,2</sup>&#x2003;&#x2003;(41)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0209" num="0159">Similarly, in the backward (reshaping) path, for chroma channels Cb/C0 and Cr/C1, the first backward predictor or prediction operation comprises a first chroma backward predictor, as follows:</p><p id="p-0210" num="0000"><maths id="MATH-US-00014" num="00014"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>v</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>0</mn>       </mrow>       <mo>,</mo>       <mn>1</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mi>b</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>42</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00014-2" num="00014.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>v</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>1</mn>       </mrow>       <mo>,</mo>       <mn>1</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mi>b</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>42</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0211" num="0000">where {circumflex over (v)}<sub>ji</sub><sup>c1 </sup>and {circumflex over (v)}<sub>ji</sub><sup>c1,1 </sup>denote first predicted chroma values for the chroma channels based on a single-stage MMR operation.</p><p id="p-0212" num="0160">Prediction errors between the first predicted chroma codeword/value {circumflex over (v)}<sub>ji</sub><sup>c0,1</sup>, {circumflex over (v)}<sub>ji</sub><sup>c1,1 </sup>and target chroma codewords/values v<sub>ji</sub><sup>c0</sup>, v<sub>ji</sub><sup>c1 </sup>in the reference (or target) HDR signal to be approximated by the first predicted chroma codewords/values may be generated for each chroma channel using an inverse cascade operation (which may be luma specific, first-stage-specific, encoder-specific, etc.), as follows:</p><p id="p-0213" num="0000"><maths id="MATH-US-00015" num="00015"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mi>v</mi>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>v</mi>       <mi>ji</mi>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>0</mn>       </mrow>      </msubsup>      <mo>-</mo>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>43</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00015-2" num="00015.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mi>v</mi>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>v</mi>       <mi>ji</mi>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>-</mo>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>43</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0214" num="0161">The prediction errors may be used as prediction target values to be predicted or approximated using a second chroma backward predictor such as a more advanced MMR mapping (than that used in the first chroma backward predictor in terms of type of the total number of stages used, the order or degree of constructs, mappings and functions used, operations, total number of input variables, type(s) of input variables, etc.) in the second backward predictor or prediction operation, as follows:</p><p id="p-0215" num="0000"><maths id="MATH-US-00016" num="00016"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>b</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>44</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00016-2" num="00016.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>b</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mover>         <mi>s</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>44</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0216" num="0162">The final predicted values {circumflex over (v)}<sub>ji</sub><sup>c0 </sup>and {circumflex over (v)}<sub>ji</sub><sup>c1 </sup>for the chroma channels are generated by summing up predicted values outputted by both the and second chroma backward predictors, as follows:</p><p id="p-0217" num="0000"><maths id="MATH-US-00017" num="00017"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>v</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mi>c</mi>       <mo>&#x2062;</mo>       <mn>0</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>+</mo>      <mrow>       <mi>&#x394;</mi>       <mo>&#x2062;</mo>       <msubsup>        <mover>         <mi>v</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mrow>          <mi>c</mi>          <mo>&#x2062;</mo>          <mn>0</mn>         </mrow>         <mo>,</mo>         <mn>2</mn>        </mrow>       </msubsup>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>45</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00017-2" num="00017.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>v</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mi>c</mi>       <mo>&#x2062;</mo>       <mn>1</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>+</mo>      <mrow>       <mi>&#x394;</mi>       <mo>&#x2062;</mo>       <msubsup>        <mover>         <mi>v</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mrow>          <mi>c</mi>          <mo>&#x2062;</mo>          <mn>1</mn>         </mrow>         <mo>,</mo>         <mn>2</mn>        </mrow>       </msubsup>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>45</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0218" num="0163">It should be noted that the final predicted luma and chroma values {circumflex over (v)}<sub>ji</sub><sup>y</sup>, {circumflex over (v)}<sub>ji</sub><sup>c0 </sup>and {circumflex over (v)}<sub>ji</sub><sup>c1 </sup>are to be generated by a recipient device that receives image metadata (or composer metadata) comprising multiple sets of cascade prediction coefficients. The multiple sets of cascade prediction coefficients comprise a first set specifying the first luma and chroma backward predictors b<sub>j</sub><sup>y,1</sup>( ), b<sub>j</sub><sup>c0,1</sup>( ), b<sub>j</sub><sup>c0,2</sup>( ) and a second set specifying the second luma and chroma backward predictors b<sub>j</sub><sup>y,2</sup>( ), b<sub>j</sub><sup>c1,1</sup>( ), b<sub>j</sub><sup>c1,2</sup>( ). These backward predictors may be applied by the recipient device to a forward reshaped SDR image (comprising the forward reshaped SDR codewords/values {&#x15d;<sub>ji</sub><sup>y</sup>,&#x15d;<sub>ji</sub><sup>c0</sup>, &#x15d;<sub>ji</sub><sup>c1</sup>}) decoded from the coded bitstream to generate the final predicted luma and chroma values {circumflex over (v)}<sub>ji</sub><sup>y</sup>, {circumflex over (v)}<sub>ji</sub><sup>c0 </sup>and {circumflex over (v)}<sub>ji</sub><sup>c1 </sup>for the reconstructed HDR image.</p><heading id="h-0006" level="2">SLiDM Architecture</heading><p id="p-0219" num="0164"><figref idref="DRAWINGS">FIG. <b>3</b>B</figref> illustrates an example SLiDM codec (e.g., an SLiDM video encoder, an SLiDM video transcoder comprising a backward reshaping path. Cascade prediction such as two-stage cascade predictions joined with an inverse cascade operation may be (e.g., additionally, optionally, or alternatively, etc.) performed in the backward reshaping paths.</p><p id="p-0220" num="0165">As shown, cascade prediction in the backward reshaping path comprises a first backward prediction operation (denoted as &#x201c;backward prediction 1&#x201d;) and a second backward prediction operation (denoted as &#x201c;backward prediction 2&#x201d;).</p><p id="p-0221" num="0166">Different types of cascade predictions may be used in the two-stage prediction of the backward reshaping path. For example, a relatively simple predictor or prediction operation may be placed in the first stage, whereas a different, a relatively advanced predictor or prediction operations can be placed in the second stage after the simpler predictor or prediction operation to obtain additional prediction accuracy and performance gain.</p><p id="p-0222" num="0167">In some operational scenarios, luma and chroma codewords/values of each SDR image in the input SDR signal are encoded in a coded bitstream (e.g., <b>122</b> of FIG. TA, etc.) and provided as input to the backward reshaping path.</p><p id="p-0223" num="0168">The luma and chroma SDR codewords/values constituting each input SDR image in the input SDR signal may be backward reshaped into reconstructed luma and chroma HDR codewords/values constituting a corresponding reconstructed HDR image in a reconstructed HDR signal. The reconstructed or backward reshaped luma and chroma HDR codewords/values (e.g., closely, with various quality levels, etc.) approximate the luma and chroma HDR codewords/values in a corresponding input HDR image in the input HDR signal. Neither the input HDR signal nor the reconstructed HDR signal is encoded in the coded bitstream. Rather, image metadata (or composer metadata) specifying backward reshaping mappings such as multiple sets of cascade prediction operations are included in the coded bitstream. Instead of decoding HDR images from the coded bitstream, a recipient decoder or playback device decodes the SDR image and generates a reconstructed HDR image from the SDR image by applying the backward reshaping mappings to the SDR image.</p><p id="p-0224" num="0169">By way of example but not limitation, the first backward predictor or prediction operation comprises a first luma backward predictor (e.g., a function, a curve, a lookup table, a BLUT, etc.) constructed from CDF matching techniques, as follows:</p><p id="p-0225" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>{circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup><i>=b</i><sub>j</sub><sup>y,1</sup>(<i>s</i><sub>ji</sub><sup>y</sup>)&#x2003;&#x2003;(46)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0226" num="0000">where {circumflex over (v)}<sub>ji</sub><sup>y,1 </sup>represents a first predicted luma codeword/value outputted by the first luma backward predictor.</p><p id="p-0227" num="0170">A prediction error between the first predicted luma codeword/value and a target luma codeword/value v<sub>ji</sub><sup>y </sup>in the input HDR signal to be approximated by the first predicted luma codeword/value may be generated using an inverse cascade operation (which may be luma specific, first-stage-specific, encoder-specific, etc.), as follows:</p><p id="p-0228" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>v</i><sub>ji</sub><sup>y,2</sup><i>=v</i><sub>ji</sub><sup>y</sup><i>&#x2212;{circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup>&#x2003;&#x2003;(47)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0229" num="0171">The prediction error may be used as prediction target values to be predicted or approximated using a second luma backward predictor such as an MMR mapping in the second backward predictor or prediction operation, as follows:</p><p id="p-0230" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>&#x394;<i>{circumflex over (v)}</i><sub>ji</sub><sup>y,2</sup><i>=b</i><sub>j</sub><sup>y,2</sup>(<i>s</i><sub>ji</sub><sup>y</sup><i>,s</i><sub>ji</sub><sup>c0</sup><i>,s</i><sub>ji</sub><sup>c1</sup>)&#x2003;&#x2003;(48)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0231" num="0172">The final predicted value {circumflex over (v)}<sub>ji</sub><sup>y </sup>for the luma channel can be generated by summing up predicted values outputted by both the and second luma backward predictors, as follows:</p><p id="p-0232" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>{circumflex over (v)}</i><sub>ji</sub><sup>y</sup><i>={circumflex over (v)}</i><sub>ji</sub><sup>y,1</sup><i>+&#x394;{circumflex over (v)}</i><sub>ji</sub><sup>y,2</sup>&#x2003;&#x2003;(49)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0233" num="0173">Similarly, in the backward (reshaping) path, for chroma channels Cb/C0 and Cr/C1, the first backward predictor or prediction operation comprises a first chroma backward predictor, as follows:</p><p id="p-0234" num="0000"><maths id="MATH-US-00018" num="00018"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>v</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>0</mn>       </mrow>       <mo>,</mo>       <mn>1</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mi>b</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>50</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00018-2" num="00018.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>v</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>1</mn>       </mrow>       <mo>,</mo>       <mn>1</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mi>b</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>50</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0235" num="0000">where {circumflex over (v)}<sub>ji</sub><sup>c0,1 </sup>and {circumflex over (v)}<sub>ji</sub><sup>c1,1 </sup>denote first predicted chroma values for the chroma channels based on a single-stage MMR operation.</p><p id="p-0236" num="0174">Prediction errors between the first predicted chroma codeword/value {circumflex over (v)}<sub>ji</sub><sup>c0,1</sup>, {circumflex over (v)}<sub>ji</sub><sup>c1,1 </sup>and target chroma codewords/values v<sub>ji</sub><sup>c0</sup>, v<sub>ji</sub><sup>c1 </sup>in the reference (or target) HDR signal to be approximated by the first predicted chroma codewords/values may be generated for each chroma channel using an inverse cascade operation (which may be luma specific, first-stage-specific, encoder-specific, etc.), as follows:</p><p id="p-0237" num="0000"><maths id="MATH-US-00019" num="00019"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mi>v</mi>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>v</mi>       <mi>ji</mi>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>0</mn>       </mrow>      </msubsup>      <mo>-</mo>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>51</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00019-2" num="00019.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mi>v</mi>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>v</mi>       <mi>ji</mi>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>-</mo>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>51</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0238" num="0175">The prediction errors may be used as prediction target values to be predicted or approximated using a second chroma backward predictor such as a more advanced MMR mapping (than that used in the first chroma backward predictor in terms of type of the total number of stages used, the order or degree of constructs, mappings and functions used, operations, total number of input variables, type(s) of input variables, etc.) in the second backward predictor or prediction operation, as follows:</p><p id="p-0239" num="0000"><maths id="MATH-US-00020" num="00020"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>b</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>52</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00020-2" num="00020.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mi>&#x394;</mi>      <mo>&#x2062;</mo>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>     </mrow>     <mo>=</mo>     <mrow>      <msubsup>       <mi>b</mi>       <mi>j</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>2</mn>       </mrow>      </msubsup>      <mo>(</mo>      <mrow>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mi>y</mi>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>       </msubsup>       <mo>,</mo>       <msubsup>        <mi>s</mi>        <mi>ji</mi>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>       </msubsup>      </mrow>      <mo>)</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>52</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0240" num="0176">The final predicted values {circumflex over (v)}<sub>ji</sub><sup>c0 </sup>and {circumflex over (v)}<sub>ji</sub><sup>c1 </sup>for the chroma channels can be generated by summing up predicted values outputted by both the and second chroma backward predictors, as follows:</p><p id="p-0241" num="0000"><maths id="MATH-US-00021" num="00021"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>v</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mi>c</mi>       <mo>&#x2062;</mo>       <mn>0</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>0</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>+</mo>      <mrow>       <mi>&#x394;</mi>       <mo>&#x2062;</mo>       <msubsup>        <mover>         <mi>v</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mrow>          <mi>c</mi>          <mo>&#x2062;</mo>          <mn>0</mn>         </mrow>         <mo>,</mo>         <mn>2</mn>        </mrow>       </msubsup>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>53</mn>      <mo>-</mo>      <mn>1</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths><maths id="MATH-US-00021-2" num="00021.2"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msubsup>      <mover>       <mi>v</mi>       <mo>^</mo>      </mover>      <mi>ji</mi>      <mrow>       <mi>c</mi>       <mo>&#x2062;</mo>       <mn>1</mn>      </mrow>     </msubsup>     <mo>=</mo>     <mrow>      <msubsup>       <mover>        <mi>v</mi>        <mo>^</mo>       </mover>       <mi>ji</mi>       <mrow>        <mrow>         <mi>c</mi>         <mo>&#x2062;</mo>         <mn>1</mn>        </mrow>        <mo>,</mo>        <mn>1</mn>       </mrow>      </msubsup>      <mo>+</mo>      <mrow>       <mi>&#x394;</mi>       <mo>&#x2062;</mo>       <msubsup>        <mover>         <mi>v</mi>         <mo>^</mo>        </mover>        <mi>ji</mi>        <mrow>         <mrow>          <mi>c</mi>          <mo>&#x2062;</mo>          <mn>1</mn>         </mrow>         <mo>,</mo>         <mn>2</mn>        </mrow>       </msubsup>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mo>(</mo>     <mrow>      <mn>53</mn>      <mo>-</mo>      <mn>2</mn>     </mrow>     <mo>)</mo>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0242" num="0177">It should be noted that the final predicted luma and chroma values {circumflex over (v)}<sub>ji</sub><sup>y</sup>, {circumflex over (v)}<sub>ji</sub><sup>c0 </sup>and {circumflex over (v)}<sub>ji</sub><sup>c1 </sup>are to be generated by a recipient device that receives image metadata (or composer metadata) comprising multiple sets of cascade prediction coefficients. The multiple sets of cascade prediction coefficients comprise a first set specifying the first luma and chroma backward predictors b<sub>j</sub><sup>y,1</sup>( ), b<sub>j</sub><sup>c0,1</sup>( ), b<sub>j</sub><sup>c0,2</sup>( ) and a second set specifying the second luma and chroma backward predictors b<sub>j</sub><sup>y,2</sup>( ), b<sub>j</sub><sup>c1,1</sup>( ), b<sub>j</sub><sup>c1,1</sup>( ). These backward predictors may be applied by the recipient device to a decoded SDR image (comprising the SDR codewords/values {s<sub>ji</sub><sup>y</sup>, s<sub>ji</sub><sup>c0</sup>, s<sub>ji</sub><sup>c1</sup>}) decoded from the coded bitstream to generate the final predicted luma and chroma values {circumflex over (v)}<sub>ji</sub><sup>y</sup>, {circumflex over (v)}<sub>ji</sub><sup>c0 </sup>and {circumflex over (v)}<sub>ji</sub><sup>c1 </sup>for the reconstructed HDR image.</p><p id="p-0243" num="0178">In some operational scenarios, linear segment-based structures may be used in computing/generating/including backward reshaping mappings in image metadata for the purpose of maintaining temporal stability of the image metadata. Example linear segment-based structures are described in U.S. Patent Application Publication Ser. No. 2018/0007356, published on Jan. 4, 2018, the entire contents of which are hereby incorporated by reference as if fully set forth herein.</p><p id="p-0244" num="0179">Some or all techniques as described herein can be implemented and/or performed as parts of real time operation to produce suitable color grades of video content for broadcast video applications, real time streaming applications, etc. Additionally, optionally or alternatively, some or all techniques as described herein can be implemented and/or performed as parts of time-delay or offline operation to produce suitable color grades of video content for non-real time streaming applications, cinema applications, etc.</p><p id="p-0245" num="0180">Example Process Flows</p><p id="p-0246" num="0181"><figref idref="DRAWINGS">FIG. <b>4</b>A</figref> illustrates an example process flow according to an embodiment. In some embodiments, one or more computing devices or components (e.g., an encoding device/module, a transcoding device/module, a decoding device/module, an inverse tone mapping device/module, a tone mapping device/module, a media device/module, a reverse mapping generation and application system, etc.) may perform this process flow. In block <b>402</b>, an image processing system applies a first predictor to an input image coded in a first domain to generate first-stage predicted codewords approximating prediction target codewords of a prediction target image coded in a second domain that is different from the first domain.</p><p id="p-0247" num="0182">In block <b>404</b>, the image processing system creates second-stage prediction target values by performing an inverse cascade operation on the prediction target codewords and the first-stage predicted codewords.</p><p id="p-0248" num="0183">In block <b>406</b>, the image processing system applies a second predictor to the input image in the first domain to generate second-stage predicted values approximating the second-stage prediction target values;</p><p id="p-0249" num="0184">In block <b>408</b>, the image processing system generates multiple sets of cascade prediction coefficients. The multiple sets of cascade prediction coefficients comprise a first set of cascade prediction coefficients specifying the first predictor. The multiple sets of cascade prediction coefficients comprise a second different set of cascade prediction coefficients specifying the second predictor.</p><p id="p-0250" num="0185">In block <b>410</b>, the image processing system encodes, in a video signal, the multiple sets of cascade prediction coefficients as image metadata. The video signal is further encoded with the input image in the first domain. A recipient device of the video signal uses the multiple sets of cascade prediction coefficients to apply the first predictor and the second predictor to the input image to generate a predicted image in the second domain. The predicted image in the second domain approximates the prediction target image in the second domain.</p><p id="p-0251" num="0186">In an embodiment, the video signal represents one of: a single-layer backward compatible signal or a single-layer inverse display management signal; the second domain has one of: a higher dynamic range than, the same dynamic range as, or a lower dynamic range than, the first domain.</p><p id="p-0252" num="0187">In an embodiment, the first predictor and the second predictor represent an overall backward reshaping mapping that maps the input image in the first domain to the predicted image in the second domain.</p><p id="p-0253" num="0188">In an embodiment, the first predictor comprises a first luma predictor and a first chroma predictor; the second predictor comprises a second luma predictor and a second chroma predictor; the first and second luma predictors are different types of luma predictors, and wherein the first and second chroma predictors are different types of chroma predictors.</p><p id="p-0254" num="0189">In an embodiment, the second luma predictor is more advanced than the first luma predictor.</p><p id="p-0255" num="0190">In an embodiment, the first luma predictor represents a single-channel polynomial predictor; the second luma predictor represents a multi-channel multivariate multiple regression (MMR) predictor.</p><p id="p-0256" num="0191">In an embodiment, the second chroma predictor is more advanced than the first chroma predictor.</p><p id="p-0257" num="0192">In an embodiment, the first chroma predictor represents a multivariate multiple regression (MMR) predictor of a first order; the second chroma predictor represents an MMR predictor of a second order higher than the first order.</p><p id="p-0258" num="0193">In an embodiment, the input image in the first domain is a forward reshaped image generated by applying a forward reshaping mapping to the prediction target image in the second domain.</p><p id="p-0259" num="0194">In an embodiment, the forward reshaping mapping represents one of: a mapping not based on multi-stage cascade prediction, or a mapping based on multi-stage cascade prediction.</p><p id="p-0260" num="0195">In an embodiment, the cascade prediction represents one of: an arithmetic addition operation, an arithmetic multiplication operation, a reversible arithmetic operation, a reversible functional operation, another reversible operation, and so forth.</p><p id="p-0261" num="0196"><figref idref="DRAWINGS">FIG. <b>4</b>B</figref> illustrates an example process flow according to an embodiment of the present invention. In some embodiments, one or more computing devices or components (e.g., an encoding device/module, a transcoding device/module, a decoding device/module, an inverse tone mapping device/module, a tone mapping device/module, a media device/module, a prediction model and feature selection system, a reverse mapping generation and application system, etc.) may perform this process flow. In block <b>452</b>, a video decoding system decodes, from a video signal, an input image coded in a first domain.</p><p id="p-0262" num="0197">In block <b>454</b>, the video decoding system decodes, from the video signal, image metadata comprising multiple sets of cascade prediction coefficients.</p><p id="p-0263" num="0198">The multiple sets of cascade prediction coefficients were generated by an upstream image processing device.</p><p id="p-0264" num="0199">The multiple sets of cascade prediction coefficients comprise a first set of cascade prediction coefficients, generated based at least in part on a prediction target image coded in a second domain, specifying a first predictor. The first domain is different from the second domain.</p><p id="p-0265" num="0200">The multiple sets of cascade prediction coefficients comprise a second set of cascade prediction coefficients, generated based at least in part on the prediction target image in the second domain, specifying a second predictor.</p><p id="p-0266" num="0201">In block <b>456</b>, the video decoding system applies the first predictor and the second predictor, as joined by a cascade operation, to the input image in the first domain to generate a reconstructed image in the second domain. The reconstructed image in the second domain approximates the prediction target image in the second domain.</p><p id="p-0267" num="0202">In block <b>458</b>, the video decoding system causes a display image derived from the reconstructed image in the second domain to be rendered with a display device.</p><p id="p-0268" num="0203">In an embodiment, a computing device such as a display device, a mobile device, a set-top box, a multimedia device, etc., is configured to perform any of the foregoing methods. In an embodiment, an apparatus comprises a processor and is configured to perform any of the foregoing methods. In an embodiment, a non-transitory computer readable storage medium, storing software instructions, which when executed by one or more processors cause performance of any of the foregoing methods.</p><p id="p-0269" num="0204">In an embodiment, a computing device comprising one or more processors and one or more storage media storing a set of instructions which, when executed by the one or more processors, cause performance of any of the foregoing methods.</p><p id="p-0270" num="0205">Note that, although separate embodiments are discussed herein, any combination of embodiments and/or partial embodiments discussed herein may be combined to form further embodiments.</p><p id="p-0271" num="0206">Example Computer System Implementation</p><p id="p-0272" num="0207">Embodiments of the present invention may be implemented with a computer system, systems configured in electronic circuitry and components, an integrated circuit (IC) device such as a microcontroller, a field programmable gate array (FPGA), or another configurable or programmable logic device (PLD), a discrete time or digital signal processor (DSP), an application specific IC (ASIC), and/or apparatus that includes one or more of such systems, devices or components. The computer and/or IC may perform, control, or execute instructions relating to the adaptive perceptual quantization of images with enhanced dynamic range, such as those described herein. The computer and/or IC may compute any of a variety of parameters or values that relate to the adaptive perceptual quantization processes described herein. The image and video embodiments may be implemented in hardware, software, firmware and various combinations thereof.</p><p id="p-0273" num="0208">Certain implementations of the invention comprise computer processors which execute software instructions which cause the processors to perform a method of the disclosure. For example, one or more processors in a display, an encoder, a set top box, a transcoder or the like may implement methods related to adaptive perceptual quantization of HDR images as described above by executing software instructions in a program memory accessible to the processors. Embodiments of the invention may also be provided in the form of a program product. The program product may comprise any non-transitory medium which carries a set of computer-readable signals comprising instructions which, when executed by a data processor, cause the data processor to execute a method of an embodiment of the invention. Program products according to embodiments of the invention may be in any of a wide variety of forms. The program product may comprise, for example, physical media such as magnetic data storage media including floppy diskettes, hard disk drives, optical data storage media including CD ROMs, DVDs, electronic data storage media including ROMs, flash RAM, or the like. The computer-readable signals on the program product may optionally be compressed or encrypted.</p><p id="p-0274" num="0209">Where a component (e.g. a software module, processor, assembly, device, circuit, etc.) is referred to above, unless otherwise indicated, reference to that component (including a reference to a &#x201c;means&#x201d;) should be interpreted as including as equivalents of that component any component which performs the function of the described component (e.g., that is functionally equivalent), including components which are not structurally equivalent to the disclosed structure which performs the function in the illustrated example embodiments of the invention.</p><p id="p-0275" num="0210">According to one embodiment, the techniques described herein are implemented by one or more special-purpose computing devices. The special-purpose computing devices may be hard-wired to perform the techniques, or may include digital electronic devices such as one or more application-specific integrated circuits (ASICs) or field programmable gate arrays (FPGAs) that are persistently programmed to perform the techniques, or may include one or more general purpose hardware processors programmed to perform the techniques pursuant to program instructions in firmware, memory, other storage, or a combination. Such special-purpose computing devices may also combine custom hard-wired logic, ASICs, or FPGAs with custom programming to accomplish the techniques. The special-purpose computing devices may be desktop computer systems, portable computer systems, handheld devices, networking devices or any other device that incorporates hard-wired and/or program logic to implement the techniques.</p><p id="p-0276" num="0211">For example, <figref idref="DRAWINGS">FIG. <b>5</b></figref> is a block diagram that illustrates a computer system <b>500</b> upon which an embodiment of the invention may be implemented. Computer system <b>500</b> includes a bus <b>502</b> or other communication mechanism for communicating information, and a hardware processor <b>504</b> coupled with bus <b>502</b> for processing information. Hardware processor <b>504</b> may be, for example, a general purpose microprocessor.</p><p id="p-0277" num="0212">Computer system <b>500</b> also includes a main memory <b>506</b>, such as a random access memory (RAM) or other dynamic storage device, coupled to bus <b>502</b> for storing information and instructions to be executed by processor <b>504</b>. Main memory <b>506</b> also may be used for storing temporary variables or other intermediate information during execution of instructions to be executed by processor <b>504</b>. Such instructions, when stored in non-transitory storage media accessible to processor <b>504</b>, render computer system <b>500</b> into a special-purpose machine that is customized to perform the operations specified in the instructions.</p><p id="p-0278" num="0213">Computer system <b>500</b> further includes a read only memory (ROM) <b>508</b> or other static storage device coupled to bus <b>502</b> for storing static information and instructions for processor <b>504</b>. A storage device <b>510</b>, such as a magnetic disk or optical disk, is provided and coupled to bus <b>502</b> for storing information and instructions.</p><p id="p-0279" num="0214">Computer system <b>500</b> may be coupled via bus <b>502</b> to a display <b>512</b>, such as a liquid crystal display, for displaying information to a computer user. An input device <b>514</b>, including alphanumeric and other keys, is coupled to bus <b>502</b> for communicating information and command selections to processor <b>504</b>. Another type of user input device is cursor control <b>516</b>, such as a mouse, a trackball, or cursor direction keys for communicating direction information and command selections to processor <b>504</b> and for controlling cursor movement on display <b>512</b>. This input device typically has two degrees of freedom in two axes, a first axis (e.g., x) and a second axis (e.g., y), that allows the device to specify positions in a plane.</p><p id="p-0280" num="0215">Computer system <b>500</b> may implement the techniques described herein using customized hard-wired logic, one or more ASICs or FPGAs, firmware and/or program logic which in combination with the computer system causes or programs computer system <b>500</b> to be a special-purpose machine. According to one embodiment, the techniques as described herein are performed by computer system <b>500</b> in response to processor <b>504</b> executing one or more sequences of one or more instructions contained in main memory <b>506</b>. Such instructions may be read into main memory <b>506</b> from another storage medium, such as storage device <b>510</b>. Execution of the sequences of instructions contained in main memory <b>506</b> causes processor <b>504</b> to perform the process steps described herein. In alternative embodiments, hard-wired circuitry may be used in place of or in combination with software instructions.</p><p id="p-0281" num="0216">The term &#x201c;storage media&#x201d; as used herein refers to any non-transitory media that store data and/or instructions that cause a machine to operation in a specific fashion. Such storage media may comprise non-volatile media and/or volatile media. Non-volatile media includes, for example, optical or magnetic disks, such as storage device <b>510</b>. Volatile media includes dynamic memory, such as main memory <b>506</b>. Common forms of storage media include, for example, a floppy disk, a flexible disk, hard disk, solid state drive, magnetic tape, or any other magnetic data storage medium, a CD-ROM, any other optical data storage medium, any physical medium with patterns of holes, a RAM, a PROM, and EPROM, a FLASH-EPROM, NVRAM, any other memory chip or cartridge.</p><p id="p-0282" num="0217">Storage media is distinct from but may be used in conjunction with transmission media. Transmission media participates in transferring information between storage media. For example, transmission media includes coaxial cables, copper wire and fiber optics, including the wires that comprise bus <b>502</b>. Transmission media can also take the form of acoustic or light waves, such as those generated during radio-wave and infra-red data communications.</p><p id="p-0283" num="0218">Various forms of media may be involved in carrying one or more sequences of one or more instructions to processor <b>504</b> for execution. For example, the instructions may initially be carried on a magnetic disk or solid state drive of a remote computer. The remote computer can load the instructions into its dynamic memory and send the instructions over a telephone line using a modem. A modem local to computer system <b>500</b> can receive the data on the telephone line and use an infra-red transmitter to convert the data to an infra-red signal. An infra-red detector can receive the data carried in the infra-red signal and appropriate circuitry can place the data on bus <b>502</b>. Bus <b>502</b> carries the data to main memory <b>506</b>, from which processor <b>504</b> retrieves and executes the instructions. The instructions received by main memory <b>506</b> may optionally be stored on storage device <b>510</b> either before or after execution by processor <b>504</b>.</p><p id="p-0284" num="0219">Computer system <b>500</b> also includes a communication interface <b>518</b> coupled to bus <b>502</b>. Communication interface <b>518</b> provides a two-way data communication coupling to a network link <b>520</b> that is connected to a local network <b>522</b>. For example, communication interface <b>518</b> may be an integrated services digital network (ISDN) card, cable modem, satellite modem, or a modem to provide a data communication connection to a corresponding type of telephone line. As another example, communication interface <b>518</b> may be a local area network (LAN) card to provide a data communication connection to a compatible LAN. Wireless links may also be implemented. In any such implementation, communication interface <b>518</b> sends and receives electrical, electromagnetic or optical signals that carry digital data streams representing various types of information.</p><p id="p-0285" num="0220">Network link <b>520</b> typically provides data communication through one or more networks to other data devices. For example, network link <b>520</b> may provide a connection through local network <b>522</b> to a host computer <b>524</b> or to data equipment operated by an Internet Service Provider (ISP) <b>526</b>. ISP <b>526</b> in turn provides data communication services through the world wide packet data communication network now commonly referred to as the &#x201c;Internet&#x201d; <b>528</b>. Local network <b>522</b> and Internet <b>528</b> both use electrical, electromagnetic or optical signals that carry digital data streams. The signals through the various networks and the signals on network link <b>520</b> and through communication interface <b>518</b>, which carry the digital data to and from computer system <b>500</b>, are example forms of transmission media.</p><p id="p-0286" num="0221">Computer system <b>500</b> can send messages and receive data, including program code, through the network(s), network link <b>520</b> and communication interface <b>518</b>. In the Internet example, a server <b>530</b> might transmit a requested code for an application program through Internet <b>528</b>, ISP <b>526</b>, local network <b>522</b> and communication interface <b>518</b>.</p><p id="p-0287" num="0222">The received code may be executed by processor <b>504</b> as it is received, and/or stored in storage device <b>510</b>, or other non-volatile storage for later execution.</p><heading id="h-0007" level="1">EQUIVALENTS, EXTENSIONS, ALTERNATIVES AND MISCELLANEOUS</heading><p id="p-0288" num="0223">In the foregoing specification, embodiments of the invention have been described with reference to numerous specific details that may vary from implementation to implementation. Thus, the sole and exclusive indicator of what is claimed embodiments of the invention, and is intended by the applicants to be claimed embodiments of the invention, is the set of claims that issue from this application, in the specific form in which such claims issue, including any subsequent correction. Any definitions expressly set forth herein for terms contained in such claims shall govern the meaning of such terms as used in the claims. Hence, no limitation, element, property, feature, advantage or attribute that is not expressly recited in a claim should limit the scope of such claim in any way. The specification and drawings are, accordingly, to be regarded in an illustrative rather than a restrictive sense.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001" nb-file="US20230007294A1-20230105-M00001.NB"><img id="EMI-M00001" he="8.13mm" wi="76.20mm" file="US20230007294A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00002" nb-file="US20230007294A1-20230105-M00002.NB"><img id="EMI-M00002" he="7.37mm" wi="76.20mm" file="US20230007294A1-20230105-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00003" nb-file="US20230007294A1-20230105-M00003.NB"><img id="EMI-M00003" he="8.13mm" wi="76.20mm" file="US20230007294A1-20230105-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00004" nb-file="US20230007294A1-20230105-M00004.NB"><img id="EMI-M00004" he="13.04mm" wi="76.20mm" file="US20230007294A1-20230105-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00005 MATH-US-00005-2 MATH-US-00005-3" nb-file="US20230007294A1-20230105-M00005.NB"><img id="EMI-M00005" he="16.59mm" wi="76.20mm" file="US20230007294A1-20230105-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00006 MATH-US-00006-2 MATH-US-00006-3" nb-file="US20230007294A1-20230105-M00006.NB"><img id="EMI-M00006" he="15.83mm" wi="76.20mm" file="US20230007294A1-20230105-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00007 MATH-US-00007-2 MATH-US-00007-3" nb-file="US20230007294A1-20230105-M00007.NB"><img id="EMI-M00007" he="15.49mm" wi="76.20mm" file="US20230007294A1-20230105-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00008 MATH-US-00008-2 MATH-US-00008-3" nb-file="US20230007294A1-20230105-M00008.NB"><img id="EMI-M00008" he="24.72mm" wi="76.20mm" file="US20230007294A1-20230105-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00009 MATH-US-00009-2 MATH-US-00009-3" nb-file="US20230007294A1-20230105-M00009.NB"><img id="EMI-M00009" he="15.16mm" wi="76.20mm" file="US20230007294A1-20230105-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00010 MATH-US-00010-2" nb-file="US20230007294A1-20230105-M00010.NB"><img id="EMI-M00010" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00011 MATH-US-00011-2" nb-file="US20230007294A1-20230105-M00011.NB"><img id="EMI-M00011" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00012 MATH-US-00012-2" nb-file="US20230007294A1-20230105-M00012.NB"><img id="EMI-M00012" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00012.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00013 MATH-US-00013-2" nb-file="US20230007294A1-20230105-M00013.NB"><img id="EMI-M00013" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00013.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00014 MATH-US-00014-2" nb-file="US20230007294A1-20230105-M00014.NB"><img id="EMI-M00014" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00014.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00015 MATH-US-00015-2" nb-file="US20230007294A1-20230105-M00015.NB"><img id="EMI-M00015" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00015.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00016 MATH-US-00016-2" nb-file="US20230007294A1-20230105-M00016.NB"><img id="EMI-M00016" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00016.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00017 MATH-US-00017-2" nb-file="US20230007294A1-20230105-M00017.NB"><img id="EMI-M00017" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00017.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00018 MATH-US-00018-2" nb-file="US20230007294A1-20230105-M00018.NB"><img id="EMI-M00018" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00018.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00019 MATH-US-00019-2" nb-file="US20230007294A1-20230105-M00019.NB"><img id="EMI-M00019" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00019.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00020 MATH-US-00020-2" nb-file="US20230007294A1-20230105-M00020.NB"><img id="EMI-M00020" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00020.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00021 MATH-US-00021-2" nb-file="US20230007294A1-20230105-M00021.NB"><img id="EMI-M00021" he="9.91mm" wi="76.20mm" file="US20230007294A1-20230105-M00021.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A method comprising:<claim-text>applying a first predictor to an input image coded in a first domain to generate first-stage predicted codewords approximating prediction target codewords of a prediction target image coded in a second domain that is different from the first domain;</claim-text><claim-text>creating second-stage prediction target values by performing an inverse cascade operation on the prediction target codewords and the first-stage predicted codewords;</claim-text><claim-text>applying a second predictor to the input image in the first domain to generate second-stage predicted values approximating the second-stage prediction target values;</claim-text><claim-text>generating multiple sets of cascade prediction coefficients, wherein the multiple sets of cascade prediction coefficients comprise a first set of cascade prediction coefficients specifying the first predictor, wherein the multiple sets of cascade prediction coefficients comprise a second different set of cascade prediction coefficients specifying the second predictor;</claim-text><claim-text>encoding, in a video signal, the multiple sets of cascade prediction coefficients as image metadata, wherein the video signal is further encoded with the input image in the first domain, wherein a recipient device of the video signal is caused to use the multiple sets of cascade prediction coefficients to apply the first predictor and the second predictor to the input image to generate a predicted image in the second domain, wherein the predicted image in the second domain approximates the prediction target image in the second domain.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the video signal represents one of: a single-layer backward compatible signal or a single-layer inverse display management signal;<claim-text>and wherein the second domain has one of: a higher dynamic range than, the same dynamic range, or a lower dynamic range than, the first domain.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first predictor and the second predictor represent an overall backward reshaping mapping that maps the input image in the first domain to the predicted image in the second domain.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first predictor comprises a first luma predictor and a first chroma predictor, wherein the second predictor comprises a second luma predictor and a second chroma predictor, wherein the first and second luma predictors are different types of luma predictors, and wherein the first and second chroma predictors are different types of chroma predictors.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the second luma predictor is more advanced than the first luma predictor.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the first luma predictor represents a single-channel polynomial predictor, and wherein the second luma predictor represents a multi-channel multivariate multiple regression (MMR) predictor.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the second chroma predictor is more advanced than the first chroma predictor.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the first chroma predictor represents a multivariate multiple regression (MMR) predictor of a second order, and wherein the second chroma predictor represents an MMR predictor of a third order higher than the first order.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the input image in the first domain is a forward reshaped image generated by applying a forward reshaping mapping to the prediction target image in the second domain.</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the forward reshaping mapping represents one of: a mapping not based on multi-stage cascade prediction, or a mapping based on multi-stage cascade prediction.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the cascade prediction represents one of: an arithmetic addition operation, an arithmetic multiplication operation, a reversible arithmetic operation, a reversible functional operation, or another reversible operation.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. A method comprising:<claim-text>decoding, from a video signal, an input image coded in a first domain;</claim-text><claim-text>decoding, from the video signal, image metadata comprising multiple sets of cascade prediction coefficients;</claim-text><claim-text>wherein the multiple sets of cascade prediction coefficients were generated by an upstream image processing device;</claim-text><claim-text>wherein the multiple sets of cascade prediction coefficients comprise a first set of cascade prediction coefficients, generated based at least in part on a prediction target image coded in a second domain, specifying a first predictor; wherein the first domain is different from the second domain;</claim-text><claim-text>wherein the multiple sets of cascade prediction coefficients comprise a second set of cascade prediction coefficients, generated based at least in part on the prediction target image in the second domain, specifying a second predictor;</claim-text><claim-text>applying the first predictor and the second predictor to the input image in the first domain to generate a reconstructed image in the second domain, wherein the reconstructed image in the second domain approximates the prediction target image in the second domain, wherein a cascade operation combines first-stage predicted codewords generated from applying the first predictor to the input image with second-stage predicted values generated from applying the second predictor to the input image;</claim-text><claim-text>causing a display image derived from the reconstructed image in the second domain to be rendered with a display device.</claim-text></claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the first predictor and the second predictor represent an overall backward reshaping mapping that maps the input image in the first domain to the reconstructed image in the second domain.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. A method as recited in <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the display image is directly derived from a second reconstructed image coded in a third domain, wherein the second reconstructed image in the third domain approximates a second prediction target image in the third domain; wherein the second reconstructed image in the third domain is generated in part by using a second cascade operation to combine third-stage predicted values generated from applying a third predictor to the input image with reconstructed codewords in the reconstructed image in the second domain.</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. An apparatus comprising a processor and configured to perform the method recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. A non-transitory computer-readable storage medium having stored thereon computer-executable instruction for executing a method with one or more processors in accordance with the method recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text></claim></claims></us-patent-application>