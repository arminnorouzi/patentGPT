<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230007033A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230007033</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17851118</doc-number><date>20220628</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="national"><country>JP</country><doc-number>2021-109246</doc-number><date>20210630</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>H</section><class>04</class><subclass>L</subclass><main-group>9</main-group><subgroup>40</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>1425</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>H</section><class>04</class><subclass>L</subclass><main-group>63</main-group><subgroup>145</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">ATTACK ANALYZER, ATTACK ANALYSIS METHOD AND ATTACK ANALYSIS PROGRAM</invention-title><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>DENSO CORPORATION</orgname><address><city>Kariya-city</city><country>JP</country></address></addressbook><residence><country>JP</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>IMOTO</last-name><first-name>Reiichiro</first-name><address><city>Kariya-city</city><country>JP</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>EGAWA</last-name><first-name>Masumi</first-name><address><city>Kariya-city</city><country>JP</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">An attack analyzer includes: a security log acquisition unit acquiring a security log including an abnormality detection signal generated by a security sensor mounted on an electronic control device constituting an electronic control system and indicating that the security sensor has detected an abnormality; a failure information acquisition unit acquiring failure information indicating a failure occurred in the electronic control device; a prediction table storage unit storing a prediction table showing a correspondence relationship between a predicted attack route in the electronic control system and a predicted abnormality detection signal predicted to be generated by the security sensor; an attack route estimation unit; and an attack information output unit outputting attack information indicating the attack route.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="118.96mm" wi="158.75mm" file="US20230007033A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="214.97mm" wi="152.57mm" file="US20230007033A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="215.14mm" wi="142.58mm" orientation="landscape" file="US20230007033A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="200.58mm" wi="150.37mm" orientation="landscape" file="US20230007033A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="205.15mm" wi="139.62mm" orientation="landscape" file="US20230007033A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="218.78mm" wi="138.26mm" orientation="landscape" file="US20230007033A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="218.78mm" wi="138.26mm" orientation="landscape" file="US20230007033A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="189.65mm" wi="109.64mm" file="US20230007033A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="200.49mm" wi="161.04mm" orientation="landscape" file="US20230007033A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="226.65mm" wi="138.26mm" orientation="landscape" file="US20230007033A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="206.25mm" wi="109.98mm" file="US20230007033A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATION</heading><p id="p-0002" num="0001">The present application is based on and claims the benefit of priority of Japanese Patent Application No. 2021-109246, filed on Jun. 30, 2021, the disclosure of which is incorporated herein by reference.</p><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">The present disclosure generally relates to a device that analyzes an attack on an electronic control system mounted on a movable body such as an automobile, including an attack analyzer, an attack analysis method, and an attack analysis program stored on a storage medium.</p><heading id="h-0003" level="1">BACKGROUND INFORMATION</heading><p id="p-0004" num="0003">In recent years, technologies for driving support and automated driving control, including V2X such as vehicle-to-vehicle communication and road-to-vehicle communication, have been attracting attention. As a result, a vehicle has a communication function, and so-called connectivity of the vehicle has been promoted. As a result, vehicles are more likely to be subject to cyber attacks such as unauthorized access. Therefore, it is necessary to analyze cyber attacks on vehicles and formulate countermeasures.</p><heading id="h-0004" level="1">SUMMARY</heading><p id="p-0005" num="0004">It is an object of the present disclosure to realize an attack analyzer or the like that estimates an attack route with higher accuracy when a cyber attack on an electronic control system is received/observed.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0006" num="0005">Objects, features, and advantages of the present disclosure will become more apparent from the following detailed description made with reference to the accompanying drawings, in which:</p><p id="p-0007" num="0006"><figref idref="DRAWINGS">FIGS. <b>1</b>A and <b>1</b>B</figref> are respectively an explanatory diagram illustrating an arrangement of an attack analyzer according to a first embodiment;</p><p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a block diagram illustrating a configuration example of an electronic control system of the first embodiment;</p><p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a block diagram showing a configuration example of the attack analyzer according to the first embodiment;</p><p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is an explanatory diagram illustrating a prediction table stored in a prediction table storage unit of the attack analyzer of the first embodiment;</p><p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is an explanatory diagram illustrating a reliability calculation method of a reliability calculation unit according to an example embodiment 1 of the first embodiment;</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is another explanatory diagram illustrating the reliability calculation method of the reliability calculation unit according to the example embodiment 1 of the first embodiment;</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a flowchart showing an operation of the attack analyzer according to the first embodiment;</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a block diagram showing a configuration example of the attack analyzer according to a second embodiment;</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is an explanatory diagram illustrating a method of assigning a flag performed by a flag-assigning unit according to the second embodiment; and</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a flowchart showing an operation of the attack analyzer according to a second embodiment.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DETAILED DESCRIPTION</heading><p id="p-0017" num="0016">Embodiments of the present disclosure will be described below with reference to the drawings.</p><p id="p-0018" num="0017">The present disclosure means the disclosure described in the section of claims or means for solving the problem (i.e., Summary section), and is not limited to the following embodiments. Further, at least the words and phrases in quotation marks mean the words and phrases described in the section of claims or means for solving the problem, and are not limited to the following embodiments.</p><p id="p-0019" num="0018">The configurations and methods described in the dependent claims of the claims section are arbitrary (i.e., non-essential) configurations and methods in the disclosure described in the independent terms of the claims. The configurations and methods of the embodiments corresponding to the configurations and methods described in the dependent claims, and the configurations and methods described only in the embodiments that are not described in the claims are arbitrary configurations and methods in the present disclosure. The configuration and method described in the embodiment when the description of the claims is wider than the description of the embodiment is also an arbitrary configuration and method in the present disclosure in the sense that it is an example of the configuration and method of the present disclosure. In either case, the description in the independent claim(s) provides an essential configuration and method of the present disclosure.</p><p id="p-0020" num="0019">Any effects described in the embodiments are effects obtained by a configuration of an embodiment as an example of the present disclosure, and are not necessarily effects of the present disclosure.</p><p id="p-0021" num="0020">When there are multiple embodiments, a configuration disclosed in each embodiment is not limited to each embodiment, but can be combined across embodiments. For example, a configuration disclosed in one embodiment may be combined with other embodiments. Configurations disclosed in multiple embodiments may be collected and combined.</p><p id="p-0022" num="0021">A difficulty described above is not a publicly known matter but is originally found by an applicant of the present application, and is a fact that confirms/proves non-obviousness of the present application together with a configuration and a method described in the present application.</p><heading id="h-0007" level="1">1. First Embodiment</heading><p id="p-0023" num="0022">(1) Arrangement of an Attack Analyzer <b>100</b> and an Electronic Control System S</p><p id="p-0024" num="0023"><figref idref="DRAWINGS">FIGS. <b>1</b>A and <b>1</b>B</figref> are diagrams illustrating arrangements of the attack analyzer <b>100</b> of the present embodiment. The attack analyzer <b>100</b> detects a cyber attack on the electronic control system S, and estimates an attack route of the cyber attack received by the electronic control system S. The attack analyzer <b>100</b> may take any arrangement/configuration in which necessary information is obtainable from the electronic control system S. Hereinafter, a cyber attack may be abbreviated as an attack. In addition, an attack may be described as abnormality based on a viewpoint of the electronic control system S affected under the attack.</p><p id="p-0025" num="0024">For example, as shown in <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, the electronic control system S and the attack analyzer <b>100</b> are &#x201c;mounted&#x201d; on a vehicle which is a &#x201c;moving body,&#x201d; and as shown in <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>, electronic devices are used. It is assumed that the control system S is &#x201c;mounted&#x201d; on a vehicle that is a &#x201c;moving body&#x201d;, and the attack analysis device <b>100</b> is realized by a server device installed outside the vehicle.</p><p id="p-0026" num="0025">The &#x201c;moving body&#x201d; refers to an object which is movable, and a travel speed thereof is arbitrary. Naturally, the above also includes a case where the movable object is stopped. Examples of the movable body include, but are not limited to, automobiles, motorcycles, bicycles, pedestrians, ships, aircrafts, and objects mounted thereon. Further, &#x201c;mounted&#x201d; includes not only a case where it is directly fixed to the movable body but also the case where it is not fixed to the movable body but moves together with the movable body. For example, the above may be a case where a person riding on the movable body carries the object, or a case where the object is mounted in a load placed on the movable body.</p><p id="p-0027" num="0026">In the case of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, the attack analyzer <b>100</b> and the electronic control system S are connected by an in-vehicle network such as CAN (Controller Area Network) or LIN (Local Interconnect Network). Alternatively, any communication method such as Ethernet (registered trademark), Wi-Fi (registered trademark), Bluetooth (registered trademark), or the like can be used for connection. As another example, the function of the attack analyzer <b>100</b> can be incorporated in at least one of the electronic control devices constituting the electronic control system S.</p><p id="p-0028" num="0027">In the case of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, the attack analyzer <b>100</b> can analyze the cyber attack without delay when the electronic control system S is attacked, and can promptly respond to the cyber attack.</p><p id="p-0029" num="0028">In the case of <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>, the attack analyzer <b>100</b> and the electronic control system S are connected by using a communication means consisting of wireless communication methods such as, for example, IEEE802.11 (Wi-Fi (registered trademark)), IEEE802.16 (WiMAX (registered trademark)), W-CDMA (Connect Wideband Code Division Multiple Access), HSPA (High Speed Packet Access), LTE (Long Term Evolution), LTE-A (Long Term Evolution Advanced), 4G, 5G and the like. Alternatively, Dedicated Short Range Communication (DSRC) can also be used. When a vehicle is parked in a parking lot or housed in a repair shop, a wired communication method can also be used instead of the wireless communication method. For example, a LAN (Local Area Network), the Internet, or a fixed telephone line can be used.</p><p id="p-0030" num="0029">In the case of <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>, when the electronic control system S mounted on a vehicle is attacked, the server device receives, from the vehicle, a security log generated by a security sensor mounted on an electronic control device constituting the electronic control system S, via a wireless communication network. Therefore, as compared with the case where the attack analyzer <b>100</b> is mounted on the vehicle, it takes time to analyze the attack and to feed back the analysis result to the vehicle, but it is possible to reduce the processing load on the vehicle. Moreover, since the abundant resources of the server device can be used, it is possible to execute a large amount of complicated arithmetic operations.</p><p id="p-0031" num="0030">As another arrangement, the following example can be considered. The electronic control system S may be mounted not on the vehicle but on a stationary body. Further, the electronic control system S and the attack analyzer <b>100</b> may be mounted on different vehicles and communicate directly or indirectly via a base station or the like.</p><p id="p-0032" num="0031">(2) Configuration of an Electronic Control System S</p><p id="p-0033" num="0032">(a) Overall Configuration</p><p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a diagram illustrating a configuration example of the electronic control system S. The electronic control system S includes TCU 11, IVI 12, CGW 13, ECU 14, ECU 15, ECU 16, and ECU 17.</p><p id="p-0035" num="0034">The TCU 11 (Telematics Control Unit) is an electronic control unit (ECU) having a communication function, and transmits/receives information by performing communication via an external information accumulation server or the Internet. The TCU 11 is called as an entry point because it can be an entrance for an attack from the outside by communicating with the outside of the electronic control system S.</p><p id="p-0036" num="0035">The IVI 12 (In-Vehicle Infotainment system) is an ECU that has a function of providing information and entertainment, and also has a communication function similar to that of the TCU 11, and the IVI 12 sends and receives information by communicating via an external information accumulation server or the Internet. Since the IVI 12 also communicates with the outside of the electronic control system S, it can be an entrance for an attack from the outside, so the IVI 12 is also called an entry point.</p><p id="p-0037" num="0036">The CGW 13 (Central GateWay) has, as its main function, a gateway (GW) function. For example, the information received by the TCU 11 or IVI 12 is transferred to the ECUs 14 to 17 connected via an in-vehicle network such as CAN or LIN or a communication network such as Ethernet (ETH). Further, the information transmitted from the ECUs 14 to 17 is transferred to the TCU 11 and the IVI 12. The CGW 13 can also be equipped with a function other than the gateway function. Further, the attack analyzer <b>100</b> described later can be mounted as a function of the CGW 13.</p><p id="p-0038" num="0037">ECUs 14 to 17 are ECUs connected to the CGW 13 via a network. In <figref idref="DRAWINGS">FIG. <b>2</b></figref>, the ECU 14 and the ECU 15 are connected via Ethernet. The ECU 16 and the ECU 17 are connected via a CAN, which is an in-vehicle network. The ECUs 14 to 17 may be any ECUs that realize each function of the vehicle, which include (i) electronic control devices for the drive system that control the engine, steering wheel, brake, etc., and include (ii) electronic control devices for the vehicle body that control the meters, power windows, etc, and include (iii) electronic control devices for information systems such as a navigation device, and include (iv) electronic control devices for safety control system that perform controls to prevent collision with an obstacle or a pedestrian, for example.</p><p id="p-0039" num="0038">In the following description, when not paying attention to the unique features of the above-mentioned TCU 11, IVI 12, CGW 13, ECU 14, ECU 15, ECU 16, and ECU 17, each of them may be simply referred to as an ECU.</p><p id="p-0040" num="0039">(b) Multi-Layer Defense and Layers</p><p id="p-0041" num="0040">In many electronic control systems S, multi-layer defense is adopted in order to enhance the security against attacks. According to multi-layer defense, security functions are provided hierarchically and in multiple layers as countermeasures against attacks, so that even if one countermeasure (that is, the first layer) is breached in the event of an attack, the next countermeasure (that is, the second layer) can still provide defense against attacks, the defense power of the electronic control system can be enhanced. Therefore, in the electronic control system S that employs multi-layer defense, there are a plurality of layers having different security levels. Therefore, the electronic control system S is divided into a plurality of layers according to the security level, and each ECU is classified into one of those layers.</p><p id="p-0042" num="0041">The electronic control system S shown in <figref idref="DRAWINGS">FIG. <b>2</b></figref> has three layers of defense. In this example, TCU 11 and IVI 12 belong to the first layer, CGW 13 belongs to the second layer, and ECUs 14 to 17 belong to the third layer. The TCU 11 and IVI 12 are ECUs having a communication function with the outside, and these ECUs are equipped with a security function for monitoring data entering the inside of the vehicle from the outside of the vehicle. The area monitored by the ECU having such a security function is the first layer. The CGW 13 is, for example, an ECU having a gateway function equipped with a security function for monitoring data communicated between a network to the ECU connected to the outside of the vehicle and a network to an ECU that controls the vehicle. The CGW 13 takes security measures different from those of the TCU 11 and IVI 12, and the area monitored by the CGW 13 has a security level different from that of the first layer, which is the area protected by the TCU 11 and the IVI 12. Therefore, the area monitored by CGW 13 is set as the second layer. It can be said that the ECUs 14 to 17 are in an area in which only the data that has passed the security function of the CGW 13 is communicated and has a security level different from that of the second layer. Therefore, the area to which the ECUs 14 to 17 belong is set as the third layer.</p><p id="p-0043" num="0042">Although the electronic control system S in <figref idref="DRAWINGS">FIG. <b>2</b></figref> has three layers of defense, four or more layers of defense may be provided. For example, the ECU connected via a sub-gateway ECU may be considered as the fourth layer.</p><p id="p-0044" num="0043">Further, although the hierarchy described in the present embodiment is a physical hierarchy starting from the entry point, a functional hierarchy may be used instead of all or part of the physical hierarchy. For example, there may be a case in which a master-slave relationship is set between ECUs.</p><p id="p-0045" num="0044">(c) Security Sensor</p><p id="p-0046" num="0045">Each ECU constituting the electronic control system S is equipped with one or more security sensors that monitor the inside of the ECU and the network to which the ECU is connected. When the security sensor detects an abnormality that has occurred inside the ECU or in the network, the security sensor generates and outputs a security log. The security log contains an abnormality detection signal indicating that the security sensor has detected an abnormality.</p><p id="p-0047" num="0046">Examples of the security sensor include firewalls, proxies, CAN-IDS, CAN filters, TLS, MAC verification, file access monitoring, secure boot, secure repro(gram), CFI, sandbox, authentication and the like.</p><p id="p-0048" num="0047">In addition to the abnormality detection signal, the security log contains abnormal position information indicating a position where the abnormality detected by the security sensor has occurred, identification information for identifying the electronic control system S, and identification information for identifying the ECU equipped with the security sensor, identification information of the security sensor that detected the abnormality, time when the abnormality was detected, number of times the abnormality was detected, order in which the abnormality was detected, information on data content and IP address (source and destination) received before the abnormality was detected, etc. may be included.</p><p id="p-0049" num="0048">(d) Failure Diagnosis Device</p><p id="p-0050" num="0049">Each ECU constituting the electronic control system S is further equipped with a failure diagnosis device that detects a failure that has occurred in each ECU. While the security sensor described above detects an abnormality by focusing on the security of the vehicle or in-vehicle system, the failure diagnosis device detects troubles that are generated in the ECU itself and the software installed in the ECU regardless of the security. Therefore, the security sensor may be not able to detect a defect that is not determined as be abnormal from the viewpoint of security, but the failure diagnosis device may be able to detect a defect that is not detected by the security software.</p><p id="p-0051" num="0050">The failure diagnostic device is, for example, an in-vehicle diagnostic device (OBD: On-Board Diagnostics). When the OBD detects a failure, it records a failure code called DTC (Diagnostic Trouble Code) according to the detected failure. The OBD detects, for example, that data values exceeding a preset upper limit or lower limit have been input/output, that communication has been interrupted, that the memory of the ECU has not been read normally, and the like, and records a failure code of the corresponding failure.</p><p id="p-0052" num="0051">In the present embodiment, when each ECU receives a request signal requesting failure information from the attack analyzer <b>100</b>, which will be described later, each ECU transmits failure information indicating a failure that has occurred in the ECU to the attack analyzer <b>100</b>. However, the ECU may be configured to transmit the failure information to the attack analyzer <b>100</b> as soon as the failure diagnosis device detects the failure that has occurred in the ECU.</p><p id="p-0053" num="0052">Each ECU may transmit the failure code recorded by the failure diagnosis device as it is as failure information, or may transmit information indicating that a failure has occurred as failure information.</p><p id="p-0054" num="0053">(3) Configuration of an Attack Analyzer <b>100</b></p><p id="p-0055" num="0054">The attack analyzer <b>100</b> of the present embodiment will be described with reference to <figref idref="DRAWINGS">FIG. <b>3</b></figref>. The attack analyzer <b>100</b> is a device that detects and analyzes an attack on the electronic control system S described above. The attack analyzer <b>100</b> includes a security log acquisition unit <b>101</b>, a failure information acquisition unit <b>102</b>, a prediction table storage unit <b>103</b>, an attack route estimation unit <b>104</b>, a request signal transmission unit <b>105</b>, and an attack information output unit <b>106</b>. Further, the attack route estimation unit <b>104</b> includes a predicted attack route candidate selection unit <b>107</b> and a reliability calculation unit <b>108</b>.</p><p id="p-0056" num="0055">When the attack analyzer <b>100</b> is provided in a vehicle, it may be provided by connecting to the electronic control system S via an in-vehicle network. Alternatively, the attack analyzer <b>100</b> may be provided inside the electronic control system S. For example, the attack analyzer <b>100</b> may be provided as a function of CGW 13 or TCU 11.</p><p id="p-0057" num="0056">The attack analyzer <b>100</b> may be composed of a general-purpose CPU (Central Processing Unit), a volatile memory such as RAM, a ROM, a flash memory, a non-volatile memory such as a hard disk, various interfaces, and an internal bus connecting them. Software is executed on the hardware, and thus a function of each functional block illustrated in <figref idref="DRAWINGS">FIG. <b>3</b></figref> can be realized. Of course, the attack analyzer <b>100</b> may also be realized by dedicated hardware such as LSI.</p><p id="p-0058" num="0057">In the present embodiment, the attack analyzer <b>100</b> assumes the form of an electronic control unit (hereinafter abbreviated as ECU) as a semi-finished product, but the attack analyzer <b>100</b> is not limited to such device. For example, the form of the attach analyzer <b>100</b> is a semiconductor circuit or semiconductor module, the form of a semi-finished product is an electronic control device, an electronic control unit, a system board, and the form of a finished product is a server, a workstation, or a personal computer (PC), a tablet, a smartphone, a mobile phone, a navigation system. Note that the attack analyzer <b>100</b> may be composed of a plurality of ECUs in addition to a single ECU.</p><p id="p-0059" num="0058">The security log acquisition unit <b>101</b> acquires a security log including an abnormality detection signal generated by a &#x201c;security sensor&#x201d; mounted on the ECU constituting the electronic control system S and indicating that the security sensor has detected an abnormality. For example, in the case of the arrangement shown in <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, the security log output to the in-vehicle network by the security sensor mounted on the TCU 11, CGW 13, ECU 14 to 17, etc. of the electronic control system S is connected to the in-vehicle network is acquired by receiving it by the security log acquisition unit <b>101</b>. In the case of the arrangement shown in <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>, the security sensor mounted on the TCU 11, CGW 13, ECU 14-17, etc. of the electronic control system S outputs the security log to the in-vehicle network, and the security log transmitted from the TCU 11 using wireless communication is received by the security log acquisition unit <b>101</b> connected to a network such as the Internet.</p><p id="p-0060" num="0059">Here, the &#x201c;security sensor&#x201d; refers to a function of monitoring an electronic control unit (ECU) or a network constituting an electronic control system and outputting a security log when a security event occurs, and the means for realizing the sensor does not matter.</p><p id="p-0061" num="0060">The failure information acquisition unit <b>102</b> acquires failure information indicating a &#x201c;failure&#x201d; detected by a failure diagnosis device mounted on an ECU constituting the electronic control system S. For example, in the case of the arrangement shown in <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, the failure information output to the in-vehicle network by the failure diagnosis device mounted on the TCU 11, CGW 13, ECU 14 to 17, etc. of the electronic control system S is acquired by receiving it by the failure information acquisition unit <b>102</b> connected to the in-vehicle network. In the case of the arrangement shown in <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>, the failure diagnosis device mounted on the TCU 11, CGW 13, ECU 14-17, etc. of the electronic control system S outputs the failure information to the in-vehicle network, and the failure information transmitted from the TCU 11 using wireless communication is acquired by receiving it by the failure information acquisition unit <b>102</b> connected to a network such as the Internet.</p><p id="p-0062" num="0061">Here, the &#x201c;failure&#x201d; may include not only a physical defect that has occurred in the hardware, but also a defect that has occurred in the software installed in the hardware.</p><p id="p-0063" num="0062">Note that the security log acquisition unit <b>101</b> and the failure information acquisition unit <b>102</b> may be realized as one acquisition unit.</p><p id="p-0064" num="0063">The prediction table storage unit <b>103</b> stores a prediction table showing a correspondence between a predicted attack route identified by a predicted attack start point, a predicted attack target, a relevant (intermediate) ECU en route from the predicted attack start point to the predicted attack target in the electronic control system S, and a predicted abnormality detection signal predicted to be generated by the security sensor. The prediction table may sometimes be called as a pattern matching table or a matching table.</p><p id="p-0065" num="0064"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a diagram showing an example of a prediction table. The prediction table of <figref idref="DRAWINGS">FIG. <b>4</b></figref> is a table that associates which security sensor mounted on each ECU detects an abnormality when there is an attack on the predicted attack target from the predicted attack start point. In <figref idref="DRAWINGS">FIG. <b>4</b></figref>, &#x2018;1&#x2019; represents a state in which an abnormality is detected, and &#x2018;0&#x2019; represents a state in which an abnormality is not detected. That is, the predicted attack start point, the predicted attack target, and the relevant ECU in <figref idref="DRAWINGS">FIG. <b>4</b></figref> correspond to the &#x201c;predicted attack route&#x201d;, and 0 or 1 of each security sensor corresponds to the &#x201c;predicted abnormality detection signal&#x201d;. For example, an event E<b>1</b> shows a situation in which, when the predicted attack start point is external and the predicted attack target is CGW 13, the security sensors A and B of the TCU 11 detect an abnormality, that is, output a predicted abnormality detection signal. In event E<b>2</b> and event E<b>3</b>, the predicted attack route and the predicted abnormality detection signal are associated with each other by the same rule.</p><p id="p-0066" num="0065">In the present embodiment, the predicted attack route is defined by the predicted attack start point, the predicted attack target, and the relevant ECU. However, since the relevant ECU can be specified from the predicted attack start point and the predicted attack target, it is possible to identify the relevant ECU from the predicted attack start point and the predicted attack target. Thus, the predicted attack route may be determined by the predicted attack start point and the predicted attack target. Alternatively, the predicted attack route may be determined by preset identification information. In such case, the attack analyzer <b>100</b> has a table in which the identification information is associated with the predicted attack start point, the predicted attack target, and the relevant ECU, in addition to the prediction table.</p><p id="p-0067" num="0066">In the present embodiment, the patterns of the predicted abnormality detection signals of the security sensors of the TCU 11, CGW 13, and the ECU 14 are used, but the patterns of the predicted abnormality detection signals of the security sensors mounted on the other ECUs may also be used.</p><p id="p-0068" num="0067">Returning to <figref idref="DRAWINGS">FIG. <b>3</b></figref>, the attack route estimation unit <b>104</b> estimates, by using the prediction table, the attack route of the attack received by the electronic control system S from the abnormality detection signal included in the security log and the failure information.</p><p id="p-0069" num="0068">Preferably, the attack route estimation unit <b>104</b> has a predicted attack route candidate selection unit <b>107</b>. More preferably, the attack route estimation unit <b>104</b> has a reliability calculation unit <b>108</b>.</p><p id="p-0070" num="0069">The attack route estimation unit <b>104</b> of the present embodiment mainly performs two processes for estimating an attack route. The first is the selection of a predicted attack route candidate by the predicted attack route candidate selection unit <b>107</b>. The second is the calculation of the reliability of the predicted attack route candidate selected in the first process by the reliability calculation unit <b>108</b>. Both of these two processes are included in the estimation of the attack route. These processes may be executed with other process interposed in between, or may be performed continuously in time (i.e., in series).</p><p id="p-0071" num="0070">The predicted attack route candidate selection unit <b>107</b> selects, by using the prediction table, a predicted attack route candidate from the predicted attack routes by comparing the abnormality detection signal and the predicted abnormality detection signal. The reliability calculation unit <b>108</b> uses the failure information to obtain the &#x201c;reliability&#x201d; indicating the certainty of the predicted attack route candidate.</p><p id="p-0072" num="0071">Here, the &#x201c;reliability&#x201d; is sufficient as long as it indicates the degree of certainty, and includes not only the case where it is indicated by a numerical value but also the case where it is indicated by a standardized value or a symbol or a set.</p><p id="p-0073" num="0072">The request signal transmission unit <b>105</b> transmits a request signal requesting transmission of failure information to the ECU included in the route of the predicted attack route candidate selected by the predicted attack route candidate selection unit <b>107</b>.</p><p id="p-0074" num="0073">By configuring each ECU to transmit failure information only when requested by a request signal, the opportunity for transmission and reception of failure information is limited to the timing when an attack on the electronic control system occurs. Further, by transmitting the request signal only to the ECU that may be related to the attack, the failure information of the ECU that has not been attacked will not be transmitted or received. Therefore, it is possible to suppress the network load caused by the transmission and reception of failure information.</p><p id="p-0075" num="0074">The attack information output unit <b>106</b> outputs attack information indicating an attack route estimated by the attack route estimation unit <b>104</b>. Preferably, the attack information output unit <b>105</b> outputs attack information, which indicates that the predicted attack route candidate selected by the predicted attack route candidate selection unit <b>107</b> serves as an estimated attack route. More preferably, the attack information output unit <b>105</b> outputs attack information, which indicates that the predicted attack route candidate selected by the predicted attack route candidate selection unit <b>107</b> and the reliability obtained by the reliability calculation unit <b>108</b> serve as an estimated attack route.</p><p id="p-0076" num="0075">In the present embodiment, all of the predicted attack route candidates selected by the predicted attack route candidate selection unit <b>107</b> are output from the attack information output unit <b>106</b> as attack routes, but only a part of the predicted attack route candidates may be output as attack routes. For example, the predicted attack route candidates from the one with the highest reliability to the third may be output as attack routes.</p><p id="p-0077" num="0076">Hereinafter, as an embodiment, a specific estimation method of the attack route estimation unit <b>104</b> and the contents of the attack information output by the attack information output unit <b>106</b> will be described with reference to <figref idref="DRAWINGS">FIGS. <b>5</b></figref> and <b>6</b>. <figref idref="DRAWINGS">FIGS. <b>5</b> and <b>6</b></figref> are diagrams for explaining a method of selecting a predicted attack route candidate and a method of calculating reliability using the prediction table of <figref idref="DRAWINGS">FIG. <b>4</b></figref>.</p><heading id="h-0008" level="1">(a) Example Embodiment 1</heading><p id="p-0078" num="0077">The example embodiment 1 is an example of correcting the reliability obtained from the prediction table by using the failure information. Hereinafter, the process will be described with reference to <figref idref="DRAWINGS">FIG. <b>5</b></figref>.</p><p id="p-0079" num="0078">It is assumed that the security sensor A of the TCU 11 outputs an abnormality detection signal, and the security log acquisition unit <b>101</b> receives this abnormality detection signal. At this time, the predicted attack route candidate selection unit <b>107</b> selects an event in which the security sensor A detects the predicted abnormality detection signal from the prediction table by comparing the abnormality detection signal with the predicted abnormality detection signal. In the case of <figref idref="DRAWINGS">FIG. <b>5</b></figref>, since the events in which the security sensor A detects the predicted abnormality detection signal are the events E<b>1</b>, E<b>2</b>, and E<b>3</b>, the events E<b>1</b>, E<b>2</b>, and E<b>3</b> are selected as the predicted attack route candidates.</p><p id="p-0080" num="0079">The request signal transmission unit <b>105</b> transmits a request signal requesting failure information to the ECU included in the predicted attack route candidates of the events E<b>1</b>, E<b>2</b>, and E<b>3</b>. In the example of <figref idref="DRAWINGS">FIG. <b>5</b></figref>, a request signal is transmitted to the TCU 11, CGW 13, and ECU 14. As an example, it is assumed that the CGW 13 outputs failure information in response to the request signal and the failure information acquisition unit <b>102</b> receives the failure information.</p><p id="p-0081" num="0080">The reliability calculation unit <b>108</b> obtains the reliability of the predicted attack route candidate selected by the predicted attack route candidate selection unit <b>107</b>. For example, the reliability calculation unit <b>108</b> obtains the reliability in consideration of the ratio of the abnormality detection signal and the predicted abnormality detection signal of each predicted attack route candidate. For example, in the present case, only the security sensor A outputs an abnormality detection signal. Then, the predicted abnormality detection signals of the same ECU as the ECU from which the abnormality detection signal is output are output from the security sensors A and B in the events E<b>1</b> and E<b>2</b>, whereas only the security sensor A outputs the same in the event E<b>3</b>, thereby indicating a situation that it is more likely that an attack corresponding to the event E<b>3</b> has been or was carried out. Therefore, the reliability is obtained (i.e., calculated) so that the reliability of the event E<b>3</b> is higher than the reliability of the events E<b>1</b> and E<b>2</b>. In the example of <figref idref="DRAWINGS">FIG. <b>5</b></figref>, as an example, the reliability of events E<b>1</b> and E<b>2</b> is 0.5, and the reliability of event E<b>3</b> is 0.6. However, these numbers are only an example, and an arbitrary numerical value or arithmetic expression can be used to calculate. Note that in the above-mentioned reliability calculation example, the reliability is calculated by considering only the predicted abnormality detection signal of the same ECU as the ECU from which the abnormality detection signal is output, but the reliability may be obtained further in consideration of the predicted abnormality detection signal of the ECU from which no abnormality detection signal is output.</p><p id="p-0082" num="0081">Further, since the failure information indicating that the failure has occurred in the CGW 13 is acquired, the reliability calculation unit <b>108</b> performs a process of increasing the reliability of the predicted attack route candidate including the CGW 13 which is the ECU in which the failure has occurred. In the case of <figref idref="DRAWINGS">FIG. <b>5</b></figref>, since the predicted attack route candidates including the CGW 13 in between the predicted attack start point and the predicted attack target are the events E<b>2</b> and E<b>3</b>, the reliability of the events E<b>2</b> and E<b>3</b> is set as a new value which is increased by adding a predetermined value, i.e., a in the present example embodiment 1, to the original reliability set in advance. The predetermined value a may be a constant or a variable that changes depending on the conditions.</p><p id="p-0083" num="0082">The attack information output unit <b>106</b> outputs events E<b>1</b>, E<b>2</b>, and E<b>3</b>, which are predicted attack route candidates, as attack information. At this time, the attack information may be output using the reliability of the events E<b>1</b>, E<b>2</b>, and E<b>3</b> as the attack route.</p><p id="p-0084" num="0083">Next, with reference to <figref idref="DRAWINGS">FIG. <b>6</b></figref>, an example of obtaining reliability when a failure occurs in each of a plurality of ECUs and failure information is acquired from each of these ECUs will be described. In this example, it is assumed that a failure has occurred in the ECU 14 in addition to the CGW 13.</p><p id="p-0085" num="0084">In such case, similar to the example of <figref idref="DRAWINGS">FIG. <b>5</b></figref>, a is added to the reliability of the events E<b>2</b> and E<b>3</b> as a process of increasing the reliability of the predicted attack route candidate including the CGW 13 in the route. Further, a process of increasing the reliability of the predicted attack route candidate including the ECU 14 in the route is performed. In this example, since the only predicted attack route candidate including the ECU 14 from the predicted attack start point to the predicted attack target is the event E<b>3</b>, a process of further adding 13 to the reliability of the event E<b>3</b> is performed. The values (&#x3b1;, &#x3b2;) added to the reliability when a failure occurs in a plurality of ECUs may be the same value, or different values may be set for respective ECUs.</p><p id="p-0086" num="0085">In the description of the present embodiment, the reliability is first obtained without using the failure information, and then the reliability is corrected using the failure information. However, the reliability may also be calculated in one process. The same applies to the examples described later.</p><p id="p-0087" num="0086">According to the example embodiment 1, since the reliability is obtained by using the failure information in addition to the conventional abnormality detection signal, the accuracy of estimation by the attack route estimation unit <b>104</b> can be improved.</p><heading id="h-0009" level="1">(b) Example Embodiment 2</heading><p id="p-0088" num="0087">The present example embodiment is an example of obtaining the reliability according to the content of the failure indicated by the failure information.</p><p id="p-0089" num="0088">As in the example embodiment 1, it is assumed that the security sensor A of the TCU 11 outputs an abnormality detection signal, and the security log acquisition unit <b>101</b> receives this abnormality detection signal. Further, it is assumed that the failure diagnosis device of the CGW 13 detects the failure that occurred in the CGW 13 and outputs the failure information, and the failure information acquisition unit <b>102</b> receives the failure information.</p><p id="p-0090" num="0089">Here, if the failure indicated by the failure information is a hardware failure caused by aging deterioration, or if the cause of the communication interruption failure is due to the ECU of the communication partner, these failures are highly possibly caused not by an attack. As described above, when it is clear that the failure indicated by the failure information is not caused by the attack, the reliability calculation unit <b>108</b> does not perform the process of adding a to the reliability using the failure information. That is, in such case, the reliability (0.5, 0.6) shown in <figref idref="DRAWINGS">FIGS. <b>5</b> and <b>6</b></figref> is the reliability of each predicted attack route candidate. Alternatively, a predetermined value may be subtracted from these reliability values to obtain a new reliability.</p><p id="p-0091" num="0090">As another example, the value to be added to the reliability may be changed according to the content of the failure indicated by the failure information. In the example embodiment 1, a new reliability is calculated by adding a predetermined value (&#x3b1;) to the reliability of the predicted attack route candidates including an ECU having a failure in the route. In the example embodiment 2, the value of a changes depending on the content of the failure.</p><p id="p-0092" num="0091">For example, when the content of the failure indicated by the failure information is a failure that is likely to be caused by an attack, the value to be added to the reliability is set to a high value for obtaining the reliability. On the other hand, when the content of the failure is a failure that is unlikely to be caused by an attack, the value to be added to the reliability is set to a low value for obtaining the reliability.</p><p id="p-0093" num="0092">According to the example embodiment 2, since the reliability is obtained according to the content of the failure indicated by the failure information in addition to the conventional abnormality detection signal, the accuracy of estimation by the attack route estimation unit <b>104</b> can be improved.</p><p id="p-0094" num="0093">(4) Operation of an Attack Analyzer <b>100</b></p><p id="p-0095" num="0094">The operation of the attack analyzer <b>100</b> will be described with reference to <figref idref="DRAWINGS">FIG. <b>7</b></figref>. <figref idref="DRAWINGS">FIG. <b>7</b></figref> not only shows an attack analysis method executed by the attack analyzer <b>100</b>, but also shows a processing procedure of an attack analysis program that can be executed by the attack analyzer <b>100</b>. And these processes are not limited to the order shown in <figref idref="DRAWINGS">FIG. <b>7</b></figref>. That is, the order may be changed as long as there are no restrictions such as a relationship in which a result of a preceding step is used in a certain step. Hereinafter, the same applies to <figref idref="DRAWINGS">FIG. <b>10</b></figref> in the second embodiment.</p><p id="p-0096" num="0095">The attack analyzer <b>100</b> includes a prediction table storage unit (<b>103</b>) for storing a prediction table showing a correspondence between the predicted attach route identified by the predicted attack start point and the predicted attack target in the electronic control system S and the predicted abnormality detection signal predicted to be generated by the security sensor.</p><p id="p-0097" num="0096">A security log (i) generated by a security sensor mounted on an electronic control device constituting the electronic control system S and (ii) including an abnormality detection signal indicating that the security sensor has detected an abnormality is acquired (S<b>101</b>).</p><p id="p-0098" num="0097">The prediction table is read from the prediction table storage unit <b>103</b>, and the attack route of the attack received by the electronic control system S is estimated from the abnormality detection signal included in the security log acquired in S<b>101</b>, and a first attack route is estimated (S<b>102</b>). Specifically, a predicted attack route candidate is selected from the predicted attack routes stored in the prediction table.</p><p id="p-0099" num="0098">A request signal requesting failure information is transmitted to the ECU included in the predicted attack route candidate selected in S<b>102</b> (S<b>103</b>). Then, the failure information transmitted from each ECU is acquired in response to the request signal transmitted in S<b>103</b> (S<b>104</b>). If the failure diagnosis device mounted on each ECU does not detect a failure, the failure information may be not transmitted from each ECU and S<b>104</b> may be not performed.</p><p id="p-0100" num="0099">The reliability is calculated as an estimation of the second attack route (S<b>105</b>). Here, when the failure information is acquired in S<b>104</b>, the reliability calculation unit <b>108</b> calculates the reliability using the failure information. On the other hand, when the failure information is not acquired in S<b>104</b>, the reliability calculation unit <b>108</b> calculates the reliability without using the failure information.</p><p id="p-0101" num="0100">Attack information is output, including the predicted attack route candidate selected in S<b>102</b> and as an estimated attack route whose reliability calculated in S<b>105</b> (S<b>106</b>).</p><p id="p-0102" num="0101">Note that, in <figref idref="DRAWINGS">FIG. <b>7</b></figref>, since the situation is described as a case where the failure information is transmitted only when each ECU receives a request signal, two attack routes are estimated (S<b>102</b> and S<b>105</b>). However, in a configuration in which the failure information is transmitted as soon as the ECU detects the failure, the failure information can be acquired from the memory in the attack analyzer <b>100</b> without transmitting a request signal. Therefore, for example, the attack analyzer <b>100</b> can acquire the security log (S<b>101</b>), can acquire the failure information from the memory (S<b>104</b>), and then can collectively estimate the attack routes of S<b>102</b> and S<b>105</b>.</p><p id="p-0103" num="0102">Further, in the present embodiment, the reliability is calculated by estimating the second attack route in S<b>105</b>. However, the reliability may be calculated in the estimation of the first attack route in S<b>102</b>, and, in the estimation of the second attack route in S<b>105</b>, a process of obtaining a new reliability from the reliability calculated in S<b>102</b> may be performed by using the failure information.</p><p id="p-0104" num="0103">(5) Summary</p><p id="p-0105" num="0104">As described above, according to the attack analyzer <b>100</b> of the present embodiment, when the electronic control system S receives a cyber attack, the reliability of the estimated attack route is calculated by using the failure information output from the electronic control devices constituting the electronic control system S. Since the failure information may indicate a failure that was not detected by the security sensor, by using the failure information for evaluation of the reliability of the attack route, the attack route can be estimated more accurately, compared to the case where only the conventional abnormality detection signal is used. Further, the failure information can also be used to estimate damage situation caused by an attack. For example, it is possible to estimate a situation in which a failure that is not detected by the security sensor has occurred due to the attack, or a situation in which the ECU is operated by an attacker due to the attack.</p><heading id="h-0010" level="1">2. Second Embodiment</heading><p id="p-0106" num="0105">In the second embodiment, instead of obtaining the reliability using the failure information, a flag is given to the predicted attack route candidate. Hereinafter, the description of the configuration common to the first embodiment will be omitted, and the differences from the first embodiment will be mainly described.</p><p id="p-0107" num="0106">(1) Configuration of an Attack Analyzer <b>200</b></p><p id="p-0108" num="0107"><figref idref="DRAWINGS">FIG. <b>8</b></figref> shows the attack analyzer <b>200</b> of the present embodiment. As shown in <figref idref="DRAWINGS">FIG. <b>8</b></figref>, unlike the first embodiment, the attack route estimation unit <b>104</b> of the present embodiment has a flag assign unit <b>201</b>.</p><p id="p-0109" num="0108">When the failure information acquisition unit <b>102</b> acquires the failure information, the flag assign unit <b>201</b> assigns a failure flag only to an attack route candidate or candidates including a failure-caused ECU, which is an ECU having a failure indicated by the failure information, among the candidates selected by the predicted attack route candidate selection unit <b>107</b>.</p><p id="p-0110" num="0109">A method of assigning a failure flag to a predicted attack route candidate will be described with reference to <figref idref="DRAWINGS">FIG. <b>9</b></figref>. Similar to the example embodiment 1 and 2 of the first embodiment, it is assumed that the failure diagnosis device of the CGW 13 detects a failure that occurred in the CGW 13 and outputs the failure information, and the failure information acquisition unit <b>102</b> receives the failure information. In such case, a failure flag is assigned to the events E<b>2</b> and E<b>3</b> in which the CGW 13 is included in the route, i.e., a predicted attack route candidate. In <figref idref="DRAWINGS">FIG. <b>9</b></figref>, 1 represents a state in which the failure flag is assigned, and 0 represents a state in which the failure flag is not assigned.</p><p id="p-0111" num="0110">Although <figref idref="DRAWINGS">FIG. <b>9</b></figref> shows an example in which one failure flag is given to each predicted attack route candidate, a plurality of failure flags may be given to one predicted attack route candidate. For example, when a failure occurs in the CGW 13 and the ECU 14, and the failure information output from each of these ECUs is acquired, one failure flag is assigned to a predicted attack route candidate having the CGW 13 in the route, and also one failure flag is assigned to a predicted attack route candidate having the ECU 14 in the route. In such case, two failure flags are assigned to the event E<b>3</b>, which is a predicted attack route candidate in which the CGW 13 and the ECU 14 are included in the route. The attack information output unit <b>106</b> outputs attack information, using the predicted attack route candidate and the failure flag as the attack route. Note that the attack information output unit <b>106</b> may output the attack information in which reliability is added as an attack route.</p><p id="p-0112" num="0111">In the present embodiment, a configuration has been described in which the reliability will not be calculated by using the failure information when the failure flag is assigned. However, in the present embodiment, the reliability calculation unit <b>108</b> may perform a process of obtaining the reliability by using the failure information.</p><p id="p-0113" num="0112">In the present embodiment, regardless of whether or not the failure flag is assigned, the predicted attack route candidate is output from the attack information output unit <b>106</b> as the attack route. However, only the predicted attack route candidate to which the failure flag is assigned may be output as an attack route.</p><p id="p-0114" num="0113">(2) Operation of an Attack Analyzer <b>200</b></p><p id="p-0115" num="0114">The processing of S<b>101</b> to S<b>106</b> shown in <figref idref="DRAWINGS">FIG. <b>10</b></figref> is the same as that of <figref idref="DRAWINGS">FIG. <b>7</b></figref> of the first embodiment. However, as described above, in the estimation of the second attack route in S<b>105</b>, the reliability may be calculated using the failure information as in the first embodiment, or the reliability may be calculated without using the failure information.</p><p id="p-0116" num="0115">Further, in the second embodiment, when the failure information is acquired in S<b>104</b>, a failure flag is assigned to a predicted attack route candidate having an ECU in which a failure indicated by the failure information has occurred (S<b>201</b>).</p><p id="p-0117" num="0116">Then, the attack information is output, using the predicted attack route candidate selected in S<b>102</b>, the reliability calculated in S<b>105</b>, and the failure flag assigned in S<b>201</b> as an attack route (S<b>106</b>).</p><p id="p-0118" num="0117">(3) Summary</p><p id="p-0119" num="0118">As described above, according to the attack analysis device <b>200</b> of the present embodiment, when the electronic control system S receives a cyber attack, a failure flag indicating that a failure has occurred in an ECU included in the predicted attack route candidate is output. When a more detailed analysis of the attack is performed downstream of the attack analyzer <b>200</b>, it is possible to provide useful information for the detailed analysis as compared with the case where only the attack route is provided.</p><heading id="h-0011" level="1">3. Conclusion</heading><p id="p-0120" num="0119">The features of the attack analyzer and the like in the embodiments of the present disclosure have been described above.</p><p id="p-0121" num="0120">Since the terms used in the embodiments are examples, the terms may be replaced with terms that are synonymous or include synonymous functions.</p><p id="p-0122" num="0121">The block diagram used for the description of the embodiment is obtained by classifying and arranging the configurations of the device for each of the functions. Individual function blocks may be implemented by arbitrarily combining hardware and software. Further, since the block diagram illustrates functions, the block diagram can be understood as disclosure of a method and a program that implements the method.</p><p id="p-0123" num="0122">Function blocks that can be understood as processes, flows, and methods described in the respective embodiments may be changed in order as long as there is no restrictions such as a relationship in which results of preceding other steps are used in one step.</p><p id="p-0124" num="0123">The terms such as first, second, to N-th (where N is an integer) used in each of the embodiments and in the claims are used to distinguish two or more configurations and methods of the same kind and are not intended to limit the order or superiority.</p><p id="p-0125" num="0124">Each of the embodiments is provided based on an assumption of providing a vehicle attack analyzer for analyzing a server attack on an electronic control system mounted on a vehicle, but the present disclosure encompasses, unless otherwise limited within the scope of the claims, other dedicated or general-purpose devices.</p><p id="p-0126" num="0125">Further, as an example form of the attack analyzer of the present disclosure, the following can be mentioned. Examples of a form of a component include a semiconductor device, an electronic circuit, a module, and a microcomputer. Examples of a form of a semi-finished product include an electronic control device (i.e., electronic control unit or ECU) and a system board. Examples of a form of a finished product include a cellular phone, a smartphone, a tablet computer, a personal computer (PC), a workstation, and a server. The example forms may further include a device having a communication function and the like, such as for example, a video camera, a still camera, and a car navigation system, for example.</p><p id="p-0127" num="0126">In addition, necessary functions such as an antenna and a communication interface may be added to the attack analyzer.</p><p id="p-0128" num="0127">It is assumed that the attack analyzer of the present disclosure is used for the purpose of providing various services, especially by being used on the server side. For providing such services, the attack analyzer of the present disclosure will be used, the method of the present disclosure will be used, and/or the program of the present disclosure will be executed.</p><p id="p-0129" num="0128">Further, the present disclosure is implemented not only by dedicated hardware having a configuration and a function described in relation to each of the embodiments, but by a combination of (i) a program for implementing the present disclosure, which is recorded on such a recording medium as memory, a hard disk and the like, and (ii) general-purpose hardware including dedicated or general-purpose CPU, memory, or the like, capable of executing the program.</p><p id="p-0130" num="0129">A program stored in a non-transitory, tangible storage medium (for example, an external storage device (a hard disk, a USB memory, a CD/BD, or the like) of dedicated or general-purpose hardware, or stored in an internal storage device (a RAM, a ROM, or the like)) may be provided to dedicated or general-purpose hardware via a recording medium, or from a server via a communication line without using the recording medium. In such manner, it is possible to always provide a latest function by updating the program.</p><p id="p-0131" num="0130">An attack analyzer of the present disclosure includes: a security log acquisition unit acquiring a security log (i) including an abnormality detection signal generated by a security sensor and (ii) indicating that the security sensor has detected an abnormality, the security sensor mounted on an electronic control device constituting an electronic control system; a failure information acquisition unit acquiring failure information indicating a failure occurred in the electronic control device; a prediction table storage unit storing a prediction table showing a correspondence relationship between a predicted attack route in the electronic control system and a predicted abnormality detection signal predicted to be generated by the security sensor; an attack route estimation unit estimating, using the prediction table, the attack route of an attack received by the electronic control system from the abnormality detection signal included in the security log and the failure information; and an attack information output unit outputting attack information indicating the attack route.</p><heading id="h-0012" level="1">INDUSTRIAL APPLICABILITY</heading><p id="p-0132" num="0131">The attack analyzer of the present disclosure is mainly intended for or targeting a device that analyzes a cyber attack received by an electronic control system mounted on an automobile, but may also be intended for or targeting a device that analyzes an attack on a normal system that is not mounted on an automobile.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-claim-statement>What is claimed is:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. An attack analyzer comprising:<claim-text>a security log acquisition unit acquiring a security log (i) including an abnormality detection signal generated by a security sensor and (ii) indicating that the security sensor has detected an abnormality, the security sensor mounted on an electronic control device constituting an electronic control system;</claim-text><claim-text>a failure information acquisition unit acquiring failure information indicating a failure occurred in the electronic control device;</claim-text><claim-text>a prediction table storage unit storing a prediction table showing a correspondence relationship between a predicted attack route in the electronic control system and a predicted abnormality detection signal predicted to be generated by the security sensor;</claim-text><claim-text>an attack route estimation unit estimating, using the prediction table, the attack route of an attack received by the electronic control system from the abnormality detection signal included in the security log and the failure information; and</claim-text><claim-text>an attack information output unit outputting attack information indicating the attack route.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The attack analyzer of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the attack route estimation unit includes: a predicted attack route candidate selection unit selecting a predicted attack route candidate from the predicted attack route by comparing the abnormality detection signal with the predicted abnormality detection signal using the prediction table, and</claim-text><claim-text>wherein the attack information output unit outputs the attack information indicating that the predicted attack route candidate serves as the attack route.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The attack analyzer of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein<claim-text>the attack route estimation unit further includes: a reliability calculation unit obtaining a reliability indicating certainty of the predicted attack route candidate using the failure information, and</claim-text><claim-text>the attack information output unit outputs the attack information indicating that the predicted attack route candidate and the reliability serve as the attack route.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The attack analyzer of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein<claim-text>the reliability calculation unit performs a process of increasing the reliability of the predicted attack route candidate including, in the attack route, an electronic control device in which a failure has occurred.</claim-text></claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The attack analyzer of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein<claim-text>the reliability calculation unit calculates the reliability of the predicted attack route candidate including, in the attack route, an electronic control device in which a failure has occurred according to a content of the failure.</claim-text></claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The attack analyzer of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein<claim-text>the attack route estimation unit further includes:</claim-text><claim-text>a flag assign unit assigning a flag to the predicted attack route candidate including, in the attack route, an electronic control unit in which the failure has occurred, and</claim-text><claim-text>the attack information output unit outputs the attack information using the predicted attack route candidate and the flag as the attack route.</claim-text></claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The attack analyzer of <claim-ref idref="CLM-00002">claim 2</claim-ref> further comprising:<claim-text>a request signal transmission unit transmitting a request signal requesting for the failure information to the electronic control device included in the predicted attack route candidate, wherein</claim-text><claim-text>the failure information acquisition unit acquires the failure information from the electronic control device to which the request signal is transmitted.</claim-text></claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The attack analyzer of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the predicted attack route is identified by a predicted attack start point, a predicted attack target, and an electronic control device or devices en route in between the predicted attack start point and the predicted attack target.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The attack analyzer of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the electronic control system and the attack analyzer are mounted on a movable body.</claim-text></claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The attack analyzer of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein<claim-text>the electronic control system is mounted on a movable body, and</claim-text><claim-text>the attack analyzer is a server device installed outside the movable body.</claim-text></claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. An attack analysis method performed by an attack analyzer having a prediction table that shows a correspondence relationship between a predicted attack route in an electronic control system and a predicted abnormality detection signal predicted to be generated by a security sensor, the attack analysis method comprising steps of:<claim-text>acquiring a security log including an abnormality detection signal generated by the security sensor and indicating that the security sensor has detected an abnormality, the security sensor mounted on an electronic control device constituting the electronic control system;</claim-text><claim-text>acquiring failure information indicating a failure occurred in the electronic control device;</claim-text><claim-text>reading the prediction table and estimating the attack route of an attack received by the electronic control system from the abnormality detection signal included in the security log and the failure information; and</claim-text><claim-text>outputting attack information indicating the attack route.</claim-text></claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. A non-transitory, computer-readable, storage medium storing instructions that, when executed by one or more processors, perform an attack analysis process, wherein the attack analysis process includes:<claim-text>controlling an attack analyzer having a prediction table that shows a correspondence relationship between a predicted attack route in an electronic control system and a predicted abnormality detection signal predicted to be generated by a security sensor,</claim-text><claim-text>acquiring a security log including an abnormality detection signal generated by the security sensor and indicating that the security sensor has detected an abnormality, the security sensor mounted on an electronic control device constituting the electronic control system;</claim-text><claim-text>acquiring failure information indicating a failure occurred in the electronic control device;</claim-text><claim-text>reading the prediction table and estimating the attack route of an attack received by the electronic control system from the abnormality detection signal included in the security log and the failure information; and</claim-text><claim-text>outputting attack information indicating the attack route.</claim-text></claim-text></claim></claims></us-patent-application>