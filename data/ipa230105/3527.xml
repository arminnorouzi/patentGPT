<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230003528A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230003528</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17941764</doc-number><date>20220909</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><priority-claims><priority-claim sequence="01" kind="regional"><country>EP</country><doc-number>20398002.4</doc-number><date>20200311</date></priority-claim></priority-claims><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>01</class><subclass>C</subclass><main-group>21</main-group><subgroup>16</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>01</class><subclass>P</subclass><main-group>13</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>01</class><subclass>C</subclass><main-group>25</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>A</section><class>61</class><subclass>B</subclass><main-group>5</main-group><subgroup>11</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>A</section><class>61</class><subclass>B</subclass><main-group>5</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>01</class><subclass>C</subclass><main-group>21</main-group><subgroup>16</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>01</class><subclass>P</subclass><main-group>13</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>01</class><subclass>C</subclass><main-group>25</main-group><subgroup>005</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>B</subclass><main-group>5</main-group><subgroup>1126</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>B</subclass><main-group>5</main-group><subgroup>6828</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>B</subclass><main-group>2562</main-group><subgroup>0219</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>B</subclass><main-group>2562</main-group><subgroup>0223</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>B</subclass><main-group>2505</main-group><subgroup>09</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>A</section><class>61</class><subclass>B</subclass><main-group>2560</main-group><subgroup>0223</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e61">CORRECTION OF HEADING ERRORS OF INERTIAL MEASUREMENT UNITS OF A MOTION TRACKING SYSTEM</invention-title><us-related-documents><continuation><relation><parent-doc><document-id><country>US</country><doc-number>PCT/EP2021/056233</doc-number><date>20210311</date></document-id><parent-status>PENDING</parent-status></parent-doc><child-doc><document-id><country>US</country><doc-number>17941764</doc-number></document-id></child-doc></relation></continuation></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>SWORD HEALTH S.A.</orgname><address><city>Porto</city><country>PT</country></address></addressbook><residence><country>PT</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>SANTOS</last-name><first-name>Pedro Henrique Oliveira</first-name><address><city>Porto</city><country>PT</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>COELHO</last-name><first-name>Lu&#xed;s Ungaro Pinto</first-name><address><city>Porto</city><country>PT</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>FERREIRA</last-name><first-name>Marta Maria Ramalho</first-name><address><city>Porto</city><country>PT</country></address></addressbook></inventor><inventor sequence="03" designation="us-only"><addressbook><last-name>MATOS</last-name><first-name>Ana Clara Ferreira</first-name><address><city>Porto</city><country>PT</country></address></addressbook></inventor><inventor sequence="04" designation="us-only"><addressbook><last-name>PE&#xd1;AS</last-name><first-name>Pablo</first-name><address><city>Porto</city><country>PT</country></address></addressbook></inventor><inventor sequence="05" designation="us-only"><addressbook><last-name>BENTO</last-name><first-name>Virg&#xed;lio Ant&#xf3;nio Ferro</first-name><address><city>Porto</city><country>PT</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A method comprising: digitally processing orientation measurements provided by each of first and second inertial measurement units, the first and second units being arranged on first and second body members of a person, respectively, according to a predetermined unit arrangement, and the first and second body members being connected by a joint; the measurements are digitally processed such that the computing device at least: computes a length vector of a segment of the first body member based on a first orientation measurement of the first unit; defines a joint axis plane of the joint based on a second orientation measurement of the second unit; and computes a heading rotation value for making the first orientation measurement to be contained within the joint axis plane defined; and the method further comprising digitally modifying the first orientation measurement or the second orientation measurement by applying a rotation at least based on the heading rotation value computed. Also, a motion tracking system and a computer program product.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="92.12mm" wi="68.16mm" file="US20230003528A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="210.14mm" wi="143.76mm" file="US20230003528A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="133.86mm" wi="93.98mm" file="US20230003528A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="199.22mm" wi="148.08mm" file="US20230003528A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="219.03mm" wi="131.74mm" file="US20230003528A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="219.03mm" wi="131.74mm" file="US20230003528A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="172.47mm" wi="58.00mm" file="US20230003528A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="lead"?><heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading><p id="p-0002" num="0001">This application is a continuation of International Application No. PCT/EP2021/056233, filed internationally on Mar. 11, 2021, which claims priority to European Application No. 20398002.4, filed on Mar. 11, 2020, all of which are hereby incorporated by reference in their entireties.</p><?cross-reference-to-related-applications description="Cross Reference To Related Applications" end="tail"?><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0002" level="1">TECHNICAL FIELD</heading><p id="p-0003" num="0002">The present invention relates to the field of systems for tracking motion of a person. More particularly, the invention relates to correction of heading errors present in measurements of inertial measurement units worn by a tracked person.</p><heading id="h-0003" level="1">STATE OF THE ART</heading><p id="p-0004" num="0003">Motion tracking or motion capture is becoming a key technique in different applications in which the movement of a target such as a person is an important part in one or more processes of the applications.</p><p id="p-0005" num="0004">An application growing in popularity is the physical rehabilitation of people while being monitored with a motion tracking system. The motion tracking system enables the physical rehabilitation of a person without the presence of a therapist. The person may improve the physical condition thereof by performing a number of physical exercises even if not directly supervised by the therapist but by the motion tracking system, hence the person may even perform the exercises at home, for example. The motion tracking system may include IMUs, i.e. inertial measurement units, for motion tracking of a target; the IMUs are adapted to be arranged on the target and include one or more sensing devices such as gyroscopes, accelerometers, magnetometers, etc. A computing device connected to the IMUs processes the measurements of one or several of these sensing devices for determining the movement sequence of the target, at least the movement sequence of the tracked parts of the target (i.e. those with an IMU arranged thereon).</p><p id="p-0006" num="0005">In order to determine the movement sequence, the computing device provides heading estimates for the different IMUs (based on the measurements thereof) for establishing the orientation of the tracked body members. These heading estimates, however, are prone to heading errors due to cumulative errors in the sensing devices or magnetic disturbances that both influence the orientation measurements provided by the IMUs. Likewise, the arrangement of IMUs on the body members results, in some cases, in soft tissue artifacts and/or IMU misplacement. Soft tissue artifacts are relative displacements or changes in orientation of the IMUs due to the behavior of the soft tissues of the body member where the IMU is arranged on, thereby causing changes in the local axis of the IMU that describes the axis of the body member or a joint connected to the body member. For IMU misplacement it is meant the incorrect placement of the IMU on the body member with respect to a placement of the IMU as expected by the computing device for proper tracking of the movement and/or orientation of the concerned body member, thus if the computing expects an IMU to be arranged e.g. on the center of a body member with respect to a horizontal axis but the person arranges it displaced from the center of said body member, the orientation measurements provided by the IMU will result in orientation estimates that are not accurate. Both soft tissue artifacts and IMU misplacement cause the provision of an incorrect movement sequence unless the heading errors are corrected and the deviations compensated for.</p><p id="p-0007" num="0006">There is an interest in having motion tracking systems capable of determining the existence of any such deviation in a heading estimate or heading error for correction of the same arising from orientation measurements of an IMU that may be affected by heading errors. By reducing the deviation and/or heading error, the movement sequence provided may be more accurate, thereby reducing the probability of incorrect assessment of the physical rehabilitation exercises performed by the person, something that, in turn, reduces the risk of injury. Further, there is also an interest in correcting the deviation and/or heading error without carrying out a calibration procedure, whenever possible, so that the motion tracking system is easier to use and operation thereof is not or is less cumbersome.</p><heading id="h-0004" level="1">DESCRIPTION OF THE INVENTION</heading><p id="p-0008" num="0007">A first aspect of the invention relates to a method comprising:</p><p id="p-0009" num="0008">digitally processing, by a computing device of a motion tracking system, orientation measurements provided by each of first and second inertial measurement units of the motion tracking system, each of the first and second units at least comprises an accelerometer and a gyroscope, the first and second units being arranged on first and second body members of a person, respectively, according to a predetermined unit arrangement, and the first and second body members being connected by a joint;</p><p id="p-0010" num="0009">the measurements are digitally processed such that the computing device at least:<ul id="ul0001" list-style="none">    <li id="ul0001-0001" num="0000">    <ul id="ul0002" list-style="none">        <li id="ul0002-0001" num="0010">computes a length vector of a segment of the first body member based on a first orientation measurement of the first unit;</li>        <li id="ul0002-0002" num="0011">defines a joint axis plane of the joint based on a second orientation measurement of the second unit; and</li>        <li id="ul0002-0003" num="0012">computes a heading rotation value for making the first orientation measurement to be contained within the joint axis plane defined; and</li>    </ul>    </li></ul></p><p id="p-0011" num="0013">the method further comprises digitally modifying, by the computing device, the first orientation measurement or the second orientation measurement by applying a rotation based on the heading rotation value computed.</p><p id="p-0012" num="0014">With the present method, the computing device is capable of correcting errors in heading estimates when the two IMUs are arranged on body members in which the joint connecting them has one or two DOF, i.e. degrees of freedom.</p><p id="p-0013" num="0015">When the joint has or substantially has one DOF (the latter meaning that there can be two or three DOF, yet the movement components resulting in the second and/or third DOF are usually minimal and, therefore, can be disregarded considering the reduced amount of error that they may imply), the joint can be regarded as a hinge joint; for example, the knee is a 1-DOF joint since components of knee abduction and rotation are minimal. A 2-DOF joint is, for example, the elbow, which allows extension/flexion and supination/pronation movements.</p><p id="p-0014" num="0016">The existence of soft tissue artifacts or IMU misplacement can be regarded as an additional DOF of a 1-DOF joint, thereby turning it into a 2-DOF joint, or as part of an existing DOF of a 2-DOF joint. Accordingly, both types of joints are considered and, thus, modeled as 2-DOF joints, regardless of the body joint itself allowing or substantially allowing movement between the first and second body members on one or two DOF and regardless of any DOF being caused entirely or affected by phenomena relating to the placement of the units on the body and not to the actual joint itself.</p><p id="p-0015" num="0017">As the body members are connected together by means of the joint, one or more biomechanical constraints may exist in accordance with the degrees of freedom that the joint features. In this sense, the computing device determines the heading error and corrects it by digitally modifying the orientation measurement of one of the first and second IMUs based on the biomechanical constraint that vectors describing the direction in which the segments of the concerned body members extend are to be contained within the joint axis plane. This means that the segments of the first and second body members should be contained within a same plane that is the plane of the axis of the joint. It is to be noted that due to the orientation of one or both body members and, thus, the orientation of the segments thereof with respect to the degrees of freedom of the joint that are considered to have minimal movement components, it is foreseen that both segments are not contained in the joint axis plane; however, these orientations result in an error that is usually several times smaller than the heading error that may affect the heading estimates.</p><p id="p-0016" num="0018">The computing device processes the orientation measurements provided by and received from the first and second units in order to at least compute the length direction of the first body member (with a length vector of the segment thereof) and a heading estimate for the second body member from the orientation measurements, a heading error based on the heading estimate, and the heading rotation value(s) for correcting the heading error. The orientation measurements of the units are indicative of the orientation of the body members on which the sensors are arranged, the heading estimates are indicative of the heading of the body members. As it is known in the art, heading estimates correspond to angles around a vertical axis (i.e. global Z), which correspond to orientations projected onto a horizontal plane like e.g. a ground plane, so an orientation component in the vertical axis is disregarded.</p><p id="p-0017" num="0019">The joint axis plane can be defined by means of the orientation measurement provided by the second unit. A local axis of the second unit can be used for the definition of the joint axis plane because the orientation of the unit can be related to the axis of the joint. The local axis defines the plane in the form of the normal of the plane, which mathematically establishes the plane. As aforementioned, the orientation measurement of the first unit should be contained in the joint axis plane owing to the biomechanical constraint, and the heading deviations of the orientation measurement that make the orientation measurement not to be coplanar with the plane are the heading error that is to be corrected. The heading error is mathematically calculable and, according to the value of the heading error, the computing device computes a heading rotation value that adjusts the heading of the orientation measurement; this means that the vertical component is not altered, something that is important for establishing the movement sequence of the person precisely.</p><p id="p-0018" num="0020">Based on the heading rotation value, the computing device is capable of reducing the heading error by digitally rotating the orientation measurement(s) of one of the units. In this sense, the rotation can be applied to measurements of any one of the first and second units, that is to say, it is not necessary to correct the heading error on the orientation measurement(s) of the first unit and which have been used to determine the heading error and the heading rotation value in the first place. The digital modification of the orientation measurement ensures that the first and second orientation measurements are in a same reference frame, therefore enabling angle measurements of the joint that are used in the provision of the movement sequence. In this sense, the reference frame of the measurements oftentimes will not be aligned with Earth's frame, but that is not necessary for performing angle measurements of the joint.</p><p id="p-0019" num="0021">The arrangement of the IMUs in the first and second body members can be done according to a predetermined unit arrangement, which sets on which body members the IMUs are to be arranged for properly determining the movement sequence of the person or at least the tracked body members thereof. A predetermined unit arrangement preferably also sets where on the body members the IMUs are to be arranged on, and/or it preferably also sets with which orientation the IMUs are to be arranged on. One or more predetermined unit arrangements (a plurality of such arrangements is since each arrangement is suitable for tracking one or more movements to be performed by the person) may be stored in at least one memory of the computing device together, and may be presented with presenting means (e.g. a screen, audio output means such as loudspeakers, a vibrating device, etc.) to the person so that proper arrangement or rearrangement (when the physical exercise to be performed changes) of the IMUs can be effected, in terms of body members and, preferably, position and/or orientation. In some embodiments, the presenting means are part of the motion tracking system whereas, in some other embodiments, the presenting means are not part of the motion tracking system, yet the computing device is connected with the presenting means so as to transmit data thereto.</p><p id="p-0020" num="0022">In the present disclosure, as it is readily apparent from the description, for the purposes of containment or coplanarity of the orientation measurements described, the concerned orientation measurement can be regarded as a free vector (which is translatable in space) or, alternatively, the concerned orientation measurement is a vector that is contained within the joint axis plane irrespective of whether it is contained in said plane or a plane parallel to the joint axis plane.</p><p id="p-0021" num="0023">In the context of the present disclosure, the terms &#x201c;unit&#x201d; and &#x201c;IMU&#x201d; are used interchangeably to refer to inertial measurement units of the motion tracking system. Further, the term &#x201c;segment&#x201d; refers to a segment whose endpoints are the ends of the concerned body member and, thus, is indicative of the direction along which the concerned body member extends.</p><p id="p-0022" num="0024">In some embodiments, the step of digitally processing comprises:<ul id="ul0003" list-style="none">    <li id="ul0003-0001" num="0000">    <ul id="ul0004" list-style="none">        <li id="ul0004-0001" num="0025">providing a first vector (a, b, c) based on the second orientation measurement;</li>        <li id="ul0004-0002" num="0026">providing value z<sub>orig </sub>based on the first orientation measurement; and</li>        <li id="ul0004-0003" num="0027">solving the following system of three equations:</li>    </ul>    </li></ul></p><p id="p-0023" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>ax</i>+by +<i>cz=</i>0,<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0024" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>y</i>=&#x221a;{square root over (1&#x2212;<i>z</i><sup>2</sup><i>&#x2212;x</i><sup>2</sup>)}, and<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0025" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>z=z</i><sub>orig </sub>and<?in-line-formulae description="In-line Formulae" end="tail"?><ul id="ul0005" list-style="none">    <li id="ul0005-0001" num="0000">    <ul id="ul0006" list-style="none">        <li id="ul0006-0001" num="0028">the heading rotation value is based on a solution to the system of three equations.</li>    </ul>    </li></ul></p><p id="p-0026" num="0029">As the segment of the second body member is contained in the joint axis plane, the first vector corresponds to a transverse direction of the segment as said vector can serve as the normal vector for the definition of the plane. The definition of the plane relies on the plane equation ax+by +cz=0.</p><p id="p-0027" num="0030">By way of example, the digital processing of the computing device is such that it defines said joint axis plane, and provides a second vector (x<sub>orig</sub>, y<sub>orig</sub>, z<sub>orig</sub>) based on the first orientation measurement (thereby providing z<sub>orig</sub>) and a third vector (x, y, z) for computing a heading rotation value. By solving the system of equations (which is defined based on the plane, the magnitude of unit vectors, and the fact that only heading is to be modified) for the third vector, for example the following resulting vector (x<sub>1</sub>, y<sub>1</sub>, z<sub>orig</sub>) is obtained, with the values x<sub>1 </sub>and y<sub>1 </sub>being obtained from a solution of the system, such as:</p><p id="p-0028" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mrow>  <mrow>   <msub>    <mi>x</mi>    <mn>1</mn>   </msub>   <mo>=</mo>   <mfrac>    <mrow>     <mrow>      <mrow>       <mo>-</mo>       <mi>a</mi>      </mrow>      <mo>&#x2062;</mo>      <mi>c</mi>      <mo>&#x2062;</mo>      <msub>       <mi>z</mi>       <mi>orig</mi>      </msub>     </mrow>     <mo>+</mo>     <mrow>      <mi>b</mi>      <mo>&#x2062;</mo>      <msqrt>       <mrow>        <mrow>         <mrow>          <mo>-</mo>          <msup>           <mi>a</mi>           <mn>2</mn>          </msup>         </mrow>         <mo>&#x2062;</mo>         <msubsup>          <mi>z</mi>          <mi>orig</mi>          <mn>2</mn>         </msubsup>        </mrow>        <mo>+</mo>        <msup>         <mi>a</mi>         <mn>2</mn>        </msup>        <mo>-</mo>        <mrow>         <msup>          <mi>b</mi>          <mn>2</mn>         </msup>         <mo>&#x2062;</mo>         <msubsup>          <mi>z</mi>          <mi>orig</mi>          <mn>2</mn>         </msubsup>        </mrow>        <mo>+</mo>        <msup>         <mi>b</mi>         <mn>2</mn>        </msup>        <mo>-</mo>        <mrow>         <msup>          <mi>c</mi>          <mn>2</mn>         </msup>         <mo>&#x2062;</mo>         <msubsup>          <mi>z</mi>          <mi>orig</mi>          <mn>2</mn>         </msubsup>        </mrow>       </mrow>      </msqrt>     </mrow>    </mrow>    <mrow>     <msup>      <mi>a</mi>      <mn>2</mn>     </msup>     <mo>+</mo>     <msup>      <mi>b</mi>      <mn>2</mn>     </msup>    </mrow>   </mfrac>  </mrow>  <mo>,</mo>  <mrow>   <mrow>    <mi fontstyle="normal">and</mi>    <mo>&#x2062;</mo>    <mtext>    </mtext>    <msub>     <mi>y</mi>     <mn>1</mn>    </msub>   </mrow>   <mo>=</mo>   <mrow>    <mo>-</mo>    <mrow>     <mfrac>      <mrow>       <mrow>        <mi>a</mi>        <mo>&#x2062;</mo>        <msub>         <mi>x</mi>         <mn>1</mn>        </msub>       </mrow>       <mo>+</mo>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <msub>         <mi>z</mi>         <mi>orig</mi>        </msub>       </mrow>      </mrow>      <mi>b</mi>     </mfrac>     <mo>.</mo>    </mrow>   </mrow>  </mrow> </mrow></math></maths></p><p id="p-0029" num="0031">Also, following the same example or another example, the computing device provides a fourth vector (x, y, z) for computing a heading rotation value. Again, by solving the system of equations but for the fourth vector, for example the following resulting vector (x<sub>2</sub>, y<sub>2</sub>, z<sub>orig</sub>) is obtained, with the values x<sub>2 </sub>and y<sub>2 </sub>being obtained from a solution of the system, such as:</p><p id="p-0030" num="0000"><maths id="MATH-US-00002" num="00002"><math overflow="scroll"> <mrow>  <mrow>   <msub>    <mi>x</mi>    <mn>2</mn>   </msub>   <mo>=</mo>   <mrow>    <mo>-</mo>    <mfrac>     <mrow>      <mrow>       <mi>a</mi>       <mo>&#x2062;</mo>       <mi>c</mi>       <mo>&#x2062;</mo>       <msub>        <mi>z</mi>        <mi>orig</mi>       </msub>      </mrow>      <mo>+</mo>      <mrow>       <mi>b</mi>       <mo>&#x2062;</mo>       <msqrt>        <mrow>         <mrow>          <mrow>           <mo>-</mo>           <msup>            <mi>a</mi>            <mn>2</mn>           </msup>          </mrow>          <mo>&#x2062;</mo>          <msubsup>           <mi>z</mi>           <mi>orig</mi>           <mn>2</mn>          </msubsup>         </mrow>         <mo>+</mo>         <msup>          <mi>a</mi>          <mn>2</mn>         </msup>         <mo>-</mo>         <mrow>          <msup>           <mi>b</mi>           <mn>2</mn>          </msup>          <mo>&#x2062;</mo>          <msubsup>           <mi>z</mi>           <mi>orig</mi>           <mn>2</mn>          </msubsup>         </mrow>         <mo>+</mo>         <msup>          <mi>b</mi>          <mn>2</mn>         </msup>         <mo>-</mo>         <mrow>          <msup>           <mi>c</mi>           <mn>2</mn>          </msup>          <mo>&#x2062;</mo>          <msubsup>           <mi>z</mi>           <mi>orig</mi>           <mn>2</mn>          </msubsup>         </mrow>        </mrow>       </msqrt>      </mrow>     </mrow>     <mrow>      <msup>       <mi>a</mi>       <mn>2</mn>      </msup>      <mo>+</mo>      <msup>       <mi>b</mi>       <mn>2</mn>      </msup>     </mrow>    </mfrac>   </mrow>  </mrow>  <mo>,</mo>  <mrow>   <mrow>    <mi fontstyle="normal">and</mi>    <mo>&#x2062;</mo>    <mtext>    </mtext>    <msub>     <mi>y</mi>     <mn>2</mn>    </msub>   </mrow>   <mo>=</mo>   <mrow>    <mo>-</mo>    <mrow>     <mfrac>      <mrow>       <mrow>        <mi>a</mi>        <mo>&#x2062;</mo>        <msub>         <mi>x</mi>         <mn>2</mn>        </msub>       </mrow>       <mo>+</mo>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <msub>         <mi>z</mi>         <mi>orig</mi>        </msub>       </mrow>      </mrow>      <mi>b</mi>     </mfrac>     <mo>.</mo>    </mrow>   </mrow>  </mrow> </mrow></math></maths></p><p id="p-0031" num="0032">The third vector could take the solution according to any one of x<sub>1 </sub>and x<sub>2</sub>, and the respective value of y.</p><p id="p-0032" num="0033">In some embodiments, the heading rotation value comprises a difference between the solution to the system of three equations and the orientation measurement to which the rotation is to be applied in the step of digitally modifying.</p><p id="p-0033" num="0034">The heading rotation value is the rotation that compensates the heading error of the orientation measurement that is digitally modified. Accordingly, the heading rotation value may be the angle that cancels out either a difference between the first orientation measurement and the solution (e.g. one of the third and fourth vectors of the aforementioned example), or a difference between the second orientation measurements and the solution (e.g. one of the third and fourth vectors).</p><p id="p-0034" num="0035">In some other embodiments, the heading rotation value comprises a combination of the solution to the system of three equations with one or more heading rotation values computed for previous orientation measurements provided by the first and second units.</p><p id="p-0035" num="0036">The rotation applied to the orientation measurement in the digital modification step takes into account previous rotation values so that the correction of the heading error does not solely rely on the heading error computed for the current measurements provided by the first and second units. Hence, the heading rotation value results from an integration of:<ul id="ul0007" list-style="none">    <li id="ul0007-0001" num="0000">    <ul id="ul0008" list-style="none">        <li id="ul0008-0001" num="0037">a) the angle that cancels out either a difference between the first orientation measurement and the solution to the system (e.g. one of the third and fourth vectors of the aforementioned example) or a difference between the second orientation measurements and the solution (e.g. one of the third and fourth vectors), and</li>        <li id="ul0008-0002" num="0038">b) one or more previous heading rotation values;</li>    </ul>    </li></ul></p><p id="p-0036" num="0039">with the integration of a) and b) above, the rotation applied takes into account preceding heading error corrections, in this way sporadic errors in the orientations measured by the units do not affect the modified orientation in a large degree.</p><p id="p-0037" num="0040">In some embodiments, the step of digitally processing further comprises selecting the solution to the system of three equations that at least one of: fulfills one or more predetermined biomechanical constraints, and results in an instantaneous heading error that: is determined not to be excessive by the computing device, and/or is less than an instantaneous heading error for the other solution to the system of three equations. Further, in these embodiments, the heading rotation value is based on the selected solution to the system of three equations.</p><p id="p-0038" num="0041">When the computing device computes more than one solution to the system of three equations, it selects the solution that results in a rotated orientation measurement deemed more realistic for the first and second body members and the common joint thereof. Accordingly, either one of the solutions may be positively selected, meaning that the solution meets certain positive criterion or criteria (i.e. fulfillment of one or more predetermined biomechanical constraints and/or not excessive instantaneous heading error and/or smaller instantaneous heading error), or one of the solutions may be discarded because it meets certain negative criterion or criteria (i.e. non-fulfillment of one or more predetermined biomechanical constraints and/or excessive instantaneous heading error and/or greater instantaneous heading error). The computing device is to select the solution that does not result in a rotation of the (first or second) orientation measurement that yields a joint movement that is considered as being impossible and/or results in a rotation that could only be possible if the dynamics of the heading error are too fast, however said dynamics are expected to be slow and accumulate over time.</p><p id="p-0039" num="0042">In some of these and in some other embodiments, if the system of equations does not yield any solution due to the provided vectors resulting in a system with no real solutions or, alternatively, if disambiguation of the two solutions by the positive or negative criteria is not possible, the computing device either applies a rotation according to a previously computed heading rotation value or a heading rotation value resulting from an integration (which is either a combination of items a) and b) as explained above, or a combination of a plurality of previous heading rotation values according to item b) above), or no rotation is applied to the first or second orientation measurement. In these cases, the rotation(s) may be applied to the orientation measurements provided by the units in previous and/or posterior moments during the motion tracking procedure.</p><p id="p-0040" num="0043">In some embodiments, the method further comprises digitally providing, by the computing device, a movement sequence of the person based on the orientation measurements provided by the first and second units wherein at least some orientation measurements of one the first and second units have been digitally modified.</p><p id="p-0041" num="0044">Owing to the digital modification for correcting the heading error, meaningful angle measurements of the joint can be made possible even when non-negligible heading errors exist, e.g. heading errors greater than 10&#xb0;. Additionally, the movement sequence provided is more accurate than a movement sequence provided with no digital modification of the at least some orientation measurements.</p><p id="p-0042" num="0045">In some embodiments, the method further comprises repeating at least the digital steps one or more times with most recent orientation measurements provided by the first and second units for correction of heading error in the measurements provided by the units.</p><p id="p-0043" num="0046">The repetition of the digital steps with the different orientation measurements provided by the units enables both the determination and correction of the heading errors during the motion tracking procedure, for instance while the person is physically exercising for rehabilitation purposes. Preferably, the steps are repeated during the entire motion tracking of the person and each time the first and second units keep provide new orientation measurements.</p><p id="p-0044" num="0047">In some embodiments, the rotation applied in the step of digitally modifying is at least further based on one or more heading rotation values previously computed for digital modification of previous orientation measurements.</p><p id="p-0045" num="0048">In some embodiments, the method further comprises, prior to the step of digitally processing, arranging the first and second units on the first and second body members of the person, respectively.</p><p id="p-0046" num="0049">In some embodiments, the method further comprises calibrating the first and second units after arranging them on the first and second body members.</p><p id="p-0047" num="0050">The calibration, which can be made in accordance with any calibration procedure known in the art for inertial measurement units, assists in reducing the heading error due to errors in the reference of the sensing devices of the units and determining the placement and/or orientation of the units on the body members for the computing device to establish length directions of the body members or, in other words, establish the segments of the body members. The calibration procedure, which may be triggered by the computing device before starting the motion tracking procedure, involves movement of the first and second body members.</p><p id="p-0048" num="0051">In some embodiments, the method further comprises calibrating the first and second units prior to arranging them on the first and second body members.</p><p id="p-0049" num="0052">The calibration, which can be made in accordance with any calibration procedure known in the art for inertial measurement units, assists in reducing the heading error due to errors in the reference of the sensing devices of the units. Also, as the units provided accurate and calibrated orientation measurements right after the calibration, the computing device is capable of determining the orientations of the units upon arrangement of the same on the person.</p><p id="p-0050" num="0053">In some embodiments, at least the second unit is arranged on the second body member such that one of three axes of the second unit is aligned or substantially aligned with a segment of the second body member. Preferably, the first unit is on the first body member such that one of three axes of the first unit is aligned or substantially aligned with a segment of the first body member.</p><p id="p-0051" num="0054">Aligned or substantially aligned arrangement can be attained with attaching devices or means for units that assist in orienting the units or force certain orientation or orientations of the units. To this end, the attaching devices or means may comprise straps, Velcro, etc. with visual indications regarding how the unit is to be attached thereto, and/or include a casing on the strap, Velcro, etc. that is adapted to receive the unit with a predetermined orientation. Said casing, which may be formed of a single member or a plurality of members, comprises a geometry that cooperates with a geometry of the unit for forcing a predetermined orientation of the unit. Likewise, the attaching devices or means may be part of the units such that the unit with sensing devices is mechanically coupled with the strap, Velcro, etc. and, thus, is not releasable therefrom.</p><p id="p-0052" num="0055">Also, it is envisaged that the person may properly arrange the units on the body members without requiring any guidance or assistance from casings or visual indications in the attaching devices or means. In this sense, presenting means that provide instructions to the user for the motion tracking procedure preferably provide instructions to the user for arranging the units.</p><p id="p-0053" num="0056">In addition to the above, further means for assisting or enforcing the proper arrangement of the units known in the art are also possible.</p><p id="p-0054" num="0057">In some embodiments, the first and second body members respectively are an upper arm and a forearm or vice versa, or the first and second body members respectively are a thigh and a shank or vice versa.</p><p id="p-0055" num="0058">In some embodiments, further comprising providing, by each of the first and second units, the orientation measurements to be digitally processed.</p><p id="p-0056" num="0059">In some embodiments, each of the first and second units further comprises a magnetometer.</p><p id="p-0057" num="0060">A second aspect of the invention relates to a motion tracking system comprising:</p><p id="p-0058" num="0061">a computing device comprising at least one processor and at least one memory; and</p><p id="p-0059" num="0062">first and second inertial measurement units adapted to be arranged on first and second body members of a person and each at least comprising an accelerometer and a gyroscope;</p><p id="p-0060" num="0063">the at least one processor is configured, together with the at least one memory, to carry out a method according to the first aspect of the invention.</p><p id="p-0061" num="0064">With the motion tracking system, motion of a person or of the body members with units arranged thereon can be tracked such that heading errors in the orientation measurements can be corrected.</p><p id="p-0062" num="0065">The motion tracking system can provide a movement sequence of the person or the body members, and assess the movements and physical exercises performed by the person without requiring calibration of the units (which, typically, is a cumbersome process that may even require some skill from the user to be correctly performed) and/or mapping of magnetic disturbances before and/or during the motion tracking procedure.</p><p id="p-0063" num="0066">Accordingly, the motion tracking system is capable of correcting heading errors during the motion tracking procedure itself, thereby improving both the quality of the resulting movement sequence provided and the user experience, reducing the setup time of the motion tracking system and, additionally, lowering the skill necessary from the person to use the motion tracking system. Concerning the latter, it is to be noted that oftentimes the user is a person with little knowledge of technology and complex and not so complex manipulation of the motion tracking system becomes a hurdle for this type of users.</p><p id="p-0064" num="0067">In some embodiments, each of the first and second units further comprises a magnetometer.</p><p id="p-0065" num="0068">In some embodiments, the motion tracking system further comprises attaching devices or means for the first and second units, or each of the first and second units comprises attaching devices or means. In some of these embodiments, the attaching devices or means comprise a casing adapted to receive a respective unit with a predetermined orientation. In some other embodiments, the attaching devices or means and the respective unit are mechanically coupled.</p><p id="p-0066" num="0069">A third aspect of the invention relates to a computer program product that has instructions which, when executed by a computing device of a motion tracking system comprising first and second inertial measurement units adapted to be arranged on first and second body members of a person and each at least comprising an accelerometer and a gyroscope, cause the computing device to perform a method according to the first aspect of the invention.</p><p id="p-0067" num="0070">Upon running the computer program product on one or more processors of the computing device, the motion tracking system both determines whether heading errors exist in the measurements of the IMUs and modifies them based on the determined heading errors for correction thereof.</p><p id="p-0068" num="0071">In some embodiments, the computer program product is embodied on a non-transitory computer readable medium.</p><p id="p-0069" num="0072">A fourth aspect of the invention relates to a data stream which is representative of a computer program product according to the third aspect of the invention.</p><p id="p-0070" num="0073">Same advantages as those described for the first aspect of the invention also apply to the second, third and fourth aspects of the invention.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading><p id="p-0071" num="0074">To complete the description and in order to provide for a better understanding of the invention, a set of drawings is provided. Said drawings form an integral part of the description and illustrate embodiments of the invention, which should not be interpreted as restricting the scope of the invention, but just as examples of how the invention can be carried out. The drawings comprise the following figures:</p><p id="p-0072" num="0075"><figref idref="DRAWINGS">FIGS. <b>1</b>A to <b>1</b>C</figref> show a person with IMUs of a motion tracking system arranged on a leg thereof for explanation of possible deviations in heading estimates or heading errors that could be compensated for with methods and system in accordance with the present disclosure.</p><p id="p-0073" num="0076"><figref idref="DRAWINGS">FIG. <b>2</b></figref> diagrammatically shows a motion tracking system in accordance with an embodiment.</p><p id="p-0074" num="0077"><figref idref="DRAWINGS">FIGS. <b>3</b>A, <b>4</b>A and <b>4</b>C</figref> show a person with IMUs of a motion tracking system, one of which includes a heading error, whereas <figref idref="DRAWINGS">FIGS. <b>3</b>B, <b>4</b>B and <b>4</b>D</figref> illustratively represent the tracked segments of <figref idref="DRAWINGS">FIGS. <b>3</b>A, <b>4</b>B and <b>4</b>D</figref>, respectively, and possible heading error corrections.</p><p id="p-0075" num="0078"><figref idref="DRAWINGS">FIGS. <b>5</b> and <b>6</b></figref> diagrammatically show methods in accordance with embodiments.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0006" level="1">DESCRIPTION OF WAYS OF CARRYING OUT THE INVENTION</heading><p id="p-0076" num="0079"><figref idref="DRAWINGS">FIGS. <b>1</b>A to <b>1</b>C</figref> show a person <b>1</b> with first and second IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>of a motion tracking system (e.g. the system <b>10</b> of <figref idref="DRAWINGS">FIG. <b>2</b></figref> below) arranged on a leg according to a predetermined unit arrangement.</p><p id="p-0077" num="0080">In this embodiment, the first IMU <b>20</b><i>a </i>is arranged on the thigh <b>6</b><i>a</i>, and the second IMU <b>20</b><i>b </i>is arranged on the shank <b>6</b><i>b </i>of the same leg. The thigh <b>6</b><i>a </i>and the shank <b>6</b><i>b </i>are connected by the knee <b>5</b><i>a</i>; the thigh <b>6</b><i>a </i>and the shank <b>6</b><i>b </i>each moves one relative to the other only around the axis of the knee <b>5</b><i>a </i>as a 1-DOF joint. In some other embodiments, the first IMU <b>20</b><i>a </i>is arranged on the shank <b>6</b><i>b </i>and the second IMU <b>20</b><i>b </i>is arranged on the thigh <b>6</b><i>a</i>. The first and second IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>are arranged on these body members <b>6</b><i>a</i>, <b>6</b><i>b </i>owing to first and second straps <b>30</b><i>a</i>, <b>30</b><i>b </i>even though other attaching means or devices for arranging the IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>on the person <b>1</b> are also possible.</p><p id="p-0078" num="0081">In <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>, the person <b>1</b> is standing still and has both IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>arranged thereon such that they are aligned with the segments of the thigh <b>6</b><i>a </i>and the shank <b>6</b><i>b</i>; it is noted that the segments define a length of a respective body member <b>6</b><i>a</i>, <b>6</b><i>b</i>. In this situation, errors in the heading estimates that are computed by the computing device can exist due to cumulated errors in the sensing devices of the IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>that influence the measurements provided, and/or due to magnetic disturbances. However, there are no deviations in the heading estimates due to soft tissue artifacts or due to misplacement of the units <b>20</b><i>a</i>, <b>20</b><i>b. </i></p><p id="p-0079" num="0082">From the standing still position, the person <b>1</b> performs a hip external rotation as illustrated in <figref idref="DRAWINGS">FIG. <b>1</b>B</figref>. The second IMU <b>20</b><i>b </i>rotates in accordance with the rotation of the hip and is aligned with the direction in which the foot of the person <b>1</b> is pointing. The first IMU <b>20</b><i>a </i>also rotates in accordance with the rotation of the hip, but due to the soft tissues of the thigh <b>6</b><i>a</i>, the rotation undergone by the first IMU <b>20</b><i>a </i>is dampened, thereby causing the IMU <b>20</b><i>a </i>not to rotate as much as the rotation of the hip and the second IMU <b>20</b><i>b</i>. It can be appreciated that the segments of the thigh <b>6</b><i>a </i>and the shank <b>6</b><i>b </i>remain aligned owing to the hinge joint that is the knee <b>5</b><i>a</i>, but the IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>do not remain aligned in contrast to the situation of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>.</p><p id="p-0080" num="0083">Turning to <figref idref="DRAWINGS">FIG. <b>1</b>C</figref>, the person <b>1</b> performs a hip flexion movement from the standing still position of <figref idref="DRAWINGS">FIG. <b>1</b>A</figref>. Again, due to the soft tissues of the thigh <b>6</b><i>a</i>, the first and second IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>are not aligned yet the segments of these body members <b>6</b><i>a</i>, <b>6</b><i>b </i>are. In this case, the first IMU <b>20</b><i>a </i>rotates inwardly as a result of the soft tissue artifacts whereas the second IMU <b>20</b><i>b </i>does not. Typically, soft tissue problems are more prevalent around the segment than in other directions.</p><p id="p-0081" num="0084">As it can be appreciated from the above examples, the heading estimates of the joint axis (knee axis in these examples) given by each of the first and second units <b>20</b><i>a</i>, <b>20</b><i>b </i>should be the same when no heading errors exist (the measurements of the sensing devices are error-free and tolerances of the sensing devices are disregarded), but in <figref idref="DRAWINGS">FIGS. <b>1</b>B and <b>1</b>C</figref> the heading estimates are not the same (even without said heading errors) because there are deviations caused by the soft tissue artifacts. In fact, full orientation estimates (i.e. orientation estimates in the three dimensions) of the joint axis should be the same, so correction in the vertical direction would also have to be effected should the vertical reference not be reliable, but it has been found out that accelerometers of IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>do provide a vertical reference that is both accurate and reliable. Therefore, it is considered that only the heading errors need be corrected. Correction of heading errors is complex because soft tissues, IMU misplacement and/or supination/pronation movements mask heading errors in the measurements of the sensing devices.</p><p id="p-0082" num="0085">Methods and systems according to the present disclosure make possible to correct heading errors, and in the following cases too, which are considered and, therefore, modelled as an additional degree of freedom in the movement of one of the body members:<ul id="ul0009" list-style="none">    <li id="ul0009-0001" num="0000">    <ul id="ul0010" list-style="none">        <li id="ul0010-0001" num="0086">there are soft tissue artifacts (as in the above examples);</li>        <li id="ul0010-0002" num="0087">there is supination/pronation of the forearm; and/or</li>        <li id="ul0010-0003" num="0088">one of the units is misplaced.</li>    </ul>    </li></ul></p><p id="p-0083" num="0089"><figref idref="DRAWINGS">FIG. <b>2</b></figref> diagrammatically shows a motion tracking system <b>10</b> in accordance with an embodiment. The motion tracking system <b>10</b> includes first and second inertial measurement units <b>20</b><i>a</i>, <b>20</b><i>b</i>, and a computing device <b>15</b>.</p><p id="p-0084" num="0090">Each IMU <b>20</b><i>a</i>, <b>20</b><i>b </i>at least includes two sensing devices: an accelerometer <b>21</b>, and a gyroscope <b>22</b>. As shown with dashed lines, in some embodiments each of the IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>further includes a magnetometer <b>23</b>.</p><p id="p-0085" num="0091">The first and second IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>further include at least one processor <b>26</b>, at least one memory <b>27</b>, and a first communications module <b>28</b> for transmitting and receiving data that enables the IMUs to transmit (through a wired or wireless communications technology and protocol known by a skilled person, for instance but without limitation, Bluetooth communications, cellular network communications such as GSM, UMTS or LTE, wireless LAN communications, etc.) measurements of the sensing device(s) <b>21</b>-<b>23</b> to the computing device <b>15</b>. The same first communications modules <b>28</b> enable the units <b>20</b><i>a</i>, <b>20</b><i>b </i>to receive data from the computing device <b>15</b>.</p><p id="p-0086" num="0092">In some preferred embodiments, the at least one processor <b>26</b> of the IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>runs a sensor fusion algorithm for processing the measurements of the sensing devices <b>21</b>-<b>23</b> within the respective IMU. The sensor fusion algorithm is intended to enhance the raw measurements of the sensing devices by correcting errors thereof due to drifts of the sensing devices and, thus, outputs processed measurements that are to be transmitted to the computing device <b>15</b>. By way of example, biases of the gyroscopes <b>22</b> accumulate over time and worsen the accuracy of the measurements of the IMUs <b>20</b><i>a</i>, <b>20</b><i>b</i>, and magnetic disturbances also bias the measurements of the magnetometers <b>23</b> when the IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>comprise said sensing device. The sensor fusion algorithm may reduce the influence of these biases with the measurements provided by remaining sensing device(s), but may not completely cancel these biases out.</p><p id="p-0087" num="0093">The computing device <b>15</b> includes at least one processor <b>16</b>, at least one memory <b>17</b>, and a second communications module <b>18</b> for transmitting and receiving data (through a wired or wireless communications technology and protocol known by a skilled person, for instance but without limitation, Bluetooth communications, cellular network communications such as GSM, UMTS or LTE, wireless LAN communications, etc.).</p><p id="p-0088" num="0094"><figref idref="DRAWINGS">FIG. <b>3</b>A</figref> shows the person <b>1</b> with first and second IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>of a motion tracking system (e.g. the system <b>10</b> of <figref idref="DRAWINGS">FIG. <b>2</b></figref>) on the thigh <b>6</b><i>a </i>and the shank <b>6</b><i>b</i>, respectively, and <figref idref="DRAWINGS">FIG. <b>3</b>B</figref> illustratively represents depicted segments <b>7</b><i>a</i>, <b>7</b><i>b </i>corresponding to the length of the thigh <b>6</b><i>a </i>and the shank <b>6</b><i>b </i>with the orientations of <figref idref="DRAWINGS">FIG. <b>3</b>A</figref>, together with a joint axis plane <b>50</b> and the IMUs <b>20</b><i>a</i>, <b>20</b><i>b. </i></p><p id="p-0089" num="0095">The person <b>1</b> is performing a hip flexion. The first and second IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>provide respective orientation measurements such as first orientation measurement <b>40</b> and second orientation measurement <b>41</b>.</p><p id="p-0090" num="0096">The computing device (e.g. the computing device <b>15</b>) of the motion tracking system receives the orientation measurements <b>40</b>, <b>41</b> from the IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>and digitally processes them for determining whether heading errors are present in the orientation measurements <b>40</b>, <b>41</b> and correcting the same.</p><p id="p-0091" num="0097">To this end, the computing device processes the second orientation measurement <b>41</b> to establish the local axes of the second unit <b>20</b><i>b </i>and, based on these local axes and whose orientations can be obtained in global coordinates, define a joint axis plane <b>50</b> corresponding to the plane of the axis of the knee <b>5</b><i>a</i>. In this case, one of the local axes of the second unit <b>20</b><i>b </i>is used as a normal vector, e.g. (a, b, c) of the plane <b>50</b>, which is sufficient to define it by equation: ax+by +cz=0.</p><p id="p-0092" num="0098">In some embodiments, none of the local axes of the second unit <b>20</b><i>b </i>coincides with the axis of the knee <b>5</b><i>a</i>, for instance when the second unit <b>20</b><i>b </i>is misplaced on the shank <b>6</b><i>b</i>. In such situations, the computing device is to calibrate the units <b>20</b><i>a</i>, <b>20</b><i>b </i>by way of a calibration procedure for determining the placement of the units <b>20</b><i>a</i>, <b>20</b><i>b </i>on the body members <b>6</b><i>a</i>, <b>6</b><i>b</i>, and then a vector is provided by the computing device to define the joint axis plane <b>50</b>; said vector does not coincide with the local axes of the second unit <b>20</b><i>b </i>but is based on the actual orientation of the (misplaced) second unit <b>20</b><i>b</i>. The calibration procedure triggered once the units <b>20</b><i>a</i>, <b>20</b><i>b </i>are arranged on the person <b>1</b> can be a calibration procedure of the state of the art whereby either the person <b>1</b> is requested to perform predetermined movement(s) for calibration purposes that involve motion of the body members with units <b>20</b><i>a</i>, <b>20</b><i>b </i>arranged thereon, and/or the units <b>20</b><i>a</i>, <b>20</b><i>b </i>have their sensing devices calibrated such that the headings of the measurements thereof are accurate at least for a certain amount of time, e.g. one minute, two minutes, five minutes, etc., without requiring any predetermined movement(s) from the person <b>1</b>. By way of example, a calibration procedure of the state of the art is that described in PCT/PT2018/050044, which is incorporated by reference in its entirety herein.</p><p id="p-0093" num="0099">The computing device computes a vector corresponding to a length direction of the segment <b>7</b><i>a </i>of the thigh <b>6</b><i>a </i>based on the first orientation measurement <b>40</b>, for example said first orientation measurement <b>40</b> can be defined by vector (x<sub>orig</sub>, y<sub>orig</sub>, z<sub>orig</sub>). The computing device then determines that there is a heading error because the first orientation measurement <b>40</b> is not coplanar with the plane <b>50</b> defined by the computing device due to accumulated bias in the gyroscope and/or magnetic distortions affecting the magnetometer (if any) of the IMU; the orientation measurement <b>40</b> should be coplanar owing to the biomechanical constraints of the knee <b>5</b><i>a. </i></p><p id="p-0094" num="0100">The soft tissue artifacts do not change the orientation in the length direction of the thigh <b>6</b><i>a </i>(i.e. that of the segment <b>7</b><i>a</i>) but change those in the other two directions, namely the directions around the length direction, hence the orientation in the length direction is used in the correction of the heading error. The computing device computes how the orientation measurement <b>40</b> is to be rotated so that it ends up being coplanar with the joint axis plane <b>50</b>. The computing device thus computes heading rotation(s) <b>55</b>, <b>56</b> (e.g. angles, quaternions) whereby the orientation measurement <b>40</b> becomes coplanar with the joint axis plane <b>50</b>, thereby providing first and second coplanar orientations <b>60</b>, <b>61</b>. The heading rotation(s) <b>55</b>, <b>56</b> correspond to the heading error computed with inverse sign. For the sake of clarity only, a first heading rotation <b>55</b> is shown with solid line as an angle for providing the first coplanar orientation <b>60</b> also shown with solid line, whereas a second heading rotation <b>56</b> is shown with dashed line as an angle for providing the second coplanar orientation <b>61</b> also shown with dashed line. The heading rotations <b>55</b>, <b>56</b> are obtained by digitally solving a system of three equations:</p><p id="p-0095" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>ax</i>+by +<i>cz=</i>0,<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0096" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>y</i>=&#x221a;{square root over (1&#x2212;<i>z</i><sup>2</sup><i>&#x2212;x</i><sup>2</sup>)}, and<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0097" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>z=z</i><sub>orig</sub>.<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0098" num="0101">In this regard, the first coplanar orientation <b>60</b> can be defined by vector (x<sub>1</sub>, y<sub>1</sub>, z<sub>orig</sub>) and, accordingly, a first heading rotation value can be computed so that x<sub>orig </sub>and y<sub>orig </sub>become x<sub>1 </sub>and y<sub>1</sub>, respectively, thus the heading rotation value 55 is such that</p><p id="p-0099" num="0000"><maths id="MATH-US-00003" num="00003"><math overflow="scroll"> <mrow>  <msub>   <mi>x</mi>   <mn>1</mn>  </msub>  <mo>=</mo>  <mrow>   <mrow>    <mrow>     <mo>-</mo>     <mfrac>      <mrow>       <mrow>        <mo>-</mo>        <msub>         <mi>acz</mi>         <mi>orig</mi>        </msub>       </mrow>       <mo>+</mo>       <mrow>        <mi>b</mi>        <mo>&#x2062;</mo>        <msqrt>         <mrow>          <mrow>           <mrow>            <mo>-</mo>            <msup>             <mi>a</mi>             <mn>2</mn>            </msup>           </mrow>           <mo>&#x2062;</mo>           <msubsup>            <mi>z</mi>            <mi>orig</mi>            <mn>2</mn>           </msubsup>          </mrow>          <mo>+</mo>          <msup>           <mi>a</mi>           <mn>2</mn>          </msup>          <mo>-</mo>          <mrow>           <msup>            <mi>b</mi>            <mn>2</mn>           </msup>           <mo>&#x2062;</mo>           <msubsup>            <mi>z</mi>            <mi>orig</mi>            <mn>2</mn>           </msubsup>          </mrow>          <mo>+</mo>          <msup>           <mi>b</mi>           <mn>2</mn>          </msup>          <mo>-</mo>          <mrow>           <msup>            <mi>c</mi>            <mn>2</mn>           </msup>           <mo>&#x2062;</mo>           <msubsup>            <mi>z</mi>            <mi>orig</mi>            <mn>2</mn>           </msubsup>          </mrow>         </mrow>        </msqrt>       </mrow>      </mrow>      <mrow>       <msup>        <mi>a</mi>        <mn>2</mn>       </msup>       <mo>+</mo>       <msup>        <mi>b</mi>        <mn>2</mn>       </msup>      </mrow>     </mfrac>    </mrow>    <mo>&#x2062;</mo>    <mtext>    </mtext>    <mi fontstyle="normal">and</mi>    <mo>&#x2062;</mo>    <mtext>    </mtext>    <msub>     <mi>y</mi>     <mn>1</mn>    </msub>   </mrow>   <mo>=</mo>   <mrow>    <mo>-</mo>    <mrow>     <mfrac>      <mrow>       <mrow>        <mi>a</mi>        <mo>&#x2062;</mo>        <msub>         <mi>x</mi>         <mn>1</mn>        </msub>       </mrow>       <mo>+</mo>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <msub>         <mi>z</mi>         <mi>orig</mi>        </msub>       </mrow>      </mrow>      <mi>b</mi>     </mfrac>     <mo>.</mo>    </mrow>   </mrow>  </mrow> </mrow></math></maths></p><p id="p-0100" num="0000">Likewise, the second coplanar orientation <b>61</b> can be defined by vector (x<sub>2</sub>, y<sub>2</sub>, z<sub>orig</sub>) and, accordingly, the second heading rotation value can be computed so that x<sub>orig </sub>and y<sub>orig </sub>become x<sub>2 </sub>and y<sub>2</sub>, respectively, thus the heading rotation value is such that</p><p id="p-0101" num="0000"><maths id="MATH-US-00004" num="00004"><math overflow="scroll"> <mrow>  <msub>   <mi>x</mi>   <mn>2</mn>  </msub>  <mo>=</mo>  <mrow>   <mrow>    <mrow>     <mo>-</mo>     <mfrac>      <mrow>       <msub>        <mi>acz</mi>        <mi>orig</mi>       </msub>       <mo>+</mo>       <mrow>        <mi>b</mi>        <mo>&#x2062;</mo>        <msqrt>         <mrow>          <mrow>           <mrow>            <mo>-</mo>            <msup>             <mi>a</mi>             <mn>2</mn>            </msup>           </mrow>           <mo>&#x2062;</mo>           <msubsup>            <mi>z</mi>            <mi>orig</mi>            <mn>2</mn>           </msubsup>          </mrow>          <mo>+</mo>          <msup>           <mi>a</mi>           <mn>2</mn>          </msup>          <mo>-</mo>          <mrow>           <msup>            <mi>b</mi>            <mn>2</mn>           </msup>           <mo>&#x2062;</mo>           <msubsup>            <mi>z</mi>            <mi>orig</mi>            <mn>2</mn>           </msubsup>          </mrow>          <mo>+</mo>          <msup>           <mi>b</mi>           <mn>2</mn>          </msup>          <mo>-</mo>          <mrow>           <msup>            <mi>c</mi>            <mn>2</mn>           </msup>           <mo>&#x2062;</mo>           <msubsup>            <mi>z</mi>            <mi>orig</mi>            <mn>2</mn>           </msubsup>          </mrow>         </mrow>        </msqrt>       </mrow>      </mrow>      <mrow>       <msup>        <mi>a</mi>        <mn>2</mn>       </msup>       <mo>+</mo>       <msup>        <mi>b</mi>        <mn>2</mn>       </msup>      </mrow>     </mfrac>    </mrow>    <mo>&#x2062;</mo>    <mtext>    </mtext>    <mi fontstyle="normal">and</mi>    <mo>&#x2062;</mo>    <mtext>    </mtext>    <msub>     <mi>y</mi>     <mn>2</mn>    </msub>   </mrow>   <mo>=</mo>   <mrow>    <mo>-</mo>    <mrow>     <mfrac>      <mrow>       <mrow>        <mi>a</mi>        <mo>&#x2062;</mo>        <msub>         <mi>x</mi>         <mn>2</mn>        </msub>       </mrow>       <mo>+</mo>       <mrow>        <mi>c</mi>        <mo>&#x2062;</mo>        <msub>         <mi>z</mi>         <mi>orig</mi>        </msub>       </mrow>      </mrow>      <mi>b</mi>     </mfrac>     <mo>.</mo>    </mrow>   </mrow>  </mrow> </mrow></math></maths></p><p id="p-0102" num="0102">The definition of the vertical component of the vectors as z<sub>orig</sub>, which is a value from the vector of the first orientation measurement <b>40</b>, is due to the fact that heading is to be corrected by means of a rotation around the global vertical axis (i.e. Z axis illustrated), thus the vertical component is disregarded. As it can be appreciated, in some other examples, the first coplanar orientation <b>60</b> is defined by vector (x<sub>2</sub>, y<sub>2</sub>, z<sub>orig</sub>) and the second coplanar orientation <b>61</b> is defined by vector (x<sub>1</sub>, y<sub>1</sub>, z<sub>orig</sub>).</p><p id="p-0103" num="0103">The computing device establishes that the first coplanar orientation <b>60</b> is the correct orientation out of the two orientations <b>60</b>, <b>61</b> since it is the orientation that:<ul id="ul0011" list-style="none">    <li id="ul0011-0001" num="0000">    <ul id="ul0012" list-style="none">        <li id="ul0012-0001" num="0104">fulfills one or more predetermined biomechanical constraints established for the concerned joint, and/or</li>        <li id="ul0012-0002" num="0105">a difference between the computed heading error and a previously computed heading error fulfills one or both of:        <ul id="ul0013" list-style="none">            <li id="ul0013-0001" num="0106">is smaller than the difference between the computed heading error for the other orientation and a previously computed heading error, and</li>            <li id="ul0013-0002" num="0107">does not exceed a predetermined heading error threshold, namely the difference shall not exceed a threshold of e.g. 10&#xb0;, 20&#xb0;, etc.</li>        </ul>        </li>    </ul>    </li></ul></p><p id="p-0104" num="0108">In relation to the fulfillment of predetermined biomechanical constraints, for example the second coplanar orientation <b>61</b> results in a movement of the joint that is deemed impossible (e.g. knee hyperextension) or is caused by a soft tissue artifact deemed excessive for the concerned body member.</p><p id="p-0105" num="0109">By way of example, when the IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>are arranged on the leg of the person <b>1</b>, it has been found out that soft tissue artifacts should not result in a difference of more than 45&#xb0; around the direction of the segment (i.e. length direction of the body member), and the solution being closer to the joint axis plane is the one deemed correct; positive Y axis is typically closer to the joint axis than negative Y axis, therefore, in these cases, the heading rotation value that is selected is that of positive Y of the thigh <b>6</b><i>a </i>joint axis, which is closer to the positive Y of the shank <b>6</b><i>b. </i></p><p id="p-0106" num="0110"><figref idref="DRAWINGS">FIGS. <b>4</b>A and <b>4</b>C</figref> show the person <b>1</b> with first and second IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>of a motion tracking system (e.g. the system <b>10</b> of <figref idref="DRAWINGS">FIG. <b>2</b></figref>) on the forearm <b>6</b><i>d </i>and the upper arm <b>6</b><i>c</i>, respectively, and <figref idref="DRAWINGS">FIG. <b>4</b>B and <b>4</b>D</figref> illustratively represent depicted segments <b>7</b><i>d</i>, <b>7</b><i>c </i>corresponding to the length of the forearm <b>6</b><i>d </i>and the upper arm <b>6</b><i>c </i>with the orientations of <figref idref="DRAWINGS">FIGS. <b>4</b>A and <b>4</b>C</figref>, together with a joint axis plane <b>50</b> and the IMUs <b>20</b><i>a</i>, <b>20</b><i>b. </i></p><p id="p-0107" num="0111">The person <b>1</b> is performing forearm pronation as illustrated with <figref idref="DRAWINGS">FIGS. <b>4</b>A and <b>4</b>C</figref>. The first and second IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>provide respective orientation measurements such as first orientation measurement <b>40</b> and second orientation measurement <b>41</b>.</p><p id="p-0108" num="0112">The computing device (e.g. the computing device <b>15</b>) of the motion tracking system receives the orientation measurements <b>40</b>, <b>41</b> from the IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>and digitally processes them for determining whether heading errors are present in the orientation measurements <b>40</b>, <b>41</b> and correcting the same.</p><p id="p-0109" num="0113">With a digital processing as described in the present disclosure, in this example, the computing device processes the first orientation measurement <b>40</b> and provides a vector corresponding to a local axis of the first IMU <b>20</b><i>a </i>to define the axis plane <b>50</b> of the joint <b>5</b><i>b</i>, in this case the elbow <b>5</b><i>b </i>of the person <b>1</b>.</p><p id="p-0110" num="0114">The computing device solves the system of equations for a vector provided based on the second orientation measurement <b>41</b>, and with the solutions it computes heading rotations <b>55</b>, <b>56</b> for making the second orientation measurement <b>41</b> to be contained within the joint axis plane <b>50</b>. One of the solutions can be selected over the other according to any one of the criteria described in relation to <figref idref="DRAWINGS">FIGS. <b>3</b>A-<b>3</b>B</figref>.</p><p id="p-0111" num="0115">It is noted that the vectors described for instance with reference to <figref idref="DRAWINGS">FIGS. <b>3</b>A-<b>3</b>B and <b>4</b>A-<b>4</b>D</figref> are either free vectors, from which those of the first and second planar orientations <b>60</b>, <b>61</b> are to be contained in the joint axis plane <b>50</b>. Alternatively, the vectors described are not free vectors but are to be contained in the joint axis plane <b>50</b> or a plane parallel thereto.</p><p id="p-0112" num="0116">Albeit in the embodiments of <figref idref="DRAWINGS">FIGS. <b>3</b>A-<b>3</b>B</figref> and <figref idref="DRAWINGS">FIGS. <b>4</b>A-<b>4</b>D</figref> it has been described that the rotation of the orientation measurements is applied to the first and second orientation measurements <b>40</b>, <b>41</b>, respectively, in some other embodiments the rotation is applied to the second and first orientation measurements <b>41</b>, <b>40</b>, respectively. That is to say, the rotation is applied to the orientation measurement used for defining the joint axis plane <b>50</b>, in which case the rotation to be applied is the same as if it were to be applied to the first and second orientation measurements <b>40</b>, <b>41</b> as explained in relation to <figref idref="DRAWINGS">FIGS. <b>3</b>A-<b>3</b>B, and <b>4</b>A-<b>4</b>D</figref>, respectively, but with inverse sign.</p><p id="p-0113" num="0117"><figref idref="DRAWINGS">FIG. <b>5</b></figref> diagrammatically shows a method <b>100</b> in accordance with embodiments.</p><p id="p-0114" num="0118">The method <b>100</b> comprises a step <b>130</b> whereby a computing device (e.g. the computing device <b>15</b> of <figref idref="DRAWINGS">FIG. <b>2</b></figref>) of a motion tracking system (e.g. the system <b>10</b> of <figref idref="DRAWINGS">FIG. <b>2</b></figref>) digitally processes orientation measurements provided by each of first and second inertial measurement units (e.g. the IMUs <b>20</b><i>a</i>, <b>20</b><i>b </i>of <figref idref="DRAWINGS">FIGS. <b>1</b>A-<b>1</b>C, <b>2</b>, <b>3</b>A-<b>3</b>B, <b>4</b>A-<b>4</b>D</figref>, with or without magnetometers <b>23</b>) of a motion tracking system that are arranged on first and second body members (e.g. thigh and shank, upper arm and forearm) of a person, respectively, according to a predetermined unit arrangement. The orientation measurements are processed in such a way that a heading error is computed from a heading estimate of one or more measurements of one of the first and second IMUs, and a heading rotation value is also computed based on the heading error so that the heading error may be corrected. Such digital processing may be, for example, as described above in relation to the example of <figref idref="DRAWINGS">FIGS. <b>3</b>A and <b>3</b>B</figref>.</p><p id="p-0115" num="0119">The orientation measurements that the computing device processes may be raw measurements, i.e. values measured by a sensing device of a respective unit, or processed measurements, i.e. values modified by the processor(s) of the IMU, for instance owing to a sensor fusion algorithm that is intended to improve the measurements of the IMU by combining the measurements of the different sensing devices.</p><p id="p-0116" num="0120">The method <b>100</b> further comprises a step <b>140</b> whereby the computing device digitally modifies one or more measurements of one of the first and second IMUs for correcting the heading error. This is attained by applying a rotation at least based on a value or values computed in the step <b>130</b> in which the computing device digitally processes the measurements.</p><p id="p-0117" num="0121">Preferably, the steps <b>130</b> and <b>140</b> are carried out in real time or almost in real time as the IMUs provide the measurements, even though, in some embodiments, the heading error correction is performed later on during the motion tracking procedure or after completion of the same. In this sense, the steps <b>130</b> and <b>140</b> can be carried out during physical exercising of the person, therefore the orientation measurements are provided by the units and the computing device processes and modifies them while the person moves one or both of the first and second body members; movement of the body members comprises linear motion and/or rotation of the respective body member.</p><p id="p-0118" num="0122">In some embodiments, the steps <b>130</b> and <b>140</b> carried out by the computing device are repeated (as illustrated with a dashed line) a number of times so as to correct heading errors in orientation measurements provided by the IMUs during a motion tracking procedure. Therefore, upon providing more recent measurements, the computing device digitally processes the same and digitally modifies measurements of one of the IMUs so as to correct the heading error, thereby making possible to improve the precision of the movement sequence that is to be provided by the computing device.</p><p id="p-0119" num="0123">In some embodiments, the method <b>100</b> further comprises one or more of steps <b>110</b>, <b>120</b> and <b>150</b> as described next in relation to method <b>101</b> of <figref idref="DRAWINGS">FIG. <b>6</b></figref>.</p><p id="p-0120" num="0124"><figref idref="DRAWINGS">FIG. <b>6</b></figref> diagrammatically shows a method <b>101</b> in accordance with embodiments.</p><p id="p-0121" num="0125">The method <b>101</b> comprises a step <b>110</b> whereby the first and second units are arranged on the first and second body members, respectively. The units may be arranged <b>110</b> by way of attaching devices or means such as e.g. straps, Velcro, etc.</p><p id="p-0122" num="0126">At least the unit whose orientation measurement(s) is/are used in the definition of the joint axis plane is preferably arranged on the respective body member (preferably the body member of the two body members that only rotates around the joint axis, or mostly rotates around the joint axis) such that a local axis of the unit out of the three local axes is aligned or substantially aligned with the segment of the body member, otherwise a calibration procedure is effected whereby the computing device determines how the IMUs are arranged on the body segments so that the orientation of the IMUs can be specified with respect to the segments of the body members (even if no local axis of one or both units is aligned or substantially aligned with the corresponding segment). More preferably, both units are arranged on the respective body members such that a respective local axis of the units out of the three local axes is aligned or substantially aligned with the segment of the respective body member, or the aforementioned calibration procedure is performed for determining the orientation of the IMUs as indicated.</p><p id="p-0123" num="0127">The method <b>101</b> further comprises a step <b>120</b> whereby the first and second units, once arranged <b>110</b> on the body members of the person, provide the orientation measurements to be digitally processed <b>130</b> and modified <b>140</b> by the computing device. The orientation measurements may be provided to the computing device via wired or, preferably, wireless communications. The orientation measurements may be raw measurements or processed measurements, e.g. processed with a sensor fusion algorithm as known in the art.</p><p id="p-0124" num="0128">The method <b>101</b> further comprises the steps <b>130</b>, <b>140</b> of digitally processing and modifying the orientation measurements provided <b>120</b>. The method <b>101</b> also comprises a step <b>150</b> whereby the computing device digitally provides a movement sequence of the person based on the orientation measurements provided by the first and second units, and where at least some (or all) orientation measurements of one the first and second units have been digitally modified <b>140</b>.</p><p id="p-0125" num="0129">The movement sequence comprises data of the motion tracking procedure that indicates how the person or at least the body members thereof with IMUs have behaved in terms of movements and orientations during said procedure. Thanks to the movement sequence provided <b>150</b>, the computing device is capable of assessing whether the person has performed movements or physical exercises according to predetermined criteria, for instance for physical rehabilitation purposes. The correction of heading errors present in the orientation measurements enhances the accuracy of the movement sequence and, thus, of any additional evaluation, for example the mentioned movement or physical exercise assessment, which may be carried out according to state of the art procedures known in the art, for example but without limitation, a physical exercise evaluation procedure as described in PCT/EP2019/066237, which is incorporated by reference in its entirety herein.</p><p id="p-0126" num="0130">A motion tracking system (e.g. the system <b>10</b> of <figref idref="DRAWINGS">FIG. <b>2</b></figref>) according to the present disclosure is adapted to carry out methods such as methods <b>100</b>, <b>101</b> of <figref idref="DRAWINGS">FIGS. <b>5</b> and <b>6</b></figref> owing to a computing device (e.g. the computing device <b>15</b> of <figref idref="DRAWINGS">FIG. <b>2</b></figref>) configured to perform steps <b>130</b>, <b>140</b>, <b>150</b> (i.e. the at least one processor is configured, together with the at least one memory, to carry out the steps <b>130</b>, <b>140</b>, <b>150</b>).</p><p id="p-0127" num="0131">In this text, the terms first, second, third, etc. have been used herein to describe several devices, elements or parameters, it will be understood that the devices, elements or parameters should not be limited by these terms since the terms are only used to distinguish one device, element or parameter from another. For example, the first orientation measurement could as well be named second orientation measurement, and the second orientation measurement could be named first orientation measurement without departing from the scope of this disclosure.</p><p id="p-0128" num="0132">In this text, the term &#x201c;comprises&#x201d; and its derivations (such as &#x201c;comprising&#x201d;, etc.) should not be understood in an excluding sense, that is, these terms should not be interpreted as excluding the possibility that what is described and defined may include further elements, steps, etc.</p><p id="p-0129" num="0133">On the other hand, the invention is obviously not limited to the specific embodiment(s) described herein, but also encompasses any variations that may be considered by any person skilled in the art (for example, as regards the choice of materials, dimensions, components, configuration, etc.), within the general scope of the invention as defined in the claims.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001" nb-file="US20230003528A1-20230105-M00001.NB"><img id="EMI-M00001" he="13.72mm" wi="76.20mm" file="US20230003528A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00002" nb-file="US20230003528A1-20230105-M00002.NB"><img id="EMI-M00002" he="13.72mm" wi="76.20mm" file="US20230003528A1-20230105-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00003" nb-file="US20230003528A1-20230105-M00003.NB"><img id="EMI-M00003" he="13.72mm" wi="76.20mm" file="US20230003528A1-20230105-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00004" nb-file="US20230003528A1-20230105-M00004.NB"><img id="EMI-M00004" he="13.72mm" wi="76.20mm" file="US20230003528A1-20230105-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A method (<b>100</b>, <b>101</b>) comprising:<claim-text>digitally processing (<b>130</b>), by a computing device (<b>15</b>) of a motion tracking system (<b>10</b>), orientation measurements (<b>40</b>, <b>41</b>) provided by each of first and second inertial measurement units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) of the motion tracking system (<b>10</b>), each of the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) at least comprises an accelerometer (<b>21</b>) and a gyroscope (<b>22</b>), the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) being arranged on first and second body members (<b>6</b><i>a</i>-<b>6</b><i>d</i>) of a person (<b>1</b>), respectively, according to a predetermined unit arrangement, and the first and second body members (<b>6</b><i>a</i>-<b>6</b><i>d</i>) being connected by a joint (<b>5</b><i>a</i>, <b>5</b><i>b</i>);</claim-text><claim-text>characterized in that:</claim-text><claim-text>the measurements are digitally processed (<b>130</b>) such that the computing device (<b>15</b>) at least:<claim-text>computes a length vector of a segment (<b>7</b><i>a</i>, <b>7</b><i>c</i>) of the first body member (<b>6</b><i>a</i>, <b>6</b><i>c</i>) based on a first orientation measurement (<b>40</b>) of the first unit (<b>20</b><i>a</i>);</claim-text><claim-text>defines a joint axis plane (<b>50</b>) of the joint (<b>5</b><i>a</i>, <b>5</b><i>b</i>) based on a second orientation measurement (<b>41</b>) of the second unit (<b>20</b><i>b</i>); and</claim-text><claim-text>computes a heading rotation value for making the first orientation measurement (<b>40</b>) to be contained (60, 61) within the joint axis plane (<b>50</b>) defined; and</claim-text></claim-text><claim-text>the method further comprising digitally modifying (<b>140</b>), by the computing device (<b>15</b>), the first orientation measurement (<b>40</b>) or the second orientation measurement (<b>41</b>) by applying a rotation (<b>55</b>, <b>56</b>) based on the heading rotation value computed.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method (<b>100</b>, <b>101</b>) of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the step of digitally processing (<b>130</b>) comprises:<claim-text>providing a first vector (a, b, c) based on the second orientation measurement (<b>41</b>);</claim-text><claim-text>providing value z<sub>orig </sub>based on the first orientation measurement (<b>40</b>); and</claim-text><claim-text>solving the following system of three equations:<claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>ax</i>+by +<i>cz=</i>0,<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>y</i>=&#x221a;{square root over (1&#x2212;<i>z</i><sup>2</sup><i>&#x2212;x</i><sup>2</sup>)}, and<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text><claim-text><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>z=z</i><sub>orig</sub>; and<?in-line-formulae description="In-line Formulae" end="tail"?></claim-text></claim-text><claim-text>the heading rotation value is based on a solution to the system of three equations.</claim-text></claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method (<b>100</b>, <b>101</b>) of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein:<claim-text>the step of digitally processing (<b>130</b>) further comprises selecting the solution to the system of three equations that at least one of:</claim-text><claim-text>fulfills one or more predetermined biomechanical constraints, and</claim-text><claim-text>results in an instantaneous heading error that:<claim-text>is determined not to be excessive by the computing device (<b>15</b>), and/or</claim-text><claim-text>is less than an instantaneous heading error for the other solution to the system of three equations; and</claim-text></claim-text><claim-text>the heading rotation value is based on the selected solution to the system of three equations.</claim-text></claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method (<b>100</b>, <b>101</b>) of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising digitally providing (<b>150</b>), by the computing device (<b>15</b>), a movement sequence of the person (<b>1</b>) based on the orientation measurements (<b>40</b>, <b>41</b>) provided by the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) wherein at least some orientation measurements (<b>60</b>) of one the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) have been digitally modified (<b>140</b>).</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method (<b>100</b>, <b>101</b>) of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising repeating at least the digital steps (<b>130</b>, <b>140</b>, <b>150</b>) one or more times with most recent orientation measurements (<b>40</b>, <b>41</b>) provided by the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) for correction of heading error in the measurements provided by the units (<b>20</b><i>a</i>, <b>20</b><i>b</i>).</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method (<b>100</b>, <b>101</b>) of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the rotation applied in the step of digitally modifying (<b>140</b>) is at least further based on one or more heading rotation values previously computed for digital modification (<b>140</b>) of previous orientation measurements.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method (<b>101</b>) of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising, prior to the step of digitally processing (<b>130</b>), arranging (<b>110</b>) the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) on the first and second body members (<b>6</b><i>a</i>-<b>6</b><i>d</i>) of the person (<b>1</b>), respectively.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. The method (<b>100</b>, <b>101</b>) of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein either the motion tracking system (<b>10</b>) or each of the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) comprises attaching devices for indicating or forcing arrangement of each unit (<b>20</b><i>a</i>, <b>20</b><i>b</i>) with a predetermined orientation.</claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising calibrating the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) after arranging (<b>110</b>) them on the first and second body members (<b>6</b><i>a</i>-<b>6</b><i>d</i>).</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The method (<b>101</b>) of any one of the preceding claims, wherein at least the second unit (<b>20</b><i>b</i>) is arranged on the second body member (<b>6</b><i>b</i>, <b>6</b><i>d</i>) such that one of three axes of the second unit (<b>20</b><i>b</i>) is aligned or substantially aligned with a segment of the second body member (<b>6</b><i>b</i>, <b>6</b><i>d</i>).</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The method (<b>100</b>, <b>101</b>) of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first and second body members (<b>6</b><i>a</i>-<b>6</b><i>d</i>) respectively are an upper arm (<b>6</b><i>c</i>) and a forearm (<b>6</b><i>d</i>) or vice versa, or the first and second body members (<b>6</b><i>a</i>-<b>6</b><i>d</i>) respectively are a thigh (<b>6</b><i>a</i>) and a shank (<b>6</b><i>b</i>) or vice versa.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The method (<b>101</b>) of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising providing (<b>120</b>), by each of the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>), the orientation measurements (<b>40</b>, <b>41</b>) to be digitally processed (<b>130</b>).</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. A motion tracking system (<b>10</b>) comprising:<claim-text>a computing device (<b>15</b>) comprising at least one processor (<b>16</b>) and at least one memory (<b>17</b>); and</claim-text><claim-text>first and second inertial measurement units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) adapted to be arranged on first and second body members (<b>6</b><i>a</i>-<b>6</b><i>d</i>) of a person (<b>1</b>) and each at least comprising an accelerometer (<b>21</b>) and a gyroscope (<b>22</b>);</claim-text><claim-text>characterized in that:</claim-text><claim-text>the at least one processor (<b>16</b>) is configured, together with the at least one memory (<b>17</b>), to carry out a method (<b>100</b>, <b>101</b>) according to <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text></claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. A computer program product that has instructions which, when executed by a computing device (<b>15</b>) of a motion tracking system (<b>10</b>) comprising a first and second inertial measurement units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) adapted to be arranged on first and second body members (<b>6</b><i>a</i>-<b>6</b><i>d</i>) of a person (<b>1</b>) and each at least comprising an accelerometer (<b>21</b>) and a gyroscope (<b>22</b>), cause the computing device (<b>15</b>) to perform a method (<b>100</b>, <b>101</b>) according to <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The method (<b>100</b>, <b>101</b>) of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein each of the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) further comprises a magnetometer (<b>23</b>).</claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The motion tracking system (<b>10</b>) of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein each of the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) further comprises a magnetometer (<b>23</b>).</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The computer program product of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein each of the first and second units (<b>20</b><i>a</i>, <b>20</b><i>b</i>) further comprises a magnetometer (<b>23</b>).</claim-text></claim></claims></us-patent-application>