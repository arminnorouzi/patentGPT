<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230003101A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230003101</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17810233</doc-number><date>20220630</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>E</section><class>21</class><subclass>B</subclass><main-group>41</main-group><subgroup>00</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>F</subclass><main-group>30</main-group><subgroup>20</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>E</section><class>21</class><subclass>B</subclass><main-group>41</main-group><subgroup>00</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20200101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>30</main-group><subgroup>20</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20200501</date></cpc-version-indicator><section>E</section><class>21</class><subclass>B</subclass><main-group>2200</main-group><subgroup>20</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20200101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>F</subclass><main-group>2113</main-group><subgroup>08</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">METHOD OF HYDROCARBON RESERVOIR SIMULATION USING STREAMLINE CONFORMAL GRIDS</invention-title><us-related-documents><us-provisional-application><document-id><country>US</country><doc-number>63216808</doc-number><date>20210630</date></document-id></us-provisional-application></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>SAUDI ARABIAN OIL COMPANY</orgname><address><city>Dhahran</city><country>SA</country></address></addressbook><residence><country>SA</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>Dogru</last-name><first-name>Ali Haydar</first-name><address><city>Dhahran</city><country>SA</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Cancelliere</last-name><first-name>Michel</first-name><address><city>Dhahran</city><country>SA</country></address></addressbook></inventor></inventors></us-parties><assignees><assignee><addressbook><orgname>SAUDI ARABIAN OIL COMPANY</orgname><role>03</role><address><city>Dhahran</city><country>SA</country></address></addressbook></assignee></assignees></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A system and method of simulating fluid flow in a hydrocarbon reservoir is disclosed. The method includes obtaining a coarse grid model of the hydrocarbon reservoir and a trajectory of a wellbore that penetrates the hydrocarbon reservoir, and determining an initial grid geometry surrounding the trajectory. The method further includes constructing a reservoir simulation grid, conformal to the initial grid geometry in a first region in a vicinity of the wellbore and conformal with the coarse grid model in a second region more distant from the wellbore than the first region, and performing a hydrocarbon reservoir simulation, modeling a flow of fluid in the hydrocarbon reservoir based, at least in part, on the reservoir simulation grid.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="166.96mm" wi="138.51mm" file="US20230003101A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="180.17mm" wi="140.55mm" file="US20230003101A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="197.95mm" wi="158.41mm" file="US20230003101A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="204.81mm" wi="135.89mm" file="US20230003101A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="127.93mm" wi="148.93mm" file="US20230003101A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="146.05mm" wi="142.49mm" file="US20230003101A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="231.82mm" wi="106.26mm" file="US20230003101A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="229.95mm" wi="140.72mm" file="US20230003101A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="230.80mm" wi="140.72mm" file="US20230003101A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="228.94mm" wi="140.72mm" file="US20230003101A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="192.19mm" wi="149.01mm" orientation="landscape" file="US20230003101A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="187.37mm" wi="149.44mm" orientation="landscape" file="US20230003101A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="214.04mm" wi="149.35mm" orientation="landscape" file="US20230003101A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00013" num="00013"><img id="EMI-D00013" he="179.07mm" wi="158.24mm" orientation="landscape" file="US20230003101A1-20230105-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00014" num="00014"><img id="EMI-D00014" he="117.01mm" wi="125.90mm" file="US20230003101A1-20230105-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00015" num="00015"><img id="EMI-D00015" he="183.73mm" wi="145.88mm" file="US20230003101A1-20230105-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">BACKGROUND</heading><p id="p-0002" num="0001">In simulations, properties for various cells may be averaged to produce a coarse grid. However, if not applied properly, averaging may provide a solution in a model that may lose accuracy as the details are lost in the process, especially where averaging is applied to highly influential grid-cells. Thus, accurate simulations may require a model that reduces the computational time to an acceptable speed while also preserving relevant physical relationships in the underlying data.</p><p id="p-0003" num="0002">In reservoir simulation the reservoir domain may be divided into sub-domains called grid cells and reservoir variables such that pressure and fluid composition and saturations are calculated for each cell as a function of production time. Based on these predictions, maps of the movement of water, gas and oil are generated throughout the reservoir with production time. The calculated movements of fluids within the reservoir are affected by the selection of the grid cell size and shape. Typically, smaller the grid cells give the more accurate prediction of fluid movement and more accurate predictions of the arrival time (&#x201c;breakthrough&#x201d;) of fluids at production wells. Accurate timing of water or gas breakthrough at wells is important information for the field management for designing surface separation facilities, and therefore, estimating the size of required investments.</p><p id="p-0004" num="0003">However, smaller grid cells increase the number of unknown variables, such as the pressure and saturation in each cell, to be determined by the reservoir simulator and, therefore, require more computational time. In some cases, for example the simulation of a gas condensate reservoir, accurate simulation of some reservoir problems requires extremely small grid cell sizes. This may be impractical for simulating fields with long histories or forecast times. Prior to hydrocarbon production, gas condensate or wet gas reservoirs contain only gas in vapor state. During the production of the gas through production wells, reservoir pressure drops continuously. The largest pressure drops are observed around the production wells. Liquids, mostly oil, precipitate from the vapor phase forming a liquid zone around the wellbore when the pressure drops below a critical pressure, the &#x201c;dew point&#x201d; pressure. This process is often referred to as &#x201c;liquid drop-out&#x201d; inside the reservoir. These liquids, mostly oil, are light in molecular weight and are called &#x201c;condensates&#x201d;. Condensates typically flow much less easily than vapor through the reservoir and, thus, the accumulation of condensate around production wells restricts the flow of gas from the reservoir into the wellbore. This causes productivity to decline from the wells and a failure to deliver the desired gas rates. Although dropped condensates around the wellbore may be removed by interventions including injecting chemicals or fracturing the reservoir rock, intervention operations are both expensive and often not completely successful removing the condensates.</p><heading id="h-0002" level="1">SUMMARY</heading><p id="p-0005" num="0004">This summary is provided to introduce a selection of concepts that are further described below in the detailed description. This summary is not intended to identify key or essential features of the claimed subject matter, nor is it intended to be used as an aid in limiting the scope of the claimed subject matter.</p><p id="p-0006" num="0005">In general, in one aspect, embodiments relate to a method of simulating fluid flow in a hydrocarbon reservoir is disclosed. The method includes obtaining a coarse grid model of the hydrocarbon reservoir and a trajectory of a wellbore that penetrates the hydrocarbon reservoir and determining an initial grid geometry surrounding the trajectory. The method further includes constructing a reservoir simulation grid, conformal to the initial grid geometry in a first region in a vicinity of the wellbore and conformal with the coarse grid model in a second region more distant from the wellbore than the first region, and performing a hydrocarbon reservoir simulation, modeling a flow of fluid in the hydrocarbon reservoir based, at least in part, on the reservoir simulation grid.</p><p id="p-0007" num="0006">In general, in one aspect, embodiments relate to a non-transitory computer readable medium storing instructions executable by a computer processor, the instructions include functionality for obtaining a coarse grid model of a hydrocarbon reservoir and a trajectory of a wellbore that penetrates the hydrocarbon reservoir and determining an initial grid geometry surrounding the trajectory. The instructions further include functionality for constructing a reservoir simulation grid, conformal to the initial grid geometry in a first region in a vicinity of the wellbore and conformal with the coarse grid model in a second region more distant from the wellbore than the first region, and performing a hydrocarbon reservoir simulation, modeling a flow of fluid in the hydrocarbon reservoir based, at least in part, on the reservoir simulation grid.</p><p id="p-0008" num="0007">In general, in one aspect, embodiments relate to a system. The system includes a reservoir simulator and a well planning system. The reservoir simulator is configured to obtain a coarse grid model of a hydrocarbon reservoir and a trajectory of a wellbore that penetrates the hydrocarbon reservoir and to determine an initial grid geometry surrounding the trajectory. The reservoir simulator is further configured to construct a reservoir simulation grid, conformal to the initial grid geometry in a first region in a vicinity of the wellbore and conformal with the coarse grid model in a second region more distant from the wellbore than the first region and perform a hydrocarbon reservoir simulation, modeling a flow of fluid in the hydrocarbon reservoir based, at least in part, on the reservoir simulation grid, and develop a hydrocarbon reservoir production plan. The well planning system is configured to determine a planned wellbore trajectory based upon the hydrocarbon reservoir production plan.</p><p id="p-0009" num="0008">Other aspects and advantages of the claimed subject matter will be apparent from the following description and the appended claims.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0003" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading><p id="p-0010" num="0009">Specific embodiments of the disclosed technology will now be described in detail with reference to the accompanying figures. Like elements in the various figures are denoted by like reference numerals for consistency.</p><p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows system in accordance with one or more embodiments.</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIGS. <b>2</b>A and <b>2</b>B</figref> show systems in accordance with one or more embodiments.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIGS. <b>3</b>A and <b>3</b>B</figref> show isobars and streamlines in accordance with one or more embodiments.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>4</b></figref> shows a system in accordance with one or more embodiments.</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>5</b></figref> shows a flowchart in accordance with one or more embodiments.</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIGS. <b>6</b>A and <b>6</b>B</figref> show grids in accordance with one or more embodiments.</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIGS. <b>7</b>A-<b>7</b>C</figref> show pressure distributions in accordance with one or more embodiments.</p><p id="p-0018" num="0017"><figref idref="DRAWINGS">FIGS. <b>8</b>A-<b>8</b>C</figref> show condensate distributions in accordance with one or more embodiments.</p><p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. <b>9</b></figref> shows condensate production rates in accordance with one or more embodiments.</p><p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. <b>10</b></figref> shows bottom hole pressure in accordance with one or more embodiments.</p><p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. <b>11</b></figref> shows gas production rates in accordance with one or more embodiments.</p><p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. <b>12</b></figref> shows computational times in accordance with one or more embodiments.</p><p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. <b>13</b></figref> shows computer systems in accordance with one or more embodiments.</p><p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. <b>14</b></figref> shows a drilling system in accordance with one or more embodiments.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><heading id="h-0004" level="1">DETAILED DESCRIPTION</heading><p id="p-0025" num="0024">In the following detailed description of embodiments of the disclosure, numerous specific details are set forth in order to provide a more thorough understanding of the disclosure. However, it will be apparent that the disclosure may be practiced without these specific details. In other instances, well-known features have not been described in detail to avoid unnecessarily complicating the description.</p><p id="p-0026" num="0025">Throughout the application, ordinal numbers (e.g., first, second, third, etc.) may be used as an adjective for an element (i.e., any noun in the application). The use of ordinal numbers is not to imply or create any particular ordering of the elements nor to limit any element to being only a single element unless expressly disclosed, such as using the terms &#x201c;before&#x201d;, &#x201c;after&#x201d;, &#x201c;single&#x201d;, and other such terminology. Rather, the use of ordinal numbers is to distinguish between the elements. By way of an example, a first element is distinct from a second element, and the first element may encompass more than one element and succeed (or precede) the second element in an ordering of elements.</p><p id="p-0027" num="0026">Predicting the distribution of oil, gas and water within the reservoir and production rates of these fluids as a function of time from the commencement of production are of great importance. Accurate prediction of oil, gas, and water distributions and production rates have previously required very finely gridded simulation models particularly around horizontal and fractured wellbores. Such models frequently require so much computer time as to be impractical.</p><p id="p-0028" num="0027">Some embodiments are directed to a simulation model grid that combines grids at least approximately congruent with isobars and streamlines in the vicinity of horizontal and fractured wellbores with a coarse grid model far from the wellbores. Such combined simulation grids may be shown to be almost as accurate as finely gridded simulation model while requiring approximately the same computational time as more coarsely gridded models.</p><p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. <b>1</b></figref> shows a schematic diagram in accordance with one or more embodiments. <figref idref="DRAWINGS">FIG. <b>1</b></figref> illustrates a well environment (<b>100</b>) that includes a hydrocarbon reservoir (&#x201c;reservoir&#x201d;) (<b>102</b>) located in a subsurface hydrocarbon-bearing formation (&#x201c;formation&#x201d;) (<b>104</b>) and a well system (<b>106</b>). The hydrocarbon-bearing formation (<b>104</b>) may include a porous or fractured rock formation that resides underground, beneath the earth's surface (&#x201c;surface&#x201d;) (<b>108</b>). In the case of the well system (<b>106</b>) being a hydrocarbon well, the reservoir (<b>102</b>) may include a portion of the hydrocarbon-bearing formation (<b>104</b>). The hydrocarbon-bearing formation (<b>104</b>) and the reservoir (<b>102</b>) may include different layers of rock having varying characteristics, such as varying degrees of permeability and porosity. In the case of the well system (<b>106</b>) being operated as a production well, the well system (<b>106</b>) may facilitate the extraction of hydrocarbons (or &#x201c;production&#x201d;) from the reservoir (<b>102</b>).</p><p id="p-0030" num="0029">In some embodiments, the well system (<b>106</b>) includes a wellbore (<b>120</b>), a well sub-surface system (<b>122</b>), a well surface system (<b>124</b>), and a well control system (&#x201c;control system&#x201d;) (<b>126</b>). The control system (<b>126</b>) may control various operations of the well system (<b>106</b>), such as well production operations, well completion operations, well maintenance operations, as well as reservoir operations including monitoring, assessment and development operations. In some embodiments, the control system (<b>126</b>) includes a computer that is the same as or similar to that of computer system (<b>1302</b>) described below in <figref idref="DRAWINGS">FIG. <b>13</b></figref> and the accompanying description.</p><p id="p-0031" num="0030">The wellbore (<b>120</b>) may include a bore hole that extends from the surface (<b>108</b>) into a target zone of the hydrocarbon-bearing formation (<b>104</b>), such as the reservoir (<b>102</b>). An upper end of the wellbore (<b>120</b>), terminating at or near the surface (<b>108</b>), may be referred to as the &#x201c;up-hole&#x201d; end of the wellbore (<b>120</b>), and a lower end of the wellbore, terminating in the hydrocarbon-bearing formation (<b>104</b>), may be referred to as the &#x201c;down-hole&#x201d; end of the wellbore (<b>120</b>). The wellbore (<b>120</b>) may facilitate the circulation of drilling fluids during drilling operations, the flow of hydrocarbon production (&#x201c;production&#x201d;) (<b>121</b>) (e.g., oil and gas) from the reservoir (<b>102</b>) to the surface (<b>108</b>) during production operations, the injection of substances (e.g., water) into the hydrocarbon-bearing formation (<b>104</b>) or the reservoir (<b>102</b>) during injection operations, or the communication of monitoring devices (e.g., logging tools) into the hydrocarbon-bearing formation (<b>104</b>) or the reservoir (<b>102</b>) during monitoring operations (e.g., during in situ logging operations).</p><p id="p-0032" num="0031">In some embodiments, during operation of the well system (<b>106</b>), the control system (<b>126</b>) collects and records wellhead data (<b>140</b>) for the well system (<b>106</b>). The wellhead data (<b>140</b>) may include, for example, a record of measurements of wellhead pressure (P<sub>wh</sub>) (e.g., including flowing wellhead pressure), wellhead temperature (T<sub>wh</sub>) (e.g., including flowing wellhead temperature), wellhead production rate (Q<sub>wh</sub>) over some or all of the life of the well system (<b>106</b>), and water cut data. In some embodiments, the measurements are recorded in real-time, and are available for review or use within seconds, minutes or hours of the condition being sensed (e.g., the measurements are available within 1 hour of the condition being sensed). In such an embodiment, the wellhead data (<b>140</b>) may be referred to as &#x201c;real-time&#x201d; wellhead data (<b>140</b>). Real-time wellhead data (<b>140</b>) may enable an operator of the well system (<b>106</b>) to assess a relatively current state of the well system (<b>106</b>), and make real-time decisions regarding development of the well system (<b>106</b>) and the reservoir (<b>102</b>), such as on-demand adjustments in regulation of production flow from the well.</p><p id="p-0033" num="0032">In some embodiments, the well surface system (<b>124</b>) includes a wellhead (<b>130</b>). The wellhead (<b>130</b>) may include a rigid structure installed at the &#x201c;up-hole&#x201d; end of the wellbore (<b>120</b>), at or near where the wellbore (<b>120</b>) terminates at the Earth's surface (<b>108</b>). The wellhead (<b>130</b>) may include structures for supporting (or &#x201c;hanging&#x201d;) casing and production tubing extending into the wellbore (<b>120</b>). Production (<b>121</b>) may flow through the wellhead (<b>130</b>), after exiting the wellbore (<b>120</b>) and the well sub-surface system (<b>122</b>), including, for example, the casing and the production tubing. In some embodiments, the well surface system (<b>124</b>) includes flow regulating devices that are operable to control the flow of substances into and out of the wellbore (<b>120</b>). For example, the well surface system (<b>124</b>) may include one or more production valves (<b>132</b>) that are operable to control the flow of production (<b>121</b>). For example, a production valve (<b>132</b>) may be fully opened to enable unrestricted flow of production (<b>121</b>) from the wellbore (<b>120</b>), the production valve (<b>132</b>) may be partially opened to partially restrict (or &#x201c;throttle&#x201d;) the flow of production (<b>121</b>) from the wellbore (<b>120</b>), and production valve (<b>132</b>) may be fully closed to fully restrict (or &#x201c;cell&#x201d;) the flow of production (<b>121</b>) from the wellbore (<b>120</b>), and through the well surface system (<b>124</b>).</p><p id="p-0034" num="0033">Keeping with <figref idref="DRAWINGS">FIG. <b>1</b></figref>, in some embodiments, the well surface system (<b>124</b>) includes a surface sensing system (<b>134</b>). The surface sensing system (<b>134</b>) may include sensors for sensing characteristics of substances, including production (<b>121</b>), passing through or otherwise located in the well surface system (<b>124</b>). The characteristics may include, for example, pressure, temperature, and flow rate of production (<b>121</b>) flowing through the wellhead (<b>130</b>), or other conduits of the well surface system (<b>124</b>), after exiting the wellbore (<b>120</b>).</p><p id="p-0035" num="0034">In some embodiments, the surface sensing system (<b>134</b>) includes a surface pressure sensor (<b>136</b>) operable to sense the pressure of production (<b>151</b>) flowing through the well surface system (<b>124</b>), after it exits the wellbore (<b>120</b>). The surface pressure sensor (<b>136</b>) may include, for example, a wellhead pressure sensor that senses a pressure of production (<b>121</b>) flowing through or otherwise located in the wellhead (<b>130</b>). In some embodiments, the surface sensing system (<b>134</b>) includes a surface temperature sensor (<b>138</b>) operable to sense the temperature of production (<b>151</b>) flowing through the well surface system (<b>124</b>) after it exits the wellbore (<b>120</b>). The surface temperature sensor (<b>138</b>) may include, for example, a wellhead temperature sensor that senses a temperature of production (<b>121</b>) flowing through or otherwise located in the wellhead (<b>130</b>), referred to as &#x201c;wellhead temperature&#x201d; (T<sub>WH</sub>). In some embodiments, the surface sensing system (<b>134</b>) includes a flow rate sensor (<b>139</b>) operable to sense the flow rate of production (<b>151</b>) flowing through the well surface system (<b>124</b>), after it exits the wellbore (<b>120</b>). The flow rate sensor (<b>139</b>) may include hardware that senses a flow rate of production (<b>121</b>) (Q<sub>WH</sub>) passing through the wellhead (<b>130</b>).</p><p id="p-0036" num="0035">In some embodiments, the well system (<b>106</b>) includes a reservoir simulator (<b>160</b>). For example, the reservoir simulator (<b>160</b>) may include hardware and/or software with functionality for generating one or more reservoir models regarding the hydrocarbon-bearing formation (<b>104</b>) and/or performing one or more reservoir simulations. For example, the reservoir simulator (<b>160</b>) may store well logs and data regarding core samples for performing simulations. A reservoir simulator may further analyze the well log data, the core sample data, seismic data, and/or other types of data to generate and/or update the one or more reservoir models. While the reservoir simulator (<b>160</b>) is shown at a well site, embodiments are contemplated where reservoir simulators are located away from well sites. In some embodiments, the reservoir simulator (<b>160</b>) may include a computer system that is similar to the computer system (<b>1302</b>) described below with regard to <figref idref="DRAWINGS">FIG. <b>13</b></figref> and the accompanying description.</p><p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. <b>2</b>A</figref> shows a schematic diagram in accordance with one or more embodiments. <figref idref="DRAWINGS">FIG. <b>2</b>A</figref> shows a geological region (<b>200</b>) that may include one or more hydrocarbon reservoir regions (e.g., reservoir region (<b>230</b>)) with various production wells (e.g., production well A (<b>211</b>), production well (<b>212</b>)). For example, a production well may be similar to the well system (<b>106</b>) described above in <figref idref="DRAWINGS">FIG. <b>1</b></figref> and the accompanying description. Hydrocarbons, such as oil, gas, or a combination of both, may be produced from hydrocarbon reservoir through the production wells. The hydrocarbon may then transported to a primary processing facility, such as a gas-oil separation plant (&#x201c;GOSP&#x201d;) via surface pipelines (not shown) or stored in tanks (not shown) near the production wells for later transportation by tanker trucks.</p><p id="p-0038" num="0037">Likewise, a reservoir region may also include one or more injection wells (e.g., injection well C (<b>216</b>)) that include functionality for enhancing production by one or more neighboring production wells. Production may be enhanced by injection fluid, such as water, from pumping systems (e.g., pumping system (<b>250</b>)) through the injection wells into the hydrocarbon reservoir. The injected fluid may be wastewater from a GOSP or drawn from nearby aquifers and may enhance production by increasing or maintaining the fluid pressure in the reservoir and/or by pushing the hydrocarbon through the hydrocarbon reservoir towards the production wells.</p><p id="p-0039" num="0038">As shown in <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>, wells may be disposed in the reservoir region (<b>230</b>) above various subsurface layers (e.g., subsurface layer A (<b>241</b>), subsurface layer B (<b>242</b>)), which may include hydrocarbon deposits. In particular, production data and/or injection data may exist for a particular well, where production data may include data that describes production or production operations at a well, such as wellhead data (<b>142</b>) described in <figref idref="DRAWINGS">FIG. <b>1</b></figref> and the accompanying description.</p><p id="p-0040" num="0039">Pumping systems may pump fluid according to a schedule defined in a hydrocarbon reservoir production plan. Similarly, productions well may be produced at flow rates determined by the hydrocarbon reservoir production plan. In some cases, additional production and/or injection wells may be drilled according to the hydrocarbon reservoir production plan. The hydrocarbon reservoir production plan may be formed based on data about the reservoir, such as seismic data and well log data, and on production and injection data recorded over the lifetime of the hydrocarbon reservoir. A reservoir simulator (<b>160</b>) may use the reservoir data arranged on a reservoir grid model, production data, and injection data to predict the future performance of the reservoir, such as expected production rates, and to simulate various future scenarios. For example, the reservoir simulator (<b>160</b>) may predict the future production of a new production well drilled at a future data, or the effect on the production of all the production wells caused by increasing fluid injection rate at one or more injection wells. Further, the reservoir simulator may predict the reservoir pressure as a function of position within the reservoir and time. This information may be critical in understanding the behavior or condensate or wet gas reservoirs and understanding when oil condensate with form as the reservoir pressure falls. These scenarios may be used by reservoir engineers managing hydrocarbon to form the hydrocarbon reservoir production plan.</p><p id="p-0041" num="0040">In accordance with one or more embodiments, <figref idref="DRAWINGS">FIG. <b>2</b>B</figref> shows a reservoir grid model (<b>290</b>) that corresponds to the geological region (<b>200</b>) from <figref idref="DRAWINGS">FIG. <b>2</b>A</figref>. More specifically, the reservoir grid model (<b>290</b>) includes grid cells (<b>261</b>) that may refer to a coarse grid cell (<b>262</b>) of a reservoir grid model as well as fine grid cells (<b>263</b>) that may refer to a subdivision of coarse grid cells (<b>262</b>) of the reservoir grid model (<b>290</b>). For example, if a coarse grid cell (<b>262</b>) may be of size 1&#xd7;1, the fine grid cells (<b>263</b>) may be of sizes &#xbd;&#xd7;&#xbd;, &#xbc;&#xd7;&#xbc;, or &#x215b;&#xd7;&#x215b;. Grid cells (<b>261</b>), fine grid cells (<b>263</b>), and the coarse grid cells (<b>262</b>) may correspond to columns for multiple model layers (<b>260</b>) within the reservoir grid model (<b>290</b>). The grid cells (<b>261</b>), coarse grid cells (<b>262</b>) and fine grid cells (<b>263</b>) may or may not be cubic. Typically, the size of the grid cells in the horizontal directions and much greater than the size of the grid cells in the vertical direction.</p><p id="p-0042" num="0041">Predicting the performance of a condensate or wet gas reservoir is of paramount interest for gas producers. Generally, reservoir simulators are used to predict the gas production rates from the wells. For a reliable prediction of the gas production rate, it is critical for the simulator to model the liquid drop-out process properly. To achieve this, reservoir simulators with capable of having a full description of the fluid composition and very fine grid cells around the wellbore may be required. The size of these very fine grid cells may be of the order of a few feet. As a result, the computation times required to complete the simulation may frequently be impractical.</p><p id="p-0043" num="0042">In practice, models composed of coarse grid cells, with horizontal sizes on the order of hundreds of feet, may be used to simulate models covering the full reservoir and containing many wellbores. These models are computationally tractable but cannot accurately calculate low pressures and steep pressure gradients around the wellbores. Consequently, these models typically fail to simulate liquid drop-out around the wellbores accurately and consequently often over-predict gas production rates.</p><p id="p-0044" num="0043">In accordance with one or more embodiments, a hydrocarbon reservoir may be composed of a porous and permeable rock, a mobile non-ideal gas that may flow though the rock, and immobile liquids whose flow through the rock is negligible compared to the gas. To model the behavior of such a hydrocarbon reservoir a multiphase multi-component simulator may be required. In the vicinity of a producing gas well the flow of gas may be described by the following nonlinear partial differential equation with the associated boundary and initial condition:</p><p id="p-0045" num="0000"><maths id="MATH-US-00001" num="00001"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>j</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <msub>         <mi>n</mi>         <mi>p</mi>        </msub>       </msubsup>       <mrow>        <mrow>         <mo>&#x2207;</mo>         <mo>.</mo>         <mfrac>          <msub>           <mi>n</mi>           <mrow>            <mi>i</mi>            <mo>,</mo>            <mi>j</mi>           </mrow>          </msub>          <msub>           <mi>N</mi>           <mi>j</mi>          </msub>         </mfrac>        </mrow>        <mo>&#x2062;</mo>        <msub>         <mi>&#x3c1;</mi>         <mi>j</mi>        </msub>        <mo>&#x2062;</mo>        <msub>         <mi>&#x3bb;</mi>         <mi>j</mi>        </msub>        <mo>&#x2062;</mo>        <mi>K</mi>        <mo>&#x2062;</mo>        <mrow>         <mo>&#x2207;</mo>         <msub>          <mi>&#x3a6;</mi>          <mi>j</mi>         </msub>        </mrow>       </mrow>      </mrow>      <mo>+</mo>      <msub>       <mi>q</mi>       <mi>i</mi>      </msub>     </mrow>     <mo>=</mo>     <mfrac>      <mrow>       <mo>&#x2202;</mo>       <msub>        <mi>n</mi>        <mi>i</mi>       </msub>      </mrow>      <mrow>       <mo>&#x2202;</mo>       <mi>t</mi>      </mrow>     </mfrac>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mrow>      <mo>(</mo>      <mn>1</mn>      <mo>)</mo>     </mrow>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0046" num="0000">where &#x3a6;<sub>j </sub>is the fluid potential for the j-th fluid phase:</p><p id="p-0047" num="0000"><maths id="MATH-US-00002" num="00002"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msub>      <mi>&#x3a6;</mi>      <mi>j</mi>     </msub>     <mo>=</mo>     <mrow>      <msub>       <mi>p</mi>       <mi>j</mi>      </msub>      <mo>-</mo>      <mrow>       <mfrac>        <mi>g</mi>        <msub>         <mi>g</mi>         <mi>c</mi>        </msub>       </mfrac>       <mo>&#x2062;</mo>       <mrow>        <msub>         <mover>          <mi>&#x3c1;</mi>          <mo>_</mo>         </mover>         <mi>j</mi>        </msub>        <mo>(</mo>        <mrow>         <mi>z</mi>         <mo>-</mo>         <msub>          <mi>z</mi>          <mi>ref</mi>         </msub>        </mrow>        <mo>)</mo>       </mrow>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mrow>      <mo>(</mo>      <mn>2</mn>      <mo>)</mo>     </mrow>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0048" num="0000">and p<sub>j </sub>is the pressure for the j-th fluid phase (j enumerates oil, water,or gas), n<sub>p </sub>is the number of fluid phases, n<sub>i,j </sub>is the total number of moles of the i-th component in j-th fluid phase. N<sub>j </sub>is the total number of moles in the j-th fluid phase, &#x3c1;<sub>j </sub>is the molar density of the j-th fluid phase, K is the absolute permeability tensor, and q<sub>i </sub>is the production or injection rate of the i-th component into the reservoir. &#x2207;. is the divergence operator, &#x2207; is the gradient operator, and t is time.</p><p id="p-0049" num="0044">The phase mobility of the j-th fluid phase, &#x3bb;<sub>j</sub>, may be determined by:</p><p id="p-0050" num="0000"><maths id="MATH-US-00003" num="00003"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msub>      <mi>&#x3bb;</mi>      <mi>j</mi>     </msub>     <mo>=</mo>     <mfrac>      <msub>       <mi>k</mi>       <mrow>        <mi>r</mi>        <mo>,</mo>        <mi>j</mi>       </mrow>      </msub>      <msub>       <mi>&#x3bc;</mi>       <mi>j</mi>      </msub>     </mfrac>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mrow>      <mo>(</mo>      <mn>3</mn>      <mo>)</mo>     </mrow>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0051" num="0000">where k<sub>r,j </sub>is the relative permeability and &#x3bc;<sub>j </sub>is the viscosity of the j-th fluid phase. The total number of moles in the j-th fluid phase, N<sub>j</sub>, is given by:</p><p id="p-0052" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>N<sub>j</sub>=&#x3a3;<sub>i=1</sub><sup>n</sup><sup><sub2>c</sub2></sup>n<sub>i,j </sub>&#x2003;&#x2003;Equation (4)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0053" num="0000">where n<sub>c </sub>is the number of components in the j-th fluid phase.</p><p id="p-0054" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>f<sup>j</sup><sub>i</sub>(n<sub>i</sub>, p<sub>j</sub>, T)=f<sup>j&#x2032;</sup><sub>i</sub>(n<sub>i</sub>, p<sub>j&#x2032;</sub>, T). &#x2003;&#x2003;Equation (5)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0055" num="0045">The pore volume (of a reservoir grid cell) may be determined by:</p><p id="p-0056" num="0000"><maths id="MATH-US-00004" num="00004"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msub>      <mi>V</mi>      <mi>p</mi>     </msub>     <mo>=</mo>     <mrow>      <msubsup>       <mo>&#x2211;</mo>       <mrow>        <mi>j</mi>        <mo>=</mo>        <mn>1</mn>       </mrow>       <msub>        <mi>n</mi>        <mi>p</mi>       </msub>      </msubsup>      <mfrac>       <msub>        <mi>N</mi>        <mi>j</mi>       </msub>       <msub>        <mi>&#x3c1;</mi>        <mi>j</mi>       </msub>      </mfrac>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mrow>      <mo>(</mo>      <mn>6</mn>      <mo>)</mo>     </mrow>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0057" num="0000">where &#x3c1;<sub>j </sub>is the density of the i-th component:</p><p id="p-0058" num="0000"><maths id="MATH-US-00005" num="00005"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msub>      <mi>&#x3c1;</mi>      <mi>j</mi>     </msub>     <mo>=</mo>     <mrow>      <msubsup>       <mo>&#x2211;</mo>       <mrow>        <mi>i</mi>        <mo>=</mo>        <mn>1</mn>       </mrow>       <msub>        <mi>n</mi>        <mi>c</mi>       </msub>      </msubsup>      <mrow>       <mfrac>        <msub>         <mi>n</mi>         <mrow>          <mi>i</mi>          <mo>,</mo>          <mi>j</mi>         </mrow>        </msub>        <msub>         <mi>N</mi>         <mi>j</mi>        </msub>       </mfrac>       <mo>&#x2062;</mo>       <mrow>        <msub>         <mi>&#x3c1;</mi>         <mi>i</mi>        </msub>        <mo>.</mo>       </mrow>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mrow>      <mo>(</mo>      <mn>7</mn>      <mo>)</mo>     </mrow>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0059" num="0000">the viscosity of the j-th fluid phase:</p><p id="p-0060" num="0000"><maths id="MATH-US-00006" num="00006"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <msub>       <mi>&#x3bc;</mi>       <mi>j</mi>      </msub>      <mo>=</mo>      <mrow>       <msubsup>        <mo>&#x2211;</mo>        <mrow>         <mi>i</mi>         <mo>=</mo>         <mn>1</mn>        </mrow>        <msub>         <mi>n</mi>         <mi>c</mi>        </msub>       </msubsup>       <mrow>        <mfrac>         <msub>          <mi>n</mi>          <mrow>           <mi>i</mi>           <mo>,</mo>           <mi>j</mi>          </mrow>         </msub>         <msub>          <mi>N</mi>          <mi>j</mi>         </msub>        </mfrac>        <mo>&#x2062;</mo>        <msub>         <mi>&#x3bc;</mi>         <mi>i</mi>        </msub>       </mrow>      </mrow>     </mrow>     <mo>,</mo>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mrow>      <mo>(</mo>      <mn>8</mn>      <mo>)</mo>     </mrow>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0061" num="0000">and N<sub>i </sub>is the total number of moles of the i-th component:</p><p id="p-0062" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>N<sub>i</sub>=&#x3a3;<sub>j=1</sub><sup>n</sup><sup><sub2>p</sub2></sup>n<sub>i,j</sub>. &#x2003;&#x2003;Equation (9)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0063" num="0000">The capillary pressure between the j-th and the j&#x2032;-th phase, for j&#x2260;j&#x2032; is given by:</p><p id="p-0064" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i><sub>cj,j&#x2032;</sub><i>=p</i><sub>j</sub><i>&#x2212;p</i><sub>j&#x2032;</sub>&#x2003;&#x2003;Equation (10)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0065" num="0000">and the phase saturation for the j-th phase is:</p><p id="p-0066" num="0000"><maths id="MATH-US-00007" num="00007"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msub>      <mi>S</mi>      <mi>j</mi>     </msub>     <mo>=</mo>     <mrow>      <mfrac>       <mfrac>        <msub>         <mi>N</mi>         <mi>j</mi>        </msub>        <msub>         <mi>&#x3c1;</mi>         <mi>j</mi>        </msub>       </mfrac>       <mrow>        <msubsup>         <mo>&#x2211;</mo>         <mrow>          <mi>j</mi>          <mo>=</mo>          <mn>1</mn>         </mrow>         <msub>          <mi>n</mi>          <mi>p</mi>         </msub>        </msubsup>        <mfrac>         <msub>          <mi>N</mi>          <mi>j</mi>         </msub>         <msub>          <mi>&#x3c1;</mi>          <mi>j</mi>         </msub>        </mfrac>       </mrow>      </mfrac>      <mo>.</mo>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mrow>      <mo>(</mo>      <mn>11</mn>      <mo>)</mo>     </mrow>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0067" num="0046">In accordance with one or more embodiments, to solve equations (1)-(11) boundary conditions may be defined. An initial boundary condition may specify a partial pressure for each fluid phase as a function of position:</p><p id="p-0068" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>p<sub>j</sub>(x, y, z, 0)=g<sub>j</sub>(x, y, z) &#x2003;&#x2003;Equation (12)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0069" num="0000">where x, y, and z are spatial coordinates and g<sub>j </sub>may allow, for example, for the gas partial pressure to be larger at the top of the reservoir and the water partial pressure to be larger at the bottom of the reservoir.</p><p id="p-0070" num="0047">Further, in accordance with one or more embodiments, boundary conditions for any producing or injecting well may be specified. For example, the gradient of pressure normal to the reservoir domain boundary, &#x2202;&#x3a9;, may be taken to be zero:</p><p id="p-0071" num="0000"><maths id="MATH-US-00008" num="00008"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mrow>      <mfrac>       <mrow>        <mo>&#x2202;</mo>        <mi>p</mi>       </mrow>       <mrow>        <mo>&#x2202;</mo>        <mover>         <mi>s</mi>         <semantics definitionURL="">          <mo>&#x2192;</mo>          <annotation encoding="Mathematica">"\[Rule]"</annotation>         </semantics>        </mover>       </mrow>      </mfrac>      <mo>=</mo>      <mn>0</mn>     </mrow>     <mo>,</mo>     <mrow>      <mi>on</mi>      <mo>&#x2062;</mo>      <mtext>   </mtext>      <mrow>       <mo>&#x2202;</mo>       <mi>&#x3a9;</mi>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mrow>      <mo>(</mo>      <mn>13</mn>      <mo>)</mo>     </mrow>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0072" num="0000">or or the pressure may be assumed to be constant on the boundary of the reservoir domain, &#x3a9;:</p><p id="p-0073" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?>p=p<sub>B</sub>, on &#x2202;&#x3a9;&#x2003;&#x2003;Equation (14)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0074" num="0000">where {right arrow over (s)} is the unit area vector normal to the boundary &#x2202;&#x3a9; and the p<sub>B </sub>is a specified boundary pressure.</p><p id="p-0075" num="0048">In accordance with one or more embodiments, equations (1)-(14) are solved to find the unknown pressure of the i-th phase, p<sub>j</sub>(x, y, z, t) and the unknown molar volume of the i-th component, n<sub>i</sub>(x, y, z, t), as a function of space and time, t&#x3f5;[0, T] where T is the total production time simulated. To solve the equations (1)-(14) for the unknowns the reservoir domain may be discretized into sub-domains (grid cells (<b>261</b>)) and the simulation time duration between [0, T] may be divided into sub-elements, &#x394;t. In some embodiments, &#x394;t may be constant and in other embodiments, &#x394;t may vary with throughout the simulation time. The discretization may result in a set of discrete nonlinear first-order differential equations. In accordance with one or more embodiments, the discrete system may be linearized and solved for any simulation time interval [0, T] using a nonlinear iterative scheme. This iterative solution may result in pressure, and molar distribution within the reservoir at any time within the simulation time interval [0, T]. The result of solving equations (1)-(14) for the production time interval [0, T] may be referred to as a multiphase multi-component simulation.</p><p id="p-0076" num="0049">In accordance with one or more embodiments the multiphase multi-component simulation may be performed using a coarse grid model spanning the whole, or a large portion, of the hydrocarbon reservoir. The coarse grid model may have coarse grid cells (<b>262</b>) that are of the order of hundreds of feet in horizontal extent although they may be much thinner in the vertical direction. Such a coarse grid model may be computationally tractable but may give unreliable or inaccurate results close to a production well (e.g., production well A (<b>211</b>) and production well B (<b>212</b>)) or an injection well (e.g., injection well C (<b>216</b>)). Never-the-less, the multiphase multi-component simulation may provide an estimate of the shape and position of isobars within a reservoir model.</p><p id="p-0077" num="0050">In some embodiments, an initial grid geometry may be defined around a trajectory of wellbore in the reservoir model. The initial grid geometry may be selected to be conformal to the isobars calculated by the coarse-grid simulation in the vicinity of a wellbore trajectory. One horizontal axis of the conformal to initial grid geometry may be parallel to the isobars and the second horizontal axis of the initial grid geometry may be orthogonal to the isobar (or equivalently parallel to the streamlines calculated by the coarse grid close to the wellbore trajectory.</p><p id="p-0078" num="0051">In other embodiments, the initial grid geometry around a trajectory of wellbore in the reservoir model may be determined using an a priori approximation. For example, it is well known that for a vertical wellbore penetrating a homogeneous reservoir the isobars form concentric circles in the horizontal plane with the centers of the circles coincident with the center of the wellbore and the streamlines extend radially away from the wellbore. In contrast, for a horizontal wellbore the isobars may approximate ellipses in the horizontal plane with the streamlines everywhere locally orthogonal to the ellipses. Similarly, for a vertical wellbore in fluid communication with a highly permeable vertical fracture the isobars may approximate ellipses surrounding the vertical fracture in the horizontal plane with the streamlines everywhere locally orthogonal to the ellipses. Although in heterogeneous reservoirs, the isobars and streamlines may not form perfect geometrical figures, i.e., circles or ellipses, even in heterogenous reservoirs geometrical figures may be a better approximation to the isobars and streamlines than can be achieved with cartesian coordinate axes. In these cases, a first horizontal axis of the model grid may be chosen to be conformal to ellipses and a second horizontal axis of the model grid may be conformal to the direction orthogonal to the ellipses.</p><p id="p-0079" num="0052"><figref idref="DRAWINGS">FIG. <b>3</b>A</figref>, in accordance with one or more embodiments, depicts three isobars (<b>302</b><i>a</i>, <b>302</b><i>b</i>, <b>302</b><i>c</i>) surrounding a horizontal wellbore (<b>306</b>). In some embodiments there may be more than three isobars and in other embodiments there may be fewer without departing from the scope of the invention. In some embodiments, the isobars (<b>302</b><i>a</i>, <b>302</b><i>b</i>, <b>302</b><i>c</i>) may be ellipses. A streamline (<b>310</b>) intersects the outermost isobar (<b>302</b><i>c</i>) at a 90-degree angle at a point (<b>312</b><i>c</i>). The same streamline (<b>310</b>) intersects the middle isobar (<b>302</b><i>b</i>) at a 90-degree angle at a point (<b>312</b><i>b</i>) and the innermost isobar (<b>302</b><i>a</i>) at a 90-degree angle at a point (<b>312</b><i>a</i>). The streamline (<b>310</b>) represents the path that fluid beginning at point (<b>312</b><i>c</i>) would follow if fluid were being produced from the reservoir at the horizontal wellbore (<b>304</b>) and the reservoir was homogeneous.</p><p id="p-0080" num="0053">In accordance with some embodiments, an elliptical isobar may be described by</p><p id="p-0081" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>ax</i><sup>2</sup><i>+by</i><sup>2</sup><i>+cxy+dx+ey=f </i>&#x2003;&#x2003;Equation (15)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0082" num="0000">where x and y represent the horizontal cartesian coordinates of points on the isobar and f is the pressure value on the isobar. The coefficients a, b, c, d, and e may be estimated from a cartesian grid solution to Equations (1)-(14), or for an isolated well in a homogeneous reservoir from an analytic solution.</p><p id="p-0083" num="0054">In accordance with one or more embodiments, a streamline may be determined starting from the point (<b>312</b><i>c</i>). For example, the slope of isobar (<b>302</b><i>c</i>) may be written as:</p><p id="p-0084" num="0000"><maths id="MATH-US-00009" num="00009"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mfrac>      <mi>dy</mi>      <mi>dx</mi>     </mfrac>     <mo>=</mo>     <mrow>      <mo>-</mo>      <mfrac>       <mrow>        <mrow>         <mn>2</mn>         <mo>&#x2062;</mo>         <mi>ax</mi>        </mrow>        <mo>+</mo>        <mi>cy</mi>        <mo>+</mo>        <mi>d</mi>       </mrow>       <mrow>        <mi>cx</mi>        <mo>+</mo>        <mrow>         <mn>2</mn>         <mo>&#x2062;</mo>         <mi>by</mi>        </mrow>        <mo>+</mo>        <mi>e</mi>       </mrow>      </mfrac>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mrow>      <mo>(</mo>      <mn>16</mn>      <mo>)</mo>     </mrow>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0085" num="0000">and using the fact that the scalar product of two orthogonal lines is equal to &#x2212;1 to obtain:</p><p id="p-0086" num="0000"><maths id="MATH-US-00010" num="00010"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <mfrac>      <msub>       <mi>dy</mi>       <mi>s</mi>      </msub>      <mi>dx</mi>     </mfrac>     <mo>=</mo>     <mfrac>      <mrow>       <mi>cx</mi>       <mo>+</mo>       <mrow>        <mn>2</mn>        <mo>&#x2062;</mo>        <msub>         <mi>by</mi>         <mi>s</mi>        </msub>       </mrow>       <mo>+</mo>       <mi>e</mi>      </mrow>      <mrow>       <mrow>        <mn>2</mn>        <mo>&#x2062;</mo>        <mi>ax</mi>       </mrow>       <mo>+</mo>       <msub>        <mi>cy</mi>        <mi>s</mi>       </msub>       <mo>+</mo>       <mi>d</mi>      </mrow>     </mfrac>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mrow>      <mo>(</mo>      <mn>17</mn>      <mo>)</mo>     </mrow>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0087" num="0000">where y<sub>s </sub>is the y-coordinate of the streamline (<b>310</b>) at the point (<b>312</b><i>c</i>). Thus, the equation for this orthogonal streamline may be written as:</p><p id="p-0088" num="0000"><maths id="MATH-US-00011" num="00011"><math overflow="scroll"> <mtable>  <mtr>   <mtd>    <mrow>     <msub>      <mi>y</mi>      <mi>s</mi>     </msub>     <mo>=</mo>     <mrow>      <msub>       <mi>y</mi>       <mi>c</mi>      </msub>      <mo>+</mo>      <mrow>       <mfrac>        <msub>         <mi>dy</mi>         <mi>s</mi>        </msub>        <mi>dx</mi>       </mfrac>       <mo>&#x2062;</mo>       <mrow>        <mo>(</mo>        <mrow>         <msub>          <mi>x</mi>          <mi>s</mi>         </msub>         <mo>-</mo>         <msub>          <mi>x</mi>          <mi>c</mi>         </msub>        </mrow>        <mo>)</mo>       </mrow>      </mrow>     </mrow>    </mrow>   </mtd>   <mtd>    <mrow>     <mi>Equation</mi>     <mo>&#x2062;</mo>     <mtext>   </mtext>     <mrow>      <mo>(</mo>      <mn>18</mn>      <mo>)</mo>     </mrow>    </mrow>   </mtd>  </mtr> </mtable></math></maths></p><p id="p-0089" num="0055">Where x<sub>s </sub>is the x-coordinate of points on the streamline, and x<sub>c </sub>and y<sub>c </sub>are the coordinates of point (<b>312</b><i>c</i>).</p><p id="p-0090" num="0056">In accordance with one or more embodiments, the intersection point (<b>314</b><i>b</i>) of the line given by Equation (18) and the isobar (<b>302</b><i>b</i>) may now be determined by solving Equation (18) and:</p><p id="p-0091" num="0000"><br/><?in-line-formulae description="In-line Formulae" end="lead"?><i>ax</i><sup>2</sup><i>+by</i><sup>2</sup><i>+cxy+dx+ey=f</i><sub>b </sub>&#x2003;&#x2003;Equation (19)<?in-line-formulae description="In-line Formulae" end="tail"?></p><p id="p-0092" num="0000">as shown in <figref idref="DRAWINGS">FIG. <b>3</b>B</figref> and where f<sub>b </sub>defines the pressure on isobar (<b>302</b><i>b</i>). Note, intersection point (<b>314</b><i>b</i>) is an approximate determination of the point (<b>312</b><i>b</i>) where the streamline (<b>310</b>) actually intersects with the isobar (<b>302</b><i>b</i>). The solution of Equation (17) and Equation (18) yields two intersection points (<b>314</b><i>b</i>) and (<b>314</b><i>f</i>) where the line defined by equation (17) intersects the &#x201c;far side&#x201d; of the isobar (<b>302</b><i>b</i>). In accordance with one or more embodiments the selected intersection point is the intersection point that is closest to the point (<b>312</b><i>c</i>).</p><p id="p-0093" num="0057">Constructing a reservoir simulation grid may require the integration of the initial grid geometry around one or more well trajectories with the coarse grid spanning all, or a large portion, of the reservoir. <figref idref="DRAWINGS">FIG. <b>4</b></figref> depicts the integration of an elliptical initial grid geometry with a cartesian coarse grid. The elliptic grid (<b>402</b>) and the associated streamlines (<b>404</b>) are centered on a horizontal well (<b>408</b>). The interval between the streamlines (<b>404</b>) may be called stream-tube grids (<b>406</b>), in accordance with one or more embodiments. To generate such a grid a reference coordinate system is first selected. For example, in <figref idref="DRAWINGS">FIG. <b>4</b></figref> the straight, horizontal well (<b>408</b>) defines the x-axis and the center of the horizontal well (<b>410</b>) is taken as the x=y=0 origin. Next, the number of ellipses is selected. In <figref idref="DRAWINGS">FIG. <b>4</b></figref> three ellipses are selected. In accordance with some embodiments, ellipses may be chosen by fitting equation (<b>15</b>) to the pressure contours computed by a coarse grid simulator. In accordance with other embodiments, the isobar can be obtained by solving a Poisson equation for pressure equation around the well using a steady state assumption.</p><p id="p-0094" num="0058"><figref idref="DRAWINGS">FIG. <b>4</b></figref> further depicts, in accordance with one or more embodiments, a bounding box (<b>412</b>). The bounding box (<b>412</b>) encloses outer most ellipse such that the edges of the bounding box (<b>412</b>) are tangent to the outermost ellipse at the points x=0 and y=0. In some embodiments, the nodes on the outermost ellipse that may form the starting point of each streamline (<b>414</b>) may be determined by where the x=constant lines (<b>416</b>) that define the coarse modeling grid (<b>418</b>) outside the bounding box (<b>412</b>) intersect the outermost ellipse. Equally, in other embodiments the intersection of the y=constant lines may determine the starting point of each streamline.</p><p id="p-0095" num="0059">In one or more embodiments, this approach to gridding the area within the bounding box (<b>412</b>) but outside the outermost ellipses may result in an irregular transitional grid, as depicted in <figref idref="DRAWINGS">FIG. <b>4</b></figref>. The transitional grid may have cells with 3 corners or 5 corners, but typically this may be accommodated by reservoir simulation algorithms that routinely use unstructured grid formats.</p><p id="p-0096" num="0060"><figref idref="DRAWINGS">FIG. <b>5</b></figref> shows a flowchart in accordance with one or more embodiments. The flowchart describes the steps that may be taken to define a reservoir simulation grid, simulated fluid flow in the reservoir using the reservoir grid, and form, revise, and execute a reservoir production plan based upon the reservoir simulation.</p><p id="p-0097" num="0061">In Step <b>502</b> a coarse grid model of the hydrocarbon reservoir and a trajectory of a wellbore that penetrates the hydrocarbon reservoir may be obtained. The coarse grid may contain porosity and permeability values for the reservoir rocks and fluid phase and composition values for the fluids within the pores. The coarse grid model may also include the location and trajectories of a plurality of existing or planned wellbores and one or more planned production scenarios. In some embodiments, the coarse grid model may be defined on a cartesian grid.</p><p id="p-0098" num="0062">In Step <b>504</b>, an initial grid geometry surrounding the trajectory may be determined. In some embodiments, the initial grid geometry may be determined, at least in part, from isobars of a coarse-grid simulation. In other embodiments, a first horizontal axis of the initial grid geometry may be an ellipse. In some embodiments, a second horizontal axis of may be locally orthogonal to the first horizontal axis. The initial grid geometry may be determined from numerical or analytical solutions to canonical or simplified models of the reservoir in the vicinity of the segment of the wellbore trajectory within the hydrocarbon reservoir. For example, the reservoir may be assumed to be locally homogeneous in the vicinity of the horizontal wellbore.</p><p id="p-0099" num="0063">In Step <b>506</b>, in accordance with one or more embodiments, a reservoir simulation grid may be constructed. The reservoir simulation grid may be constructed to be conformal to the initial grid geometry in a first region in a vicinity of the wellbore and conformal with the coarse grid model in a second region more distant from the wellbore than the first region. The boundaries of cells of the reservoir simulation grid near the wellbore may be exactly, or approximately, coincident with isobars and streamlines of the simulated fluid flow. If the isobar was determined from a numerical or analytic solution to a canonical or simplified model, then the isobar may be an ellipse.</p><p id="p-0100" num="0064">In accordance with one or more embodiments, in Step <b>506</b> the intersection of the outermost, largest ellipse, with the edges of the coarse grid cells having at least one orientation may be determined. For example, in some embodiments the intersection of the largest ellipse with the edges having x=constant may be determined. In other embodiments, the intersection of the largest ellipse with the edges having y=constant may be determined. Alternatively, the intersection of the largest ellipse with the edges running North-South may be determined. A streamline may be determined starting at each of the intersection and crossing each of the concentric ellipses orthogonally.</p><p id="p-0101" num="0065">Stream-tubes may be determined, in accordance with one or more embodiments. Each stream-tube may be bounded on either side by an approximation to adjacent streamlines. The boundary of the stream-tube may be determined by tracing a line orthogonally to the outermost ellipse from an intersection point inward to the point at which the orthogonal line intersects the next largest ellipse. Then the procedure may be repeated iteratively to find the intersection point with the next concentric ellipse.</p><p id="p-0102" num="0066">In accordance with one or more embodiments, in Step <b>508</b> a hydrocarbon reservoir simulation, modeling a flow of fluid in the hydrocarbon reservoir based, at least in part, on the reservoir simulation grid may be performed. The hydrocarbon reservoir simulation may be a multiphase multi-component reservoir simulation and the hydrocarbon reservoir is a wet gas reservoir. The hydrocarbon simulation may include the simulation or modeling of multiple scenarios predicting the effects of changing fluid injection schedules or drilling new production and/or injection wells.</p><p id="p-0103" num="0067">In Step <b>510</b>, a hydrocarbon reservoir development plan may be formed and executed based, at least in part, on the fluid flow simulation results determined in Step <b>508</b>. For example, the critical pressure at which condensates form may be utilized to develop a plan. After discovery and initial appraisal of a hydrocarbon reservoir or field, a hydrocarbon reservoir development plan may be formulated to facilitate the safe and efficient production of hydrocarbons from the reservoir. The plan may include defining the type, size, and location of surface facilities, such as production rigs, pipelines, and GOSPs. The plan may further include the type, surface location, and subsurface trajectory of wellbores, including horizontal wellbores, to be drilled to reach and penetrate the reservoir, and from which to produce hydrocarbons. The plan may also include specifying the type of completions to use, including whether wells should be cased, uncased, or contain slotted liners; whether hydraulic fracturing, acidizing, or both, is utilized, and whether surface or downhole pumps are needed to produce the hydrocarbons. The plan may still further determine whether the injection of fluid, typically water, is required at locations within the reservoir to raise, maintain, or slow the decline in reservoir pressure. Further, the plan may include enhanced recovery methods, such as the injection of water to maintain reservoir pressure above the pressure at which condensates form. The hydrocarbon reservoir development plan may be influenced by the assessment of geological, geographical, and economic factors.</p><p id="p-0104" num="0068">Executing the hydrocarbon reservoir development plan may include carrying out the operations, such as constructing the surface facilities, drilling and completing the wells, pumping the injection fluids, and maintaining the reservoir pressure, specified in the plan. Executing the plan may further include updating the reservoir development plan based on production data and well logging acquired during preceding execution steps.</p><p id="p-0105" num="0069"><figref idref="DRAWINGS">FIGS. <b>6</b>-<b>13</b></figref> show steps and results from an illustrative example of one embodiment. <figref idref="DRAWINGS">FIG. <b>6</b>A</figref> shows a horizontal portion (<b>602</b>) of a wellbore with a length of 1200 feet and a coarse grid reservoir simulation model with coarse grid cell sizes of 400&#xd7;400 feet. In the following, the results generated with the model shown in <figref idref="DRAWINGS">FIG. <b>6</b>A</figref> will be compared and contrasted with the results from a fine grid model shown in <figref idref="DRAWINGS">FIG. <b>6</b>B</figref> and with the results from a combined elliptical and coarse grid simulation. The results generated using the fine grid model shown in <figref idref="DRAWINGS">FIG. <b>6</b>B</figref> may be regarded as the best available estimate of the true or exact result.</p><p id="p-0106" num="0070"><figref idref="DRAWINGS">FIG. <b>7</b>A</figref> shows the fluid pressure distribution in the reservoir after hydrocarbon production from the reservoir for a period of time as predicted using the coarse grid model shown in <figref idref="DRAWINGS">FIG. <b>6</b>A</figref>. In contrast, <figref idref="DRAWINGS">FIG. <b>7</b>B</figref> shows fluid pressure distribution in the reservoir after hydrocarbon production from the reservoir for the same period of time as predicted using the fine grid model shown in <figref idref="DRAWINGS">FIG. <b>6</b>B</figref>. A person of ordinary skill in the art will readily appreciate the differences between the <figref idref="DRAWINGS">FIGS. <b>7</b>A and <b>7</b>B</figref> including the significantly larger zone of greatly decreased pressure shown in <figref idref="DRAWINGS">FIG. <b>7</b>A</figref>. <figref idref="DRAWINGS">FIG. <b>7</b>C</figref> shows both the reservoir simulation grid formed by combining the initial elliptical grid and coarse grid model, and the fluid pressure distribution in the reservoir after hydrocarbon production from the reservoir. <figref idref="DRAWINGS">FIGS. <b>7</b>A-<b>7</b>C</figref> all show the results simulated for the same period of production time. One of ordinary skill in the art will readily appreciate the significantly greater similarity between <figref idref="DRAWINGS">FIGS. <b>7</b>C and <b>7</b>B</figref> than between <figref idref="DRAWINGS">FIGS. <b>7</b>A and <b>7</b>B</figref>.</p><p id="p-0107" num="0071"><figref idref="DRAWINGS">FIGS. <b>8</b>A, <b>8</b>B and <b>8</b>C</figref> show the condensate saturation in the reservoir after hydrocarbon production from the reservoir for the same period of time. <figref idref="DRAWINGS">FIG. <b>8</b>A</figref> shows the prediction formed using the coarse grid model. <figref idref="DRAWINGS">FIG. <b>8</b>B</figref> shows the prediction formed using the fine grid model, and <figref idref="DRAWINGS">FIG. <b>8</b>B</figref> shows the prediction formed using the combined elliptical and coarse grid model. A person of ordinary skill in the art will readily appreciate the significantly greater similarity between <figref idref="DRAWINGS">FIGS. <b>8</b>C and <b>8</b>B</figref> than between <figref idref="DRAWINGS">FIGS. <b>8</b>A and <b>8</b>B</figref>.</p><p id="p-0108" num="0072"><figref idref="DRAWINGS">FIG. <b>9</b></figref> shows the condensate production rate over a four-year simulated production period as predicted using the coarse grid (<b>902</b>), the fine grid (<b>904</b>), the combined elliptical and coarse grid (<b>906</b>) and a modification of the coarse grid with a pseudo-pressure transform (<b>908</b>). It will be readily apparent to one of ordinary skill in the art that the condensate production rate calculated using the combined elliptical and coarse grid (<b>906</b>) is more similar to the condensate production rate calculated using the fine grid (<b>904</b>) than are either of the two methods using the coarse grid (<b>902</b>, <b>908</b>).</p><p id="p-0109" num="0073"><figref idref="DRAWINGS">FIG. <b>10</b></figref> shows the bottom hole pressure over a four-year simulated prediction period as predicted using the coarse grid (<b>1002</b>), the fine grid (<b>1004</b>), the combined elliptical and coarse grid (<b>1006</b>) and a modification of the coarse grid with a pseudo- pressure transform (<b>1008</b>). It will be readily apparent to a person of ordinary skill in the art that the bottom hole pressure predicted using the combined elliptical and coarse grid (<b>1006</b>) is more similar to the condensate production rate calculated using the fine grid (<b>1004</b>) than are either of the two methods using the coarse grid (<b>1002</b>, <b>1008</b>).</p><p id="p-0110" num="0074"><figref idref="DRAWINGS">FIG. <b>11</b></figref> shows the gas production rate over a four-year period as predicted using the coarse grid (<b>1102</b>), the fine grid (<b>1104</b>), the combined elliptical and coarse grid (<b>1106</b>) and a modification of the coarse grid with a pseudo-pressure transform (<b>1108</b>). It will be readily apparent to a person of ordinary skill in the art that the gas production rate predicted using the combined elliptical and coarse grid (<b>1106</b>) is more similar to the condensate production rate calculated using the fine grid (<b>1104</b>) than are either of the two methods using the coarse grid (<b>1102</b>, <b>1108</b>).</p><p id="p-0111" num="0075"><figref idref="DRAWINGS">FIG. <b>12</b></figref> shows the computational time required to generate the results shown in <figref idref="DRAWINGS">FIGS. <b>7</b>-<b>11</b></figref>. Note, the vertical axis (<b>1202</b>) of <figref idref="DRAWINGS">FIG. <b>12</b></figref> is depicted on a logarithmic scale. <figref idref="DRAWINGS">FIG. <b>12</b></figref> indicates, in accordance with one or more embodiments, that the computation time required for the fine grid simulation (<b>1204</b>) is approximately 20 times greater than the computational time than does the coarse grid model (<b>1206</b>), the combined coarse grid and elliptical grid embodiment (<b>1208</b>), or the coarse grid model supplemented by the pseudo-pressure transformation (<b>1210</b>).</p><p id="p-0112" num="0076">Embodiments may be implemented on a computer system using reservoir simulation software stored in non-transitory computer readable media. <figref idref="DRAWINGS">FIG. <b>13</b></figref> is a cell diagram of a computer system (<b>1302</b>) used to provide computational functionalities associated with described algorithms, methods, functions, processes, flows, and procedures as described in the instant disclosure, according to an implementation. The illustrated computer system (<b>1302</b>) is intended to encompass any computing device such as a high-performance computing (HPC) device, server, desktop computer, laptop, notebook computer, wireless data port, smart phone, personal data assistant (PDA), tablet computing device, one or more processors within these devices, or any other suitable processing device, including both physical or virtual instances (or both) of the computing device. Additionally, the computer system (<b>1302</b>) may include a computer that includes an input device, such as a keypad, keyboard, touch screen, or other device that can accept user information, and an output device that conveys information associated with the operation of the computer system (<b>1302</b>), including digital data, visual, or audio information (or a combination of information), or a graphical user interface GUI.</p><p id="p-0113" num="0077">The computer system (<b>1302</b>) can serve in a role as a client, network component, a server, a database or other persistency, or any other component (or a combination of roles) of a computer system for performing the subject matter described in the instant disclosure. The illustrated computer system (<b>1302</b>) is communicably coupled with a network (<b>1330</b>). In some implementations, one or more components of the computer system (<b>1302</b>) may be configured to operate within environments, including cloud-computing-based, local, global, or other environment (or a combination of environments).</p><p id="p-0114" num="0078">At a high level, the computer system (<b>1302</b>) is an electronic computing device operable to receive, transmit, process, store, or manage data and information associated with the described subject matter. According to some implementations, the computer system (<b>1302</b>) may also include or be communicably coupled with an application server, e-mail server, web server, caching server, streaming data server, business intelligence (BI) server, or other server (or a combination of servers).</p><p id="p-0115" num="0079">The computer system (<b>1302</b>) can receive requests over network (<b>1330</b>) from a client application (for example, executing on another computer system (<b>1302</b>)) and responding to the received requests by processing the said requests in an appropriate software application. In addition, requests may also be sent to the computer system (<b>1302</b>) from internal users (for example, from a command console or by other appropriate access method), external or third-parties, other automated applications, as well as any other appropriate entities, individuals, systems, or computers.</p><p id="p-0116" num="0080">Each of the components of the computer system (<b>1302</b>) can communicate using a system bus (<b>1303</b>). In some implementations, any or all of the components of the computer system (<b>1302</b>), both hardware or software (or a combination of hardware and software), may interface with each other or the interface (<b>1304</b>) (or a combination of both) over the system bus (<b>1303</b>) using an application programming interface (API) (<b>1312</b>) or a service layer (<b>1313</b>) (or a combination of the API (<b>1312</b>) and service layer (<b>1313</b>). The API (<b>1312</b>) may include specifications for routines, data structures, and object classes. The API (<b>1312</b>) may be either computer-language independent or dependent and refer to a complete interface, a single function, or even a set of APIs. The service layer (<b>1313</b>) provides software services to the computer system (<b>1302</b>) or other components (whether or not illustrated) that are communicably coupled to the computer system (<b>1302</b>). The functionality of the computer system (<b>1302</b>) may be accessible for all service consumers using this service layer. Software services, such as those provided by the service layer (<b>1313</b>), provide reusable, defined business functionalities through a defined interface. For example, the interface may be software written in JAVA, C++, or other suitable language providing data in extensible markup language (XML) format or another suitable format. While illustrated as an integrated component of the computer system (<b>1302</b>), alternative implementations may illustrate the API (<b>1312</b>) or the service layer (<b>1313</b>) as stand-alone components in relation to other components of the computer system (<b>1302</b>) or other components (whether or not illustrated) that are communicably coupled to the computer system (<b>1302</b>). Moreover, any or all parts of the API (<b>1312</b>) or the service layer (<b>1313</b>) may be implemented as child or sub-modules of another software module, enterprise application, or hardware module without departing from the scope of this disclosure.</p><p id="p-0117" num="0081">The computer system (<b>1302</b>) includes an interface (<b>1304</b>). Although illustrated as a single interface (<b>1304</b>) in <figref idref="DRAWINGS">FIG. <b>13</b></figref>, two or more interfaces (<b>1304</b>) may be used according to particular needs, desires, or particular implementations of the computer system (<b>1302</b>). The interface (<b>1304</b>) is used by the computer system (<b>1302</b>) for communicating with other systems in a distributed environment that are connected to the network (<b>1330</b>). Generally, the interface (<b>1304</b>) includes logic encoded in software or hardware (or a combination of software and hardware) and operable to communicate with the network (<b>1330</b>). More specifically, the interface (<b>1304</b>) may include software supporting one or more communication protocols associated with communications such that the network (<b>1330</b>) or interface's hardware is operable to communicate physical signals within and outside of the illustrated computer system (<b>1302</b>).</p><p id="p-0118" num="0082">The computer system (<b>1302</b>) includes at least one computer processor (<b>1305</b>). Although illustrated as a single computer processor (<b>1305</b>) in <figref idref="DRAWINGS">FIG. <b>13</b></figref>, two or more processors may be used according to particular needs, desires, or particular implementations of the computer system (<b>1302</b>). Generally, the computer processor (<b>1305</b>) executes instructions and manipulates data to perform the operations of the computer system (<b>1302</b>) and any algorithms, methods, functions, processes, flows, and procedures as described in the instant disclosure.</p><p id="p-0119" num="0083">The computer system (<b>1302</b>) also includes a memory (<b>1306</b>) that holds data for the computer system (<b>1302</b>) or other components (or a combination of both) that can be connected to the network (<b>1330</b>). For example, memory (<b>1306</b>) can be a database storing data consistent with this disclosure. Although illustrated as a single memory (<b>1306</b>) in <figref idref="DRAWINGS">FIG. <b>13</b></figref>, two or more memories may be used according to particular needs, desires, or particular implementations of the computer system (<b>1302</b>) and the described functionality. While memory (<b>1306</b>) is illustrated as an integral component of the computer system (<b>1302</b>), in alternative implementations, memory (<b>1306</b>) can be external to the computer system (<b>1302</b>).</p><p id="p-0120" num="0084">The application (<b>1307</b>) is an algorithmic software engine providing functionality according to particular needs, desires, or particular implementations of the computer system (<b>1302</b>), particularly with respect to functionality described in this disclosure. For example, application (<b>1307</b>) can serve as one or more components, modules, applications, etc. Further, although illustrated as a single application (<b>1307</b>), the application (<b>1307</b>) may be implemented as multiple applications (<b>1307</b>) on the computer system (<b>1302</b>). In addition, although illustrated as integral to the computer system (<b>1302</b>), in alternative implementations, the application (<b>1307</b>) can be external to the computer system (<b>1302</b>).</p><p id="p-0121" num="0085">There may be any number of computers associated with, or external to, a computer system containing computer system (<b>1302</b>), each computer communicating over network (<b>1330</b>). Further, the term &#x201c;client,&#x201d; &#x201c;user,&#x201d; and other appropriate terminology may be used interchangeably as appropriate without departing from the scope of this disclosure. Moreover, this disclosure contemplates that many users may use one computer system (<b>1302</b>), or that one user may use multiple computers (<b>1302</b>).</p><p id="p-0122" num="0086"><figref idref="DRAWINGS">FIG. <b>14</b></figref> illustrates a drill system (<b>1400</b>), in accordance with one or more embodiments. A wellbore (<b>1422</b><i>a, b</i>) may be drilled using a drill bit (<b>1404</b>) attached to a drillstring (<b>1406</b>) further attached to a drill rig (<b>1408</b>) located on the surface of the earth (<b>1424</b>). The wellbore (<b>1422</b><i>a, b</i>) may traverse a plurality of overburden layers (<b>1410</b>), one or more cap-rock layers (<b>1412</b>), and geological discontinues (<b>1412</b>) to reach a hydrocarbon reservoir region (<b>230</b>). The wellbore (<b>1422</b><i>a, b</i>) may be drilled according to a wellbore plan along a wellbore trajectory defined in the well plan and may include portions of wellbore that are essentially vertical (<b>1422</b><i>a</i>) and portions of wellbore that are highly deviated or horizontal (<b>1422</b><i>b</i>). In particular, horizontal portions of the wellbore (<b>1422</b><i>b</i>) may be drilled in the hydrocarbon reservoir (<b>230</b>) to maximize the production of hydrocarbons from the wellbore.</p><p id="p-0123" num="0087">In addition to the wellbore trajectory, the well plan may provide for other characteristics of the well. For example, the well plan may provide for the wellbore to be drilled in portions. After drilling each portion the drill bit (<b>1404</b>) and the drillstring (<b>1406</b>) may be withdrawn from the wellbore (<b>1422</b><i>a</i>) by the drill rig (<b>1408</b>) and a &#x201c;casing string&#x201d; (<b>1402</b>) may be lowered into the wellbore (<b>1422</b><i>a</i>) and cemented into place by injecting cement into the annulus (<b>1414</b>) formed between the casing string (<b>1402</b>) and the formation (<b>1410</b>). Casing strings are composed of a plurality of steel pipes casing joints threaded together, where each casing joint is a steel pipe approximately 30 feet long. The casing joints may be screwed together as the casing string is inserted into the wellbore. Once the casing string is cemented in place the drillstring (<b>1406</b>) and the drill bit (<b>1404</b>) may be re-inserted through the central channel of the casing string (<b>1412</b>) and the next portion of the wellbore (<b>1422</b><i>a, b</i>) may be drilled. Typically, each portion of the wellbore (<b>1422</b><i>a</i>) is of a smaller diameter than the previous portion. For example, the first portion of the wellbore (<b>1422</b><i>a</i>) near the surface of the earth may have a diameter of 2 or 3 feet, while the final portion of the wellbore that intersects the hydrocarbon reservoir (<b>1422</b><i>b</i>) may have a diameter of 6 or 8 inches. These diameter values are provided for illustrative purposes only and should not be construed as limiting the scope of the invention in any way.</p><p id="p-0124" num="0088">Once installed, the casing may provide mechanical strength and stability to the wellbore (<b>1422</b><i>a, b</i>), to precent the collapse of overburden layers (<b>1410</b>) and cap-rock layers (<b>1412</b>). Further, casing may isolate fluid in the pores of one overburden layer from the pores in another. In addition, casing may aid in the control of pressure and prevent unwanted fluid flow from pores within a formation into the wellbore (<b>1422</b><i>a, b</i>).</p><p id="p-0125" num="0089">A well plan may be determined by a wellbore planning system composed of a computer system, such as computer system (<b>1302</b>) and appropriate software. The well planning system may take as input a well head on the surface of the earth, a drilling target within the reservoir, the location of drilling hazards (such as shallow gas pockets, pre-existing well trajectory and fault planes), the mechanical limitations of the drill rig and the drillstring (such as the tolerable maximum curvature), and geoscience data such as the expected pore pressure distribution with depth).</p><p id="p-0126" num="0090">Although only a few example embodiments have been described in detail above, those skilled in the art will readily appreciate that many modifications are possible in the example embodiments without materially departing from this invention. Accordingly, all such modifications are intended to be included within the scope of this disclosure as defined in the following claims.</p><?detailed-description description="Detailed Description" end="tail"?></description><us-math idrefs="MATH-US-00001" nb-file="US20230003101A1-20230105-M00001.NB"><img id="EMI-M00001" he="6.35mm" wi="76.20mm" file="US20230003101A1-20230105-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00002" nb-file="US20230003101A1-20230105-M00002.NB"><img id="EMI-M00002" he="5.25mm" wi="76.20mm" file="US20230003101A1-20230105-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00003" nb-file="US20230003101A1-20230105-M00003.NB"><img id="EMI-M00003" he="6.35mm" wi="76.20mm" file="US20230003101A1-20230105-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00004" nb-file="US20230003101A1-20230105-M00004.NB"><img id="EMI-M00004" he="6.35mm" wi="76.20mm" file="US20230003101A1-20230105-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00005" nb-file="US20230003101A1-20230105-M00005.NB"><img id="EMI-M00005" he="5.67mm" wi="76.20mm" file="US20230003101A1-20230105-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00006" nb-file="US20230003101A1-20230105-M00006.NB"><img id="EMI-M00006" he="5.67mm" wi="76.20mm" file="US20230003101A1-20230105-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00007" nb-file="US20230003101A1-20230105-M00007.NB"><img id="EMI-M00007" he="13.38mm" wi="76.20mm" file="US20230003101A1-20230105-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00008" nb-file="US20230003101A1-20230105-M00008.NB"><img id="EMI-M00008" he="6.35mm" wi="76.20mm" file="US20230003101A1-20230105-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00009" nb-file="US20230003101A1-20230105-M00009.NB"><img id="EMI-M00009" he="6.01mm" wi="76.20mm" file="US20230003101A1-20230105-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00010" nb-file="US20230003101A1-20230105-M00010.NB"><img id="EMI-M00010" he="6.35mm" wi="76.20mm" file="US20230003101A1-20230105-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-math idrefs="MATH-US-00011" nb-file="US20230003101A1-20230105-M00011.NB"><img id="EMI-M00011" he="5.67mm" wi="76.20mm" file="US20230003101A1-20230105-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/></us-math><us-claim-statement>What is claimed:</us-claim-statement><claims id="claims"><claim id="CLM-00001" num="00001"><claim-text><b>1</b>. A method of simulating fluid flow in a hydrocarbon reservoir, comprising:<claim-text>obtaining a coarse grid model of the hydrocarbon reservoir and a trajectory of a wellbore that penetrates the hydrocarbon reservoir;</claim-text><claim-text>determining an initial grid geometry surrounding the trajectory;</claim-text><claim-text>constructing a reservoir simulation grid, wherein the reservoir simulation grid is conformal to the initial grid geometry in a first region in a vicinity of the wellbore and conformal with the coarse grid model in a second region more distant from the wellbore than the first region; and</claim-text><claim-text>performing a hydrocarbon reservoir simulation, modeling a flow of fluid in the hydrocarbon reservoir based, at least in part, on the reservoir simulation grid.</claim-text></claim-text></claim><claim id="CLM-00002" num="00002"><claim-text><b>2</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising forming and executing a hydrocarbon reservoir production plan based, at least on part, on the hydrocarbon reservoir simulation.</claim-text></claim><claim id="CLM-00003" num="00003"><claim-text><b>3</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein performing the hydrocarbon reservoir simulation comprises performing a multiphase multi-component reservoir simulation.</claim-text></claim><claim id="CLM-00004" num="00004"><claim-text><b>4</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the hydrocarbon reservoir is a wet gas reservoir.</claim-text></claim><claim id="CLM-00005" num="00005"><claim-text><b>5</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the initial grid geometry is determined, at least in part, from isobars of a coarse-grid simulation.</claim-text></claim><claim id="CLM-00006" num="00006"><claim-text><b>6</b>. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein a first horizontal axis of the initial grid geometry comprises an ellipse.</claim-text></claim><claim id="CLM-00007" num="00007"><claim-text><b>7</b>. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein a second horizontal axis of the initial grid geometry is locally orthogonal to the ellipse.</claim-text></claim><claim id="CLM-00008" num="00008"><claim-text><b>8</b>. A non-transitory computer readable medium storing instructions executable by a computer processor, the instructions comprising functionality for:<claim-text>obtaining a coarse grid model of a hydrocarbon reservoir and a trajectory of a wellbore that penetrates the hydrocarbon reservoir;</claim-text><claim-text>determining an initial grid geometry surrounding the trajectory;</claim-text><claim-text>constructing a reservoir simulation grid, wherein the reservoir simulation grid is conformal to the initial grid geometry in a first region in a vicinity of the wellbore and conformal with the coarse grid model in a second region more distant from the wellbore than the first region; and</claim-text><claim-text>performing a hydrocarbon reservoir simulation, modeling a flow of fluid in the hydrocarbon reservoir based, at least in part, on the reservoir simulation grid.</claim-text></claim-text></claim><claim id="CLM-00009" num="00009"><claim-text><b>9</b>. The non-transitory computer readable medium of <claim-ref idref="CLM-00008">claim 8</claim-ref>, further comprising instructions for forming a hydrocarbon reservoir production plan based, at least on part, on the hydrocarbon reservoir simulation.</claim-text></claim><claim id="CLM-00010" num="00010"><claim-text><b>10</b>. The non-transitory computer readable medium of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein performing the hydrocarbon reservoir simulation comprises performing a multiphase multi-component reservoir simulation.</claim-text></claim><claim id="CLM-00011" num="00011"><claim-text><b>11</b>. The non-transitory computer readable medium of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the hydrocarbon reservoir is a wet gas reservoir.</claim-text></claim><claim id="CLM-00012" num="00012"><claim-text><b>12</b>. The non-transitory computer readable medium of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the initial grid geometry is determined, at least in part, from isobars of a coarse-grid simulation.</claim-text></claim><claim id="CLM-00013" num="00013"><claim-text><b>13</b>. The non-transitory computer readable medium of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein a first horizontal axis of the initial grid geometry comprises an ellipse and a second horizontal axis of the initial grid geometry is locally orthogonal to the ellipse.</claim-text></claim><claim id="CLM-00014" num="00014"><claim-text><b>14</b>. A system comprising:<claim-text>a reservoir simulator, configured to:<claim-text>obtain a coarse grid model of a hydrocarbon reservoir and a trajectory of a wellbore that penetrates the hydrocarbon reservoir;</claim-text><claim-text>determine an initial grid geometry surrounding the trajectory;</claim-text><claim-text>construct a reservoir simulation grid, wherein the reservoir simulation grid is conformal to the initial grid geometry in a first region in a vicinity of the wellbore and conformal with the coarse grid model in a second region more distant from the wellbore than the first region; and</claim-text><claim-text>perform a hydrocarbon reservoir simulation, modeling a flow of fluid in the hydrocarbon reservoir based, at least in part, on the reservoir simulation grid;</claim-text><claim-text>develop a hydrocarbon reservoir production plan; and</claim-text></claim-text><claim-text>a well planning system configured to determine a planned wellbore trajectory based upon the hydrocarbon reservoir production plan.</claim-text></claim-text></claim><claim id="CLM-00015" num="00015"><claim-text><b>15</b>. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, further comprising a drilling system configured to drilling the wellbore guided by the planned wellbore trajectory.</claim-text></claim><claim id="CLM-00016" num="00016"><claim-text><b>16</b>. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, further comprising a pumping system configured to pump a fluid injection program based, at least in part, upon the hydrocarbon reservoir production plan.</claim-text></claim><claim id="CLM-00017" num="00017"><claim-text><b>17</b>. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the hydrocarbon reservoir is a wet gas reservoir.</claim-text></claim><claim id="CLM-00018" num="00018"><claim-text><b>18</b>. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the initial grid geometry of isobars is determined, at least in part, from a coarse-grid simulation.</claim-text></claim><claim id="CLM-00019" num="00019"><claim-text><b>19</b>. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein a first horizontal axis of the initial grid geometry comprises an ellipse.</claim-text></claim><claim id="CLM-00020" num="00020"><claim-text><b>20</b>. The system of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein a second horizontal axis of the initial grid geometry is locally orthogonal to the ellipse.</claim-text></claim></claims></us-patent-application>