<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE us-patent-application SYSTEM "us-patent-application-v46-2022-02-17.dtd" [ ]><us-patent-application lang="EN" dtd-version="v4.6 2022-02-17" file="US20230004982A1-20230105.XML" status="PRODUCTION" id="us-patent-application" country="US" date-produced="20221221" date-publ="20230105"><us-bibliographic-data-application lang="EN" country="US"><publication-reference><document-id><country>US</country><doc-number>20230004982</doc-number><kind>A1</kind><date>20230105</date></document-id></publication-reference><application-reference appl-type="utility"><document-id><country>US</country><doc-number>17942868</doc-number><date>20220912</date></document-id></application-reference><us-application-series-code>17</us-application-series-code><classifications-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>Q</subclass><main-group>20</main-group><subgroup>40</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr><classification-ipcr><ipc-version-indicator><date>20060101</date></ipc-version-indicator><classification-level>A</classification-level><section>G</section><class>06</class><subclass>Q</subclass><main-group>20</main-group><subgroup>38</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source></classification-ipcr></classifications-ipcr><classifications-cpc><main-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>Q</subclass><main-group>20</main-group><subgroup>4016</subgroup><symbol-position>F</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></main-cpc><further-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>Q</subclass><main-group>20</main-group><subgroup>3829</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>Q</subclass><main-group>20</main-group><subgroup>389</subgroup><symbol-position>L</symbol-position><classification-value>I</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc><classification-cpc><cpc-version-indicator><date>20130101</date></cpc-version-indicator><section>G</section><class>06</class><subclass>Q</subclass><main-group>2220</main-group><subgroup>00</subgroup><symbol-position>L</symbol-position><classification-value>A</classification-value><action-date><date>20230105</date></action-date><generating-office><country>US</country></generating-office><classification-status>B</classification-status><classification-data-source>H</classification-data-source><scheme-origination-code>C</scheme-origination-code></classification-cpc></further-cpc></classifications-cpc><invention-title id="d2e43">TRACING FLOW OF TAGGED FUNDS ON A BLOCKCHAIN</invention-title><us-related-documents><continuation><relation><parent-doc><document-id><country>US</country><doc-number>16544770</doc-number><date>20190819</date></document-id><parent-grant-document><document-id><country>US</country><doc-number>11443317</doc-number></document-id></parent-grant-document></parent-doc><child-doc><document-id><country>US</country><doc-number>17942868</doc-number></document-id></child-doc></relation></continuation><us-provisional-application><document-id><country>US</country><doc-number>62782341</doc-number><date>20181219</date></document-id></us-provisional-application></us-related-documents><us-parties><us-applicants><us-applicant sequence="00" app-type="applicant" designation="us-only" applicant-authority-category="assignee"><addressbook><orgname>SALT BLOCKCHAIN INC.</orgname><address><city>Denver</city><state>CO</state><country>US</country></address></addressbook><residence><country>US</country></residence></us-applicant></us-applicants><inventors><inventor sequence="00" designation="us-only"><addressbook><last-name>McClelland</last-name><first-name>Keagan</first-name><address><city>Denver</city><state>CO</state><country>US</country></address></addressbook></inventor><inventor sequence="01" designation="us-only"><addressbook><last-name>Hill</last-name><first-name>Matthew</first-name><address><city>Centennial</city><state>CO</state><country>US</country></address></addressbook></inventor><inventor sequence="02" designation="us-only"><addressbook><last-name>McClelland</last-name><first-name>Aiden</first-name><address><city>Denver</city><state>CO</state><country>US</country></address></addressbook></inventor></inventors></us-parties></us-bibliographic-data-application><abstract id="abstract"><p id="p-0001" num="0000">A system for &#x201c;tagging&#x201d; funds identified on a blockchain and associating a weight value therewith. The tagging profile is developed into a propagation profile wherein weight values are inherited from the tagging profile s. Propagation profile funds may be diluted by combining with non-tagged funds, similar to how ink dilutes through water. A spending history of funds of interest is developed based on replaying the funds of interest against the global transaction history of the blockchain. It is determined whether the spending history intersects with the propagation profile, thus determining how closely the two sources of funds are economically to one another. Intersection triggers actions including alert notifications or transfer of funds on the blockchain.</p></abstract><drawings id="DRAWINGS"><figure id="Fig-EMI-D00000" num="00000"><img id="EMI-D00000" he="218.69mm" wi="158.75mm" file="US20230004982A1-20230105-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00001" num="00001"><img id="EMI-D00001" he="240.62mm" wi="174.67mm" file="US20230004982A1-20230105-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00002" num="00002"><img id="EMI-D00002" he="242.49mm" wi="172.64mm" file="US20230004982A1-20230105-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00003" num="00003"><img id="EMI-D00003" he="241.89mm" wi="171.03mm" file="US20230004982A1-20230105-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00004" num="00004"><img id="EMI-D00004" he="241.89mm" wi="171.45mm" file="US20230004982A1-20230105-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00005" num="00005"><img id="EMI-D00005" he="240.88mm" wi="171.11mm" file="US20230004982A1-20230105-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00006" num="00006"><img id="EMI-D00006" he="240.88mm" wi="169.08mm" file="US20230004982A1-20230105-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00007" num="00007"><img id="EMI-D00007" he="240.88mm" wi="168.57mm" file="US20230004982A1-20230105-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00008" num="00008"><img id="EMI-D00008" he="240.88mm" wi="170.52mm" file="US20230004982A1-20230105-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00009" num="00009"><img id="EMI-D00009" he="240.28mm" wi="174.67mm" file="US20230004982A1-20230105-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00010" num="00010"><img id="EMI-D00010" he="237.83mm" wi="169.93mm" file="US20230004982A1-20230105-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00011" num="00011"><img id="EMI-D00011" he="237.83mm" wi="169.76mm" file="US20230004982A1-20230105-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure><figure id="Fig-EMI-D00012" num="00012"><img id="EMI-D00012" he="237.24mm" wi="156.46mm" file="US20230004982A1-20230105-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/></figure></drawings><description id="description"><?summary-of-invention description="Summary of Invention" end="lead"?><heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading><p id="p-0002" num="0001">Blockchains are shared ledgers that are periodically updated according to a set of network consensus rules. Some blockchain shared ledgers track the movement of funds (e.g., units of monetary value that may be viewed as being &#x201c;coins&#x201d; or units of cryptocurrency). Participants in the blockchain network may choose to conduct business (e.g., provide goods and/or services) in exchange for these units of funds. In some cases, network participants may wish to avoid certain &#x201c;tainted&#x201d; units of funds for business and/or regulatory reasons (e.g., if the funds are suspected of having been stolen, if the funds are associated with a legal jurisdiction in which the network participant is not authorized to do business, if the funds have been associated with terrorist or other criminal activity, if the funds are associated with a known credit risk, etc.). There could be legal requirements in certain jurisdictions to check blockchain funds against lists of known bad funds (e.g., stolen, used for terrorism, associated with a country subject to economic sanctions, etc.) before accepting the funds in the course of business.</p><p id="p-0003" num="0002">Some blockchains are based on an unspent transaction output (UTXO) model wherein units of funds are discrete and not fractionally spendable, similar to physical paper bills of a fiat currency. When spending a UTXO, there is likely to be at least one &#x201c;change&#x201d; output associated with the transaction since it is unlikely that the size of a UTXO exactly matches the amount the spender wishes to transfer. Thus, knowledge of a particular tainted UTXO becomes stale when the UTXO is spent and the tainted funds are split between a recipient and a change address controlled by the spending entity. A blockchain network participant is therefore unlikely to be able to follow the movement of funds and accurately determine whether a particular unit of funds should not be accepted for business purposes. Moreover, tainted funds can be combined with &#x201c;clean&#x201d; funds, thus complicating the question of whether a network participant may accept a payment.</p><p id="p-0004" num="0003">Accordingly, there is a need for a system to track movement of tainted or otherwise classified funds over time on a blockchain for a network participant to determine whether it is permissible to handle a particular unit of funds (e.g., the output of a particular UTXO) according to the network participant's criteria.</p><?summary-of-invention description="Summary of Invention" end="tail"?><?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?><description-of-drawings><heading id="h-0002" level="1">BRIEF DESCRIPTION OF THE SEVERAL VIEWS OF THE DRAWINGS</heading><p id="p-0005" num="0004">The accompanying figures, where like reference numerals refer to identical or functionally similar elements throughout the separate views, together with the detailed description below, are incorporated in and form part of the specification, and serve to further illustrate embodiments of concepts that include the claimed invention, and explain various principles and advantages of those embodiments.</p><p id="p-0006" num="0005"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is an example block diagram of an example relationship between a source of funds and an auditor tracing the flow those funds with respect to a tagging profile on a blockchain.</p><p id="p-0007" num="0006"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a time-series diagram of a tagging profile replayed against a global transaction history over time on a blockchain shared ledger to yield a propagation profile of unspent transaction outputs.</p><p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a signal diagram of a process of tracing the flow of tagged funds on a blockchain network.</p><p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a time plot illustrating the creation of an example propagation profile from a tagging profile and the creation of a spending history from an identification of funds as each is replayed against a global transaction history.</p><p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is another time diagram illustrating an example relationship among blockchain addresses with an identifier of funds, a spending profile, a tagging profile, and a propagation profile.</p><p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a diagram illustrating a dilution effect of combining clean funds with funds deemed tainted according to a tagging profile.</p><p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a diagram illustrating an example relationship among a digital asset services provider auditing the flow of blockchain funds of a customer with respect to counterparties to transactions with the customer.</p><p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a diagram illustrating an example generation of tagging profiles by a digital asset services provider.</p><p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a block diagram of an example system for tracing flow of tagged funds on a blockchain.</p><p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a flowchart of an example workflow for tracing flow of tagged funds on a blockchain.</p><p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. <b>11</b></figref> is another flowchart of an example workflow for tracing flow of tagged funds on a blockchain.</p><p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. <b>12</b></figref> is an example system that may be useful in carrying out the present disclosure.</p></description-of-drawings><?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?><?detailed-description description="Detailed Description" end="lead"?><p id="p-0018" num="0017">Skilled artisans will appreciate that elements in the figures are illustrated for simplicity and clarity and have not necessarily been drawn to scale. For example, the dimensions of some of the elements in the figures may be exaggerated relative to other elements to help to improve understanding of embodiments of the present invention.</p><p id="p-0019" num="0018">The apparatus and method components have been represented where appropriate by conventional symbols in the drawings, showing only those specific details that are pertinent to understanding the embodiments of the present invention so as not to obscure the disclosure with details that will be readily apparent to those of ordinary skill in the art having the benefit of the description herein.</p><heading id="h-0003" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading><p id="p-0020" num="0019">A participant in a blockchain network may be aware of funds of interest and may wish to track the funds over time. The funds of interest may be funds that the participant does not wish to interact with (e.g., for legal reasons, regulatory reasons, because the funds have been claimed as stolen, associated with a darknet market, etc.). The funds of interest may also be funds that are of economic interest, such as funds that have been associated with another market participant of interest (e.g., a competitor or any other entity exchanging goods or services for funds on the blockchain).</p><p id="p-0021" num="0020">It is quite difficult to trace a source of funds on a UTXO blockchain due to the structure of the UTXO model. A UTXO represents a discrete amount of funds that can only be spent in full, similar to a physical paper currency bill. In the same way it is not possible to spend $10 by cutting a $20 bill in half, a UTXO must be fully spent. If a spender of funds on a UTXO blockchain wishes to transfer value to a recipient, then the spender must select one or more UTXOs, the aggregate value of which is greater than the transfer amount as inputs to a transaction. The spender's transaction typically will have two outputs: one output going to the recipient of the funds, and a second output controlled by the spender and referred to herein as a change output or change address.</p><p id="p-0022" num="0021">If a blockchain network participant identifies a UTXO of interest (e.g., a UTXO having a &#x201c;risk factor&#x201d;), it is not effective to simply check the UTXO on the blockchain because, if the owner ever spends the UTXO, the funds contained therein effectively are moved partially to a recipient in a new UTXO and the remainder is held by the spender in a new UTXO change address. Without the aid of evidence extrinsic to the blockchain, it is likely not possible to distinguish between coins held by the recipient of the transaction and coins that are the change address, although it may be possible to apply heuristics or other analysis such as wallet clustering to identify the change address in some cases.</p><p id="p-0023" num="0022">Accordingly, a method is disclosed herein that, given an initial tagging profile of funds, can follow the history of the funds against the global transaction history of the blockchain to determine whether there is an intersection between the funds and a weighted profile (e.g., a risk profile) of funds of interest. As funds are spent and combined with new transaction inputs, the weight values of the profile, referred to herein as a tagging profile, can be thought of like a drop of ink diffusing through a body of water. As more transactions accumulate on the blockchain, the tagged funds are diluted by combination with non-tagged funds, thus spreading out the weighting value into future transaction outputs. An identification of funds (e.g., funds deposited by a customer of a digital asset services provider) can be compared against the weighted transaction outputs to determine whether there is an intersection indicating economic interaction between the two parties. Given a long enough time horizon, in theory, all transaction outputs could eventually come into contact with one another (analogous to the ink drop in eventually becoming fully mixed with the body of water). Thus, a minimum weight value threshold may be imposed to satisfy an intersection condition between the identified funds and the tagging profile.</p><p id="p-0024" num="0023">As used herein, an &#x201c;identification of funds&#x201d; is an initial identification of funds on the blockchain that can be made in several ways. In one implementation, the identification of funds includes one or more transaction outputs, whether spent or not. In other implementations, the identification of funds could include an extended public address (also known as an xpub) that deterministically creates an infinite line of payment address. Cryptocurrency wallets often use an xpub, often generated based on a deterministic seed, to be able to generate all the payment addresses that will ever be used by the wallet. However the initial identification of funds is made, these initial transaction outputs can be compared against the global transaction history of the blockchain to generate a list of transaction outputs that are children of the initial identification of funds, referred to herein as the spending history of the identification of funds. It would not be known how much of the funds in the spending history is retained by the entity that originally controlled the identified funds compared to funds in the spending history that are sent to recipients due to the nature of the blockchain.</p><p id="p-0025" num="0024">As used herein, a &#x201c;tagging profile&#x201d; is a set of funds that is similar to the identification of funds, but with a weight value associated therewith. An example weight value could be a risk value attached to or associated with each transaction output in the tagging profile. When funds included in the tagging profile are spent or combined with other transaction outputs to form inputs to a new transaction, the weight values can be inherited by the resulting new transaction outputs. The tagging profile therefore resembles the diffusing ink in the body of water such that weight values can be diluted according to the magnitude of unweighted transaction outputs that are &#x201c;mixed in&#x201d; with the weighted transaction outputs. The resulting set of funds with weighting values after the tagging profile has been applied to the global transaction history is referred to herein as the propagation profile.</p><p id="p-0026" num="0025">As an example, funds on the blockchain could be deemed &#x201c;tainted&#x201d; and thus undesirable or prohibited to handle from a legal or regulatory perspective. For example, funds could be reported as having been stolen, associated with an unlawful entity, deemed associated with an entity subject to trade sanctions, or any number of other reasons. In this scenario a weight value representing &#x201c;risk,&#x201d; or a similar concept, can be assigned to the tainted funds. As the tainted funds are spent and combined with fresh funds (e.g., funds not associated with a weighting value), the new transaction outputs inherit the weight values from the tainted funds proportionally according to the fraction of input value to new transactions represented by the tainted funds.</p><p id="p-0027" num="0026">If the tainted funds are not mixed with fresh funds, then any new transaction outputs will retain the weight values of the parent transaction outputs. Thus, if stolen funds are sent directly to a digital asset services provider, the digital asset services provider may refuse to accept the funds assuming the weight values are above the digital asset service provider's risk threshold. Since the risk threshold is adjustable, a digital asset service provider can specify what level of exposure to tainted funds is tolerable. Likely any market participant will find it necessary to have some non-zero level of risk on the funds, similar to the case for physical cash or other types of money that have been involved in prohibited activities before coming into possession of a market participant.</p><p id="p-0028" num="0027">The system and methods for tracing flow of tagged funds on a blockchain disclosed herein are a practical application of blockchains. From one point of view, the tagging schema disclosed herein is an attack on the fungibility of the cryptocurrency, which is often viewed as a core source of value for the coins. If some funds are labeled as &#x201c;tainted&#x201d; or &#x201c;at risk&#x201d; as described herein, then those coins may trade at a discount on the market compared to &#x201c;clean&#x201d; funds. Tracing funds on a blockchain by developing a propagation profile, thus has a real-world effect on participants wishing to transact in the coins: cryptocurrency deposits may be returned, a customer could be denied service, law enforcement authorities could be notified, etc.</p><p id="p-0029" num="0028">Nor are the systems and methods disclosed herein merely organizing information. In a blockchain cryptocurrency system, private signing keys (also referred to herein as spending keys) are needed to move funds. By design, a signing key only exists in the possession of the participant who created it. If it were otherwise, it would be computationally practical to steal another participant's coins. The private signing key, therefore, is not merely information, the private signing key is the money itself When a participant is in possession of a private signing key, that participant takes on the responsibility and obligation to protect the key against loss of funds. The history of cryptocurrency is littered with centralized digital asset services providers who lost signing keys, and therewith the coins, whether to theft, incompetence, or other reasons. Receiving digital asset funds is therefore more akin to receiving a shipment of a precious metal than it is to receiving an electronic transmission. Electronic transmissions can typically be copied and retransmitted at much as desired; blockchain funds, on the other hand, cannot. The stopping of a digital asset payment, or the rejection and return of a digital asset payment, is therefore more than merely transmitting data due to the custodial responsibilities involved.</p><p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. <b>1</b></figref> is a block diagram <b>100</b> of an example relationship between a source of funds and an auditor tracing the flow those funds with respect to a tagging profile on a blockchain. In the example illustrated in <figref idref="DRAWINGS">FIG. <b>1</b></figref>, a blockchain <b>102</b> is an unspent transaction output (UTXO) model blockchain wherein each new block added to the chain spends a subset of available UTXOs as transaction inputs and creates new, previously nonexistent, UTXOs as transaction outputs. The blockchain <b>102</b> thus represents a global transaction history for users of the chain.</p><p id="p-0031" num="0030">An auditor <b>106</b> receives a tagging profile <b>110</b> identifying funds with weighting values associated therewith (e.g., a set of transaction outputs with risk values). The auditor <b>106</b> further received an identification of funds <b>108</b> from a participant <b>104</b>. The identification of funds illustrated in <figref idref="DRAWINGS">FIG. <b>1</b></figref> is a set of xpubs each representing a cryptocurrency wallet of interest to the participant <b>104</b>. The wallets of interest to the participant may represent customer wallets, business counterparty wallets, etc.</p><p id="p-0032" num="0031">Upon receipt of the tagging profile <b>110</b> and the identification of funds <b>108</b>, the auditor <b>106</b> generates the spending history and propagation profile based thereon and searches for funds (e.g., transaction outputs) that appear in both sets. If there are funds in both sets, then the auditor <b>106</b> determines whether the funds satisfy an intersection condition, which may rely on the weighting value of intersecting funds exceeding a minimum threshold, such as a threshold supplied by the participant <b>104</b>. The auditor may then take action, such as transmitting an intersection alert to the participant <b>104</b>.</p><p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. <b>2</b></figref> is a time-series diagram <b>200</b> of a tagging profile replayed against a global transaction history over time on a blockchain shared ledger to yield a propagation profile of unspent transaction outputs. At the outset, clarification may be useful regarding the term &#x201c;unspent&#x201d; in UTXO. A transaction may be unspent at a certain point in time, but then later is consumed as an input to a confirmed transaction, thus becoming &#x201c;spent.&#x201d; These transaction inputs/outputs are commonly referred to as UTXOs whether they are spent or not. For purposes of this disclosure, a UTXO can refer to either a spent or unspent transaction output. Similarly, a transaction &#x201c;output&#x201d; is created by a confirmed transaction, but later can be used as an input to another transaction. Thus, UTXO should not be interpreted as strictly a transaction output.</p><p id="p-0034" num="0033">The tagging profile in the example illustrated in <figref idref="DRAWINGS">FIG. <b>2</b></figref> includes four UTXOs <b>202</b>, <b>204</b>, <b>206</b>, and <b>212</b>. Each UTXO in the tagging profile has a funds value and a weight value associated therewith. For example, UTXO <b>202</b> has <b>5</b> bitcoins (BTC) and a weight value, here a risk score, of <b>3</b>. The remaining UTXOs <b>204</b>, <b>206</b>, and <b>212</b> similarly have funds values and risk scores. Taken together, the four UTXOs <b>202</b>, <b>204</b>, <b>206</b>, and <b>212</b> represent the tagging profile in this example.</p><p id="p-0035" num="0034">As time progresses downward in the diagram <b>200</b>, the UTXOs <b>202</b> and <b>204</b> are inputs to a confirmed transaction Tx <b>1</b>. Confirmed transaction Tx <b>1</b> generates two transaction outputs <b>208</b> and <b>210</b>. Funds values may be apportioned as desired by the sender between the two outputs <b>208</b> and <b>210</b> but must not exceed the total value of the inputs to Tx <b>1</b>. In practice, there would also be a transaction fee paid to the miner who solved the block in which Tx <b>1</b> is included, but transaction fees are ignored for the purposes of this example. In a typical scenario, one of the outputs of Tx <b>1</b> is now owned by the payee of the transaction and the other output is the change address belonging to the sender. For purposes of generating the propagation profile, it does not matter which output is the payee's and which is the change address. The risk is apportioned across the outputs to Tx <b>1</b> according to the formula ((5*3)+(7*12))/(5+7)=8.25. In the example of Tx <b>1</b>, there are no &#x201c;fresh&#x201d; inputs (e.g., inputs without weight scores), such that the output weights can be viewed as changing the balance of the risk of the inputs but not reducing the overall risk as would be the case if a diluting zero-weight input had been used. One way to view the Tx <b>1</b> is that the total risk of the inputs was shared equally by the two outputs, regardless of the relative size of each output.</p><p id="p-0036" num="0035">Next in the time progression of diagram <b>200</b> is confirmed Tx <b>2</b>, which consumes UTXO <b>208</b> and UTXO <b>206</b>. Tx <b>2</b> produces two outputs, UTXOs <b>214</b> and <b>216</b>. As with Tx <b>1</b>, the two transaction outputs each have a value, 1 BTC and 3 BTC, respectively, and share the same risk score of 6.625. Concurrent with confirmed Tx <b>2</b> is confirmed Tx <b>3</b>, which consumes UTXOs <b>210</b> and <b>212</b> and produces new transaction outputs <b>218</b> and <b>220</b>. As with the other transactions, Tx <b>3</b> produces outputs of different BTC funds values but equal risk scores. The set of UTXOs <b>214</b>, <b>216</b>, <b>218</b>, <b>220</b> in the example illustrated in <figref idref="DRAWINGS">FIG. <b>2</b></figref> is the propagation profile that resulted from replaying the tagging profile against a global transaction history.</p><p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. <b>3</b></figref> is a signal diagram of a workflow <b>300</b> of tracing the flow of tagged funds on a blockchain network. The workflow <b>300</b> begins with a receiving operation <b>302</b> wherein an auditor receives at least a portion of a global transaction history from a blockchain. In implementations, the auditor includes a full validating node on a network of the blockchain such that the auditor has access to a full history of the blockchain. In other implementations, the auditor receives only a portion of the blockchain record, such as via a third-party such as a block explorer website or API. In many cases, the history of the blockchain may span a long period of time (e.g., many years) and only a subset of the total history is of interest to the participants. Thus, a block height may be specified as a start block for purposes of the method described herein such that only blocks above the start block are considered.</p><p id="p-0038" num="0037">A receiving operation <b>304</b> receives an identification of funds on the blockchain from a user. The identification of funds may include any information identifying funds in question, such as a set of transaction outputs, an xpub, etc. Once the auditor has the identification of funds, the auditor replays the identifier of funds against the global transaction history to generate a spending history. The process of replaying the identification of funds against the global transaction history is similar to the generation of the propagation profile except there is no weighting value. In implementations, all outputs descending from the identification of funds are considered to belong to the spending history. In other implementations, change addresses are identified as belonging to a wallet associated with the identification of funds distinct from recipient addresses, which are excluded from the spending history.</p><p id="p-0039" num="0038">In some cases, an identification of funds will be &#x201c;fresh&#x201d; in the sense that the funds only exist at or near the tip of the blockchain. In other words, no blocks or very few blocks have been solved since the block height wherein the identification of funds first appeared on the blockchain shared ledger. This situation may occur when a new address has been created for the purpose of receiving the funds and it is known that the address had not existed prior due to the creation of the address with sufficient entropy input. In this scenario, the replaying operation <b>306</b> is a null operation because there is nothing in the global transaction history against which to replay the identification of funds. Examples may include wherein a digital asset services provider creates a new payment address into which a customer or prospective customer deposits funds for use with the digital asset services provider (e.g., making a deposit into a cryptocurrency exchange for trading, depositing digital asset collateral for a loan, depositing funds for use on a platform, etc.).</p><p id="p-0040" num="0039">A receiving operation <b>308</b> receives a tagging profile including transaction outputs with weight values associated therewith. Another replaying operation <b>310</b> replays the tagging profile against the global spending history to yield a propagation profile. A determining operation <b>312</b> then determines whether there is an intersection between the spending history and the propagation profile by determining whether there exist any transaction outputs that are members of both sets. It is likely that mere membership in both sets will not be deemed sufficient to satisfy an intersection condition because, given enough time, virtually all funds can comingle on the blockchain. Thus, a minimum risk score for the intersecting funds may be required to filter out funds that are only minimally related between the two sets. Depending on the sensitivity of a market participant to tainted funds, the determining operation <b>312</b> may adjust the minimum threshold. For a tagging profile that applies to funds deemed truly toxic to the market participant, a minimum threshold approaching zero may be used.</p><p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. <b>4</b></figref> is a time plot <b>400</b> illustrating the creation of an example propagation profile from a tagging profile and the creation of a spending history from an identification of funds as each is replayed against a global transaction history. The horizontal x-axis of the plot <b>400</b> is time, starting at a time To and extending indefinitely. In implementations, time To represents the genesis block of the blockchain. In other implementations, time To represents a start block, such as a block identified by block height at the beginning of an epoch of interest on the blockchain. In the example illustrated in plot <b>400</b>, the tagging profile and the identification of funds originate are at the same block height, but different block heights are also possible.</p><p id="p-0042" num="0041">The y-axis of <figref idref="DRAWINGS">FIG. <b>4</b></figref> should not be interpreted to mean the transaction outputs are ordered. In both spent and unspent outputs are deemed to be represented by the y-axis, then the total size of the set increases over time but there is nothing inherent to the outputs that signifies ordering. Thus, the y-axis should be interpreted to mean the overall size of the transaction outputs and not the currency values thereof or any other attribute of the transaction outputs.</p><p id="p-0043" num="0042">The cone extending to the right of the tagging profile at time To represents the generation of the propagation profile as applied to the global transaction history as time increases. Expansion of the cone depicts a rising number of transaction outputs that are assigned a weight value as inputs are consumed by transactions and new outputs created. Not depicted in the plot <b>400</b> is the weighting value of the transaction outputs in the propagation profile, which may differ from output to output. Similarly, the cone extending to the right from the identification of funds represents the generation of the spending history as time progresses. The intersection point shows the first point at which a transaction output appears in both cones. This point may trigger the intersection condition, depending on whether the weight of the intersecting transaction output exceeds a triggering threshold. The intersection condition need not be only triggered at one point. If the cones continued to extend to the right, then there could be many intersecting transaction outputs over time, each of which can independently trigger the intersection condition. The plot <b>400</b> suggests that, as time increases to infinity, and identification of funds will eventually intersect with the propagation profile.</p><p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. <b>5</b></figref> is another time diagram <b>500</b> illustrating an example relationship among blockchain addresses with an identifier of funds, a spending profile, a tagging profile, and a propagation profile. In the time diagram <b>500</b>, time progresses downward as indicated by the times T<sub>1</sub>, T<sub>2</sub>, T<sub>3</sub>, etc. In the diagram <b>500</b>, each time level is depicted as having a transaction output set associated therewith. In the diagram <b>500</b>, individual transaction outputs on the blockchain are depicted as circles. When the address is spent, then an X is drawn through the circle representing the address. If a payment address is unspent, then there is no X in the circle.</p><p id="p-0045" num="0044">As in other examples disclosed herein, the term &#x201c;output&#x201d; is applied to any output of a confirmed blockchain transaction, but it should also be appreciated that the &#x201c;output&#x201d; may then become an input to a later confirmed blockchain transaction. Thus, &#x201c;output&#x201d; should not be construed to mean strictly a blockchain transaction output but could also refer to an input. Similarly, the term &#x201c;unspent&#x201d; may refer to a transaction that later may be spent. Blockchain transaction outputs may also be referred to herein as addresses or payment addresses.</p><p id="p-0046" num="0045">The identification of funds is represented by circle <b>502</b>. In <figref idref="DRAWINGS">FIG. <b>5</b></figref>, outputs representing the spending history of the identifier of funds include a check mark. Unspent outputs are represented by a circle, spent output are crossed out, and outputs with a weighting value attached as part of the tagging profile and/or the propagation profile include a number indicating the weighting assigned thereto.</p><p id="p-0047" num="0046">On the left side, <figref idref="DRAWINGS">FIG. <b>5</b></figref> illustrates replaying the identification of funds against a global transaction history over time to generate the spending history of the identification of funds. In this example, the identification of funds is made by reference to a single unspent payment address <b>502</b>. At time T<sub>2</sub>, the initial identifier of funds <b>502</b> is spent to fund a recipient address <b>504</b> and a change address <b>506</b>. At time T<sub>3</sub>, the change address <b>506</b> has been spent in a transaction yielding two new outputs <b>508</b> and <b>510</b>. The transaction output <b>508</b> is illustrated as spent to outputs <b>526</b> (itself later spent to output <b>530</b>) and <b>528</b>, left unspent. None of the output resulting from spending output <b>508</b> intersect with the propagation profile.</p><p id="p-0048" num="0047">Moving back up to time T<sub>3</sub>, the transaction output <b>510</b> does intersect with the propagation profile when, at time T<sub>4</sub>, output <b>510</b> is spent in combination with transaction output <b>512</b>, which is a transaction output with a weight value attached thereto. The transaction <b>512</b> has a weight value associated therewith because it is a child transaction of the tagging profile <b>514</b>, and is thus part of the propagation profile. Although the initial tagging profile <b>514</b> may consist of any number of UTXOs, in the example illustrated in diagram <b>500</b> is a single UTXO with a weight value of <b>10</b>. In an implementation, the weight value is on a scale of 0-10, thus the tagging profile <b>514</b> is a maximally weighted tagging profile. Such a high weight value may indicate funds that are high risk, such as funds that have been stolen from a cryptocurrency exchange.</p><p id="p-0049" num="0048">Tracing the development of the propagation profile, at time T<sub>1</sub>, the tagging profile UTXO <b>514</b> is spent as an input together with a UTXO <b>516</b> that does not have a weight value to produce new transaction output <b>518</b>. The funds value of the output <b>516</b> is significantly lower than the output <b>514</b>, thus resulting in a slight dilution of the weighting value to 9. The output <b>518</b> then becomes an input to another transaction together with UTXO <b>520</b>, which also does not have a weighting value associated therewith. The input <b>520</b> has a comparatively lower BTC funds value, thus diluting the weighting again to 8 for the output of the transaction, output <b>522</b>. Output <b>522</b> is spent as an input to a transaction creating three more outputs, including output <b>512</b>, which, in turn, it spent as an input to a transaction combining it with output <b>510</b>, part of the spending history. Thus, the first address satisfying the intersection condition is output <b>524</b>.</p><p id="p-0050" num="0049">Output <b>524</b> thus satisfies an intersection condition between the identifier of funds developed into the spending history, on the one hand, and the tagging profile developed into the propagation profile on the other hand. The intersection condition of output <b>524</b> has a value 5 associated therewith, reflecting that the size of input <b>510</b> is smaller than that of input <b>512</b>. A participant interested in the intersection condition can use the intersecting value to reflect the degree of intersection (e.g., in the case of a &#x201c;risk profile&#x201d; weighting, how &#x201c;tainted&#x201d; the intersecting funds are). As time increases to infinity, it may become likely that virtually all blockchain outputs accrue some level of the weighting factor, due to the nature of the how the outputs are recombined as inputs to new transactions over the course of time on the blockchain. Thus, to have a value of relevance, intersection conditions may be limited to funds that have a weighting value above a threshold value, to &#x201c;filter out the dust.&#x201d;</p><p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. <b>6</b></figref> is a diagram <b>600</b> illustrating a dilution effect of combining clean funds <b>604</b> with funds deemed tainted <b>606</b> according to a tagging profile. Initially, a blockchain network participant <b>602</b> owns a set of funds <b>604</b> that are not associated with weight values from any tagging profile and/or propagation profile generated therefrom. A suspect participant <b>608</b> owns funds <b>606</b> that have a weighting value indicating a high level of risk. As the funds <b>606</b> themselves are tainted according to the tagging profile, the suspect participant <b>608</b> may encounter difficulty spending the funds <b>606</b> as desired. Accordingly, the suspect participant <b>608</b> may elect to sell the funds <b>606</b> to the network participant <b>602</b> to be diluted with the clean funds <b>604</b>. If the participant <b>602</b> is aware of the tainted nature of the funds <b>606</b>, then the network participant <b>602</b> may demand a below-market sale price to compensate for the dilution.</p><p id="p-0052" num="0051">After the arrow <b>610</b>, the clean funds <b>604</b> have acquired an amount of taint from the funds <b>606</b> and the suspect participant <b>608</b> has divested from the tainted funds. The diagram <b>600</b> shows that tainted funds may be absorbed into non-tainted funds with new weighting according to the relative size of the two sets of funds. In this example, the clean funds <b>604</b> are substantially larger than the tainted funds, thus after combination the formerly completely clean funds take on a small level of taint. Such a level may be acceptable to the network participant <b>602</b>, depending on a desired plan to use the funds.</p><p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. <b>7</b></figref> is a diagram <b>700</b> illustrating an example relationship among a digital asset services provider <b>502</b> auditing the flow of blockchain funds of a customer <b>704</b> with respect to counterparties <b>708</b> and <b>710</b> to transactions with the customer. Unlike the previous examples in this disclosure, the diagram <b>700</b> depicts a scenario wherein the tagging profile is not a risk profile, but rather a profile indicating how closely tied funds are to specific market participants <b>708</b> and <b>710</b>. Funds known to be associated with a market participant can be tagged with a weighting value indicating the relationship (e.g., the highest weighting value possible). These funds are then diluted as they are combined with other, non-tagged funds. Over time the tagging profile will become less and less related to the original counterparty, but the level of interaction with these funds can still be used to indicate a probability that an interaction with customer funds <b>704</b> is performed by the counterparty in question.</p><p id="p-0054" num="0053">In the example illustrated in <figref idref="DRAWINGS">FIG. <b>7</b></figref>, a customer <b>704</b> owns digital asset funds <b>706</b> held in custody by the digital asset services provider <b>702</b> (e.g., a custodial wallet service, a manager of a digital asset collateral wallet for a digital asset collateralized loan, a cryptocurrency exchange, and/or any other type of digital asset service provider). Whatever the type of service provided by the digital asset service provider <b>702</b>, funds owned by the customer <b>704</b> may be traced, such as when the customer initiates a transaction from a custodial wallet.</p><p id="p-0055" num="0054">In the example of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, the customer <b>704</b> initiates a transfer <b>716</b> to the counterparty <b>708</b>. If the transfer <b>716</b> occurs through the digital asset services provider <b>702</b> or if the transaction <b>716</b> is on-chain and thus visible on a copy of the blockchain ledger, the digital asset services provider <b>702</b> can identify the transaction <b>716</b> as part of the spending history of the user <b>704</b>. Once the transaction <b>716</b> has been identified as part of the spending history of the user <b>704</b>, then a tracing operation <b>712</b> can calculate the likelihood that the funds were spent with the counterparty <b>708</b>. A similar process is followed with transaction <b>718</b> to counterparty <b>710</b> and tracing operation <b>714</b>.</p><p id="p-0056" num="0055">In the example of <figref idref="DRAWINGS">FIG. <b>7</b></figref>, the digital asset services provider <b>702</b> may infer multiple types of economic information regarding the user <b>704</b> and the counterparties <b>708</b> and <b>710</b>. In one implementation, the digital asset services provider <b>702</b> can assemble a consumer profile of the customer <b>704</b> by detecting intersection conditions between the funds <b>706</b> and known tagging profiles of counterparties. In another implementation, the digital asset services provider <b>702</b> can detect new counterparties with whom the customer <b>704</b> has engaged in business by examining intersection conditions with previously unknown counterparties. If the digital asset services provider has many customers, then comparisons may be made of the respective spending histories to detect new counterparties.</p><p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. <b>8</b></figref> is a diagram <b>800</b> illustrating an example application of tagging profiles by a digital asset services provider. There are various scenarios possible wherein the digital asset services provider <b>802</b> may want to, or be required to, refrain from handling certain funds. The profiling of these funds and weight values assigned thereto may be selected by a variety of participants and/or observers to the system. In one implementation, the tagging profile represents funds stolen from a cryptocurrency exchange. In the event of a theft, the exchange can publish a tagging profile wherein any funds taken by the attacks are identified by the relevant blockchain transaction outputs. The weighting values associated therewith may be chosen as high risk by the exchange according to a commonly accepted weighting scale (e.g., 0-10 with 10 being the most at risk funds) or the weighting may be chosen by the digital asset service provider <b>802</b> according to its own risk tolerance or standards imposed on the digital asset service provider <b>802</b> (e.g., a legal requirement not to handle stolen funds and a minimum threshold weighting score of 0.1). Other weighting propagation schemes are also possible, such as the &#x201c;full blacklist&#x201d; wherein any contact at all with the tagged funds and descendants thereof are assigned the same high weight value.</p><p id="p-0058" num="0057">Other sources of the tagging profile and weightings may be supplied by a government entity, such as a government regulatory or enforcement agency. If a law enforcement agency deems blockchain funds to have been used in the commitment of a crime or to finance terrorism or in dealings with countries subject to economic sanctions, to take but a few examples, then the agency may have authority to tag those funds and impose restrictions or requirements on persons and/or businesses in the relevant legal jurisdictions regarding use of the funds should they come into contact. There is hardly any limit to the measures a state actor may take in an attempt to limit use of funds on a blockchain (especially a UTXO model blockchain). Any opponent of the state could be targeted and funds excluded from digital asset services providers, which could also include legacy financial system services providers, including without limitation tax collection enforcement targets, crime suspects, persons conducting business with entities of foreign origin, etc. The government entity may thus publish tagging profiles and require adherence thereto from the digital asset services provider <b>802</b>.</p><p id="p-0059" num="0058">Another example of the source of tagging profiles is a public registry. Funds known to have originated from undesirable sources may be collected and published. In some implementations, the customer <b>804</b> selects one or more tagging profiles from the public registry and requests the digital asset services provider <b>802</b> to apply the tagging profiles to any blockchain funds traced at the request of the customer <b>804</b>. For example, if the customer <b>804</b> is the customer of an API service provided by the digital asset services provider <b>802</b> to check funds with which the customer <b>804</b> is considering interacting but wants to check a risk score first.</p><p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. <b>9</b></figref> is a block diagram <b>900</b> of an example system <b>902</b> for tracing flow of tagged funds on a blockchain <b>904</b>. The system <b>902</b> includes multiple components for carrying out the functions described herein. One such components is the transmitter <b>910</b>, which can communicate with other participants (e.g., over the internet) and to receive certain pieces of information used in the system <b>902</b>. One such type of communication is the identification of funds <b>908</b> from a participant <b>906</b>. The participant <b>906</b> could be, for example without limitation, a customer of a digital asset services provider who has deposited funds into a wallet controlled by the digital asset services provider, a customer wishing to check funds for a business transaction with a third-party, etc.</p><p id="p-0061" num="0060">The transmitter <b>910</b> also receives a global transaction history <b>922</b> from the blockchain <b>904</b>. The transmitter <b>910</b> may receive the global transaction history pursuant to a request from the blockchain network participant <b>912</b>. The blockchain network participant <b>912</b>, in some implementations, is a full node participating in the network of the blockchain <b>904</b>. A full node, in most cases, maintains a full (or in some cases, pruned) copy of the full shared ledger of the blockchain. Receipt of the global transaction history <b>922</b> in this case means receiving constant updates from other full node of pending transactions (e.g., the mempool) and solved blocks. As each new block is added to the chain, the global transaction history is thus updated. The blockchain network participant may further apply the consensus rules of the blockchain <b>904</b> to all newly received transactions and blocks and reject any transaction or block that does not comply therewith. In other implementations, the blockchain network participant <b>912</b> is not a full node. The participant <b>912</b> could alternatively or additionally be a client that requests and searches a copy of the blockchain, such as by requesting from a third-party block explorer.</p><p id="p-0062" num="0061">The system for tracing funds <b>902</b> obtains tagging profiles <b>916</b>. The tagging profiles may be generated locally at the system <b>902</b> and/or received from another source, such as the public list, the government enforcement list, stolen property list, or other published chosen criteria. The tagging profiles <b>916</b> could arise from private information as well, such as tagged wallets known to belong to a commercial entity to profile on-chain interactions between the funds and the entity, especially with respect to a particular customer or user <b>906</b>.</p><p id="p-0063" num="0062">A transaction replayer <b>914</b> receives the tagging profiles <b>916</b> and the global transaction history (or relevant portion thereof) and identification of funds from the blockchain network participant <b>912</b>. Equipped with these pieces, the transaction replayer can generate the spending history of the identifier of funds by replaying the identifier of funds against the global transaction history of the blockchain. The result, the spending history, includes the blockchain transaction outputs that resulted from confirmed transactions including the outputs identified by the identifier of funds. In implementations, the identifier of funds is the extended public address (xpub) from which a set of new outputs will be deterministically generated and can be thought of as a &#x201c;wallet.&#x201d; In the case of an xpub, the spending history would include all the xpub generated address that exist on the blockchain <b>904</b> in addition to any outputs that are the result of a transaction that combines inputs with outputs generated based on the xpub.</p><p id="p-0064" num="0063">The transaction replayer <b>914</b> also generates the propagation profile by replaying the tagging profile(s) against the global transaction history. Similar to generation of the spending history, generation of the propagation profile involves starting with a set of blockchain outputs (or an xpub) and finding additional outputs of interest that were combined with outputs arising from the tagging profile. Unlike generation of the spending history, however, generation of the propagation profile includes propagation of a weighting value. The tagged funds thus &#x201c;dilute&#x201d; as they move around the blockchain and combine with non-tagged funds. The degree of dilution depends on the size of the untagged funds mixed in. A relatively small amount will result only in a small dilution, whereas a relatively large amount mixed in will produce greater dilution.</p><p id="p-0065" num="0064">The term global transaction history as used herein essentially is the blockchain itself since the blockchain represents incremental updates to a shared ledger. Some blockchains could be pruned, meaning all spent outputs are discarded and the network participant only works with the unspent outputs (e.g., the UTXO set). Such a pruned chain could miss intersections between the tagging profile and the spending history. If only the UTXO set is considered, then a dilution level of any tagged funds may differ from the dilution level of the funds upstream. Nonetheless, implementations may choose to only handle the UTXO set, thus giving a &#x201c;current snapshot&#x201d; of the intersection of the spending history with the propagation profile, and not a historical record of the same.</p><p id="p-0066" num="0065">After the transaction replayer <b>914</b> has generated the spending history and the propagation profile, the funds weighting evaluator <b>920</b> determines whether an intersection condition is satisfied. As was noted herein, over long periods of time, it is possible that a large and significant portion of all the funds on the chain <b>904</b> acquire some weighting level. As a large intersecting set may be of diminished utility in determining how closely related identified funds are to weighted funds, the funds weighting evaluator <b>920</b> may act as a filter to remove intersecting funds wherein the weight level is below a minimum threshold.</p><p id="p-0067" num="0066">If the funds weighting evaluator <b>920</b> determines an intersection condition does exist, there may be triggers set such that the intersection causes another event to fire. In one implementation, a payment gatekeeper <b>918</b> forms and broadcasts a blockchain transaction in response to the intersection condition. Examples of triggers may be when funds deposited by a customer <b>906</b> with a digital asset service provider are deemed to intersect with stolen funds. In this case, the digital asset service provider may be required to not interact with the funds. Accordingly, the payment gatekeeper <b>918</b> may generate a blockchain transaction returning the funds to the sender. In other words, by signing a new, valid blockchain transaction with an output known to be associated with the customer <b>906</b> who deposited the funds (e.g., a known return address, an address known to have been generated as part of a wallet controlled by the customer <b>906</b>, etc.).</p><p id="p-0068" num="0067">Another example of a trigger based on intersection of the spending history with the propagation profile is a notification alert sent to a participant. Since intersecting funds with a propagation profile are likely to trigger an event, a notification of the event or an alert may be performed by the transmitter <b>910</b> to inform the network participant of the event. For example, if funds deposited by the customer <b>906</b> are to be returned, then the customer <b>906</b> likely wishes to be notified of this fact. Other examples may include without limitation a lender who accepts digital asset collateral for a loan with minimum loan-to-value ratio (LTV) requirements wherein a borrower may attempt to improve the LTV by depositing digital assets that may not be credited to the customer <b>906</b> due to a weighting value above the acceptable threshold.</p><p id="p-0069" num="0068">Other examples of a trigger based on intersection of the spending history with the propagation profile include assembly of a profile of the customer <b>906</b>. If the customer <b>906</b> receives funds from a digital asset services provider (e.g., withdrawal from a cryptocurrency exchange), then the digital asset services provider may be interested to know about economic interactions between the customer <b>906</b> and other entities using the withdrawn funds. For example, if funds identified as withdrawn by the customer <b>906</b> and thus under control of the customer <b>906</b> end up intersecting with a known hot wallet of a large online retailer, then the digital asset services provider can profile the user <b>906</b> as a customer of the large online retailer, assuming the weight of the intersecting funds is deemed high enough. This information is especially easy to glean based on known hot and cold wallets of popular cryptocurrency exchanged.</p><p id="p-0070" num="0069">Of course, intersection of the funds withdrawn by the customer <b>906</b> intersecting with another known wallet do not mean the customer <b>906</b> himself interacted economically with the known hot wallet. It is also possible the customer <b>906</b> spent funds to a third-party, who then spent the funds to the known wallet. In this case, the customer <b>906</b> is profiled as having been economically closely located to the known wallet, even if the interaction is not direct. In this way, a &#x201c;heat map&#x201d; of the economic position of the customer <b>906</b> can be made, even if the direct and/or indirect nature of the interaction is not directly known.</p><p id="p-0071" num="0070"><figref idref="DRAWINGS">FIG. <b>10</b></figref> is a flowchart <b>1000</b> of an example workflow for tracing flow of tagged funds on a blockchain. An obtaining operation <b>1002</b> obtains at least a portion of a blockchain ledger, the blockchain ledger representing a global transaction history of funds on the blockchain. One way to limit the operation to a portion of the shared ledger is to specify a blockheight representing the earliest point in time on the blockchain of interest. A receiving operation <b>1004</b> receives an identifier of funds on the blockchain ledger. Ways to identify the funds include the xpub of a wallet, and/or one or more blockchain transaction outputs.</p><p id="p-0072" num="0071">A replaying operation <b>1006</b> replays the identifier of funds against the global transaction history to yield a spending history of the identifier of funds. The spending history includes the spent and unspent outputs arising from transactions into which identified funds were inputs. In some cases, the identifier of funds will be near or at the tip of the chain. For example, when a newly created output (e.g., the output was introduced to the blockchain in a recently mined block) is the identifier of funds. In the case of a very &#x201c;fresh&#x201d; identifier of funds, the replaying operation can be or resemble a null operation. In other words, the portion of the global transaction history against which the identifier of funds is to be replayed is itself a null set. In this case, the replaying operation <b>1006</b> may be merely checking for new transactions involving the identifier of funds in the global transaction history without finding any, and thus the output of the replay operation is the identifier of funds itself</p><p id="p-0073" num="0072">A receiving operation <b>1008</b> receives a tagging profile, the tagging profile including a set of tagged transaction outputs on the blockchain ledger and weight values associated therewith. In one implementation, the weight values are risk values assigned according to association of the funds in the tagging profile with illegal and/or undesirable activity. In other implementations, the weight values indicate how closely the tagging profile is associated with a particular business entity or industry sector for the purpose of drawing inferences about the spending of the funds. Another replaying operation <b>1010</b> replays the tagging profile against the global transaction history to yield a propagation profile, the propagation profile including transaction outputs and weight values associated therewith derived from the tagging profile. The propagation profile may, for example, inherit weight values according to the relative weight of the blockchain outputs used as inputs to a transaction resulting in the propagation profile.</p><p id="p-0074" num="0073">A determining operation <b>1012</b> determines whether the spending history of the identifier of funds satisfies an intersection condition with respect to the propagation profile. The intersection condition may be satisfied if any of the spending history shares an output with an output of the propagation profile having a weight value above a threshold. A transmitting operation <b>1014</b> transmits an alert notification to a network participant if the intersection condition is satisfied. The alert notification may alert the participant to a condition, such as the detection of an intersection with a propagation profile developed from a chosen tagging profile, whether funds are being moved based on the intersection condition, etc.</p><p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. <b>11</b></figref> is another flowchart <b>1100</b> of an example workflow for tracing flow of tagged funds on a blockchain. A generating operation <b>1102</b> generates an identifier of funds on a blockchain ledger. Examples of identified funds may include funds deposited by a customer, funds dispersed to a customer, funds identified by a user of an API, etc. A requesting operation <b>1104</b> requests the application of a tagging profile including a set of tagged transaction outputs on the blockchain ledger and weight values associated therewith against the identifier of funds. The requesting operation <b>1104</b> may, for example, a request via an API to a digital asset services provider to trace funds on a blockchain. In other words, the digital asset services provider in this scenario is a provider of funds tracing services.</p><p id="p-0076" num="0075">A receiving operation <b>1106</b> receives an intersection profile including an indication of whether a spending history of the identifier of funds intersects with a propagation profile of the set of tagged transaction outputs, the propagation profile inheriting weight values from the tagging profile. The intersection profile may indicate which blockchain outputs intersected with propagation profile elements and what the resulting weight values are. Aggregate data on the amount and extent of the intersection may be included in the intersection profile (e.g., mean, median, mode weight values, etc.).</p><p id="p-0077" num="0076"><figref idref="DRAWINGS">FIG. <b>12</b></figref> is an example system that may be useful in carrying out the present disclosure. <figref idref="DRAWINGS">FIG. <b>12</b></figref> is a diagram of a system <b>1200</b> that may be useful for implementing a UTXO tagging system. <figref idref="DRAWINGS">FIG. <b>12</b></figref> illustrates an example system (labeled as a processing system <b>1200</b>) that may be useful in implementing the described technology. The processing system <b>1200</b> may be a client device, such as a smart device, connected device, Internet of Things (IoT) device, laptop, mobile device, desktop, tablet, or a server/cloud device. The processing system <b>1200</b> includes one or more processor(s) <b>1202</b>, and a memory <b>1204</b>. The memory <b>1204</b> generally includes both volatile memory (e.g., RAM) and non-volatile memory (e.g., flash memory). An operating system <b>1210</b> resided in the memory <b>1204</b> and is executed by the processor <b>1202</b>.</p><p id="p-0078" num="0077">One or more application programs <b>1212</b> modules or segments, such as oracle manager <b>944</b> and blockchain manager <b>1246</b> are loaded in the memory <b>1204</b> and/or storage <b>1220</b> and executed by the processor <b>1202</b>. In some implementations, the graph generator <b>1244</b> is stored in read-only memory (ROM) <b>1214</b> or write once, read many (WORM) memory. Data such as extrinsic event data sources may be stored in the memory <b>1204</b> or storage <b>1220</b> and may be retrievable by the processor <b>1202</b> for use by oracle manager <b>1244</b> and the blockchain manager <b>1246</b>, etc. The storage <b>1220</b> may be local to the processing system <b>1200</b> or may be remote and communicatively connected to the processing system <b>1200</b> and may include another server. The storage <b>1220</b> may store resources that are requestable by client devices (not shown). The storage <b>1220</b> may include secure storage such as one or more platform configuration registers (PCR) managed by one or more trusted platform modules (TPMs), which may be implemented in a chip or by the trusted execution environment (TEE).</p><p id="p-0079" num="0078">The processing system <b>1200</b> includes a power supply <b>1216</b>, which is powered by one or more batteries or other power sources and which provides power to other components of the processing system <b>1200</b>. The power supply <b>1216</b> may also be connected to an external power source that overrides or recharges the built-in batteries or other power sources.</p><p id="p-0080" num="0079">The processing system <b>1200</b> may include one or more communication transceivers <b>1230</b> which may be connected to one or more antenna(s) <b>1232</b> to provide network connectivity (e.g., mobile phone network, Wi-Fi&#xae;, Bluetooth&#xae;, etc.) to one or more other servers and/or client devices (e.g., mobile devices, desktop computers, or laptop computers). The processing system <b>1200</b> may further include a network adapter <b>1236</b>, which is a type of communication device. The processing system <b>1200</b> may use the network adapter <b>1236</b> and any other types of communication devices for establishing connections over a wide-area network (WAN) or local area network (LAN). It should be appreciated that the network connections shown are exemplary and that other communications devices and means for establishing a communications link between the processing system <b>1200</b> and other devices may be used.</p><p id="p-0081" num="0080">The processing system <b>1200</b> may include one or more input devices <b>1234</b> such that a user may enter commands and information (e.g., a keyboard or mouse). Input devices <b>1234</b> may further include other types of input such as multimodal input, speech input, graffiti input, motion detection, facial recognition, physical fingerprinting, etc. These and other input devices may be coupled to the server by one or more interfaces <b>1238</b> such as a serial port interface, parallel port, universal serial bus (USB), etc. The processing system <b>1200</b> may further include a display <b>1222</b> such as a touch screen display.</p><p id="p-0082" num="0081">The processing system <b>1200</b> may include a variety of tangible processor-readable storage media and intangible processor-readable communication signals including in virtual and/or cloud computing environment. Tangible processor-readable storage can be embodied by any available media that can be accessed by the processing system <b>1200</b> and includes both volatile and nonvolatile storage media, removable and non-removable storage media. Tangible processor-readable storage media excludes intangible communications signals and includes volatile and nonvolatile, removable and non-removable storage media implemented in any method or technology for storage of information such as processor-readable instructions, data structures, program modules or other data. Tangible processor-readable storage media includes, but is not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CDROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other tangible medium which can be used to store the desired information, and which can be accessed by the processing system <b>1200</b>. In contrast to tangible processor-readable storage media, intangible processor-readable communication signals may embody computer-readable instructions, data structures, program modules or other data resident in a modulated data signal, such as a carrier wave or other signal transport mechanism. The term &#x201c;modulated data signal&#x201d; means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, intangible communication signals include signals traveling through wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared, and other wireless media.</p><p id="p-0083" num="0082">In the foregoing specification, specific embodiments have been described. However, one of ordinary skill in the art appreciates that various modifications and changes can be made without departing from the scope of the invention as set forth in the claims below. Accordingly, the specification and figures are to be regarded in an illustrative rather than a restrictive sense, and all such modifications are intended to be included within the scope of present teachings.</p><p id="p-0084" num="0083">The benefits, advantages, solutions to problems, and any element(s) that may cause any benefit, advantage, or solution to occur or become more pronounced are not to be construed as a critical, required, or essential features or elements of any or all the claims. The invention is defined solely by the appended claims including any amendments made during the pendency of this application and all equivalents of those claims as issued.</p><p id="p-0085" num="0084">Moreover, in this document, relational terms such as first and second, top and bottom, and the like may be used solely to distinguish one entity or action from another entity or action without necessarily requiring or implying any actual such relationship or order between such entities or actions. The terms &#x201c;comprises,&#x201d; &#x201c;comprising,&#x201d; &#x201c;has&#x201d;, &#x201c;having,&#x201d; &#x201c;includes&#x201d;, &#x201c;including,&#x201d; &#x201c;contains&#x201d;, &#x201c;containing&#x201d; or any other variation thereof, are intended to cover a non-exclusive inclusion, such that a process, method, article, or apparatus that comprises, has, includes, contains a list of elements does not include only those elements but may include other elements not expressly listed or inherent to such process, method, article, or apparatus. An element proceeded by &#x201c;comprises . . . a&#x201d;, &#x201c;has . . . a&#x201d;, &#x201c;includes . . . a&#x201d;, &#x201c;contains . . . a&#x201d; does not, without more constraints, preclude the existence of additional identical elements in the process, method, article, or apparatus that comprises, has, includes, contains the element. The terms &#x201c;a&#x201d; and &#x201c;an&#x201d; are defined as one or more unless explicitly stated otherwise herein. The terms &#x201c;substantially&#x201d;, &#x201c;essentially&#x201d;, &#x201c;approximately&#x201d;, &#x201c;about&#x201d; or any other version thereof, are defined as being close to as understood by one of ordinary skill in the art, and in one non-limiting embodiment the term is defined to be within 10%, in another embodiment within 5%, in another embodiment within 1% and in another embodiment within 0.5%. The term &#x201c;coupled&#x201d; as used herein is defined as connected, although not necessarily directly and not necessarily mechanically. A device or structure that is &#x201c;configured&#x201d; in a certain way is configured in at least that way but may also be configured in ways that are not listed.</p><p id="p-0086" num="0085">It will be appreciated that some embodiments may be comprised of one or more generic or specialized processors (or &#x201c;processing devices&#x201d;) such as microprocessors, digital signal processors, customized processors and field programmable gate arrays (FPGAs) and unique stored program instructions (including both software and firmware) that control the one or more processors to implement, in conjunction with certain non-processor circuits, some, most, or all of the functions of the method and/or apparatus described herein. Alternatively, some or all functions could be implemented by a state machine that has no stored program instructions, or in one or more application specific integrated circuits (ASICs), in which each function or some combinations of certain of the functions are implemented as custom logic. Of course, a combination of the two approaches could be used.</p><p id="p-0087" num="0086">Moreover, an embodiment can be implemented as a computer-readable storage medium having computer readable code stored thereon for programming a computer (e.g., comprising a processor) to perform a method as described and claimed herein. Examples of such computer-readable storage mediums include, but are not limited to, a hard disk, a CD-ROM, an optical storage device, a magnetic storage device, a ROM (Read Only Memory), a PROM (Programmable Read Only Memory), an EPROM (Erasable Programmable Read Only Memory), an EEPROM (Electrically Erasable Programmable Read Only Memory) and a Flash memory. Further, it is expected that one of ordinary skill, notwithstanding possibly significant effort and many design choices motivated by, for example, available time, current technology, and economic considerations, when guided by the concepts and principles disclosed herein will be readily capable of generating such software instructions and programs and ICs with minimal experimentation.</p><p id="p-0088" num="0087">The Abstract of the Disclosure is provided to allow the reader to quickly ascertain the nature of the technical disclosure. It is submitted with the understanding that it will not be used to interpret or limit the scope or meaning of the claims. In addition, in the foregoing Detailed Description, it can be seen that various features are grouped together in various embodiments for the purpose of streamlining the disclosure. This method of disclosure is not to be interpreted as reflecting an intention that the claimed embodiments require more features than are expressly recited in each claim. Rather, as the following claims reflect, inventive subject matter lies in less than all features of a single disclosed embodiment. Thus the following claims are hereby incorporated into the Detailed Description, with each claim standing on its own as a separately claimed subject matter.</p><?detailed-description description="Detailed Description" end="tail"?></description><claims id="claims"><claim id="CLM-01-20" num="01-20"><claim-text><b>1</b>-<b>20</b>. (canceled)</claim-text></claim><claim id="CLM-00021" num="00021"><claim-text><b>21</b>. A system for tracing flow of tagged funds on a blockchain, the system comprising:<claim-text>a blockchain network participant configured to obtain at least a portion of a blockchain ledger representing a global transaction history of funds on the blockchain;</claim-text><claim-text>a transmitter at which to receive an identifier of funds on the blockchain ledger and a tagging profile including a set of tagged transaction outputs on the blockchain ledger and weight values associated therewith pursuant to a request from the blockchain network participant,<claim-text>wherein each of the weight values is indicative of an amount of the funds included in a corresponding one of the set of tagged transaction outputs; and</claim-text></claim-text><claim-text>at least one application program executable by the system and configured to:<claim-text>ascertain a spending history of the identifier of funds and a propagation profile; and</claim-text><claim-text>determine whether the spending history satisfies an intersection condition with respect to the propagation profile.</claim-text></claim-text></claim-text></claim><claim id="CLM-00022" num="00022"><claim-text><b>22</b>. The system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the at least one application program sends an alert notification to a market participant if the intersection condition is satisfied.</claim-text></claim><claim id="CLM-00023" num="00023"><claim-text><b>23</b>. The system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the tagging profile is based at least in part on an identification of stolen funds.</claim-text></claim><claim id="CLM-00024" num="00024"><claim-text><b>24</b>. The system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the tagging profile is based at least in part on funds associated with a market participant and the alert notification indicates an economic interaction between funds in the spending history of the identifier of funds with the market participant.</claim-text></claim><claim id="CLM-00025" num="00025"><claim-text><b>25</b>. The system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the blockchain network participant includes a node on the blockchain network and the global transaction history of funds on the blockchain is local to the node.</claim-text></claim><claim id="CLM-00026" num="00026"><claim-text><b>26</b>. The system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the identifier of funds and the spending history are equivalent.</claim-text></claim><claim id="CLM-00027" num="00027"><claim-text><b>27</b>. The system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the intersection condition is satisfied only if a weight value of a transaction output in the spending history of the identifier of funds intersects with a transaction output in the propagation profile having a weight value above a trigger threshold.</claim-text></claim><claim id="CLM-00028" num="00028"><claim-text><b>28</b>. The system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the transaction replayer assigns an equal weighting value to any outputs from a transaction in the global transaction history wherein at least one input to the transaction is associated with a weighting value.</claim-text></claim><claim id="CLM-00029" num="00029"><claim-text><b>29</b>. The system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the tagging profile includes a blacklist of transaction outputs.</claim-text></claim><claim id="CLM-00030" num="00030"><claim-text><b>30</b>. The system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the identifier of funds includes a set of transaction outputs derived from an extended public key (xpub).</claim-text></claim><claim id="CLM-00031" num="00031"><claim-text><b>31</b>. The system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the identifier of funds includes a block height on the blockchain.</claim-text></claim><claim id="CLM-00032" num="00032"><claim-text><b>32</b>. A system for tracing flow of tagged funds on a blockchain, the system comprising:<claim-text>a blockchain network participant configured to obtain at least a portion of a blockchain ledger representing a global transaction history of funds on the blockchain;</claim-text><claim-text>a transmitter at which to receive an identifier of funds on the blockchain ledger and a tagging profile including a set of tagged transaction outputs on the blockchain ledger and weight values associated therewith pursuant to a request from the blockchain network participant,<claim-text>wherein each of the weight values is indicative of an amount of the funds included in a corresponding one of the set of tagged transaction outputs; and</claim-text></claim-text><claim-text>at least one application program that, when executed, replays the tagging profile against the global transaction history to yield a spending history of the identifier of funds and a propagation profile; and</claim-text><claim-text>determines whether the spending history of the identifier of funds satisfies an intersection condition with respect to the propagation profile.</claim-text></claim-text></claim><claim id="CLM-00033" num="00033"><claim-text><b>33</b>. The system of <claim-ref idref="CLM-00032">claim 32</claim-ref>, wherein said at least one application program blocks a requested transaction if the intersection condition is satisfied.</claim-text></claim><claim id="CLM-00034" num="00034"><claim-text><b>34</b>. The system of <claim-ref idref="CLM-00033">claim 33</claim-ref>, wherein said at least one application program issues a new transaction so as to return funds associated with the requested transaction.</claim-text></claim><claim id="CLM-00035" num="00035"><claim-text><b>35</b>. The system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein said at least one application program is further configured to block a requested transaction if the intersection condition is satisfied.</claim-text></claim><claim id="CLM-00036" num="00036"><claim-text><b>36</b>. The system of <claim-ref idref="CLM-00035">claim 35</claim-ref> wherein said at least one application program is further configured to issue a new transaction so as to return funds associated with the requestion transaction.</claim-text></claim></claims></us-patent-application>